      ******************************************************************
      *$Header$
      ******************************************************************
      *
      * システムＩＤ   : T-STAR
      * システム名称   : 次期TSTARシステム
      * プログラムＩＤ : SMZJ1910
      * プログラム名称 : 異動簿価・損益計算(物)
      * 処理概要       : 対象ポートフォリオからデータを抽出して，
      *                  ポートフォリオ属性、基準日計算情報より、
      *                  対象ポートフォリオを更新して、
      *                  基準日断面情報を作成する。
      * 参照ＤＢ       : 取引テーブル（TKMXTR00）
      *                : 残高異動計算データテーブル（TKMZBW06）
      *                : 残高異動テーブル（TKMZZI00）
      *                : 取引異動テーブル（TKMTTI00）
      *                : 残高履歴テーブル（TKMZZR00）
      * 更新ＤＢ       : 残高異動計算データテーブル（TKMZBW06）
      * 引数           : IN  取引データ
      *                : IN  相対取引データ
      *                : IN  異動計算パターン
      *                : IN  直前残高異動
      *                : IN  通貨デフォールト端数処理
      *                : IN  基準日断面情報
      *                : IN  銘柄別断面情報
      *                : IN  対象取引情報
      *                : IN  市場通貨コード
      *                : IN  勘定科目出力商品名
      *                : IN  仕訳基準データ
      *                : IN  キャッシュフロー2回有効フラグ
      *                : IN  銘柄属性取得フラグ
      *                : IN  約定ベース受渡順フラグ
      *                : IN  乗算/除算区分
      *                : IN  銘柄属性コールプット区分
      *                : IN  ゼロクーポン債フラグ
      *                : IN  銘柄属性データ
      *                : IN  勘定異動／残高作成
      *                : IN  利付／割引区分
      *                : IN  国内外国区分
      *                : OUT 残高異動計算データ
      *                : OUT 警告情報数
      *                : OUT 警告情報
      *                : OUT RTNパッケージ
      * 改訂履歴
      * 年月日     区分  所属       担当者  内容
      * ---------- ----  ---------  ------  ------------------------
      * 20080526   新規  SCS        于 瓊   新規作成
      * 20080806   修正  SCS        于 瓊   修正
      * 20080813   修正  SCS        于 瓊   修正
      * 20080923   修正  SCS        于 瓊   修正
      * 20081007   修正  SCS        高 帥   残タスク83
      * 20081027   修正  SCS        高 帥
      * 20081105   修正  SCS        王 粒
      * 20081112   修正  SCS        張凌翔  ①連結障害対応0000307対応
      *                                     ②連結障害対応0000271対応
      * 20081119   修正  SCS        張凌翔  修正
      * 20081125   修正  SCS        張凌翔  修正
      * 20081127   修正  SCS        張凌翔  修正
      * 20081203   修正  SCS        張凌翔  残タスク135対応
      * 20081210   修正  SCS        張凌翔  ①連結障害0000812対応
      *                                     ②連結障害0000814対応
      *                                     ③連結障害0000815対応
      * 20081211   修正  SCS        張凌翔  連結テスト障害対応0000833
      * 20081218   修正  SCS        張凌翔  連結障害0000896対応
      * 20081218   修正  SCS        張凌翔  連結障害0001074対応
      *                                     連結障害0000306対応
      * 20090115   修正  SCS        徐曉俊  残タスク131対応
      * 20090119   修正  SCS        徐曉俊  連結障害0001140と残タスク131対応
      * 20090122   修正  SCS        徐曉俊  残タスク163対応
      * 20090202   修正  SCS        王飛
      * 20090203   修正  SCS        周運棟  連結障害0001277対応
      * 20090205   修正  SCS        王飛    残タスク62対応
      * 20090227   修正  SCS        徐曉俊  残タスク188対応
      * 20090302   修正  SCS        徐曉俊  残タスク179対応
      * 20090310   修正  SCS        徐曉俊  残タスク187対応と残タスク194対応
      * 20090325   修正  SCS        徐曉俊  連結引継ぎ残47対応
      * 20090422   修正  SCS        何傑文  テーマ24対応
      *                                     テーマ18対応
      *                                     テーマ14対応
      * 20090429   修正  SCS        李菁    テーマ18対応2
      * 20090430   修正  SCS        徐曉俊   テーマ18対応
      * 20090504   修正  SCS        何傑文  連結障害1719
      * 20090526   修正  SCS        顧建鋒  総障679
      * 20090610   修正  SCS        何傑文  総合障害893
      * 20090612   修正  SCS        何傑文  テーマ32、総合障害478、415
      * 20090619   修正  SCS        何傑文  テーマ544対応
      * 20090624   修正  SCS        何傑文  総合障害530
      * 20090625   修正  SCS        徐曉俊  連結障害1902
      * 20090701   修正  SCS        徐曉俊  総合障害961対応
      * 20090707   修正  SCS        徐曉俊  総合障害982
      * 20090707   修正  SCS        何傑文  総合障害1266
      * 20090715   修正  SCS        王飛    総障1505
      * 20090724   修正  SCS        顧建鋒  総合障害1322
      * 20090727   修正  SCS        王飛    総合障害680対応
      * 20090730   修正  SCS        王飛    総合障害1282
      * 20090731   修正  SCS        顧建鋒  総合障害1381
      * 20090807   修正  SCS        顧建鋒  総合障害1632
      * 20090811   修正  SCS        顧建鋒  総合障害1632 090810追加修正
      * 20090813   修正  SCS        顧建鋒  総合障害1247
      * 20090817   修正  SCS        顧建鋒  総合障害1978
      * 20090818   修正  SCS        顧建鋒  総合障害1595
      * 20090821   修正  SCS        王飛    総合障害1764
      * 20090902   修正  SCS        顧建鋒  総合障害1624
      * 20091019   修正  SCS        王飛    総合障害2833
      * 20091026   修正  SCS        徐曉俊  テーマ1891
      * 20091027   修正  SCS        顧建鋒  テーマ1770
      * 20091027   修正  SCS        顧建鋒  総合障害2714
      * 20091111   修正  SCS        王飛    テーマ1903
      * 20091116   修正  SCS        何傑文  テーマ1760
      * 20091127   修正  SCS        王飛    テーマ1339
      * 20091203   修正  SCS        顧建鋒  テーマ2153
      * 20091216   修正  SCS        王飛    テーマ2257
      * 20091222   修正  SCS        顧建鋒  テーマ1075
      * 20091222   修正  SCS        顧建鋒  テーマ1751
      * 20100222   修正  SCS        孫潔雲  性能改善
      * 20100505   修正  SCS        王蕾    テーマ2473
      * 20100526   修正  SCS        陳曄    テーマ2679
      * 20100531   修正  SCS        陳幸縁  テーマ2560
      * 20100713   修正  SCS        兪巧芳  テーマ2927
      * 20100716   修正  SCS        楊 超   テーマ2560
      * 20100902   修正  SCS        陳幸縁  テーマ3004
      * 20100925   修正  SCS        陳幸縁  テーマ3005
      * 20110422   修正  SCS        丁亜君  テーマ3212-1.残高更新  性能改善
      * 20110615   修正  SCS        兪巧芳  テーマ3224
      * 20130122   修正  SCS        楊斯洋  テーマ3467
      * 20130708   修正  SCS        孫炯    テーマ3530
      ******************************************************************
      ******************************************************************
       IDENTIFICATION         DIVISION.
       PROGRAM-ID.    SMZJ1910.
       AUTHOR.        Nomura.
       DATE-WRITTEN.  08-05-26.
       DATE-COMPILED.
      ******************************************************************
      *
      *                 環  境  部
      *
      ******************************************************************
       ENVIRONMENT            DIVISION.
       CONFIGURATION          SECTION.
       SOURCE-COMPUTER.       L1000V.
      *SOURCE-COMPUTER.       L1000V   WITH DEBUGGING MODE.
       OBJECT-COMPUTER.       RP5470.
       INPUT-OUTPUT           SECTION.
       FILE-CONTROL.
      ******************************************************************
      *
      *                 デ  ー  タ  部
      *
      ******************************************************************
       DATA                   DIVISION.
       WORKING-STORAGE        SECTION.
       01  IDNAME                  PIC  X(80)  VALUE
       "$Id$".
      ******************************************************************
      *                 コンスタント  エリア
      ******************************************************************
       01  CONSTANT-AREA.
         05  CNS-MZCNS.
           COPY "MZCNS.cpy".
      *----------  プログラム名
         05  CNS-PGM-ID            PIC  X(08)  VALUE  "SMZJ1910".
      *----------  取引テーブル
         05  CNS-TBL-TKMXTR00      PIC  X(08)  VALUE  "TKMXTR00".
      *----------  残高異動テーブル
         05  CNS-TBL-TKMZZI00      PIC  X(08)  VALUE  "TKMZZI00".
      *----------  取引異動テーブル
         05  CNS-TBL-TKMXTI00      PIC  X(08)  VALUE  "TKMXTI00".
      *----------  残高履歴テーブル
         05  CNS-TBL-TKMZZR00      PIC  X(08)  VALUE  "TKMZZR00".
      *----------  残高異動計算データテーブル
         05  CNS-TBL-TKMZBW06      PIC  X(08)  VALUE  "TKMZBW06".
      *----------  対象取引情報テーブル
         05  CNS-TBL-TKMZBW04      PIC  X(08)  VALUE  "TKMZBW04".
      *----------  受渡日
         05  CNS-UKE-YMD           PIC  X(07)  VALUE  "UKE_YMD".
      *----------  計上基準日
         05  CNS-KEIJOU-KIJUNBI    PIC  X(14)  VALUE  "KEIJOU_KIJUNBI".
      *----------  警告情報.警告フラグ
         05  CNS-WARN-FLG-B1       PIC  X(02)  VALUE  "B1".
         05  CNS-WARN-FLG-I1       PIC  X(02)  VALUE  "I1".
         05  CNS-WARN-FLG-I2       PIC  X(02)  VALUE  "I2".
         05  CNS-WARN-FLG-I3       PIC  X(02)  VALUE  "I3".
         05  CNS-WARN-FLG-I4       PIC  X(02)  VALUE  "I4".
         05  CNS-WARN-FLG-N2       PIC  X(02)  VALUE  "N2".
      *----------  初期値
         05  CNS-SYOKITI           PIC  S9(15)V9(03)
                                        VALUE  999999999999999.999.
      *----------  計算種類
         05  CNS-CALC-SHRU-10      PIC  X(02)  VALUE  "10".
         05  CNS-CALC-SHRU-02      PIC  X(02)  VALUE  "02".
      *----------  取引事由
         05  CNS-TORI-JIYU-INFI    PIC  X(04)  VALUE  "INFI".
         05  CNS-TORI-JIYU-RETR    PIC  X(04)  VALUE  "RETR".
         05  CNS-TORI-JIYU-STXP    PIC  X(04)  VALUE  "STXP".
         05  CNS-TORI-JIYU-CSOP    PIC  X(04)  VALUE  "CSOP".
         05  CNS-TORI-JIYU-CSTP    PIC  X(04)  VALUE  "CSTP".
      *----------  赤黒区分
         05  CNS-AKA-KBN-1         PIC  X(01)  VALUE  "1".
         05  CNS-AKA-KBN-9         PIC  X(01)  VALUE  "9".
      *----------  ワーク基本会計ベースフラグ
         05  CNS-KH-KAIKEI-BASE-FLG-1
                                   PIC  X(01)  VALUE  "1".
         05  CNS-KH-KAIKEI-BASE-FLG-2
                                   PIC  X(01)  VALUE  "2".
      *----------  ワーク約定主義会計フラグ
         05  CNS-YKJ-SYUGI-KAIKEI-FLG-0
                                   PIC  X(01)  VALUE  "0".
         05  CNS-YKJ-SYUGI-KAIKEI-FLG-1
                                   PIC  X(01)  VALUE  "1".
         05  CNS-YKJ-SYUGI-KAIKEI-FLG-2
                                   PIC  X(01)  VALUE  "2".
      *----------  キャッシュフロー２回発生区分
         05  CNS-CASH-FLOW-KBN-1   PIC  X(01)  VALUE  "1".
         05  CNS-CASH-FLOW-KBN-2   PIC  X(01)  VALUE  "2".
      *----------  銘柄属性取得フラグ
         05  CNS-MEG-ZOK-FLG-1     PIC  X(01)  VALUE  "1".
         05  CNS-MEG-ZOK-FLG-0     PIC  X(01)  VALUE  "0".
      *----------  判定対象区分
         05  CNS-HANTEI-TARGET-KBN-1
                                   PIC  X(01)  VALUE  "1".
         05  CNS-HANTEI-TARGET-KBN-3
                                   PIC  X(01)  VALUE  "3".
         05  CNS-HANTEI-TARGET-KBN-2
                                   PIC  X(01)  VALUE  "2".
         05  CNS-HANTEI-TARGET-KBN-5
                                   PIC  X(01)  VALUE  "5".
         05  CNS-HANTEI-TARGET-KBN-7
                                   PIC  X(01)  VALUE  "7".
         05  CNS-HANTEI-TARGET-KBN-8
                                   PIC  X(01)  VALUE  "8".
         05  CNS-HANTEI-TARGET-KBN-A
                                   PIC  X(01)  VALUE  "a".
         05  CNS-HANTEI-TARGET-KBN-4
                                   PIC  X(01)  VALUE  "4".
      *----------  ワーク取引分析-未収未払.未収未払フラグ
         05  CNS-MISYU-MIHAR-FLG-0
                                   PIC  X(01)  VALUE  "0".
         05  CNS-MISYU-MIHAR-FLG-1
                                   PIC  X(01)  VALUE  "1".
         05  CNS-MISYU-MIHAR-FLG-2
                                   PIC  X(01)  VALUE  "2".
      *----------  資金決済方法
         05  CNS-KESAI-HOHO-2      PIC  X(01)  VALUE  "2".
      *----------  分割元
         05  CNS-BUNKATSUGEN       PIC  X(01)  VALUE  "1".
      *----------  分割先
         05  CNS-BUNKATSUSEN       PIC  X(01)  VALUE  "2".
      *----------  国内外国区分
         05  CNS-NAI-GAI-KBN-0     PIC  X(01)  VALUE  "0".
         05  CNS-NAI-GAI-KBN-1     PIC  X(01)  VALUE  "1".
      *----------  フラグ
         05  CNS-FLG-0             PIC  X(01)  VALUE  "0".
         05  CNS-FLG-1             PIC  X(01)  VALUE  "1".
         05  CNS-FLG-2             PIC  X(01)  VALUE  "2".
         05  CNS-DATA-FLG-1        PIC  9(01)  VALUE  1.
      *----------  処理順
         05  CNS-SRJUN-1           PIC  9(01)  VALUE  1.
      *----------  増幅区分
         05  CNS-KBN-1             PIC  X(01)  VALUE  "1".
      *----------  バランスフラグ
         05  CNS-BALANCE-FLG-1     PIC  X(01)  VALUE  "1".
      *----------  作成フラグ
         05  CNS-SK-FLG-3          PIC  X(01)  VALUE  "3".
         05  CNS-SK-FLG-4          PIC  X(01)  VALUE  "4".
      *----------  更新フラグ
         05  CNS-UPD-FLG-3         PIC  X(01)  VALUE  "3".
         05  CNS-UPD-FLG-4         PIC  X(01)  VALUE  "4".
      *----------  ワーク乗算/除算区分
         05  CNS-JZ-JS-KBN-FLG-1   PIC  X(01)  VALUE  "1".
      *----------  商品別取引区分
         05  CNS-SHB-TORI-KBN-1    PIC  X(01)  VALUE  "1".
      *----------  経過利息区分
         05  CNS-KKRS-KBN-1        PIC  X(01)  VALUE  "1".
         05  CNS-KKRS-KBN-2        PIC  X(01)  VALUE  "2".
         05  CNS-KKRS-KBN-4        PIC  X(01)  VALUE  "4".
         05  CNS-KKRS-KBN-5        PIC  X(01)  VALUE  "5".
      *----------  商品区分
         05  CNS-SYOHIN-KBN-2      PIC  X(01)  VALUE  "2".
      *----------  前払金計算方法
         05  CNS-MAEBR-KIN-CALC-HOU-1
                                   PIC  9(01)  VALUE  1.
         05  CNS-MAEBR-KIN-CALC-HOU-2
                                   PIC  9(01)  VALUE  2.
         05  CNS-MAEBR-KIN-CALC-HOU-3
                                   PIC  9(01)  VALUE  3.
         05  CNS-MAEBR-KIN-CALC-HOU-4
                                   PIC  9(01)  VALUE  4.
         05  CNS-MAEBR-KIN-CALC-HOU-5
                                   PIC  9(01)  VALUE  5.
         05  CNS-MAEBR-KIN-CALC-HOU-0
                                   PIC  9(01)  VALUE  0.
         05  CNS-MAEBR-KIN-CALC-HOU-15
                                   PIC  9(02)  VALUE  15.
         05  CNS-MAEBR-KIN-CALC-HOU-16
                                   PIC  9(02)  VALUE  16.
         05  CNS-MAEBR-KIN-CALC-HOU-21
                                   PIC  9(02)  VALUE  21.
         05  CNS-MAEBR-KIN-CALC-HOU-24
                                   PIC  9(02)  VALUE  24.
         05  CNS-MAEBR-KIN-CALC-HOU-25
                                   PIC  9(02)  VALUE  25.
      *---------- 乗算/除算区分
         05  CNS-JZ-JS-KBN-1       PIC  X(01)  VALUE "1".
      *---------- 勘定異動／残高作成:作成しない
         05  CNS-KJIDO-ZANSK-2     PIC  9(01)  VALUE  2.
      *----------  パラメータエラーメッセージ
         05  CNS-SQL-MSG-SELECT    PIC  X(17)  VALUE
                                               " SQL-MSG(SELECT):".
      *----------  リターンコード
         05  CNS-RTN-113           PIC  X(03)  VALUE  "113".
         05  CNS-1                 PIC  9(01)  VALUE  1.
         05  CNS-C1                PIC  X(01)  VALUE  "1".
         05  CNS-C2                PIC  X(01)  VALUE  "2".
         05  CNS-C3                PIC  X(01)  VALUE  "3".
         05  CNS-C4                PIC  X(01)  VALUE  "4".
         05  CNS-C5                PIC  X(01)  VALUE  "5".
         05  CNS-C6                PIC  X(01)  VALUE  "6".
         05  CNS-C                 PIC  X(01)  VALUE  "C".
         05  CNS-P                 PIC  X(01)  VALUE  "P".
         05  CNS-Z                 PIC  X(01)  VALUE  "Z".
         05  CNS-C0                PIC  X(01)  VALUE  "0".
         05  CNS-DMY1              PIC  X(04)  VALUE  "DMY1".
         05  CNS-DMY3              PIC  X(04)  VALUE  "DMY3".
         05  CNS-DMY6              PIC  X(04)  VALUE  "DMY6".
         05  CNS-DMY7              PIC  X(04)  VALUE  "DMY7".
         05  CNS-DMY8              PIC  X(04)  VALUE  "DMY8".
         05  CNS-DMY9              PIC  X(04)  VALUE  "DMY9".
         05  CNS-GANI              PIC  X(04)  VALUE  "GANI".
         05  CNS-LOOI              PIC  X(04)  VALUE  "LOOI".
         05  CNS-GANC              PIC  X(04)  VALUE  "GANC".
         05  CNS-LOOC              PIC  X(04)  VALUE  "LOOC".
         05  CNS-PYIN              PIC  X(04)  VALUE  "PYIN".
         05  CNS-RCOT              PIC  X(04)  VALUE  "RCOT".
         05  CNS-RCPB              PIC  X(04)  VALUE  "RCPB".
         05  CNS-RCPS              PIC  X(04)  VALUE  "RCPS".
         05  CNS-BUY               PIC  X(03)  VALUE  "BUY".
         05  CNS-FBUY              PIC  X(04)  VALUE  "FBUY".
         05  CNS-OSIO              PIC  X(04)  VALUE  "OSIO".
         05  CNS-OSIT              PIC  X(04)  VALUE  "OSIT".
         05  CNS-SELL              PIC  X(04)  VALUE  "SELL".
         05  CNS-FSEL              PIC  X(04)  VALUE  "FSEL".
         05  CNS-OSOT              PIC  X(04)  VALUE  "OSOT".
         05  CNS-TSOT              PIC  X(04)  VALUE  "TSOT".
         05  CNS-PO                PIC  X(04)  VALUE  "PO  ".
         05  CNS-FTPK              PIC  X(04)  VALUE  "FTPK".
         05  CNS-FTLL              PIC  X(04)  VALUE  "FTLL".
         05  CNS-FTLK              PIC  X(04)  VALUE  "FTLK".
         05  CNS-FTPL              PIC  X(04)  VALUE  "FTPL".
         05  CNS-KBN-2             PIC  X(01)  VALUE  "2".
         05  CNS-KBN-4             PIC  X(01)  VALUE  "4".
      ******************************************************************
      *                 ワ－クエリア
      ******************************************************************
       01  WORK-AREA.
         05  WK-DATA-IN.
      *----------  取引データ
           10  WK-TORI-DATA.
      *----------  処理実行日
             15  WK-SYORI-YMD      PIC  S9(08).
      *----------  利用会社コード
             15  WK-RIYO-CMP-CD    PIC  X(04).
      *----------  ファンドコード
             15  WK-FUND-CD        PIC  X(12).
      *----------  ポートフォリオコード
             15  WK-PTF-CD         PIC  X(04).
      *----------  銘柄コード
             15  WK-MEG-CD         PIC  X(15).
      *----------  証券種別コード
             15  WK-SEC-SBT-CD     PIC  X(04).
      *----------  資産負債・買建売建フラグ
             15  WK-TATE-FLG       PIC  X(01).
      *----------  玉ID
             15  WK-GYOKU-ID       PIC  X(10).
      *----------  取引連関ＩＤ
             15  WK-THRK-ID        PIC  S9(10).
      *----------  対象取引ＩＤ
             15  WK-TARGET-TORI-ID
                                   PIC  S9(10).
      *----------  取引内容
             15  WK-TORI-NAIY      PIC  X(04).
      *----------  取引事由
             15  WK-TORI-JIYU      PIC  X(04).
      *----------  市場通貨コード
             15  WK-SJTK-CD        PIC  X(04).
      *----------  投資対象国コード
             15  WK-TSTSK-CD       PIC  X(04).
      *----------  発行国コード
             15  WK-HAKO-CD        PIC  X(04).
      *----------  １口注文ＩＤ
             15  WK-ORDR-1K-ID     PIC  S9(10).
      *----------  約定日
             15  WK-YKJ-YMD        PIC  S9(08).
      *----------  受渡日
             15  WK-UKE-YMD        PIC  S9(08).
      *----------  効力発生日
             15  WK-KOURYOKU-YMD   PIC  S9(08).
      *----------  スタート日（放出日）
             15  WK-ST-YMD         PIC  S9(08).
      *----------  受渡ベースエンド日
             15  WK-UKE-END-YMD    PIC  S9(08).
      *----------  保有目的
             15  WK-POSSESSION-OBJECT
                                   PIC  X(01).
      *----------  資金決済方法
             15  WK-KESAI-HOHO     PIC  X(01).
      *----------  現地入出金額
             15  WK-G-NSKG         PIC  S9(15)V9(03).
      *----------  現地ブローカー
             15  WK-G-BRK          PIC  X(04).
      *----------  経過利息区分
             15  WK-KKRS-KBN       PIC  X(01).
      *----------  数量単位
             15  WK-SURYO-TANI     PIC  S9(12)V9(06).
      *----------  異動数量
             15  WK-IDO-SURYO      PIC  S9(12)V9(06).
      *----------  権利数量
             15  WK-KENRI-SURYO    PIC  S9(12)V9(06).
      *----------  約定単価
             15  WK-YKJ-TANKA      PIC  S9(08)V9(10).
      *----------  為替レート（市場／運用）
             15  WK-S-U-KWS        PIC  S9(08)V9(10).
      *----------  為替差損益
             15  WK-UYTK-KWS-SNEKI
                                   PIC  S9(15)V9(03).
      *----------  調整損益
             15  WK-CHOSEI-SNEKI   PIC  S9(15)V9(03).
      *----------  約定金額
             15  WK-G-YJKG         PIC  S9(15)V9(03).
      *----------  受取利息金額
             15  WK-UKETR-RSK-KG   PIC  S9(15)V9(03).
      *----------  入出金額（約定レート・運用通貨換算額）
             15  WK-NSKG-Y-UY      PIC  S9(15)V9(03).
      *----------  既経過利息（市場通貨換算額）
             15  WK-S-KSG-G-KKKRS  PIC  S9(15)V9(03).
      *----------  既経過利息（運用通貨換算額）
             15  WK-U-KSG-G-KKKRS  PIC  S9(15)V9(03).
      *----------  精算金額（市場通貨換算額）
             15  WK-S-KSG-SSKG     PIC  S9(15)V9(03).
      *----------  精算金額（運用通貨換算額）
             15  WK-U-KSG-SSKG     PIC  S9(15)V9(03).
      *----------  約定金額（市場通貨換算額）
             15  WK-S-KSG-G-YJKG   PIC  S9(15)V9(03).
      *----------  約定金額（運用通貨換算額）
             15  WK-U-KSG-G-YJKG   PIC  S9(15)V9(03).
      *----------  運用国手数料（市場通貨換算額）
             15  WK-S-KSG-U-TSR    PIC  S9(15)V9(03).
      *----------  運用国消費税（市場通貨換算額）
             15  WK-S-KSG-U-SHZ    PIC  S9(15)V9(03).
      *----------  運用国その他費用（市場通貨換算額）
             15  WK-S-KSG-U-THY    PIC  S9(15)V9(03).
      *----------  運用国手数料（運用通貨換算額）
             15  WK-U-KSG-U-TSR    PIC  S9(15)V9(03).
      *----------  運用国消費税（運用通貨換算額）
             15  WK-U-KSG-U-SHZ    PIC  S9(15)V9(03).
      *----------  運用国その他費用（運用通貨換算額）
             15  WK-U-KSG-U-THY    PIC  S9(15)V9(03).
      *----------  現地手数料（市場通貨換算額）
             15  WK-S-KSG-G-TSR    PIC  S9(15)V9(03).
      *----------  現地消費税（市場通貨換算額）
             15  WK-S-KSG-G-SHZ    PIC  S9(15)V9(03).
      *----------  現地その他費用（市場通貨換算額）
             15  WK-S-KSG-G-THY    PIC  S9(15)V9(03).
      *----------  現地手数料（運用通貨換算額）
             15  WK-U-KSG-G-TSR    PIC  S9(15)V9(03).
      *----------  現地消費税（運用通貨換算額）
             15  WK-U-KSG-G-SHZ    PIC  S9(15)V9(03).
      *----------  現地その他費用（運用通貨換算額）
             15  WK-U-KSG-G-THY    PIC  S9(15)V9(03).
      *----------  現地源泉税（市場通貨換算額）
             15  WK-S-KSG-G-GSZ    PIC  S9(15)V9(03).
      *----------  現地源泉税（運用通貨換算額）
             15  WK-U-KSG-G-GSZ    PIC  S9(15)V9(03).
      *----------  国内源泉税（運用通貨換算額）
             15  WK-NAI-TAX-U-KSG  PIC  S9(15)V9(03).
      *----------  国内源泉税（市場通貨換算額）
             15  WK-S-KSG-U-GSZ    PIC  S9(15)V9(03).
      *----------  日歩（市場通貨換算額）
             15  WK-S-KSG-HIBU     PIC  S9(15)V9(03).
      *----------  逆日歩（市場通貨換算額）
             15  WK-S-KSG-GHIBU    PIC  S9(15)V9(03).
      *----------  管理費（市場通貨換算額）
             15  WK-S-KSG-KRH      PIC  S9(15)V9(03).
      *----------  管理費消費税（市場通貨換算額）
             15  WK-S-KSG-KRH-SHZ  PIC  S9(15)V9(03).
      *----------  日歩（運用通貨換算額）
             15  WK-U-KSG-HIBU     PIC  S9(15)V9(03).
      *----------  逆日歩（運用通貨換算額）
             15  WK-U-KSG-GHIBU    PIC  S9(15)V9(03).
      *----------  管理費（運用通貨換算額）
             15  WK-U-KSG-KRH      PIC  S9(15)V9(03).
      *----------  管理費消費税（運用通貨換算額）
             15  WK-U-KSG-KRH-SHZ  PIC  S9(15)V9(03).
      *----------  異動確定区分
             15  WK-IDO-KBN        PIC  X(01).
      *----------  商品別取引区分
             15  WK-SHB-TORI-KBN   PIC  X(01).
      *----------  相対取引データ
           10  WK-AITAI-TRHK-DATA.
      *----------  決済約定金額
             15  WK-U-KSG-KS-YJKG  PIC  S9(15)V9(03).
      *----------  権利行使金額
             15  WK-U-KSG-KRKS-KG  PIC  S9(15)V9(03).
      *----------  建時約定金額（市場通貨）
             15  WK-S-KSG-TH-YJKG  PIC  S9(15)V9(03).
      *----------  建時約定金額（運用通貨）
             15  WK-U-KSG-TH-YJKG  PIC  S9(15)V9(03).
      *----------  建時現地手数料（市場通貨）
             15  WK-S-KSG-TH-G-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時現地消費税（市場通貨）
             15  WK-S-KSG-TH-G-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時現地その他費用（市場通貨）
             15  WK-S-KSG-TH-G-THY
                                   PIC  S9(15)V9(03).
      *----------  建時運用国手数料（市場通貨）
             15  WK-S-KSG-TH-U-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時運用国消費税（市場通貨）
             15  WK-S-KSG-TH-U-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時運用国その他費用（市場通貨）
             15  WK-S-KSG-TH-U-THY
                                   PIC  S9(15)V9(03).
      *----------  建時現地手数料（運用通貨）
             15  WK-U-KSG-TH-G-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時現地消費税（運用通貨）
             15  WK-U-KSG-TH-G-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時現地その他費用（運用通貨）
             15  WK-U-KSG-TH-G-THY
                                   PIC  S9(15)V9(03).
      *----------  建時運用国手数料（運用通貨）
             15  WK-U-KSG-TH-U-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時運用国消費税（運用通貨）
             15  WK-U-KSG-TH-U-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時運用国その他費用（運用通貨）
             15  WK-U-KSG-TH-U-THY
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ現地手数料（市場通貨）
             15  WK-S-KSG-HTOP-G-TSR
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ現地消費税（市場通貨）
             15  WK-S-KSG-HTOP-G-SHZ
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ現地その他費用（市場通貨）
             15  WK-S-KSG-HTOP-G-THY
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ現地手数料（運用通貨）
             15  WK-U-KSG-HTOP-G-TSR
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ現地消費税（運用通貨）
             15  WK-U-KSG-HTOP-G-SHZ
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ現地その他費用（運用通貨）
             15  WK-U-KSG-HTOP-G-THY
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ運用国手数料（市場通貨）
             15  WK-S-KSG-HTOP-U-TSR
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ運用国消費税（市場通貨）
             15  WK-S-KSG-HTOP-U-SHZ
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ運用国その他費用（市場通貨）
             15  WK-S-KSG-HTOP-U-THY
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ運用国手数料（運用通貨）
             15  WK-U-KSG-HTOP-U-TSR
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ運用国消費税（運用通貨）
             15  WK-U-KSG-HTOP-U-SHZ
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ運用国その他費用（運用通貨）
             15  WK-U-KSG-HTOP-U-THY
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ現地手数料（市場通貨）
             15  WK-S-KSG-TH-OP-G-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ現地消費税（市場通貨）
             15  WK-S-KSG-TH-OP-G-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ現地その他費用（市場通貨）
             15  WK-S-KSG-TH-OP-G-THY
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ現地手数料（運用通貨）
             15  WK-U-KSG-TH-OP-G-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ現地消費税（運用通貨）
             15  WK-U-KSG-TH-OP-G-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ現地その他費用（運用通貨）
             15  WK-U-KSG-TH-OP-G-THY
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ運用国手数料（市場通貨）
             15  WK-S-KSG-TH-OP-U-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ運用国消費税（市場通貨）
             15  WK-S-KSG-TH-OP-U-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ運用国その他費用（市場通貨）
             15  WK-S-KSG-TH-OP-U-THY
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ運用国手数料（運用通貨）
             15  WK-U-KSG-TH-OP-U-TSR
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ運用国消費税（運用通貨）
             15  WK-U-KSG-TH-OP-U-SHZ
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ運用国その他費用（運用通貨）
             15  WK-U-KSG-TH-OP-U-THY
                                   PIC  S9(15)V9(03).
      *----------  決済単価
             15  WK-KS-TANKA       PIC  S9(08)V9(10).
      *----------  建時現地約定日
             15  WK-TATE-G-YKJ-YMD
                                   PIC  S9(08).
      *----------  権利行使価格
             15  WK-KRKS-KKK       PIC  S9(08)V9(10).
      *----------  建時単価
             15  WK-TATE-TANKA     PIC  S9(08)V9(10).
      *----------  引継ＯＰ約定金額（市場通貨）
             15  WK-S-KSG-HTOP-YJKG
                                   PIC  S9(15)V9(03).
      *----------  引継ＯＰ約定金額（運用通貨）
             15  WK-U-KSG-HTOP-YJKG
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ約定金額（市場通貨）
             15  WK-S-KSG-TH-OP-YJKG
                                   PIC  S9(15)V9(03).
      *----------  建時ＯＰ約定金額（運用通貨）
             15  WK-U-KSG-TH-OP-YJKG
                                   PIC  S9(15)V9(03).
      *----------  資産負債・買建売建フラグ
             15  WK-TATE-FLG       PIC  X(01).
      *----------  異動計算パターン
           10  WK-YIDOU-CALC-PARM.
      *----------  払出簿価計算方法
             15  WK-DEBET-BOKA-CALC-HOU
                                   PIC  X(01).
      *----------  払出簿価端数（市場通貨）
             15  WK-DEBET-BOKA-HASU-BC
                                   PIC  X(01).
      *----------  払出単価桁数（市場通貨）
             15  WK-DEBET-TNK-KETASU-BC
                                   PIC  9(02).
      *----------  払出単価端数（市場通貨）
             15  WK-DEBET-TNK-HASU-BC
                                   PIC  X(01).
      *----------  払出簿価端数（運用通貨）
             15  WK-DEBET-BOKA-HASU-LC
                                   PIC  X(01).
      *----------  払出単価桁数（運用通貨）
             15  WK-DEBET-TNK-KETASU-LC
                                   PIC  9(02).
      *----------  払出単価端数（運用通貨）
             15  WK-DEBET-TNK-HASU-LC
                                   PIC  X(01).
      *----------  簿価為替レート適用フラグ
             15  WK-BOKA-KWS-TEKIYO-FLG
                                   PIC  X(01).
      *----------  簿価為替レート端数
             15  WK-BOKA-KWS-HASU
                                   PIC  X(01).
      *----------  簿価為替レート桁数
             15  WK-BOKA-KWS-KETASU
                                   PIC  9(02).
      *----------  按分簿価端数
             15  WK-ANB-BOKA-HASU  PIC  X(01).
      *----------  按分単価端数
             15  WK-ANB-TNK-HASU   PIC  X(01).
      *----------  按分単価桁数
             15  WK-ANB-TNK-KETASU
                                   PIC  S9(02).
      *----------  前払金償却分端数
             15  WK-MAEKIN-SHOUKYK-HASU
                                   PIC  X(01).
      *----------  売り続く限り同一コスト
             15  WK-URI-TUDUKU-SAME-COST
                                   PIC  X(01).
      *----------  同一日は同一コスト
             15  WK-SAME-YMD-SAME-COST
                                   PIC  X(01).
      *----------  処理順序
             15  WK-SYRI-JUN       PIC  X(01).
      *----------  前払金償却方法
             15  WK-MAEKIN-SHOUKYK-HOU
                                   PIC  X(01).
      *----------  新／旧簿価計算方法
             15  WK-SIN-KYU-BOKA-CALC
                                   PIC  X(01).
      *----------  直前残高異動
           10  WK-TZ-ZN-IDO.
      *----------  利用会社コード
             15  WK-RIYO-CMP-CD    PIC  X(04).
      *----------  原取引ＩＤ
             15  WK-TORI-ID        PIC  S9(10).
      *----------  取引事由
             15  WK-TORI-JIYU      PIC  X(04).
      *----------  赤黒区分
             15  WK-AKA-KBN        PIC  X(01).
      *----------  異動後数量残高
             15  WK-IDOG-SRYZN     PIC  S9(12)V9(06).
      *----------  異動後数量残高(利付)
             15  WK-IDOG-SRYZN-RIT
                                   PIC  S9(12)V9(06).
      *----------  市場通貨異動後簿価残高
             15  WK-SJTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後簿価残高
             15  WK-UYTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨払出単価
             15  WK-SJTK-H-TNK     PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
             15  WK-UYTK-H-TNK     PIC  S9(08)V9(10).
      *----------  計上基準日
             15  WK-KEIJOU-KIJUNBI
                                   PIC  S9(08).
      *----------  異動計上順序
             15  WK-IDO-KJY-JUN    PIC  S9(08).
      *----------  市場通貨簿価単価
             15  WK-SJTK-BOKA-TNK  PIC  S9(08)V9(10).
      *----------  運用通貨簿価単価
             15  WK-UYTK-BOKA-TNK  PIC  S9(08)V9(10).
      *----------  運用通貨異動後建玉精算金額残
             15  WK-UYTK-IDOG-TG-SSKGZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉約定金額残
             15  WK-SJTK-IDOG-TG-YJKNZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉約定金額残
             15  WK-UYTK-IDOG-TG-YJKNZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉手数料残
             15  WK-SJTK-IDOG-TG-TSRZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉手数料残
             15  WK-UYTK-IDOG-TG-TSRZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉消費税残
             15  WK-SJTK-IDOG-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉消費税残
             15  WK-UYTK-IDOG-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉その他費用残
             15  WK-SJTK-IDOG-TG-ELS-HZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉その他費用残
             15  WK-UYTK-IDOG-TG-ELS-HZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉精算金額残
             15  WK-SJTK-IDOG-TG-SSKGZN
                                   PIC  S9(15)V9(03).
      *----------  オプションＬ／Ｓフラグ
             15  WK-OP-L-S-FLG     PIC  X(01).
      *----------  運用通貨異動後前払金残
             15  WK-UYTK-IDOG-PPAYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後前払金残
             15  WK-SJTK-IDOG-PPAYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後前受金残
             15  WK-UYTK-IDOG-ARECZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後前受金残
             15  WK-SJTK-IDOG-ARECZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後仮払金残
             15  WK-UYTK-IDOG-SPAYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後仮払金残
             15  WK-SJTK-IDOG-SPAYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後源泉税還付予定額残高
             15  WK-SJTK-IDOG-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後源泉税還付予定額残高
             15  WK-UYTK-IDOG-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後ノンカバー未収金残高
             15  WK-SJTK-IDOG-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後ノンカバー未収金残高
             15  WK-UYTK-IDOG-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後ノンカバー未払金残高
             15  WK-SJTK-IDOG-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後ノンカバー未払金残高
             15  WK-UYTK-IDOG-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
      *----------  短期スタート・エンド経過利息
             15  WK-SHORT-STEN-KEKA-RSK
                                   PIC  S9(12)V9(06).
      *----------  短期スタート日
             15  WK-SHORT-START-YMD
                                   PIC  9(08).
      *----------  短期エンド日
             15  WK-SHORT-END-YMD  PIC  9(08).
      *----------  市場通貨引継前受・前払プレミアム
             15  WK-SJTK-HT-PPAR-PMM
                                   PIC  S9(15)V9(03).
      *----------  運用通貨引継前受・前払プレミアム
             15  WK-UYTK-HT-PPAR-PMM
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後未払費用残
             15  WK-SJTK-IDOG-MBHYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後未払費用残
             15  WK-UYTK-IDOG-MBHYZN
                                   PIC  S9(15)V9(03).
      *---------- 市場通貨異動後未払消費税残
             15  WK-SJTK-IDOG-MB-S-TAXZN
                                   PIC  S9(15)V9(03).
      *---------- 運用通貨異動後未払消費税残
             15  WK-UYTK-IDOG-MB-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後移管評価損益残
             15  WK-SJTK-IDOG-IK-HKSEZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管評価損益残
             15  WK-UYTK-IDOG-IK-HKSEZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後移管未収収益
             15  WK-SJTK-IDOG-IK-MSSHEKI
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管未収収益
             15  WK-UYTK-IDOG-IK-MSSHEKI
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管前払金評価損益残
             15  WK-UYTK-IDOG-IK-PPHKZN
                                   PIC  S9(15)V9(03).
      *----------  決済通貨異動後源泉税還付予定額残高
             15  WK-KSTK-IDOG-GSZKP-YTZN
                                   PIC  S9(12)V9(06).
      *----------  ＯＰ資産負債・買建売建フラグ
             15  WK-OP-TATE-FLG    PIC  X(01).
      *----------  市場通貨コード
             15  WK-SI-TU-CD       PIC  X(04).
      *----------  数量単位
             15  WK-SURYO-TANI     PIC  S9(12)V9(06).
      *----------  建玉単価
             15  WK-TGYOKU-TNK     PIC  S9(08)V9(10).
      *----------  建玉為替レート
             15  WK-TGYOKU-KWS-RATE
                                   PIC  S9(08)V9(10).
      *----------  建玉ブローカー
             15  WK-TGYOKU-BRK     PIC  X(04).
      *----------  建玉約定日
             15  WK-TGYOKU-YKJ-YMD PIC  S9(08).
      *----------  通貨デフォールト端数処理
           10  WK-TUKA-DEF-HASU-SYRI-PARM.
      *----------  運用通貨端数処理方法
             15  WK-LC-HS          PIC  X(01).
      *----------  運用通貨小数点以下桁数
             15  WK-LC-SYOSU-TENYIKA-KETASU
                                   PIC  9(02).
      *----------  市場通貨端数処理方法
             15  WK-BC-HS          PIC  X(01).
      *----------  市場通貨小数点以下桁数
             15  WK-BC-SYOSU-TENYIKA-KETASU
                                   PIC  9(02).
      *----------  基準日断面情報
           10  WK-KYJ-YMD-DMN-INFO.
      *----------  処理実行日
             15  WK-SYORI-YMD      PIC  S9(08).
      *----------  起動ID
             15  WK-KIDOU-ID       PIC  X(04).
      *----------  利用会社コード
             15  WK-RIYO-CMP-CD    PIC  X(04).
      *----------  開始基準日の翌日
             15  WK-KAISI-KJN-YMD-NEXT
                                   PIC  S9(08).
      *----------  約定レートコード
             15  WK-YKJ-RATE-CD    PIC  X(04).
      *----------  ファンドコード
             15  WK-FUND-CD        PIC  X(12).
      *----------  ポートフォリオコード
             15  WK-PTF-CD         PIC  X(04).
      *----------  仕訳基準パターンコード
             15  WK-SWK-KJN-PTN-CD
                                   PIC  X(08).
      *----------  基本会計ベースフラグ
             15  WK-KH-KAIKEI-BASE-FLG
                                   PIC  X(01).
      *----------  約定主義会計フラグ
             15  WK-YKJ-SYUGI-KAIKEI
                                   PIC  X(01).
      *----------  キャッシュフロー２回発生区分
             15  WK-CASH-FLOW-KBN  PIC  X(01).
      *----------  保有目的
             15  WK-POSSESSION-OBJECT
                                   PIC  X(01).
      *----------  証券種別コード
             15  WK-SEC-SBT-CD     PIC  X(04).
      *----------  運用通貨コード
             15  WK-UYTK-CD        PIC  X(04).
      *----------  測定基準区分
             15  WK-ST-KJN-KBN     PIC  X(01).
      *----------  開始基準日
             15  WK-KAISI-KJN-YMD  PIC  S9(08).
      *----------  基準日
             15  WK-KJN-YMD        PIC  S9(08).
      *----------  銘柄別断面情報
           10  WK-MEG-BETU-DMN-INFO.
      *----------  処理実行日
             15  WK-SYORI-YMD      PIC  S9(08).
      *----------  起動ID
             15  WK-KIDOU-ID       PIC  X(04).
      *----------  利用会社コード
             15  WK-RIYO-CMP-CD    PIC  X(04).
      *----------  ファンドコード
             15  WK-FUND-CD        PIC  X(12).
      *----------  ポートフォリオコード
             15  WK-PTF-CD         PIC  X(04).
      *----------  開始基準日
             15  WK-KAISI-KJN-YMD  PIC  9(08).
      *----------  基準日
             15  WK-KJN-YMD        PIC  9(08).
      *----------  銘柄コード
             15  WK-MEG-CD         PIC  X(15).
      *----------  証券種別コード
             15  WK-SEC-SBT-CD     PIC  X(04).
      *----------  資産負債・買建売建フラグ
             15  WK-TATE-FLG       PIC  X(01).
      *----------  玉ID
             15  WK-GYOKU-ID       PIC  X(10).
      *----------  差分更新From日
             15  WK-SABON-UPDATE-FROM
                                   PIC  9(08).
      *----------  再計算区分
             15  WK-SAI-CALC-KBN   PIC  X(01).
      *----------  銘柄種類２
             15  WK-MEG-CD-SHRU2   PIC  X(01).
      *----------  対象取引情報
           10  WK-TARGET-TORI-INFO.
      *----------  処理順
             15  WK-SRJUN          PIC  S9(08).
      *----------  原取引ＩＤ
             15  WK-TORI-ID        PIC  S9(10).
      *----------  計上基準日
             15  WK-KEIJOU-KIJUNBI
                                   PIC  S9(08).
      *----------  増幅区分
             15  WK-ZOFKU-KBN      PIC  X(01).
      *----------  増幅赤黒区分
             15  WK-ZOFKU-AKA-KBN  PIC  X(01).
      *----------  換算後為替レート(市場／運用)
             15  WK-K-S-U-KWS      PIC  S9(18)V9(18).
      *----------  換算後経過利息為替レート
             15  WK-K-KEKA-RSK-KWS PIC  S9(08)V9(10).
      *----------  受渡日
             15  WK-UKE-YMD        PIC  9(08).
      *----------  売り続く限りフラグ
           10  WK-URI-TUDUKU-KAGI-FLG
                                   PIC  X(01).
      *----------  市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *----------  勘定科目出力商品名
           10  WK-KNJ-KAMK-OUT-SYOHIN
                                   PIC  X(04).
      *----------  仕訳基準データ
           10  WK-SWK-KJN-DATA.
      *---------- 為替差損益計上区分
             15  WK-UKS-KJY-KBN    PIC  X(01).
      *----------  手数料用売買損益に含むフラグ
             15  WK-TESRY-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  消費税用売買損益に含むフラグ
             15  WK-SHOHI-TAX-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  その他費用用売買損益に含むフラグ
             15  WK-ELS-HIYO-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  日歩用売買損益に含むフラグ
             15  WK-HIBU-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  逆日歩用売買損益に含むフラグ
             15  WK-GHIBU-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  管理費用売買損益に含むフラグ
             15  WK-KRH-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  管理費消費税用売買損益に含むフラグ
             15  WK-KRH-SHZ-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  手数料を市場取得金額に含めるフラグ
             15  WK-TESRY-SJST-KN-FLG
                                   PIC  X(01).
      *----------  消費税を市場取得金額に含めるフラグ
             15  WK-SHOHI-TAX-SJST-KN-FLG
                                   PIC  X(01).
      *----------  その他費用を市場取得金額に含めるフラグ
             15  WK-ELS-HIYO-SJST-KN-FLG
                                   PIC  X(01).
      *----------  日歩を市場取得金額に含めるフラグ
             15  WK-KSG-HIBU-SJST-KN-FLG
                                   PIC  X(01).
      *----------  逆日歩を市場取得金額に含めるフラグ
             15  WK-KSG-GHIBU-SJST-KN-FLG
                                   PIC  X(01).
      *----------  管理費を市場取得金額に含めるフラグ
             15  WK-KSG-SJST-KN-FLG
                                   PIC  X(01).
      *----------  管理費消費税を市場取得金額に含めるフラグ
             15  WK-KSG-KRH-SJST-KN-FLG
                                   PIC  X(01).
      *----------  キャッシュフロー2回有効フラグ
           10  WK-CASH-FLOW-2-FLG  PIC  X(01).
      *----------  銘柄属性取得フラグ
           10  WK-MEG-ZOK-FLG      PIC  X(01).
      *----------  約定ベース受渡順フラグ
           10  WK-YKJ-UKE-JUN-FLG  PIC  X(01).
      *---------- 乗算/除算区分
           10  WK-JZ-JS-KBN-IN     PIC  X(01).
      *---------- 銘柄属性コールプット区分
           10  WK-MEG-CALL-PUT-KBN PIC  X(01).
      *---------- ゼロクーポン債フラグ
           10  WK-ZERO-CUPON-FLG   PIC  9(01).
      *----------  銘柄属性データ
           10  WK-MEG-SKJO-DATA.
      *---------- 初期利払起算日
             15  WK-SHOKI-RIBAR-KS-YMD
                                   PIC  S9(08).
      *---------- 初期利払日
             15  WK-SHOKI-RIBAR-YMD
                                   PIC  S9(08).
      *---------- 最終利払起算日
             15  WK-LAST-RIBAR-KISAN-YMD
                                   PIC  S9(08).
      *---------- 最終利払日
             15  WK-LAST-RIBAR-YMD
                                   PIC  S9(08).
      *----------  利払回数
             15  WK-RIBAR-KAISU    PIC  X(02).
      *----------  利払日１
             15  WK-RIBAR-YMD-1    PIC  9(04).
      *----------  利払日２
             15  WK-RIBAR-YMD-2    PIC  9(04).
      *----------  利払日３
             15  WK-RIBAR-YMD-3    PIC  9(04).
      *----------  利払日４
             15  WK-RIBAR-YMD-4    PIC  9(04).
      *----------  利払日休日処理区分
             15  WK-RIBAR-YMD-QJT-SR-KBN
                                   PIC  X(01).
      *----------  初期利払日休日処理区分
             15  WK-SHOKI-RB-YMD-QJT-KBN
                                   PIC  X(01).
      *----------  終期利払日休日処理区分
             15  WK-SHUKI-RB-YMD-QJT-KBN
                                   PIC  X(01).
      *----------  勘定異動／残高作成
           10  WK-KJIDO-ZANSK      PIC  9(01).
      *---------- 利付／割引区分
           10  WK-RITUKI-WARI-KBN  PIC  X(01).
      *----------  国内外国区分
           10  WK-NAI-GAI-KBN      PIC  X(01).
      *---------- 決済口座１通貨コード
           10  WK-KOZA1-TUKA-CD    PIC  X(04).
      *---------- 決済口座２通貨コード
           10  WK-KOZA2-TUKA-CD    PIC  X(04).
      *---------- 入出金額（決済レート・運用通貨換算額）
           10  WK-NSKG-K-UY        PIC  S9(15)V9(03).
      *---------- 決済口座１入出金額
           10  WK-KOZA1-NSKG       PIC  S9(15)V9(03).
           10  WK-MEG-SKJO-DATA-2.
      *----------  償還日
             15  WK-SHOKAN-YMD     PIC  S9(08).
      *----------  償還日休日処理区分
             15  WK-SHOKAN-QJT-SYRI-KBN
                                   PIC  X(01).
           10  WK-MEG-SKJO-DATA-3.
      *----------  利払日数
             15  WK-KEKA-NISU      PIC  9(03).
      *----------  ワーク計算パターン
         05  WK-CALC-PTN.
      *----------  数量計算方法
           10  WK-SURYO-CALC-HOU   PIC  9(03).
      *----------  簿価計算方法
           10  WK-BOKA-CALC-HOU    PIC  9(03).
      *----------  前払金計算方法
           10  WK-MAEBR-KIN-CALC-HOU
                                   PIC  9(03).
      *----------  売買損益計算方法
           10  WK-BBSONEKI-CALC-HOU
                                   PIC  9(03).
      *----------  その他損益計算方法
           10  WK-ELS-SNEKI-CALC-HOU
                                   PIC  9(03).
      *----------  損益勘定計算方法
           10  WK-RKSEKJ-CALC-HOU  PIC  9(03).
      *----------  建玉計算方法
           10  WK-TGYOKU-CALC-HOU  PIC  9(03).
      *----------  源泉税還付計算方法
           10  WK-GSZKP-CALC-HOU   PIC  9(03).
      *----------  ノンカバー未収未払計算方法
           10  WK-NONCOV-MSMH-CALC-HOU
                                   PIC  9(03).
      *----------  未払費用計算方法
           10  WK-MISYU-HIYO-CALC-HOU
                                   PIC  9(03).
      *----------  移管項目計算
           10  WK-IKAN-KMOK-CALC   PIC  9(03).
      *----------  損益仕訳フラグパッケージ
         05  WK-SNEKI-SWK-FLG-PACKAGE.
      *----------  売買損益フラグ
           10  WK-BBSONEKI-FLG     PIC  9(01).
      *----------  雑損益フラグ
           10  WK-ZA-SNEKI-FLG     PIC  9(01).
      *----------  為替差損益フラグ
           10  WK-UYTK-KWS-SNEKI-FLG
                                   PIC  9(01).
      *----------  ワーク計算詳細
         05  WK-CALC-SYOSAI.
      *----------  計算詳細明細
           10  WK-CALC-SYOSAI-MEISAI
                                   OCCURS  200.
      *----------  計算種類
             15  WK-CALC-SHRU      PIC  X(02).
      *----------  計算項番
             15  WK-CALC-KOUB      PIC  9(03).
      *----------  素データ数
             15  WK-SO-DATA-SU     PIC  9(02).
      *----------  詳細
             15  WK-SYOSAI.
      *----------  素データ詳細
               20  WK-SO-DATA-SYOSAI
                                   OCCURS  10.
      *----------  素データ
                 25  WK-SO-DATA.
      *----------  1桁目
                   30  WK-1-KETA   PIC  X(01).
      *----------  2桁目
                   30  WK-2-KETA   PIC  9(02).
      *----------  ワーク素データ分析結果
         05  WK-SO-DATA-BENSEKI-KEKKA.
      *----------  a01取引フラグ
           10  WK-TORI-FLG         PIC  X(01).
      *----------  a02相対取引フラグ
           10  WK-AITAI-TORI-FLG   PIC  X(01).
      *----------  a03親株取引フラグ
           10  WK-O-TORI-FLG       PIC  X(01).
      *----------  a04新株取引フラグ
           10  WK-N-TORI-FLG       PIC  X(01).
      *----------  a07取引分析-オプションフラグ
           10  WK-TORI-BUNSEKI-OPT-FLG
                                   PIC  X(01).
      *----------  a08直前取引フラグ
           10  WK-CHOKZ-TORI-FLG   PIC  X(01).
      *----------  a09取引分析-先物フラグ
           10  WK-TORI-BUNSEKI-FT-FLG
                                   PIC  X(01).
      *----------  a10取引分析-未収未払フラグ
           10  WK-TORI-BUNSEKI-MSMH-FLG
                                   PIC  X(01).
      *----------  a11取引分析-為替差損益フラグ
           10  WK-TRBNSEKI-KWSNEKI-FLG
                                   PIC  X(01).
      *----------  b01直前残高異動フラグ
           10  WK-CHOKZ-ZADAKA-IDOU-FLG
                                   PIC  X(01).
      *----------  b02直前親株残高異動フラグ
           10  WK-CHOKZ-O-ZADAKA-IDOU-FLG
                                   PIC  X(01).
      *----------  b06直前新株残高異動フラグ
           10  WK-CHOKZ-S-ZADAKA-IDOU-FLG
                                   PIC  X(01).
      *----------  c01通貨フラグ
           10  WK-TUKA-FLG         PIC  X(01).
      *----------  c02異動計算フラグ
           10  WK-IDO-CALC-FLG     PIC  X(01).
      *----------  c04仕訳基準フラグ
           10  WK-SWK-KJN-FLG      PIC  X(01).
      *----------  c05仕訳パターン分析フラグ
           10  WK-SWK-PATTERN-BUNSEKI-FLG
                                   PIC  X(01).
      *----------  c06引継元仕訳基準フラグ
           10  WK-HT-SWK-KJN-FLG   PIC  X(01).
      *----------  d01数量計算結果フラグ
           10  WK-SURYO-CALC-KEKKA-FLG
                                   PIC  X(01).
      *----------  d02簿価計算結果フラグ
           10  WK-BOKA-CALC-KEKKA-FLG
                                   PIC  X(01).
      *----------  d03建玉計算結果フラグ
           10  WK-TGYOKU-CALC-KEKKA-FLG
                                   PIC  X(01).
      *----------  d04前払金計算結果フラグ
           10  WK-MAEBR-KIN-CALC-KEKKA-FLG
                                   PIC  X(01).
      *----------  e03個別計算３フラグ
           10  WK-KOBETSU-CALC-3-FLG
                                   PIC  X(01).
      *----------  e05個別計算５フラグ
           10  WK-KOBETSU-CALC-5-FLG
                                   PIC  X(01).
      *----------  e06個別計算６フラグ
           10  WK-KOBETSU-CALC-6-FLG
                                   PIC  X(01).
      *----------  e07個別計算７フラグ
           10  WK-KOBETSU-CALC-7-FLG
                                   PIC  X(01).
      *----------  e08個別計算８フラグ
           10  WK-KOBETSU-CALC-8-FLG
                                   PIC  X(01).
      *----------  e09個別計算９フラグ
           10  WK-KOBETSU-CALC-9-FLG
                                   PIC  X(01).
      *----------  e10個別計算１０フラグ
           10  WK-KOBETSU-CALC-10-FLG
                                   PIC  X(01).
      *----------  e11個別計算１１フラグ
           10  WK-KOBETSU-CALC-11-FLG
                                   PIC  X(01).
      *----------  e13個別計算１３フラグ
           10  WK-KOBETSU-CALC-13-FLG
                                   PIC  X(01).
      *----------  e14個別計算１４フラグ
           10  WK-KOBETSU-CALC-14-FLG
                                   PIC  X(01).
      *----------  e15個別計算１５フラグ
           10  WK-KOBETSU-CALC-15-FLG
                                   PIC  X(01).
      *----------  e16個別計算１６フラグ
           10  WK-KOBETSU-CALC-16-FLG
                                   PIC  X(01).
      *----------  e17個別計算１７フラグ
           10  WK-KOBETSU-CALC-17-FLG
                                   PIC  X(01).
      *----------  e18個別計算１８フラグ
           10  WK-KOBETSU-CALC-18-FLG
                                   PIC  X(01).
      *----------  e19個別計算１９フラグ
           10  WK-KOBETSU-CALC-19-FLG
                                   PIC  X(01).
      *----------  e20個別計算２０フラグ
           10  WK-KOBETSU-CALC-20-FLG
                                   PIC  X(01).
      *----------  e21個別計算２１フラグ
           10  WK-KOBETSU-CALC-21-FLG
                                   PIC  X(01).
      *----------  e22個別計算２２フラグ
           10  WK-KOBETSU-CALC-22-FLG
                                   PIC  X(01).
      *----------  f01売買金額フラグ
           10  WK-BS-KN-FLG        PIC  X(01).
      *----------  ワーク取引分析-オプション
         05  WK-TORI-BUNSEKI-OPT.
      *----------  コール／プットフラグ
           10  WK-CALL-PUT-FLG     PIC  X(01).
      *----------  ワーク取引分析-先物
         05  WK-TORI-BUNSEKI-FT.
      *----------  権利行使・割当フラグ
           10  WK-KRKS-WARIATE-FLG
                                   PIC  X(01).
      *----------  ワーク取引分析-未収未払
         05  WK-TORI-BUNSEK-MSMH.
      *----------  未収未払フラグ
           10  WK-MISYU-MIHAR-FLG  PIC  X(01).
      *----------  ワーク為替差損益フラグ
         05  WK-KWS-SNEKI-FLG      PIC  X(01).
      *----------  ワーク仕訳基準
         05  WK-SWK-KJN.
      *----------  為替差損益の計上フラグ
           10  WK-UYTK-KWS-SNEKI-FLG
                                   PIC  X(01).
      *----------  手数料用売買損益に含むフラグ
           10  WK-TESRY-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  消費税用売買損益に含むフラグ
           10  WK-SHOHI-TAX-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  その他費用用売買損益に含むフラグ
           10  WK-ELS-HIYO-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  日歩用売買損益に含むフラグ
           10  WK-HIBU-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  逆日歩用売買損益に含むフラグ
           10  WK-GHIBU-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  管理費用売買損益に含むフラグ
           10  WK-KRH-BBSNEKI-FLG  PIC  X(01).
      *----------  管理費消費税用売買損益に含むフラグ
           10  WK-KRH-SHZ-BBSNEKI-FLG
                                   PIC  X(01).
      *----------  手数料を市場取得金額に含めるフラグ
           10  WK-TESRY-SJST-KN-FLG
                                   PIC  X(01).
      *----------  消費税を市場取得金額に含めるフラグ
           10  WK-SHOHI-TAX-SJST-KN-FLG
                                   PIC  X(01).
      *----------  その他費用を市場取得金額に含めるフラグ
           10  WK-ELS-HIYO-SJST-KN-FLG
                                   PIC  X(01).
      *----------  日歩を市場取得金額に含めるフラグ
           10  WK-KSG-HIBU-SJST-KN-FLG
                                   PIC  X(01).
      *----------  逆日歩を市場取得金額に含めるフラグ
           10  WK-KSG-GHIBU-SJST-KN-FLG
                                   PIC  X(01).
      *----------  管理費を市場取得金額に含めるフラグ
           10  WK-KSG-SJST-KN-FLG  PIC  X(01).
      *----------  管理費消費税を市場取得金額に含めるフラグ
           10  WK-KSG-KRH-SJST-KN-FLG
                                   PIC  X(01).
      *----------  ワーク仕訳パターン分析
         05  WK-SWK-PATTERN-BUNSEKI.
      *----------  仕訳フラグ
           10  WK-SWK-FLG          PIC  X(01).
      *----------  ワーク数量計算結果
         05  WK-SURYO-CALC-KEKKA.
      *----------  異動数量
           10  WK-IDO-SURYO        PIC  S9(12)V9(06).
      *----------  異動数量(利付)
           10  WK-IDO-SURYO-RIT    PIC  S9(12)V9(06).
      *----------  異動後数量残高
           10  WK-IDOG-SRYZN       PIC  S9(12)V9(06).
      *----------  異動後数量残高(利付)
           10  WK-IDOG-SRYZN-RIT   PIC  S9(12)V9(06).
      *----------  ワーク前払金計算結果
         05  WK-MAEBR-KIN-CALC-KEKKA.
      *----------  市場通貨前払金異動額
           10  WK-SJTK-PPAYIDOG    PIC  S9(15)V9(03).
      *----------  運用通貨前払金異動額
           10  WK-UYTK-PPAYIDOG    PIC  S9(15)V9(03).
      *----------  市場通貨異動後前払金残
           10  WK-SJTK-IDOG-PPAYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後前払金残
           10  WK-UYTK-IDOG-PPAYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後前受金残
           10  WK-SJTK-IDOG-ARECZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後前受金残
           10  WK-UYTK-IDOG-ARECZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後仮払金残
           10  WK-SJTK-IDOG-SPAYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後仮払金残
           10  WK-UYTK-IDOG-SPAYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨前払金償却額（マイナス期間分）
           10  WK-SJTK-PPAY-SKK-MINU-KKN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨前払金償却額（マイナス期間分）
           10  WK-UYTK-PPAY-SKK-MINU-KKN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨前払金償却額（プラス期間分）
           10  WK-SJTK-PPAY-SKK-PULS-KKN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨前払金償却額（プラス期間分）
           10  WK-UYTK-PPAY-SKK-PULS-KKN
                                   PIC  S9(15)V9(03).
      *----------  直前の前払金未償却数量サマリ
           10  WK-TZ-MK-MSKK-SRY-SUM
                                   PIC  S9(12)V9(06).
      *----------  直前の前払金未償却数量サマリ（利金）
           10  WK-TZ-MK-MSKK-SRY-RIKIN-SUM
                                   PIC  S9(12)V9(06).
      *----------  売却パタン
           10  WK-BAKYK-PTN        PIC  S9(01).
      *----------  購入パタン
           10  WK-KOUNYU-PTN       PIC  S9(01).
      *----------  ワーク簿価計算結果
         05  WK-BOKA-CALC-KEKKA.
      *----------  市場通貨異動簿価
           10  WK-SJTK-IDO-BOKA    PIC  S9(15)V9(03).
      *----------  運用通貨異動簿価
           10  WK-UYTK-IDO-BOKA    PIC  S9(15)V9(03).
      *----------  市場通貨簿価単価
           10  WK-SJTK-BOKA-TNK    PIC  S9(08)V9(10).
      *----------  運用通貨簿価単価
           10  WK-UYTK-BOKA-TNK    PIC  S9(08)V9(10).
      *----------  簿価為替レート
           10  WK-BOKA-KWS         PIC  S9(08)V9(10).
      *----------  市場通貨払出簿価
           10  WK-SJTK-H-BOKA      PIC  S9(15)V9(03).
      *----------  運用通貨払出簿価
           10  WK-UYTK-H-BOKA      PIC  S9(15)V9(03).
      *----------  市場通貨払出単価
           10  WK-SJTK-H-TNK       PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  WK-UYTK-H-TNK       PIC  S9(08)V9(10).
      *----------  市場通貨異動後簿価残高
           10  WK-SJTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後簿価残高
           10  WK-UYTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  ワーク売買損益計算結果
         05  WK-BBSONEKI-CALC-KEKKA.
      *----------  市場通貨売買損益
           10  WK-SJTK-BBSNEKI     PIC  S9(15)V9(03).
      *----------  運用通貨売買損益
           10  WK-UYTK-BBSNEKI     PIC  S9(15)V9(03).
      *----------  為替差損益
           10  WK-UYTK-KWS-SNEKI   PIC  S9(15)V9(03).
      *----------  為替差損益（市場）
           10  WK-UYTK-KWS-SNEKI-SJ
                                   PIC  S9(15)V9(03).
      *----------  為替差損益（利金）
           10  WK-UYTK-KWS-SNEKI-RK
                                   PIC  S9(15)V9(03).
      *----------  ワークその他損益計算結果
         05  WK-ELS-SNEKI-CALC-KEKKA.
      *----------  市場通貨手数料
           10  WK-SJTK-TSR         PIC  S9(15)V9(03).
      *----------  運用通貨手数料
           10  WK-UYTK-TSR         PIC  S9(15)V9(03).
      *----------  市場通貨消費税
           10  WK-SJTK-S-TAX       PIC  S9(15)V9(03).
      *----------  運用通貨消費税
           10  WK-UYTK-S-TAX       PIC  S9(15)V9(03).
      *----------  市場通貨その他損益
           10  WK-SJTK-ELS-SNEKI   PIC  S9(15)V9(03).
      *----------  運用通貨その他損益
           10  WK-UYTK-ELS-SNEKI   PIC  S9(15)V9(03).
      *----------  市場通貨源泉税
           10  WK-SJTK-GENSEN-TAX  PIC  S9(15)V9(03).
      *----------  運用通貨源泉税
           10  WK-UYTK-GENSEN-TAX  PIC  S9(15)V9(03).
      *----------  ワーク損益勘定計算結果
         05  WK-RKSEKJ-CALC-KEKKA.
      *----------  市場通貨利金等損益勘定
           10  WK-SJTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  運用通貨利金等損益勘定
           10  WK-UYTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  為替差損益（利金）
           10  WK-UYTK-KWS-SNEKI-RK
                                   PIC  S9(15)V9(03).
      *----------  ワーク源泉税還付予定計算結果
         05  WK-GSZKP-YT-CALC-KEKKA.
      *----------  市場通貨源泉税還付予定異動額
           10  WK-SJTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  運用通貨源泉税還付予定異動額
           10  WK-UYTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後源泉税還付予定額残高
           10  WK-SJTK-IDOG-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後源泉税還付予定額残高
           10  WK-UYTK-IDOG-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
      *----------  決済通貨源泉税還付予定異動額
           10  WK-KSTK-GSZKP-YTIDOG
                                   PIC  S9(12)V9(06).
      *----------  決済通貨異動後源泉税還付予定額残高
           10  WK-KSTK-IDOG-GSZKP-YTZN
                                   PIC  S9(12)V9(06).
      *----------  為替差損益
           10  WK-UYTK-KWS-SNEKI   PIC  S9(15)V9(03).
      *----------  為替差損益（市場）
           10  WK-UYTK-KWS-SNEKI-SJ
                                   PIC  S9(15)V9(03).
      *----------  市場通貨利金等損益勘定
           10  WK-SJTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  運用通貨利金等損益勘定
           10  WK-UYTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  ワーク建玉計算結果
         05  WK-TGYOKU-CALC-KEKKA.
      *----------  市場通貨異動後建玉約定金額残
           10  WK-SJTK-IDOG-TG-YJKNZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉約定金額残
           10  WK-UYTK-IDOG-TG-YJKNZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉手数料
           10  WK-SJTK-TG-TSR      PIC  S9(15)V9(03).
      *----------  運用通貨建玉手数料
           10  WK-UYTK-TG-TSR      PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉手数料残
           10  WK-SJTK-IDOG-TG-TSRZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉手数料残
           10  WK-UYTK-IDOG-TG-TSRZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉消費税
           10  WK-SJTK-TG-S-TAX    PIC  S9(15)V9(03).
      *----------  運用通貨建玉消費税
           10  WK-UYTK-TG-S-TAX    PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉消費税残
           10  WK-SJTK-IDOG-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉消費税残
           10  WK-UYTK-IDOG-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉その他費用
           10  WK-SJTK-TG-ELS-HIYO
                                   PIC  S9(15)V9(03).
      *----------  運用通貨建玉その他費用
           10  WK-UYTK-TG-ELS-HIYO
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉その他費用残
           10  WK-SJTK-IDOG-TG-ELS-HZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉その他費用残
           10  WK-UYTK-IDOG-TG-ELS-HZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉精算金額
           10  WK-SJTK-TG-SSKG     PIC  S9(15)V9(03).
      *----------  運用通貨建玉精算金額
           10  WK-UYTK-TG-SSKG     PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉精算金額残
           10  WK-SJTK-IDOG-TG-SSKGZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉精算金額残
           10  WK-UYTK-IDOG-TG-SSKGZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動簿価
           10  WK-SJTK-IDO-BOKA    PIC  S9(15)V9(03).
      *----------  運用通貨異動簿価
           10  WK-UYTK-IDO-BOKA    PIC  S9(15)V9(03).
      *----------  市場通貨引継前受・前払プレミアム
           10  WK-SJTK-HT-PPAR-PMM
                                   PIC  S9(15)V9(03).
      *----------  運用通貨引継前受・前払プレミアム
           10  WK-UYTK-HT-PPAR-PMM
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後簿価残高
           10  WK-SJTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後簿価残高
           10  WK-UYTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  オプションＬ／Ｓフラグ
           10  WK-OP-L-S-FLG       PIC  X(01).
      *----------  ワークノンカバー未収未払計算結果
         05  WK-NONCOV-MSMH-CALC-KEKA .
      *----------  市場通貨異動後ノンカバー未収金残高
           10  WK-SJTK-IDOG-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後ノンカバー未収金残高
           10  WK-UYTK-IDOG-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後ノンカバー未払金残高
           10  WK-SJTK-IDOG-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後ノンカバー未払金残高
           10  WK-UYTK-IDOG-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
      *----------  ワーク未払費用計算結果
         05  WK-MISYU-HIYO-CALC-KEKKA .
      *----------  市場通貨異動後未払費用残
           10  WK-SJTK-IDOG-MBHYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後未払費用残
           10  WK-UYTK-IDOG-MBHYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後未払消費税残
           10  WK-SJTK-IDOG-MB-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後未払消費税残
           10  WK-UYTK-IDOG-MB-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  ワーク移管項目計算結果
         05  WK-IKAN-KMOK-CALC-KEKKA.
      *----------  市場通貨異動後移管評価損益残
           10  WK-SJTK-IDOG-IK-HKSEZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管評価損益残
           10  WK-UYTK-IDOG-IK-HKSEZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後移管未収収益
           10  WK-SJTK-IDOG-IK-MSSHEKI
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管未収収益
           10  WK-UYTK-IDOG-IK-MSSHEKI
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管前払金評価損益残
           10  WK-UYTK-IDOG-IK-PPHKZN
                                   PIC  S9(15)V9(03).
      *----------  ワーク直前取引
         05  WK-CHOKZ-TORI .
      *----------  １口注文ＩＤ
           10  WK-ORDR-1K-ID       PIC  S9(10).
      *----------  ワーク直前親株残高異動
         05  WK-CHOKZ-O-ZADAKA-IDOU.
      *----------  市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *----------  異動後数量残高
           10  WK-IDOG-SRYZN       PIC  S9(12)V9(06).
      *----------  市場通貨異動後簿価残高
           10  WK-SJTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後簿価残高
           10  WK-UYTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  数量単位
           10  WK-SURYO-TANI       PIC  S9(12)V9(06).
      *----------  ワーク直前新株残高異動
         05  WK-CHOKZ-S-ZADAKA-IDOU.
      *----------  異動後数量残高
           10  WK-IDOG-SRYZN       PIC  S9(12)V9(06).
      *----------  市場通貨異動後簿価残高
           10  WK-SJTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後簿価残高
           10  WK-UYTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  ワーク親株取引
         05  WK-OKB-TORI-PARM.
      *----------  異動数量
           10  WK-IDO-SURYO        PIC  S9(12)V9(06).
      *----------  精算金額(市場通貨換算額)
           10  WK-S-KSG-SSKG       PIC  S9(15)V9(03).
      *----------  精算金額(運用通貨換算額)
           10  WK-U-KSG-G-SSKG     PIC  S9(15)V9(03).
      *----------  ワーク新株取引
         05  WK-SKB-TORI-PARM.
      *----------  異動数量
           10  WK-IDO-SURYO        PIC  S9(12)V9(06).
      *----------  為替レート（市場／運用）
           10  WK-S-U-KWS          PIC  S9(08)V9(10).
      *----------  換算後為替レート（市場／運用）
           10  WK-K-S-U-KWS        PIC  S9(18)V9(18).
      *----------  約定金額(市場通貨換算額)
           10  WK-S-KSG-G-YJKG     PIC  S9(15)V9(03).
      *----------  約定金額(運用通貨換算額)
           10  WK-U-KSG-G-YJKG     PIC  S9(15)V9(03).
      *----------  市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *----------  約定単価
           10  WK-YKJ-TANKA        PIC  S9(08)V9(10).
      *----------  数量単位
           10  WK-SURYO-TANI       PIC  S9(12)V9(06).
      *----------  C/A位置付けフラグ
         05  WK-CA-POS-FLG         PIC  X(01).
      *----------  ワーク残高異動計算データ
         05  WK-ZN-IDO-CALC-DATE.
      *----------  処理実行日
           10  WK-SYORI-YMD        PIC  S9(08).
      *----------  起動ID
           10  WK-KIDOU-ID         PIC  X(04).
      *----------  利用会社コード
           10  WK-RIYO-CMP-CD      PIC  X(04).
      *----------  ファンドコード
           10  WK-FUND-CD          PIC  X(12).
      *----------  ポートフォリオコード
           10  WK-PTF-CD           PIC  X(04).
      *----------  原取引ID
           10  WK-TORI-ID          PIC  S9(10).
      *----------  計上基準日
           10  WK-KEIJOU-KIJUNBI   PIC  S9(08).
      *----------  赤黒区分
           10  WK-AKA-KBN          PIC  X(01).
      *----------  誤計上№
           10  WK-ERR-KJY-NO       PIC  S9(10).
      *----------  誤計上区分
           10  WK-ERR-KJY-KBN      PIC  X(01).
      *----------  取引連関ID
           10  WK-THRK-ID          PIC  S9(10).
      *----------  証券種別コード
           10  WK-SEC-SBT-CD       PIC  X(04).
      *----------  取引内容
           10  WK-TORI-NAIY        PIC  X(04).
      *----------  取引事由
           10  WK-TORI-JIYU        PIC  X(04).
      *----------  市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *----------  銘柄コード
           10  WK-MEG-CD           PIC  X(15).
      *----------  資産負債・買建売建フラグ
           10  WK-TATE-FLG         PIC  X(01).
      *----------  玉ＩＤ
           10  WK-GYOKU-ID         PIC  X(10).
      *----------  約定日
           10  WK-YKJ-YMD          PIC  S9(08).
      *----------  受渡日
           10  WK-UKE-YMD          PIC  S9(08).
      *----------  市場通貨異動簿価
           10  WK-SJTK-IDO-BOKA    PIC  S9(15)V9(03).
      *----------  運用通貨異動簿価
           10  WK-UYTK-IDO-BOKA    PIC  S9(15)V9(03).
      *----------  市場通貨簿価単価
           10  WK-SJTK-BOKA-TNK    PIC  S9(08)V9(10).
      *----------  運用通貨簿価単価
           10  WK-UYTK-BOKA-TNK    PIC  S9(08)V9(10).
      *----------  簿価為替レート
           10  WK-BOKA-KWS         PIC  S9(08)V9(10).
      *----------  市場通貨払出簿価
           10  WK-SJTK-H-BOKA      PIC  S9(15)V9(03).
      *----------  運用通貨払出簿価
           10  WK-UYTK-H-BOKA      PIC  S9(15)V9(03).
      *----------  市場通貨払出単価
           10  WK-SJTK-H-TNK       PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  WK-UYTK-H-TNK       PIC  S9(08)V9(10).
      *----------  異動数量
           10  WK-IDO-SURYO        PIC  S9(12)V9(06).
      *----------  異動数量（利付）
           10  WK-IDO-SURYO-RIT    PIC  S9(12)V9(06).
      *----------  市場通貨異動後簿価残高
           10  WK-SJTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後簿価残高
           10  WK-UYTK-IDOG-BOKAZN
                                   PIC  S9(15)V9(03).
      *----------  異動後数量残高
           10  WK-IDOG-SRYZN       PIC  S9(12)V9(06).
      *----------  異動後数量残高（利付）
           10  WK-IDOG-SRYZN-RIT   PIC  S9(12)V9(06).
      *----------  市場通貨前払金異動額
           10  WK-SJTK-PPAYIDOG    PIC  S9(15)V9(03).
      *----------  運用通貨前払金異動額
           10  WK-UYTK-PPAYIDOG    PIC  S9(15)V9(03).
      *----------  市場通貨異動後前払金残
           10  WK-SJTK-IDOG-PPAYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後前払金残
           10  WK-UYTK-IDOG-PPAYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後前受金残
           10  WK-SJTK-IDOG-ARECZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後前受金残
           10  WK-UYTK-IDOG-ARECZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後仮払金残
           10  WK-SJTK-IDOG-SPAYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後仮払金残
           10  WK-UYTK-IDOG-SPAYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨売買損益
           10  WK-SJTK-BBSNEKI     PIC  S9(15)V9(03).
      *----------  運用通貨売買損益
           10  WK-UYTK-BBSNEKI     PIC  S9(15)V9(03).
      *----------  為替差損益
           10  WK-UYTK-KWS-SNEKI   PIC  S9(15)V9(03).
      *----------  為替差損益（利金）
           10  WK-UYTK-KWS-SNEKI-RK
                                   PIC  S9(15)V9(03).
      *----------  為替差損益（市場）
           10  WK-UYTK-KWS-SNEKI-SJ
                                   PIC  S9(15)V9(03).
      *----------  市場通貨手数料
           10  WK-SJTK-TSR         PIC  S9(15)V9(03).
      *----------  運用通貨手数料
           10  WK-UYTK-TSR         PIC  S9(15)V9(03).
      *----------  市場通貨消費税
           10  WK-SJTK-S-TAX       PIC  S9(15)V9(03).
      *----------  運用通貨消費税
           10  WK-UYTK-S-TAX       PIC  S9(15)V9(03).
      *----------  市場通貨源泉税
           10  WK-SJTK-GENSEN-TAX  PIC  S9(15)V9(03).
      *----------  運用通貨源泉税
           10  WK-UYTK-GENSEN-TAX  PIC  S9(15)V9(03).
      *----------  市場通貨その他損益
           10  WK-SJTK-ELS-SNEKI   PIC  S9(15)V9(03).
      *----------  運用通貨その他損益
           10  WK-UYTK-ELS-SNEKI   PIC  S9(15)V9(03).
      *----------  市場通貨利金等損益勘定
           10  WK-SJTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  運用通貨利金等損益勘定
           10  WK-UYTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  異動計上順序
           10  WK-IDO-KJY-JUN      PIC  S9(08).
      *----------  建玉単価
           10  WK-TGYOKU-TNK       PIC  S9(08)V9(10).
      *----------  建玉為替レート
           10  WK-TGYOKU-KWS-RATE  PIC  S9(08)V9(10).
      *----------  建玉ブローカー
           10  WK-TGYOKU-BRK       PIC  X(04).
      *----------  建玉約定日
           10  WK-TGYOKU-YKJ-YMD   PIC  S9(08).
      *----------  市場通貨異動後建玉約定金額残
           10  WK-SJTK-IDOG-TG-YJKNZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉約定金額残
           10  WK-UYTK-IDOG-TG-YJKNZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉手数料
           10  WK-SJTK-TG-TSR      PIC  S9(15)V9(03).
      *----------  運用通貨建玉手数料
           10  WK-UYTK-TG-TSR      PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉手数料残
           10  WK-SJTK-IDOG-TG-TSRZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉手数料残
           10  WK-UYTK-IDOG-TG-TSRZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉消費税
           10  WK-SJTK-TG-S-TAX    PIC  S9(15)V9(03).
      *----------  運用通貨建玉消費税
           10  WK-UYTK-TG-S-TAX    PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉消費税残
           10  WK-SJTK-IDOG-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉消費税残
           10  WK-UYTK-IDOG-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉その他費用
           10  WK-SJTK-TG-ELS-HIYO
                                   PIC  S9(15)V9(03).
      *----------  運用通貨建玉その他費用
           10  WK-UYTK-TG-ELS-HIYO
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉その他費用残
           10  WK-SJTK-IDOG-TG-ELS-HZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉その他費用残
           10  WK-UYTK-IDOG-TG-ELS-HZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨建玉精算金額
           10  WK-SJTK-TG-SSKG     PIC  S9(15)V9(03).
      *----------  運用通貨建玉精算金額
           10  WK-UYTK-TG-SSKG     PIC  S9(15)V9(03).
      *----------  市場通貨異動後建玉精算金額残
           10  WK-SJTK-IDOG-TG-SSKGZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後建玉精算金額残
           10  WK-UYTK-IDOG-TG-SSKGZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨引継前受・前払プレミアム
           10  WK-SJTK-HT-PPAR-PMM
                                   PIC  S9(15)V9(03).
      *----------  運用通貨引継前受・前払プレミアム
           10  WK-UYTK-HT-PPAR-PMM
                                   PIC  S9(15)V9(03).
      *----------  ＯＰ資産負債・買建売建フラグ
           10  WK-OP-TATE-FLG      PIC  X(01).
      *----------  市場通貨源泉税還付予定異動額
           10  WK-SJTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  運用通貨源泉税還付予定異動額
           10  WK-UYTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  決済通貨源泉税還付予定異動額
           10  WK-KSTK-GSZKP-YTIDOG
                                   PIC  S9(12)V9(06).
      *----------  市場通貨異動後源泉税還付予定額残高
           10  WK-SJTK-IDOG-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後源泉税還付予定額残高
           10  WK-UYTK-IDOG-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
      *----------  決済通貨異動後源泉税還付予定額残高
           10  WK-KSTK-IDOG-GSZKP-YTZN
                                   PIC  S9(12)V9(06).
      *----------  市場通貨異動後ノンカバー未収金残高
           10  WK-SJTK-IDOG-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後ノンカバー未収金残高
           10  WK-UYTK-IDOG-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後ノンカバー未払金残高
           10  WK-SJTK-IDOG-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後ノンカバー未払金残高
           10  WK-UYTK-IDOG-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後未払費用残
           10  WK-SJTK-IDOG-MBHYZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後未払費用残
           10  WK-UYTK-IDOG-MBHYZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後未払消費税残
           10  WK-SJTK-IDOG-MB-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後未払消費税残
           10  WK-UYTK-IDOG-MB-S-TAXZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後移管評価損益残
           10  WK-SJTK-IDOG-IK-HKSEZN
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管評価損益残
           10  WK-UYTK-IDOG-IK-HKSEZN
                                   PIC  S9(15)V9(03).
      *----------  市場通貨異動後移管未収収益
           10  WK-SJTK-IDOG-IK-MSSHEKI
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管未収収益
           10  WK-UYTK-IDOG-IK-MSSHEKI
                                   PIC  S9(15)V9(03).
      *----------  運用通貨異動後移管前払金評価損益残
           10  WK-UYTK-IDOG-IK-PPHKZN
                                   PIC  S9(15)V9(03).
      *----------  削除区分
           10  WK-SAKUJO-KBN       PIC  X(01).
      *----------  短期スタート・エンド経過利息
           10  WK-SHORT-STEN-KEKA-RSK
                                   PIC  S9(12)V9(06).
      *----------  短期スタート日
           10  WK-SHORT-START-YMD  PIC  S9(08).
      *----------  短期エンド日
           10  WK-SHORT-END-YMD    PIC  S9(08).
      *----------  投資対象国コード
           10  WK-TSTSK-CD         PIC  X(04).
      *----------  発行国コード
           10  WK-HAKO-CD          PIC  X(04).
      *----------  数量単位
           10  WK-SURYO-TANI       PIC  S9(12)V9(06).
      *----------  初期設定金額
           10  WK-SHOKI-SET-KGK    PIC  S9(15)V9(03).
      *----------  作成フラグ
           10  WK-SK-FLG           PIC  X(01).
      *----------  作成日時
           10  WK-SK-DATE          PIC  X(14).
      *----------  作成ログインユーザ会社コード
           10  WK-SK-LOGIN-CMP-CD
                                   PIC  X(04).
      *----------  作成ユーザＩＤ
           10  WK-SK-SID           PIC  X(20).
      *----------  作成プログラムＩＤ
           10  WK-SK-PGMID         PIC  X(16).
      *----------  更新フラグ
           10  WK-UPD-FLG          PIC  X(01).
      *----------  更新日時
           10  WK-UPD-DATE         PIC  X(14).
      *----------  更新ログインユーザ会社コード
           10  WK-UPD-LOGIN-CMP-CD
                                   PIC  X(04).
      *----------  更新ユーザＩＤ
           10  WK-UPD-SID          PIC  X(20).
      *----------  更新プログラムＩＤ
           10  WK-UPD-PGMID        PIC  X(16).
      *----------  ワーク取引異動
         05  WK-TORI-IDO.
      *----------  市場通貨払出簿価
           10  WK-SJTK-H-BOKA      PIC  S9(15)V9(03).
      *----------  市場通貨売買損益
           10  WK-SJTK-BBSNEKI     PIC  S9(15)V9(03).
      *----------  市場通貨前払金異動額
           10  WK-SJTK-PPAYIDOG    PIC  S9(15)V9(03).
      *----------  市場通貨利金等損益勘定
           10  WK-SJTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  市場通貨源泉税還付予定異動額
           10  WK-SJTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  運用通貨払出簿価
           10  WK-UYTK-H-BOKA      PIC  S9(15)V9(03).
      *----------  運用通貨売買損益
           10  WK-UYTK-BBSNEKI     PIC  S9(15)V9(03).
      *----------  運用通貨前払金異動額
           10  WK-UYTK-PPAYIDOG    PIC  S9(15)V9(03).
      *----------  運用通貨利金等損益勘定
           10  WK-UYTK-RKSEKJ      PIC  S9(15)V9(03).
      *----------  運用通貨源泉税還付予定異動額
           10  WK-UYTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  為替差損益
           10  WK-UYTK-KWS-SNEKI   PIC  S9(15)V9(03).
      *----------  為替差損益（利金）
           10  WK-UYTK-KWS-SNEKI-RK
                                   PIC  S9(15)V9(03).
      *----------  為替差損益（市場）
           10  WK-UYTK-KWS-SNEKI-SJ
                                   PIC  S9(15)V9(03).
      *----------  取引異動データあるフラグ
         05  WK-TORI-IDO-FLG       PIC  X(01).
      *----------  ワーク還付金異動計算特殊フラグ
         05  WK-KANPKIN-IDO-FLG    PIC  X(01).
      *----------  ワーク一口売却計算フラグ
         05  WK-KUTI1-BAKYK-CALC-FLG
                                   PIC  X(01).
      *----------  ワーク約定主義会計フラグ
         05  WK-YKJ-SYUGI-KAIKEI-FLG
                                   PIC  X(01).
      *----------  ワーク新株発行フラグ
         05  WK-NEW-KABU-HAKKO-FLG
                                   PIC  X(01).
      *----------  ワークOLD証券種別コード
         05  WK-OLD-SEC-SBT-CD     PIC  X(04).
      *----------  ワークOLD取引事由
         05  WK-OLD-TORI-JIYU      PIC  X(04).
      *----------  ワークOLD資産負債・買建売建フラグ
         05  WK-OLD-TATE-FLG       PIC  X(01).
      *----------  ワークOLDオプションL／Sフラグ
         05  WK-OLD-OP-L-S-FLG     PIC  X(01).
      *----------  ワークデータなしフラグ
         05  WK-DATA-NASI-FLG      PIC  9(01).
      *----------  「別紙1-13 SQL」フラグ
         05  WK-13SQL-FLG          PIC  9(01).
      *----------  ワーク個別項目計算６用データ
         05  WK-KOBETSU-KOMK-CALC-6-DATA.
      *----------  取引事由
           10  WK-TORI-JIYU        PIC  X(04).
      *----------  市場通貨払出単価
           10  WK-SJTK-H-TNK       PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  WK-UYTK-H-TNK       PIC  S9(08)V9(10).
      *----------  赤黒区分
           10  WK-AKA-KBN          PIC  X(01).
      *----------  ワーク運用通貨予備売買金額
         05  WK-UYTK-YOBI-BS-KN    PIC  S9(15)V9(03).
      *----------  ワーク市場通貨予備売買金額
         05  WK-SJTK-YOBI-BS-KN    PIC  S9(15)V9(03).
      *----------  ワーク乗算/除算区分
         05  WK-JZ-JS-KBN          PIC  X(01).
      *----------  ワーク商品区分
         05  WK-SYOHIN-KBN         PIC  X(01).
      *----------  ワーク約定ベース消費税受渡計上
         05  WK-YKJ-SHOHI-JUN      PIC  X(01).
      *----------  ワーク本体フラグ
         05  WK-HONTAI-FLG         PIC  X(01).
      *----------  ワーク計算パターン決定用取引事由
         05  WK-KSKT-TORI-JIYU     PIC  X(04).
      *----------  市場通貨前払金異動額有効フラグ
         05  WK-SJTK-PPAYIDOG-FLG  PIC  X(01).
      *----------  運用通貨前払金異動額有効フラグ
         05  WK-UYTK-PPAYIDOG-FLG  PIC  X(01).
      *----------  ワーク市場通貨簿価指定フラグ
         05  WK-SJTK-BOKA-SITEI-FLG
                                   PIC  9(01).
      *----------  ワーク運用通貨簿価指定フラグ
         05  WK-UYTK-BOKA-SITEI-FLG
                                   PIC  9(01).
      *----------  ワーク相手存在フラグ
         05  WK-AITE-SONZAI-FLG    PIC  9(01).
      ******************************************************************
      *    フラグエリア
      ******************************************************************
       01  FLG-AREA.
      *----------  取引カーソルオープンフラグ
      ***05  FLG-TKMXTR00-CR-OPEN  PIC  9(01).                          @3212SEINO@
      *----------  取引カーソルオープンフラグ
      ***05  FLG-TKMXTR00-CR-1-OPEN                                     @3212SEINO@
      *****                        PIC  9(01).                          @3212SEINO@
      *----------  取引カーソルオープンフラグ
      ***05  FLG-TKMXTR00-CR-2-OPEN                                     @3212SEINO@
      *****                        PIC  9(01).                          @3212SEINO@
      *----------  対象取引情報カーソルオープンフラグ
      ***05  FLG-TKMZBW04-CR-OPEN  PIC  9(01).                          @3212SEINO@
      *----------  残高異動計算データカーソルオープンフラグ
      ***05  FLG-TKMZBW06-CR-OPEN  PIC  9(01).                          @3212SEINO@
      ***05  FLG-TKMZBW06-CR-2-OPEN                                     @3212SEINO@
      *****                        PIC  9(01).                          @3212SEINO@
      *----------  残高異動カーソルオープンフラグ
         05  FLG-TKMZZI00-CR-OPEN  PIC  9(01).
      *----------  残高履歴カーソルオープンフラグ
      ***05  FLG-TKMZZR00-CR-OPEN  PIC  9(01).                          @3212SEINO@
      *----------  取引異動カーソルオ ープンフラグ
      ***05  FLG-TKMXTI00-CR-OPEN  PIC  9(01).                          @3212SEINO@
      ***05  FLG-TKMXTI00-CR-2-OPEN                                     @3212SEINO@
      *****                        PIC  9(01).                          @3212SEINO@
      ***05  FLG-TKMXTI00-CR-13-OPEN                                    @3212SEINO@
      *****                        PIC  9(01).                          @3212SEINO@
      *----------  対応本体取引異動カーソルオ ープンフラグ
      ***05  FLG-TKMXTI00-CR-1-OPEN                                     @3212SEINO@
      *****                        PIC  9(01).                          @3212SEINO@
      ***05  FLG-TKMXTR00-CR-11-OPEN                                    @3212SEINO@
      *****                        PIC  9(01).                          @3212SEINO@
      ******************************************************************@3212SEINO@
      *                カーソルオープンフラグ  エリア                   @3212SEINO@
      ******************************************************************@3212SEINO@
       01  FLG-AREA2.                                                   @3212SEINO@
      *----------  取引カーソルオープンフラグ
         05  FLG-TKMXTR00-CR-OPEN  PIC  9(01).                          @3212SEINO@
      *----------  取引カーソルオープンフラグ
         05  FLG-TKMXTR00-CR-1-OPEN                                     @3212SEINO@
                                   PIC  9(01).                          @3212SEINO@
      *----------  取引カーソルオープンフラグ
         05  FLG-TKMXTR00-CR-2-OPEN                                     @3212SEINO@
                                   PIC  9(01).                          @3212SEINO@
      *----------  残高異動計算データカーソルオープンフラグ
         05  FLG-TKMZBW06-CR-OPEN  PIC  9(01).                          @3212SEINO@
         05  FLG-TKMZBW06-CR2-OPEN PIC  9(01).                          @3212SEINO@
         05  FLG-TKMZBW06-CR-2-OPEN                                     @3212SEINO@
                                   PIC  9(01).                          @3212SEINO@
      *----------  残高履歴カーソルオープンフラグ
         05  FLG-TKMZZR00-CR-OPEN  PIC  9(01).                          @3212SEINO@
      *----------  取引異動カーソルオ ープンフラグ
         05  FLG-TKMXTI00-CR-OPEN  PIC  9(01).                          @3212SEINO@
         05  FLG-TKMXTI00-CR-2-OPEN                                     @3212SEINO@
                                   PIC  9(01).                          @3212SEINO@
         05  FLG-TKMXTI00-CR-13-OPEN                                    @3212SEINO@
                                   PIC  9(01).                          @3212SEINO@
      *----------  対応本体取引異動カーソルオ ープンフラグ
         05  FLG-TKMXTI00-CR-1-OPEN                                     @3212SEINO@
                                   PIC  9(01).                          @3212SEINO@
         05  FLG-TKMXTR00-CR-11-OPEN                                    @3212SEINO@
                                   PIC  9(01).                          @3212SEINO@
      *----------  対象取引情報カーソルオープンフラグ                   @3212SEINO@
         05  FLG-TKMZBW04-CR-OPEN  PIC  9(01).                          @3212SEINO@
      ******************************************************************@3212SEINO@
      *                複数回起動チェック用スイッチ                     @3212SEINO@
      ******************************************************************@3212SEINO@
       01  FIRST-SW                PIC  X(03)  VALUE 'YES'.             @3212SEINO@
      ******************************************************************
      *    ＯＲＡＣＬＥホスト変数定義
      ******************************************************************
      *----------  ＳＱＬコミュニケーション領域
           EXEC  SQL  INCLUDE  SQLCA             END-EXEC.
           EXEC  SQL  INCLUDE  ORACA             END-EXEC.
           EXEC  SQL  BEGIN   DECLARE   SECTION  END-EXEC.
       01  HST-AREA.
      *----------  取引TBL(別紙1-1)
         05  H-TKMXTR00.
      *----------  異動数量
           10  H-IDO-SURYOU        PIC  S9(12)V9(06).
      *----------  精算金額（市場通貨換算額）
           10  H-S-KSG-G-SSKG      PIC  S9(15)V9(03).
      *----------  精算金額（運用通貨換算額）
           10  H-U-KSG-G-SSKG      PIC  S9(15)V9(03).
      *----------  取引TBL(別紙1-1)
         05  H-TKMXTR00-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  残高異動計算データTBL(別紙1-2)
         05  H-TKMZBW06.
      *----------  市場通貨コード
           10  H-SIJO-TUKA-CD      PIC  X(04).
      *----------  異動後数量残高
           10  H-IDOG-SRYZN        PIC  S9(12)V9(06).
      *----------  市場通貨異動後簿価残高
           10  H-SJTK-IDOG-BOKAZN  PIC  S9(15)V9(03).
      *----------  運用通貨異動後簿価残高
           10  H-UYTK-IDOG-BOKAZN  PIC  S9(15)V9(03).
      *----------  数量単位
           10  H-SURYO-TANI        PIC  S9(12)V9(06).
      *----------  残高異動計算データTBL(別紙1-2)
         05  H-TKMZBW06-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD-1     PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID-1         PIC  S9(10).
      *----------  処理実行日
           10  H-SYORI-YMD-1       PIC  S9(08).
      *----------  起動ID
           10  H-KIDOU-ID-1        PIC  X(04).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *----------  起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD-2     PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID-2         PIC  S9(10).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD-3     PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD-3         PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD-3          PIC  X(04).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD-4     PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID-4         PIC  S9(10).
      *----------  計上基準日
           10  H-KAISI-KJN-YMD-NEXT-3
                                   PIC  S9(08).
      *----------  計上基準日
           10  H-KEIJOU-KIJUNBI-3  PIC  S9(08).
      *----------  取引連関ＩＤ
           10  H-THRK-ID-3         PIC  S9(10).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD-5     PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD-5         PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD-5          PIC  X(04).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD-6     PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID-6         PIC  S9(10).
      *----------  計上基準日
           10  H-KAISI-KJN-YMD-NEXT-5
                                   PIC  S9(08).
      *----------  計上基準日
           10  H-KEIJOU-KIJUNBI-5  PIC  S9(08).
      *----------  取引連関ＩＤ
           10  H-THRK-ID-5         PIC  S9(10).
      *----------  残高履歴TBL(別紙1-3)
         05  H-TKMZZR00.
      *----------  市場通貨コード
           10  H-SIJO-TUKA-CD      PIC  X(04).
      *----------  数量残高
           10  H-SRYZN             PIC  S9(12)V9(06).
      *----------  市場通貨簿価残高
           10  H-SJTK-BOKAZN       PIC  S9(15)V9(03).
      *----------  運用通貨簿価残高
           10  H-UYTK-BOKAZN       PIC  S9(15)V9(03).
      *----------  数量単位
           10  H-SURYO-TANI        PIC  S9(12)V9(06).
      *----------  残高履歴TBL(別紙1-3)
         05  H-TKMZZR00-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD-1     PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  基準日
           10  H-KJN-YMD           PIC  S9(08).
      *----------  取引TBL(別紙1-4)
         05  H-TKMXTR00-1.
      *----------  異動数量
           10  H-IDO-SURYOU        PIC  S9(12)V9(06).
      *----------  約定単価
           10  H-YKJ-TANKA         PIC  S9(08)V9(10).
      *----------  為替レート（市場／運用）
           10  H-S-U-KWS           PIC  S9(08)V9(10).
      *----------  市場通貨コード
           10  H-SIJO-TUKA-CD      PIC  X(04).
      *----------  約定金額(市場通貨換算額)
           10  H-S-KSG-G-YJKG      PIC  S9(15)V9(03).
      *----------  約定金額(運用通貨換算額)
           10  H-U-KSG-G-YJKG      PIC  S9(15)V9(03).
      *----------  数量単位
           10  H-SURYO-TANI        PIC  S9(12)V9(06).
      *----------  取引TBL(別紙1-4)
         05  H-TKMXTR00-S-1.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  取引TBL(別紙1-5)
         05  H-TKMXTR00-2.
      *----------  １口注文ＩＤ
           10  H-ORDR-1K-ID        PIC  S9(10).
      *----------  取引TBL(別紙1-5)
         05  H-TKMXTR00-S-2.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  取引異動TBL(別紙1-6)
         05  H-TKMXTI00.
      *----------  市場通貨払出簿価
           10  H-SJTK-H-BOKA       PIC  S9(15)V9(03).
      *----------  市場通貨売買損益
           10  H-SJTK-BBSNEKI      PIC  S9(15)V9(03).
      *----------  市場通貨前払金異動額
           10  H-SJTK-PPAYIDOG     PIC  S9(15)V9(03).
      *----------  市場通貨利金等損益勘定
           10  H-SJTK-RKSEKJ       PIC  S9(15)V9(03).
      *----------  市場通貨源泉税還付予定異動額
           10  H-SJTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  運用通貨払出簿価
           10  H-UYTK-H-BOKA       PIC  S9(15)V9(03).
      *----------  運用通貨売買損益
           10  H-UYTK-BBSNEKI      PIC  S9(15)V9(03).
      *----------  運用通貨前払金異動額
           10  H-UYTK-PPAYIDOG     PIC  S9(15)V9(03).
      *----------  運用通貨利金等損益勘定
           10  H-UYTK-RKSEKJ       PIC  S9(15)V9(03).
      *----------  市場通貨源泉税還付予定異動額
           10  H-UYTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  為替差損益
           10  H-UYTK-KWS-SNEKI    PIC  S9(15)V9(03).
      *----------  為替差損益（利金）
           10  H-UYTK-KWS-SNEKI-RK
                                   PIC  S9(15)V9(03).
      *----------  為替差損益（市場）
           10  H-UYTK-KWS-SNEKI-SJ
                                   PIC  S9(15)V9(03).
      *----------  取引異動TBL(別紙1-6)
         05  H-TKMXTI00-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  削除区分
           10  H-SAKUJO-KBN        PIC  X(01).
      *----------  赤黒区分
           10  H-AKA-KBN           PIC  X(01).
      *----------  対象取引情報TBL(別紙1-9)
         05  H-TKMZBW04.
      *----------  市場通貨払出簿価
           10  H-SJTK-H-BOKA       PIC  S9(15)V9(03).
      *----------  運用通貨払出簿価
           10  H-UYTK-H-BOKA       PIC  S9(15)V9(03).
      *----------  市場通貨払出単価
           10  H-SJTK-H-TNK        PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  H-UYTK-H-TNK        PIC  S9(08)V9(10).
      *----------  対象取引情報TBL(別紙1-9)
         05  H-TKMZBW04-S.
      *----------  処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *----------  起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  基準日
           10  H-KJN-YMD           PIC  S9(08).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *----------  証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *----------  玉ＩＤ
           10  H-GYOKU-ID          PIC  X(10).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  増幅赤黒区分
           10  H-ZOFKU-AKA-KBN     PIC  X(01).
      *----------  残高異動計算データTBL(別紙1-10)
         05  H-TKMZBW06-2.
      *----------  市場通貨異動簿価
           10  H-SJTK-IDO-BOKA     PIC  S9(15)V9(03).
      *----------  運用通貨異動簿価
           10  H-UYTK-IDO-BOKA     PIC  S9(15)V9(03).
      *----------  市場通貨前払金異動額
           10  H-SJTK-PPAYIDOG     PIC  S9(15)V9(03).
      *----------  運用通貨前払金異動額
           10  H-UYTK-PPAYIDOG     PIC  S9(15)V9(03).
      *----------  残高異動計算データTBL(別紙1-10)
         05  H-TKMZBW06-2-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *----------  起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  取引TBL(別紙1-11)
         05  H-TKMXTR00-S-11.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  取引事由
           10  H-TORI-JIYU         PIC  X(04).
      *----------  取引異動TBL(別紙1-12)
         05  H-TKMXTI00-1.
      *----------  市場通貨払出簿価
           10  H-SJTK-H-BOKA       PIC  S9(15)V9(03).
      *----------  市場通貨売買損益
           10  H-SJTK-BBSNEKI      PIC  S9(15)V9(03).
      *----------  市場通貨前払金異動額
           10  H-SJTK-PPAYIDOG     PIC  S9(15)V9(03).
      *----------  市場通貨利金等損益勘定
           10  H-SJTK-RKSEKJ       PIC  S9(15)V9(03).
      *----------  市場通貨源泉税還付予定異動額
           10  H-SJTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  運用通貨払出簿価
           10  H-UYTK-H-BOKA       PIC  S9(15)V9(03).
      *----------  運用通貨売買損益
           10  H-UYTK-BBSNEKI      PIC  S9(15)V9(03).
      *----------  運用通貨前払金異動額
           10  H-UYTK-PPAYIDOG     PIC  S9(15)V9(03).
      *----------  運用通貨利金等損益勘定
           10  H-UYTK-RKSEKJ       PIC  S9(15)V9(03).
      *----------  市場通貨源泉税還付予定異動額
           10  H-UYTK-GSZKP-YTIDOG
                                   PIC  S9(15)V9(03).
      *----------  為替差損益
           10  H-UYTK-KWS-SNEKI    PIC  S9(15)V9(03).
      *----------  為替差損益（利金）
           10  H-UYTK-KWS-SNEKI-RK
                                   PIC  S9(15)V9(03).
      *----------  為替差損益（市場）
           10  H-UYTK-KWS-SNEKI-SJ
                                   PIC  S9(15)V9(03).
      *----------  取引異動TBL(別紙1-12)
         05  H-TKMXTI00-S-1.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  削除区分
           10  H-SAKUJO-KBN        PIC  X(01).
      *----------  赤黒区分
           10  H-AKA-KBN           PIC  X(01).
         05  SQLSTMT1              PIC  X(400).                         @3212SEINO@
         05  SQLSTMT2              PIC  X(400).                         @3212SEINO@
         05  SQLSTMT3              PIC  X(400).                         @3212SEINO@
         05  SQLSTMT4              PIC  X(400).                         @3212SEINO@
         05  SQLSTMT5              PIC  X(100).                         @3212SEINO@
         05  SQLSTMT6              PIC  X(150).                         @3212SEINO@
         05  SQLSTMT7              PIC  X(200).                         @3212SEINO@
         05  SQLSTMT8              PIC  X(100).                         @3212SEINO@
         05  SQLSTMT9              PIC  X(2100).                        @3212SEINO@
         05  SQLSTMT12             PIC  X(2100).                        @3212SEINO@
         05  SQLSTMT10             PIC  X(450).                         @3212SEINO@
         05  SQLSTMT11             PIC  X(260).                         @3212SEINO@
         05  SQLSTMT               PIC  X(420).                         @3212SEINO@
           EXEC  SQL  END DECLARE       SECTION  END-EXEC.
      ******************************************************************
      *            SQL  エリア
      ******************************************************************
       01  SQL-AREA.
      *----------  取引SQL文(別紙1-1)
         05  SQL-SELECT-1-1.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  異動数量
           10  FILLER              PIC  X(11)  VALUE  "IDO_SURYO, ".
      *----------  精算金額（市場通貨換算額）
           10  FILLER              PIC  X(12)  VALUE  "S_KSG_SSKG, ".
      *----------  精算金額（運用通貨換算額）
           10  FILLER              PIC  X(13)  VALUE  "U_KSG_G_SSKG ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-1        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(17)  VALUE
               ":P_TARGET_TORI_ID".
      *----------  残高異動計算データSQL文(別紙1-2)
         05  SQL-SELECT-1-2.
      *----------  Layer00
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨コード
           10  FILLER              PIC  X(14)  VALUE  "SIJO_TUKA_CD, ".
      *----------  異動後数量残高
           10  FILLER              PIC  X(12)  VALUE  "IDOG_SRYZN, ".
      *----------  市場通貨異動後簿価残高
           10  FILLER              PIC  X(18)  VALUE
                                                   "SJTK_IDOG_BOKAZN, ".
      *----------  運用通貨異動後簿価残高
           10  FILLER              PIC  X(18)  VALUE
                                                   "UYTK_IDOG_BOKAZN, ".
      *----------  数量単位
           10  FILLER              PIC  X(11)  VALUE  "SURYO_TANI ".
           10  FILLER              PIC  X(06)  VALUE  "FROM (".
      *----------  Layer01-1/2
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨コード
           10  FILLER              PIC  X(16)  VALUE "A.SIJO_TUKA_CD, ".
      *----------  異動後数量残高
           10  FILLER              PIC  X(14)  VALUE  "A.IDOG_SRYZN, ".
      *----------  市場通貨異動後簿価残高
           10  FILLER              PIC  X(20)  VALUE
               "A.SJTK_IDOG_BOKAZN, ".
      *----------  運用通貨異動後簿価残高
           10  FILLER              PIC  X(20)  VALUE
               "A.UYTK_IDOG_BOKAZN, ".
      *----------  A.受渡日
           10  FILLER              PIC  X(11)  VALUE  "A.UKE_YMD, ".
      *----------  計上基準日
           10  FILLER              PIC  X(18)  VALUE
               "A.KEIJOU_KIJUNBI, ".
      *----------  A.異動計上順序
           10  FILLER              PIC  X(15)  VALUE  "A.IDO_KJY_JUN, ".
      *----------  数量単位
           10  FILLER              PIC  X(14)  VALUE  "A.SURYO_TANI, ".
      *----------  TBL区分
           10  FILLER              PIC  X(13)  VALUE  "1 AS TBL_KBN ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-2-A      PIC  X(13).
           10  FILLER              PIC  X(04)  VALUE  " A, ".
           10  FILLER              PIC  X(08)  VALUE  "(SELECT ".
      *----------  異動計上順序
           10  FILLER              PIC  X(12)  VALUE  "IDO_KJY_JUN ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-2-B      PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(17)  VALUE
               ":P_TARGET_TORI_ID".
      *----------  処理実行日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(12)  VALUE  "SYORI_YMD = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_SYORI_YMD".
      *----------  起動ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "KIDOU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_KIDOU_ID".
      *----------  赤黒区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(15)  VALUE  "AKA_KBN <> '1')".
           10  FILLER              PIC  X(02)  VALUE  " B".
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(16)  VALUE
               "A.RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  処理実行日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "A.SYORI_YMD = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_SYORI_YMD".
      *----------  起動ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "A.KIDOU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_KIDOU_ID".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(12)  VALUE  "A.FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "A.PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  証券種別コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(15)  VALUE  "(A.SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(10)  VALUE  "A.MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(12)  VALUE  "A.TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(12)  VALUE  "A.GYOKU_ID) ".
           10  FILLER              PIC  X(04)  VALUE  "IN (".
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  証券種別コード
           10  FILLER              PIC  X(12)  VALUE  "SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  "TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(09)  VALUE  "GYOKU_ID ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-TKMXTR00-1  PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(18)  VALUE
               ":P_TARGET_TORI_ID)".
      *----------  異動計上順序
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(16)  VALUE
               "A.IDO_KJY_JUN < ".
           10  FILLER              PIC  X(13)  VALUE  "B.IDO_KJY_JUN".
      *----------  UNION
           10  FILLER              PIC  X(07)  VALUE  " UNION ".
      *----------  Layer01-2/2S
           10  FILLER              PIC  X(08)  VALUE  " SELECT ".
           10  FILLER              PIC  X(13)  VALUE  "SIJO_TUKA_CD,".
           10  FILLER              PIC  X(11)  VALUE  "IDOG_SRYZN,".
           10  FILLER              PIC  X(17)  VALUE
               "SJTK_IDOG_BOKAZN,".
           10  FILLER              PIC  X(17)  VALUE
               "UYTK_IDOG_BOKAZN,".
           10  FILLER              PIC  X(08)  VALUE  "UKE_YMD,".
           10  FILLER              PIC  X(21)  VALUE
                                                "T_AAA.KEIJOU_KIJUNBI,".
           10  FILLER              PIC  X(12)  VALUE  "IDO_KJY_JUN,".
           10  FILLER              PIC  X(11)  VALUE  "SURYO_TANI,".
           10  FILLER              PIC  X(12)  VALUE  "2 AS TBL_KBN".
           10  FILLER              PIC  X(07)  VALUE  " FROM (".
      *----------  Layer02-1/2S
           10  FILLER              PIC  X(09)  VALUE  " (SELECT ".
           10  FILLER              PIC  X(13)  VALUE  "SIJO_TUKA_CD,".
           10  FILLER              PIC  X(11)  VALUE  "IDOG_SRYZN,".
           10  FILLER              PIC  X(17)  VALUE
               "SJTK_IDOG_BOKAZN,".
           10  FILLER              PIC  X(17)  VALUE
               "UYTK_IDOG_BOKAZN,".
           10  FILLER              PIC  X(08)  VALUE  "UKE_YMD,".
           10  FILLER              PIC  X(15)  VALUE  "KEIJOU_KIJUNBI,".
           10  FILLER              PIC  X(12)  VALUE  "IDO_KJY_JUN,".
           10  FILLER              PIC  X(11)  VALUE  "SURYO_TANI,".
           10  FILLER              PIC  X(09)  VALUE  "TORI_JIYU".
           10  FILLER              PIC  X(06)  VALUE  " FROM ".
           10  SQL-TBL-TKMZZI00-N1 PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  証券種別コード
           10  FILLER              PIC  X(13)  VALUE  "(SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  "TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(10)  VALUE  "GYOKU_ID) ".
           10  FILLER              PIC  X(04)  VALUE  "IN (".
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  証券種別コード
           10  FILLER              PIC  X(12)  VALUE  "SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  "TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(09)  VALUE  "GYOKU_ID ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-TKMXTR00-N1 PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(18)  VALUE
               ":P_TARGET_TORI_ID)".
      *----------  計上基準日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(24)  VALUE
               "(KEIJOU_KIJUNBI BETWEEN ".
           10  FILLER              PIC  X(22)  VALUE
               ":P_KEIJOU_KIJUNBI_YKJC".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(18)  VALUE
               ":P_KEIJOU_KIJUNBI)".
      *----------  取引連関ＩＤ
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "THRK_ID <> ".
           10  FILLER              PIC  X(10)  VALUE  ":P_THRK_ID".
           10  FILLER              PIC  X(09)  VALUE  " ) T_AAA ".
      *----------  Layer02-1/2E
      *----------  LEFT JOIN
      *----------  Layer02-2/2S
           10  FILLER              PIC  X(11)  VALUE  " LEFT JOIN ".
           10  FILLER              PIC  X(09)  VALUE  " (SELECT ".
           10  FILLER              PIC  X(15)  VALUE  "KEIJOU_KIJUNBI,".
           10  FILLER              PIC  X(15)  VALUE  "MAX(UKE_YMD) AS".
           10  FILLER              PIC  X(19)  VALUE
               " KEIJOU_UKE_YMD" .
           10  FILLER              PIC  X(06)  VALUE  " FROM ".
           10  SQL-TBL-TKMZZI00-N2 PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  証券種別コード
           10  FILLER              PIC  X(13)  VALUE  "(SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  "TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(10)  VALUE  "GYOKU_ID) ".
           10  FILLER              PIC  X(04)  VALUE  "IN (".
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  証券種別コード
           10  FILLER              PIC  X(12)  VALUE  "SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  "TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(09)  VALUE  "GYOKU_ID ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-TKMXTR00-N2 PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(18)  VALUE
               ":P_TARGET_TORI_ID)".
      *----------  計上基準日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(24)  VALUE
               "(KEIJOU_KIJUNBI BETWEEN ".
           10  FILLER              PIC  X(22)  VALUE
               ":P_KEIJOU_KIJUNBI_YKJC".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(18)  VALUE
               ":P_KEIJOU_KIJUNBI)".
      *----------  取引連関ＩＤ
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "THRK_ID <> ".
           10  FILLER              PIC  X(10)  VALUE  ":P_THRK_ID".
           10  FILLER              PIC  X(10)  VALUE  " GROUP BY ".
           10  FILLER              PIC  X(15)  VALUE  " KEIJOU_KIJUNBI".
           10  FILLER              PIC  X(07)  VALUE  ") T_BBB".
           10  FILLER              PIC  X(04)  VALUE  " ON ".
           10  FILLER              PIC  X(43)  VALUE
               "T_AAA.KEIJOU_KIJUNBI = T_BBB.KEIJOU_KIJUNBI".
           10  FILLER              PIC  X(01)  VALUE  ")".
      *----------  Layer01-2/2E
           10  FILLER              PIC  X(01)  VALUE  ")".
      *----------  ORDER BY
           10  FILLER              PIC  X(10)  VALUE  " ORDER BY ".
      *----------  TBL区分
           10  FILLER              PIC  X(08)  VALUE  "TBL_KBN,".
      *----------  TBL区分
           10  FILLER              PIC  X(26)  VALUE
               "DECODE(TBL_KBN,1,19800101,".
      *----------  受渡日OR計上基準日  降順
           10  SQL-HANTEI          PIC  X(14).
           10  FILLER              PIC  X(01)  VALUE  ")".
           10  FILLER              PIC  X(07)  VALUE  " DESC, ".
      *----------  異動計上順序  降順
           10  FILLER              PIC  X(16)  VALUE
               "IDO_KJY_JUN DESC".
      *----------  残高履歴SQL文(別紙1-3)
         05  SQL-SELECT-1-3.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  数量残高
           10  FILLER              PIC  X(07)  VALUE  "SRYZN, ".
      *----------  市場通貨簿価残高
           10  FILLER              PIC  X(13)  VALUE
               "SJTK_BOKAZN, ".
      *----------  運用通貨簿価残高
           10  FILLER              PIC  X(13)  VALUE
               "UYTK_BOKAZN, ".
      *----------  市場通貨コード
           10  FILLER              PIC  X(14)  VALUE  "SIJO_TUKA_CD, ".
      *----------  数量単位
           10  FILLER              PIC  X(11)  VALUE  "SURYO_TANI ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-11       PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  証券種別コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "(SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  "TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(10)  VALUE  "GYOKU_ID) ".
           10  FILLER              PIC  X(04)  VALUE  "IN (".
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  証券種別コード
           10  FILLER              PIC  X(12)  VALUE  "SEC_SBT_CD, ".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  "TATE_FLG, ".
      *----------  玉ID
           10  FILLER              PIC  X(09)  VALUE  "GYOKU_ID ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-TKMXTR00    PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(18)  VALUE
               ":P_TARGET_TORI_ID)".
      *----------  基準日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "KJN_YMD = ".
           10  FILLER              PIC  X(16)  VALUE
               ":P_KAISI_KJN_YMD".
      *----------  決算日断面区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(16)  VALUE
               "KSN_YMD_DMN_KBN ".
           10  FILLER              PIC  X(12)  VALUE  "IN ('0','2')".
      *----------  ORDER BY
           10  FILLER              PIC  X(10)  VALUE  " ORDER BY ".
      *----------  基準日  降順
           10  FILLER              PIC  X(12)  VALUE
               "KJN_YMD DESC".
      *----------  取引SQL文(別紙1-4)
         05  SQL-SELECT-1-4.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  異動数量
           10  FILLER              PIC  X(11)  VALUE  "IDO_SURYO, ".
      *----------  約定単価
           10  FILLER              PIC  X(11)  VALUE  "YKJ_TANKA, ".
      *----------  為替レート（市場／運用）
           10  FILLER              PIC  X(09)  VALUE  "S_U_KWS, ".
      *----------  市場通貨コード
           10  FILLER              PIC  X(14)  VALUE  "SIJO_TUKA_CD, ".
      *----------  約定金額(市場通貨換算額)
           10  FILLER              PIC  X(14)  VALUE  "S_KSG_G_YJKG, ".
      *----------  約定金額(運用通貨換算額)
           10  FILLER              PIC  X(14)  VALUE  "U_KSG_G_YJKG, ".
      *----------  数量単位
           10  FILLER              PIC  X(11)  VALUE  "SURYO_TANI ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-4        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(17)  VALUE
               ":P_TARGET_TORI_ID".
      *----------  取引SQL文(別紙1-5)
         05  SQL-SELECT-1-5.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  １口注文ＩＤ
           10  FILLER              PIC  X(11)  VALUE  "ORDR_1K_ID ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-5        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_TORI_ID".
      *----------  取引異動SQL文(別紙1-6)
         05  SQL-SELECT-1-6.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨払出簿価
           10  FILLER              PIC  X(13)  VALUE  "SJTK_H_BOKA, ".
      *----------  市場通貨売買損益
           10  FILLER              PIC  X(14)  VALUE  "SJTK_BBSNEKI, ".
      *----------  市場通貨前払金異動額
           10  FILLER              PIC  X(15)  VALUE  "SJTK_PPAYIDOG, ".
      *----------  市場通貨利金等損益勘定
           10  FILLER              PIC  X(13)  VALUE  "SJTK_RKSEKJ, ".
      *----------  市場通貨源泉税還付予定異動額
           10  FILLER              PIC  X(19)  VALUE
               "SJTK_GSZKP_YTIDOG, ".
      *----------  運用通貨払出簿価
           10  FILLER              PIC  X(13)  VALUE  "UYTK_H_BOKA, ".
      *----------  運用通貨売買損益
           10  FILLER              PIC  X(14)  VALUE  "UYTK_BBSNEKI, ".
      *----------  運用通貨前払金異動額
           10  FILLER              PIC  X(15)  VALUE  "UYTK_PPAYIDOG, ".
      *----------  運用通貨利金等損益勘定
           10  FILLER              PIC  X(13)  VALUE  "UYTK_RKSEKJ, ".
      *----------  運用通貨源泉税還付予定異動額
           10  FILLER              PIC  X(19)  VALUE
               "UYTK_GSZKP_YTIDOG, ".
      *----------  為替差損益
           10  FILLER              PIC  X(16)  VALUE
               "UYTK_KWS_SNEKI, ".
      *----------  為替差損益（利金）
           10  FILLER              PIC  X(19)  VALUE
               "UYTK_KWS_SNEKI_RK, ".
      *----------  為替差損益（市場）
           10  FILLER              PIC  X(18)  VALUE
               "UYTK_KWS_SNEKI_SJ ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-6        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_TORI_ID".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE ":P_PTF_CD".
      *----------  削除区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "SAKUJO_KBN = ".
           10  FILLER              PIC  X(13)  VALUE  ":P_SAKUJO_KBN".
      *----------  赤黒区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "AKA_KBN = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_AKA_KBN".
      *----------  対象取引情報SQL文(別紙1-9)
         05  SQL-SELECT-1-9.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨払出簿価
           10  FILLER              PIC  X(13)  VALUE  "SJTK_H_BOKA, ".
      *----------  運用通貨払出簿価
           10  FILLER              PIC  X(13)  VALUE  "UYTK_H_BOKA, ".
      *----------  市場通貨払出単価
           10  FILLER              PIC  X(12)  VALUE  "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
           10  FILLER              PIC  X(11)  VALUE  "UYTK_H_TNK ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-9        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  処理実行日
           10  FILLER              PIC  X(12)  VALUE  "SYORI_YMD = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_SYORI_YMD".
      *----------  起動ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "KIDOU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_KIDOU_ID".
      *----------  利用会社コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  基準日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "KJN_YMD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_KJN_YMD".
      *----------  銘柄コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "MEG_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_MEG_CD".
      *----------  証券種別コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "SEC_SBT_CD = ".
           10  FILLER              PIC  X(13)  VALUE  ":P_SEC_SBT_CD".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "TATE_FLG = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_TATE_FLG".
      *----------  玉ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "GYOKU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_GYOKU_ID".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_TORI_ID".
      *----------  増幅赤黒区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(16)  VALUE
               "ZOFKU_AKA_KBN = ".
           10  FILLER              PIC  X(16)  VALUE
               ":P_ZOFKU_AKA_KBN".
      *----------  残高異動計算データSQL文(別紙1-10)
         05  SQL-SELECT-1-10.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨異動簿価
           10  FILLER              PIC  X(15)  VALUE  "SJTK_IDO_BOKA, ".
      *----------  運用通貨異動簿価
           10  FILLER              PIC  X(15)  VALUE  "UYTK_IDO_BOKA, ".
      *----------  市場通貨前払金異動額
           10  FILLER              PIC  X(15)  VALUE  "SJTK_PPAYIDOG, ".
      *----------  運用通貨前払金異動額
           10  FILLER              PIC  X(14)  VALUE  "UYTK_PPAYIDOG ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-10       PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  処理実行日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(12)  VALUE  "SYORI_YMD = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_SYORI_YMD".
      *----------  起動ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "KIDOU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_KIDOU_ID".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_TORI_ID".
      *----------  本体取引データの取引事由を取得する。（「別紙1-11 SQL説明」を参照）
         05  SQL-SELECT-1-11.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  取引事由
           10  FILLER              PIC  X(10)  VALUE  "TORI_JIYU ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-111      PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_TORI_ID".
      *----------  対応本体の取引の取引異動SQL文(別紙1-12)
         05  SQL-SELECT-1-12.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨払出簿価
           10  FILLER              PIC  X(13)  VALUE  "SJTK_H_BOKA, ".
      *----------  市場通貨売買損益
           10  FILLER              PIC  X(14)  VALUE  "SJTK_BBSNEKI, ".
      *----------  市場通貨前払金異動額
           10  FILLER              PIC  X(15)  VALUE  "SJTK_PPAYIDOG, ".
      *----------  市場通貨利金等損益勘定
           10  FILLER              PIC  X(13)  VALUE  "SJTK_RKSEKJ, ".
      *----------  市場通貨源泉税還付予定異動額
           10  FILLER              PIC  X(19)  VALUE
               "SJTK_GSZKP_YTIDOG, ".
      *----------  運用通貨払出簿価
           10  FILLER              PIC  X(13)  VALUE  "UYTK_H_BOKA, ".
      *----------  運用通貨売買損益
           10  FILLER              PIC  X(14)  VALUE  "UYTK_BBSNEKI, ".
      *----------  運用通貨前払金異動額
           10  FILLER              PIC  X(15)  VALUE  "UYTK_PPAYIDOG, ".
      *----------  運用通貨利金等損益勘定
           10  FILLER              PIC  X(13)  VALUE  "UYTK_RKSEKJ, ".
      *----------  運用通貨源泉税還付予定異動額
           10  FILLER              PIC  X(19)  VALUE
               "UYTK_GSZKP_YTIDOG, ".
      *----------  為替差損益
           10  FILLER              PIC  X(16)  VALUE
               "UYTK_KWS_SNEKI, ".
      *----------  為替差損益（利金）
           10  FILLER              PIC  X(19)  VALUE
               "UYTK_KWS_SNEKI_RK, ".
      *----------  為替差損益（市場）
           10  FILLER              PIC  X(18)  VALUE
               "UYTK_KWS_SNEKI_SJ ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-12       PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "TORI_ID = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_TORI_ID".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE ":P_PTF_CD".
      *----------  削除区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "SAKUJO_KBN = ".
           10  FILLER              PIC  X(13)  VALUE  ":P_SAKUJO_KBN".
      *----------  赤黒区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "AKA_KBN = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_AKA_KBN".
      ******************************************************************
      *                エラーメッセージ
      ******************************************************************
       01  E-MSG-TBL.
      *---------- SELECT SQL文(別紙1-1,別紙1-5)
         05  WK-MSG-1-1.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMXTR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
      *---------- SELECT SQL文(別紙1-2)
         05  WK-MSG-1-2.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW06     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(17)  VALUE
               " AND SYORI_YMD = ".
           10  WK-SYORI-YMD        PIC  9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID         PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(29)  VALUE
               "' AND TKMXTR00.RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-2    PIC  X(04).
           10  FILLER              PIC  X(25)  VALUE
               "' AND TKMXTR00.TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
           10  FILLER              PIC  X(07)  VALUE
               " UNION ".
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZZI00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-1    PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-1        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-1         PIC  X(04).
           10  FILLER              PIC  X(29)  VALUE
               "' AND KEIJOU_KIJUNBI BWTWEEN ".
           10  WK-KAISI-KJN-YMD-NEXT
                                   PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE
               " AND ".
           10  WK-KEIJOU-KIJUNBI   PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND THRK_ID <> ".
           10  WK-THRK-ID          PIC  S9(10).
           10  FILLER              PIC  X(28)  VALUE
               " AND TKMXTR00.RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-3    PIC  X(04).
           10  FILLER              PIC  X(25)  VALUE
               "' AND TKMXTR00.TORI_ID = ".
           10  WK-TORI-ID-1        PIC  S9(10).
      *---------- SELECT SQL文(別紙1-3)
         05  WK-MSG-1-3.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZZR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(29)  VALUE
               "' AND TKMXTR00.RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-1    PIC  X(04).
           10  FILLER              PIC  X(25)  VALUE
               "' AND TKMXTR00.TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
           10  FILLER              PIC  X(24)  VALUE
               " AND TKMZZR00.KJN_YMD = ".
           10  WK-KJN-YMD          PIC  9(08).
      *---------- SELECT SQL文(別紙1-4)
         05  WK-MSG-1-4.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMXTR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               " AND TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
      *---------- SELECT SQL文(別紙1-6)
         05  WK-MSG-1-6.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMXTI00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
           10  FILLER              PIC  X(15)  VALUE
               " AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SAKUJO_KBN ='".
           10  WK-SAKUJO-KBN       PIC  X(01).
           10  FILLER              PIC  X(16)  VALUE
               "' AND AKA_KBN ='".
           10  WK-AKA-KBN          PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE
               "'".
      *---------- SELECT SQL文(別紙1-9)
         05  WK-MSG-1-9.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW04     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(13)  VALUE
               " SYORI_YMD = ".
           10  WK-SYORI-YMD        PIC  9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID         PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND KJN_YMD ='".
           10  WK-KJN-YMD          PIC  S9(08).
           10  FILLER              PIC  X(15)  VALUE
               "' AND MEG_CD ='".
           10  WK-MEG-CD           PIC  X(15).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC_SBT_CD ='".
           10  WK-SEC-SBT-CD       PIC  X(04).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG         PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID         PIC  X(10).
           10  FILLER              PIC  X(16)  VALUE
               "' AND TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
           10  FILLER              PIC  X(21)  VALUE
               " AND ZOFKU_AKA_KBN = ".
           10  WK-ZOFKU-AKA-KBN    PIC  X(01).
      *---------- SELECT SQL文(別紙1-10)
         05  WK-MSG-1-10.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW06     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(17)  VALUE
               " AND SYORI_YMD = ".
           10  WK-SYORI-YMD        PIC  9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID         PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
      *---------- SELECT SQL文(別紙1-11)
         05  WK-MSG-1-11.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMXTR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
      *---------- SELECT SQL文(別紙1-12)
         05  WK-MSG-1-12.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMXTI00-1   PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND TORI_ID = ".
           10  WK-TORI-ID          PIC  S9(10).
           10  FILLER              PIC  X(15)  VALUE
               " AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SAKUJO_KBN ='".
           10  WK-SAKUJO-KBN       PIC  X(01).
           10  FILLER              PIC  X(16)  VALUE
               "' AND AKA_KBN ='".
           10  WK-AKA-KBN          PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE
               "'".
      ******************************************************************
      *                 サブプログラム  パラメ－タ  エリア
      ******************************************************************
      *----------  SCZY1160 テーブルID取得ルーチン
       01  PARM-SCZY1160-INOUT.
           COPY  "SCZY1160.cpy".
      *---------- TKMZBW06挿入ルーチン
       01  PARM-INSERT-INOUT.
         05  PARM-INSERT-ARG1.
      *----------  利用会社コード
           10  RIYO-CMP-CD         PIC  X(04).
         05  PARM-INSERT-ARG2.
      *----------  DBレイアウトコピー句
           10  TBL-LAYOUT.
             COPY  "TKMZBW06.cpy".
       01  PARM-INSERT-RTNPKG.
         05  PARM-INSERT-ARG3.
      *----------  RTNパッケージ
           10  RTN-PACKAGE.
             COPY  "CZRTNPACKAGE.cpy".
      *----------  SMZJ1911異動簿価・損益計算(物)-計算詳細セットルーチン
       01  PARM-SMZJ1911-INOUT.
           COPY  "SMZJ1911.cpy".
      *----------  SMZJ1912異動簿価・損益計算(物)-素データ分析ルーチン
       01  PARM-SMZJ1912-INOUT.
           COPY  "SMZJ1912.cpy".
      *----------  SMZJ1913一口売却計算サブルーチン
       01  PARM-SMZJ1913-INOUT.
           COPY  "SMZJ1913.cpy".
      *----------  SMZJ1914赤の残高異動編集ルーチン
       01  PARM-SMZJ1914-INOUT.
           COPY  "SMZJ1914.cpy".
      *----------  SMZJ1915先物よりオプション側仕訳基準取得ルーチン
       01  PARM-SMZJ1915-INOUT.
           COPY  "SMZJ1915.cpy".
      *----------  SMZJ1916仕訳フラグ編集ルーチン
       01  PARM-SMZJ1916-INOUT.
           COPY  "SMZJ1916.cpy".
      *----------  SMZJ1921増減情報判断ルーチン
       01  PARM-SMZJ1921-INOUT.
           COPY  "SMZJ1921.cpy".
      *----------  SMZJ1930仕訳計算（物）サブルーチン
       01  PARM-SMZJ1930-INOUT.
           COPY  "SMZJ1930.cpy".
      *----------  SMZJ4012取引事由判定ルーチン
       01  PARM-SMZJ4012-INOUT.
           COPY  "SMZJ4012.cpy".
      *----------  SMZJ4014証券種別判定ルーチン
       01  PARM-SMZJ4014-INOUT.
           COPY  "SMZJ4014.cpy".
      *----------  SMZJ4015計算パターン決定ルーチン
       01  PARM-SMZJ4015-INOUT.
           COPY  "SMZJ4015.cpy".
      *----------  SMZC1950数量計算ルーチン
       01  PARM-SMZC1950-INOUT.
           COPY  "SMZC1950.cpy".
      *----------  SMZC1400異動計算-個別項目計算３ルーチン
       01  PARM-SMZC1400-INOUT.
           COPY  "SMZC1400.cpy".
      *----------  SMZC1402異動計算-個別項目計算５ルーチン
       01  PARM-SMZC1402-INOUT.
           COPY  "SMZC1402.cpy".
      *----------  SMZC1403異動計算-個別項目計算６ルーチン
       01  PARM-SMZC1403-INOUT.
           COPY  "SMZC1403.cpy".
      *----------  SMZC1404異動計算-個別項目計算７ルーチン
       01  PARM-SMZC1404-INOUT.
           COPY  "SMZC1404.cpy".
      *----------  SMZC1405異動計算-個別項目計算８ルーチン
       01  PARM-SMZC1405-INOUT.
           COPY  "SMZC1405.cpy".
      *----------  SMZC1406異動計算-個別項目計算９ルーチン
       01  PARM-SMZC1406-INOUT.
           COPY  "SMZC1406.cpy".
      *----------  SMZC1407異動計算-個別項目計算１０ルーチン
       01  PARM-SMZC1407-INOUT.
           COPY  "SMZC1407.cpy".
      *----------  SMZC1408異動計算-個別項目計算１１ルーチン
       01  PARM-SMZC1408-INOUT.
           COPY  "SMZC1408.cpy".
      *----------  SMZC1410異動計算-個別項目計算１３ルーチン
       01  PARM-SMZC1410-INOUT.
           COPY  "SMZC1410.cpy".
      *----------  SMZC1411異動計算-個別項目計算１４ルーチン
       01  PARM-SMZC1411-INOUT.
           COPY  "SMZC1411.cpy".
      *----------  SMZC1412異動計算-個別項目計算１５ルーチン
       01  PARM-SMZC1412-INOUT.
           COPY  "SMZC1412.cpy".
      *----------  SMZC1413異動計算-個別項目計算１６ルーチン
       01  PARM-SMZC1413-INOUT.
           COPY  "SMZC1413.cpy".
      *----------  SMZC1414異動計算-個別項目計算１７ルーチン
       01  PARM-SMZC1414-INOUT.
           COPY  "SMZC1414.cpy".
      *----------  SMZC1415異動計算-個別項目計算１８ルーチン
       01  PARM-SMZC1415-INOUT.
           COPY  "SMZC1415.cpy".
      *----------  SMZC1416異動計算-個別項目計算１９ルーチン
       01  PARM-SMZC1416-INOUT.
           COPY  "SMZC1416.cpy".
      *----------  SMZC1417異動計算-個別項目計算２０ルーチン
       01  PARM-SMZC1417-INOUT.
           COPY  "SMZC1417.cpy".
      *----------  SMZC1418異動計算-個別項目計算２１ルーチン
       01  PARM-SMZC1418-INOUT.
           COPY  "SMZC1418.cpy".
      *----------  SMZC1419異動計算-個別項目計算２２ルーチン
       01  PARM-SMZC1419-INOUT.
           COPY  "SMZC1419.cpy".
      *----------  SMZC1951簿価計算ルーチン
       01  PARM-SMZC1951-INOUT.
           COPY  "SMZC1951.cpy".
      *----------  SMZC1952前払金計算ルーチン
       01  PARM-SMZC1952-INOUT.
           COPY  "SMZC1952.cpy".
      *----------  SMZC1953売買損益計算ルーチン
       01  PARM-SMZC1953-INOUT.
           COPY  "SMZC1953.cpy".
      *----------  SMZC1954その他損益計算ルーチン
       01  PARM-SMZC1954-INOUT.
           COPY  "SMZC1954.cpy".
      *----------  SMZC1955損益勘定計算ルーチン
       01  PARM-SMZC1955-INOUT.
           COPY  "SMZC1955.cpy".
      *----------  SMZC1956建玉計算ルーチン
       01  PARM-SMZC1956-INOUT.
           COPY  "SMZC1956.cpy".
      *----------  SMZC1957源泉税還付予定計算ルーチン
       01  PARM-SMZC1957-INOUT.
           COPY  "SMZC1957.cpy".
      *----------  SMZC1959ノンカバー未収未払計算ルーチン
       01  PARM-SMZC1959-INOUT.
           COPY  "SMZC1959.cpy".
      *----------  SMZC1960未払費用計算ルーチン
       01  PARM-SMZC1960-INOUT.
           COPY  "SMZC1960.cpy".
      *----------  SMZC1961移管項目計算ルーチン
       01  PARM-SMZC1961-INOUT.
           COPY  "SMZC1961.cpy".
      *----------  SCZY4502為替換算情報取得ルーチン
       01  PARM-SCZY4502-INOUT.
           COPY  "SCZY4502.cpy".
      *----------  SCZY1170 リターンパッケージセットルーチン
       01  PARM-SCZY1170-IN.
      *----------  リターンパッケージセットルーチンコピー句
           COPY  "SCZY1170.cpy".
       01  PARM-SCZY1170-RTNPKG.
         05  PARM-SCZY1170-ARG2.
      *----------  RTNパッケージ
           COPY  "CZRTNPACKAGE.cpy".
       01  PARM-RTNPKG.
         05  PARM-RTNPKG-ARG.
           COPY  "CZRTNPACKAGE.cpy".
      *----------  SMZJ1917債券ダミー切替判定
       01  PARM-SMZJ1917-INOUT.
           COPY  "SMZJ1917.cpy".
      ******************************************************************
      *                 連絡節
      ******************************************************************
       LINKAGE                SECTION.
       01  PARM-SMZJ1910-INOUT.
           COPY  "SMZJ1910.cpy".
       01  PARM-SMZJ1910-RTNPKG.
         05  PARM-SMZJ1910-ARG3.
           COPY  "CZRTNPACKAGE.cpy".
      ******************************************************************
      *
      *                 手 続 き 部
      *
      ******************************************************************
       PROCEDURE              DIVISION
           USING  PARM-SMZJ1910-INOUT
                  PARM-SMZJ1910-RTNPKG.
      ******************************************************************
      *                 異動簿価・損益計算(物)
      ******************************************************************
       BASE-RTN               SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ***  SMZJ1910処理  START  ***"
      *-----------------------------------------------------------------
      *----------  3.1 前処理
           PERFORM  INIT-RTN
      *----------  3.2 主処理
           PERFORM  MAIN-RTN
      *----------  3.3 後処理
           PERFORM  END-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ***  SMZJ1910処理  正常終了  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       BASE-EXT.
           GOBACK.
      ******************************************************************
      *                 3.1 前処理
      ******************************************************************
       INIT-RTN               SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  前処理  START  ***"
      *-----------------------------------------------------------------
      *----------  3.1.1 初期化処理
           PERFORM  INITIALIZE-RTN
      *----------  3.1.2 テーブルID取得処理
           PERFORM  TBLID-GET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ***  前処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       INIT-EXT.
           EXIT.
      ******************************************************************
      *        3.1.1 初期化処理
      ******************************************************************
       INITIALIZE-RTN         SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":***  初期化処理  START  ***"
      *-----------------------------------------------------------------
      *----------  初期化
           INITIALIZE     WORK-AREA
                          FLG-AREA
                          HST-AREA
                          SQL-AREA
                          E-MSG-TBL
                          PARM-SCZY1160-INOUT
                          PARM-SMZJ1911-INOUT
                          PARM-SMZJ1912-INOUT
                          PARM-SMZJ1913-INOUT
                          PARM-SMZJ1914-INOUT
                          PARM-SMZJ1915-INOUT
                          PARM-SMZJ1916-INOUT
                          PARM-SMZJ1921-INOUT
                          PARM-SMZJ1930-INOUT
                          PARM-SMZJ4012-INOUT
                          PARM-SMZJ4014-INOUT
                          PARM-SMZJ4015-INOUT
                          PARM-SMZC1950-INOUT
                          PARM-SMZC1400-INOUT
                          PARM-SMZC1402-INOUT
                          PARM-SMZC1403-INOUT
                          PARM-SMZC1404-INOUT
                          PARM-SMZC1405-INOUT
                          PARM-SMZC1406-INOUT
                          PARM-SMZC1407-INOUT
                          PARM-SMZC1408-INOUT
                          PARM-SMZC1410-INOUT
                          PARM-SMZC1411-INOUT
                          PARM-SMZC1412-INOUT
                          PARM-SMZC1413-INOUT
                          PARM-SMZC1414-INOUT
                          PARM-SMZC1415-INOUT
                          PARM-SMZC1416-INOUT
                          PARM-SMZC1417-INOUT
                          PARM-SMZC1418-INOUT
                          PARM-SMZC1419-INOUT
                          PARM-SMZC1951-INOUT
                          PARM-SMZC1952-INOUT
                          PARM-SMZC1953-INOUT
                          PARM-SMZC1954-INOUT
                          PARM-SMZC1955-INOUT
                          PARM-SMZC1956-INOUT
                          PARM-SMZC1957-INOUT
                          PARM-SMZC1959-INOUT
                          PARM-SMZC1960-INOUT
                          PARM-SMZC1961-INOUT
                          PARM-SCZY4502-INOUT
                          PARM-SCZY1170-IN
                          PARM-SCZY1170-RTNPKG
                          PARM-RTNPKG
                          PARM-SMZJ1910-ARG2  OF  PARM-SMZJ1910-INOUT
                          PARM-SMZJ1910-RTNPKG
                          PARM-SMZJ1917-INOUT
      *-----------------------------------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FIRST-SW            =["FIRST-SW"]"      @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *-----  初回ＣＡＬＬ時のみフラグエリアの初期化を行う              @3212SEINO@
           IF     FIRST-SW = 'YES'                                      @3212SEINO@
           THEN                                                         @3212SEINO@
                  INITIALIZE              FLG-AREA2                     @3212SEINO@
                  MOVE  'NO '         TO  FIRST-SW                      @3212SEINO@
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
           END-IF                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FIRST-SW  = ["FIRST-SW"]"               @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-AREA         = ["FLG-AREA2"]"       @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":WORK-AREA        = ["WORK-AREA"]"
      D    DISPLAY  CNS-PGM-ID":FLG-AREA         = ["FLG-AREA"]"
      D    DISPLAY  CNS-PGM-ID":HST-AREA         = ["HST-AREA"]"
      D    DISPLAY  CNS-PGM-ID":SQL-AREA         = ["SQL-AREA"]"
      D    DISPLAY  CNS-PGM-ID":E-MSG-TBL        = ["E-MSG-TBL"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SCZY1160-INOUT = ["
      D             PARM-SCZY1160-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1911-INOUT = ["
      D             PARM-SMZJ1911-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1912-INOUT = ["
      D             PARM-SMZJ1912-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1913-INOUT = ["
      D             PARM-SMZJ1913-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1914-INOUT = ["
      D             PARM-SMZJ1914-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1915-INOUT = ["
      D             PARM-SMZJ1915-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1916-INOUT = ["
      D             PARM-SMZJ1916-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1921-INOUT = ["
      D             PARM-SMZJ1921-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1930-INOUT = ["
      D             PARM-SMZJ1930-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ4012-INOUT = ["
      D             PARM-SMZJ4012-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ4014-INOUT = ["
      D             PARM-SMZJ4014-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ4015-INOUT = ["
      D             PARM-SMZJ4015-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1400-INOUT = ["
      D             PARM-SMZC1400-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1402-INOUT = ["
      D             PARM-SMZC1402-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1403-INOUT = ["
      D             PARM-SMZC1403-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1404-INOUT = ["
      D             PARM-SMZC1404-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1405-INOUT = ["
      D             PARM-SMZC1405-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1406-INOUT = ["
      D             PARM-SMZC1406-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1407-INOUT = ["
      D             PARM-SMZC1407-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1408-INOUT = ["
      D             PARM-SMZC1408-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1410-INOUT = ["
      D             PARM-SMZC1410-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1411-INOUT = ["
      D             PARM-SMZC1411-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1412-INOUT = ["
      D             PARM-SMZC1412-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1413-INOUT = ["
      D             PARM-SMZC1413-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1414-INOUT = ["
      D             PARM-SMZC1414-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1415-INOUT = ["
      D             PARM-SMZC1415-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1416-INOUT = ["
      D             PARM-SMZC1416-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1417-INOUT = ["
      D             PARM-SMZC1417-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1418-INOUT = ["
      D             PARM-SMZC1418-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1419-INOUT = ["
      D             PARM-SMZC1419-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1950-INOUT = ["
      D             PARM-SMZC1950-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1951-INOUT = ["
      D             PARM-SMZC1951-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1952-INOUT = ["
      D             PARM-SMZC1952-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1953-INOUT = ["
      D             PARM-SMZC1953-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1954-INOUT = ["
      D             PARM-SMZC1954-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1955-INOUT = ["
      D             PARM-SMZC1955-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1956-INOUT = ["
      D             PARM-SMZC1956-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1957-INOUT = ["
      D             PARM-SMZC1957-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1959-INOUT = ["
      D             PARM-SMZC1959-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1960-INOUT = ["
      D             PARM-SMZC1960-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZC1961-INOUT = ["
      D             PARM-SMZC1961-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SCZY4502-INOUT = ["
      D             PARM-SCZY4502-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SCZY1170-IN = ["PARM-SCZY1170-IN"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SCZY1170-RTNPKG= ["
      D             PARM-SCZY1170-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG = ["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1910-ARG2  = ["
      D             PARM-SMZJ1910-ARG2   OF  PARM-SMZJ1910-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1910-RTNPKG= ["
      D             PARM-SMZJ1910-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1917-INOUT = ["
      D             PARM-SMZJ1917-INOUT"]"
      *-----------------------------------------------------------------
           MOVE  CNS-RTN-000
             TO  RTN-CD                  OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD  OF  PARM-SCZY1170-ARG1 = ["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  取引データ
           MOVE  TORI-DATA               OF  PARM-SMZJ1910-ARG1
             TO  WK-TORI-DATA            OF  WK-DATA-IN
      *----------  相対取引データ
           MOVE  AITAI-TRHK-DATA         OF  PARM-SMZJ1910-ARG1
             TO  WK-AITAI-TRHK-DATA      OF  WK-DATA-IN
      *----------  異動計算パターン
           MOVE  YIDOU-CALC-PARM         OF  PARM-SMZJ1910-ARG1
             TO  WK-YIDOU-CALC-PARM      OF  WK-DATA-IN
      *----------  直前残高異動
           MOVE  TZ-ZN-IDO               OF  PARM-SMZJ1910-ARG1
             TO  WK-TZ-ZN-IDO            OF  WK-DATA-IN
      *----------  通貨デフォールト端数処理
           MOVE  TUKA-DEF-HASU-SYRI-PARM
             OF  PARM-SMZJ1910-ARG1
             TO  WK-TUKA-DEF-HASU-SYRI-PARM
             OF  WK-DATA-IN
      *----------  基準日断面情報
           MOVE  KYJ-YMD-DMN-INFO        OF  PARM-SMZJ1910-ARG1
             TO  WK-KYJ-YMD-DMN-INFO     OF  WK-DATA-IN
      *----------  銘柄別断面情報
           MOVE  MEG-BETU-DMN-INFO       OF  PARM-SMZJ1910-ARG1
             TO  WK-MEG-BETU-DMN-INFO    OF  WK-DATA-IN
      *----------  対象取引情報
           MOVE  TARGET-TORI-INFO        OF  PARM-SMZJ1910-ARG1
             TO  WK-TARGET-TORI-INFO     OF  WK-DATA-IN
      *----------  売り続く限りフラグ
           MOVE  URI-TUDUKU-KAGI-FLG     OF  PARM-SMZJ1910-ARG1
             TO  WK-URI-TUDUKU-KAGI-FLG  OF  WK-DATA-IN
      *----------  市場通貨コード
           MOVE  SIJO-TUKA-CD            OF  PARM-SMZJ1910-ARG1
             TO  WK-SIJO-TUKA-CD         OF  WK-DATA-IN
      *----------  勘定科目出力商品名
           MOVE  KNJ-KAMK-OUT-SYOHIN     OF  PARM-SMZJ1910-ARG1
             TO  WK-KNJ-KAMK-OUT-SYOHIN  OF  WK-DATA-IN
      *----------  仕訳基準データ
           MOVE  SKJN-DATA               OF  PARM-SMZJ1910-ARG1
             TO  WK-SWK-KJN-DATA         OF  WK-DATA-IN
      *----------  キャッシュフロー2回有効フラグ
           MOVE  CASH-FLOW-2-FLG         OF  PARM-SMZJ1910-ARG1
             TO  WK-CASH-FLOW-2-FLG      OF  WK-DATA-IN
      *----------  銘柄属性取得フラグ
           MOVE  MEG-ZOK-FLG             OF  PARM-SMZJ1910-ARG1
             TO  WK-MEG-ZOK-FLG          OF  WK-DATA-IN
      *----------  約定ベース受渡順フラグ
           MOVE  YKJ-UKE-JUN-FLG         OF  PARM-SMZJ1910-ARG1
             TO  WK-YKJ-UKE-JUN-FLG      OF  WK-DATA-IN
      *---------- 乗算/除算区分
           MOVE  JZ-JS-KBN               OF  PARM-SMZJ1910-ARG1
             TO  WK-JZ-JS-KBN-IN         OF  WK-DATA-IN
      *---------- 銘柄属性コールプット区分
           MOVE  MEG-CALL-PUT-KBN        OF  PARM-SMZJ1910-ARG1
             TO  WK-MEG-CALL-PUT-KBN     OF  WK-DATA-IN
      *---------- ゼロクーポン債フラグ
           MOVE  ZERO-CUPON-FLG          OF  PARM-SMZJ1910-ARG1
             TO  WK-ZERO-CUPON-FLG       OF  WK-DATA-IN
      *----------  銘柄属性データ
           MOVE  MEG-SKJO-DATA           OF  PARM-SMZJ1910-ARG1
             TO  WK-MEG-SKJO-DATA        OF  WK-DATA-IN
      *---------- 勘定異動／残高作成
           MOVE  KJIDO-ZANSK             OF  PARM-SMZJ1910-ARG1
             TO  WK-KJIDO-ZANSK          OF  WK-DATA-IN
      *----------  利付／割引区分
           MOVE  RITUKI-WARI-KBN         OF  PARM-SMZJ1910-ARG1
             TO  WK-RITUKI-WARI-KBN      OF  WK-DATA-IN
      *----------  国内外国区分
           MOVE  NAI-GAI-KBN             OF  PARM-SMZJ1910-ARG1
             TO  WK-NAI-GAI-KBN          OF  WK-DATA-IN
      *---------- 決済口座１通貨コード
           MOVE  KOZA1-TUKA-CD           OF  PARM-SMZJ1910-ARG1
             TO  WK-KOZA1-TUKA-CD        OF  WK-DATA-IN
      *---------- 決済口座２通貨コード
           MOVE  KOZA2-TUKA-CD           OF  PARM-SMZJ1910-ARG1
             TO  WK-KOZA2-TUKA-CD        OF  WK-DATA-IN
      *---------- 入出金額（決済レート・運用通貨換算額）
           MOVE  NSKG-K-UY               OF  PARM-SMZJ1910-ARG1
             TO  WK-NSKG-K-UY            OF  WK-DATA-IN
      *---------- 決済口座１入出金額
           MOVE  KOZA1-NSKG              OF  PARM-SMZJ1910-ARG1
             TO  WK-KOZA1-NSKG           OF  WK-DATA-IN
      *----------  銘柄属性データ2
           MOVE  MEG-SKJO-DATA-2         OF  PARM-SMZJ1910-ARG1
             TO  WK-MEG-SKJO-DATA-2      OF  WK-DATA-IN
      *----------  銘柄属性データ3
           MOVE  MEG-SKJO-DATA-3         OF  PARM-SMZJ1910-ARG1
             TO  WK-MEG-SKJO-DATA-3      OF  WK-DATA-IN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ              =["
      D             WK-TORI-DATA         OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":相対取引データ          =["
      D             WK-AITAI-TRHK-DATA   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン        =["
      D             WK-YIDOU-CALC-PARM   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動            =["
      D             WK-TZ-ZN-IDO         OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             WK-TUKA-DEF-HASU-SYRI-PARM  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報          =["
      D             WK-KYJ-YMD-DMN-INFO  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報          =["
      D             WK-MEG-BETU-DMN-INFO  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報            =["
      D             WK-TARGET-TORI-INFO  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限りフラグ      =["
      D             WK-URI-TUDUKU-KAGI-FLG  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード          =["
      D             WK-SIJO-TUKA-CD      OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":勘定科目出力商品名      =["
      D             WK-KNJ-KAMK-OUT-SYOHIN  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準データ          =["
      D             WK-SWK-KJN-DATA      OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー2回有効フラグ=["
      D             WK-CASH-FLOW-2-FLG   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性取得フラグ=["
      D             WK-MEG-ZOK-FLG       OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ=["
      D             WK-YKJ-UKE-JUN-FLG   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":乗算/除算区分=["
      D             WK-JZ-JS-KBN-IN      OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性コールプット区分=["
      D             WK-MEG-CALL-PUT-KBN  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":ゼロクーポン債フラグ=["
      D             WK-ZERO-CUPON-FLG    OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ=["
      D             WK-MEG-SKJO-DATA     OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":利付／割引区分=["
      D             WK-RITUKI-WARI-KBN   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":勘定異動／残高作成                   =["
      D             WK-KJIDO-ZANSK       OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":利付／割引区分                       =["
      D             WK-RITUKI-WARI-KBN   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID"20100526  テーマ2679  START"
      D    DISPLAY  CNS-PGM-ID":国内外国区分                         =["
      D             WK-NAI-GAI-KBN       OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１通貨コード=["
      D             WK-KOZA1-TUKA-CD     OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":決済口座２通貨コード=["
      D             WK-KOZA2-TUKA-CD     OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":入出金額(決済レート・運用通貨換算額)=["
      D             WK-NSKG-K-UY         OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１入出金額=["
      D             WK-KOZA1-NSKG        OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID"20100526  テーマ2679  END"
      D    DISPLAY  CNS-PGM-ID":***  初期化処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       INITIALIZE-EXT.
           EXIT.
      ******************************************************************
      *    3.1.2 テーブルID取得処理
      ******************************************************************
       TBLID-GET-RTN          SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  テーブルID取得  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1160-INOUT
                       PARM-RTNPKG
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-KYJ-YMD-DMN-INFO
             TO  RIYO-CMP-CD             OF  PARM-SCZY1160-ARG1
      *----------  取引テーブル
           MOVE  CNS-TBL-TKMXTR00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(1)
      *----------  残高異動計算データテーブル
           MOVE  CNS-TBL-TKMZBW06
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(2)
      *----------  残高異動テーブル
           MOVE  CNS-TBL-TKMZZI00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(3)
      *----------  取引異動テーブル
           MOVE  CNS-TBL-TKMXTI00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(4)
      *----------  対象取引情報テーブル
           MOVE  CNS-TBL-TKMZBW04
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(5)
      *----------  残高履歴情報テーブル
           MOVE  CNS-TBL-TKMZZR00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(6)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD  OF PARM-SCZY1160-ARG1=["
      D             RIYO-CMP-CD          OF  PARM-SCZY1160-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":TBL-ID   OF PARM-SCZY1160-ARG1(1)=["
      D             TBL-ID               OF  PARM-SCZY1160-ARG1(1)"]"
      D    DISPLAY  CNS-PGM-ID":TBL-ID   OF PARM-SCZY1160-ARG1(2)=["
      D             TBL-ID               OF  PARM-SCZY1160-ARG1(2)"]"
      D    DISPLAY  CNS-PGM-ID":TBL-ID   OF PARM-SCZY1160-ARG1(3)=["
      D             TBL-ID               OF  PARM-SCZY1160-ARG1(3)"]"
      D    DISPLAY  CNS-PGM-ID":TBL-ID   OF PARM-SCZY1160-ARG1(4)=["
      D             TBL-ID               OF  PARM-SCZY1160-ARG1(4)"]"
      D    DISPLAY  CNS-PGM-ID":TBL-ID   OF PARM-SCZY1160-ARG1(5)=["
      D             TBL-ID               OF  PARM-SCZY1160-ARG1(5)"]"
      D    DISPLAY  CNS-PGM-ID":TBL-ID   OF PARM-SCZY1160-ARG1(6)=["
      D             TBL-ID               OF  PARM-SCZY1160-ARG1(6)"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1160"              USING  PARM-SCZY1160-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1160)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  ワーク取引テーブル
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(1)
               TO  WK-TBL-TKMXTR00       OF  WK-MSG-1-1,
                   WK-TBL-TKMXTR00       OF  WK-MSG-1-4,
                   SQL-TBL-ID-1,
                   SQL-TBL-TKMXTR00-1    OF  SQL-SELECT-1-2,
                   SQL-TBL-TKMXTR00-N1   OF  SQL-SELECT-1-2,
                   SQL-TBL-TKMXTR00-N2   OF  SQL-SELECT-1-2,
                   SQL-TBL-TKMXTR00      OF  SQL-SELECT-1-3,
                   SQL-TBL-ID-4,
                   SQL-TBL-ID-5,
                   SQL-TBL-ID-111        OF  SQL-SELECT-1-11,
                   WK-TBL-TKMXTR00       OF  WK-MSG-1-11
      *----------  ワーク残高異動計算データテーブル
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(2)
               TO  WK-TBL-TKMZBW06       OF  WK-MSG-1-2,
                   WK-TBL-TKMZBW06       OF  WK-MSG-1-10,
                   SQL-TBL-ID-2-A,
                   SQL-TBL-ID-2-B,
                   SQL-TBL-ID-10
      *----------  ワーク残高異動テーブル
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(3)
               TO  WK-TBL-TKMZZI00       OF  WK-MSG-1-2,
                   SQL-TBL-TKMZZI00-N1   OF  SQL-SELECT-1-2,
                   SQL-TBL-TKMZZI00-N2   OF  SQL-SELECT-1-2
      *----------  ワーク取引異動テーブル
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(4)
               TO  WK-TBL-TKMXTI00,
                   SQL-TBL-ID-6,
                   WK-TBL-TKMXTI00-1,
                   SQL-TBL-ID-12
      *----------  ワーク対象取引情報テーブル
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(5)
               TO  WK-TBL-TKMZBW04,
                   SQL-TBL-ID-9
      *----------  ワーク残高履歴テーブル
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(6)
               TO  WK-TBL-TKMZZR00,
                   SQL-TBL-ID-11
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引テーブル              =["
      D             WK-TBL-TKMXTR00     OF  WK-MSG-1-1"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データテーブル=["
      D             WK-TBL-TKMZBW06     OF  WK-MSG-1-2"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動テーブル          =["
      D             SQL-TBL-TKMXTR00-N1"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動テーブル          =["
      D             WK-TBL-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報テーブル      =["
      D             WK-TBL-TKMZBW04"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴テーブル          =["
      D             WK-TBL-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対応本体取引異動テーブル  =["
      D             WK-TBL-TKMXTI00-1"]"
      *-----------------------------------------------------------------
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-001
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":テーブルID取得処理  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  テーブルID取得  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TBLID-GET-EXT.
           EXIT.
      ******************************************************************
      *                 3.2 主処理
      ******************************************************************
       MAIN-RTN               SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": *****  主処理  START  *****"
      *-----------------------------------------------------------------
      *----------  3.2.1.異動・損益計算
           PERFORM  IDO-SONEKI-CALC-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":勘定異動／残高作成                   =["
      D             WK-KJIDO-ZANSK        OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.取引事由                  =["
      D             WK-TORI-JIYU          OF  WK-TORI-DATA
      D                                   OF  WK-DATA-IN"]"
      *-----------------------------------------------------------------
           IF  WK-KJIDO-ZANSK             OF  WK-DATA-IN  NOT
            =  CNS-KJIDO-ZANSK-2
           AND  (WK-TORI-JIYU             OF  WK-TORI-DATA
                                          OF  WK-DATA-IN
                NOT  =  'FTSQ'
           AND  NOT  =  'DMY2'
           AND  NOT  =  'DMY4'
           AND  NOT  =  'MINS'
           AND  NOT  =  'MOTS'
           AND  NOT  =  'REDU'
           AND  NOT  =  'CISL'
           AND  NOT  =  'FEX'
           AND  NOT  =  'OATB'
           AND  NOT  =  'SINH'
           AND  NOT  =  'SOUH')
           THEN
      *----------  3.2.3.勘定異動作成
             PERFORM  KANJYOU-IDO-RTN
           ELSE
             CONTINUE
           END-IF
      *----------  3.2.5.異動計算データインサート
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.取引事由= ["
      D             WK-TORI-JIYU        OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク約定ベース消費税受渡計上=["
      D             WK-YKJ-SHOHI-JUN"]"
      *-----------------------------------------------------------------
           IF  (WK-TORI-JIYU            OF  WK-ZN-IDO-CALC-DATE
            =  CNS-TORI-JIYU-STXP  OR
               WK-TORI-JIYU             OF  WK-ZN-IDO-CALC-DATE
            =  CNS-TORI-JIYU-CSOP  OR
               WK-TORI-JIYU             OF  WK-ZN-IDO-CALC-DATE
            =  CNS-TORI-JIYU-CSTP) AND  WK-YKJ-SHOHI-JUN = CNS-FLG-0
           THEN
             MOVE  ZERO
               TO  WK-SJTK-ELS-SNEKI    OF  WK-ZN-IDO-CALC-DATE
             MOVE  ZERO
               TO  WK-UYTK-ELS-SNEKI    OF  WK-ZN-IDO-CALC-DATE
             MOVE  ZERO
               TO  WK-SJTK-S-TAX        OF  WK-ZN-IDO-CALC-DATE
             MOVE  ZERO
               TO  WK-UYTK-S-TAX        OF  WK-ZN-IDO-CALC-DATE
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨その他損益= ["
      D             WK-SJTK-ELS-SNEKI   OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨その他損益= ["
      D             WK-UYTK-ELS-SNEKI   OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨消費税= ["
      D             WK-SJTK-S-TAX       OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨消費税= ["
      D             WK-UYTK-S-TAX       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           PERFORM  TKMZBW06-INSERT-RTN
      *----------  3.2.6.ARG2セット
           PERFORM  ARG2-SET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*****  主処理  END  *****"
      *-----------------------------------------------------------------
           CONTINUE.
       MAIN-EXT.
           EXIT.
      ******************************************************************
      *        3.2.1.異動・損益計算
      ******************************************************************
       IDO-SONEKI-CALC-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  異動・損益計算  START  ***"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.対象取引情報.増幅区分    =["
      D             WK-ZOFKU-KBN         OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.対象取引情報.増幅赤黒区分=["
      D             WK-ZOFKU-AKA-KBN     OF  WK-TARGET-TORI-INFO"]"
      *-----------------------------------------------------------------
           IF  WK-ZOFKU-KBN  OF  WK-TARGET-TORI-INFO = CNS-KBN-1
             AND  WK-ZOFKU-AKA-KBN  OF  WK-TARGET-TORI-INFO = CNS-KBN-1
           THEN
      *----------  赤増幅編集処理
             PERFORM  SMZJ1914-RTN
           ELSE
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
             IF  WK-TORI-JIYU            OF  WK-TORI-DATA  NOT
              =  CNS-TORI-JIYU-RETR
             THEN
      *----------  取引異動データを取得する
               PERFORM  TORI-IDO-SET-RTN
      *----------  対応本体の取引の取引異動データを取得する
               PERFORM  TAIOU-TORI-IDO-SET-RTN
             ELSE
               PERFORM  TORI-IDO-SET2-RTN
             END-IF
      *----------  一口売却計算
             PERFORM  SMZJ1913-RTN
      *----------  4.1.異動・損益計算
             PERFORM  IDO-SONEKI-CALC1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  異動・損益計算  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       IDO-SONEKI-CALC-EXT.
           EXIT.
      ******************************************************************
      *    赤増幅編集処理
      ******************************************************************
       SMZJ1914-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  赤増幅編集処理 START  ***"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後簿価残高
           MOVE  WK-SJTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-BOKAZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後簿価残高
           MOVE  WK-UYTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-BOKAZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  異動後数量残高
           MOVE  WK-IDOG-SRYZN           OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN              OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  異動後数量残高（利付）
           MOVE  WK-IDOG-SRYZN-RIT       OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN-RIT          OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後前払金残
           MOVE  WK-SJTK-IDOG-PPAYZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-PPAYZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後前受金残
           MOVE  WK-SJTK-IDOG-ARECZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-ARECZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後前受金残
           MOVE  WK-UYTK-IDOG-ARECZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-ARECZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後仮払金残
           MOVE  WK-SJTK-IDOG-SPAYZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-SPAYZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後仮払金残
           MOVE  WK-UYTK-IDOG-SPAYZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-SPAYZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後建玉約定金額残
           MOVE  WK-SJTK-IDOG-TG-YJKNZN  OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-YJKNZN     OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後建玉約定金額残
           MOVE  WK-UYTK-IDOG-TG-YJKNZN  OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-YJKNZN     OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後建玉手数料残
           MOVE  WK-UYTK-IDOG-TG-TSRZN   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-TSRZN      OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後建玉消費税残
           MOVE  WK-SJTK-IDOG-TG-S-TAXZN
             OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-S-TAXZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後建玉消費税残
           MOVE  WK-UYTK-IDOG-TG-S-TAXZN
             OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-S-TAXZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後建玉その他費用残
           MOVE  WK-SJTK-IDOG-TG-ELS-HZN
             OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-ELS-HZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後建玉その他費用残
           MOVE  WK-UYTK-IDOG-TG-ELS-HZN
             OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-ELS-HZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後建玉精算金額残
           MOVE  WK-SJTK-IDOG-TG-SSKGZN  OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-SSKGZN     OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後建玉精算金額残
           MOVE  WK-UYTK-IDOG-TG-SSKGZN  OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-SSKGZN     OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨引継前受・前払プレミアム
           MOVE  WK-SJTK-HT-PPAR-PMM     OF  WK-TZ-ZN-IDO
             TO  SJTK-HT-PPAR-PMM        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨引継前受・前払プレミアム
           MOVE  WK-UYTK-HT-PPAR-PMM     OF  WK-TZ-ZN-IDO
             TO  UYTK-HT-PPAR-PMM        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後源泉税還付予定額残高
           MOVE  WK-SJTK-IDOG-GSZKP-YTZN
             OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-GSZKP-YTZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後源泉税還付予定額残高
           MOVE  WK-UYTK-IDOG-GSZKP-YTZN
             OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-GSZKP-YTZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  決済通貨異動後源泉税還付予定額残高
           MOVE  WK-KSTK-IDOG-GSZKP-YTZN
             OF  WK-TZ-ZN-IDO
             TO  KSTK-IDOG-GSZKP-YTZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後ノンカバー未収金残高
           MOVE  WK-SJTK-IDOG-NOCV-MSKZN
             OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-NOCV-MSKZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後ノンカバー未収金残高
           MOVE  WK-UYTK-IDOG-NOCV-MSKZN
             OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-NOCV-MSKZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後ノンカバー未払金残高
           MOVE  WK-SJTK-IDOG-NOCV-MBKZN
             OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-NOCV-MBKZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後ノンカバー未払金残高
           MOVE  WK-UYTK-IDOG-NOCV-MBKZN
             OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-NOCV-MBKZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後未払費用残
           MOVE  WK-SJTK-IDOG-MBHYZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-MBHYZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後未払費用残
           MOVE  WK-UYTK-IDOG-MBHYZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-MBHYZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後移管評価損益残
           MOVE  WK-SJTK-IDOG-IK-HKSEZN  OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-IK-HKSEZN     OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後移管評価損益残
           MOVE  WK-UYTK-IDOG-IK-HKSEZN  OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-IK-HKSEZN     OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後移管未収収益
           MOVE  WK-SJTK-IDOG-IK-MSSHEKI
             OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-IK-MSSHEKI    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後移管未収収益
           MOVE  WK-UYTK-IDOG-IK-MSSHEKI
             OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-IK-MSSHEKI    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後移管前払金評価損益残
           MOVE  WK-UYTK-IDOG-IK-PPHKZN  OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-IK-PPHKZN     OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  市場通貨異動後未払消費税残
           MOVE  WK-SJTK-IDOG-MB-S-TAXZN
             OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-MB-S-TAXZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後未払消費税残
           MOVE  WK-UYTK-IDOG-MB-S-TAXZN
             OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-MB-S-TAXZN    OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  運用通貨異動後前払金残
           MOVE  WK-UYTK-IDOG-PPAYZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-PPAYZN        OF  TKMZZI00-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  RIYO-CMP-CD             OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             TO  FUND-CD                 OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  PTF-CD                  OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  開始基準日
           MOVE  WK-KAISI-KJN-YMD        OF  WK-MEG-BETU-DMN-INFO
             TO  KAISI-KJN-YMD           OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  SEC-SBT-CD              OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  銘柄コード
           MOVE  WK-MEG-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  MEG-CD                  OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  TATE-FLG                OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  玉ID
           MOVE  WK-GYOKU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  GYOKU-ID                OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-MEG-BETU-DMN-INFO
             TO  SYORI-YMD               OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  KIDOU-ID                OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  銘柄種類２
           MOVE  WK-MEG-CD-SHRU2         OF  WK-MEG-BETU-DMN-INFO
             TO  MEG-CD-SHRU2            OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  基準日
           MOVE  WK-KJN-YMD              OF  WK-MEG-BETU-DMN-INFO
             TO  KJN-YMD                 OF  TKMZBW03-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  原取引ID
           MOVE  WK-TORI-ID              OF  WK-TARGET-TORI-INFO
             TO  TORI-ID                 OF  TKMZBW04-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  計上基準日
           MOVE  WK-KEIJOU-KIJUNBI       OF  WK-TARGET-TORI-INFO
             TO  KEIJOU-KIJUNBI          OF  TKMZBW04-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  増幅赤黒区分
           MOVE  WK-ZOFKU-AKA-KBN        OF  WK-TARGET-TORI-INFO
             TO  ZOFKU-AKA-KBN           OF  TKMZBW04-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  処理順
           MOVE  WK-SRJUN                OF  WK-TARGET-TORI-INFO
             TO  SRJUN                   OF  TKMZBW04-PARM
             OF  PARM-SMZJ1914-ARG1
      *----------  キャッシュフロー2回有効フラグ
           MOVE  WK-CASH-FLOW-2-FLG      OF  WK-DATA-IN
             TO  CASH-FLOW-2-FLG         OF  PARM-SMZJ1914-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前残高異動=["
      D             TKMZZI00-PARM        OF  PARM-SMZJ1914-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報=["
      D             TKMZBW03-PARM        OF  PARM-SMZJ1914-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報=["
      D             TKMZBW04-PARM        OF  PARM-SMZJ1914-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー2回有効フラグ=["
      D             CASH-FLOW-2-FLG      OF  PARM-SMZJ1914-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1914"              USING  PARM-SMZJ1914-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1914)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  ワーク残高異動計算データ
             MOVE  PARM-SMZJ1914-ARG2    TO  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ= ["
      D             WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-002
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1914】赤の残高異動編集  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  赤増幅編集処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1914-EXT.
           EXIT.
      ******************************************************************
      *        取引異動データセット
      ******************************************************************
       TORI-IDO-SET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  取引異動データセット  START  ***"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.対象取引情報.増幅区分=["
      D             WK-ZOFKU-KBN         OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.取引データ.異動確定区分=["
      D             WK-IDO-KBN           OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *    IF  WK-ZOFKU-KBN  OF  WK-TARGET-TORI-INFO NOT = CNS-KBN-1
      *      AND  WK-IDO-KBN OF  WK-TORI-DATA = CNS-KBN-1
           IF  WK-IDO-KBN OF  WK-TORI-DATA = CNS-KBN-1
           THEN
      *----------  1)取引異動取得
             PERFORM  TORI-IDO-GET-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  取引異動データセット END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TORI-IDO-SET-EXT.
           EXIT.
      ******************************************************************
      *        1)取引異動取得
      ******************************************************************
       TORI-IDO-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  1)取引異動取得  START  ***"
      D    DISPLAY  CNS-PGM-ID ":*** 取引異動  CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT1                                         @3212SEINO@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-RIYO-CMP-CD           OF  H-TKMXTI00-S,
                 WK-RIYO-CMP-CD          OF  WK-MSG-1-6
      *----------  原取引ID
           MOVE  WK-TORI-ID              OF  WK-TARGET-TORI-INFO
             OF  WK-DATA-IN
             TO  H-TORI-ID               OF  H-TKMXTI00-S,
                 WK-TORI-ID              OF  WK-MSG-1-6
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-FUND-CD               OF  H-TKMXTI00-S,
                 WK-FUND-CD              OF  WK-MSG-1-6
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-PTF-CD                OF  H-TKMXTI00-S,
                 WK-PTF-CD               OF  WK-MSG-1-6
      *----------  削除区分
           MOVE  SPACE
             TO  H-SAKUJO-KBN            OF  H-TKMXTI00-S,
                 WK-SAKUJO-KBN           OF  WK-MSG-1-6
      *----------  赤黒区分
           MOVE  SPACE
             TO  H-AKA-KBN               OF  H-TKMXTI00-S,
                 WK-AKA-KBN              OF  WK-MSG-1-6
           MOVE  SQL-SELECT-1-6          TO  SQLSTMT1                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ID            =["
      D             H-TORI-ID            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":削除区分            =["
      D             H-SAKUJO-KBN         OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":赤黒区分            =["
      D             H-AKA-KBN            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT1=[" SQLSTMT1 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *-----------------------------------------------------------------@3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-OPEN=["                 @3212SEINO@
      D                         FLG-TKMXTI00-CR-OPEN"]"                 @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTI00-CR-OPEN   NOT =  CNS-ON                   @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  取引異動 CURSOR PREPARE
             EXEC  SQL
               PREPARE  S6  FROM  :SQLSTMT1                             @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-003
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-6        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXTI00_CUR  CURSOR  FOR  S6
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動 CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMXTI00_CUR
               USING :H-TKMXTI00-S
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE           TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":取引異動 CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMXTI00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-OPEN=["
      D             FLG-TKMXTI00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-004
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-6          DELIMITED  BY  SIZE
               INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR OPEN END ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMXTI00_CUR
             INTO  :H-TKMXTI00
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨払出簿価      =["
      D             H-SJTK-H-BOKA        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨売買損益      =["
      D             H-SJTK-BBSNEKI       OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨前払金異動額  =["
      D             H-SJTK-PPAYIDOG      OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨利金等損益勘定=["
      D             H-SJTK-RKSEKJ        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨源泉税還付予定異動額=["
      D             H-SJTK-GSZKP-YTIDOG  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨払出簿価      =["
      D             H-UYTK-H-BOKA        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨売買損益      =["
      D             H-UYTK-BBSNEKI       OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨前払金異動額  =["
      D             H-UYTK-PPAYIDOG      OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨利金等損益勘定=["
      D             H-UYTK-RKSEKJ        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨源泉税還付予定異動額=["
      D             H-UYTK-GSZKP-YTIDOG  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.為替差損益            =["
      D             H-UYTK-KWS-SNEKI     OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.為替差損益（利金）    =["
      D             H-UYTK-KWS-SNEKI-RK  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.為替差損益（市場）    =["
      D             H-UYTK-KWS-SNEKI-SJ  OF  H-TKMXTI00"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引異動←「別紙1-6 SQL説明」
               MOVE  H-TKMXTI00          TO  WK-TORI-IDO
      *----------  取引異動データあるフラグ
               MOVE  CNS-FLG-1           TO  WK-TORI-IDO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨払出簿価      =["
      D             WK-SJTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨売買損益      =["
      D             WK-SJTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨前払金異動額  =["
      D             WK-SJTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨払出簿価      =["
      D             WK-UYTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨売買損益      =["
      D             WK-UYTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨前払金異動額  =["
      D             WK-UYTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益            =["
      D             WK-UYTK-KWS-SNEKI    OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）    =["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（市場）    =["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":ワーク銘柄別断面情報.銘柄種類２=["
      D             WK-MEG-CD-SHRU2      OF  WK-MEG-BETU-DMN-INFO"]"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.キャッシュフロー2回有効フラグ=["
      D             WK-CASH-FLOW-2-FLG   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.経過利息区分         =["
      D             WK-KKRS-KBN          OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
               IF   WK-MEG-CD-SHRU2 OF  WK-MEG-BETU-DMN-INFO = CNS-KBN-2
               AND (WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-BUY  OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-FBUY OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-OSIO OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-OSIT OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-SELL OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-FSEL OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-OSOT OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-TSOT OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-GANI OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-LOOI OR
                    WK-TORI-JIYU    OF  WK-TORI-DATA = CNS-PO)
               AND  ((WK-CASH-FLOW-2-FLG  OF  WK-DATA-IN = CNS-KBN-1 AND
                      WK-KKRS-KBN   OF  WK-TORI-DATA  NOT= CNS-KBN-4) OR
                     WK-KKRS-KBN    OF  WK-TORI-DATA     = CNS-KBN-4)
               THEN
      *----------  ワーク取引異動.市場通貨利金等損益勘定
                 MOVE  CNS-SYOKITI
                   TO  WK-SJTK-RKSEKJ    OF  WK-TORI-IDO
      *----------  ワーク取引異動.運用通貨利金等損益勘定
                 MOVE  CNS-SYOKITI
                   TO  WK-UYTK-RKSEKJ    OF  WK-TORI-IDO
      *----------  ワーク取引異動.為替差損益（利金）
                 MOVE  CNS-SYOKITI
                   TO  WK-UYTK-KWS-SNEKI-RK
                                         OF  WK-TORI-IDO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）    =["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  NOTFOUND"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-006
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-6        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID":***  1)取引異動取得  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TORI-IDO-GET-EXT.
           EXIT.
      ******************************************************************
      *    対応本体の取引の取引異動データを取得する
      ******************************************************************
       TAIOU-TORI-IDO-SET-RTN SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  対応本体の取引の"
      D             "の取引異動データを取得する START  ***"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.対象取引情報.増幅区分=["
      D             WK-ZOFKU-KBN         OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.キャッシュフロー2回有効フラグ=["
      D             WK-CASH-FLOW-2-FLG   OF  WK-DATA-IN"]"
      *-----------------------------------------------------------------
           IF ((WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-DMY1 OR
                   WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-DMY3 OR
                   WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-DMY6 OR
                   WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-DMY7 OR
                   WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-DMY8 OR
                   WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-DMY9) AND
                   WK-CASH-FLOW-2-FLG   OF  WK-DATA-IN = CNS-KBN-1) OR
                  (WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-RCPB OR
                   WK-TORI-JIYU  OF  WK-TORI-DATA = CNS-RCPS)
           THEN
      *----------  2)対応本体の取引の取引異動取得
             PERFORM  TAIOU-TORI-IDO-GET-RTN
           ELSE
             CONTINUE
           END-IF.
       TAIOU-TORI-IDO-SET-EXT.
           EXIT.
      ******************************************************************
      *    2)対応本体の取引の取引異動取得
      ******************************************************************
       TAIOU-TORI-IDO-GET-RTN SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  2)対応本体の取引の"
      D             "の取引異動取得 START  ***"
      D    DISPLAY  CNS-PGM-ID ":*** 対応本体取引異動  "
      D             "CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT2                                         @3212SEINO@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-RIYO-CMP-CD           OF  H-TKMXTI00-S-1,
                 WK-RIYO-CMP-CD          OF  WK-MSG-1-12
      *----------  原取引ID
           MOVE  WK-THRK-ID              OF  WK-TORI-DATA
             OF  WK-DATA-IN
             TO  H-TORI-ID               OF  H-TKMXTI00-S-1,
                 WK-TORI-ID              OF  WK-MSG-1-12
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-FUND-CD               OF  H-TKMXTI00-S-1,
                 WK-FUND-CD              OF  WK-MSG-1-12
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-PTF-CD                OF  H-TKMXTI00-S-1,
                 WK-PTF-CD               OF  WK-MSG-1-12
      *----------  削除区分
           MOVE  SPACE
             TO  H-SAKUJO-KBN            OF  H-TKMXTI00-S-1,
                 WK-SAKUJO-KBN           OF  WK-MSG-1-12
      *----------  赤黒区分
           MOVE  SPACE
             TO  H-AKA-KBN               OF  H-TKMXTI00-S-1,
                 WK-AKA-KBN              OF  WK-MSG-1-12
           MOVE  SQL-SELECT-1-12         TO  SQLSTMT2                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMXTI00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ID            =["
      D             H-TORI-ID            OF  H-TKMXTI00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMXTI00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMXTI00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":削除区分            =["
      D             H-SAKUJO-KBN         OF  H-TKMXTI00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":赤黒区分            =["
      D             H-AKA-KBN            OF  H-TKMXTI00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT2=[" SQLSTMT2 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-1-OPEN=["               @3212SEINO@
      D                         FLG-TKMXTI00-CR-1-OPEN"]"               @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTI00-CR-1-OPEN   NOT =  CNS-ON                 @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  対応本体取引異動 CURSOR PREPARE
             EXEC  SQL
               PREPARE  S12  FROM  :SQLSTMT2                            @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":対応本体取引異動CURSOR PREPARE SQLCODE"
      D             " =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動 CURSOR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動 CURSOR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-008
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-12       DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXTI00_CUR_1  CURSOR  FOR  S12
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":対応本体取引異動 CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対応本体取引異動"
      D             " CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMXTI00_CUR_1
               USING :H-TKMXTI00-S-1
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":対応本体取引異動"
      D             " CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMXTI00-CR-1-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動 CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-1-OPEN=["
      D             FLG-TKMXTI00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動 CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-009
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-12         DELIMITED  BY  SIZE
               INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対応本体取引異動"
      D             " CURSOR OPEN END ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMXTI00_CUR_1
             INTO  :H-TKMXTI00-1
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動"
      D             " CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動 CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.市場通貨払出簿価      =["
      D             H-SJTK-H-BOKA        OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.市場通貨売買損益      =["
      D             H-SJTK-BBSNEKI       OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.市場通貨前払金異動額  =["
      D             H-SJTK-PPAYIDOG      OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.市場通貨利金等損益勘定=["
      D             H-SJTK-RKSEKJ        OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.市場通貨源泉税還付予定異動額=["
      D             H-SJTK-GSZKP-YTIDOG  OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.運用通貨払出簿価      =["
      D             H-UYTK-H-BOKA        OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.運用通貨売買損益      =["
      D             H-UYTK-BBSNEKI       OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.運用通貨前払金異動額  =["
      D             H-UYTK-PPAYIDOG      OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.運用通貨利金等損益勘定=["
      D             H-UYTK-RKSEKJ        OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.運用通貨源泉税還付予定異動額=["
      D             H-UYTK-GSZKP-YTIDOG  OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.為替差損益            =["
      D             H-UYTK-KWS-SNEKI     OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.為替差損益（利金）    =["
      D             H-UYTK-KWS-SNEKI-RK  OF  H-TKMXTI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.為替差損益（市場）    =["
      D             H-UYTK-KWS-SNEKI-SJ  OF  H-TKMXTI00-1"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引異動←「別紙1-12 SQL説明」
               MOVE  H-TKMXTI00-1        TO  WK-TORI-IDO
      *----------  取引異動データあるフラグ
               MOVE  CNS-FLG-1           TO  WK-TORI-IDO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨払出簿価      =["
      D             WK-SJTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨売買損益      =["
      D             WK-SJTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨前払金異動額  =["
      D             WK-SJTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨払出簿価      =["
      D             WK-UYTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨売買損益      =["
      D             WK-UYTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨前払金異動額  =["
      D             WK-UYTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益            =["
      D             WK-UYTK-KWS-SNEKI    OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）    =["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（市場）    =["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
      *----------  ダミー処理不要項目再セット
      *----------  ワーク取引異動.市場通貨払出簿価
               MOVE  CNS-SYOKITI
                 TO  WK-SJTK-H-BOKA      OF  WK-TORI-IDO
      *----------  ワーク取引異動.市場通貨売買損益
               MOVE  CNS-SYOKITI
                 TO  WK-SJTK-BBSNEKI     OF  WK-TORI-IDO
      *----------  ワーク取引異動.市場通貨源泉税還付予定異動額
               MOVE  CNS-SYOKITI
                 TO  WK-SJTK-GSZKP-YTIDOG
                                         OF  WK-TORI-IDO
      *----------  ワーク取引異動.運用通貨払出簿価
               MOVE  CNS-SYOKITI
                 TO  WK-UYTK-H-BOKA      OF  WK-TORI-IDO
      *----------  ワーク取引異動.運用通貨売買損益
               MOVE  CNS-SYOKITI
                 TO  WK-UYTK-BBSNEKI     OF  WK-TORI-IDO
      *----------  ワーク取引異動.運用通貨源泉税還付予定異動額
               MOVE  CNS-SYOKITI
                 TO  WK-UYTK-GSZKP-YTIDOG
                                         OF  WK-TORI-IDO
      *----------  ワーク取引異動.為替差損益
               MOVE  CNS-SYOKITI
                 TO  WK-UYTK-KWS-SNEKI   OF  WK-TORI-IDO
      *----------  ワーク取引異動.為替差損益（市場）
               MOVE  CNS-SYOKITI
                 TO  WK-UYTK-KWS-SNEKI-SJ
                                         OF  WK-TORI-IDO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨払出簿価      =["
      D             WK-SJTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨売買損益      =["
      D             WK-SJTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額    =["
      D             WK-SJTK-GSZKP-YTIDOG OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨払出簿価      =["
      D             WK-UYTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨売買損益      =["
      D             WK-UYTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額    =["
      D             WK-UYTK-GSZKP-YTIDOG OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益            =["
      D             WK-UYTK-KWS-SNEKI    OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（市場）    =["
      D             WK-UYTK-KWS-SNEKI-SJ OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.経過利息区分         =["
      D             WK-KKRS-KBN          OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
               IF  WK-KKRS-KBN           OF  WK-TORI-DATA  = CNS-KBN-4
               THEN
      *----------  ワーク取引異動.市場通貨利金等損益勘定
                 MOVE  CNS-SYOKITI
                   TO  WK-SJTK-RKSEKJ    OF  WK-TORI-IDO
      *----------  ワーク取引異動.運用通貨利金等損益勘定
                 MOVE  CNS-SYOKITI
                   TO  WK-UYTK-RKSEKJ    OF  WK-TORI-IDO
      *----------  ワーク取引異動.為替差損益（利金）
                 MOVE  CNS-SYOKITI
                   TO  WK-UYTK-KWS-SNEKI-RK
                                         OF  WK-TORI-IDO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）    =["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動 CURSOR FETCH  NOTFOUND"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対応本体取引異動 CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-010
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-12       DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対応本体取引異動 "
      D             "CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID":***  2)対応本体の取引の取引異動取得"
      D             "  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TAIOU-TORI-IDO-GET-EXT.
           EXIT.
      ******************************************************************
      *        取引異動データセット2
      ******************************************************************
       TORI-IDO-SET2-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  取引異動データセット2 START  ***"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.対象取引情報.増幅区分=["
      D             WK-ZOFKU-KBN         OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID  ":ARG1.取引データ.異動確定区分=["
      D             WK-IDO-KBN           OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
           INITIALIZE  WK-KANPKIN-IDO-FLG
      *    IF  WK-ZOFKU-KBN  OF  WK-TARGET-TORI-INFO NOT = CNS-KBN-1
      *      AND  WK-IDO-KBN OF  WK-TORI-DATA = CNS-KBN-2
           IF WK-IDO-KBN OF  WK-TORI-DATA = CNS-KBN-2
           THEN
      *----------  1)取引異動取得
             PERFORM  TORI-IDO-GET3-RTN
           ELSE
             CONTINUE
           END-IF
      *    IF  WK-ZOFKU-KBN  OF  WK-TARGET-TORI-INFO NOT = CNS-KBN-1
      *      AND  WK-IDO-KBN OF  WK-TORI-DATA = CNS-KBN-1
           IF  WK-IDO-KBN OF  WK-TORI-DATA = CNS-KBN-1
           THEN
      *----------  1)取引異動取得
             PERFORM  TORI-IDO-GET2-RTN
             IF  WK-13SQL-FLG = CNS-1
             THEN
      *----------  1)取引異動取得
               PERFORM  TORI-IDO-GET3-RTN
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  取引異動データセット2 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TORI-IDO-SET2-EXT.
           EXIT.
      ******************************************************************
      *        1)取引異動取得
      ******************************************************************
       TORI-IDO-GET2-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  1)取引異動取得2 START  ***"
      D    DISPLAY  CNS-PGM-ID ":*** 取引異動  CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT3                                         @3212SEINO@
                       WK-13SQL-FLG
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-RIYO-CMP-CD           OF  H-TKMXTI00-S,
                 WK-RIYO-CMP-CD          OF  WK-MSG-1-6
      *----------  原取引ID
           MOVE  WK-TORI-ID              OF  WK-TARGET-TORI-INFO
             OF  WK-DATA-IN
             TO  H-TORI-ID               OF  H-TKMXTI00-S,
                 WK-TORI-ID              OF  WK-MSG-1-6
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-FUND-CD               OF  H-TKMXTI00-S,
                 WK-FUND-CD              OF  WK-MSG-1-6
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-PTF-CD                OF  H-TKMXTI00-S,
                 WK-PTF-CD               OF  WK-MSG-1-6
      *----------  削除区分
           MOVE  SPACE
             TO  H-SAKUJO-KBN            OF  H-TKMXTI00-S,
                 WK-SAKUJO-KBN           OF  WK-MSG-1-6
      *----------  赤黒区分
           MOVE  SPACE
             TO  H-AKA-KBN               OF  H-TKMXTI00-S,
                 WK-AKA-KBN              OF  WK-MSG-1-6
           MOVE  SQL-SELECT-1-6          TO  SQLSTMT3                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ID            =["
      D             H-TORI-ID            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":削除区分            =["
      D             H-SAKUJO-KBN         OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":赤黒区分            =["
      D             H-AKA-KBN            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT3=[" SQLSTMT3 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-2-OPEN=["               @3212SEINO@
      D                         FLG-TKMXTI00-CR-2-OPEN"]"               @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTI00-CR-2-OPEN   NOT =  CNS-ON                 @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  取引異動 CURSOR PREPARE
             EXEC  SQL
                 PREPARE  S62  FROM  :SQLSTMT3                          @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-021
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-6        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXTI00_CUR2  CURSOR  FOR  S62
             END-EXEC
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動 CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMXTI00_CUR2
               USING :H-TKMXTI00-S
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE           TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":取引異動 CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMXTI00-CR-2-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-2-OPEN=["
      D             FLG-TKMXTI00-CR-2-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-022
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-6          DELIMITED  BY  SIZE
               INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR OPEN END ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMXTI00_CUR2
             INTO  :H-TKMXTI00
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨払出簿価      =["
      D             H-SJTK-H-BOKA        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨売買損益      =["
      D             H-SJTK-BBSNEKI       OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨前払金異動額  =["
      D             H-SJTK-PPAYIDOG      OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨利金等損益勘定=["
      D             H-SJTK-RKSEKJ        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.市場通貨源泉税還付予定異動額=["
      D             H-SJTK-GSZKP-YTIDOG  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨払出簿価      =["
      D             H-UYTK-H-BOKA        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨売買損益      =["
      D             H-UYTK-BBSNEKI       OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨前払金異動額  =["
      D             H-UYTK-PPAYIDOG      OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨利金等損益勘定=["
      D             H-UYTK-RKSEKJ        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.運用通貨源泉税還付予定異動額=["
      D             H-UYTK-GSZKP-YTIDOG  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.為替差損益            =["
      D             H-UYTK-KWS-SNEKI     OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.為替差損益（利金）    =["
      D             H-UYTK-KWS-SNEKI-RK  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-6.為替差損益（市場）    =["
      D             H-UYTK-KWS-SNEKI-SJ  OF  H-TKMXTI00"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引異動←「別紙1-6 SQL説明」
               MOVE  H-TKMXTI00          TO  WK-TORI-IDO
      *----------  取引異動データあるフラグ
               MOVE  CNS-FLG-1           TO  WK-TORI-IDO-FLG
      *----------  ワーク還付金異動計算特殊フラグ
               MOVE  CNS-FLG-1           TO  WK-KANPKIN-IDO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨払出簿価      =["
      D             WK-SJTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨売買損益      =["
      D             WK-SJTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨前払金異動額  =["
      D             WK-SJTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨払出簿価      =["
      D             WK-UYTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨売買損益      =["
      D             WK-UYTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨前払金異動額  =["
      D             WK-UYTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益            =["
      D             WK-UYTK-KWS-SNEKI    OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）    =["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（市場）    =["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク還付金異動計算特殊フラグ=["
      D             WK-KANPKIN-IDO-FLG"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *----------  「別紙1-13 SQL」フラグ
               MOVE  CNS-1               TO  WK-13SQL-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  NOTFOUND"
      D    DISPLAY  CNS-PGM-ID":「別紙1-13 SQL」フラグ=["
      D             WK-13SQL-FLG"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-023
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-6        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID":***  1)取引異動取得2  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TORI-IDO-GET2-EXT.
           EXIT.
      ******************************************************************
      *        1)取引異動取得
      ******************************************************************
       TORI-IDO-GET3-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  1)取引異動取得3 START  ***"
      D    DISPLAY  CNS-PGM-ID ":*** 取引異動  CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT4                                         @3212SEINO@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-RIYO-CMP-CD           OF  H-TKMXTI00-S,
                 WK-RIYO-CMP-CD          OF  WK-MSG-1-6
      *----------  原取引ID
           MOVE  WK-TORI-ID              OF  WK-TARGET-TORI-INFO
             OF  WK-DATA-IN
             TO  H-TORI-ID               OF  H-TKMXTI00-S,
                 WK-TORI-ID              OF  WK-MSG-1-6
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             OF  WK-DATA-IN
             TO  H-FUND-CD               OF  H-TKMXTI00-S,
                 WK-FUND-CD              OF  WK-MSG-1-6
      *----------  ポートフォリオコード
           MOVE  SPACE
             TO  H-PTF-CD                OF  H-TKMXTI00-S,
                 WK-PTF-CD               OF  WK-MSG-1-6
      *----------  削除区分
           MOVE  SPACE
             TO  H-SAKUJO-KBN            OF  H-TKMXTI00-S,
                 WK-SAKUJO-KBN           OF  WK-MSG-1-6
      *----------  赤黒区分
           MOVE  SPACE
             TO  H-AKA-KBN               OF  H-TKMXTI00-S,
                 WK-AKA-KBN              OF  WK-MSG-1-6
           MOVE  SQL-SELECT-1-6          TO  SQLSTMT4
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ID            =["
      D             H-TORI-ID            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":削除区分            =["
      D             H-SAKUJO-KBN         OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":赤黒区分            =["
      D             H-AKA-KBN            OF  H-TKMXTI00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT4=[" SQLSTMT4 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-13-OPEN=["              @3212SEINO@
      D                         FLG-TKMXTI00-CR-13-OPEN"]"              @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTI00-CR-13-OPEN   NOT =  CNS-ON                @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  取引異動 CURSOR PREPARE
             EXEC  SQL
               PREPARE  S13  FROM  :SQLSTMT4                            @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-025
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-6        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXTI00_CUR3  CURSOR  FOR  S13
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動 CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMXTI00_CUR3
               USING :H-TKMXTI00-S
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE           TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":取引異動 CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMXTI00-CR-13-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTI00-CR-13-OPEN=["
      D             FLG-TKMXTI00-CR-13-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-026
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-6          DELIMITED  BY  SIZE
               INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR OPEN END ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMXTI00_CUR3
             INTO  :H-TKMXTI00
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.市場通貨払出簿価      =["
      D             H-SJTK-H-BOKA        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.市場通貨売買損益      =["
      D             H-SJTK-BBSNEKI       OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.市場通貨前払金異動額  =["
      D             H-SJTK-PPAYIDOG      OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.市場通貨利金等損益勘定=["
      D             H-SJTK-RKSEKJ        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.市場通貨源泉税還付予定異動額=["
      D             H-SJTK-GSZKP-YTIDOG  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.運用通貨払出簿価      =["
      D             H-UYTK-H-BOKA        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.運用通貨売買損益      =["
      D             H-UYTK-BBSNEKI       OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.運用通貨前払金異動額  =["
      D             H-UYTK-PPAYIDOG      OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.運用通貨利金等損益勘定=["
      D             H-UYTK-RKSEKJ        OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.運用通貨源泉税還付予定異動額=["
      D             H-UYTK-GSZKP-YTIDOG  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.為替差損益            =["
      D             H-UYTK-KWS-SNEKI     OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.為替差損益（利金）    =["
      D             H-UYTK-KWS-SNEKI-RK  OF  H-TKMXTI00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.為替差損益（市場）    =["
      D             H-UYTK-KWS-SNEKI-SJ  OF  H-TKMXTI00"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引異動←「別紙1-13 SQL説明」
               MOVE  H-TKMXTI00          TO  WK-TORI-IDO
      *----------  取引異動データあるフラグ
               MOVE  CNS-FLG-1           TO  WK-TORI-IDO-FLG
      *----------  ワーク還付金異動計算特殊フラグ
               MOVE  CNS-FLG-1           TO  WK-KANPKIN-IDO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨払出簿価      =["
      D             WK-SJTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨売買損益      =["
      D             WK-SJTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨前払金異動額  =["
      D             WK-SJTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨払出簿価      =["
      D             WK-UYTK-H-BOKA       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨売買損益      =["
      D             WK-UYTK-BBSNEKI      OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨前払金異動額  =["
      D             WK-UYTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益            =["
      D             WK-UYTK-KWS-SNEKI    OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）    =["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（市場）    =["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク還付金異動計算特殊フラグ=["
      D             WK-KANPKIN-IDO-FLG"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  NOTFOUND"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動 CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-027
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-6        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引異動 CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID":***  1)取引異動取得3  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TORI-IDO-GET3-EXT.
           EXIT.
      ******************************************************************
      *    一口売却計算
      ******************************************************************
       SMZJ1913-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  一口売却計算 START  ***"
      *-----------------------------------------------------------------
      *----------  取引データ
      *----------  １口注文ＩＤ
           MOVE  WK-ORDR-1K-ID           OF  WK-TORI-DATA
             TO  ORDR-1K-ID              OF  TORI-DATA
             OF  PARM-SMZJ1913-ARG1
      *----------  数量単位
           MOVE  WK-SURYO-TANI           OF  WK-TORI-DATA
             TO  SURYO-TANI              OF  TORI-DATA
             OF  PARM-SMZJ1913-ARG1
      *----------  払出簿価計算方法
           MOVE  WK-DEBET-BOKA-CALC-HOU  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-CALC-HOU     OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  払出簿価端数（市場通貨）
           MOVE  WK-DEBET-BOKA-HASU-BC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-BC      OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  払出単価桁数（市場通貨）
           MOVE  WK-DEBET-TNK-KETASU-BC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-BC     OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  払出単価端数（市場通貨）
           MOVE  WK-DEBET-TNK-HASU-BC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-BC       OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  払出簿価端数（運用通貨）
           MOVE  WK-DEBET-BOKA-HASU-LC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-LC      OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  払出単価桁数（運用通貨）
           MOVE  WK-DEBET-TNK-KETASU-LC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-LC     OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  払出単価端数（運用通貨）
           MOVE  WK-DEBET-TNK-HASU-LC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-LC       OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  簿価為替レート適用フラグ
           MOVE  WK-BOKA-KWS-TEKIYO-FLG  OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-TEKIYO-FLG     OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  簿価為替レート端数
           MOVE  WK-BOKA-KWS-HASU        OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-HASU           OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  簿価為替レート桁数
           MOVE  WK-BOKA-KWS-KETASU      OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-KETASU         OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  売り続く限り同一コスト
           MOVE  WK-URI-TUDUKU-SAME-COST
             OF  WK-YIDOU-CALC-PARM
             TO  URI-TUDUKU-SAME-COST    OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  同一日は同一コスト
           MOVE  WK-SAME-YMD-SAME-COST   OF  WK-YIDOU-CALC-PARM
             TO  SAME-YMD-SAME-COST      OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  処理順序
           MOVE  WK-SYRI-JUN             OF  WK-YIDOU-CALC-PARM
             TO  SYRI-JUN                OF  YIDOU-CALC-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  市場通貨払出単価
           MOVE  WK-SJTK-H-TNK           OF  WK-TZ-ZN-IDO
             TO  SJTK-HARAID-TNK         OF  TZ-ZN-IDO
             OF  PARM-SMZJ1913-ARG1
      *----------  運用通貨払出単価
           MOVE  WK-UYTK-H-TNK           OF  WK-TZ-ZN-IDO
             TO  UYTK-HARAID-TNK         OF  TZ-ZN-IDO
             OF  PARM-SMZJ1913-ARG1
      *----------  計上基準日
           MOVE  WK-KEIJOU-KIJUNBI       OF  WK-TZ-ZN-IDO
             TO  KEIJOU-KIJUNBI          OF  TZ-ZN-IDO
             OF  PARM-SMZJ1913-ARG1
      *----------  市場通貨異動後簿価残高
           MOVE  WK-SJTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-BOKAZN        OF  TZ-ZN-IDO
             OF  PARM-SMZJ1913-ARG1
      *----------  運用通貨異動後簿価残高
           MOVE  WK-UYTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-BOKAZN        OF  TZ-ZN-IDO
             OF  PARM-SMZJ1913-ARG1
      *----------  異動後数量残高
           MOVE  WK-IDOG-SRYZN           OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN              OF  TZ-ZN-IDO
             OF  PARM-SMZJ1913-ARG1
      *----------  取引事由
           MOVE  WK-TORI-JIYU            OF  WK-TZ-ZN-IDO
             TO  TORI-JIYU               OF  TZ-ZN-IDO
             OF  PARM-SMZJ1913-ARG1
      *----------  通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DHS-SYRI-PARM
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-MEG-BETU-DMN-INFO
             TO  SYORI-YMD               OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  KIDOU-ID                OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  RIYO-CMP-CD             OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             TO  FUND-CD                 OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  PTF-CD                  OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  基準日
           MOVE  WK-KJN-YMD              OF  WK-MEG-BETU-DMN-INFO
             TO  KJN-YMD                 OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  銘柄コード
           MOVE  WK-MEG-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  MEG-CD                  OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  SEC-SBT-CD              OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  TATE-FLG                OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  玉ID
           MOVE  WK-GYOKU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  GYOKU-ID                OF  TKMZBW03-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  増幅赤黒区分
           MOVE  WK-ZOFKU-AKA-KBN        OF  WK-TARGET-TORI-INFO
             TO  ZOFKU-AKA-KBN           OF  TKMZBW04-PARM
             OF  PARM-SMZJ1913-ARG1
      *----------  売り続く限りフラグ
           MOVE  WK-URI-TUDUKU-KAGI-FLG  OF  WK-DATA-IN
             TO  URI-TUDUKU-KAGI-FLG     OF  PARM-SMZJ1913-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ=["
      D             TORI-DATA            OF  PARM-SMZJ1913-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン=["
      D             YIDOU-CALC-PARM      OF  PARM-SMZJ1913-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動=["
      D             TZ-ZN-IDO            OF  PARM-SMZJ1913-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DHS-SYRI-PARM   OF  PARM-SMZJ1913-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報=["
      D             TKMZBW03-PARM        OF  PARM-SMZJ1913-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報=["
      D             TKMZBW04-PARM        OF  PARM-SMZJ1913-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限りフラグ=["
      D             URI-TUDUKU-KAGI-FLG  OF  PARM-SMZJ1913-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1913"              USING  PARM-SMZJ1913-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1913)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             IF  WARN-FLG  OF  PARM-SMZJ1913-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZJ1913-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZJ1913-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZJ1913-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  ワーク一口売却計算フラグ
             MOVE  KUTI1-BAKYK-CALC-FLG  OF  PARM-SMZJ1913-ARG2
               TO  WK-KUTI1-BAKYK-CALC-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク一口売却計算フラグ= ["
      D             WK-KUTI1-BAKYK-CALC-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-012
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1913】一口売却計算  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  一口売却計算  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1913-EXT.
           EXIT.
      ******************************************************************
      *    仕訳フラグ編集
      ******************************************************************
       SMZJ1916-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  仕訳フラグ編集 START  ***"
      *-----------------------------------------------------------------
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-KYJ-YMD-DMN-INFO
             TO  RIYO-CMP-CD             OF  KJYD-DMN-INFO-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD       OF  WK-KYJ-YMD-DMN-INFO
             TO  SWK-KJN-PTN-CD          OF  KJYD-DMN-INFO-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  基本会計ベースフラグ
           MOVE  WK-KH-KAIKEI-BASE-FLG   OF  WK-KYJ-YMD-DMN-INFO
             TO  KH-KAIKEI-BASE-FLG      OF  KJYD-DMN-INFO-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  約定主義会計フラグ
           MOVE  WK-YKJ-SYUGI-KAIKEI     OF  WK-KYJ-YMD-DMN-INFO
             TO  YKJ-SYUGI-KAIKEI        OF  KJYD-DMN-INFO-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  キャッシュフロー２回発生区分
           MOVE  WK-CASH-FLOW-KBN        OF  WK-KYJ-YMD-DMN-INFO
             TO  CASH-FLOW-KBN           OF  KJYD-DMN-INFO-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-KYJ-YMD-DMN-INFO
             TO  SEC-SBT-CD              OF  KJYD-DMN-INFO-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  経過利息区分
           MOVE  WK-KKRS-KBN             OF  WK-TORI-DATA
             TO  KKRS-KBN                OF  TORI-DATA-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  保有目的
           MOVE  WK-POSSESSION-OBJECT    OF  WK-TORI-DATA
             TO  POSSESSION-OBJECT       OF  TORI-DATA-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-TORI-DATA
             TO  TATE-FLG                OF  TORI-DATA-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  取引事由
           MOVE  WK-TORI-JIYU            OF  WK-TORI-DATA
             TO  TORI-JIYU               OF  TORI-DATA-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  取引内容
           MOVE  WK-TORI-NAIY            OF  WK-TORI-DATA
             TO  TORI-NAIY               OF  TORI-DATA-PARM
             OF  PARM-SMZJ1916-ARG1
      *----------  計上基準日
           MOVE  WK-KEIJOU-KIJUNBI       OF  WK-TARGET-TORI-INFO
             TO  KEIJOU-KIJUNBI          OF  PARM-SMZJ1916-ARG1
      *----------  国内外国区分
           MOVE  WK-NAI-GAI-KBN          OF  WK-DATA-IN
             TO  NAI-GAI-KBN             OF  PARM-SMZJ1916-ARG1
      *----------  勘定科目出力商品名
           MOVE  WK-KNJ-KAMK-OUT-SYOHIN  OF  WK-DATA-IN
             TO  KNJ-KAMK-OUT-SYOHIN     OF  PARM-SMZJ1916-ARG1
      *----------  銘柄別断面情報.証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  SEC-SBT-CD              OF  MEG-BETU-DMN-INFO
             OF  PARM-SMZJ1916-ARG1
      *----------  ＯＰ資産負債・買建売建フラグ
           MOVE  WK-OP-TATE-FLG          OF  WK-TZ-ZN-IDO
             TO  OP-TATE-FLG
             OF  PARM-SMZJ1916-ARG1
      *----------  銘柄属性コールプット区分
           MOVE  WK-MEG-CALL-PUT-KBN     OF  WK-DATA-IN
             TO  MEG-CALL-PUT-KBN        OF  PARM-SMZJ1916-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報:"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD          OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準パターンコード=["
      D             SWK-KJN-PTN-CD       OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ=["
      D             KH-KAIKEI-BASE-FLG   OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定主義会計フラグ=["
      D             YKJ-SYUGI-KAIKEI     OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー２回発生区分=["
      D             CASH-FLOW-KBN        OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["SEC-SBT-CD
      D             OF  KJYD-DMN-INFO-PARM    OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ:"
      D    DISPLAY  CNS-PGM-ID":経過利息区分=["
      D             KKRS-KBN             OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":保有目的=["
      D             POSSESSION-OBJECT    OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引事由=["
      D             TORI-JIYU            OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引内容=["
      D             TORI-NAIY            OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計上基準日=["
      D             KEIJOU-KIJUNBI       OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.運用通貨コード=["
      D             WK-UYTK-CD           OF  WK-KYJ-YMD-DMN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.市場通貨コード=["
      D             WK-SIJO-TUKA-CD      OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":テーマ2679  START(SMZJ1916)"
      D    DISPLAY  CNS-PGM-ID":ARG1.国内外国区分=["
      D             WK-NAI-GAI-KBN       OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":テーマ2679  END(SMZJ1916)"
      D    DISPLAY  CNS-PGM-ID":国内外国区分=["
      D             NAI-GAI-KBN          OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":勘定科目出力商品名=["
      D             KNJ-KAMK-OUT-SYOHIN  OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.証券種別コード=["
      D             SEC-SBT-CD           OF  MEG-BETU-DMN-INFO
      D                                  OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄種類2=["
      D             MEG-CD-SHRU2         OF  MEG-BETU-DMN-INFO
      D                                  OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ=["
      D             OP-TATE-FLG          OF  PARM-SMZJ1916-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性コールプット区分=["
      D             MEG-CALL-PUT-KBN     OF  PARM-SMZJ1916-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1916"              USING  PARM-SMZJ1916-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1916)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1916】仕訳フラグ編集  正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-013
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1916】仕訳フラグ編集  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  仕訳フラグ編集  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1916-EXT.
           EXIT.
      ******************************************************************
      *    先物よりオプション側仕訳基準取得
      ******************************************************************
       SMZJ1915-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  先物よりオプション側仕訳基準取得 START  ***"
      *-----------------------------------------------------------------
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-TORI-DATA
             TO  SEC-SBT-CD              OF  PARM-SMZJ1915-ARG1
      *----------  取引事由
           MOVE  WK-TORI-JIYU            OF  WK-TORI-DATA
             TO  TORI-JIYU               OF  PARM-SMZJ1915-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-KYJ-YMD-DMN-INFO
             TO  RIYO-CMP-CD             OF  PARM-SMZJ1915-ARG1
      *----------  仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD       OF  WK-KYJ-YMD-DMN-INFO
             TO  SWK-KJN-PTN-CD          OF  PARM-SMZJ1915-ARG1
      *----------  測定基準区分
           MOVE  WK-ST-KJN-KBN           OF  WK-KYJ-YMD-DMN-INFO
             TO  ST-KJN-KBN              OF  PARM-SMZJ1915-ARG1
      *----------  国内外国区分
           MOVE  WK-NAI-GAI-KBN          OF  WK-DATA-IN
             TO  NAI-GAI-KBN             OF  PARM-SMZJ1915-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-TORI-DATA
             TO  TATE-FLG                OF  PARM-SMZJ1915-ARG1
      *----------  オプションL／Sフラグ
           MOVE  WK-OP-L-S-FLG           OF  WK-TZ-ZN-IDO
             TO  OP-L-S-FLG              OF  PARM-SMZJ1915-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD           OF  PARM-SMZJ1915-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引事由=["
      D             TORI-JIYU            OF  PARM-SMZJ1915-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD          OF  PARM-SMZJ1915-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準パターンコード=["
      D             SWK-KJN-PTN-CD       OF  PARM-SMZJ1915-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":測定基準区分=["
      D             ST-KJN-KBN           OF  PARM-SMZJ1915-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.運用通貨コード=["
      D             WK-UYTK-CD           OF  WK-KYJ-YMD-DMN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.市場通貨コード=["
      D             WK-SIJO-TUKA-CD      OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":テーマ2679  START(SMZJ1915)"
      D    DISPLAY  CNS-PGM-ID":ARG1.国内外国区分=["
      D             WK-NAI-GAI-KBN       OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":国内外国区分=["
      D             NAI-GAI-KBN          OF  PARM-SMZJ1915-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":テーマ2679  END(SMZJ1915)"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZJ1915-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":オプションL／Sフラグ=["
      D             OP-L-S-FLG           OF  PARM-SMZJ1915-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1915"              USING  PARM-SMZJ1915-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1915)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":【SMZJ1915】先物よりオプション側仕訳基準取得  正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-014
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":【SMZJ1915】先物よりオプション側仕訳基準取得  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  先物よりオプション側仕訳基準取得  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1915-EXT.
           EXIT.
      ******************************************************************
      *    仕訳計算（物）
      ******************************************************************
       SMZJ1930-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  仕訳計算（物） START  ***"
      *-----------------------------------------------------------------
      *----------  国内外国区分
           MOVE  WK-NAI-GAI-KBN          OF  WK-DATA-IN
             TO  NAI-GAI-KBN             OF  PARM-SMZJ1930-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-TORI-DATA
             TO  RIYO-CMP-CD             OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  保有目的
           MOVE  WK-POSSESSION-OBJECT    OF  WK-TORI-DATA
             TO  POSSESSION-OBJECT       OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  取引内容
           MOVE  WK-TORI-NAIY            OF  WK-TORI-DATA
             TO  TORI-NAIY               OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  為替差損益
           MOVE  WK-UYTK-KWS-SNEKI       OF  WK-TORI-DATA
             TO  UYTK-KWS-SNEKI          OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-TORI-DATA
             TO  SYORI-YMD               OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  経過利息区分
           MOVE  WK-KKRS-KBN             OF  WK-TORI-DATA
             TO  KKRS-KBN                OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用国消費税（運用通貨換算額）
           MOVE  WK-U-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-U-SHZ             OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  精算金額（運用通貨換算額）
           MOVE  WK-U-KSG-SSKG           OF  WK-TORI-DATA
             TO  U-KSG-G-SSKG            OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  入出金額（約定レート・運用通貨換算額）
           MOVE  WK-NSKG-Y-UY            OF  WK-TORI-DATA
             TO  NSKG-Y-UY               OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  約定金額（運用通貨換算額）
           MOVE  WK-U-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  U-KSG-G-YJKG            OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  既経過利息（運用通貨換算額）
           MOVE  WK-U-KSG-G-KKKRS        OF  WK-TORI-DATA
             TO  U-KSG-G-KKKRS           OF  TORI-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-ZN-IDO-CALC-DATE
             TO  SYORI-YMD               OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID             OF  WK-ZN-IDO-CALC-DATE
             TO  KIDOU-ID                OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-ZN-IDO-CALC-DATE
             TO  RIYO-CMP-CD             OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-ZN-IDO-CALC-DATE
             TO  FUND-CD                 OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-ZN-IDO-CALC-DATE
             TO  PTF-CD                  OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  原取引ID
           MOVE  WK-TORI-ID              OF  WK-ZN-IDO-CALC-DATE
             TO  TORI-ID                 OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-ZN-IDO-CALC-DATE
             TO  SEC-SBT-CD              OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  銘柄コード
           MOVE  WK-MEG-CD               OF  WK-ZN-IDO-CALC-DATE
             TO  MEG-CD                  OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  赤黒区分
           MOVE  WK-AKA-KBN              OF  WK-ZN-IDO-CALC-DATE
             TO  AKA-KBN                 OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  誤計上№
           MOVE  WK-ERR-KJY-NO           OF  WK-ZN-IDO-CALC-DATE
             TO  ERR-KJY-NO              OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-ZN-IDO-CALC-DATE
             TO  TATE-FLG                OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  玉ID
           MOVE  WK-GYOKU-ID             OF  WK-ZN-IDO-CALC-DATE
             TO  GYOKU-ID                OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  計上基準日
           MOVE  WK-KEIJOU-KIJUNBI       OF  WK-ZN-IDO-CALC-DATE
             TO  KEIJOU-KIJUNBI          OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  取引連関ID
           MOVE  WK-THRK-ID              OF  WK-ZN-IDO-CALC-DATE
             TO  THRK-ID                 OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  取引内容
           MOVE  WK-TORI-NAIY            OF  WK-ZN-IDO-CALC-DATE
             TO  TORI-NAIY               OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  取引事由
           MOVE  WK-TORI-JIYU            OF  WK-ZN-IDO-CALC-DATE
             TO  TORI-JIYU               OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  誤計上区分
           MOVE  WK-ERR-KJY-KBN          OF  WK-ZN-IDO-CALC-DATE
             TO  ERR-KJY-KBN             OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  約定日
           MOVE  WK-YKJ-YMD              OF  WK-ZN-IDO-CALC-DATE
             TO  YKJ-YMD                 OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  受渡日
           MOVE  WK-UKE-YMD              OF  WK-ZN-IDO-CALC-DATE
             TO  UKE-YMD                 OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  為替差損益
           MOVE  WK-UYTK-KWS-SNEKI       OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-KWS-SNEKI          OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  為替差損益（利金）
           MOVE  WK-UYTK-KWS-SNEKI-RK    OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-KWS-SNEKI-RK       OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨異動簿価
           MOVE  WK-UYTK-IDO-BOKA        OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-IDO-BOKA           OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨売買損益
           MOVE  WK-UYTK-BBSNEKI         OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-BBSNEKI            OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨利金等損益勘定
           MOVE  WK-UYTK-RKSEKJ          OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-RKSEKJ             OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨引継前受・前払プレミアム
           MOVE  WK-UYTK-HT-PPAR-PMM     OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-HT-PPAR-PMM        OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨前払金異動額
           MOVE  WK-UYTK-PPAYIDOG        OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-PPAYIDOG           OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨建玉精算金額
           MOVE  WK-UYTK-TG-SSKG         OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-TG-SSKG            OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨源泉税
           MOVE  WK-UYTK-GENSEN-TAX      OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-GENSEN-TAX         OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  ＯＰ資産負債・買建売建フラグ
           MOVE  WK-OP-TATE-FLG          OF  WK-ZN-IDO-CALC-DATE
             TO  OP-TATE-FLG             OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨源泉税還付予定異動額
           MOVE  WK-UYTK-GSZKP-YTIDOG    OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-GSZKP-YTIDOG       OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨手数料
           MOVE  WK-UYTK-TSR             OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-TSR                OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨消費税
           MOVE  WK-UYTK-S-TAX           OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-S-TAX              OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨その他損益
           MOVE  WK-UYTK-ELS-SNEKI       OF  WK-ZN-IDO-CALC-DATE
             TO  UYTK-ELS-SNEKI          OF  ZN-IDO-CALC-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  決済約定金額
           MOVE  WK-U-KSG-KS-YJKG        OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-KS-YJKG           OF  AITAI-TRHK-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  権利行使金額
           MOVE  WK-U-KSG-KRKS-KG        OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-KRKS-KG           OF  AITAI-TRHK-PARM
             OF  PARM-SMZJ1930-ARG1
      *----------  仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD       OF  WK-KYJ-YMD-DMN-INFO
             TO  SWK-KJN-PTN-CD          OF  KYJ-YMD-DMN-INFO
             OF  PARM-SMZJ1930-ARG1
      *----------  保有目的
           MOVE  WK-POSSESSION-OBJECT    OF  WK-KYJ-YMD-DMN-INFO
             TO  POSSESSION-OBJECT       OF  KYJ-YMD-DMN-INFO
             OF  PARM-SMZJ1930-ARG1
      *----------  約定主義会計フラグ
           MOVE  WK-YKJ-SYUGI-KAIKEI     OF  WK-KYJ-YMD-DMN-INFO
             TO  YKJ-SYUGI-KAIKEI        OF  KYJ-YMD-DMN-INFO
             OF  PARM-SMZJ1930-ARG1
      *----------  キャッシュフロー２回発生区分
           MOVE  WK-CASH-FLOW-KBN        OF  WK-KYJ-YMD-DMN-INFO
             TO  CASH-FLOW-KBN           OF  KYJ-YMD-DMN-INFO
             OF  PARM-SMZJ1930-ARG1
      *----------  銘柄種類2
           MOVE  WK-MEG-CD-SHRU2         OF  WK-MEG-BETU-DMN-INFO
             TO  MEG-CD-SHRU2            OF  MEG-BETU-DMN-INFO
             OF  PARM-SMZJ1930-ARG1
      *----------  勘定科目出力商品名
           MOVE  WK-KNJ-KAMK-OUT-SYOHIN  OF  WK-DATA-IN
             TO  KNJ-KAMK-OUT-SYOHIN     OF  PARM-SMZJ1930-ARG1
      *----------  運用通貨予備売買金額
           MOVE  WK-UYTK-YOBI-BS-KN
             TO  UYTK-YOBI-BBSNEKI       OF  TOKU-KJY-DATA
             OF  PARM-SMZJ1930-ARG1
      *----------  コール・プット区分
           MOVE  WK-MEG-CALL-PUT-KBN     OF  WK-DATA-IN
             TO  CALL-PUT-KBN            OF  PARM-SMZJ1930-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD         OF  WK-DATA-IN
             TO  SIJO-TUKA-CD            OF  PARM-SMZJ1930-ARG1
      *---------- 運用通貨コード
           MOVE  WK-UYTK-CD              OF  WK-KYJ-YMD-DMN-INFO
             TO  CAPITAL-TUKA-CD         OF  PARM-SMZJ1930-ARG1
      *---------- 決済口座１通貨コード
           MOVE  WK-KOZA1-TUKA-CD        OF  WK-DATA-IN
             TO  KOZA1-TUKA-CD           OF  PARM-SMZJ1930-ARG1
      *---------- 決済口座２通貨コード
           MOVE  WK-KOZA2-TUKA-CD        OF  WK-DATA-IN
             TO  KOZA2-TUKA-CD           OF  PARM-SMZJ1930-ARG1
      *---------- 入出金額（決済レート・運用通貨換算額）
           MOVE  WK-NSKG-K-UY            OF  WK-DATA-IN
             TO  NSKG-K-UY               OF  PARM-SMZJ1930-ARG1
      *---------- 決済口座１入出金額
           MOVE  WK-KOZA1-NSKG           OF  WK-DATA-IN
             TO  KOZA1-NSKG              OF  PARM-SMZJ1930-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.運用通貨コード=["
      D             WK-UYTK-CD           OF  WK-KYJ-YMD-DMN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.市場通貨コード=["
      D             WK-SIJO-TUKA-CD      OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":テーマ2679  START(SMZJ1930)"
      D    DISPLAY  CNS-PGM-ID":ARG1.国内外国区分=["
      D             WK-NAI-GAI-KBN       OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":国内外国区分=["
      D             NAI-GAI-KBN          OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":テーマ2679  END(SMZJ1930)"
      D    DISPLAY  CNS-PGM-ID":取引データ:"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD          OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":保有目的=["
      D             POSSESSION-OBJECT    OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引内容=["
      D             TORI-NAIY            OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益=["
      D             UYTK-KWS-SNEKI       OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD            OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過利息区分=["
      D             KKRS-KBN             OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用国消費税（運用通貨換算額）=["
      D             U-KSG-U-SHZ          OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":精算金額（運用通貨換算額）=["
      D             U-KSG-G-SSKG         OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":入出金額（約定レート・運用通貨換算額）=["
      D             NSKG-Y-UY            OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG         OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":既経過利息（運用通貨換算額）=["
      D             U-KSG-G-KKKRS        OF  TORI-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ:"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD            OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID             OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD          OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD              OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD               OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID=["
      D             TORI-ID              OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD           OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             MEG-CD               OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分=["
      D             AKA-KBN              OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№=["
      D             ERR-KJY-NO           OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID=["
      D             GYOKU-ID             OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計上基準日=["
      D             KEIJOU-KIJUNBI       OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID=["
      D             THRK-ID              OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引内容=["
      D             TORI-NAIY            OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引事由=["
      D             TORI-JIYU            OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分=["
      D             ERR-KJY-KBN          OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定日=["
      D             YKJ-YMD              OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受渡日=["
      D             UKE-YMD              OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益=["
      D             UYTK-KWS-SNEKI       OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（利金）=["
      D             UYTK-KWS-SNEKI-RK    OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価=["
      D             UYTK-IDO-BOKA        OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨売買損益=["
      D             UYTK-BBSNEKI         OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定=["
      D             UYTK-RKSEKJ          OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨引継前受・前払プレミアム=["
      D             UYTK-HT-PPAR-PMM     OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額=["
      D             UYTK-PPAYIDOG        OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額=["
      D             UYTK-TG-SSKG         OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税=["
      D             UYTK-GENSEN-TAX      OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ=["
      D             OP-TATE-FLG          OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定異動額=["
      D             UYTK-GSZKP-YTIDOG    OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料=["
      D             UYTK-TSR             OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税=["
      D             UYTK-S-TAX           OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他損益=["
      D             UYTK-ELS-SNEKI       OF  ZN-IDO-CALC-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引データ:"
      D    DISPLAY  CNS-PGM-ID":決済約定金額=["
      D             U-KSG-KS-YJKG        OF  AITAI-TRHK-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":権利行使金額=["
      D             U-KSG-KRKS-KG        OF  AITAI-TRHK-PARM
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報:"
      D    DISPLAY  CNS-PGM-ID":仕訳基準パターンコード=["
      D             SWK-KJN-PTN-CD       OF  KYJ-YMD-DMN-INFO
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":保有目的=["
      D             POSSESSION-OBJECT    OF  KYJ-YMD-DMN-INFO
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定主義会計フラグ=["
      D             YKJ-SYUGI-KAIKEI     OF  KYJ-YMD-DMN-INFO
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー２回発生区分=["
      D             CASH-FLOW-KBN        OF  KYJ-YMD-DMN-INFO
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄種類2=["
      D             MEG-CD-SHRU2         OF  MEG-BETU-DMN-INFO
      D             OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":勘定科目出力商品名=["
      D             KNJ-KAMK-OUT-SYOHIN  OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":特殊計上データ.運用通貨予備売買金額=["
      D             UYTK-YOBI-BBSNEKI    OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":コール・プット区分=["
      D             CALL-PUT-KBN         OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             SIJO-TUKA-CD         OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨コード=["
      D             CAPITAL-TUKA-CD      OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１通貨コード=["
      D             KOZA1-TUKA-CD        OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決済口座２通貨コード=["
      D             KOZA2-TUKA-CD        OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":入出金額(決済レート・運用通貨換算額)=["
      D             NSKG-K-UY            OF  PARM-SMZJ1930-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１入出金額=["
      D             KOZA1-NSKG           OF  PARM-SMZJ1930-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1930"              USING  PARM-SMZJ1930-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1930)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1930】仕訳計算（物）  正常"
      D    DISPLAY  CNS-PGM-ID":警告フラグ=["
      D                       WARN-FLG OF PARM-SMZJ1930-ARG2"]"
      *-----------------------------------------------------------------
             IF WARN-FLG OF PARM-SMZJ1930-ARG2 NOT = SPACE
             THEN
               COMPUTE WARN-INFO-SU OF PARM-SMZJ1910-ARG2
                     = WARN-INFO-SU OF PARM-SMZJ1910-ARG2 + 1
               MOVE  WARN-FLG OF PARM-SMZJ1930-ARG2
                 TO  WARN-FLG
               OF PARM-SMZJ1910-ARG2(WARN-INFO-SU OF PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D                       WARN-INFO-SU OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報("
      D                        WARN-INFO-SU OF PARM-SMZJ1910-ARG2
      D                        ").警告フラグ=[" WARN-FLG
      D     OF PARM-SMZJ1910-ARG2(WARN-INFO-SU OF PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-015
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1930】仕訳計算（物）  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  仕訳計算（物）  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1930-EXT.
           EXIT.
      ******************************************************************
      *        3.2.3.勘定異動作成
      ******************************************************************
       KANJYOU-IDO-RTN        SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  勘定異動作成  START  ***"
      *-----------------------------------------------------------------
           PERFORM  SMZJ1930-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":***  勘定異動作成  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       KANJYOU-IDO-EXT.
           EXIT.
      ******************************************************************
      *        3.2.5.異動計算データインサート
      ******************************************************************
       TKMZBW06-INSERT-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  異動計算データインサート  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE    PARM-INSERT-INOUT
                         PARM-INSERT-RTNPKG
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-KYJ-YMD-DMN-INFO
             TO  RIYO-CMP-CD            OF  PARM-INSERT-ARG1
      *----------  DBレイアウトコピー句
           MOVE  WK-ZN-IDO-CALC-DATE
             TO  TBL-LAYOUT             OF  PARM-INSERT-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             RIYO-CMP-CD          OF  PARM-INSERT-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.処理実行日= ["
      D             SYORI-YMD            OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.起動ID= ["
      D             KIDOU-ID             OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "利用会社コード= ["
      D             RIYO-CMP-CD          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "ファンドコード= ["
      D             FUND-CD              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "ポートフォリオコード= ["
      D             PTF-CD               OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.原取引ID= ["
      D             TORI-ID              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.計上基準日= ["
      D             KEIJOU-KIJUNBI       OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.赤黒区分= ["
      D             AKA-KBN              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.取引連関ID= ["
      D             THRK-ID              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "証券種別コード= ["
      D             SEC-SBT-CD           OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.取引内容= ["
      D             TORI-NAIY            OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.取引事由= ["
      D             TORI-JIYU            OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨コード= ["
      D             SIJO-TUKA-CD         OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.銘柄コード= ["
      D             MEG-CD               OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "資産負債・買建売建フラグ= ["
      D             TATE-FLG             OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.玉ＩＤ= ["
      D             GYOKU-ID             OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.約定日= ["
      D             YKJ-YMD              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.受渡日= ["
      D             UKE-YMD              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動簿価= ["
      D             SJTK-IDO-BOKA        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動簿価= ["
      D             UYTK-IDO-BOKA        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨簿価単価= ["
      D             SJTK-BOKA-TNK        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨簿価単価= ["
      D             UYTK-BOKA-TNK        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "簿価為替レート= ["
      D             BOKA-KWS             OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨払出簿価= ["
      D             SJTK-H-BOKA          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨払出簿価= ["
      D             UYTK-H-BOKA          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨払出単価= ["
      D             SJTK-H-TNK           OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨払出単価= ["
      D             UYTK-H-TNK           OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "異動数量= ["
      D             IDO-SURYO            OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "異動数量（利付）= ["
      D             IDO-SURYO-RIT        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後簿価残高= ["
      D             SJTK-IDOG-BOKAZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後簿価残高= ["
      D             UYTK-IDOG-BOKAZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "異動後数量残高= ["
      D             IDOG-SRYZN           OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "異動後数量残高（利付）= ["
      D             IDOG-SRYZN-RIT       OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨前払金異動額= ["
      D             SJTK-PPAYIDOG        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨前払金異動額= ["
      D             UYTK-PPAYIDOG        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後前払金残= ["
      D             SJTK-IDOG-PPAYZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後前払金残= ["
      D             UYTK-IDOG-PPAYZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後前受金残= ["
      D             SJTK-IDOG-ARECZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後前受金残= ["
      D             UYTK-IDOG-ARECZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後仮払金残= ["
      D             SJTK-IDOG-SPAYZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後仮払金残= ["
      D             UYTK-IDOG-SPAYZN     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨売買損益= ["
      D             SJTK-BBSNEKI         OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨売買損益= ["
      D             UYTK-BBSNEKI         OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "為替差損益= ["
      D             UYTK-KWS-SNEKI       OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "為替差損益（利金）= ["
      D             UYTK-KWS-SNEKI-RK    OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨手数料= ["
      D             SJTK-TSR             OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨手数料= ["
      D             UYTK-TSR             OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨消費税= ["
      D             SJTK-S-TAX           OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨消費税= ["
      D             UYTK-S-TAX           OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨源泉税= ["
      D             SJTK-GENSEN-TAX      OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨源泉税= ["
      D             UYTK-GENSEN-TAX      OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨その他損益= ["
      D             SJTK-ELS-SNEKI       OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨その他損益= ["
      D             UYTK-ELS-SNEKI       OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨利金等損益勘定= ["
      D             SJTK-RKSEKJ          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨利金等損益勘定= ["
      D             UYTK-RKSEKJ          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "異動計上順序= ["
      D             IDO-KJY-JUN          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後建玉約定金額残= ["
      D             SJTK-IDOG-TG-YJKNZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後建玉約定金額残= ["
      D             UYTK-IDOG-TG-YJKNZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨建玉手数料= ["
      D             SJTK-TG-TSR          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨建玉手数料= ["
      D             UYTK-TG-TSR          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後建玉手数料残= ["
      D             SJTK-IDOG-TG-TSRZN   OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後建玉手数料残= ["
      D             UYTK-IDOG-TG-TSRZN   OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨建玉消費税= ["
      D             SJTK-TG-S-TAX        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨建玉消費税= ["
      D             UYTK-TG-S-TAX        OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後建玉消費税残= ["
      D             SJTK-IDOG-TG-S-TAXZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後建玉消費税残= ["
      D             UYTK-IDOG-TG-S-TAXZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨建玉その他費用= ["
      D             SJTK-IDOG-TG-ELS-HZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨建玉その他費用= ["
      D             UYTK-IDOG-TG-ELS-HZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後建玉その他費用残= ["
      D             SJTK-IDOG-TG-ELS-HZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後建玉その他費用残= ["
      D             UYTK-IDOG-TG-ELS-HZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨建玉精算金額= ["
      D             SJTK-TG-SSKG         OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨建玉精算金額= ["
      D             UYTK-TG-SSKG         OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後建玉精算金額残= ["
      D             SJTK-IDOG-TG-SSKGZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後建玉精算金額残= ["
      D             UYTK-IDOG-TG-SSKGZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨引継前受・前払プレミアム= ["
      D             SJTK-HT-PPAR-PMM     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨引継前受・前払プレミアム= ["
      D             UYTK-HT-PPAR-PMM     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "ＯＰ資産負債・買建売建フラグ= ["
      D             OP-TATE-FLG          OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨源泉税還付予定異動額= ["
      D             SJTK-GSZKP-YTIDOG    OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨源泉税還付予定異動額= ["
      D             UYTK-GSZKP-YTIDOG    OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後源泉税還付予定額残高= ["
      D             SJTK-IDOG-GSZKP-YTZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後源泉税還付予定額残高= ["
      D             UYTK-IDOG-GSZKP-YTZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後ノンカバー未収金残高= ["
      D             SJTK-IDOG-NOCV-MSKZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用貨異動後ノンカバー未収金残高= ["
      D             UYTK-IDOG-NOCV-MSKZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後ノンカバー未払金残高= ["
      D             SJTK-IDOG-NOCV-MBKZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後ノンカバー未払金残高= ["
      D             UYTK-IDOG-NOCV-MBKZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後未払費用残= ["
      D             SJTK-IDOG-MBHYZN      OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後未払費用残= ["
      D             UYTK-IDOG-MBHYZN      OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後移管評価損益残= ["
      D             SJTK-IDOG-IK-HKSEZN   OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後移管評価損益残= ["
      D             UYTK-IDOG-IK-HKSEZN   OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "市場通貨異動後移管未収収益= ["
      D             SJTK-IDOG-IK-MSSHEKI  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後移管未収収益= ["
      D             UYTK-IDOG-IK-MSSHEKI  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ."
      D             "運用通貨異動後移管前払金評価損益残= ["
      D             UYTK-IDOG-IK-PPHKZN  OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データ.削除区分= ["
      D             SAKUJO-KBN           OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データ.作成フラグ= ["
      D             SK-FLG               OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D      ":残高異動計算データ.作成ログインユーザ会社コード= ["
      D             SK-LOGIN-CMP-CD      OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データ.作成ユーザＩＤ= ["
      D             SK-SID               OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データ.作成プログラムＩＤ= ["
      D             SK-PGMID             OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データ.更新フラグ= ["
      D             UPD-FLG              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ.更新ログインユ"
      D             "ーザ会社コード= ["
      D             UPD-LOGIN-CMP-CD     OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データ.更新ユーザＩＤ= ["
      D             UPD-SID              OF PARM-INSERT-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データ.更新プログラムＩＤ= ["
      D             UPD-PGMID            OF PARM-INSERT-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "TIMZBW06"             USING  PARM-INSERT-INOUT
                                               PARM-INSERT-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":RTN-CD(TIMZBW06)=["RTN-CD
      D        OF  PARM-INSERT-RTNPKG(COUNTER OF PARM-INSERT-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-INSERT-RTNPKG
                       (COUNTER OF PARM-INSERT-RTNPKG)
             =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク残高異動計算データを残高異動データにインサート正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------</DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高異動計算データを残高異動データにインサートエラー"
      *-----------------------------------------------------------------
      *----------  エラー
             MOVE  PARM-INSERT-RTNPKG   TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-017
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF PARM-INSERT-RTNPKG (COUNTER
                                         OF PARM-INSERT-RTNPKG)
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
           CONTINUE.
       TKMZBW06-INSERT-EXT.
           EXIT.
      ******************************************************************
      *        3.2.6.ARG2セット
      ******************************************************************
       ARG2-SET-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":***  ARG2セット  START  ***"
      *-----------------------------------------------------------------
      *----------  ARG2セット
           MOVE  WK-ZN-IDO-CALC-DATE
             TO  ZN-IDO-CALC-DATE        OF  PARM-SMZJ1910-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.処理実行日= ["
      D             SYORI-YMD            OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.起動ID= ["
      D             KIDOU-ID             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "利用会社コード= ["
      D             RIYO-CMP-CD          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "ファンドコード= ["
      D             FUND-CD              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "ポートフォリオコード= ["
      D             PTF-CD               OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.原取引ID= ["
      D             TORI-ID              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.計上基準日= ["
      D             KEIJOU-KIJUNBI       OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.赤黒区分= ["
      D             AKA-KBN              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.取引連関ID= ["
      D             THRK-ID              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "証券種別コード= ["
      D             SEC-SBT-CD           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.取引内容= ["
      D             TORI-NAIY            OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.取引事由= ["
      D             TORI-JIYU            OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨コード= ["
      D             SIJO-TUKA-CD         OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.銘柄コード= ["
      D             MEG-CD               OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "資産負債・買建売建フラグ= ["
      D             TATE-FLG             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.玉ＩＤ= ["
      D             GYOKU-ID             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.約定日= ["
      D             YKJ-YMD              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.受渡日= ["
      D             UKE-YMD              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動簿価= ["
      D             SJTK-IDO-BOKA        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動簿価= ["
      D             UYTK-IDO-BOKA        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨簿価単価= ["
      D             SJTK-BOKA-TNK        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨簿価単価= ["
      D             UYTK-BOKA-TNK        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "簿価為替レート= ["
      D             BOKA-KWS             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨払出簿価= ["
      D             SJTK-H-BOKA          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨払出簿価= ["
      D             UYTK-H-BOKA          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨払出単価= ["
      D             SJTK-H-TNK           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨払出単価= ["
      D             UYTK-H-TNK           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "異動数量= ["
      D             IDO-SURYO            OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "異動数量（利付）= ["
      D             IDO-SURYO-RIT        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後簿価残高= ["
      D             SJTK-IDOG-BOKAZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後簿価残高= ["
      D             UYTK-IDOG-BOKAZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "異動後数量残高= ["
      D             IDOG-SRYZN           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "異動後数量残高（利付）= ["
      D             IDOG-SRYZN-RIT       OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨前払金異動額= ["
      D             SJTK-PPAYIDOG        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨前払金異動額= ["
      D             UYTK-PPAYIDOG        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後前払金残= ["
      D             SJTK-IDOG-PPAYZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後前払金残= ["
      D             UYTK-IDOG-PPAYZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後前受金残= ["
      D             SJTK-IDOG-ARECZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後前受金残= ["
      D             UYTK-IDOG-ARECZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後仮払金残= ["
      D             SJTK-IDOG-SPAYZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後仮払金残= ["
      D             UYTK-IDOG-SPAYZN     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨売買損益= ["
      D             SJTK-BBSNEKI         OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨売買損益= ["
      D             UYTK-BBSNEKI         OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "為替差損益= ["
      D             UYTK-KWS-SNEKI       OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "為替差損益（利金）= ["
      D             UYTK-KWS-SNEKI-RK    OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "為替差損益（市場）= ["
      D             UYTK-KWS-SNEKI-SJ    OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨手数料= ["
      D             SJTK-TSR             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨手数料= ["
      D             UYTK-TSR             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨消費税= ["
      D             SJTK-S-TAX           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨消費税= ["
      D             UYTK-S-TAX           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨源泉税= ["
      D             SJTK-GENSEN-TAX      OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨源泉税= ["
      D             UYTK-GENSEN-TAX      OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨その他損益= ["
      D             SJTK-ELS-SNEKI       OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨その他損益= ["
      D             UYTK-ELS-SNEKI       OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨利金等損益勘定= ["
      D             SJTK-RKSEKJ          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨利金等損益勘定= ["
      D             UYTK-RKSEKJ          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "異動計上順序= ["
      D             IDO-KJY-JUN          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後建玉約定金額残= ["
      D             SJTK-IDOG-TG-YJKNZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後建玉約定金額残= ["
      D             UYTK-IDOG-TG-YJKNZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨建玉手数料= ["
      D             SJTK-TG-TSR          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨建玉手数料= ["
      D             UYTK-TG-TSR          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後建玉手数料残= ["
      D             SJTK-IDOG-TG-TSRZN   OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後建玉手数料残= ["
      D             UYTK-IDOG-TG-TSRZN   OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨建玉消費税= ["
      D             SJTK-TG-S-TAX        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨建玉消費税= ["
      D             UYTK-TG-S-TAX        OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後建玉消費税残= ["
      D             SJTK-IDOG-TG-S-TAXZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後建玉消費税残= ["
      D             UYTK-IDOG-TG-S-TAXZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨建玉その他費用= ["
      D             SJTK-IDOG-TG-ELS-HZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨建玉その他費用= ["
      D             UYTK-IDOG-TG-ELS-HZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後建玉その他費用残= ["
      D             SJTK-IDOG-TG-ELS-HZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後建玉その他費用残= ["
      D             UYTK-IDOG-TG-ELS-HZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨建玉精算金額= ["
      D             SJTK-TG-SSKG         OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨建玉精算金額= ["
      D             UYTK-TG-SSKG         OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後建玉精算金額残= ["
      D             SJTK-IDOG-TG-SSKGZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後建玉精算金額残= ["
      D             UYTK-IDOG-TG-SSKGZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨引継前受・前払プレミアム= ["
      D             SJTK-HT-PPAR-PMM     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨引継前受・前払プレミアム= ["
      D             UYTK-HT-PPAR-PMM     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "ＯＰ資産負債・買建売建フラグ= ["
      D             OP-TATE-FLG          OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨源泉税還付予定異動額= ["
      D             SJTK-GSZKP-YTIDOG    OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨源泉税還付予定異動額= ["
      D             UYTK-GSZKP-YTIDOG    OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後源泉税還付予定額残高= ["
      D             SJTK-IDOG-GSZKP-YTZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後源泉税還付予定額残高= ["
      D             UYTK-IDOG-GSZKP-YTZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後ノンカバー未収金残高= ["
      D             SJTK-IDOG-NOCV-MSKZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用貨異動後ノンカバー未収金残高= ["
      D             UYTK-IDOG-NOCV-MSKZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後ノンカバー未払金残高= ["
      D             SJTK-IDOG-NOCV-MBKZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後ノンカバー未払金残高= ["
      D             UYTK-IDOG-NOCV-MBKZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後未払費用残= ["
      D             SJTK-IDOG-MBHYZN      OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後未払費用残= ["
      D             UYTK-IDOG-MBHYZN      OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後移管評価損益残= ["
      D             SJTK-IDOG-IK-HKSEZN   OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後移管評価損益残= ["
      D             UYTK-IDOG-IK-HKSEZN   OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "市場通貨異動後移管未収収益= ["
      D             SJTK-IDOG-IK-MSSHEKI  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後移管未収収益= ["
      D             UYTK-IDOG-IK-MSSHEKI  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2."
      D             "運用通貨異動後移管前払金評価損益残= ["
      D             UYTK-IDOG-IK-PPHKZN  OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.削除区分= ["
      D             SAKUJO-KBN           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.投資対象国コード= ["
      D             TSTSK-CD             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.発行国コード= ["
      D             HAKO-CD              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.数量単位= ["
      D             SURYO-TANI           OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.作成フラグ= ["
      D             SK-FLG               OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.作成ログインユーザ会社コード= ["
      D             SK-LOGIN-CMP-CD      OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.作成ユーザＩＤ= ["
      D             SK-SID               OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.作成プログラムＩＤ= ["
      D             SK-PGMID             OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.更新フラグ= ["
      D             UPD-FLG              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.更新ログインユ"
      D             "ーザ会社コード= ["
      D             UPD-LOGIN-CMP-CD     OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.更新ユーザＩＤ= ["
      D             UPD-SID              OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG2.更新プログラムＩＤ= ["
      D             UPD-PGMID            OF PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID ":***  ARG2セット  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ARG2-SET-EXT.
           EXIT.
      ******************************************************************
      *        4.1.異動・損益計算
      ******************************************************************
       IDO-SONEKI-CALC1-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":***  4.1.異動・損益計算  START  ***"
      *-----------------------------------------------------------------
      *----------  4.1.1.計算パターン決定
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":  4.1.1.計算パターン決定  START  "
      *-----------------------------------------------------------------
      *----------  0)債券ダミー切替処理
      *----------  基準日断面情報
      *----------  処理実行日
           MOVE  WK-SYORI-YMD       OF  WK-KYJ-YMD-DMN-INFO
             TO  SYORI-YMD          OF  PARM-SMZJ1917-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID        OF  WK-KYJ-YMD-DMN-INFO
             TO  KIDOU-ID           OF  PARM-SMZJ1917-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD     OF  WK-KYJ-YMD-DMN-INFO
             TO  RIYO-CMP-CD        OF  PARM-SMZJ1917-ARG1
      *----------  ファンドコード
           MOVE  WK-FUND-CD         OF  WK-KYJ-YMD-DMN-INFO
             TO  FUND-CD            OF  PARM-SMZJ1917-ARG1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD          OF  WK-KYJ-YMD-DMN-INFO
             TO  PTF-CD             OF  PARM-SMZJ1917-ARG1
      *----------  仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD  OF  WK-KYJ-YMD-DMN-INFO
             TO  SWK-KJN-PTN-CD     OF  PARM-SMZJ1917-ARG1
      *----------  基準日
           MOVE  WK-KJN-YMD         OF  WK-KYJ-YMD-DMN-INFO
             TO  KJN-YMD            OF  PARM-SMZJ1917-ARG1
      *----------  取引事由
           MOVE  WK-TORI-JIYU       OF  WK-TORI-DATA
             TO  TORI-JIYU          OF  PARM-SMZJ1917-ARG1
      *----------  取引連関ＩＤ
           MOVE  WK-THRK-ID         OF  WK-TORI-DATA
             TO  THRK-ID            OF  PARM-SMZJ1917-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD          OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID           OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD        OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD            OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD             OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準パターンコード=["
      D             SWK-KJN-PTN-CD     OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             KJN-YMD            OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引事由=["
      D             TORI-JIYU          OF  PARM-SMZJ1917-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ＩＤ=["
      D             THRK-ID            OF  PARM-SMZJ1917-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1917"              USING  PARM-SMZJ1917-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1917)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1917】債券ダミー切替判定  正常"
      D    DISPLAY  CNS-PGM-ID": リターンパッケージ.切替対象フラグ =["
      D             KIRIKAE-FLG  OF  PARM-SMZJ1917-ARG2"]"
      *-----------------------------------------------------------------
      *----------  A)リターンパッケージ.切替対象フラグ＝'1'(対象)の場合
             IF  KIRIKAE-FLG  OF  PARM-SMZJ1917-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": リターンパッケージ.切替情報."
      D             "キャッシュフロー2回有効フラグ =["
      D             CASH-FLOW-2-FLG     OF  PARM-SMZJ1917-ARG2"]"
      D    DISPLAY  CNS-PGM-ID": リターンパッケージ.切替情報."
      D             "仕訳基準パターンコード =["
      D             SWK-KJN-PTN-CD      OF  PARM-SMZJ1917-ARG2"]"
      *-----------------------------------------------------------------
               MOVE  CASH-FLOW-2-FLG     OF  PARM-SMZJ1917-ARG2
                 TO  WK-CASH-FLOW-2-FLG  OF  WK-DATA-IN
               MOVE  SWK-KJN-PTN-CD      OF  PARM-SMZJ1917-ARG2
                 TO  WK-SWK-KJN-PTN-CD   OF  WK-KYJ-YMD-DMN-INFO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ARG1.キャッシュフロー2回有効フラグ =["
      D             WK-CASH-FLOW-2-FLG  OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID": ARG1.基準日断面情報."
      D             "仕訳基準パターンコード =["
      D             WK-SWK-KJN-PTN-CD   OF  WK-KYJ-YMD-DMN-INFO"]"
      *-----------------------------------------------------------------
             ELSE
      *----------  B)上記以外
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-018
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":【SMZJ1917】債券ダミー切替判定  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  【SMZJ1917】債券ダミー切替判定  END  ***"
      *-----------------------------------------------------------------
      *----------  1)ワーク新株発行フラグ編集
           INITIALIZE  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  判定対象区分
           MOVE  CNS-HANTEI-TARGET-KBN-8
             TO  HANTEI-TARGET-KBN       OF  PARM-SMZJ4012-ARG1
           PERFORM  SMZJ4012-RTN
           EVALUATE  KABU-HAIT-SKB-HANTEI-FLG  OF  PARM-SMZJ4012-ARG2
             WHEN  CNS-FLG-0
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZJ4012.リターンパッケージ."
      D             "株式配当新株判定フラグ=["
      D             KABU-HAIT-SKB-HANTEI-FLG  OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
               MOVE  SPACE               TO  WK-NEW-KABU-HAKKO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク新株発行フラグ=["
      D             WK-NEW-KABU-HAKKO-FLG"]"
      *-----------------------------------------------------------------
             WHEN  CNS-FLG-1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZJ4012.リターンパッケージ."
      D             "株式配当新株判定フラグ=["
      D             KABU-HAIT-SKB-HANTEI-FLG  OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
               IF  WK-TARGET-TORI-ID     OF  WK-TORI-DATA = ZERO
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.対象取引ＩＤ=["
      D             WK-TARGET-TORI-ID    OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
                 MOVE  CNS-FLG-1           TO  WK-NEW-KABU-HAKKO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク新株発行フラグ=["
      D             WK-NEW-KABU-HAKKO-FLG"]"
      *-----------------------------------------------------------------
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.対象取引ＩＤ=["
      D             WK-TARGET-TORI-ID    OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
                 MOVE  CNS-FLG-2           TO  WK-NEW-KABU-HAKKO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク新株発行フラグ=["
      D             WK-NEW-KABU-HAKKO-FLG"]"
      *-----------------------------------------------------------------
               END-IF
             WHEN  OTHER
               CONTINUE
           END-EVALUATE
      *----------  2)約定ベース消費税受渡計上編集
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ARG1.基準日断面情報.基本会計ベース"
      D                        "フラグ=["WK-KH-KAIKEI-BASE-FLG"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.基準日断面情報.仕訳基準パターン"
      D                        "コード=["WK-SWK-KJN-PTN-CD"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.基準日断面情報.仕訳基準パターン"
      D                       "コードの3桁目=["WK-SWK-KJN-PTN-CD(3:1)"]"
      *-----------------------------------------------------------------
           IF  WK-KH-KAIKEI-BASE-FLG  =  CNS-KH-KAIKEI-BASE-FLG-1
           AND ( WK-SWK-KJN-PTN-CD(3:1) = CNS-C2
             OR  WK-SWK-KJN-PTN-CD(3:1) = CNS-C4
             OR  WK-SWK-KJN-PTN-CD(3:1) = CNS-C6
             OR  WK-SWK-KJN-PTN-CD(3:1) = CNS-Z )
           THEN
             MOVE  CNS-C1  TO  WK-YKJ-SHOHI-JUN
           ELSE
             IF  WK-KH-KAIKEI-BASE-FLG  =  CNS-KH-KAIKEI-BASE-FLG-2
             THEN
               MOVE  CNS-C2  TO  WK-YKJ-SHOHI-JUN
             ELSE
               MOVE  CNS-C0  TO  WK-YKJ-SHOHI-JUN
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク約定ベース消費税受渡計上=["
      D                          WK-YKJ-SHOHI-JUN"]"
      *-----------------------------------------------------------------
      *----------  3)本体フラグ編集
      *----------  ①ワーク計算パターン決定用取引事由
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU  OF  WK-TORI-DATA  OF  WK-DATA-IN"]"
      *-----------------------------------------------------------------
           MOVE  WK-TORI-JIYU       OF  WK-TORI-DATA
                                    OF  WK-DATA-IN
             TO  WK-KSKT-TORI-JIYU  OF  WORK-AREA
      *----------  ②ARG1.取引データ.取引事由 IN ('DMY6','DMY7','DMY1',
      *----------  'DMY3')の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク計算パターン決定用取引事由=["
      D             WK-KSKT-TORI-JIYU  OF  WORK-AREA"]"
      D    DISPLAY  CNS-PGM-ID ":取引事由=["
      D                          WK-TORI-JIYU  OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
           IF  WK-TORI-JIYU  OF  WK-TORI-DATA  =  CNS-DMY6
            OR WK-TORI-JIYU  OF  WK-TORI-DATA  =  CNS-DMY7
            OR WK-TORI-JIYU  OF  WK-TORI-DATA  =  CNS-DMY1
            OR WK-TORI-JIYU  OF  WK-TORI-DATA  =  CNS-DMY3
           THEN
             PERFORM SQL-SELECT-11-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":「別紙1-11  SQL説明」.取引事由=["
      D                          H-TORI-JIYU  OF  H-TKMXTR00-S-11"]"
      *-----------------------------------------------------------------
             IF  H-TORI-JIYU  OF  H-TKMXTR00-S-11 = CNS-GANI
              OR H-TORI-JIYU  OF  H-TKMXTR00-S-11 = CNS-LOOI
             THEN
               MOVE  CNS-C1  TO  WK-HONTAI-FLG
             ELSE
               IF  H-TORI-JIYU  OF  H-TKMXTR00-S-11 = CNS-GANC
                OR H-TORI-JIYU  OF  H-TKMXTR00-S-11 = CNS-LOOC
               THEN
                 MOVE  CNS-C2  TO  WK-HONTAI-FLG
               ELSE
                 CONTINUE
               END-IF
             END-IF
             IF  H-TORI-JIYU  OF  H-TKMXTR00-S-11 = CNS-PYIN
             THEN
               MOVE  CNS-DMY8  TO  WK-KSKT-TORI-JIYU  OF  WORK-AREA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク計算パターン決定用取引事由=["
      D             WK-KSKT-TORI-JIYU  OF  WORK-AREA"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
             IF  H-TORI-JIYU  OF  H-TKMXTR00-S-11 = CNS-RCOT
             THEN
               MOVE  CNS-DMY9  TO  WK-KSKT-TORI-JIYU  OF  WORK-AREA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク計算パターン決定用取引事由=["
      D             WK-KSKT-TORI-JIYU  OF  WORK-AREA"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク本体フラグ=["WK-HONTAI-FLG"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク取引データ.取引事由=["
      D                          WK-TORI-JIYU  OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.取引データ.取引事由=["
      D                         TORI-JIYU   OF  TORI-DATA
      D                         OF  PARM-SMZJ1910-ARG1"]"
      *-----------------------------------------------------------------
      *----------  4)【SMZJ4015】計算パターン決定に接続用パラメータの設定を行なう
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  SEC-SBT-CD              OF  PARM-SMZJ4015-ARG1
      *----------  取引事由
           MOVE  WK-KSKT-TORI-JIYU       OF  WORK-AREA
             TO  TORI-JIYU               OF  PARM-SMZJ4015-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-TORI-DATA
             TO  TATE-FLG                OF  PARM-SMZJ4015-ARG1
      *----------  約定主義会計フラグ
           MOVE  WK-CASH-FLOW-2-FLG
             TO  YKJ-SYUGI-KAIKEI        OF  PARM-SMZJ4015-ARG1
      *----------  新株発行フラグ
           MOVE  WK-NEW-KABU-HAKKO-FLG
             TO  SKB-HK-NS-FLG           OF  PARM-SMZJ4015-ARG1
      *----------  経過利息区分
           MOVE  WK-KKRS-KBN             OF  WK-TORI-DATA
             TO  KKRS-KBN                OF  PARM-SMZJ4015-ARG1
      *----------  異動数量
           MOVE  WK-IDO-SURYO            OF  WK-TORI-DATA
             TO  IDO-SURYO               OF  PARM-SMZJ4015-ARG1
      *----------  判定対象区分
           MOVE  CNS-HANTEI-TARGET-KBN-1
             TO  HANTEI-TARGET-KBN       OF  PARM-SMZJ4015-ARG1
      *----------  約定ベース消費税受渡計上
           MOVE  WK-YKJ-SHOHI-JUN
             TO  YKJ-SHOHI-JUN           OF  PARM-SMZJ4015-ARG1
      *----------  本体フラグ
           MOVE  WK-HONTAI-FLG
             TO  HONTAI-FLG              OF  PARM-SMZJ4015-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード          =["
      D             SEC-SBT-CD           OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引事由                =["
      D             TORI-JIYU            OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定主義会計フラグ      =["
      D             YKJ-SYUGI-KAIKEI     OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":新株発行フラグ          =["
      D             SKB-HK-NS-FLG        OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過利息区分            =["
      D             KKRS-KBN             OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動数量                =["
      D             IDO-SURYO            OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金種別                =["
      D             SIKIN-SBT            OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":増減区分                =["
      D             ZG-KBN               OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分            =["
      D             HANTEI-TARGET-KBN    OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース消費税受渡計上 =["
      D             YKJ-SHOHI-JUN        OF  PARM-SMZJ4015-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":本体フラグ               =["
      D             HONTAI-FLG           OF  PARM-SMZJ4015-ARG1"]"
      *-----------------------------------------------------------------
      *----------  5)【SMZJ4015】計算パターン決定をコールして、リターンパッケージを取得する
           CALL  "SMZJ4015"              USING  PARM-SMZJ4015-INOUT
                                                PARM-RTNPKG
      *----------  ワーク計算パターン
           MOVE  CALC-PTN-MONO           OF  PARM-SMZJ4015-ARG2
             TO  WK-CALC-PTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン=["WK-CALC-PTN"]"
      *-----------------------------------------------------------------
      *----------  6)ARG1.銘柄属性取得フラグ＝0 AND ワーク計算パターン.前払金計算方法 IN (1,2,3,4)の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄属性取得フラグ=["
      D             WK-MEG-ZOK-FLG"]"
      *-----------------------------------------------------------------
           IF  WK-MEG-ZOK-FLG  =  CNS-MEG-ZOK-FLG-0
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.前払金計算方法=["
      D             WK-MAEBR-KIN-CALC-HOU   OF  WK-CALC-PTN"]"
      *-----------------------------------------------------------------
             IF  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-1
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-2
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-3
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-4
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-5
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-15
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-16
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-24
               OR  WK-MAEBR-KIN-CALC-HOU = CNS-MAEBR-KIN-CALC-HOU-25
             THEN
               MOVE  CNS-MAEBR-KIN-CALC-HOU-0
                 TO  WK-MAEBR-KIN-CALC-HOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.前払金計算方法=["
      D             WK-MAEBR-KIN-CALC-HOU   OF  WK-CALC-PTN"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *----------  7)ARG1.取引データ.経過利息区分='5'(割引債)の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ARG1.取引データ.経過利息区分=["
      D                         WK-KKRS-KBN OF WK-TORI-DATA "]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.ゼロクーポン債フラグ=["
      D             WK-ZERO-CUPON-FLG       OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":利付／割引区分=["
      D             WK-RITUKI-WARI-KBN   OF  WK-DATA-IN"]"
      *-----------------------------------------------------------------
           IF  WK-KKRS-KBN OF WK-TORI-DATA = CNS-C5
           OR  WK-ZERO-CUPON-FLG       OF  WK-DATA-IN  =  CNS-1
           OR  WK-RITUKI-WARI-KBN      OF  WK-DATA-IN  =  CNS-C2
           THEN
             MOVE  CNS-MAEBR-KIN-CALC-HOU-0  TO  WK-MAEBR-KIN-CALC-HOU
             IF  WK-KKRS-KBN OF WK-TORI-DATA NOT= CNS-C0
              AND WK-KKRS-KBN OF WK-TORI-DATA NOT= SPACE
             THEN
               IF   (WK-KKRS-KBN OF WK-TORI-DATA = CNS-C5
               AND  WK-RITUKI-WARI-KBN      OF  WK-DATA-IN  NOT= CNS-C2)
               OR (WK-KKRS-KBN OF WK-TORI-DATA NOT= CNS-C5
               AND  WK-RITUKI-WARI-KBN      OF  WK-DATA-IN  =  CNS-C2)
               THEN
      *----------  ARG2.警告情報数
                 COMPUTE  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2
                       =  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
                 MOVE  CNS-WARN-FLG-N2
                   TO  WARN-FLG
                   OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                   OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.前払金計算方法=["
      D             WK-MAEBR-KIN-CALC-HOU   OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID": 取引異動データあるフラグ =["
      D             WK-TORI-IDO-FLG"]"
      D    DISPLAY  CNS-PGM-ID": ワーク取引異動.市場通貨前払金異動額 =["
      D             WK-SJTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID": ワーク取引異動.運用通貨前払金異動額 =["
      D             WK-UYTK-PPAYIDOG     OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  8)取引異動データあるフラグ＝'1'(ある)
           IF  WK-TORI-IDO-FLG  =  CNS-FLG-1
            AND (WK-SJTK-PPAYIDOG     OF  WK-TORI-IDO NOT = CNS-SYOKITI
                 OR WK-UYTK-PPAYIDOG  OF  WK-TORI-IDO NOT = CNS-SYOKITI)
           THEN
      *----------  A)ワーク取引異動.市場通貨前払金異動額
      *----------  ≠999999999999999.999の場合
             IF  WK-SJTK-PPAYIDOG     OF  WK-TORI-IDO NOT = CNS-SYOKITI
             THEN
      *----------  市場通貨前払金異動額有効フラグ
               MOVE  CNS-C1           TO  WK-SJTK-PPAYIDOG-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金異動額有効フラグ  =["
      D             WK-SJTK-PPAYIDOG-FLG"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
      *----------  B)ワーク取引異動.運用通貨前払金異動額
      *----------  ≠999999999999999.999の場合
             IF  WK-UYTK-PPAYIDOG  OF  WK-TORI-IDO NOT = CNS-SYOKITI
             THEN
      *----------  運用通貨前払金異動額有効フラグ
               MOVE  CNS-C1           TO  WK-UYTK-PPAYIDOG-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額有効フラグ =["
      D             WK-UYTK-PPAYIDOG-FLG"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
      *----------  C)ワーク計算パターン.前払金計算方法＝1 OR 3の場合
             IF  WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN =
                 CNS-MAEBR-KIN-CALC-HOU-1   OR
                 WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN =
                 CNS-MAEBR-KIN-CALC-HOU-3
             THEN
               MOVE  CNS-MAEBR-KIN-CALC-HOU-15
                 TO  WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.前払金計算方法 =["
      D             WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
      *----------  D)ワーク計算パターン.前払金計算方法＝2 OR 4の場合
             IF  WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN =
                 CNS-MAEBR-KIN-CALC-HOU-2   OR
                 WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN =
                 CNS-MAEBR-KIN-CALC-HOU-4
             THEN
               MOVE  CNS-MAEBR-KIN-CALC-HOU-16
                 TO  WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.前払金計算方法 =["
      D             WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
      *----------  E)ワーク計算パターン.前払金計算方法＝5の場合
             IF  WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN =
                 CNS-MAEBR-KIN-CALC-HOU-5
             THEN
               MOVE  CNS-MAEBR-KIN-CALC-HOU-21
                 TO  WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.前払金計算方法 =["
      D             WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":  4.1.1.計算パターン決定  END  "
      *-----------------------------------------------------------------
      *----------  4.1.2.ワーク計算詳細セット
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":  4.1.2.ワーク計算詳細セット  START  "
      *-----------------------------------------------------------------
           CALL  "SMZJ1911"              USING  PARM-SMZJ1911-INOUT
                                                PARM-RTNPKG
      *----------  ワーク計算詳細←リターンパッケージ.計算詳細
           MOVE  CALC-SYOSAI             OF  PARM-SMZJ1911-INOUT
             TO  WK-CALC-SYOSAI
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算詳細=["WK-CALC-SYOSAI"]"
      D    DISPLAY  CNS-PGM-ID ":  4.1.2.ワーク計算詳細セット  END  "
      *-----------------------------------------------------------------
      *----------  4.1.3.素データ分析
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":  4.1.3.素データ分析  START  "
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン=["WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計算詳細    =["WK-CALC-SYOSAI"]"
      *-----------------------------------------------------------------
      *----------  計算パターン←ワーク計算パターン
           MOVE  WK-CALC-PTN
             TO  CALC-PTN                OF  PARM-SMZJ1912-INOUT
      *----------  計算詳細←ワーク計算詳細
           MOVE  WK-CALC-SYOSAI
             TO  CALC-SYOSAI             OF  PARM-SMZJ1912-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":計算パターン=["
      D             CALC-PTN             OF  PARM-SMZJ1912-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":計算詳細=["
      D             CALC-SYOSAI          OF  PARM-SMZJ1912-INOUT"]"
      D    DISPLAY  CNS-PGM-ID ":  SMZJ1912をコール START  "
      *-----------------------------------------------------------------
           CALL  "SMZJ1912"              USING  PARM-SMZJ1912-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.素データ分析結果=["
      D            SO-DATA-BENSEKI-KEKKA   OF  PARM-SMZJ1912-INOUT"]"
      D    DISPLAY  CNS-PGM-ID ":  SMZJ1912をコール END  "
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果←リターンパッケージ.素データ分析結果
           MOVE  SO-DATA-BENSEKI-KEKKA   OF  PARM-SMZJ1912-INOUT
             TO  WK-SO-DATA-BENSEKI-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果=["
      D             WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID ":  4.1.3.素データ分析  END  "
      *-----------------------------------------------------------------
      *----------  4.1.4.素データ整理
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":  4.1.4.素データ整理  START  "
      *-----------------------------------------------------------------
      *----------  4.1.4.1.諸フラグ設定
           IF  WK-TORI-IDO-FLG  =  CNS-FLG-1
           THEN
             IF  WK-SJTK-H-BOKA     OF  WK-TORI-IDO  NOT  =  CNS-SYOKITI
             THEN
      *----------  ワーク市場通貨簿価指定フラグ
               MOVE  CNS-DATA-FLG-1 TO  WK-SJTK-BOKA-SITEI-FLG
             ELSE
               CONTINUE
             END-IF
             IF  WK-UYTK-H-BOKA     OF  WK-TORI-IDO  NOT  =  CNS-SYOKITI
             THEN
      *----------  ワーク運用通貨簿価指定フラグ
               MOVE  CNS-DATA-FLG-1 TO  WK-UYTK-BOKA-SITEI-FLG
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
           IF  WK-TARGET-TORI-ID    OF  WK-TORI-DATA  NOT  =  ZERO
           THEN
      *----------  ワーク相手存在フラグ
             MOVE  CNS-DATA-FLG-1   TO  WK-AITE-SONZAI-FLG
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨簿価指定フラグ  = ["
      D             WK-SJTK-BOKA-SITEI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨簿価指定フラグ  = ["
      D             WK-UYTK-BOKA-SITEI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク相手存在フラグ          = ["
      D             WK-AITE-SONZAI-FLG"]"
      *-----------------------------------------------------------------
      *----------  4.1.4.2.取引系
      *----------  1)ワーク素データ分析結果.a03親株取引フラグ＝'1'の場合
      *----------  OR  ワーク素データ分析結果.a04新株取引フラグ＝'1'
           IF  WK-O-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1
             OR  WK-N-TORI-FLG OF WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a03親株取引フラ"
      D             "グ=["WK-O-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a04新株取引フラ"
      D             "グ=["WK-N-TORI-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             INITIALIZE  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  判定対象区分
             MOVE  CNS-HANTEI-TARGET-KBN-3
               TO  HANTEI-TARGET-KBN     OF  PARM-SMZJ4012-ARG1
             PERFORM  SMZJ4012-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.C/A位置付けフラグ=["
      D             CA-POS-FLG           OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークC/A位置付けフラグ
             MOVE  CA-POS-FLG            OF  PARM-SMZJ4012-ARG2
               TO  WK-CA-POS-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a03親株取引フラ"
      D             "グ=["WK-O-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a04新株取引フラ"
      D             "グ=["WK-N-TORI-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  2)ワーク素データ分析結果.a03親株取引フラグ＝'1'の場合
           IF  WK-O-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a03親株取引フラ"
      D             "グ=["WK-O-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  A)C/A位置付けフラグ＝'1'(分割元)の場合
             IF  WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.異動数量=["
      D             WK-IDO-SURYO         OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.精算金額(市場通貨換算額"
      D             ")=["WK-S-KSG-SSKG   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.精算金額(運用通貨換算額"
      D             ")=["WK-U-KSG-SSKG   OF  WK-DATA-IN"]"
      *-----------------------------------------------------------------
      *----------  ワーク親株取引.異動数量
               MOVE  WK-IDO-SURYO        OF  WK-DATA-IN
                 TO  WK-IDO-SURYO        OF  WK-OKB-TORI-PARM
      *----------  ワーク親株取引.精算金額(市場通貨換算額)
               MOVE  WK-S-KSG-SSKG       OF  WK-DATA-IN
                 TO  WK-S-KSG-SSKG       OF  WK-OKB-TORI-PARM
      *----------  ワーク親株取引.精算金額(運用通貨換算額)
               MOVE  WK-U-KSG-SSKG       OF  WK-DATA-IN
                 TO  WK-U-KSG-G-SSKG     OF  WK-OKB-TORI-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク親株取引.異動数量=["
      D             WK-IDO-SURYO         OF  WK-OKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク親株取引.精算金額(市場通貨換算額)"
      D             "=["WK-S-KSG-SSKG    OF  WK-OKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク親株取引.精算金額(運用通貨換算額)"
      D             "=["WK-U-KSG-G-SSKG  OF  WK-OKB-TORI-PARM"]"
      *-----------------------------------------------------------------
             ELSE
               IF  WK-CA-POS-FLG = CNS-BUNKATSUSEN
               THEN
      *----------  B)ワークC/A位置付けフラグ＝'2'(分割先)の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
                 IF  (WK-SJTK-BOKA-SITEI-FLG = ZERO  OR
                      WK-UYTK-BOKA-SITEI-FLG = ZERO) AND
                      WK-AITE-SONZAI-FLG     = CNS-DATA-FLG-1
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":（ワーク市場通貨簿価指定フラグ＝0"
      D             "(未指定)  OR  ワーク運用通貨簿価指定フラグ＝0"
      D             "(未指定)）AND ワーク相手存在フラグ＝1(ある)の場合"
      *-----------------------------------------------------------------
                   PERFORM  OKB-TORI-GET-RTN
                 ELSE
                   CONTINUE
                 END-IF
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
                 CONTINUE
               END-IF
             END-IF
           ELSE
             CONTINUE
           END-IF
      *----------  3)ワーク素データ分析結果.a04新株取引フラグ＝'1'の場合
           IF  WK-N-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a04新株取引フラ"
      D             "グ=["WK-N-TORI-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             IF  WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *----------  A)ワークC/A位置付けフラグ＝'1'(分割元)の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               IF  (WK-SJTK-BOKA-SITEI-FLG = ZERO  OR
                    WK-UYTK-BOKA-SITEI-FLG = ZERO) AND
                    WK-AITE-SONZAI-FLG     = CNS-DATA-FLG-1
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":（ワーク市場通貨簿価指定フラグ＝0"
      D             "(未指定)  OR  ワーク運用通貨簿価指定フラグ＝0"
      D             "(未指定)）AND ワーク相手存在フラグ＝1(ある)の場合"
      *-----------------------------------------------------------------
                 PERFORM  SKB-TORI-GET-RTN
               ELSE
                 CONTINUE
               END-IF
             ELSE
               IF  WK-CA-POS-FLG = CNS-BUNKATSUSEN
               THEN
      *----------  B)ワークC/A位置付けフラグ＝'2'(分割先)の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.異動数量=["
      D             WK-IDO-SURYO         OF  WK-DATA-IN"]"
      *-----------------------------------------------------------------
      *----------  ワーク新株取引.異動数量
                 MOVE  WK-IDO-SURYO        OF  WK-DATA-IN
                   TO  WK-IDO-SURYO        OF  WK-SKB-TORI-PARM
      *----------  ワーク新株取引.約定単価
                 MOVE  WK-YKJ-TANKA        OF  WK-DATA-IN
                   TO  WK-YKJ-TANKA        OF  WK-SKB-TORI-PARM
      *----------  ワーク新株取引.換算後為替レート（市場／運用）
                 MOVE  WK-K-S-U-KWS        OF  WK-TARGET-TORI-INFO
                   TO  WK-K-S-U-KWS        OF  WK-SKB-TORI-PARM
      *----------  ワーク新株取引.約定金額(市場通貨換算額)
                 MOVE  WK-S-KSG-G-YJKG     OF  WK-DATA-IN
                   TO  WK-S-KSG-G-YJKG     OF  WK-SKB-TORI-PARM
      *----------  ワーク新株取引.約定金額(運用通貨換算額)
                 MOVE  WK-U-KSG-G-YJKG     OF  WK-DATA-IN
                   TO  WK-U-KSG-G-YJKG     OF  WK-SKB-TORI-PARM
      *----------  ワーク新株取引.市場通貨コード
                 MOVE  WK-SJTK-CD          OF  WK-DATA-IN
                   TO  WK-SIJO-TUKA-CD     OF  WK-SKB-TORI-PARM
      *----------  ワーク新株取引.数量単位
                 MOVE  WK-SURYO-TANI       OF  WK-TORI-DATA
                                           OF  WK-DATA-IN
                   TO  WK-SURYO-TANI       OF  WK-SKB-TORI-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク新株取引.異動数量=["
      D             WK-IDO-SURYO         OF  WK-SKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク新株取引.約定単価=["
      D             WK-YKJ-TANKA         OF  WK-SKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク新株取引.換算後為替レート（市場／運用）=["
      D             WK-K-S-U-KWS         OF  WK-SKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク新株取引.約定金額(市場通貨換算額)=["
      D             WK-S-KSG-G-YJKG      OF  WK-SKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク新株取引.約定金額(運用通貨換算額)=["
      D             WK-U-KSG-G-YJKG      OF  WK-SKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク新株取引.市場通貨コード =["
      D             WK-SIJO-TUKA-CD      OF  WK-SKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク新株取引.数量単位 =["
      D             WK-SURYO-TANI        OF  WK-SKB-TORI-PARM"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             END-IF
           ELSE
             CONTINUE
           END-IF
      *----------  4)ワーク素データ分析結果.a07取引分析-オプションフラグ＝'1'の場合
           IF  WK-TORI-BUNSEKI-OPT-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a07取引分析-オプ"
      D             "ションフラグ=["WK-TORI-BUNSEKI-OPT-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD        OF  WK-MEG-BETU-DMN-INFO"]"
      *-----------------------------------------------------------------
      *----------  証券種別コード
             MOVE  WK-SEC-SBT-CD         OF  WK-MEG-BETU-DMN-INFO
               TO  SEC-SBT-CD            OF  PARM-SMZJ4014-ARG1
      *----------  判定対象区分
             MOVE  CNS-HANTEI-TARGET-KBN-2
               TO  HANTEI-TARGET-KBN     OF  PARM-SMZJ4014-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD           OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分=["
      D             HANTEI-TARGET-KBN    OF  PARM-SMZJ4014-ARG1"]"
      *-----------------------------------------------------------------
      *---------- 【SMZJ4014】証券種別判定をコールして、リターンパッケージを取得する
             CALL  "SMZJ4014"            USING  PARM-SMZJ4014-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.コール／プットフラグ=["
      D             CALL-PUT-FLG         OF  PARM-SMZJ4014-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引分析-オプション.コール／プットフラグ
             MOVE  CALL-PUT-FLG          OF  PARM-SMZJ4014-ARG2
               TO  WK-CALL-PUT-FLG       OF  WK-TORI-BUNSEKI-OPT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引分析-オプション.コール／プットフラグ=["
      D             WK-CALL-PUT-FLG      OF  WK-TORI-BUNSEKI-OPT"]"
      *-----------------------------------------------------------------
             IF  WK-CALL-PUT-FLG         OF  WK-TORI-BUNSEKI-OPT
               = CNS-C3
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引分析-オプション."
      D             ":コール／プットフラグ＝'3'(判断できない)の場合"
      D    DISPLAY  CNS-PGM-ID":銘柄属性コールプット区分=["
      D             WK-MEG-CALL-PUT-KBN  OF  WK-DATA-IN"]"
      *-----------------------------------------------------------------
               EVALUATE  WK-MEG-CALL-PUT-KBN  OF  WK-DATA-IN
                 WHEN  CNS-C
      *----------  ワーク取引分析-オプション.コール／プットフラグ ← '1'
                   MOVE  CNS-C1
                     TO  WK-CALL-PUT-FLG      OF  WK-TORI-BUNSEKI-OPT
                 WHEN  CNS-P
      *----------  ワーク取引分析-オプション.コール／プットフラグ ← '2'
                   MOVE  CNS-C2
                     TO  WK-CALL-PUT-FLG      OF  WK-TORI-BUNSEKI-OPT
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引分析-オプション.コール／プットフラグ=["
      D             WK-CALL-PUT-FLG      OF  WK-TORI-BUNSEKI-OPT"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a07取引分析-オプ"
      D             "ションフラグ=["WK-TORI-BUNSEKI-OPT-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD        OF  WK-MEG-BETU-DMN-INFO"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  5)ワーク素データ分析結果.a09取引分析-先物フラグ＝'1'の場合
           IF  WK-TORI-BUNSEKI-FT-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a09取引分析-先物"
      D             "フラグ=["WK-TORI-BUNSEKI-FT-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             INITIALIZE  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  判定対象区分
             MOVE  CNS-HANTEI-TARGET-KBN-5
               TO  HANTEI-TARGET-KBN     OF  PARM-SMZJ4012-ARG1
             PERFORM  SMZJ4012-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.権利行使・割当フラグ=["
      D             KRKS-WARIATE-FLG     OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引分析-先物.権利行使・割当フラグ
             MOVE  KRKS-WARIATE-FLG      OF  PARM-SMZJ4012-ARG2
               TO  WK-KRKS-WARIATE-FLG   OF  WK-TORI-BUNSEKI-FT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引分析-先物.権利行使・割当フラグ=["
      D             WK-KRKS-WARIATE-FLG  OF  WK-TORI-BUNSEKI-FT"]"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a09取引分析-先物"
      D             "フラグ=["WK-TORI-BUNSEKI-FT-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  6)ワーク素データ分析結果.a10取引分析-未収未払フラグ＝'1'
      *----------  AND ARG1.取引データ.資金決済方法＝ '2'（ﾉﾝｶﾊﾞｰ）の場合
           IF  WK-TORI-BUNSEKI-MSMH-FLG
               OF  WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1 AND
               WK-KESAI-HOHO  OF  WK-TORI-DATA =  CNS-KESAI-HOHO-2
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a10取引分析-未収"
      D             "未払フラグ=["WK-TORI-BUNSEKI-MSMH-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.資金決済方法=["
      D             WK-KESAI-HOHO        OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
             IF  WK-G-NSKG    OF  WK-TORI-DATA > ZERO
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.現地入出金額=["
      D             WK-G-NSKG           OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引分析-未収未払.未収未払フラグ
               MOVE  CNS-MISYU-MIHAR-FLG-1
                 TO  WK-MISYU-MIHAR-FLG  OF  WK-TORI-BUNSEK-MSMH
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引分析-未収未払.未収未払フラグ=["
      D             WK-MISYU-MIHAR-FLG  OF  WK-TORI-BUNSEK-MSMH"]"
      *-----------------------------------------------------------------
             ELSE
               IF  WK-G-NSKG    OF  WK-TORI-DATA < ZERO
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.現地入出金額=["
      D             WK-G-NSKG           OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引分析-未収未払.未収未払フラグ
                 MOVE  CNS-MISYU-MIHAR-FLG-2
                   TO  WK-MISYU-MIHAR-FLG  OF  WK-TORI-BUNSEK-MSMH
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引分析-未収未払.未収未払フラグ=["
      D             WK-MISYU-MIHAR-FLG  OF  WK-TORI-BUNSEK-MSMH"]"
      *-----------------------------------------------------------------
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.現地入出金額=["
      D             WK-G-NSKG           OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  ワーク取引分析-未収未払.未収未払フラグ
                 MOVE  CNS-MISYU-MIHAR-FLG-0
                   TO  WK-MISYU-MIHAR-FLG  OF  WK-TORI-BUNSEK-MSMH
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引分析-未収未払.未収未払フラグ=["
      D             WK-MISYU-MIHAR-FLG  OF  WK-TORI-BUNSEK-MSMH"]"
      *-----------------------------------------------------------------
               END-IF
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a10取引分析-未収"
      D             "未払フラグ=["WK-TORI-BUNSEKI-MSMH-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.資金決済方法=["
      D             WK-KESAI-HOHO        OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  7)ワーク素データ分析結果.a08直前取引フラグ＝'1'AND ARG1.対象取引情報.処理順≠1の場合
           IF  WK-CHOKZ-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1 AND WK-SRJUN OF WK-TARGET-TORI-INFO
               NOT = CNS-SRJUN-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a08直前取引フラ"
      D             "グ=["WK-CHOKZ-TORI-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.対象取引情報.処理順=["
      D             WK-SRJUN      OF WK-TARGET-TORI-INFO"]"
      *-----------------------------------------------------------------
             PERFORM  CHOKZ-TORI-GET-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a08直前取引フラ"
      D             "グ=["WK-CHOKZ-TORI-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  8)ワーク素データ分析結果.a11取引分析-為替差損益フラグ＝'1'の場合
           IF  WK-TRBNSEKI-KWSNEKI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
            =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a11取引分析-為替"
      D             "差損益フラグ=["WK-TRBNSEKI-KWSNEKI-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             INITIALIZE  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  判定対象区分
             MOVE  CNS-HANTEI-TARGET-KBN-7
               TO  HANTEI-TARGET-KBN     OF  PARM-SMZJ4012-ARG1
             PERFORM  SMZJ4012-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.為替差損益フラグ=["
      D             UYTK-KWS-SNEKI-FLG     OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク為替差損益フラグ
             MOVE  UYTK-KWS-SNEKI-FLG    OF  PARM-SMZJ4012-ARG2
               TO  WK-KWS-SNEKI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク為替差損益フラグ=["
      D             WK-KWS-SNEKI-FLG"]"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a11取引分析-為替"
      D             "差損益フラグ=["WK-TRBNSEKI-KWSNEKI-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  4.1.4.3.異動系
      *----------  1)ワーク素データ分析結果.b02直前親株残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-O-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b02直前親株残高"
      D             "異動フラググ=["WK-CHOKZ-O-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *----------  ワークC/A位置付けフラグ＝'1'(分割元)の場合
               MOVE  WK-SI-TU-CD         OF  WK-TZ-ZN-IDO
                 TO  WK-SIJO-TUKA-CD     OF  WK-CHOKZ-O-ZADAKA-IDOU
               MOVE  WK-IDOG-SRYZN       OF  WK-TZ-ZN-IDO
                 TO  WK-IDOG-SRYZN       OF  WK-CHOKZ-O-ZADAKA-IDOU
               MOVE  WK-SJTK-IDOG-BOKAZN OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-BOKAZN OF  WK-CHOKZ-O-ZADAKA-IDOU
               MOVE  WK-UYTK-IDOG-BOKAZN OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-BOKAZN OF  WK-CHOKZ-O-ZADAKA-IDOU
               MOVE  WK-SURYO-TANI       OF  WK-TZ-ZN-IDO
                 TO  WK-SURYO-TANI       OF  WK-CHOKZ-O-ZADAKA-IDOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動=["
      D             WK-CHOKZ-O-ZADAKA-IDOU"]"
      *-----------------------------------------------------------------
             ELSE
               IF  (WK-SJTK-BOKA-SITEI-FLG = ZERO  OR
                    WK-UYTK-BOKA-SITEI-FLG = ZERO) AND
                    WK-AITE-SONZAI-FLG     = CNS-DATA-FLG-1
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":（ワーク市場通貨簿価指定フラグ＝0"
      D             "(未指定)  OR  ワーク運用通貨簿価指定フラグ＝0"
      D             "(未指定)）AND ワーク相手存在フラグ＝1(ある)の場合"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ=["               @3212SEINO@
      D                             WK-YKJ-UKE-JUN-FLG"]"               @3212SEINO@
      *-----------------------------------------------------------------
               IF  WK-YKJ-UKE-JUN-FLG = CNS-FLG-1                       @3212SEINO@
               THEN                                                     @3212SEINO@
                 PERFORM  TKMZBW06-GET-RTN                              @3212SEINO@
               ELSE                                                     @3212SEINO@
                 PERFORM  TKMZBW06-GET-2-RTN                            @3212SEINO@
               END-IF                                                   @3212SEINO@
               ELSE
                 CONTINUE
               END-IF
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b02直前親株残高"
      D             "異動フラググ=["WK-CHOKZ-O-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  2)ワーク素データ分析結果.b06直前新株残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-S-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b06直前新株残高"
      D             "異動フラググ=["WK-CHOKZ-S-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
               CONTINUE
             ELSE
               MOVE  WK-IDOG-SRYZN       OF  WK-TZ-ZN-IDO
                 TO  WK-IDOG-SRYZN       OF  WK-CHOKZ-S-ZADAKA-IDOU
               MOVE  WK-SJTK-IDOG-BOKAZN OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-BOKAZN OF  WK-CHOKZ-S-ZADAKA-IDOU
               MOVE  WK-UYTK-IDOG-BOKAZN OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-BOKAZN OF  WK-CHOKZ-S-ZADAKA-IDOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク直前新株残高異動=["
      D             WK-CHOKZ-S-ZADAKA-IDOU"]"
      *-----------------------------------------------------------------
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b06直前新株残高"
      D             "異動フラググ=["WK-CHOKZ-S-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  4)ワーク素データ分析結果.f01売買金額フラグ＝'1'の場合
           IF  WK-BS-KN-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.f01売買金額フラ"
      D             "グ=["WK-BS-KN-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             INITIALIZE  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU       OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  判定対象区分
             MOVE  CNS-HANTEI-TARGET-KBN-A
               TO  HANTEI-TARGET-KBN   OF  PARM-SMZJ4012-ARG1
             PERFORM  SMZJ4012-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":【SMZJ4012】.ARG2.CB転換・ワラント行使フラグ=["
      D             CB-TENKAN-WRNT-FLG  OF  PARM-SMZJ4012-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨簿価指定フラグ      =["
      D             WK-SJTK-BOKA-SITEI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨簿価指定フラグ      =["
      D             WK-UYTK-BOKA-SITEI-FLG"]"
      *-----------------------------------------------------------------
             IF  CB-TENKAN-WRNT-FLG  OF  PARM-SMZJ4012-ARG2 = CNS-FLG-1
             AND (WK-SJTK-BOKA-SITEI-FLG   =  ZERO  OR
                  WK-UYTK-BOKA-SITEI-FLG   =  ZERO)
             THEN
               PERFORM  TKMZBW06-GET2-RTN
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":【SMZJ4012】.ARG2.CB転換・ワラント行使フラグ=["
      D             CB-TENKAN-WRNT-FLG  OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             INITIALIZE  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU       OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  判定対象区分
             MOVE  CNS-HANTEI-TARGET-KBN-4
               TO  HANTEI-TARGET-KBN   OF  PARM-SMZJ4012-ARG1
             PERFORM  SMZJ4012-RTN
             IF  BS-GK-ST-FLG  OF  PARM-SMZJ4012-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":【SMZJ4012】.ARG2.売買現先スタートフラグ=["
      D             BS-GK-ST-FLG  OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク運用通貨予備売買金額
               MOVE  WK-U-KSG-G-KKKRS  OF  WK-TORI-DATA
                 TO  WK-UYTK-YOBI-BS-KN
      *----------  ワーク市場通貨予備売買金額
               MOVE  WK-S-KSG-G-KKKRS  OF  WK-TORI-DATA
                 TO  WK-SJTK-YOBI-BS-KN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨予備売買金額=["
      D             WK-UYTK-YOBI-BS-KN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨予備売買金額=["
      D             WK-SJTK-YOBI-BS-KN"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":【SMZJ4012】.ARG2.売買現先スタートフラグ=["
      D             BS-GK-ST-FLG  OF  PARM-SMZJ4012-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.f01売買金額フラ"
      D             "グ=["WK-BS-KN-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  4.1.4.4.属性系
      *----------  2)ワーク素データ分析結果.c04仕訳基準フラグ＝'1'の場合
           IF  WK-SWK-KJN-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c04仕訳基準フラ"
      D             "グ=["WK-SWK-KJN-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "為替差損益計上区分=["
      D             WK-UKS-KJY-KBN           OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "手数料用売買損益に含むフラグ=["
      D             WK-TESRY-BBSNEKI-FLG     OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "消費税用売買損益に含むフラグ=["
      D             WK-SHOHI-TAX-BBSNEKI-FLG  OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "その他費用用売買損益に含むフラグ=["
      D             WK-ELS-HIYO-BBSNEKI-FLG  OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "日歩用売買損益に含むフラグ=["
      D             WK-HIBU-BBSNEKI-FLG      OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "逆日歩用売買損益に含むフラグ=["
      D             WK-GHIBU-BBSNEKI-FLG     OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "管理費用売買損益に含むフラグ=["
      D             WK-KRH-BBSNEKI-FLG       OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "管理費消費税用売買損益に含むフラグ=["
      D             WK-KRH-SHZ-BBSNEKI-FLG   OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "手数料を市場取得金額に含めるフラグ=["
      D             WK-TESRY-SJST-KN-FLG     OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "消費税を市場取得金額に含めるフラグ=["
      D             WK-SHOHI-TAX-SJST-KN-FLG  OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "その他費用を市場取得金額に含めるフラグ=["
      D             WK-ELS-HIYO-SJST-KN-FLG  OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "日歩を市場取得金額に含めるフラグ=["
      D             WK-KSG-HIBU-SJST-KN-FLG  OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "逆日歩を市場取得金額に含めるフラグ=["
      D             WK-KSG-GHIBU-SJST-KN-FLG  OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "管理費を市場取得金額に含めるフラグ=["
      D             WK-KSG-SJST-KN-FLG       OF  WK-SWK-KJN-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.仕訳基準データ."
      D             "管理費消費税を市場取得金額に含めるフラグ=["
      D             WK-KSG-KRH-SJST-KN-FLG   OF  WK-SWK-KJN-DATA"]"
      *-----------------------------------------------------------------
      *----------  ワーク仕訳基準 ← ARG1.仕訳基準データ
             MOVE  WK-SWK-KJN-DATA       TO  WK-SWK-KJN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク仕訳基準.為替差損益の計上フラグ=["
      D             WK-UYTK-KWS-SNEKI-FLG    OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク仕訳基準.手数料用売買損益に含むフラグ=["
      D             WK-TESRY-BBSNEKI-FLG     OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク仕訳基準.消費税用売買損益に含むフラグ=["
      D             WK-SHOHI-TAX-BBSNEKI-FLG    OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク仕訳基準.その他費用用売買損益に含むフラグ=["
      D             WK-ELS-HIYO-BBSNEKI-FLG  OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク仕訳基準.日歩用売買損益に含むフラグ=["
      D             WK-HIBU-BBSNEKI-FLG      OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク仕訳基準.逆日歩用売買損益に含むフラグ=["
      D             WK-GHIBU-BBSNEKI-FLG     OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク仕訳基準.管理費用売買損益に含むフラグ=["
      D             WK-KRH-BBSNEKI-FLG       OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク仕訳基準.管理費消費税用売買損益に含むフラグ=["
      D             WK-KRH-SHZ-BBSNEKI-FLG   OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク仕訳基準.手数料を市場取得金額に含めるフラグ=["
      D             WK-TESRY-SJST-KN-FLG     OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク仕訳基準.消費税を市場取得金額に含めるフラグ=["
      D             WK-SHOHI-TAX-SJST-KN-FLG OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D       ":ワーク仕訳基準.その他費用を市場取得金額に含めるフラグ=["
      D             WK-ELS-HIYO-SJST-KN-FLG  OF WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク仕訳基準.日歩を市場取得金額に含めるフラグ=["
      D             WK-KSG-HIBU-SJST-KN-FLG  OF  WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク仕訳基準.逆日歩を市場取得金額に含めるフラグ=["
      D             WK-KSG-GHIBU-SJST-KN-FLG OF  WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク仕訳基準.管理費を市場取得金額に含めるフラグ=["
      D             WK-KSG-SJST-KN-FLG       OF  WK-SWK-KJN"]"
      D    DISPLAY  CNS-PGM-ID
      D     ":ワーク仕訳基準.管理費消費税を市場取得金額に含めるフラグ=["
      D             WK-KSG-KRH-SJST-KN-FLG   OF  WK-SWK-KJN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c04仕訳基準フラ"
      D             "グ=["WK-SWK-KJN-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  3)ワーク素データ分析結果.c05仕訳パターン分析フラグ＝'1'の場合
           IF  WK-SWK-PATTERN-BUNSEKI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZJ1916-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  3)ワーク素データ分析結果.c06引継元仕訳基準フラグ＝'1'の場合
           IF  WK-HT-SWK-KJN-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c06引継元仕訳"
      D             "基準フラグ=["WK-HT-SWK-KJN-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             IF  WK-OLD-SEC-SBT-CD NOT = WK-SEC-SBT-CD OF WK-TORI-DATA
               OR  WK-OLD-TORI-JIYU NOT = WK-TORI-JIYU OF  WK-TORI-DATA
               OR  WK-OLD-TATE-FLG NOT = WK-TATE-FLG OF  WK-TORI-DATA
               OR  WK-OLD-OP-L-S-FLG NOT =
                   WK-OP-L-S-FLG  OF  WK-TZ-ZN-IDO
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークOLD証券種別コード=["
      D             WK-OLD-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.券種別コード=["
      D             WK-SEC-SBT-CD        OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD取引事由=["
      D             WK-OLD-TORI-JIYU"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD資産負債・買建売建フラグ=["
      D             WK-OLD-TATE-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.取引データ.資産負債・買建売建フラグ=["
      D             WK-TATE-FLG          OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLDオプションL／Sフラグ=["
      D             WK-OLD-OP-L-S-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.直前残高異動.オプションL／Sフラグ=["
      D             WK-OP-L-S-FLG        OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
               PERFORM  SMZJ1915-RTN
      *----------  ワークOLD証券種別コード←ARG1.取引データ.券種別コード
               MOVE  WK-SEC-SBT-CD       OF  WK-TORI-DATA
                 TO  WK-OLD-SEC-SBT-CD
      *----------  ワークOLD取引事由←ARG1.取引データ.取引事由
               MOVE  WK-TORI-JIYU        OF  WK-TORI-DATA
                 TO  WK-OLD-TORI-JIYU
      *----------  ワークOLD資産負債・買建売建フラグ←ARG1.取引データ.資産負債・買建売建フラグ
               MOVE  WK-TATE-FLG         OF  WK-TORI-DATA
                 TO  WK-OLD-TATE-FLG
      *----------  ワークOLDオプションL／Sフラグ←ARG1.直前残高異動.オプションL／Sフラグ
               MOVE  WK-OP-L-S-FLG       OF  WK-TZ-ZN-IDO
                 TO  WK-OLD-OP-L-S-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークOLD証券種別コード=["
      D             WK-OLD-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD取引事由=["
      D             WK-OLD-TORI-JIYU"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD資産負債・買建売建フラグ=["
      D             WK-OLD-TATE-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLDオプションL／Sフラグ=["
      D             WK-OLD-OP-L-S-FLG"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークOLD証券種別コード=["
      D             WK-OLD-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.券種別コード=["
      D             WK-SEC-SBT-CD        OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD取引事由=["
      D             WK-OLD-TORI-JIYU"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由=["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD資産負債・買建売建フラグ=["
      D             WK-OLD-TATE-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.取引データ.資産負債・買建売建フラグ=["
      D             WK-TATE-FLG          OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLDオプションL／Sフラグ=["
      D             WK-OLD-OP-L-S-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.直前残高異動.オプションL／Sフラグ=["
      D             WK-OP-L-S-FLG        OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c06引継元仕訳"
      D             "基準フラグ=["WK-HT-SWK-KJN-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":  4.1.4.素データ整理  END  "
      *-----------------------------------------------------------------
      *----------  4.1.5.各項目計算
      *----------  1)数量計算
           PERFORM  SMZC1950-RTN
      *----------  2)個別計算GROUP１
      *----------  ①ワーク素データ分析結果.e03個別計算３フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-3-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e03個別計算３"
      D             "フラグ=["WK-KOBETSU-CALC-3-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1400-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e03個別計算３"
      D             "フラグ=["WK-KOBETSU-CALC-3-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ②ワーク素データ分析結果.e05個別計算５フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-5-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e05個別計算５"
      D             "フラグ=["WK-KOBETSU-CALC-5-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1402-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e05個別計算５"
      D             "フラグ=["WK-KOBETSU-CALC-5-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ③ワーク素データ分析結果.e06個別計算６フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-6-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e06個別計算６"
      D             "フラグ=["WK-KOBETSU-CALC-6-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  ワーク一口売却計算フラグ＝'1'の場合
             IF  WK-KUTI1-BAKYK-CALC-FLG  =  CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク一口売却計算フラグ= ["
      D             WK-KUTI1-BAKYK-CALC-FLG"]"
      *-----------------------------------------------------------------
               PERFORM  TKMZBW04-GET-RTN
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク一口売却計算フラグ= ["
      D             WK-KUTI1-BAKYK-CALC-FLG"]"
      *-----------------------------------------------------------------
               PERFORM  SMZC1403-RTN
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e06個別計算６"
      D             "フラグ=["WK-KOBETSU-CALC-6-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ④ワーク素データ分析結果.e07個別計算７フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-7-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e07個別計算７"
      D             "フラグ=["WK-KOBETSU-CALC-7-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1404-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e07個別計算７"
      D             "フラグ=["WK-KOBETSU-CALC-7-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑤ワーク素データ分析結果.e08個別計算８フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-8-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e08個別計算８"
      D             "フラグ=["WK-KOBETSU-CALC-8-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1405-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e08個別計算８"
      D             "フラグ=["WK-KOBETSU-CALC-8-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑥ワーク素データ分析結果.e09個別計算９フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-9-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e09個別計算９"
      D             "フラグ=["WK-KOBETSU-CALC-9-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1406-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e09個別計算９"
      D             "フラグ=["WK-KOBETSU-CALC-9-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑦ワーク素データ分析結果.e10個別計算１０フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-10-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e10個別計算１０"
      D             "フラグ=["WK-KOBETSU-CALC-10-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1407-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e10個別計算１０"
      D             "フラグ=["WK-KOBETSU-CALC-10-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑧ワーク素データ分析結果.e13個別計算１３フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-13-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e13個別計算１３"
      D             "フラグ=["WK-KOBETSU-CALC-13-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             IF  (WK-SJTK-BOKA-SITEI-FLG = ZERO  OR
                  WK-UYTK-BOKA-SITEI-FLG = ZERO) AND
                  WK-AITE-SONZAI-FLG     = CNS-DATA-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":（ワーク市場通貨簿価指定フラグ＝0"
      D             "(未指定)  OR  ワーク運用通貨簿価指定フラグ＝0"
      D             "(未指定)）AND ワーク相手存在フラグ＝1(ある)の場合"
      *-----------------------------------------------------------------
               PERFORM  SMZC1410-RTN
             ELSE
               CONTINUE
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e13個別計算１３"
      D             "フラグ=["WK-KOBETSU-CALC-13-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑨ワーク素データ分析結果.e14個別計算１４フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-14-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e14個別計算１４"
      D             "フラグ=["WK-KOBETSU-CALC-14-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1411-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e14個別計算１４"
      D             "フラグ=["WK-KOBETSU-CALC-14-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑩ワーク素データ分析結果.e15個別計算１５フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-15-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e15個別計算１５"
      D             "フラグ=["WK-KOBETSU-CALC-15-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1412-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e15個別計算１５"
      D             "フラグ=["WK-KOBETSU-CALC-15-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑪ワーク素データ分析結果.e16個別計算１６フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-16-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e16個別計算１６"
      D             "フラグ=["WK-KOBETSU-CALC-16-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1413-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e16個別計算１６"
      D             "フラグ=["WK-KOBETSU-CALC-16-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑫ワーク素データ分析結果.e17個別計算１７フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-17-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e17個別計算１７"
      D             "フラグ=["WK-KOBETSU-CALC-17-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1414-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e17個別計算１７"
      D             "フラグ=["WK-KOBETSU-CALC-17-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑬ワーク素データ分析結果.e18個別計算１８フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-18-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e18個別計算１８"
      D             "フラグ=["WK-KOBETSU-CALC-18-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1415-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e18個別計算１８"
      D             "フラグ=["WK-KOBETSU-CALC-18-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑭ワーク素データ分析結果.e20個別計算２０フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-20-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e20個別計算２０"
      D             "フラグ=["WK-KOBETSU-CALC-20-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1417-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e20個別計算２０"
      D             "フラグ=["WK-KOBETSU-CALC-20-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑮ワーク素データ分析結果.e19個別計算１９フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-19-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e19個別計算１９"
      D             "フラグ=["WK-KOBETSU-CALC-19-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1416-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e19個別計算１９"
      D             "フラグ=["WK-KOBETSU-CALC-19-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑯ワーク素データ分析結果.e21個別計算２１フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-21-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e21個別計算２１"
      D             "フラグ=["WK-KOBETSU-CALC-21-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1418-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e21個別計算２１"
      D             "フラグ=["WK-KOBETSU-CALC-21-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ⑰ワーク素データ分析結果.e22個別計算２２フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-22-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1419-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  3)簿価計算
           PERFORM  SMZC1951-RTN
      *----------  4)建玉計算
           PERFORM  SMZC1956-RTN
      *----------  5)個別計算GROUP2
      *----------  ①ワーク素データ分析結果.e11個別計算１１フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-11-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e11個別計算１１"
      D             "フラグ=["WK-KOBETSU-CALC-11-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             PERFORM  SMZC1408-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e11個別計算１１"
      D             "フラグ=["WK-KOBETSU-CALC-11-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  6)前払金計算
           PERFORM  SMZC1952-RTN
      *----------  7)売買損益計算
           PERFORM  SMZC1953-RTN
      *----------  8)その他損益計算
           PERFORM  SMZC1954-RTN
      *----------  9)損益勘定計算
           PERFORM  SMZC1955-RTN
      *----------  10)源泉税還付予定計算
           PERFORM  SMZC1957-RTN
      *----------  11)ノンカバー未収未払計算
           PERFORM  SMZC1959-RTN
      *----------  12)未払費用計算
           PERFORM  SMZC1960-RTN
      *----------  13)移管項目計算
           PERFORM  SMZC1961-RTN
      *----------  4.1.6.残高異動データ編集
           PERFORM  TKMZBW06-HENSYU-RTN
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":***  4.1.異動・損益計算  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       IDO-SONEKI-CALC1-EXT.
           EXIT.
      ******************************************************************
      *    本体フラグ編集
      ******************************************************************
       SQL-SELECT-11-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 本体フラグ編集 START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT5                                         @3212SEINO@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD    OF    WK-KYJ-YMD-DMN-INFO
             TO  H-RIYO-CMP-CD     OF    H-TKMXTR00-S-11,
                 WK-RIYO-CMP-CD    OF    WK-MSG-1-11
      *----------  原取引ＩＤ
           MOVE  WK-THRK-ID        OF    WK-TORI-DATA
             TO  H-TORI-ID         OF    H-TKMXTR00-S-11,
                 WK-TORI-ID        OF    WK-MSG-1-11
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMXTR00-S-11"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ    =["
      D             H-TORI-ID            OF  H-TKMXTR00-S-11"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT5=[" SQLSTMT5 "]"               @3212SEINO@
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT5
      *----------  ＳＱＬ文
           MOVE  SQL-SELECT-1-11          TO  SQLSTMT5                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT5=["SQLSTMT5"]"                  @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-11-OPEN=["              @3212SEINO@
      D                         FLG-TKMXTR00-CR-11-OPEN"]"              @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTR00-CR-11-OPEN   NOT =  CNS-ON                @3212SEINO@
           THEN                                                         @3212SEINO@
             EXEC SQL
                 PREPARE S11 FROM :SQLSTMT5                             @3212SEINO@
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               CONTINUE
             ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
               MOVE  CNS-POS-019
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-11        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXTR00_CUR_11  CURSOR  FOR  S11
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":取引事由を取得CUR DECLARE SQLCODE=["
      D             SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMXTR00_CUR_11
               USING :H-TKMXTR00-S-11.H-RIYO-CMP-CD,
                     :H-TKMXTR00-S-11.H-TORI-ID
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引事由を取得CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON              TO  FLG-TKMXTR00-CR-11-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由を取得CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-11-OPEN=["
      D             FLG-TKMXTR00-CR-11-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由を取得CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-020
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-11          DELIMITED  BY  SIZE
               INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引事由を取得CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引事由を取得CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMXTR00_CUR_11
             INTO  :H-TKMXTR00-S-11.H-TORI-JIYU
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引事由を取得CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
                   CONTINUE
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由を取得CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-086
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG
                 OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-11       DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引事由を取得CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID
      *-----------------------------------------------------------------
           CONTINUE.
       SQL-SELECT-11-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ4012】取引事由判定
      ******************************************************************
       SMZJ4012-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** SMZJ4012取引事由判定 START ***"
      *-----------------------------------------------------------------
      *----------  取引事由
             MOVE  WK-TORI-JIYU          OF  WK-TORI-DATA
               TO  TORI-JIYU             OF  PARM-SMZJ4012-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由=["
      D             TORI-JIYU            OF  PARM-SMZJ4012-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分=["
      D             HANTEI-TARGET-KBN    OF  PARM-SMZJ4012-ARG1"]"
      *-------------------<DEBUG>---------------------------------------
      *---------- 【SMZJ4012】取引事由判定をコールして、リターンパッケージを取得する
           CALL  "SMZJ4012"              USING  PARM-SMZJ4012-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** SMZJ4012取引事由判定 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4012-EXT.
           EXIT.
      ******************************************************************
      *    親株取引データを取得する
      ******************************************************************
       OKB-TORI-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 親株取引データを取得 START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 親株取引データ CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
             INITIALIZE  SQLSTMT6                                       @3212SEINO@
      *----------  利用会社コード
             MOVE  WK-RIYO-CMP-CD        OF  WK-KYJ-YMD-DMN-INFO
               TO  H-RIYO-CMP-CD         OF  H-TKMXTR00-S,
                   WK-RIYO-CMP-CD        OF  WK-MSG-1-1
      *----------  原取引ID
             MOVE  WK-TARGET-TORI-ID     OF  WK-TORI-DATA
               TO  H-TORI-ID             OF  H-TKMXTR00-S,
                   WK-TORI-ID            OF  WK-MSG-1-1
             MOVE  SQL-SELECT-1-1        TO  SQLSTMT6                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード            =["
      D             H-RIYO-CMP-CD        OF  H-TKMXTR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ID      =["
      D             H-TORI-ID            OF  H-TKMXTR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT6=[" SQLSTMT6 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["                 @3212SEINO@
      D                         FLG-TKMXTR00-CR-OPEN"]"                 @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTR00-CR-OPEN   NOT =  CNS-ON                   @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  親株取引データCURSOR PREPARE
               EXEC  SQL
                 PREPARE  S1  FROM  :SQLSTMT6                           @3212SEINO@
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":親株取引データCURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":親株取引データCUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":親株取引データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-087
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-1      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMXTR00_CUR  CURSOR  FOR  S1
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":親株取引データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 親株取引データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMXTR00_CUR
                 USING :H-TKMXTR00-S.H-RIYO-CMP-CD,
                       :H-TKMXTR00-S.H-TORI-ID
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":親株取引データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               MOVE  CNS-ON              TO  FLG-TKMXTR00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":親株取引データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["
      D             FLG-TKMXTR00-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":親株取引データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-088
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 親株取引データCURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 親株取引データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
             EXEC SQL
               FETCH TKMXTR00_CUR
               INTO  :H-TKMXTR00
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":親株取引データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             EVALUATE  SQLCODE
      *----------  正常
               WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":親株取引データCURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-1.異動数量                =["
      D             H-IDO-SURYOU         OF  H-TKMXTR00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-1.精算金額(市場通貨換算額)=["
      D             H-S-KSG-G-SSKG       OF  H-TKMXTR00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-1.精算金額(運用通貨換算額)=["
      D             H-U-KSG-G-SSKG       OF  H-TKMXTR00"]"
      *-----------------------------------------------------------------
      *----------  ワーク親株取引←「別紙1-1 SQL説明」
                 MOVE  H-IDO-SURYOU      OF  H-TKMXTR00
                   TO  WK-IDO-SURYO      OF  WK-OKB-TORI-PARM
                 MOVE  H-S-KSG-G-SSKG    OF  H-TKMXTR00
                   TO  WK-S-KSG-SSKG     OF  WK-OKB-TORI-PARM
                 MOVE  H-U-KSG-G-SSKG    OF  H-TKMXTR00
                   TO  WK-U-KSG-G-SSKG   OF  WK-OKB-TORI-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク親株取引.異動数量      =["
      D             WK-IDO-SURYO         OF  WK-OKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク親株取引.精算金額(市場通貨換算額)"
      D             "=["WK-S-KSG-SSKG    OF  WK-OKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク親株取引.精算金額(運用通貨換算額)"
      D             "=["WK-U-KSG-G-SSKG  OF  WK-OKB-TORI-PARM"]"
      *-----------------------------------------------------------------
               WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":親株取引データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
                 COMPUTE  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2
                       =  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
                 MOVE  CNS-WARN-FLG-I1
                   TO  WARN-FLG
                   OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                   OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-089
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-110
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-1      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":親株取引データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-090
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-1      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
             END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 親株取引データCURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID ":*** 親株取引データを取得 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       OKB-TORI-GET-EXT.
           EXIT.
      ******************************************************************
      *    新株取引データを取得する
      ******************************************************************
       SKB-TORI-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 新株取引データを取得 START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 新株取引データ CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
             INITIALIZE  SQLSTMT7                                       @3212SEINO@
      *----------  利用会社コード
             MOVE  WK-RIYO-CMP-CD        OF  WK-KYJ-YMD-DMN-INFO
               TO  H-RIYO-CMP-CD         OF  H-TKMXTR00-S-1,
                   WK-RIYO-CMP-CD        OF  WK-MSG-1-4
      *----------  原取引ＩＤ
             MOVE  WK-TARGET-TORI-ID     OF  WK-TORI-DATA
               TO  H-TORI-ID             OF  H-TKMXTR00-S-1,
                   WK-TORI-ID            OF  WK-MSG-1-4
             MOVE  SQL-SELECT-1-4        TO  SQLSTMT7                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMXTR00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ    =["
      D             H-TORI-ID            OF  H-TKMXTR00-S-1"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT7=[" SQLSTMT7 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-1-OPEN=["               @3212SEINO@
      D                         FLG-TKMXTR00-CR-1-OPEN"]"               @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTR00-CR-1-OPEN   NOT =  CNS-ON                       @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  新株取引データCURSOR PREPARE
             EXEC  SQL
               PREPARE  S4  FROM  :SQLSTMT7                             @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":新株取引データCURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-092
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-4        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXTR00_CUR_1  CURSOR  FOR  S4
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":新株取引データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 新株取引データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMXTR00_CUR_1
                 USING :H-TKMXTR00-S-1.H-RIYO-CMP-CD,
                       :H-TKMXTR00-S-1.H-TORI-ID
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":新株取引データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               MOVE  CNS-ON              TO  FLG-TKMXTR00-CR-1-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-1-OPEN=["
      D             FLG-TKMXTR00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-029
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-4        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 新株取引データCURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 新株取引データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
             EXEC SQL
               FETCH TKMXTR00_CUR_1
               INTO  :H-TKMXTR00-1
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":新株取引データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             EVALUATE  SQLCODE
      *----------  正常
               WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引データCURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-4.SQL=["H-TKMXTR00-1"]"
      *-----------------------------------------------------------------
      *----------  ワーク新株取引←「別紙1-4 SQL説明」
      *----------  異動数量
                 MOVE  H-IDO-SURYOU      OF  H-TKMXTR00-1
                   TO  WK-IDO-SURYO      OF  WK-SKB-TORI-PARM
      *----------  約定単価
                 MOVE  H-YKJ-TANKA       OF  H-TKMXTR00-1
                   TO  WK-YKJ-TANKA      OF  WK-SKB-TORI-PARM
      *----------  為替レート（市場／運用）
                 MOVE  H-S-U-KWS         OF  H-TKMXTR00-1
                   TO  WK-S-U-KWS        OF  WK-SKB-TORI-PARM
      *----------  市場通貨コード
                 MOVE  H-SIJO-TUKA-CD    OF  H-TKMXTR00-1
                   TO  WK-SIJO-TUKA-CD   OF  WK-SKB-TORI-PARM
      *----------  約定金額(市場通貨換算額)
                 MOVE  H-S-KSG-G-YJKG    OF  H-TKMXTR00-1
                   TO  WK-S-KSG-G-YJKG   OF  WK-SKB-TORI-PARM
      *----------  約定金額(運用通貨換算額)
                 MOVE  H-U-KSG-G-YJKG    OF  H-TKMXTR00-1
                   TO  WK-U-KSG-G-YJKG   OF  WK-SKB-TORI-PARM
      *----------  数量単位
                 MOVE  H-SURYO-TANI      OF  H-TKMXTR00-1
                   TO  WK-SURYO-TANI     OF  WK-SKB-TORI-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク新株取引 =["WK-SKB-TORI-PARM"]"
      *-----------------------------------------------------------------
               WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
                 COMPUTE  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2
                       =  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
                 MOVE  CNS-WARN-FLG-I3
                   TO  WARN-FLG
                   OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                   OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-030
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-110
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-4      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-031
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-4      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
             END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 新株取引データCURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID ":*** 新株取引データを取得 END ***"
      D    DISPLAY  CNS-PGM-ID ":*** ②換算後為替レート（市場／運用）"
      D             " START ***"
      *-----------------------------------------------------------------
      *----------  【SCZY4502】為替換算情報取得ルーチンをコールして、乗除区分を取得する。
      *----------  為替系列コード
           MOVE  WK-YKJ-RATE-CD         OF  WK-KYJ-YMD-DMN-INFO
             TO  KWS-KRTU-CD            OF  PARM-SCZY4502-ARG1
      *----------  ベース通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-SKB-TORI-PARM
             TO  BASE-TUKA-CD           OF  PARM-SCZY4502-ARG1
      *----------  目的通貨コード
           MOVE  WK-UYTK-CD             OF  WK-KYJ-YMD-DMN-INFO
             TO  MOKUTEKI-TUKA-CD       OF  PARM-SCZY4502-ARG1
      *----------  為替換算情報データエリア
           MOVE  KWS-GET-AREA           OF  PARM-SMZJ1910-ARG1
             TO  PARM-SCZY4502-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":為替系列コード=["
      D             KWS-KRTU-CD         OF  PARM-SCZY4502-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ベース通貨コード=["
      D             BASE-TUKA-CD        OF  PARM-SCZY4502-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":目的通貨コード=["
      D             MOKUTEKI-TUKA-CD    OF  PARM-SCZY4502-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":為替換算情報データエリア=["
      D             PARM-SCZY4502-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4502"             USING  PARM-SCZY4502-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG      =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4502) =["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF  PARM-RTNPKG=["
      D             COUNTER                        OF  PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG (COUNTER      OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SCZY4502】為替換算情報取得 正常 "
      *-----------------------------------------------------------------
             MOVE  JZ-JS-KBN            OF  PARM-SCZY4502-ARG3
               TO  WK-JZ-JS-KBN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク乗算/除算区分=["WK-JZ-JS-KBN"]"
      *-----------------------------------------------------------------
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-033
               TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
               TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG             OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SCZY4502】為替換算情報取得  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *----------  ワーク乗算/除算区分
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク乗算/除算区分=["WK-JZ-JS-KBN"]"
      *-----------------------------------------------------------------
           IF  WK-JZ-JS-KBN  =  CNS-JZ-JS-KBN-FLG-1
           THEN
             MOVE  WK-S-U-KWS           OF  WK-SKB-TORI-PARM
               TO  WK-K-S-U-KWS         OF  WK-SKB-TORI-PARM
           ELSE
             COMPUTE  WK-K-S-U-KWS      OF  WK-SKB-TORI-PARM
               =  1 / WK-S-U-KWS        OF  WK-SKB-TORI-PARM
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク新株取引.換算後為替レート"
      D    "（市場／運用）=["WK-K-S-U-KWS      OF  WK-SKB-TORI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":SCZY4502為替換算情報取得 END"
      *-----------------------------------------------------------------
           CONTINUE.
       SKB-TORI-GET-EXT.
           EXIT.
      ******************************************************************
      *    直前取引データを取得する
      ******************************************************************
       CHOKZ-TORI-GET-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 直前取引データを取得 START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 直前取引データ CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
             INITIALIZE  SQLSTMT8                                       @3212SEINO@
      *----------  利用会社コード
             MOVE  WK-RIYO-CMP-CD        OF  WK-KYJ-YMD-DMN-INFO
               TO  H-RIYO-CMP-CD         OF  H-TKMXTR00-S-2,
                   WK-RIYO-CMP-CD        OF  WK-MSG-1-1
      *----------  原取引ＩＤ
             MOVE  WK-TORI-ID            OF  WK-TZ-ZN-IDO
               TO  H-TORI-ID             OF  H-TKMXTR00-S-2,
                   WK-TORI-ID            OF  WK-MSG-1-1
             MOVE  SQL-SELECT-1-5        TO  SQLSTMT8                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMXTR00-S-2"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ  =["
      D             H-TORI-ID            OF  H-TKMXTR00-S-2"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT8=[" SQLSTMT8 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-2-OPEN=["               @3212SEINO@
      D                         FLG-TKMXTR00-CR-2-OPEN"]"               @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMXTR00-CR-2-OPEN   NOT =  CNS-ON                 @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  直前取引データCURSOR PREPARE
             EXEC  SQL
               PREPARE  S5  FROM  :SQLSTMT8                             @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":直前取引データCURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前取引データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前取引データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-034
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXTR00_CUR_2  CURSOR  FOR  S5
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":直前取引データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 直前取引データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMXTR00_CUR_2
                 USING :H-TKMXTR00-S-2.H-RIYO-CMP-CD,
                       :H-TKMXTR00-S-2.H-TORI-ID
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":直前取引データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               MOVE  CNS-ON              TO  FLG-TKMXTR00-CR-2-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前取引データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-2-OPEN=["
      D             FLG-TKMXTR00-CR-2-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前取引データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-035
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 直前取引データCURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 直前取引データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
             EXEC SQL
               FETCH TKMXTR00_CUR_2
               INTO  :H-TKMXTR00-2
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":直前取引データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             EVALUATE  SQLCODE
      *----------  正常
               WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前取引データCURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-5.１口注文ＩＤ =["
      D             H-ORDR-1K-ID         OF  H-TKMXTR00-2"]"
      *-----------------------------------------------------------------
      *----------  ワーク直前取引←「別紙1-5 SQL説明」
                 MOVE  H-ORDR-1K-ID      OF  H-TKMXTR00-2
                   TO  WK-ORDR-1K-ID     OF  WK-CHOKZ-TORI
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク直前取引.１口注文ＩＤ =["
      D             WK-ORDR-1K-ID        OF  WK-CHOKZ-TORI"]"
      *-----------------------------------------------------------------
               WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前取引データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
                 COMPUTE  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2
                       =  WARN-INFO-SU   OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
                 MOVE  CNS-WARN-FLG-I4
                   TO  WARN-FLG
                   OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                   OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-036
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-110
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-1      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前取引データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-037
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-1      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
             END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 直前取引データCURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID ":*** 直前取引データを取得 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       CHOKZ-TORI-GET-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データを取得する
      ******************************************************************
       TKMZBW06-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高異動計算データを取得 START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
             INITIALIZE  SQLSTMT9                                       @3212SEINO@
      *----------  利用会社コード
             MOVE  WK-RIYO-CMP-CD        OF  WK-KYJ-YMD-DMN-INFO
               TO  H-RIYO-CMP-CD         OF  H-TKMZBW06-S,
                   H-RIYO-CMP-CD-1       OF  H-TKMZBW06-S,
                   H-RIYO-CMP-CD-2       OF  H-TKMZBW06-S,
                   H-RIYO-CMP-CD-3       OF  H-TKMZBW06-S,
                   H-RIYO-CMP-CD-4       OF  H-TKMZBW06-S,
                   H-RIYO-CMP-CD-5       OF  H-TKMZBW06-S,
                   H-RIYO-CMP-CD-6       OF  H-TKMZBW06-S,
                   WK-RIYO-CMP-CD        OF  WK-MSG-1-2,
                   WK-RIYO-CMP-CD-1      OF  WK-MSG-1-2,
                   WK-RIYO-CMP-CD-2      OF  WK-MSG-1-2,
                   WK-RIYO-CMP-CD-3      OF  WK-MSG-1-2
      *----------  処理実行日
             MOVE  WK-SYORI-YMD          OF  WK-KYJ-YMD-DMN-INFO
               TO  H-SYORI-YMD           OF  H-TKMZBW06-S,
                   H-SYORI-YMD-1         OF  H-TKMZBW06-S,
                   WK-SYORI-YMD          OF  WK-MSG-1-2
      *----------  起動ID
             MOVE  WK-KIDOU-ID           OF  WK-KYJ-YMD-DMN-INFO
               TO  H-KIDOU-ID            OF  H-TKMZBW06-S,
                   H-KIDOU-ID-1          OF  H-TKMZBW06-S,
                   WK-KIDOU-ID           OF  WK-MSG-1-2
      *----------  ファンドコード
             MOVE  WK-FUND-CD            OF  WK-KYJ-YMD-DMN-INFO
               TO  H-FUND-CD             OF  H-TKMZBW06-S,
                   H-FUND-CD-3           OF  H-TKMZBW06-S,
                   H-FUND-CD-5           OF  H-TKMZBW06-S,
                   WK-FUND-CD            OF  WK-MSG-1-2,
                   WK-FUND-CD-1          OF  WK-MSG-1-2
      *----------  ポートフォリオコード
             MOVE  WK-PTF-CD             OF  WK-KYJ-YMD-DMN-INFO
               TO  H-PTF-CD              OF  H-TKMZBW06-S,
                   H-PTF-CD-3            OF  H-TKMZBW06-S,
                   H-PTF-CD-5            OF  H-TKMZBW06-S,
                   WK-PTF-CD             OF  WK-MSG-1-2,
                   WK-PTF-CD-1           OF  WK-MSG-1-2
      *----------  取引連関ＩＤ
             MOVE  WK-THRK-ID            OF  WK-TORI-DATA
               TO  H-THRK-ID-3           OF  H-TKMZBW06-S,
                   H-THRK-ID-5           OF  H-TKMZBW06-S,
                   WK-THRK-ID            OF  WK-MSG-1-2
      *----------  原取引ＩＤ
             MOVE  WK-TARGET-TORI-ID     OF  WK-TORI-DATA
               TO  H-TORI-ID-1           OF  H-TKMZBW06-S,
                   H-TORI-ID-2           OF  H-TKMZBW06-S,
                   H-TORI-ID-4           OF  H-TKMZBW06-S,
                   H-TORI-ID-6           OF  H-TKMZBW06-S,
                   WK-TORI-ID            OF  WK-MSG-1-2,
                   WK-TORI-ID-1          OF  WK-MSG-1-2
      *----------  計上基準日
             MOVE  WK-KAISI-KJN-YMD-NEXT OF  WK-KYJ-YMD-DMN-INFO
               TO  H-KAISI-KJN-YMD-NEXT-3
                                         OF  H-TKMZBW06-S,
                   H-KAISI-KJN-YMD-NEXT-5
                                         OF  H-TKMZBW06-S,
                   WK-KAISI-KJN-YMD-NEXT OF  WK-MSG-1-2
             MOVE  WK-KEIJOU-KIJUNBI     OF  WK-TARGET-TORI-INFO
               TO  H-KEIJOU-KIJUNBI-3    OF  H-TKMZBW06-S,
                   H-KEIJOU-KIJUNBI-5    OF  H-TKMZBW06-S,
                   WK-KEIJOU-KIJUNBI     OF  WK-MSG-1-2
      *----------  約定ベース受渡順フラグ
      *****  IF  WK-YKJ-UKE-JUN-FLG = CNS-FLG-1                         @3212SEINO@
      *****  THEN                                                       @3212SEINO@
               MOVE  CNS-UKE-YMD         TO  SQL-HANTEI
      *****  ELSE                                                       @3212SEINO@
      *****    MOVE  CNS-KEIJOU-KIJUNBI  TO  SQL-HANTEI                 @3212SEINO@
      *****  END-IF                                                     @3212SEINO@
             MOVE  SQL-SELECT-1-2        TO  SQLSTMT9                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日          =["
      D             H-SYORI-YMD          OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID              =["
      D             H-KIDOU-ID           OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":取引連関ＩＤ        =["
      D             H-THRK-ID-3          OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ          =["
      D             H-TORI-ID-1          OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":開始基準日の翌日    =["
      D             H-KAISI-KJN-YMD-NEXT-3
      D                                  OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":計上基準日           =["
      D             H-KEIJOU-KIJUNBI-3   OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":約定ベース受渡順フラグ=["
      D             WK-YKJ-UKE-JUN-FLG"]"
      D    DISPLAY  CNS-PGM-ID ":SQL-HANTEI=["SQL-HANTEI"]"
      D    DISPLAY  CNS-PGM-ID ":H-TKMZBW06-S         =["H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT9=[" SQLSTMT9 "]"               @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR-OPEN=["                 @3212SEINO@
      D                         FLG-TKMZBW06-CR-OPEN"]"                 @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMZBW06-CR-OPEN   NOT =  CNS-ON                   @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  残高異動計算データCURSOR PREPARE
             EXEC  SQL
               PREPARE  S2  FROM  :SQLSTMT9                             @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D       ":残高異動計算データCURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-039
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-2        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZBW06_CUR  CURSOR  FOR  S2
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZBW06_CUR
                 USING :H-TKMZBW06-S
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               MOVE  CNS-ON              TO  FLG-TKMZBW06-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR-OPEN=["
      D             FLG-TKMZBW06-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-040
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-2        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
             EXEC SQL
               FETCH TKMZBW06_CUR
               INTO  :H-TKMZBW06.H-SIJO-TUKA-CD,
                     :H-TKMZBW06.H-IDOG-SRYZN,
                     :H-TKMZBW06.H-SJTK-IDOG-BOKAZN,
                     :H-TKMZBW06.H-UYTK-IDOG-BOKAZN,
                     :H-TKMZBW06.H-SURYO-TANI
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             EVALUATE  SQLCODE
      *----------  正常
               WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-2.市場通貨コード        =["
      D             H-SIJO-TUKA-CD       OF  H-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-2.異動後数量残高        =["
      D             H-IDOG-SRYZN         OF  H-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-2.市場通貨異動後簿価残高=["
      D             H-SJTK-IDOG-BOKAZN   OF  H-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-2.運用通貨異動後簿価残高=["
      D             H-UYTK-IDOG-BOKAZN   OF  H-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-2.数量単位              =["
      D             H-SURYO-TANI         OF  H-TKMZBW06"]"
      *-----------------------------------------------------------------
      *----------  ワーク直前親株残高異動←「別紙1-2 SQL説明」
                 MOVE  H-SIJO-TUKA-CD  OF  H-TKMZBW06
                   TO  WK-SIJO-TUKA-CD OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-IDOG-SRYZN    OF  H-TKMZBW06
                   TO  WK-IDOG-SRYZN   OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-SJTK-IDOG-BOKAZN
                                         OF  H-TKMZBW06
                   TO  WK-SJTK-IDOG-BOKAZN
                                         OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-UYTK-IDOG-BOKAZN
                                         OF  H-TKMZBW06
                   TO  WK-UYTK-IDOG-BOKAZN
                                         OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-SURYO-TANI      OF  H-TKMZBW06
                   TO  WK-SURYO-TANI     OF  WK-CHOKZ-O-ZADAKA-IDOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.市場通貨コード=["
      D             WK-SIJO-TUKA-CD      OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.異動後数量残高=["
      D             WK-IDOG-SRYZN        OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.市場通貨異動後"
      D             "簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.運用通貨異動後"
      D             "簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.数量単位=["
      D             WK-SURYO-TANI        OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      *-----------------------------------------------------------------
               WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  残高履歴を取得する
                 PERFORM  TKMZZR00-GET-RTN
               WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-041
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-2      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
             END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID ":*** 残高異動計算データを取得 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-GET-EXT.
           EXIT.
      ******************************************************************@3212SEINO@
      *    残高異動計算データを取得する2                                @3212SEINO@
      ******************************************************************@3212SEINO@
       TKMZBW06-GET-2-RTN     SECTION.                                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":*** 残高異動計算データを取得2 START ***"@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 残高異動計算データ2CURSOR PREPARE  START ***" @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             INITIALIZE  SQLSTMT12                                      @3212SEINO@
      *----------  利用会社コード                                       @3212SEINO@
             MOVE  WK-RIYO-CMP-CD        OF  WK-KYJ-YMD-DMN-INFO        @3212SEINO@
               TO  H-RIYO-CMP-CD         OF  H-TKMZBW06-S,              @3212SEINO@
                   H-RIYO-CMP-CD-1       OF  H-TKMZBW06-S,              @3212SEINO@
                   H-RIYO-CMP-CD-2       OF  H-TKMZBW06-S,              @3212SEINO@
                   H-RIYO-CMP-CD-3       OF  H-TKMZBW06-S,              @3212SEINO@
                   H-RIYO-CMP-CD-4       OF  H-TKMZBW06-S,              @3212SEINO@
                   H-RIYO-CMP-CD-5       OF  H-TKMZBW06-S,              @3212SEINO@
                   H-RIYO-CMP-CD-6       OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-RIYO-CMP-CD        OF  WK-MSG-1-2,                @3212SEINO@
                   WK-RIYO-CMP-CD-1      OF  WK-MSG-1-2,                @3212SEINO@
                   WK-RIYO-CMP-CD-2      OF  WK-MSG-1-2,                @3212SEINO@
                   WK-RIYO-CMP-CD-3      OF  WK-MSG-1-2                 @3212SEINO@
      *----------  処理実行日                                           @3212SEINO@
             MOVE  WK-SYORI-YMD          OF  WK-KYJ-YMD-DMN-INFO        @3212SEINO@
               TO  H-SYORI-YMD           OF  H-TKMZBW06-S,              @3212SEINO@
                   H-SYORI-YMD-1         OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-SYORI-YMD          OF  WK-MSG-1-2                 @3212SEINO@
      *----------  起動ID                                               @3212SEINO@
             MOVE  WK-KIDOU-ID           OF  WK-KYJ-YMD-DMN-INFO        @3212SEINO@
               TO  H-KIDOU-ID            OF  H-TKMZBW06-S,              @3212SEINO@
                   H-KIDOU-ID-1          OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-KIDOU-ID           OF  WK-MSG-1-2                 @3212SEINO@
      *----------  ファンドコード                                       @3212SEINO@
             MOVE  WK-FUND-CD            OF  WK-KYJ-YMD-DMN-INFO        @3212SEINO@
               TO  H-FUND-CD             OF  H-TKMZBW06-S,              @3212SEINO@
                   H-FUND-CD-3           OF  H-TKMZBW06-S,              @3212SEINO@
                   H-FUND-CD-5           OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-FUND-CD            OF  WK-MSG-1-2,                @3212SEINO@
                   WK-FUND-CD-1          OF  WK-MSG-1-2                 @3212SEINO@
      *----------  ポートフォリオコード                                 @3212SEINO@
             MOVE  WK-PTF-CD             OF  WK-KYJ-YMD-DMN-INFO        @3212SEINO@
               TO  H-PTF-CD              OF  H-TKMZBW06-S,              @3212SEINO@
                   H-PTF-CD-3            OF  H-TKMZBW06-S,              @3212SEINO@
                   H-PTF-CD-5            OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-PTF-CD             OF  WK-MSG-1-2,                @3212SEINO@
                   WK-PTF-CD-1           OF  WK-MSG-1-2                 @3212SEINO@
      *----------  取引連関ＩＤ                                         @3212SEINO@
             MOVE  WK-THRK-ID            OF  WK-TORI-DATA               @3212SEINO@
               TO  H-THRK-ID-3           OF  H-TKMZBW06-S,              @3212SEINO@
                   H-THRK-ID-5           OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-THRK-ID            OF  WK-MSG-1-2                 @3212SEINO@
      *----------  原取引ＩＤ                                           @3212SEINO@
             MOVE  WK-TARGET-TORI-ID     OF  WK-TORI-DATA               @3212SEINO@
               TO  H-TORI-ID-1           OF  H-TKMZBW06-S,              @3212SEINO@
                   H-TORI-ID-2           OF  H-TKMZBW06-S,              @3212SEINO@
                   H-TORI-ID-4           OF  H-TKMZBW06-S,              @3212SEINO@
                   H-TORI-ID-6           OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-TORI-ID            OF  WK-MSG-1-2,                @3212SEINO@
                   WK-TORI-ID-1          OF  WK-MSG-1-2                 @3212SEINO@
      *----------  計上基準日                                           @3212SEINO@
             MOVE  WK-KAISI-KJN-YMD-NEXT OF  WK-KYJ-YMD-DMN-INFO        @3212SEINO@
               TO  H-KAISI-KJN-YMD-NEXT-3                               @3212SEINO@
                                         OF  H-TKMZBW06-S,              @3212SEINO@
                   H-KAISI-KJN-YMD-NEXT-5                               @3212SEINO@
                                         OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-KAISI-KJN-YMD-NEXT OF  WK-MSG-1-2                 @3212SEINO@
             MOVE  WK-KEIJOU-KIJUNBI     OF  WK-TARGET-TORI-INFO        @3212SEINO@
               TO  H-KEIJOU-KIJUNBI-3    OF  H-TKMZBW06-S,              @3212SEINO@
                   H-KEIJOU-KIJUNBI-5    OF  H-TKMZBW06-S,              @3212SEINO@
                   WK-KEIJOU-KIJUNBI     OF  WK-MSG-1-2                 @3212SEINO@
      *----------  約定ベース受渡順フラグ                               @3212SEINO@
             MOVE  CNS-KEIJOU-KIJUNBI    TO  SQL-HANTEI                 @3212SEINO@
             MOVE  SQL-SELECT-1-2        TO  SQLSTMT12                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["                @3212SEINO@
      D             H-RIYO-CMP-CD        OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":処理実行日          =["                @3212SEINO@
      D             H-SYORI-YMD          OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":起動ID              =["                @3212SEINO@
      D             H-KIDOU-ID           OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["                @3212SEINO@
      D             H-FUND-CD            OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["                @3212SEINO@
      D             H-PTF-CD             OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":取引連関ＩＤ        =["                @3212SEINO@
      D             H-THRK-ID-3          OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ          =["                @3212SEINO@
      D             H-TORI-ID-1          OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":開始基準日の翌日    =["                @3212SEINO@
      D             H-KAISI-KJN-YMD-NEXT-3                              @3212SEINO@
      D                                  OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":計上基準日           =["               @3212SEINO@
      D             H-KEIJOU-KIJUNBI-3   OF  H-TKMZBW06-S"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":約定ベース受渡順フラグ=["              @3212SEINO@
      D             WK-YKJ-UKE-JUN-FLG"]"                               @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":SQL-HANTEI=["SQL-HANTEI"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":H-TKMZBW06-S         =["H-TKMZBW06-S"]"@3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT12=[" SQLSTMT12 "]"             @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR2-OPEN=["                @3212SEINO@
      D                         FLG-TKMZBW06-CR2-OPEN"]"                @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMZBW06-CR2-OPEN   NOT =  CNS-ON                  @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  残高異動計算データCURSOR PREPARE                     @3212SEINO@
             EXEC  SQL                                                  @3212SEINO@
               PREPARE  S14  FROM  :SQLSTMT12                           @3212SEINO@
             END-EXEC                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D       ":残高異動計算データCURSOR PREPARE SQLCODE =[" SQLCODE "]"@3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             IF  SQLCODE = CNS-SQL-NORMAL                               @3212SEINO@
             THEN                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ2CUR PREPARE 正常"    @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
               CONTINUE                                                 @3212SEINO@
             ELSE                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ2CUR PREPARE 異常"    @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  エラー検知プログラム名                               @3212SEINO@
               MOVE  CNS-PGM-ID                                         @3212SEINO@
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  ポジション                                           @3212SEINO@
               MOVE  CNS-POS-100                                        @3212SEINO@
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  リターンコード                                       @3212SEINO@
               MOVE  CNS-RTN-900                                        @3212SEINO@
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  詳細リターンコード                                   @3212SEINO@
               MOVE  SQLCODE                                            @3212SEINO@
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  詳細リターンコードデコードフラグ                     @3212SEINO@
               MOVE  CNS-DETAIL-1                                       @3212SEINO@
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *---------- フリーメッセージ                                      @3212SEINO@
               STRING  CNS-SQL-MSG-SELECT,                              @3212SEINO@
                       WK-MSG-1-2        DELIMITED  BY  SIZE            @3212SEINO@
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["         @3212SEINO@
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["        @3212SEINO@
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["         @3212SEINO@
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["         @3212SEINO@
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["         @3212SEINO@
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["         @3212SEINO@
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  エラー処理                                           @3212SEINO@
               PERFORM  ERR-RTN                                         @3212SEINO@
             END-IF                                                     @3212SEINO@
      *----------  DECLARE CURSOR                                       @3212SEINO@
             EXEC  SQL                                                  @3212SEINO@
               DECLARE  TKMZBW06_CUR2  CURSOR  FOR  S14                 @3212SEINO@
             END-EXEC                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"@3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 残高異動計算データ2CURSOR OPEN START ***"     @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  OPEN CURSOR                                          @3212SEINO@
             EXEC  SQL                                                  @3212SEINO@
               OPEN  TKMZBW06_CUR2                                      @3212SEINO@
                 USING :H-TKMZBW06-S                                    @3212SEINO@
             END-EXEC                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":残高異動計算データCUR OPEN SQLCODE=["SQLCODE"]"   @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             IF  SQLCODE  =  CNS-SQL-NORMAL                             @3212SEINO@
             THEN                                                       @3212SEINO@
               MOVE  CNS-ON              TO  FLG-TKMZBW06-CR2-OPEN      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  正常"    @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR2-OPEN=["                @3212SEINO@
      D             FLG-TKMZBW06-CR2-OPEN"]"                            @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             ELSE                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  異常"    @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  エラー検知プログラム名                               @3212SEINO@
               MOVE  CNS-PGM-ID                                         @3212SEINO@
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  ポジション                                           @3212SEINO@
               MOVE  CNS-POS-101                                        @3212SEINO@
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  リターンコード                                       @3212SEINO@
               MOVE  CNS-RTN-900                                        @3212SEINO@
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  詳細リターンコード                                   @3212SEINO@
               MOVE  SQLCODE                                            @3212SEINO@
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  詳細リターンコードデコードフラグ                     @3212SEINO@
               MOVE  CNS-DETAIL-1                                       @3212SEINO@
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *---------- フリーメッセージ                                      @3212SEINO@
               STRING  CNS-SQL-MSG-SELECT,                              @3212SEINO@
                       WK-MSG-1-2        DELIMITED  BY  SIZE            @3212SEINO@
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["         @3212SEINO@
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["         @3212SEINO@
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["         @3212SEINO@
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["         @3212SEINO@
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["         @3212SEINO@
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["         @3212SEINO@
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  エラー処理                                           @3212SEINO@
               PERFORM  ERR-RTN                                         @3212SEINO@
             END-IF                                                     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 残高異動計算データCURSOR OPEN END ***"        @3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 残高異動計算データCURSOR FETCH START ***"     @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  CURSOR FETCH                                         @3212SEINO@
             EXEC SQL                                                   @3212SEINO@
               FETCH TKMZBW06_CUR2                                      @3212SEINO@
               INTO  :H-TKMZBW06.H-SIJO-TUKA-CD,                        @3212SEINO@
                     :H-TKMZBW06.H-IDOG-SRYZN,                          @3212SEINO@
                     :H-TKMZBW06.H-SJTK-IDOG-BOKAZN,                    @3212SEINO@
                     :H-TKMZBW06.H-UYTK-IDOG-BOKAZN,                    @3212SEINO@
                     :H-TKMZBW06.H-SURYO-TANI                           @3212SEINO@
             END-EXEC                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":残高異動計算データCUR FETCH SQLCODE=["SQLCODE"]"  @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             EVALUATE  SQLCODE                                          @3212SEINO@
      *----------  正常                                                 @3212SEINO@
               WHEN  CNS-SQL-NORMAL                                     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  正常"   @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":別紙1-2.市場通貨コード        =["       @3212SEINO@
      D             H-SIJO-TUKA-CD       OF  H-TKMZBW06"]"              @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":別紙1-2.異動後数量残高        =["       @3212SEINO@
      D             H-IDOG-SRYZN         OF  H-TKMZBW06"]"              @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":別紙1-2.市場通貨異動後簿価残高=["       @3212SEINO@
      D             H-SJTK-IDOG-BOKAZN   OF  H-TKMZBW06"]"              @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":別紙1-2.運用通貨異動後簿価残高=["       @3212SEINO@
      D             H-UYTK-IDOG-BOKAZN   OF  H-TKMZBW06"]"              @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":別紙1-2.数量単位              =["       @3212SEINO@
      D             H-SURYO-TANI         OF  H-TKMZBW06"]"              @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  ワーク直前親株残高異動←「別紙1-2 SQL説明」          @3212SEINO@
                 MOVE  H-SIJO-TUKA-CD  OF  H-TKMZBW06                   @3212SEINO@
                   TO  WK-SIJO-TUKA-CD OF  WK-CHOKZ-O-ZADAKA-IDOU       @3212SEINO@
                 MOVE  H-IDOG-SRYZN    OF  H-TKMZBW06                   @3212SEINO@
                   TO  WK-IDOG-SRYZN   OF  WK-CHOKZ-O-ZADAKA-IDOU       @3212SEINO@
                 MOVE  H-SJTK-IDOG-BOKAZN                               @3212SEINO@
                                         OF  H-TKMZBW06                 @3212SEINO@
                   TO  WK-SJTK-IDOG-BOKAZN                              @3212SEINO@
                                         OF  WK-CHOKZ-O-ZADAKA-IDOU     @3212SEINO@
                 MOVE  H-UYTK-IDOG-BOKAZN                               @3212SEINO@
                                         OF  H-TKMZBW06                 @3212SEINO@
                   TO  WK-UYTK-IDOG-BOKAZN                              @3212SEINO@
                                         OF  WK-CHOKZ-O-ZADAKA-IDOU     @3212SEINO@
                 MOVE  H-SURYO-TANI      OF  H-TKMZBW06                 @3212SEINO@
                   TO  WK-SURYO-TANI     OF  WK-CHOKZ-O-ZADAKA-IDOU     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.市場通貨コード=["@3212SEINO@
      D             WK-SIJO-TUKA-CD      OF  WK-CHOKZ-O-ZADAKA-IDOU"]"  @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.異動後数量残高=["@3212SEINO@
      D             WK-IDOG-SRYZN        OF  WK-CHOKZ-O-ZADAKA-IDOU"]"  @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.市場通貨異動後"  @3212SEINO@
      D             "簿価残高=["                                        @3212SEINO@
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-CHOKZ-O-ZADAKA-IDOU"]"  @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.運用通貨異動後"  @3212SEINO@
      D             "簿価残高=["                                        @3212SEINO@
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-CHOKZ-O-ZADAKA-IDOU"]"  @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.数量単位=["      @3212SEINO@
      D             WK-SURYO-TANI        OF  WK-CHOKZ-O-ZADAKA-IDOU"]"  @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
               WHEN  CNS-SQL-NOTFOUND                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH NOTFOUND"@3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  残高履歴を取得する                                   @3212SEINO@
                 PERFORM  TKMZZR00-GET-RTN                              @3212SEINO@
               WHEN  OTHER                                              @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  異常"   @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  エラー検知プログラム名                               @3212SEINO@
                 MOVE  CNS-PGM-ID                                       @3212SEINO@
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  ポジション                                           @3212SEINO@
                 MOVE  CNS-POS-102                                      @3212SEINO@
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  リターンコード                                       @3212SEINO@
                 MOVE  CNS-RTN-900                                      @3212SEINO@
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  詳細リターンコード                                   @3212SEINO@
                 MOVE  SQLCODE                                          @3212SEINO@
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *----------  詳細リターンコードデコードフラグ                     @3212SEINO@
                 MOVE  CNS-DETAIL-1                                     @3212SEINO@
                   TO  DETAIL-RTN-CD-FLG                                @3212SEINO@
                   OF  PARM-SCZY1170-ARG1                               @3212SEINO@
      *---------- フリーメッセージ                                      @3212SEINO@
                 STRING  CNS-SQL-MSG-SELECT,                            @3212SEINO@
                         WK-MSG-1-2      DELIMITED  BY  SIZE            @3212SEINO@
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["         @3212SEINO@
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["         @3212SEINO@
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["         @3212SEINO@
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["         @3212SEINO@
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["         @3212SEINO@
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["         @3212SEINO@
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  エラー処理                                           @3212SEINO@
                 PERFORM  ERR-RTN                                       @3212SEINO@
             END-EVALUATE                                               @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 残高異動計算データCURSOR FETCH END ***"       @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":*** 残高異動計算データを取得 END ***"  @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           CONTINUE.                                                    @3212SEINO@
       TKMZBW06-GET-2-EXT.                                              @3212SEINO@
           EXIT.                                                        @3212SEINO@
      ******************************************************************
      *    残高履歴を取得する
      ******************************************************************
       TKMZZR00-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴を取得 START ***"
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
             INITIALIZE  SQLSTMT10                                      @3212SEINO@
      *----------  利用会社コード
             MOVE  WK-RIYO-CMP-CD        OF  WK-KYJ-YMD-DMN-INFO
               TO  H-RIYO-CMP-CD         OF  H-TKMZZR00-S,
                   H-RIYO-CMP-CD-1       OF  H-TKMZZR00-S,
                   WK-RIYO-CMP-CD        OF  WK-MSG-1-3,
                   WK-RIYO-CMP-CD-1      OF  WK-MSG-1-3
      *----------  ファンドコード
             MOVE  WK-FUND-CD            OF  WK-KYJ-YMD-DMN-INFO
               TO  H-FUND-CD             OF  H-TKMZZR00-S,
                   WK-FUND-CD            OF  WK-MSG-1-3
      *----------  ポートフォリオコード
             MOVE  WK-PTF-CD             OF  WK-KYJ-YMD-DMN-INFO
               TO  H-PTF-CD              OF  H-TKMZZR00-S,
                   WK-PTF-CD             OF  WK-MSG-1-3
      *----------  原取引ＩＤ
             MOVE  WK-TARGET-TORI-ID     OF  WK-TORI-DATA
               TO  H-TORI-ID             OF  H-TKMZZR00-S,
                   WK-TORI-ID            OF  WK-MSG-1-3
      *----------  基準日
             MOVE  WK-KAISI-KJN-YMD      OF  WK-KYJ-YMD-DMN-INFO
               TO  H-KJN-YMD             OF  H-TKMZZR00-S,
                   WK-KJN-YMD            OF  WK-MSG-1-3
             MOVE  SQL-SELECT-1-3        TO  SQLSTMT10                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード            =["
      D             H-RIYO-CMP-CD        OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード            =["
      D             H-FUND-CD            OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード      =["
      D             H-PTF-CD             OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ          =["
      D             H-TORI-ID            OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日                =["
      D             H-KJN-YMD            OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT10=[" SQLSTMT10 "]"             @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZR00-CR-OPEN=["                 @3212SEINO@
      D                         FLG-TKMZZR00-CR-OPEN"]"                 @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMZZR00-CR-OPEN   NOT =  CNS-ON                   @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  残高異動CURSOR PREPARE
             EXEC  SQL
               PREPARE  S3  FROM  :SQLSTMT10                            @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-043
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-3        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZZR00_CUR  CURSOR  FOR  S3
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZZR00_CUR
                 USING :H-TKMZZR00-S
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               MOVE  CNS-ON              TO  FLG-TKMZZR00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZR00-CR-OPEN=["
      D             FLG-TKMZZR00-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-044
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-3        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
             EXEC SQL
               FETCH TKMZZR00_CUR
               INTO  :H-TKMZZR00.H-SRYZN,
                     :H-TKMZZR00.H-SJTK-BOKAZN,
                     :H-TKMZZR00.H-UYTK-BOKAZN,
                     :H-TKMZZR00.H-SIJO-TUKA-CD,
                     :H-TKMZZR00.H-SURYO-TANI
             END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             EVALUATE  SQLCODE
      *----------  正常
               WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-3.数量残高        =["
      D             H-SRYZN              OF  H-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-3.市場通貨簿価残高=["
      D             H-SJTK-BOKAZN   OF  H-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-3.運用通貨簿価残高=["
      D             H-UYTK-BOKAZN   OF  H-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-3.市場通貨コード  =["
      D             H-SIJO-TUKA-CD       OF  H-TKMZZR00"]"
      *-----------------------------------------------------------------
      *----------  ワーク直前親株残高異動←「別紙1-3 SQL説明」
                 MOVE  H-SIJO-TUKA-CD   OF  H-TKMZZR00
                   TO  WK-SIJO-TUKA-CD  OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-SRYZN          OF  H-TKMZZR00
                   TO  WK-IDOG-SRYZN    OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-SJTK-BOKAZN    OF  H-TKMZZR00
                   TO  WK-SJTK-IDOG-BOKAZN
                                        OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-UYTK-BOKAZN    OF  H-TKMZZR00
                   TO  WK-UYTK-IDOG-BOKAZN
                                        OF  WK-CHOKZ-O-ZADAKA-IDOU
                 MOVE  H-SURYO-TANI     OF  H-TKMZZR00
                   TO  WK-SURYO-TANI    OF  WK-CHOKZ-O-ZADAKA-IDOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.市場通貨コード=["
      D             WK-SIJO-TUKA-CD      OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.異動後数量残高=["
      D             WK-IDOG-SRYZN        OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.市場通貨異動後"
      D             "簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.運用通貨異動後"
      D             "簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前親株残高異動.数量単位=["
      D             WK-SURYO-TANI        OF  WK-CHOKZ-O-ZADAKA-IDOU"]"
      *-----------------------------------------------------------------
               WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
                 CONTINUE
               WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID        OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-045
                   TO  ERR-POS           OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD            OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD     OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG
                   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-3      DELIMITED  BY  SIZE
                   INTO  FREE-MSG        OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
             END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID ":*** 残高履歴を取得 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZZR00-GET-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データを取得する(別紙1-10)
      ******************************************************************
       TKMZBW06-GET2-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データを取得(別紙1-10) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT11                                        @3212SEINO@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-KYJ-YMD-DMN-INFO
             TO  H-RIYO-CMP-CD           OF  H-TKMZBW06-2-S,
                 WK-RIYO-CMP-CD          OF  WK-MSG-1-10
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-KYJ-YMD-DMN-INFO
             TO  H-SYORI-YMD             OF  H-TKMZBW06-2-S,
                 WK-SYORI-YMD            OF  WK-MSG-1-10
      *----------  起動ID
           MOVE  WK-KIDOU-ID             OF  WK-KYJ-YMD-DMN-INFO
             TO  H-KIDOU-ID              OF  H-TKMZBW06-2-S,
                 WK-KIDOU-ID             OF  WK-MSG-1-10
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-KYJ-YMD-DMN-INFO
             TO  H-FUND-CD               OF  H-TKMZBW06-2-S,
                 WK-FUND-CD              OF  WK-MSG-1-10
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-KYJ-YMD-DMN-INFO
             TO  H-PTF-CD                OF  H-TKMZBW06-2-S,
                 WK-PTF-CD               OF  WK-MSG-1-10
      *----------  原取引ＩＤ
           MOVE  WK-THRK-ID              OF  WK-TORI-DATA
             TO  H-TORI-ID               OF  H-TKMZBW06-2-S,
                 WK-TORI-ID              OF  WK-MSG-1-10
           MOVE  SQL-SELECT-1-10         TO  SQLSTMT11                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW06-2-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日          =["
      D             H-SYORI-YMD          OF  H-TKMZBW06-2-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID              =["
      D             H-KIDOU-ID           OF  H-TKMZBW06-2-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZBW06-2-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW06-2-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ          =["
      D             H-TORI-ID            OF  H-TKMZBW06-2-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT11=[" SQLSTMT11 "]"             @3212SEINO@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR-2-OPEN=["               @3212SEINO@
      D                         FLG-TKMZBW06-CR-2-OPEN"]"               @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMZBW06-CR-2-OPEN   NOT =  CNS-ON                 @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  残高異動計算データCURSOR PREPARE
             EXEC  SQL
               PREPARE  S10  FROM  :SQLSTMT11                           @3212SEINO@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D       ":残高異動計算データCURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-047
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-10        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZBW06_CUR_2  CURSOR  FOR  S10
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZBW06_CUR_2
               USING :H-TKMZBW06-2-S
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON              TO  FLG-TKMZBW06-CR-2-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR-2-OPEN=["
      D             FLG-TKMZBW06-CR-2-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-048
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-10          DELIMITED  BY  SIZE
               INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZBW06_CUR_2
             INTO  :H-TKMZBW06-2
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-10.市場通貨異動簿価=["
      D             H-SJTK-IDO-BOKA      OF  H-TKMZBW06-2"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-10.運用通貨異動簿価=["
      D             H-UYTK-IDO-BOKA      OF  H-TKMZBW06-2"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-10.市場通貨前払金異動額=["
      D             H-SJTK-PPAYIDOG      OF  H-TKMZBW06-2"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-10.運用通貨前払金異動額=["
      D             H-UYTK-PPAYIDOG      OF  H-TKMZBW06-2"]"
      *-----------------------------------------------------------------
      *----------  ワーク運用通貨予備売買金額
               COMPUTE  WK-UYTK-YOBI-BS-KN
                     =  H-UYTK-IDO-BOKA  OF  H-TKMZBW06-2 +
                        H-UYTK-PPAYIDOG  OF  H-TKMZBW06-2
      *----------  ワーク市場通貨予備売買金額
               COMPUTE  WK-SJTK-YOBI-BS-KN
                     =  H-SJTK-IDO-BOKA  OF  H-TKMZBW06-2 +
                        H-SJTK-PPAYIDOG  OF  H-TKMZBW06-2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨予備売買金額=["
      D             WK-UYTK-YOBI-BS-KN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨予備売買金額=["
      D             WK-SJTK-YOBI-BS-KN"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-049
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-160
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG
                 OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-10       DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-050
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG
                 OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-10       DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データを取得(別紙1-10) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-GET2-EXT.
           EXIT.
      ******************************************************************
      *    対象取引情報を取得する(別紙1-9)
      ******************************************************************
       TKMZBW04-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 対象取引情報を取得(別紙1-9) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 対象取引情報CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-MEG-BETU-DMN-INFO
             TO  H-SYORI-YMD             OF  H-TKMZBW04-S,
                 WK-SYORI-YMD            OF  WK-MSG-1-9
      *----------  起動ID
           MOVE  WK-KIDOU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  H-KIDOU-ID              OF  H-TKMZBW04-S,
                 WK-KIDOU-ID             OF  WK-MSG-1-9
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  H-RIYO-CMP-CD           OF  H-TKMZBW04-S,
                 WK-RIYO-CMP-CD          OF  WK-MSG-1-9
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             TO  H-FUND-CD               OF  H-TKMZBW04-S,
                 WK-FUND-CD              OF  WK-MSG-1-9
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  H-PTF-CD                OF  H-TKMZBW04-S,
                 WK-PTF-CD               OF  WK-MSG-1-9
      *----------  基準日
           MOVE  WK-KJN-YMD              OF  WK-MEG-BETU-DMN-INFO
             TO  H-KJN-YMD               OF  H-TKMZBW04-S,
                 WK-KJN-YMD              OF  WK-MSG-1-9
      *----------  銘柄コード
           MOVE  WK-MEG-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  H-MEG-CD                OF  H-TKMZBW04-S,
                 WK-MEG-CD               OF  WK-MSG-1-9
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  H-SEC-SBT-CD            OF  H-TKMZBW04-S,
                 WK-SEC-SBT-CD           OF  WK-MSG-1-9
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  H-TATE-FLG              OF  H-TKMZBW04-S,
                 WK-TATE-FLG             OF  WK-MSG-1-9
      *----------  玉ＩＤ
           MOVE  WK-GYOKU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  H-GYOKU-ID              OF  H-TKMZBW04-S
                 WK-GYOKU-ID             OF  WK-MSG-1-9
      *----------  原取引ＩＤ
           MOVE  WK-TORI-ID              OF  WK-TARGET-TORI-INFO
             TO  H-TORI-ID               OF  H-TKMZBW04-S,
                 WK-TORI-ID              OF  WK-MSG-1-9
      *----------  増幅赤黒区分
           MOVE  WK-ZOFKU-AKA-KBN        OF  WK-TARGET-TORI-INFO
             TO  H-ZOFKU-AKA-KBN         OF  H-TKMZBW04-S,
                 WK-ZOFKU-AKA-KBN        OF  WK-MSG-1-9
           MOVE  SQL-SELECT-1-9          TO  SQLSTMT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":処理実行日          =["
      D             H-SYORI-YMD          OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID              =["
      D             H-KIDOU-ID           OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日              =["
      D             H-KJN-YMD            OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード          =["
      D             H-MEG-CD             OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード      =["
      D             H-SEC-SBT-CD         OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産負債・買建売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ＩＤ              =["
      D             H-GYOKU-ID           OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ＩＤ          =["
      D             H-TORI-ID            OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":増幅赤黒区分        =["
      D             H-ZOFKU-AKA-KBN      OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT=[" SQLSTMT "]"
      *-----------------------------------------------------------------
      *-----------------------------------------------------------------@3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW04-CR-OPEN=["                 @3212SEINO@
      D                                        FLG-TKMZBW04-CR-OPEN"]"  @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF    FLG-TKMZBW04-CR-OPEN   NOT =  CNS-ON                   @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  対象取引情報CURSOR PREPARE
             EXEC  SQL
               PREPARE  S9  FROM  :SQLSTMT
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D       ":対象取引情報CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象取引情報CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象取引情報CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-052
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-9        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                      =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象取引情報CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZBW04_CUR  CURSOR  FOR  S9
             END-EXEC
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  PREPARE,DECLAREスキップ  ***"      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ END      @3212SEINO@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":対象取引情報CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZBW04_CUR
               USING :H-TKMZBW04-S
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":対象取引情報CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON              TO  FLG-TKMZBW04-CR-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象取引情報CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW04-CR-OPEN=["
      D             FLG-TKMZBW04-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象取引情報CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-053
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-9          DELIMITED  BY  SIZE
               INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象取引情報CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID":*** 対象取引情報CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZBW04_CUR
             INTO  :H-TKMZBW04
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE          TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":対象取引情報CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
      *----------  正常
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象取引情報CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-9.市場通貨払出簿価=["
      D             H-SJTK-H-BOKA        OF  H-TKMZBW04"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-9.運用通貨払出簿価=["
      D             H-UYTK-H-BOKA        OF  H-TKMZBW04"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-9.市場通貨払出単価=["
      D             H-SJTK-H-TNK         OF  H-TKMZBW04"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-9.運用通貨払出単価=["
      D             H-UYTK-H-TNK         OF  H-TKMZBW04"]"
      *-----------------------------------------------------------------
      *----------  SMZC1403.ARG2.市場通貨払出簿価
             MOVE  H-SJTK-H-BOKA         OF  H-TKMZBW04
               TO  SJTK-DEBET-BOKA       OF  PARM-SMZC1403-ARG2
      *----------  SMZC1403.ARG2.運用通貨払出簿価
             MOVE  H-UYTK-H-BOKA         OF  H-TKMZBW04
               TO  UYTK-DEBET-BOKA       OF  PARM-SMZC1403-ARG2
      *----------  SMZC1403.ARG2.市場通貨払出単価
             MOVE  H-SJTK-H-TNK          OF  H-TKMZBW04
               TO  SJTK-DEBET-TNK        OF  PARM-SMZC1403-ARG2
      *----------  SMZC1403.ARG2.運用通貨払出単価
             MOVE  H-UYTK-H-TNK          OF  H-TKMZBW04
               TO  UYTK-DEBET-TNK        OF  PARM-SMZC1403-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1403.ARG2.市場通貨払出簿価=["
      D             SJTK-DEBET-BOKA      OF  PARM-SMZC1403-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":SMZC1403.ARG2.運用通貨払出簿価=["
      D             UYTK-DEBET-BOKA      OF  PARM-SMZC1403-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":SMZC1403.ARG2.市場通貨払出単価=["
      D             SJTK-DEBET-TNK       OF  PARM-SMZC1403-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":SMZC1403.ARG2.運用通貨払出単価=["
      D             UYTK-DEBET-TNK       OF  PARM-SMZC1403-ARG2"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象取引情報CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-054
               TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG
               OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-9       DELIMITED  BY  SIZE
               INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象取引情報CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 対象取引情報を取得(別紙1-9) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW04-GET-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1950数量計算をコールする
      ******************************************************************
       SMZC1950-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** SMZC1950数量計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1950】数量計算コールに接続用パラメータの設定を行なう
      *----------  数量計算方法
           MOVE  WK-SURYO-CALC-HOU       OF  WK-CALC-PTN
             TO  SRY-CALC-HOU            OF  PARM-SMZC1950-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":数量計算方法=["
      D             SRY-CALC-HOU         OF  PARM-SMZC1950-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *---------- 異動数量
             MOVE  WK-IDO-SURYO          OF  WK-TORI-DATA
               TO  IDO-SURYO             OF  PARM-SMZC1950-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動数量=["
      D             IDO-SURYO            OF  PARM-SMZC1950-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *---------- 異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-TZ-ZN-IDO
               TO  IDOG-SRYZN            OF  PARM-SMZC1950-ARG1
      *---------- 異動後数量残高(利付)
             MOVE  WK-IDOG-SRYZN-RIT     OF  WK-TZ-ZN-IDO
               TO  IDOG-SRYZN-RITUKI     OF  PARM-SMZC1950-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動後数量残高      =["
      D             IDOG-SRYZN           OF  PARM-SMZC1950-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高(利付)=["
      D             IDOG-SRYZN-RITUKI    OF  PARM-SMZC1950-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *---------- ②【SMZC1950】数量計算コールをコールして、リターンパッケージを取得する
           CALL  "SMZC1950"              USING  PARM-SMZC1950-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1950)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク数量計算結果を初期化
             INITIALIZE  WK-SURYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク数量計算結果=["
      D             WK-SURYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.異動数量.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  IDO-SURYO  OF  PARM-SMZC1950-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動数量.編集フラグ"
      D             "=["EDIT-FLG OF IDO-SURYO OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク数量計算結果.異動数量←リターンパッケージ.異動数量.バリュー
               MOVE  OUT-VALUES          OF  IDO-SURYO
                 OF  PARM-SMZC1950-ARG2
                 TO  WK-IDO-SURYO        OF  WK-SURYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク数量計算結果.異動数量=["
      D             WK-IDO-SURYO         OF  WK-SURYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動数量.編集フラグ"
      D             "=["EDIT-FLG OF IDO-SURYO OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.異動数量(利付).編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  IDO-SURYO-RITUKI  OF  PARM-SMZC1950-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動数量(利付).編集"
      D             "フラグ=["EDIT-FLG   OF  IDO-SURYO-RITUKI
      D              OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク数量計算結果.異動数量(利付)←リターンパッケージ.異動数量(利付).バリュー
               MOVE  OUT-VALUES          OF  IDO-SURYO-RITUKI
                 OF  PARM-SMZC1950-ARG2
                 TO  WK-IDO-SURYO-RIT    OF  WK-SURYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク数量計算結果.異動数量(利付)=["
      D             WK-IDO-SURYO-RIT     OF  WK-SURYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動数量(利付).編集"
      D             "フラグ=["EDIT-FLG   OF  IDO-SURYO-RITUKI
      D              OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.異動後数量残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  IDOG-SRYZN  OF  PARM-SMZC1950-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動後数量残高.編集"
      D             "フラグ=["EDIT-FLG   OF  IDOG-SRYZN
      D              OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク数量計算結果.異動後数量残高←リターンパッケージ.異動後数量残高.バリュー
               MOVE  OUT-VALUES          OF  IDOG-SRYZN
                 OF  PARM-SMZC1950-ARG2
                 TO  WK-IDOG-SRYZN       OF  WK-SURYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク数量計算結果.異動後数量残高=["
      D             WK-IDOG-SRYZN        OF  WK-SURYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動後数量残高.編集"
      D             "フラグ=["EDIT-FLG   OF  IDOG-SRYZN
      D              OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク数量計算結果.異動後数量残高←ARG1.直前残高異動.異動後数量残高
               MOVE  WK-IDOG-SRYZN       OF  WK-TZ-ZN-IDO
                 TO  WK-IDOG-SRYZN       OF  WK-SURYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク数量計算結果.異動後数量残高=["
      D             WK-IDOG-SRYZN        OF  WK-SURYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.異動後数量残高(利付).編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  IDOG-SRYZN-RITUKI  OF  PARM-SMZC1950-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動後数量残高(利付)"
      D             ".編集フラグ=["EDIT-FLG   OF  IDOG-SRYZN-RITUKI
      D              OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク数量計算結果.異動後数量残高(利付)←リターンパッケージ.異動後数量残高(利付).バリュー
               MOVE  OUT-VALUES          OF  IDOG-SRYZN-RITUKI
                 OF  PARM-SMZC1950-ARG2
                 TO  WK-IDOG-SRYZN-RIT   OF  WK-SURYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク数量計算結果.異動後数量残高"
      D          "(利付)=["WK-IDOG-SRYZN-RIT  OF  WK-SURYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.異動後数量残高(利付)"
      D             ".編集フラグ=["EDIT-FLG   OF  IDOG-SRYZN-RITUKI
      D              OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク数量計算結果.異動後数量残高(利付)←ARG1.直前残高異動.異動後数量残高(利付)
               MOVE  WK-IDOG-SRYZN-RIT   OF  WK-TZ-ZN-IDO
                 TO  WK-IDOG-SRYZN-RIT   OF  WK-SURYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク数量計算結果.異動後数量残高"
      D           "(利付)=["WK-IDOG-SRYZN-RIT OF  WK-SURYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1950-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1950-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1950-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-056
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1950数量計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** SMZC1950数量計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1950-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算３
      ******************************************************************
       SMZC1400-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算３ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算３【SMZC1400】に接続用パラメータの設定を行なう
      *----------  取引データ.運用国手数料（運用通貨換算額）
           MOVE  WK-U-KSG-U-TSR          OF  WK-TORI-DATA
             TO  U-KSG-U-TSR             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.運用国消費税（運用通貨換算額）
           MOVE  WK-U-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-U-SHZ             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.運用国その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-U-THY          OF  WK-TORI-DATA
             TO  U-KSG-U-THY             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.現地手数料（運用通貨換算額）
           MOVE  WK-U-KSG-G-TSR          OF  WK-TORI-DATA
             TO  U-KSG-G-TSR             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.現地その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-G-THY          OF  WK-TORI-DATA
             TO  U-KSG-G-THY             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.現地手数料（市場通貨換算額）
           MOVE  WK-S-KSG-G-TSR          OF  WK-TORI-DATA
             TO  S-KSG-G-TSR             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.現地消費税（市場通貨換算額）
           MOVE  WK-S-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-G-SHZ             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.現地その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-G-THY          OF  WK-TORI-DATA
             TO  S-KSG-G-THY             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.運用国手数料（市場通貨換算額）
           MOVE  WK-S-KSG-U-TSR          OF  WK-TORI-DATA
             TO  S-KSG-U-TSR             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.運用国消費税（市場通貨換算額）
           MOVE  WK-S-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-U-SHZ             OF  PARM-SMZC1400-ARG1
      *----------  取引データ.運用国その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-U-THY          OF  WK-TORI-DATA
             TO  S-KSG-U-THY             OF  PARM-SMZC1400-ARG1
      *----------  手数料用売買損益に含むフラグ
           MOVE  WK-TESRY-BBSNEKI-FLG    OF  WK-SWK-KJN
             TO  TESRY-BBSNEKI-FLG       OF  PARM-SMZC1400-ARG1
      *----------  消費税用売買損益に含むフラグ
           MOVE  WK-SHOHI-TAX-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1400-ARG1
      *----------  その他費用用売買損益に含むフラグ
           MOVE  WK-ELS-HIYO-BBSNEKI-FLG OF  WK-SWK-KJN
             TO  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1400-ARG1
      *----------  手数料を市場取得金額に含むフラグ
           MOVE  WK-TESRY-SJST-KN-FLG    OF  WK-SWK-KJN
             TO  TESRY-SJST-KN-FLG       OF  PARM-SMZC1400-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  WK-SHOHI-TAX-SJST-KN-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1400-ARG1
      *----------  その他費用を市場取得金額に含むフラグ
           MOVE  WK-ELS-HIYO-SJST-KN-FLG OF  WK-SWK-KJN
             TO  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1400-ARG1
      *----------  運用通貨コード
           MOVE  WK-UYTK-CD              OF  WK-KYJ-YMD-DMN-INFO
             TO  CAPITAL-TUKA-CD         OF  PARM-SMZC1400-ARG1
      *----------  市場通貨コード
           MOVE  WK-SIJO-TUKA-CD         OF  WK-DATA-IN
             TO  SIJO-TUKA-CD            OF  PARM-SMZC1400-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国手数料（運用通貨換算額"
      D             "）=["U-KSG-U-TSR    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国消費税（運用通貨換算額"
      D             "）=["U-KSG-U-SHZ    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国その他費用（運用通貨換"
      D             "算額）=["U-KSG-U-THY   OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地手数料（運用通貨換算額"
      D             "）=["U-KSG-G-TSR    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地消費税（運用通貨換算額"
      D             "）=["U-KSG-G-SHZ    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地その他費用（運用通貨換"
      D             "算額）=["U-KSG-G-THY   OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地手数料（市場通貨換算額）"
      D             "=["S-KSG-G-TSR      OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地消費税（市場通貨換算額）"
      D             "=["S-KSG-G-SHZ      OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地その他費用（市場通貨換算"
      D             "額）=["S-KSG-G-THY  OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国手数料（市場通貨換算額"
      D             "）=["S-KSG-U-TSR    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国消費税（市場通貨換算額"
      D             "）=["S-KSG-U-SHZ    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国その他費用（市場通貨換"
      D             "算額）=["S-KSG-U-THY   OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ        =["
      D             TESRY-BBSNEKI-FLG       OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ    =["
      D             ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含むフラグ    =["
      D             TESRY-SJST-KN-FLG       OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含むフラグ=["
      D             ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨コード                      =["
      D             CAPITAL-TUKA-CD         OF  PARM-SMZC1400-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード                      =["
      D             SIJO-TUKA-CD            OF  PARM-SMZC1400-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)【SMZC1400】数量計算コールをコールして、リターンパッケージを取得する
           CALL  "SMZC1400"              USING  PARM-SMZC1400-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1400)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-057
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算３  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算３ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1400-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算５
      ******************************************************************
       SMZC1402-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算５ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算５【SMZC1402】に接続用パラメータの設定を行なう
      *----------  異動計算パターン.払出簿価計算方法
           MOVE  WK-DEBET-BOKA-CALC-HOU  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-CALC-HOU     OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.払出簿価端数（市場通貨）
           MOVE  WK-DEBET-BOKA-HASU-BC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-BC      OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.払出単価桁数（市場通貨）
           MOVE  WK-DEBET-TNK-KETASU-BC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-BC     OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.払出単価端数（市場通貨）
           MOVE  WK-DEBET-TNK-HASU-BC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-BC       OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.払出簿価端数（運用通貨）
           MOVE  WK-DEBET-BOKA-HASU-LC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-LC      OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.払出単価桁数（運用通貨）
           MOVE  WK-DEBET-TNK-KETASU-LC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-LC     OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.払出単価端数（運用通貨）
           MOVE  WK-DEBET-TNK-HASU-LC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-LC       OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.簿価為替レート適用フラグ
           MOVE  WK-BOKA-KWS-TEKIYO-FLG  OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-TEKIYO-FLG     OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.簿価為替レート端数
           MOVE  WK-BOKA-KWS-HASU        OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-HASU           OF  PARM-SMZC1402-ARG1
      *----------  異動計算パターン.簿価為替レート桁数
           MOVE  WK-BOKA-KWS-KETASU      OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-KETASU         OF  PARM-SMZC1402-ARG1
      *----------  直前の残高異動.市場通貨異動後簿価残高
           MOVE  WK-SJTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-BOKAZN        OF  PARM-SMZC1402-ARG1
      *----------  直前の残高異動.運用通貨異動後簿価残高
           MOVE  WK-UYTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-BOKAZN        OF  PARM-SMZC1402-ARG1
      *----------  直前の残高異動.異動後数量残高
           MOVE  WK-IDOG-SRYZN           OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN              OF  PARM-SMZC1402-ARG1
      *----------  直前の残高異動.数量単位
           MOVE  WK-SURYO-TANI           OF  WK-TZ-ZN-IDO
             TO  SURYO-TANI              OF  PARM-SMZC1402-ARG1
      *----------  通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
             OF  PARM-SMZC1402-ARG1
      *----------  異動数量
           MOVE  WK-IDO-SURYO            OF  WK-SURYO-CALC-KEKKA
             TO  IDO-SURYO               OF  PARM-SMZC1402-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価計算方法    =["
      D             DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（市場通貨"
      D             "）=["DEBET-BOKA-HASU-BC  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（市場通貨"
      D             "）=["DEBET-TNK-KETASU-BC  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（市場通貨"
      D             "）=["DEBET-TNK-HASU-BC  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（運用通貨"
      D             "）=["DEBET-BOKA-HASU-LC  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（運用通貨"
      D             "）=["DEBET-TNK-KETASU-LC  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（運用通貨"
      D             "）=["DEBET-TNK-HASU-LC  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート適用フラ"
      D             "グ=["BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート端数  =["
      D             BOKA-KWS-HASU        OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート桁数  =["
      D             BOKA-KWS-KETASU      OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後簿価残高=["
      D             SJTK-IDOG-BOKAZN     OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後簿価残高=["
      D             UYTK-IDOG-BOKAZN     OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.異動後数量残高        =["
      D             IDOG-SRYZN           OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.数量単位        =["
      D             SURYO-TANI           OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理             =["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1402-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動数量                             =["
      D             IDO-SURYO            OF  PARM-SMZC1402-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算５【SMZC1402】をコールして、リターンパッケージを取得する
           CALL  "SMZC1402"              USING  PARM-SMZC1402-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1402)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-058
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算５  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算５ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1402-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算６
      ******************************************************************
       SMZC1403-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算６ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算６【SMZC1403】に接続用パラメータの設定を行なう
      *----------  異動計算パターン.払出簿価計算方法
           MOVE  WK-DEBET-BOKA-CALC-HOU  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-CALC-HOU     OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.払出簿価端数（市場通貨）
           MOVE  WK-DEBET-BOKA-HASU-BC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-BC      OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.払出単価桁数（市場通貨）
           MOVE  WK-DEBET-TNK-KETASU-BC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-BC     OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.払出単価端数（市場通貨）
           MOVE  WK-DEBET-TNK-HASU-BC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-BC       OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.払出簿価端数（運用通貨）
           MOVE  WK-DEBET-BOKA-HASU-LC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-LC      OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.払出単価桁数（運用通貨）
           MOVE  WK-DEBET-TNK-KETASU-LC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-LC     OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.払出単価端数（運用通貨）
           MOVE  WK-DEBET-TNK-HASU-LC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-LC       OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.簿価為替レート適用フラグ
           MOVE  WK-BOKA-KWS-TEKIYO-FLG  OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-TEKIYO-FLG     OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.簿価為替レート端数
           MOVE  WK-BOKA-KWS-HASU        OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-HASU           OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.簿価為替レート桁数
           MOVE  WK-BOKA-KWS-KETASU      OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-KETASU         OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.売り続く限り同一コスト
           MOVE  WK-URI-TUDUKU-SAME-COST
             OF  WK-YIDOU-CALC-PARM
             TO  URI-TUDUKU-SAME-COST    OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.同一日は同一コスト
           MOVE  WK-SAME-YMD-SAME-COST   OF  WK-YIDOU-CALC-PARM
             TO  SAME-YMD-SAME-COST      OF  PARM-SMZC1403-ARG1
      *----------  異動計算パターン.処理順序
           MOVE  WK-SYRI-JUN             OF  WK-YIDOU-CALC-PARM
             TO  SYRI-JUN                OF  PARM-SMZC1403-ARG1
      *----------  取引.１口注文ＩＤ
           MOVE  WK-ORDR-1K-ID           OF  WK-TORI-DATA
             TO  ORDR-1K-ID              OF  TORI-HIKI-PARM
             OF  PARM-SMZC1403-ARG1
      *----------  取引.約定日
           MOVE  WK-YKJ-YMD              OF  WK-TORI-DATA
             TO  YKJ-YMD                 OF  PARM-SMZC1403-ARG1
      *----------  取引.受渡日
           MOVE  WK-UKE-YMD              OF  WK-TORI-DATA
             TO  UKE-YMD                 OF  PARM-SMZC1403-ARG1
      *----------  取引.数量単位
           MOVE  WK-SURYO-TANI           OF  WK-TORI-DATA
             TO  SURYO-TANI              OF  PARM-SMZC1403-ARG1
      *----------  直前の取引.１口注文ＩＤ
           MOVE  WK-ORDR-1K-ID           OF  WK-CHOKZ-TORI
             TO  ORDR-1K-ID              OF  TYOKUZEN-TORI-HIKI-PARM
             OF  PARM-SMZC1403-ARG1
      *----------  直前の残高異動.市場通貨払出単価
           MOVE  WK-SJTK-H-TNK           OF  WK-TZ-ZN-IDO
             TO  SJTK-HARAID-TNK         OF  PARM-SMZC1403-ARG1
      *----------  直前の残高異動.運用通貨払出単価
           MOVE  WK-UYTK-H-TNK           OF  WK-TZ-ZN-IDO
             TO  UYTK-HARAID-TNK         OF  PARM-SMZC1403-ARG1
      *----------  直前の残高異動.計上基準日
           MOVE  WK-KEIJOU-KIJUNBI       OF  WK-TZ-ZN-IDO
             TO  KEIJOU-KIJUNBI          OF  PARM-SMZC1403-ARG1
      *----------  直前の残高異動.市場通貨異動後簿価残高
           MOVE  WK-SJTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-BOKAZN        OF  PARM-SMZC1403-ARG1
      *----------  直前の残高異動.運用通貨異動後簿価残高
           MOVE  WK-UYTK-IDOG-BOKAZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-BOKAZN        OF  PARM-SMZC1403-ARG1
      *----------  直前の残高異動.異動後数量残高
           MOVE  WK-IDOG-SRYZN           OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN              OF  PARM-SMZC1403-ARG1
      *----------  通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
             OF  PARM-SMZC1403-ARG1
      *----------  異動数量
           MOVE  WK-IDO-SURYO            OF  WK-SURYO-CALC-KEKKA
             TO  IDO-SURYOU              OF  PARM-SMZC1403-ARG1
      *----------  基本会計ベースフラグ
           MOVE  WK-KH-KAIKEI-BASE-FLG   OF  WK-KYJ-YMD-DMN-INFO
             TO  KIHON-KAIKEI-BASE-FLG   OF  PARM-SMZC1403-ARG1
      *----------  売り続く限りフラグ
           MOVE  WK-URI-TUDUKU-KAGI-FLG  OF  WK-DATA-IN
             TO  URI-TUDUKU-KAGI-FLG     OF  PARM-SMZC1403-ARG1
      *----------  銘柄別断面情報
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  RIYO-CMP-CD             OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             TO  FUND-CD                 OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  PTF-CD                  OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-MEG-BETU-DMN-INFO
             TO  SYORI-YMD               OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  KIDOU-ID                OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  銘柄コード
           MOVE  WK-MEG-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  MEG-CD                  OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  SEC-SBT-CD              OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  TATE-FLG                OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *----------  玉ID
           MOVE  WK-GYOKU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  GYOKU-ID                OF  TKMZBW03-PARM
                                         OF  PARM-SMZC1403-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価計算方法    =["
      D             DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（市場通貨"
      D             "）=["DEBET-BOKA-HASU-BC  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（市場通貨"
      D             "）=["DEBET-TNK-KETASU-BC  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（市場通貨"
      D             "）=["DEBET-TNK-HASU-BC  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（運用通貨"
      D             "）=["DEBET-BOKA-HASU-LC  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（運用通貨"
      D             "）=["DEBET-TNK-KETASU-LC  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（運用通貨"
      D             "）=["DEBET-TNK-HASU-LC  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート適用フラ"
      D             "グ=["BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート端数  =["
      D             BOKA-KWS-HASU        OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート桁数  =["
      D             BOKA-KWS-KETASU      OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.売り続く限り同一コスト"
      D             "=["URI-TUDUKU-SAME-COST  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.同一日は同一コスト=["
      D             SAME-YMD-SAME-COST   OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.処理順序      =["
      D             SYRI-JUN             OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.１口注文ＩＤ=["ORDR-1K-ID  OF
      D             TORI-HIKI-PARM       OF PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定日=["
      D             YKJ-YMD              OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.受渡日=["
      D             UKE-YMD              OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.数量単位=["
      D             SURYO-TANI           OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の取引.１口注文ＩＤ=["ORDR-1K-ID  OF
      D             TYOKUZEN-TORI-HIKI-PARM  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨払出単価=["
      D             SJTK-HARAID-TNK      OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨払出単価=["
      D             UYTK-HARAID-TNK      OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.計上基準日      =["
      D             KEIJOU-KIJUNBI       OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後簿価残高=["
      D             SJTK-IDOG-BOKAZN     OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後簿価残高=["
      D             UYTK-IDOG-BOKAZN     OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.異動後数量残高        =["
      D             IDOG-SRYZN           OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理             =["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動数量                             =["
      D             IDO-SURYOU           OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ                =["
      D             KIHON-KAIKEI-BASE-FLG  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限りフラグ               =["
      D             URI-TUDUKU-KAGI-FLG    OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報"
      D    DISPLAY  CNS-PGM-ID":利用会社コード         = ["
      D             RIYO-CMP-CD          OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード         = ["
      D             FUND-CD              OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード   = ["
      D             PTF-CD               OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日             = ["
      D             SYORI-YMD            OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                 = ["
      D             KIDOU-ID             OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード             = ["
      D             MEG-CD               OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード         = ["
      D             SEC-SBT-CD           OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ= ["
      D             TATE-FLG             OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID                    = ["
      D             GYOKU-ID             OF  TKMZBW03-PARM
      D                                  OF  PARM-SMZC1403-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算６【SMZC1403】をコールして、リターンパッケージを取得する
           CALL  "SMZC1403"              USING  PARM-SMZC1403-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1403)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-059
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算６  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算６ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1403-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算７
      ******************************************************************
       SMZC1404-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算７ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算７【SMZC1404】に接続用パラメータの設定を行なう
      *----------  取引.約定金額（市場通貨換算額)
           MOVE  WK-S-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  S-KSG-G-YJKG            OF  PARM-SMZC1404-ARG1
      *----------  取引.約定金額（運用通貨換算額)
           MOVE  WK-U-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  U-KSG-G-YJKG            OF  PARM-SMZC1404-ARG1
      *----------  取引.現地手数料（運用通貨換算額）
           MOVE  WK-U-KSG-G-TSR          OF  WK-TORI-DATA
             TO  U-KSG-G-TSR             OF  PARM-SMZC1404-ARG1
      *----------  取引.現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  PARM-SMZC1404-ARG1
      *----------  取引.現地その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-G-THY          OF  WK-TORI-DATA
             TO  U-KSG-G-THY             OF  PARM-SMZC1404-ARG1
      *----------  取引.現地源泉税（運用通貨換算額）
           MOVE  WK-U-KSG-G-GSZ          OF  WK-TORI-DATA
             TO  U-KSG-G-GSZ             OF  PARM-SMZC1404-ARG1
      *----------  取引.現地源泉税（市場通貨換算額）
           MOVE  WK-S-KSG-G-GSZ          OF  WK-TORI-DATA
             TO  S-KSG-G-GSZ             OF  PARM-SMZC1404-ARG1
      *----------  取引.国内源泉税（運用通貨換算額）
           MOVE  WK-NAI-TAX-U-KSG        OF  WK-TORI-DATA
             TO  U-KSG-U-GSZ             OF  PARM-SMZC1404-ARG1
      *----------  取引.国内源泉税（市場通貨換算額）
           MOVE  WK-S-KSG-U-GSZ          OF  WK-TORI-DATA
             TO  S-KSG-U-GSZ             OF  PARM-SMZC1404-ARG1
      *----------  個別項目計算３.市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1400-ARG2
             TO  SJTK-TESRY-BS-KN        OF  PARM-SMZC1404-ARG1
      *----------  個別項目計算３.運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1400-ARG2
             TO  UYTK-TESRY-BS-KN        OF  PARM-SMZC1404-ARG1
      *----------  個別項目計算３.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1400-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1404-ARG1
      *----------  個別項目計算３.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1400-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1404-ARG1
      *----------  個別項目計算３.市場通貨その他費用（売買金額）
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1400-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1404-ARG1
      *----------  個別項目計算３.運用通貨その他費用（売買金額）
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1400-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1404-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額)=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額)=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（運用通貨換算額）=["
      D             U-KSG-G-TSR          OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（運用通貨換算額）=["
      D             U-KSG-G-THY          OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地源泉税（運用通貨換算額）=["
      D             U-KSG-G-GSZ          OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地源泉税（市場通貨換算額）=["
      D             S-KSG-G-GSZ          OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.国内源泉税（運用通貨換算額）=["
      D             U-KSG-U-GSZ          OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.国内源泉税（市場通貨換算額）=["
      D             S-KSG-U-GSZ          OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.市場通貨手数料（売買金額"
      D             "）=["SJTK-TESRY-BS-KN  OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.運用通貨手数料（売買金額"
      D             "）=["UYTK-TESRY-BS-KN  OF  PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.市場通貨消費税（売買金額"
      D             "）=["SJTK-SHOHI-TAX-BS-KN OF PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.運用通貨消費税（売買金額"
      D             "）=["UYTK-SHOHI-TAX-BS-KN OF PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.市場通貨その他費用（売買"
      D           "金額）=["SJTK-ELS-HIYO-BS-KN OF PARM-SMZC1404-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.運用通貨その他費用（売買"
      D           "金額）=["UYTK-ELS-HIYO-BS-KN OF PARM-SMZC1404-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算７【SMZC1404】をコールして、リターンパッケージを取得する
           CALL  "SMZC1404"              USING  PARM-SMZC1404-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1404)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-060
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算７  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算７ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1404-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算８
      ******************************************************************
       SMZC1405-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算８ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算８【SMZC1405】に接続用パラメータの設定を行なう
      *----------  取引.約定金額（市場通貨換算額)
           MOVE  WK-S-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  S-KSG-G-YJKG            OF  PARM-SMZC1405-ARG1
      *----------  取引.約定金額（運用通貨換算額)
           MOVE  WK-U-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  U-KSG-G-YJKG            OF  PARM-SMZC1405-ARG1
      *----------  取引.現地手数料（運用通貨換算額）
           MOVE  WK-U-KSG-G-TSR          OF  WK-TORI-DATA
             TO  U-KSG-G-TSR             OF  PARM-SMZC1405-ARG1
      *----------  取引.現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  PARM-SMZC1405-ARG1
      *----------  取引.現地その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-G-THY          OF  WK-TORI-DATA
             TO  U-KSG-G-THY             OF  PARM-SMZC1405-ARG1
      *----------  個別項目計算３.市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1400-ARG2
             TO  SJTK-TESRY-BS-KN        OF  PARM-SMZC1405-ARG1
      *----------  個別項目計算３.運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1400-ARG2
             TO  UYTK-TESRY-BS-KN        OF  PARM-SMZC1405-ARG1
      *----------  個別項目計算３.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1400-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1405-ARG1
      *----------  個別項目計算３.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1400-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1405-ARG1
      *----------  個別項目計算３.市場通貨その他費用（売買金額）
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1400-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1405-ARG1
      *----------  個別項目計算３.運用通貨その他費用（売買金額）
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1400-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1405-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額)=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額)=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（運用通貨換算額）=["
      D             U-KSG-G-TSR          OF  PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（運用通貨換算額）=["
      D             U-KSG-G-THY          OF  PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.市場通貨手数料（売買金額"
      D             "）=["SJTK-TESRY-BS-KN  OF  PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.運用通貨手数料（売買金額"
      D             "）=["UYTK-TESRY-BS-KN  OF  PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.市場通貨消費税（売買金額"
      D             "）=["SJTK-SHOHI-TAX-BS-KN OF PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.運用通貨消費税（売買金額"
      D             "）=["UYTK-SHOHI-TAX-BS-KN OF PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.市場通貨その他費用（売買"
      D           "金額）=["SJTK-ELS-HIYO-BS-KN OF PARM-SMZC1405-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算３.運用通貨その他費用（売買"
      D           "金額）=["UYTK-ELS-HIYO-BS-KN OF PARM-SMZC1405-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算８【SMZC1405】をコールして、リターンパッケージを取得する
           CALL  "SMZC1405"              USING  PARM-SMZC1405-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1405)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-061
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算８  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算８ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1405-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算９
      ******************************************************************
       SMZC1406-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算９ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算９【SMZC1406】に接続用パラメータの設定を行なう
      *----------  取引.現地手数料（市場通貨換算額）
           MOVE  WK-S-KSG-G-TSR          OF  WK-TORI-DATA
             TO  S-KSG-G-TSR             OF  PARM-SMZC1406-ARG1
      *----------  取引.現地消費税（市場通貨換算額）
           MOVE  WK-S-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-G-SHZ             OF  PARM-SMZC1406-ARG1
      *----------  取引.現地その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-G-THY          OF  WK-TORI-DATA
             TO  S-KSG-G-THY             OF  PARM-SMZC1406-ARG1
      *----------  取引.現地手数料（運用通貨換算額）
           MOVE  WK-U-KSG-G-TSR          OF  WK-TORI-DATA
             TO  U-KSG-G-TSR             OF  PARM-SMZC1406-ARG1
      *----------  取引.現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  PARM-SMZC1406-ARG1
      *----------  取引.現地その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-G-THY          OF  WK-TORI-DATA
             TO  U-KSG-G-THY             OF  PARM-SMZC1406-ARG1
      *----------  取引.運用国手数料（運用通貨換算額）
           MOVE  WK-U-KSG-U-TSR          OF  WK-TORI-DATA
             TO  U-KSG-U-TSR             OF  PARM-SMZC1406-ARG1
      *----------  取引.運用国消費税（運用通貨換算額）
           MOVE  WK-U-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-U-SHZ             OF  PARM-SMZC1406-ARG1
      *----------  取引.運用国その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-U-THY          OF  WK-TORI-DATA
             TO  U-KSG-U-THY             OF  PARM-SMZC1406-ARG1
      *----------  取引.資金決済方法
           MOVE  WK-KESAI-HOHO           OF  WK-TORI-DATA
             TO  KESAI-HOHO              OF  PARM-SMZC1406-ARG1
      *----------  建時現地手数料（市場通貨）
           MOVE  WK-S-KSG-TH-G-TSR       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-TSR          OF  PARM-SMZC1406-ARG1
      *----------  建時現地消費税（市場通貨）
           MOVE  WK-S-KSG-TH-G-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-SHZ          OF  PARM-SMZC1406-ARG1
      *----------  建時現地その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-G-THY       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-THY          OF  PARM-SMZC1406-ARG1
      *----------  建時運用国手数料（市場通貨）
           MOVE  WK-S-KSG-TH-U-TSR       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-TSR          OF  PARM-SMZC1406-ARG1
      *----------  建時運用国消費税（市場通貨）
           MOVE  WK-S-KSG-TH-U-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-SHZ          OF  PARM-SMZC1406-ARG1
      *----------  建時運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-U-THY       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-THY          OF  PARM-SMZC1406-ARG1
      *----------  建時現地手数料（運用通貨）
           MOVE  WK-U-KSG-TH-G-TSR       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-TSR          OF  PARM-SMZC1406-ARG1
      *----------  建時現地消費税（運用通貨）
           MOVE  WK-U-KSG-TH-G-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-SHZ          OF  PARM-SMZC1406-ARG1
      *----------  建時現地その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-G-THY       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-THY          OF  PARM-SMZC1406-ARG1
      *----------  建時運用国手数料（運用通貨）
           MOVE  WK-U-KSG-TH-U-TSR       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-TSR          OF  PARM-SMZC1406-ARG1
      *----------  建時運用国消費税（運用通貨）
           MOVE  WK-U-KSG-TH-U-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-SHZ          OF  PARM-SMZC1406-ARG1
      *----------  建時運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-U-THY       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-THY          OF  PARM-SMZC1406-ARG1
      *----------  手数料を市場取得金額に含むフラグ
           MOVE  WK-TESRY-SJST-KN-FLG    OF  WK-SWK-KJN
             TO  TESRY-SJST-KN-FLG       OF  PARM-SMZC1406-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  WK-SHOHI-TAX-SJST-KN-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1406-ARG1
      *----------  その他費用を市場取得金額に含むフラグ
           MOVE  WK-ELS-HIYO-SJST-KN-FLG OF  WK-SWK-KJN
             TO  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1406-ARG1
      *---------- 手数料用売買損益に含むフラグ
           MOVE  WK-TESRY-BBSNEKI-FLG    OF  WK-SWK-KJN
             TO  TESRY-BBSNEKI-FLG       OF  PARM-SMZC1406-ARG1
      *---------- 消費税用売買損益に含むフラグ
           MOVE  WK-SHOHI-TAX-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1406-ARG1
      *---------- その他費用用売買損益に含むフラグ
           MOVE  WK-ELS-HIYO-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1406-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（市場通貨換算額）=["
      D             S-KSG-G-TSR          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（市場通貨換算額）=["
      D             S-KSG-G-SHZ          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（市場通貨換算額）=["
      D             S-KSG-G-THY          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（運用通貨換算額）=["
      D             U-KSG-G-TSR          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（運用通貨換算額）=["
      D             U-KSG-G-THY          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国手数料（運用通貨換算額）=["
      D             U-KSG-U-TSR          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国消費税（運用通貨換算額）=["
      D             U-KSG-U-SHZ          OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国その他費用（運用通貨換算額）"
      D             "=["U-KSG-U-THY      OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.資金決済方法                  =["
      D             KESAI-HOHO           OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（市場通貨）=["
      D             S-KSG-TH-G-TSR       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（市場通貨）=["
      D             S-KSG-TH-G-SHZ       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（市場通貨）=["
      D             S-KSG-TH-G-THY       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（市場通貨）=["
      D             S-KSG-TH-U-TSR       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（市場通貨）=["
      D             S-KSG-TH-U-SHZ       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（市場通貨）=["
      D             S-KSG-TH-U-THY       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（運用通貨）=["
      D             U-KSG-TH-G-TSR       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（運用通貨）=["
      D             U-KSG-TH-G-SHZ       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（運用通貨）=["
      D             U-KSG-TH-G-THY       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（運用通貨）=["
      D             U-KSG-TH-U-TSR       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（運用通貨）=["
      D             U-KSG-TH-U-SHZ       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（運用通貨）=["
      D             U-KSG-TH-U-THY       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含むフラグ    =["
      D             TESRY-SJST-KN-FLG       OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含むフラグ=["
      D             ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ        =["
      D             TESRY-BBSNEKI-FLG    OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG  OF  PARM-SMZC1406-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ    =["
      D             ELS-HIYO-BBSNEKI-FLG  OF  PARM-SMZC1406-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算９【SMZC1406】をコールして、リターンパッケージを取得する
           CALL  "SMZC1406"              USING  PARM-SMZC1406-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1406)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-062
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算９  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算９ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1406-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１０
      ******************************************************************
       SMZC1407-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１０ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１０【SMZC1407】に接続用パラメータの設定を行なう
      *----------  取引.現地手数料（市場通貨換算額）
           MOVE  WK-S-KSG-G-TSR          OF  WK-TORI-DATA
             TO  S-KSG-G-TSR             OF  PARM-SMZC1407-ARG1
      *----------  取引.現地消費税（市場通貨換算額）
           MOVE  WK-S-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-G-SHZ             OF  PARM-SMZC1407-ARG1
      *----------  取引.現地その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-G-THY          OF  WK-TORI-DATA
             TO  S-KSG-G-THY             OF  PARM-SMZC1407-ARG1
      *----------  取引.現地手数料（運用通貨換算額）
           MOVE  WK-U-KSG-G-TSR          OF  WK-TORI-DATA
             TO  U-KSG-G-TSR             OF  PARM-SMZC1407-ARG1
      *----------  取引.現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  PARM-SMZC1407-ARG1
      *----------  取引.現地その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-G-THY          OF  WK-TORI-DATA
             TO  U-KSG-G-THY             OF  PARM-SMZC1407-ARG1
      *----------  取引.運用国手数料（運用通貨換算額）
           MOVE  WK-U-KSG-U-TSR          OF  WK-TORI-DATA
             TO  U-KSG-U-TSR             OF  PARM-SMZC1407-ARG1
      *----------  取引.運用国消費税（運用通貨換算額）
           MOVE  WK-U-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-U-SHZ             OF  PARM-SMZC1407-ARG1
      *----------  取引.運用国その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-U-THY          OF  WK-TORI-DATA
             TO  U-KSG-U-THY             OF  PARM-SMZC1407-ARG1
      *----------  取引.運用国手数料（市場通貨換算額）
           MOVE  WK-S-KSG-U-TSR          OF  WK-TORI-DATA
             TO  S-KSG-U-TSR             OF  PARM-SMZC1407-ARG1
      *----------  取引.運用国消費税（市場通貨換算額）
           MOVE  WK-S-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-U-SHZ             OF  PARM-SMZC1407-ARG1
      *----------  取引.運用国その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-U-THY          OF  WK-TORI-DATA
             TO  S-KSG-U-THY             OF  PARM-SMZC1407-ARG1
      *----------  建時現地手数料（市場通貨）
           MOVE  WK-S-KSG-TH-G-TSR       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-TSR          OF  PARM-SMZC1407-ARG1
      *----------  建時現地消費税（市場通貨）
           MOVE  WK-S-KSG-TH-G-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-SHZ          OF  PARM-SMZC1407-ARG1
      *----------  建時現地その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-G-THY       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-THY          OF  PARM-SMZC1407-ARG1
      *----------  建時運用国手数料（市場通貨）
           MOVE  WK-S-KSG-TH-U-TSR       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-TSR          OF  PARM-SMZC1407-ARG1
      *----------  建時運用国消費税（市場通貨）
           MOVE  WK-S-KSG-TH-U-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-SHZ          OF  PARM-SMZC1407-ARG1
      *----------  建時運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-U-THY       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-THY          OF  PARM-SMZC1407-ARG1
      *----------  建時現地手数料（運用通貨）
           MOVE  WK-U-KSG-TH-G-TSR       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-TSR          OF  PARM-SMZC1407-ARG1
      *----------  建時現地消費税（運用通貨）
           MOVE  WK-U-KSG-TH-G-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-SHZ          OF  PARM-SMZC1407-ARG1
      *----------  建時現地その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-G-THY       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-THY          OF  PARM-SMZC1407-ARG1
      *----------  建時運用国手数料（運用通貨）
           MOVE  WK-U-KSG-TH-U-TSR       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-TSR          OF  PARM-SMZC1407-ARG1
      *----------  建時運用国消費税（運用通貨）
           MOVE  WK-U-KSG-TH-U-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-SHZ          OF  PARM-SMZC1407-ARG1
      *----------  建時運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-U-THY       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-THY          OF  PARM-SMZC1407-ARG1
      *----------  手数料を市場取得金額に含むフラグ
           MOVE  WK-TESRY-SJST-KN-FLG    OF  WK-SWK-KJN
             TO  TESRY-SJST-KN-FLG       OF  PARM-SMZC1407-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  WK-SHOHI-TAX-SJST-KN-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1407-ARG1
      *----------  その他費用を市場取得金額に含むフラグ
           MOVE  WK-ELS-HIYO-SJST-KN-FLG OF  WK-SWK-KJN
             TO  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1407-ARG1
      *----------  手数料用売買損益に含むフラグ
           MOVE  WK-TESRY-BBSNEKI-FLG    OF  WK-SWK-KJN
             TO  TESRY-BBSNEKI-FLG       OF  PARM-SMZC1407-ARG1
      *----------  消費税用売買損益に含むフラグ
           MOVE  WK-SHOHI-TAX-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1407-ARG1
      *----------  その他費用用売買損益に含むフラグ
           MOVE  WK-ELS-HIYO-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1407-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（市場通貨換算額）=["
      D             S-KSG-G-TSR          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（市場通貨換算額）=["
      D             S-KSG-G-SHZ          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（市場通貨換算額）=["
      D             S-KSG-G-THY          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（運用通貨換算額）=["
      D             U-KSG-G-TSR          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（運用通貨換算額）=["
      D             U-KSG-G-THY          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国手数料（運用通貨換算額）=["
      D             U-KSG-U-TSR          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国消費税（運用通貨換算額）=["
      D             U-KSG-U-SHZ          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国その他費用（運用通貨換算額）"
      D             "=["U-KSG-U-THY      OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国手数料（市場通貨換算額）=["
      D             S-KSG-U-TSR          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国消費税（市場通貨換算額）=["
      D             S-KSG-U-SHZ          OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国その他費用（市場通貨換算額）"
      D             "=["S-KSG-U-THY      OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引データ"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（市場通貨）=["
      D             S-KSG-TH-G-TSR       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（市場通貨）=["
      D             S-KSG-TH-G-SHZ       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（市場通貨）=["
      D             S-KSG-TH-G-THY       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（市場通貨）=["
      D             S-KSG-TH-U-TSR       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（市場通貨）=["
      D             S-KSG-TH-U-SHZ       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（市場通貨）=["
      D             S-KSG-TH-U-THY       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（運用通貨）=["
      D             U-KSG-TH-G-TSR       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（運用通貨）=["
      D             U-KSG-TH-G-SHZ       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（運用通貨）=["
      D             U-KSG-TH-G-THY       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（運用通貨）=["
      D             U-KSG-TH-U-TSR       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（運用通貨）=["
      D             U-KSG-TH-U-SHZ       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（運用通貨）=["
      D             U-KSG-TH-U-THY       OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含むフラグ    =["
      D             TESRY-SJST-KN-FLG    OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG  OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含むフラグ=["
      D             ELS-HIYO-SJST-KN-FLG OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ        =["
      D             TESRY-BBSNEKI-FLG    OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG  OF  PARM-SMZC1407-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ    =["
      D             ELS-HIYO-BBSNEKI-FLG  OF  PARM-SMZC1407-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１０【SMZC1407】をコールして、リターンパッケージを取得する
           CALL  "SMZC1407"              USING  PARM-SMZC1407-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1407)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-063
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１０  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１０ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1407-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１３
      ******************************************************************
       SMZC1410-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１３ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１３【SMZC1410】に接続用パラメータの設定を行なう
      *----------  新株取引.異動数量
           MOVE  WK-IDO-SURYO            OF  WK-SKB-TORI-PARM
             TO  IDO-SURYOU              OF  PARM-SMZC1410-ARG1
      *----------  新株取引.約定金額（市場通貨換算額）
           MOVE  WK-S-KSG-G-YJKG         OF  WK-SKB-TORI-PARM
             TO  S-KSG-G-YJKG            OF  PARM-SMZC1410-ARG1
      *----------  新株取引.約定金額（運用通貨換算額）
           MOVE  WK-U-KSG-G-YJKG         OF  WK-SKB-TORI-PARM
             TO  U-KSG-G-YJKG            OF  PARM-SMZC1410-ARG1
      *----------  直前親株の残高異動.市場通貨異動後簿価残高
           MOVE  WK-SJTK-IDOG-BOKAZN     OF  WK-CHOKZ-O-ZADAKA-IDOU
             TO  SJTK-IDOG-BOKAZN        OF  TYOKUZEN-OKB-ZN-IDO-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  直前親株の残高異動.運用通貨異動後簿価残高
           MOVE  WK-UYTK-IDOG-BOKAZN     OF  WK-CHOKZ-O-ZADAKA-IDOU
             TO  UYTK-IDOG-BOKAZN        OF  TYOKUZEN-OKB-ZN-IDO-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  直前親株の残高異動.異動後数量残高
           MOVE  WK-IDOG-SRYZN           OF  WK-CHOKZ-O-ZADAKA-IDOU
             TO  IDOG-SRYZN              OF  TYOKUZEN-OKB-ZN-IDO-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  直前新株の残高異動.市場通貨異動後簿価残高
           MOVE  WK-SJTK-IDOG-BOKAZN     OF  WK-CHOKZ-S-ZADAKA-IDOU
             TO  SJTK-IDOG-BOKAZN        OF  TYOKUZEN-SKB-ZN-IDO-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  直前新株の残高異動.運用通貨異動後簿価残高
           MOVE  WK-UYTK-IDOG-BOKAZN     OF  WK-CHOKZ-S-ZADAKA-IDOU
             TO  UYTK-IDOG-BOKAZN        OF  TYOKUZEN-SKB-ZN-IDO-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.新／旧簿価計算方法
           MOVE  WK-SIN-KYU-BOKA-CALC    OF  WK-YIDOU-CALC-PARM
             TO  SIN-KYU-BOKA-CALC       OF  IDO-CALC-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.払出簿価計算方法
           MOVE  WK-DEBET-BOKA-CALC-HOU  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-CALC-HOU     OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.払出簿価端数（市場通貨）
           MOVE  WK-DEBET-BOKA-HASU-BC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-BC      OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.払出単価桁数（市場通貨）
           MOVE  WK-DEBET-TNK-KETASU-BC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-BC     OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.払出単価端数（市場通貨）
           MOVE  WK-DEBET-TNK-HASU-BC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-BC       OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.払出簿価端数（運用通貨）
           MOVE  WK-DEBET-BOKA-HASU-LC   OF  WK-YIDOU-CALC-PARM
             TO  DEBET-BOKA-HASU-LC      OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.払出単価桁数（運用通貨）
           MOVE  WK-DEBET-TNK-KETASU-LC  OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-KETASU-LC     OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.払出単価端数（運用通貨）
           MOVE  WK-DEBET-TNK-HASU-LC    OF  WK-YIDOU-CALC-PARM
             TO  DEBET-TNK-HASU-LC       OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.簿価為替レート適用フラグ
           MOVE  WK-BOKA-KWS-TEKIYO-FLG  OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-TEKIYO-FLG     OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.簿価為替レート端数
           MOVE  WK-BOKA-KWS-HASU        OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-HASU           OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.簿価為替レート桁数
           MOVE  WK-BOKA-KWS-KETASU      OF  WK-YIDOU-CALC-PARM
             TO  BOKA-KWS-KETASU         OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.按分簿価端数
           MOVE  WK-ANB-BOKA-HASU        OF  WK-YIDOU-CALC-PARM
             TO  ANB-BOKA-HASU           OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.按分単価端数
           MOVE  WK-ANB-TNK-HASU         OF  WK-YIDOU-CALC-PARM
             TO  ANB-TNK-HASU            OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.按分単価桁数
           MOVE  WK-ANB-TNK-KETASU       OF  WK-YIDOU-CALC-PARM
             TO  ANB-TNK-KETASU          OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *----------  異動計算パターン.前払金償却分端数
           MOVE  WK-MAEKIN-SHOUKYK-HASU  OF  WK-YIDOU-CALC-PARM
             TO  MAEKIN-SHOUKYK-HASU     OF  SMZC1501-PARM
             OF  PARM-SMZC1410-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":新株取引.異動数量=["
      D             IDO-SURYOU           OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":新株取引.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":新株取引.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.市場通貨異動後簿価残"
      D             "高=["SJTK-IDOG-BOKAZN  OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.運用通貨異動後簿価残"
      D             "高=["UYTK-IDOG-BOKAZN  OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.異動後数量残高=["
      D             IDOG-SRYZN           OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前新株の残高異動.市場通貨異動後簿価残"
      D             "高=["SJTK-IDOG-BOKAZN  OF  TYOKUZEN-SKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前新株の残高異動.運用通貨異動後簿価残"
      D             "高=["UYTK-IDOG-BOKAZN  OF  TYOKUZEN-SKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理 =["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.新／旧簿価計算方法=["
      D             SIN-KYU-BOKA-CALC       OF  IDO-CALC-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価計算方法=["
      D             DEBET-BOKA-CALC-HOU  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（市場通貨"
      D             "）=["DEBET-BOKA-HASU-BC  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（市場通貨"
      D             "）=["DEBET-TNK-KETASU-BC  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（市場通貨"
      D             "）=["DEBET-TNK-HASU-BC  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（運用通貨"
      D             "）=["DEBET-BOKA-HASU-LC  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（運用通貨"
      D             "）=["DEBET-TNK-KETASU-LC  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（運用通貨"
      D             "）=["DEBET-TNK-HASU-LC  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート適用フ"
      D             "ラグ=["BOKA-KWS-TEKIYO-FLG  OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート端数=["
      D             BOKA-KWS-HASU        OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート桁数=["
      D             BOKA-KWS-KETASU     OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分簿価端数=["
      D             ANB-BOKA-HASU    OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価端数=["
      D             ANB-TNK-HASU      OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価桁数=["
      D             ANB-TNK-KETASU       OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.前払金償却分端数=["
      D             MAEKIN-SHOUKYK-HASU   OF  SMZC1501-PARM
      D             OF  PARM-SMZC1410-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１３【SMZC1410】をコールして、リターンパッケージを取得する
           CALL  "SMZC1410"              USING  PARM-SMZC1410-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1410)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-064
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１３  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１３ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1410-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１４
      ******************************************************************
       SMZC1411-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１４ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１４【SMZC1411】に接続用パラメータの設定を行なう
      *----------  取引.約定金額（市場通貨換算額)
           MOVE  WK-S-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  S-KSG-G-YJKG            OF  PARM-SMZC1411-ARG1
      *----------  取引.約定金額（運用通貨換算額)
           MOVE  WK-U-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  U-KSG-G-YJKG            OF  PARM-SMZC1411-ARG1
      *----------  取引.資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  TATE-FLG                OF  PARM-SMZC1411-ARG1
      *---------- 市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  SJTK-TESRY-BS-KN        OF  PARM-SMZC1411-ARG1
      *---------- 市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1411-ARG1
      *---------- 市場通貨その他費用（売買金額)
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1411-ARG1
      *---------- 運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  UYTK-TESRY-BS-KN        OF  PARM-SMZC1411-ARG1
      *---------- 運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1411-ARG1
      *---------- 運用通貨その他費用（売買金額)
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1411-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額)=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額)=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN     OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他費用（売買金額)=["
      D             SJTK-ELS-HIYO-BS-KN  OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN     OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1411-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他費用（売買金額)=["
      D             UYTK-ELS-HIYO-BS-KN  OF  PARM-SMZC1411-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１４【SMZC1411】をコールして、リターンパッケージを取得する
           CALL  "SMZC1411"              USING  PARM-SMZC1411-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1411)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-065
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１４  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１４ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1411-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１５
      ******************************************************************
       SMZC1412-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１５ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１５【SMZC1412】に接続用パラメータの設定を行なう
      *----------  取引.約定金額（市場通貨換算額)
           MOVE  WK-S-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  S-KSG-G-YJKG            OF  PARM-SMZC1412-ARG1
      *----------  取引.約定金額（運用通貨換算額)
           MOVE  WK-U-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  U-KSG-G-YJKG            OF  PARM-SMZC1412-ARG1
      *----------  取引.資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  TATE-FLG                OF  PARM-SMZC1412-ARG1
      *---------- 市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  SJTK-TESRY-BS-KN        OF  PARM-SMZC1412-ARG1
      *---------- 市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1412-ARG1
      *---------- 市場通貨その他費用（売買金額)
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1412-ARG1
      *---------- 運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  UYTK-TESRY-BS-KN        OF  PARM-SMZC1412-ARG1
      *---------- 運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1412-ARG1
      *---------- 運用通貨その他費用（売買金額)
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1412-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額)=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額)=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN     OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他費用（売買金額)=["
      D             SJTK-ELS-HIYO-BS-KN  OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN     OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1412-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他費用（売買金額)=["
      D             UYTK-ELS-HIYO-BS-KN  OF  PARM-SMZC1412-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１５【SMZC1412】をコールして、リターンパッケージを取得する
           CALL  "SMZC1412"              USING  PARM-SMZC1412-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1412)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-066
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１５  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１５ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1412-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１６
      ******************************************************************
       SMZC1413-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１６ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１６【SMZC1413】に接続用パラメータの設定を行なう
      *----------  引継ＯＰ現地手数料（市場通貨）
           MOVE  WK-S-KSG-HTOP-G-TSR     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-G-TSR        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ現地消費税（市場通貨）
           MOVE  WK-S-KSG-HTOP-G-SHZ     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-G-SHZ        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ現地その他費用（市場通貨）
           MOVE  WK-S-KSG-HTOP-G-THY     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-G-THY        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ運用国手数料（市場通貨）
           MOVE  WK-S-KSG-HTOP-U-TSR     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-U-TSR        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ運用国消費税（市場通貨）
           MOVE  WK-S-KSG-HTOP-U-SHZ     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-U-SHZ        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-HTOP-U-THY     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-U-THY        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ現地手数料（運用通貨）
           MOVE  WK-U-KSG-HTOP-G-TSR     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-G-TSR        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ現地消費税（運用通貨）
           MOVE  WK-U-KSG-HTOP-G-SHZ     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-G-SHZ        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ現地その他費用（運用通貨）
           MOVE  WK-U-KSG-HTOP-G-THY     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-G-THY        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ運用国手数料（運用通貨）
           MOVE  WK-U-KSG-HTOP-U-TSR     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-U-TSR        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ運用国消費税（運用通貨）
           MOVE  WK-U-KSG-HTOP-U-SHZ     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-U-SHZ        OF  PARM-SMZC1413-ARG1
      *----------  引継ＯＰ運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-HTOP-U-THY     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-U-THY        OF  PARM-SMZC1413-ARG1
      *----------  手数料を市場取得金額に含むフラグ
           MOVE  TESRY-SJST-KN-FLG       OF  PARM-SMZJ1915-ARG2(2)
             TO  TESRY-SJST-KN-FLG       OF  PARM-SMZC1413-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZJ1915-ARG2(2)
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1413-ARG1
      *----------  その他費用を市場取得金額に含むフラグ
           MOVE  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZJ1915-ARG2(2)
             TO  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1413-ARG1
      *----------  手数料用売買損益に含むフラグ
           MOVE  TESRY-BBSNEKI-FLG       OF  PARM-SMZJ1915-ARG2(2)
             TO  TESRY-BBSNEKI-FLG       OF  PARM-SMZC1413-ARG1
      *----------  消費税用売買損益に含むフラグ
           MOVE  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZJ1915-ARG2(2)
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1413-ARG1
      *----------  その他費用用売買損益に含むフラグ
           MOVE  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZJ1915-ARG2(2)
             TO  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1413-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地手数料（市場通貨）=["
      D             S-KSG-HTOP-G-TSR     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地消費税（市場通貨）=["
      D             S-KSG-HTOP-G-SHZ     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地その他費用（市場通貨）=["
      D             S-KSG-HTOP-G-THY     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国手数料（市場通貨）=["
      D             S-KSG-HTOP-U-TSR     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国消費税（市場通貨）=["
      D             S-KSG-HTOP-U-SHZ     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国その他費用（市場通貨）=["
      D             S-KSG-HTOP-U-THY     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地手数料（運用通貨）=["
      D             U-KSG-HTOP-G-TSR     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地消費税（運用通貨）=["
      D             U-KSG-HTOP-G-SHZ     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地その他費用（運用通貨）=["
      D             U-KSG-HTOP-G-THY     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国手数料（運用通貨）=["
      D             U-KSG-HTOP-U-TSR     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国消費税（運用通貨）=["
      D             U-KSG-HTOP-U-SHZ     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国その他費用（運用通貨）=["
      D             U-KSG-HTOP-U-THY     OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含むフラグ    =["
      D             TESRY-SJST-KN-FLG    OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含むフラグ=["
      D             ELS-HIYO-SJST-KN-FLG OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ        =["
      D             TESRY-BBSNEKI-FLG    OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG  OF  PARM-SMZC1413-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ    =["
      D             ELS-HIYO-BBSNEKI-FLG  OF  PARM-SMZC1413-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１６【SMZC1413】をコールして、リターンパッケージを取得する
           CALL  "SMZC1413"              USING  PARM-SMZC1413-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1413)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-067
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１６  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１６ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1413-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１７
      ******************************************************************
       SMZC1414-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１７ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１７【SMZC1414】に接続用パラメータの設定を行なう
      *----------  建時ＯＰ現地手数料（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-TSR    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-TSR       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ現地消費税（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-SHZ       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ現地その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-THY    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-THY       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ運用国手数料（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-TSR    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-TSR       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ運用国消費税（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-SHZ       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-THY    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-THY       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ現地手数料（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-TSR    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-TSR       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ現地消費税（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-SHZ       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ現地その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-THY    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-THY       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ運用国手数料（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-TSR    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-TSR       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ運用国消費税（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-SHZ       OF  PARM-SMZC1414-ARG1
      *----------  建時ＯＰ運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-THY    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-THY       OF  PARM-SMZC1414-ARG1
      *----------  手数料を市場取得金額に含むフラグ
           MOVE  TESRY-SJST-KN-FLG       OF  PARM-SMZJ1915-ARG2(1)
             TO  TESRY-SJST-KN-FLG       OF  PARM-SMZC1414-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZJ1915-ARG2(1)
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1414-ARG1
      *----------  その他費用を市場取得金額に含むフラグ
           MOVE  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZJ1915-ARG2(1)
             TO  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1414-ARG1
      *----------  手数料用売買損益に含むフラグ
           MOVE  TESRY-BBSNEKI-FLG       OF  PARM-SMZJ1915-ARG2(1)
             TO  TESRY-BBSNEKI-FLG       OF  PARM-SMZC1414-ARG1
      *----------  消費税用売買損益に含むフラグ
           MOVE  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZJ1915-ARG2(1)
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1414-ARG1
      *----------  その他費用用売買損益に含むフラグ
           MOVE  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZJ1915-ARG2(1)
             TO  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1414-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（市場通貨）=["
      D             S-KSG-TH-OP-G-TSR    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（市場通貨）=["
      D             S-KSG-TH-OP-G-SHZ    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（市場通貨）=["
      D             S-KSG-TH-OP-G-THY    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（市場通貨）=["
      D             S-KSG-TH-OP-U-TSR    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（市場通貨）=["
      D             S-KSG-TH-OP-U-SHZ    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（市場通貨）=["
      D             S-KSG-TH-OP-U-THY    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（運用通貨）=["
      D             U-KSG-TH-OP-G-TSR    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（運用通貨）=["
      D             U-KSG-TH-OP-G-SHZ    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（運用通貨）=["
      D             U-KSG-TH-OP-G-THY    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（運用通貨）=["
      D             U-KSG-TH-OP-U-TSR    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（運用通貨）=["
      D             U-KSG-TH-OP-U-SHZ    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（運用通貨）=["
      D             U-KSG-TH-OP-U-THY    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含むフラグ    =["
      D             TESRY-SJST-KN-FLG    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含むフラグ=["
      D             ELS-HIYO-SJST-KN-FLG OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ        =["
      D             TESRY-BBSNEKI-FLG    OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG  OF  PARM-SMZC1414-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ    =["
      D             ELS-HIYO-BBSNEKI-FLG  OF  PARM-SMZC1414-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１７【SMZC1414】をコールして、リターンパッケージを取得する
           CALL  "SMZC1414"              USING  PARM-SMZC1414-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1414)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-068
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１７  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１７ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1414-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１８
      ******************************************************************
       SMZC1415-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１８ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１８【SMZC1415】に接続用パラメータの設定を行なう
      *----------  取引.約定金額（市場通貨換算額)
           MOVE  WK-S-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  S-KSG-G-YJKG            OF  PARM-SMZC1415-ARG1
      *----------  取引.約定金額（運用通貨換算額)
           MOVE  WK-U-KSG-G-YJKG         OF  WK-TORI-DATA
             TO  U-KSG-G-YJKG            OF  PARM-SMZC1415-ARG1
      *----------  取引.資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  TATE-FLG                OF  PARM-SMZC1415-ARG1
      *----------  相対取引.決済単価
           MOVE  WK-KS-TANKA             OF  WK-AITAI-TRHK-DATA
             TO  KS-TANKA                OF  PARM-SMZC1415-ARG1
      *----------  相対取引.建時単価
           MOVE  WK-TATE-TANKA           OF  WK-AITAI-TRHK-DATA
             TO  TATE-TANKA              OF  PARM-SMZC1415-ARG1
      *---------- 市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  SJTK-TESRY-BS-KN        OF  PARM-SMZC1415-ARG1
      *---------- 市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1415-ARG1
      *---------- 市場通貨その他費用（売買金額)
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1415-ARG1
      *---------- 運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  UYTK-TESRY-BS-KN        OF  PARM-SMZC1415-ARG1
      *---------- 運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1415-ARG1
      *---------- 運用通貨その他費用（売買金額)
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1415-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額)=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額)=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.決済単価=["
      D             KS-TANKA             OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時単価=["
      D             TATE-TANKA           OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN     OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他費用（売買金額)=["
      D             SJTK-ELS-HIYO-BS-KN  OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN     OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1415-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他費用（売買金額)=["
      D             UYTK-ELS-HIYO-BS-KN  OF  PARM-SMZC1415-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１８【SMZC1415】をコールして、リターンパッケージを取得する
           CALL  "SMZC1415"              USING  PARM-SMZC1415-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1415)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-069
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１８  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１８ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1415-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算２０
      ******************************************************************
       SMZC1417-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算２０ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算２０【SMZC1417】に接続用パラメータの設定を行なう
      *----------  建時ＯＰ現地手数料（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-TSR    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-TSR       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ現地消費税（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-SHZ       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ現地その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-THY    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-THY       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ現地手数料（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-TSR    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-TSR       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ現地消費税（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-SHZ       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ現地その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-THY    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-THY       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ運用国手数料（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-TSR    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-TSR       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ運用国消費税（市場通貨)
           MOVE  WK-S-KSG-TH-OP-U-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-SHZ       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-THY    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-THY       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ運用国手数料（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-TSR    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-TSR       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ運用国消費税（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-SHZ       OF  PARM-SMZC1417-ARG1
      *----------  建時ＯＰ運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-THY    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-THY       OF  PARM-SMZC1417-ARG1
      *----------  手数料用売買損益に含むフラグ
           MOVE  WK-TESRY-BBSNEKI-FLG    OF  WK-SWK-KJN
             TO  TESRY-BBSNEKI-FLG       OF  PARM-SMZC1417-ARG1
      *----------  消費税用売買損益に含むフラグ
           MOVE  WK-SHOHI-TAX-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1417-ARG1
      *----------  その他費用用売買損益に含むフラグ
           MOVE  WK-ELS-HIYO-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1417-ARG1
      *----------  手数料を市場取得金額に含むフラグ
           MOVE  WK-TESRY-SJST-KN-FLG    OF  WK-SWK-KJN
             TO  TESRY-SJST-KN-FLG       OF  PARM-SMZC1417-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  WK-SHOHI-TAX-SJST-KN-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1417-ARG1
      *----------  その他費用を市場取得金額に含むフラグ
           MOVE  WK-ELS-HIYO-SJST-KN-FLG OF  WK-SWK-KJN
             TO  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1417-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（市場通貨）=["
      D             S-KSG-TH-OP-G-TSR    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（市場通貨）=["
      D             S-KSG-TH-OP-G-SHZ    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（市場通貨）=["
      D             S-KSG-TH-OP-G-THY    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（運用通貨）=["
      D             U-KSG-TH-OP-G-TSR    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（運用通貨）=["
      D             U-KSG-TH-OP-G-SHZ    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（運用通貨）=["
      D             U-KSG-TH-OP-G-THY    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（市場通貨）=["
      D             S-KSG-TH-OP-U-TSR    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（市場通貨）=["
      D             S-KSG-TH-OP-U-SHZ    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（市場通貨）=["
      D             S-KSG-TH-OP-U-THY    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（運用通貨）=["
      D             U-KSG-TH-OP-U-TSR    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（運用通貨）=["
      D             U-KSG-TH-OP-U-SHZ    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（運用通貨）=["
      D             U-KSG-TH-OP-U-THY    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ        =["
      D             TESRY-BBSNEKI-FLG    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG  OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ    =["
      D             ELS-HIYO-BBSNEKI-FLG  OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含むフラグ    =["
      D             TESRY-SJST-KN-FLG    OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG OF  PARM-SMZC1417-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含むフラグ=["
      D             ELS-HIYO-SJST-KN-FLG OF  PARM-SMZC1417-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算２０【SMZC1417】をコールして、リターンパッケージを取得する
           CALL  "SMZC1417"              USING  PARM-SMZC1417-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1417)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-070
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算２０  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算２０ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1417-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１９
      ******************************************************************
       SMZC1416-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１９ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１９【SMZC1416】に接続用パラメータの設定を行なう
      *----------  相対取引.建時ＯＰ約定金額（市場通貨）
           MOVE  WK-S-KSG-TH-OP-YJKG     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-YJKG        OF  PARM-SMZC1416-ARG1
      *----------  相対取引.建時ＯＰ約定金額（運用通貨）
           MOVE  WK-U-KSG-TH-OP-YJKG     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-YJKG        OF  PARM-SMZC1416-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-AITAI-TRHK-DATA
             TO  TATE-FLG                OF  PARM-SMZC1416-ARG1
      *----------  個別項目計算20.市場通貨手数料(払出建時金額)
           MOVE  SJTK-TESRY-HIYO-HTK     OF  PARM-SMZC1417-ARG2
             TO  SJTK-TESRY-HIYO-HTK     OF  PARM-SMZC1416-ARG1
      *----------  個別項目計算20.市場通貨消費税(払出建時金額)
           MOVE  SJTK-SHOHI-TAX-HTK      OF  PARM-SMZC1417-ARG2
             TO  SJTK-SHOHI-TAX-HTK      OF  PARM-SMZC1416-ARG1
      *----------  個別項目計算20.市場通貨その他費用(払出建時金額)
           MOVE  SJTK-ELS-HIYO-HTK       OF  PARM-SMZC1417-ARG2
             TO  SJTK-ELS-HIYO-HTK       OF  PARM-SMZC1416-ARG1
      *----------  個別項目計算20.運用通貨手数料(払出建時金額)
           MOVE  UYTK-TESRY-HIYO-HTK     OF  PARM-SMZC1417-ARG2
             TO  UYTK-TESRY-HIYO-HTK     OF  PARM-SMZC1416-ARG1
      *----------  個別項目計算20.運用通貨消費税(払出建時金額)
           MOVE  UYTK-SHOHI-TAX-HTK      OF  PARM-SMZC1417-ARG2
             TO  UYTK-SHOHI-TAX-HTK      OF  PARM-SMZC1416-ARG1
      *----------  個別項目計算20.運用通貨その他費用(払出建時金額)
           MOVE  UYTK-ELS-HIYO-HTK       OF  PARM-SMZC1417-ARG2
             TO  UYTK-ELS-HIYO-HTK       OF  PARM-SMZC1416-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ約定金額（市場通貨）=["
      D             S-KSG-TH-OP-YJKG     OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ約定金額（運用通貨）=["
      D             U-KSG-TH-OP-YJKG     OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算20.市場通貨手数料(払出建時金額)=["
      D             SJTK-TESRY-HIYO-HTK  OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算20.市場通貨消費税(払出建時金額)=["
      D             SJTK-SHOHI-TAX-HTK   OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算20.市場通貨その他費用(払出建時金額)=["
      D             SJTK-ELS-HIYO-HTK    OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算20.運用通貨手数料(払出建時金額)=["
      D             UYTK-TESRY-HIYO-HTK  OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算20.運用通貨消費税(払出建時金額)=["
      D             UYTK-SHOHI-TAX-HTK   OF  PARM-SMZC1416-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算20.運用通貨その他費用(払出建時金額)=["
      D             UYTK-ELS-HIYO-HTK    OF  PARM-SMZC1416-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１９【SMZC1416】をコールして、リターンパッケージを取得する
           CALL  "SMZC1416"              USING  PARM-SMZC1416-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1416)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-071
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１９  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１９ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1416-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算２１
      ******************************************************************
       SMZC1418-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算２１ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算２１【SMZC1418】に接続用パラメータの設定を行なう
      *----------  取引.現地手数料（市場通貨換算額）
           MOVE  WK-S-KSG-G-TSR          OF  WK-TORI-DATA
             TO  S-KSG-G-TSR             OF  PARM-SMZC1418-ARG1
      *----------  取引.現地消費税（市場通貨換算額）
           MOVE  WK-S-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-G-SHZ             OF  PARM-SMZC1418-ARG1
      *----------  取引.現地その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-G-THY          OF  WK-TORI-DATA
             TO  S-KSG-G-THY             OF  PARM-SMZC1418-ARG1
      *----------  取引.現地手数料（運用通貨換算額）
           MOVE  WK-U-KSG-G-TSR          OF  WK-TORI-DATA
             TO  U-KSG-G-TSR             OF  PARM-SMZC1418-ARG1
      *----------  取引.現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  PARM-SMZC1418-ARG1
      *----------  取引.現地その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-G-THY          OF  WK-TORI-DATA
             TO  U-KSG-G-THY             OF  PARM-SMZC1418-ARG1
      *----------  取引.運用国手数料（市場通貨換算額）
           MOVE  WK-S-KSG-U-TSR          OF  WK-TORI-DATA
             TO  S-KSG-U-TSR             OF  PARM-SMZC1418-ARG1
      *----------  取引.運用国消費税（市場通貨換算額）
           MOVE  WK-S-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-U-SHZ             OF  PARM-SMZC1418-ARG1
      *----------  取引.運用国その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-U-THY          OF  WK-TORI-DATA
             TO  S-KSG-U-THY             OF  PARM-SMZC1418-ARG1
      *----------  取引.運用国手数料（運用通貨換算額）
           MOVE  WK-U-KSG-U-TSR          OF  WK-TORI-DATA
             TO  U-KSG-U-TSR             OF  PARM-SMZC1418-ARG1
      *----------  取引.運用国消費税（運用通貨換算額）
           MOVE  WK-U-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-U-SHZ             OF  PARM-SMZC1418-ARG1
      *----------  取引.運用国その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-U-THY          OF  WK-TORI-DATA
             TO  U-KSG-U-THY             OF  PARM-SMZC1418-ARG1
      *----------  取引.日歩（市場通貨換算額）
           MOVE  WK-S-KSG-HIBU           OF  WK-TORI-DATA
             TO  S-KSG-HIBU              OF  PARM-SMZC1418-ARG1
      *----------  取引.逆日歩（市場通貨換算額）
           MOVE  WK-S-KSG-GHIBU          OF  WK-TORI-DATA
             TO  S-KSG-GHIBU             OF  PARM-SMZC1418-ARG1
      *----------  取引.管理費（市場通貨換算額）
           MOVE  WK-S-KSG-KRH            OF  WK-TORI-DATA
             TO  S-KSG-KRH               OF  PARM-SMZC1418-ARG1
      *----------  取引.管理費消費税（市場通貨換算額）
           MOVE  WK-S-KSG-KRH-SHZ        OF  WK-TORI-DATA
             TO  S-KSG-KRH-SHZ           OF  PARM-SMZC1418-ARG1
      *----------  取引.日歩（運用通貨換算額）
           MOVE  WK-U-KSG-HIBU           OF  WK-TORI-DATA
             TO  U-KSG-HIBU              OF  PARM-SMZC1418-ARG1
      *----------  取引.逆日歩（運用通貨換算額）
           MOVE  WK-U-KSG-GHIBU          OF  WK-TORI-DATA
             TO  U-KSG-GHIBU             OF  PARM-SMZC1418-ARG1
      *----------  取引.管理費（運用通貨換算額）
           MOVE  WK-U-KSG-KRH            OF  WK-TORI-DATA
             TO  U-KSG-KRH               OF  PARM-SMZC1418-ARG1
      *----------  取引.管理費消費税（運用通貨換算額）
           MOVE  WK-U-KSG-KRH-SHZ        OF  WK-TORI-DATA
             TO  U-KSG-KRH-SHZ           OF  PARM-SMZC1418-ARG1
      *----------  建時現地手数料（市場通貨）
           MOVE  WK-S-KSG-TH-G-TSR       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-TSR          OF  PARM-SMZC1418-ARG1
      *----------  建時現地消費税（市場通貨）
           MOVE  WK-S-KSG-TH-G-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-SHZ          OF  PARM-SMZC1418-ARG1
      *----------  建時現地その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-G-THY       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-THY          OF  PARM-SMZC1418-ARG1
      *----------  建時現地手数料（運用通貨）
           MOVE  WK-U-KSG-TH-G-TSR       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-TSR          OF  PARM-SMZC1418-ARG1
      *----------  建時現地消費税（運用通貨）
           MOVE  WK-U-KSG-TH-G-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-SHZ          OF  PARM-SMZC1418-ARG1
      *----------  建時現地その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-G-THY       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-THY          OF  PARM-SMZC1418-ARG1
      *----------  建時運用国手数料（市場通貨）
           MOVE  WK-S-KSG-TH-U-TSR       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-TSR          OF  PARM-SMZC1418-ARG1
      *----------  建時運用国消費税（市場通貨）
           MOVE  WK-S-KSG-TH-U-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-SHZ          OF  PARM-SMZC1418-ARG1
      *----------  建時運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-U-THY       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-THY          OF  PARM-SMZC1418-ARG1
      *----------  建時運用国手数料（運用通貨）
           MOVE  WK-U-KSG-TH-U-TSR       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-TSR          OF  PARM-SMZC1418-ARG1
      *----------  建時運用国消費税（運用通貨）
           MOVE  WK-U-KSG-TH-U-SHZ       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-SHZ          OF  PARM-SMZC1418-ARG1
      *----------  建時運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-U-THY       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-THY          OF  PARM-SMZC1418-ARG1
      *----------  手数料用売買損益に含むフラグ
           MOVE  WK-TESRY-BBSNEKI-FLG    OF  WK-SWK-KJN
             TO  TESRY-BBSNEKI-FLG       OF  PARM-SMZC1418-ARG1
      *----------  消費税用売買損益に含むフラグ
           MOVE  WK-SHOHI-TAX-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1418-ARG1
      *----------  その他費用用売買損益に含むフラグ
           MOVE  WK-ELS-HIYO-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  ELS-HIYO-BBSNEKI-FLG    OF  PARM-SMZC1418-ARG1
      *----------  日歩用売買損益に含むフラグ
           MOVE  WK-HIBU-BBSNEKI-FLG     OF  WK-SWK-KJN
             TO  HIBU-BBSNEKI-FLG        OF  PARM-SMZC1418-ARG1
      *----------  逆日歩用売買損益に含むフラグ
           MOVE  WK-GHIBU-BBSNEKI-FLG    OF  WK-SWK-KJN
             TO  GHIBU-BBSNEKI-FLG       OF  PARM-SMZC1418-ARG1
      *----------  管理費用売買損益に含むフラグ
           MOVE  WK-KRH-BBSNEKI-FLG      OF  WK-SWK-KJN
             TO  KRH-BBSNEKI-FLG         OF  PARM-SMZC1418-ARG1
      *----------  管理費消費税用売買損益に含むフラグ
           MOVE  WK-KRH-SHZ-BBSNEKI-FLG  OF  WK-SWK-KJN
             TO  KRH-SHZ-BBSNEKI-FLG     OF  PARM-SMZC1418-ARG1
      *----------  手数料を市場取得金額に含むフラグ
           MOVE  WK-TESRY-SJST-KN-FLG    OF  WK-SWK-KJN
             TO  TESRY-SJST-KN-FLG       OF  PARM-SMZC1418-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  WK-SHOHI-TAX-SJST-KN-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1418-ARG1
      *----------  その他費用を市場取得金額に含むフラグ
           MOVE  WK-ELS-HIYO-SJST-KN-FLG OF  WK-SWK-KJN
             TO  ELS-HIYO-SJST-KN-FLG    OF  PARM-SMZC1418-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（市場通貨換算額）=["
      D             S-KSG-G-TSR          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（市場通貨換算額）=["
      D             S-KSG-G-SHZ          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（市場通貨換算額）=["
      D             S-KSG-G-THY          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（運用通貨換算額）=["
      D             U-KSG-G-TSR          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（運用通貨換算額）=["
      D             U-KSG-G-THY          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国手数料（市場通貨換算額）=["
      D             S-KSG-U-TSR          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国消費税（市場通貨換算額）=["
      D             S-KSG-U-SHZ          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国その他費用（市場通貨換算額）"
      D             "=["S-KSG-U-THY      OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国手数料（運用通貨換算額）=["
      D             U-KSG-U-TSR          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国消費税（運用通貨換算額）=["
      D             U-KSG-U-SHZ          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国その他費用（運用通貨換算額）"
      D             "=["U-KSG-U-THY      OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.日歩（市場通貨換算額）=["
      D             S-KSG-HIBU           OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.逆日歩（市場通貨換算額）=["
      D             S-KSG-GHIBU          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.管理費（市場通貨換算額）=["
      D             S-KSG-KRH            OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.管理費消費税（市場通貨換算額）=["
      D             S-KSG-KRH-SHZ        OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.日歩（運用通貨換算額）=["
      D             U-KSG-HIBU           OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.逆日歩（運用通貨換算額）=["
      D             U-KSG-GHIBU          OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.管理費（運用通貨換算額）=["
      D             U-KSG-KRH            OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.管理費消費税（運用通貨換算額）=["
      D             U-KSG-KRH-SHZ        OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引データ"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（市場通貨）=["
      D             S-KSG-TH-G-TSR       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（市場通貨）=["
      D             S-KSG-TH-G-SHZ       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（市場通貨）=["
      D             S-KSG-TH-G-THY       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（運用通貨）=["
      D             U-KSG-TH-G-TSR       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（運用通貨）=["
      D             U-KSG-TH-G-SHZ       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（運用通貨）=["
      D             U-KSG-TH-G-THY       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（市場通貨）=["
      D             S-KSG-TH-U-TSR       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（市場通貨）=["
      D             S-KSG-TH-U-SHZ       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（市場通貨）=["
      D             S-KSG-TH-U-THY       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（運用通貨）=["
      D             U-KSG-TH-U-TSR       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（運用通貨）=["
      D             U-KSG-TH-U-SHZ       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（運用通貨）=["
      D             U-KSG-TH-U-THY       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ        =["
      D             TESRY-BBSNEKI-FLG    OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG  OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ    =["
      D             ELS-HIYO-BBSNEKI-FLG  OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":日歩用売買損益に含むフラグ          =["
      D             HIBU-BBSNEKI-FLG      OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩用売買損益に含むフラグ        =["
      D             GHIBU-BBSNEKI-FLG     OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費用売買損益に含むフラグ        =["
      D             KRH-BBSNEKI-FLG       OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税用売買損益に含むフラグ  =["
      D             KRH-SHZ-BBSNEKI-FLG   OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含むフラグ    =["
      D             TESRY-SJST-KN-FLG     OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG OF  PARM-SMZC1418-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含むフラグ=["
      D             ELS-HIYO-SJST-KN-FLG  OF  PARM-SMZC1418-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算２１【SMZC1418】をコールして、リターンパッケージを取得する
           CALL  "SMZC1418"              USING  PARM-SMZC1418-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1418)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-072
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算２１  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算２１ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1418-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算２２
      ******************************************************************
       SMZC1419-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算２２ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算２２【SMZC1419】に接続用パラメータの設定を行なう
      *----------  取引データ.運用国消費税（運用通貨換算額）
           MOVE  WK-U-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-U-SHZ             OF  PARM-SMZC1419-ARG1
      *----------  取引データ.現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  U-KSG-G-SHZ             OF  PARM-SMZC1419-ARG1
      *----------  取引データ.現地消費税（市場通貨換算額）
           MOVE  WK-S-KSG-G-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-G-SHZ             OF  PARM-SMZC1419-ARG1
      *----------  取引データ.運用国消費税（市場通貨換算額）
           MOVE  WK-S-KSG-U-SHZ          OF  WK-TORI-DATA
             TO  S-KSG-U-SHZ             OF  PARM-SMZC1419-ARG1
      *----------  消費税用売買損益に含むフラグ
           MOVE  WK-SHOHI-TAX-BBSNEKI-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1419-ARG1
      *----------  消費税を市場取得金額に含むフラグ
           MOVE  WK-SHOHI-TAX-SJST-KN-FLG
             OF  WK-SWK-KJN
             TO  SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1419-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国消費税（運用通貨換算額"
      D             "）=["U-KSG-U-SHZ    OF  PARM-SMZC1419-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地消費税（運用通貨換算額"
      D             "）=["U-KSG-G-SHZ    OF  PARM-SMZC1419-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地消費税（市場通貨換算額）"
      D             "=["S-KSG-G-SHZ      OF  PARM-SMZC1419-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国消費税（市場通貨換算額"
      D             "）=["S-KSG-U-SHZ    OF  PARM-SMZC1419-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ        =["
      D             SHOHI-TAX-BBSNEKI-FLG   OF  PARM-SMZC1419-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含むフラグ    =["
      D             SHOHI-TAX-SJST-KN-FLG   OF  PARM-SMZC1419-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨コード                      =["
      D             CAPITAL-TUKA-CD         OF  PARM-SMZC1419-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード                      =["
      D             SIJO-TUKA-CD            OF  PARM-SMZC1419-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)【SMZC1419】異動計算-個別項目計算２２をコールして、リターンパッケージを取得する
           CALL  "SMZC1419"              USING  PARM-SMZC1419-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1419)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-099
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算２２  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算２２ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1419-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1951簿価計算をコールする
      ******************************************************************
       SMZC1951-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** SMZC1951簿価計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1951】簿価計算コールに接続用パラメータの設定を行なう
      *----------  簿価計算方法
           MOVE  WK-BOKA-CALC-HOU       OF  WK-CALC-PTN
             TO  BOKA-CALC-HOU          OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":簿価計算方法=["
      D             BOKA-CALC-HOU        OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.c01通貨フラグ＝'1'の場合
           IF  WK-TUKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  通貨デフォールト端数処理
             MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
               TO  TUKA-DEF-HASU-SYRI-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c02異動計算フラグ＝'1'の場合
           IF  WK-IDO-CALC-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  払出簿価計算方法
             MOVE  WK-DEBET-BOKA-CALC-HOU
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1951-ARG1
      *----------  払出簿価端数（市場通貨）
             MOVE  WK-DEBET-BOKA-HASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-HASU-BC   OF  PARM-SMZC1951-ARG1
      *----------  払出単価桁数（市場通貨）
             MOVE  WK-DEBET-TNK-KETASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-KETASU-BC  OF  PARM-SMZC1951-ARG1
      *----------  払出単価端数（市場通貨）
             MOVE  WK-DEBET-TNK-HASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-HASU-BC    OF  PARM-SMZC1951-ARG1
      *----------  払出簿価端数（運用通貨）
             MOVE  WK-DEBET-BOKA-HASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-HASU-LC   OF  PARM-SMZC1951-ARG1
      *----------  払出単価桁数（運用通貨）
             MOVE  WK-DEBET-TNK-KETASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-KETASU-LC  OF  PARM-SMZC1951-ARG1
      *----------  払出単価端数（運用通貨）
             MOVE  WK-DEBET-TNK-HASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-HASU-LC    OF  PARM-SMZC1951-ARG1
      *----------  簿価為替レート適用フラグ
             MOVE  WK-BOKA-KWS-TEKIYO-FLG
               OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1951-ARG1
      *----------  簿価為替レート端数
             MOVE  WK-BOKA-KWS-HASU     OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-HASU        OF  PARM-SMZC1951-ARG1
      *----------  簿価為替レート桁数
             MOVE  WK-BOKA-KWS-KETASU   OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-KETASU      OF  PARM-SMZC1951-ARG1
      *----------  按分簿価端数
             MOVE  WK-ANB-BOKA-HASU     OF  WK-YIDOU-CALC-PARM
               TO  ANB-BOKA-HASU        OF  PARM-SMZC1951-ARG1
      *----------  按分単価端数
             MOVE  WK-ANB-TNK-HASU      OF  WK-YIDOU-CALC-PARM
               TO  ANB-TNK-HASU         OF  PARM-SMZC1951-ARG1
      *----------  按分単価桁数
             MOVE  WK-ANB-TNK-KETASU    OF  WK-YIDOU-CALC-PARM
               TO  ANB-TNK-KETASU       OF  PARM-SMZC1951-ARG1
      *----------  前払金償却分端数
             MOVE  WK-MAEKIN-SHOUKYK-HASU
               OF  WK-YIDOU-CALC-PARM
               TO  MAEKIN-SHOUKYK-HASU  OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価計算方法=["
      D             DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（市場通貨"
      D             "）=["DEBET-BOKA-HASU-BC  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（市場通貨"
      D             "）=["DEBET-TNK-KETASU-BC  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（市場通貨"
      D             "）=["DEBET-TNK-HASU-BC  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（運用通貨"
      D             "）=["DEBET-BOKA-HASU-LC  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（運用通貨"
      D             "）=["DEBET-TNK-KETASU-LC  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（運用通貨"
      D             "）=["DEBET-TNK-HASU-LC  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート適用フラ"
      D             "グ=["BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート端数=["
      D             BOKA-KWS-HASU        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート桁数=["
      D             BOKA-KWS-KETASU      OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分簿価端数=["
      D             ANB-BOKA-HASU        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価端数=["
      D             ANB-TNK-HASU         OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価桁数=["
      D             ANB-TNK-KETASU       OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.前払金償却分端数=["
      D             MAEKIN-SHOUKYK-HASU  OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-BOKAZN      OF  TYOKUZEN-ZANDAKA-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前の残高異動.市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-BOKAZN      OF  TYOKUZEN-ZANDAKA-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前の残高異動.異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-TZ-ZN-IDO
               TO  IDOG-SRYZN            OF  TYOKUZEN-ZANDAKA-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前の残高異動.市場通貨簿価単価
             MOVE  WK-SJTK-BOKA-TNK      OF  WK-TZ-ZN-IDO
               TO  SJTK-BOKA-TNK         OF  PARM-SMZC1951-ARG1
      *----------  直前の残高異動.運用通貨簿価単価
             MOVE  WK-UYTK-BOKA-TNK      OF  WK-TZ-ZN-IDO
               TO  UYTK-BOKA-TNK         OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後簿価残高=["
      D             UYTK-IDOG-BOKAZN     OF  TYOKUZEN-ZANDAKA-IDO-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後簿価残高=["
      D             SJTK-IDOG-BOKAZN     OF  TYOKUZEN-ZANDAKA-IDO-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.異動後数量残高        =["
      D             IDOG-SRYZN           OF  TYOKUZEN-ZANDAKA-IDO-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨簿価単価      =["
      D             SJTK-BOKA-TNK        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨簿価単価      =["
      D             UYTK-BOKA-TNK        OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b02直前親株残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-O-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b02直前親株残高"
      D             "異動フラグ=["WK-CHOKZ-O-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前親株の残高異動.市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-CHOKZ-O-ZADAKA-IDOU
               TO  SJTK-IDOG-BOKAZN      OF  TYOKUZEN-OKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前親株の残高異動.運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-CHOKZ-O-ZADAKA-IDOU
               TO  UYTK-IDOG-BOKAZN      OF  TYOKUZEN-OKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前親株の残高異動.異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-CHOKZ-O-ZADAKA-IDOU
               TO  IDOG-SRYZN            OF  TYOKUZEN-OKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前親株の残高異動.市場通貨コード
             MOVE  WK-SIJO-TUKA-CD       OF  WK-CHOKZ-O-ZADAKA-IDOU
               TO  SIJO-TUKA-CD          OF  TYOKUZEN-OKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前親株の残高異動.数量単位
             MOVE  WK-SURYO-TANI         OF  WK-CHOKZ-O-ZADAKA-IDOU
               TO  SURYO-TANI            OF  TYOKUZEN-OKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.市場通貨異動後簿価残"
      D             "高=["SJTK-IDOG-BOKAZN  OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D              OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.運用通貨異動後簿価残"
      D             "高=["UYTK-IDOG-BOKAZN  OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D              OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.異動後数量残高=["
      D             IDOG-SRYZN              OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.市場通貨コード=["
      D             SIJO-TUKA-CD            OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前親株の残高異動.数量単位=["
      D             SURYO-TANI              OF  TYOKUZEN-OKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b02直前親株残高"
      D             "異動フラグ=["WK-CHOKZ-O-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b06直前新株残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-S-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b06直前新株残高"
      D             "異動フラグ=["WK-CHOKZ-S-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前新株の残高異動.市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-CHOKZ-S-ZADAKA-IDOU
               TO  SJTK-IDOG-BOKAZN      OF  TYOKUZEN-SKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前新株の残高異動.運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-CHOKZ-S-ZADAKA-IDOU
               TO  UYTK-IDOG-BOKAZN      OF  TYOKUZEN-SKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  直前新株の残高異動.異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-CHOKZ-S-ZADAKA-IDOU
               TO  IDOG-SRYZN            OF  TYOKUZEN-SKB-ZN-IDO-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前新株の残高異動.市場通貨異動後簿価残"
      D             "高=["SJTK-IDOG-BOKAZN  OF  TYOKUZEN-SKB-ZN-IDO-PARM
      D              OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前新株の残高異動.運用通貨異動後簿価残"
      D             "高=["UYTK-IDOG-BOKAZN  OF  TYOKUZEN-SKB-ZN-IDO-PARM
      D              OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前新株の残高異動.異動後数量残高=["
      D             IDOG-SRYZN              OF  TYOKUZEN-SKB-ZN-IDO-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b06直前新株残高"
      D             "異動フラグ=["WK-CHOKZ-S-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d01数量計算結果フラグ＝'1'の場合
           IF  WK-SURYO-CALC-KEKKA-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d01数量計算結果"
      D             "フラグ=["WK-SURYO-CALC-KEKKA-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-SURYO-CALC-KEKKA
               TO  IDOG-SRYZN            OF  ZN-IDO-DATA-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  異動数量
             MOVE  WK-IDO-SURYO          OF  WK-SURYO-CALC-KEKKA
               TO  IDO-SURYO             OF  ZN-IDO-DATA-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動後数量残高=["IDOG-SRYZN   OF
      D             ZN-IDO-DATA-PARM  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動数量      =["IDO-SURYO    OF
      D             ZN-IDO-DATA-PARM     OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d01数量計算結果"
      D             "フラグ=["WK-SURYO-CALC-KEKKA-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e05個別計算５フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-5-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e05個別計算５"
      D             "フラグ=["WK-KOBETSU-CALC-5-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨払出簿価
             MOVE  UYTK-DEBET-BOKA       OF  PARM-SMZC1402-ARG2
               TO  UYTK-H-BOKA           OF  KOBETSU-KOMK-CALC-5-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  市場通貨払出簿価
             MOVE  SJTK-DEBET-BOKA       OF  PARM-SMZC1402-ARG2
               TO  SJTK-H-BOKA           OF  KOBETSU-KOMK-CALC-5-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  運用通貨払出単価
             MOVE  UYTK-DEBET-TNK        OF  PARM-SMZC1402-ARG2
               TO  UYTK-H-TNK            OF  KOBETSU-KOMK-CALC-5-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  市場通貨払出単価
             MOVE  SJTK-DEBET-TNK        OF  PARM-SMZC1402-ARG2
               TO  SJTK-H-TNK            OF  KOBETSU-KOMK-CALC-5-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価=["
      D             UYTK-H-BOKA          OF  KOBETSU-KOMK-CALC-5-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価=["
      D             SJTK-H-BOKA          OF  KOBETSU-KOMK-CALC-5-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価=["
      D             UYTK-H-TNK           OF  KOBETSU-KOMK-CALC-5-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価=["
      D             SJTK-H-TNK           OF  KOBETSU-KOMK-CALC-5-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e05個別計算５"
      D             "フラグ=["WK-KOBETSU-CALC-5-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e06個別計算６フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-6-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e06個別計算６"
      D             "フラグ=["WK-KOBETSU-CALC-6-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨払出簿価
             MOVE  UYTK-DEBET-BOKA       OF  PARM-SMZC1403-ARG2
               TO  UYTK-H-BOKA           OF  KOBETSU-KOMK-CALC-6-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  市場通貨払出簿価
             MOVE  SJTK-DEBET-BOKA       OF  PARM-SMZC1403-ARG2
               TO  SJTK-H-BOKA           OF  KOBETSU-KOMK-CALC-6-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  運用通貨払出単価
             MOVE  UYTK-DEBET-TNK        OF  PARM-SMZC1403-ARG2
               TO  UYTK-H-TNK            OF  KOBETSU-KOMK-CALC-6-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  市場通貨払出単価
             MOVE  SJTK-DEBET-TNK        OF  PARM-SMZC1403-ARG2
               TO  SJTK-H-TNK            OF  KOBETSU-KOMK-CALC-6-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価=["
      D             UYTK-H-BOKA          OF  KOBETSU-KOMK-CALC-6-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価=["
      D             SJTK-H-BOKA          OF  KOBETSU-KOMK-CALC-6-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価=["
      D             UYTK-H-TNK           OF  KOBETSU-KOMK-CALC-6-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価=["
      D             SJTK-H-TNK           OF  KOBETSU-KOMK-CALC-6-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e06個別計算６"
      D             "フラグ=["WK-KOBETSU-CALC-6-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e07個別計算７フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-7-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e07個別計算７"
      D             "フラグ=["WK-KOBETSU-CALC-7-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨売買金額
             MOVE  UYTK-BS-KN            OF  PARM-SMZC1404-ARG2
               TO  UYTK-BS-KN            OF  KOBETSU-KOMK-CALC-7-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  市場通貨売買金額
             MOVE  SJTK-BS-KN            OF  PARM-SMZC1404-ARG2
               TO  SJTK-BS-KN            OF  KOBETSU-KOMK-CALC-7-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨売買金額=["
      D             UYTK-BS-KN           OF  KOBETSU-KOMK-CALC-7-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買金額=["
      D             SJTK-BS-KN           OF  KOBETSU-KOMK-CALC-7-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e07個別計算７"
      D             "フラグ=["WK-KOBETSU-CALC-7-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e08個別計算８フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-8-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e08個別計算８"
      D             "フラグ=["WK-KOBETSU-CALC-8-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨売買金額
             MOVE  UYTK-BS-KN            OF  PARM-SMZC1405-ARG2
               TO  UYTK-BS-KN            OF  KOBETSU-KOMK-CALC-8-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  市場通貨売買金額
             MOVE  SJTK-BS-KN            OF  PARM-SMZC1405-ARG2
               TO  SJTK-BS-KN            OF  KOBETSU-KOMK-CALC-8-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨売買金額=["
      D             UYTK-BS-KN           OF  KOBETSU-KOMK-CALC-8-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買金額=["
      D             SJTK-BS-KN          OF  KOBETSU-KOMK-CALC-8-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e08個別計算８"
      D             "フラグ=["WK-KOBETSU-CALC-8-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e13個別計算１３フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-13-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e13個別計算１３"
      D             "フラグ=["WK-KOBETSU-CALC-13-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨簿価異動（親株）
             MOVE  SJTK-BOKA-IDO-OKB     OF  PARM-SMZC1410-ARG2
               TO  SJTK-IDO-BOKA-OKB     OF  PARM-SMZC1951-ARG1
      *----------  運用通貨簿価異動（親株）
             MOVE  UYTK-BOKA-IDO-OKB     OF  PARM-SMZC1410-ARG2
               TO  UYTK-IDO-BOKA-OKB     OF  PARM-SMZC1951-ARG1
      *----------  市場通貨簿価異動（新株）
             MOVE  SJTK-BOKA-IDO-SKB     OF  PARM-SMZC1410-ARG2
               TO  SJTK-IDO-BOKA-SKB     OF  PARM-SMZC1951-ARG1
      *----------  運用通貨簿価異動（新株）
             MOVE  UYTK-BOKA-IDO-SKB     OF  PARM-SMZC1410-ARG2
               TO  UYTK-IDO-BOKA-SKB     OF  PARM-SMZC1951-ARG1
      *----------  市場通貨異動後簿価残高（親株）
             MOVE  SJTK-IDOG-BOKAZN-OKB  OF  PARM-SMZC1410-ARG2
               TO  SJTK-IDOG-BOKAZN-OKB  OF  PARM-SMZC1951-ARG1
      *----------  運用通貨異動後簿価残高（親株）
             MOVE  UYTK-IDOG-BOKAZN-OKB  OF  PARM-SMZC1410-ARG2
               TO  UYTK-IDOG-BOKAZN-OKB  OF  PARM-SMZC1951-ARG1
      *----------  市場通貨異動後簿価残高（新株）
             MOVE  SJTK-IDOG-BOKAZN-SKB  OF  PARM-SMZC1410-ARG2
               TO  SJTK-IDOG-BOKAZN-SKB  OF  PARM-SMZC1951-ARG1
      *----------  運用通貨異動後簿価残高（新株）
             MOVE  UYTK-IDOG-BOKAZN-SKB  OF  PARM-SMZC1410-ARG2
               TO  UYTK-IDOG-BOKAZN-SKB  OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価異動（親株）=["
      D             SJTK-IDO-BOKA-OKB     OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価異動（親株）=["
      D             UYTK-IDO-BOKA-OKB     OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価異動（新株）=["
      D             SJTK-IDO-BOKA-SKB     OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価異動（新株）=["
      D             UYTK-IDO-BOKA-SKB     OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高（親株）=["
      D             SJTK-IDOG-BOKAZN-OKB  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高（親株）=["
      D             UYTK-IDOG-BOKAZN-OKB  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高（新株）=["
      D             SJTK-IDOG-BOKAZN-SKB  OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高（新株）=["
      D             UYTK-IDOG-BOKAZN-SKB  OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e13個別計算１３"
      D             "フラグ=["WK-KOBETSU-CALC-13-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e14個別計算１４フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-14-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e14個別計算１４"
      D             "フラグ=["WK-KOBETSU-CALC-14-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨売買金額
             MOVE  BC-BS-KN              OF  PARM-SMZC1411-ARG2
               TO  SJTK-BS-KN            OF  KOBETSU-KOMK-CALC-14-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  運用通貨売買金額
             MOVE  LC-BS-KN              OF  PARM-SMZC1411-ARG2
               TO  UYTK-BS-KN            OF  KOBETSU-KOMK-CALC-14-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨売買金額=["
      D             SJTK-BS-KN           OF  KOBETSU-KOMK-CALC-14-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨売買金額=["
      D             UYTK-BS-KN           OF  KOBETSU-KOMK-CALC-14-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e14個別計算１４"
      D             "フラグ=["WK-KOBETSU-CALC-14-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e19個別計算１９フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-19-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e19個別計算１９"
      D             "フラグ=["WK-KOBETSU-CALC-19-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨払出建時金額
             MOVE  SJTK-HDA-DTJI-KN      OF  PARM-SMZC1416-ARG2
               TO  SJTK-HDA-DTJI-KN      OF  KOBETSU-KOMK-CALC-19-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  運用通貨払出建時金額
             MOVE  UYTK-HDA-DTJI-KN      OF  PARM-SMZC1416-ARG2
               TO  UYTK-HDA-DTJI-KN      OF  KOBETSU-KOMK-CALC-19-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨払出建時金額=["
      D             SJTK-HDA-DTJI-KN    OF  KOBETSU-KOMK-CALC-19-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出建時金額=["
      D             UYTK-HDA-DTJI-KN     OF  KOBETSU-KOMK-CALC-19-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e19個別計算１９"
      D             "フラグ=["WK-KOBETSU-CALC-19-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *---------- 運用通貨予備売買金額←ワーク運用通貨予備売買金額
           MOVE  WK-UYTK-YOBI-BS-KN
             TO  UYTK-YOBI-BS-KN         OF  PARM-SMZC1951-ARG1
      *---------- 市場通貨予備売買金額←ワーク市場通貨予備売買金額
           MOVE  WK-SJTK-YOBI-BS-KN
             TO  SJTK-YOBI-BS-KN         OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨予備売買金額=["
      D             UYTK-YOBI-BS-KN      OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨予備売買金額=["
      D             SJTK-YOBI-BS-KN      OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG    OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ"
      D             "=["WK-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引.約定金額（市場通貨換算額)
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  TORI-HIKI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  取引.約定金額（運用通貨換算額)
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  TORI-HIKI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  取引.既経過利息（市場通貨換算額）
             MOVE  WK-S-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  S-KSG-G-KKKRS         OF  TORI-HIKI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  取引.既経過利息（運用通貨換算額）
             MOVE  WK-U-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  U-KSG-G-KKKRS         OF  TORI-HIKI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  取引.調整損益
             MOVE  WK-CHOSEI-SNEKI       OF  WK-TORI-DATA
               TO  CHOSEI-SNEKI          OF  TORI-HIKI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  取引.数量単位
             MOVE  WK-SURYO-TANI         OF  WK-TORI-DATA
               TO  SURYO-TANI            OF  TORI-HIKI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  取引.取引事由
             MOVE  WK-TORI-JIYU          OF  WK-TORI-DATA
               TO  TORI-JIYU             OF  TORI-HIKI-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額)=["
      D             S-KSG-G-YJKG         OF  TORI-HIKI-PARM
      D        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額)=["
      D             U-KSG-G-YJKG         OF  TORI-HIKI-PARM
      D        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.既経過利息（市場通貨換算額）=["
      D             S-KSG-G-KKKRS        OF  TORI-HIKI-PARM
      D        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.既経過利息（運用通貨換算額）=["
      D             U-KSG-G-KKKRS        OF  TORI-HIKI-PARM
      D        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.調整損益=["
      D             CHOSEI-SNEKI         OF  TORI-HIKI-PARM
      D        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.数量単位=["
      D             SURYO-TANI           OF  TORI-HIKI-PARM
      D        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.取引事由=["
      D             TORI-JIYU            OF  TORI-HIKI-PARM
      D        OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ"
      D             "=["WK-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a03親株取引フラグ＝'1'の場合
           IF  WK-O-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a03親株取引"
      D             "フラグ=["WK-O-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  異動数量
             MOVE  WK-IDO-SURYO          OF  WK-OKB-TORI-PARM
               TO  IDO-SURYO             OF  OKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  精算金額(市場通貨換算額)
             MOVE  WK-S-KSG-SSKG         OF  WK-OKB-TORI-PARM
               TO  S-KSG-SSKG            OF  OKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  精算金額(運用通貨換算額)
             MOVE  WK-U-KSG-G-SSKG       OF  WK-OKB-TORI-PARM
               TO  U-KSG-G-SSKG          OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動数量=["IDO-SURYO  OF
      D             OKB-TORI-PARM        OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":精算金額(市場通貨換算額)=["
      D             S-KSG-SSKG           OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":精算金額(運用通貨換算額)=["
      D             U-KSG-G-SSKG         OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a03親株取引"
      D             "フラグ=["WK-O-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a04新株取引フラグ＝'1'の場合
           IF  WK-N-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a04新株取引"
      D             "フラグ=["WK-N-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  異動数量
             MOVE  WK-IDO-SURYO          OF  WK-SKB-TORI-PARM
               TO  IDO-SURYO             OF  SKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  約定単価
             MOVE  WK-YKJ-TANKA          OF  WK-SKB-TORI-PARM
               TO  YKJ-TANKA             OF  SKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  為替レート（市場／運用）
             MOVE  WK-K-S-U-KWS          OF  WK-SKB-TORI-PARM
               TO  S-U-KWS               OF  SKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-SKB-TORI-PARM
               TO  S-KSG-G-YJKG          OF  SKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-SKB-TORI-PARM
               TO  U-KSG-G-YJKG          OF  SKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  市場通貨コード
             MOVE  WK-SIJO-TUKA-CD       OF  WK-SKB-TORI-PARM
               TO  SIJO-TUKA-CD          OF  SKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *----------  数量単位
             MOVE  WK-SURYO-TANI         OF  WK-SKB-TORI-PARM
               TO  SURYO-TANI            OF  SKB-TORI-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動数量=["IDO-SURYO  OF  SKB-TORI-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定単価=["YKJ-TANKA  OF  SKB-TORI-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":為替レート（市場／運用）=["S-U-KWS
      D             OF  SKB-TORI-PARM    OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG         OF  SKB-TORI-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG         OF  SKB-TORI-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             SIJO-TUKA-CD         OF  SKB-TORI-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":数量単位=["
      D             SURYO-TANI           OF  SKB-TORI-PARM
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a04新株取引"
      D             "フラグ=["WK-N-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c05仕訳パターン分析フラグ＝'1'の場合
           IF  WK-SWK-PATTERN-BUNSEKI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":【SMZJ1916】.ARG2.簿価仕訳フラグ=["
      D             BOKA-SWK-FLG         OF  PARM-SMZJ1916-ARG2"]"
      *-----------------------------------------------------------------
      *----------  仕訳フラグ
             MOVE  BOKA-SWK-FLG          OF  PARM-SMZJ1916-ARG2
               TO  SWK-FLG               OF  SWK-PATTERN-BUNSEKI-PARM
               OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":仕訳フラグ=["SWK-FLG
      D             OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  取引異動データ.市場通貨払出簿価
           MOVE  WK-SJTK-H-BOKA         OF  WK-TORI-IDO
             TO  SJTK-H-BOKA            OF  TORI-HIKI-IDO-PARM
                                        OF  PARM-SMZC1951-ARG1
      *----------  取引異動データ.運用通貨払出簿価
           MOVE  WK-UYTK-H-BOKA         OF  WK-TORI-IDO
             TO  UYTK-H-BOKA            OF  TORI-HIKI-IDO-PARM
                                        OF  PARM-SMZC1951-ARG1
      *---------- 市場通貨簿価指定フラグ
           MOVE  WK-SJTK-BOKA-SITEI-FLG
             TO  SJTK-BOKA-SITEI-FLG     OF  PARM-SMZC1951-ARG1
      *---------- 運用通貨簿価指定フラグ
           MOVE  WK-UYTK-BOKA-SITEI-FLG
             TO  UYTK-BOKA-SITEI-FLG     OF  PARM-SMZC1951-ARG1
      *---------- 相手存在フラグ
           MOVE  WK-AITE-SONZAI-FLG
             TO  AITE-SONZAI-FLG         OF  PARM-SMZC1951-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動データ.市場通貨払出簿価 = ["
      D    SJTK-H-BOKA  OF TORI-HIKI-IDO-PARM OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引異動データ.運用通貨払出簿価 = ["
      D    UYTK-H-BOKA  OF TORI-HIKI-IDO-PARM OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価指定フラグ          = ["
      D             SJTK-BOKA-SITEI-FLG       OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価指定フラグ          = ["
      D             UYTK-BOKA-SITEI-FLG       OF  PARM-SMZC1951-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相手存在フラグ                  = ["
      D             AITE-SONZAI-FLG           OF  PARM-SMZC1951-ARG1"]"
      *-----------------------------------------------------------------
      *---------- ②【SMZC1951】簿価計算コールをコールして、リターンパッケージを取得する
           CALL  "SMZC1951"              USING  PARM-SMZC1951-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1951)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク簿価計算結果を初期化
             INITIALIZE  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果=["
      D             WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  B)残高項目を初期化
      *----------  ワーク簿価計算結果.運用通貨異動後簿価残高←ARG1.直前残高異動.運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  WK-UYTK-IDOG-BOKAZN   OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.運用通貨異動後簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨異動後簿価残高←ARG1.直前残高異動.市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  WK-SJTK-IDOG-BOKAZN   OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.市場通貨異動後簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨簿価単価←ARG1.直前残高異動.運用通貨簿価単価
             MOVE  WK-UYTK-BOKA-TNK      OF  WK-TZ-ZN-IDO
               TO  WK-UYTK-BOKA-TNK      OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.運用通貨簿価単価=["
      D             WK-UYTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨簿価単価←ARG1.直前残高異動.市場通貨簿価単価
             MOVE  WK-SJTK-BOKA-TNK      OF  WK-TZ-ZN-IDO
               TO  WK-SJTK-BOKA-TNK      OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.市場通貨簿価単価=["
      D             WK-SJTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.運用通貨異動簿価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDO-BOKA  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF UYTK-IDO-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨異動簿価←リターンパッケージ.運用通貨異動簿価.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDO-BOKA
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-IDO-BOKA    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨異動簿価=["
      D             WK-UYTK-IDO-BOKA     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF UYTK-IDO-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動簿価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDO-BOKA  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF SJTK-IDO-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨異動簿価←リターンパッケージ.市場通貨異動簿価.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDO-BOKA
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-IDO-BOKA    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨異動簿価=["
      D             WK-SJTK-IDO-BOKA     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF SJTK-IDO-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨異動簿価(親株).編集フラグ＝'1'AND ワークC/A位置付けフラグ＝'1'(分割元)の場合
             IF  EDIT-FLG  OF  UYTK-IDO-BOKA-OKB  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
               AND WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.運用通貨異動簿価(親株).編集フラグ=["
      D    EDIT-FLG OF UYTK-IDO-BOKA-OKB     OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨異動簿価←リターンパッケージ.運用通貨異動簿価(親株).バリュー
               MOVE  OUT-VALUES              OF  UYTK-IDO-BOKA-OKB
                                             OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-IDO-BOKA        OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨異動簿価=["
      D             WK-UYTK-IDO-BOKA         OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.運用通貨異動簿価(親株).編集フラグ=["
      D    EDIT-FLG OF UYTK-IDO-BOKA-OKB     OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動簿価(親株).編集フラグ＝'1'AND ワークC/A位置付けフラグ＝'1'(分割元)の場合
             IF  EDIT-FLG  OF  SJTK-IDO-BOKA-OKB  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
               AND WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.市場通貨異動簿価(親株).編集フラグ=["
      D    EDIT-FLG OF SJTK-IDO-BOKA-OKB     OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨異動簿価←リターンパッケージ.市場通貨異動簿価(親株).バリュー
               MOVE  OUT-VALUES              OF  SJTK-IDO-BOKA-OKB
                                             OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-IDO-BOKA        OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨異動簿価=["
      D             WK-SJTK-IDO-BOKA         OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.市場通貨異動簿価(親株).編集フラグ=["
      D    EDIT-FLG OF SJTK-IDO-BOKA-OKB     OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨異動簿価(新株).編集フラグ＝'1'AND ワークC/A位置付けフラグ＝'2'(分割先)の場合
             IF  EDIT-FLG  OF  UYTK-IDO-BOKA-SKB  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
               AND WK-CA-POS-FLG = CNS-BUNKATSUSEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.運用通貨異動簿価(新株).編集フラグ=["
      D    EDIT-FLG OF UYTK-IDO-BOKA-SKB     OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨異動簿価←リターンパッケージ.運用通貨異動簿価(新株).バリュー
               MOVE  OUT-VALUES              OF  UYTK-IDO-BOKA-SKB
                                             OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-IDO-BOKA        OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨異動簿価=["
      D             WK-UYTK-IDO-BOKA         OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.運用通貨異動簿価(新株).編集フラグ=["
      D    EDIT-FLG OF UYTK-IDO-BOKA-SKB OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動簿価(新株).編集フラグ＝'1'AND ワークC/A位置付けフラグ＝'2'(分割先)の場合
             IF  EDIT-FLG  OF  SJTK-IDO-BOKA-SKB  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
               AND WK-CA-POS-FLG = CNS-BUNKATSUSEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.市場通貨異動簿価(新株).編集フラグ=["
      D    EDIT-FLG OF SJTK-IDO-BOKA-SKB OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨異動簿価←リターンパッケージ.市場通貨異動簿価(新株).バリュー
               MOVE  OUT-VALUES               OF  SJTK-IDO-BOKA-SKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-IDO-BOKA         OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨異動簿価=["
      D             WK-SJTK-IDO-BOKA          OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.市場通貨異動簿価(新株).編集フラグ=["
      D    EDIT-FLG OF SJTK-IDO-BOKA-SKB OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワークC/A位置付けフラグ=["
      D             WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨異動後簿価残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-BOKAZN  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨異動後簿価残高.編集フラグ=["
      D            EDIT-FLG OF UYTK-IDOG-BOKAZN OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨異動後簿価残高←リターンパッケージ.運用通貨異動後簿価残高.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-BOKAZN
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-IDOG-BOKAZN
                 OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.運用通貨異動後簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨異動後簿価残高.編集フラグ=["
      D            EDIT-FLG OF UYTK-IDOG-BOKAZN OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後簿価残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-BOKAZN  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨異動後簿価残高.編集フラグ=["
      D            EDIT-FLG OF SJTK-IDOG-BOKAZN OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨異動後簿価残高←リターンパッケージ.市場通貨異動後簿価残高.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-BOKAZN
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-IDOG-BOKAZN
                 OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.市場通貨異動後簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨異動後簿価残高.編集フラグ=["
      D            EDIT-FLG OF SJTK-IDOG-BOKAZN OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨簿価単価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-BOKA-TNK  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨簿価単価.編集フラグ=["
      D             EDIT-FLG OF UYTK-BOKA-TNK OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨簿価単価←リターンパッケージ.運用通貨簿価単価.バリュー
               MOVE  OUT-VALUES          OF  UYTK-BOKA-TNK
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-BOKA-TNK    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨簿価単価=["
      D             WK-UYTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨簿価単価.編集フラグ=["
      D             EDIT-FLG OF UYTK-BOKA-TNK OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨簿価単価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-BOKA-TNK  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨簿価単価.編集フラグ=["
      D             EDIT-FLG OF SJTK-BOKA-TNK OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨簿価単価←リターンパッケージ.市場通貨簿価単価.バリュー
               MOVE  OUT-VALUES          OF  SJTK-BOKA-TNK
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-BOKA-TNK    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨簿価単価=["
      D             WK-SJTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨簿価単価.編集フラグ=["
      D             EDIT-FLG OF SJTK-BOKA-TNK OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨払出簿価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-H-BOKA  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨払出簿価.編集フラグ=["
      D             EDIT-FLG OF UYTK-H-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨払出簿価←リターンパッケージ.運用通貨払出簿価.バリュー
               MOVE  OUT-VALUES          OF  UYTK-H-BOKA
                 OF  PARM-SMZC1951-ARG2
                 TO   WK-UYTK-H-BOKA     OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨払出簿価=["
      D             WK-UYTK-H-BOKA       OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨払出簿価.編集フラグ=["
      D             EDIT-FLG OF UYTK-H-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨払出簿価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-H-BOKA  OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨払出簿価.編集フラグ=["
      D             EDIT-FLG OF SJTK-H-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨払出簿価←リターンパッケージ.市場通貨払出簿価.バリュー
               MOVE  OUT-VALUES          OF  SJTK-H-BOKA
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-H-BOKA      OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨払出簿価=["
      D             WK-SJTK-H-BOKA       OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨払出簿価.編集フラグ=["
      D             EDIT-FLG OF SJTK-H-BOKA OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨払出単価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-H-TNK   OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨払出単価.編集フラグ=["
      D             EDIT-FLG OF UYTK-H-TNK  OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨払出単価←リターンパッケージ.運用通貨払出単価.バリュー
               MOVE  OUT-VALUES          OF  UYTK-H-TNK
                 OF  PARM-SMZC1951-ARG2
                 TO   WK-UYTK-H-TNK      OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨払出単価=["
      D             WK-UYTK-H-TNK        OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨払出単価.編集フラグ=["
      D             EDIT-FLG OF UYTK-H-TNK  OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨払出単価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-H-TNK   OF  PARM-SMZC1951-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨払出単価.編集フラグ=["
      D             EDIT-FLG OF SJTK-H-TNK  OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨払出単価←リターンパッケージ.市場通貨払出単価.バリュー
               MOVE  OUT-VALUES           OF  SJTK-H-TNK
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-H-TNK       OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨払出単価=["
      D             WK-SJTK-H-TNK        OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨払出単価.編集フラグ=["
      D             EDIT-FLG OF SJTK-H-TNK  OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後簿価残高（親株）.編集フラグ＝'1'
      *----------  AND ワークC/A位置付けフラグ＝'1'(分割元)の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-BOKAZN-OKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1 AND
                 WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後簿価"
      D            "残高（親株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-IDOG-BOKAZN-OKB  OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨異動後簿価残高←リターンパッケージ.市場通貨異動後簿価残高（親株）.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-BOKAZN-OKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-IDOG-BOKAZN
                 OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.市場通貨異動後簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後簿価"
      D            "残高（親株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-IDOG-BOKAZN-OKB  OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨異動後簿価残高（親株）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-BOKAZN-OKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1  AND
                 WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後簿価"
      D            "残高（親株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-IDOG-BOKAZN-OKB  OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨異動後簿価残高←リターンパッケージ.運用通貨異動後簿価残高（親株）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-BOKAZN-OKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-IDOG-BOKAZN
                 OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.運用通貨異動後簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後簿価"
      D            "残高（親株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-IDOG-BOKAZN-OKB  OF PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後簿価残高（新株）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-BOKAZN-SKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1  AND
                 WK-CA-POS-FLG = CNS-BUNKATSUSEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後簿価"
      D            "残高（新株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-IDOG-BOKAZN-SKB  OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨異動後簿価残高←リターンパッケージ.市場通貨異動後簿価残高（新株）.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-BOKAZN-SKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-IDOG-BOKAZN
                 OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.市場通貨異動後簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後簿価"
      D            "残高（新株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-IDOG-BOKAZN-SKB  OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨異動後簿価残高（新株）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-BOKAZN-SKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1  AND
                 WK-CA-POS-FLG = CNS-BUNKATSUSEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後簿価"
      D            "残高（新株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-IDOG-BOKAZN-SKB  OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨異動後簿価残高←リターンパッケージ.運用通貨異動後簿価残高（新株）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-BOKAZN-SKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-IDOG-BOKAZN
                 OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.運用通貨異動後簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後簿価"
      D            "残高（新株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-IDOG-BOKAZN-SKB  OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨簿価単価（親株）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-BOKA-TNK-OKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1  AND
                 WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨簿価単価"
      D            "（親株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-BOKA-TNK-OKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨簿価単価←リターンパッケージ.市場通貨簿価単価（親株）.バリュー
               MOVE  OUT-VALUES          OF  SJTK-BOKA-TNK-OKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-BOKA-TNK    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨簿価単価=["
      D             WK-SJTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨簿価単価"
      D            "（親株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-BOKA-TNK-OKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨簿価単価（親株）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-BOKA-TNK-OKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1  AND
                 WK-CA-POS-FLG = CNS-BUNKATSUGEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨簿価単価"
      D            "（親株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-BOKA-TNK-OKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨簿価単価←リターンパッケージ.運用通貨簿価単価（親株）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-BOKA-TNK-OKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-BOKA-TNK    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨簿価単価=["
      D             WK-UYTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨簿価単価"
      D            "（親株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-BOKA-TNK-OKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨簿価単価（新株）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-BOKA-TNK-SKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1  AND
                 WK-CA-POS-FLG = CNS-BUNKATSUSEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨簿価単価"
      D            "（新株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-BOKA-TNK-SKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.市場通貨簿価単価←リターンパッケージ.市場通貨簿価単価（新株）.バリュー
               MOVE  OUT-VALUES          OF  SJTK-BOKA-TNK-SKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-SJTK-BOKA-TNK    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨簿価単価=["
      D             WK-SJTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨簿価単価"
      D            "（新株）.編集フラグ=["EDIT-FLG  OF
      D             SJTK-BOKA-TNK-SKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨簿価単価（新株）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-BOKA-TNK-SKB
                 OF  PARM-SMZC1951-ARG2  = CNS-FLG-1  AND
                 WK-CA-POS-FLG = CNS-BUNKATSUSEN
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨簿価単価"
      D            "（新株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-BOKA-TNK-SKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク簿価計算結果.運用通貨簿価単価←リターンパッケージ.運用通貨簿価単価（新株）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-BOKA-TNK-SKB
                 OF  PARM-SMZC1951-ARG2
                 TO  WK-UYTK-BOKA-TNK    OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨簿価単価=["
      D             WK-UYTK-BOKA-TNK     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨簿価単価"
      D            "（新株）.編集フラグ=["EDIT-FLG  OF
      D             UYTK-BOKA-TNK-SKB    OF PARM-SMZC1951-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["WK-CA-POS-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1951-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1951-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1951-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク一口売却計算フラグ=["
      D                                       WK-KUTI1-BAKYK-CALC-FLG"]"
      *-----------------------------------------------------------------
      *----------  ワーク一口売却計算フラグ＝'1'の場合
             IF  WK-KUTI1-BAKYK-CALC-FLG  =  CNS-FLG-1
             THEN
      *----------  ワーク簿価計算結果.市場通貨払出単価
               MOVE  H-SJTK-H-TNK       OF  H-TKMZBW04
                 TO  WK-SJTK-H-TNK      OF  WK-BOKA-CALC-KEKKA
      *----------  ワーク簿価計算結果.運用通貨払出単価
               MOVE  H-UYTK-H-TNK       OF  H-TKMZBW04
                 TO  WK-UYTK-H-TNK      OF  WK-BOKA-CALC-KEKKA
      *----------  ワーク簿価計算結果.市場通貨払出簿価
               MOVE  H-SJTK-H-BOKA      OF  H-TKMZBW04
                 TO  WK-SJTK-H-BOKA     OF  WK-BOKA-CALC-KEKKA
      *----------  ワーク簿価計算結果.運用通貨払出簿価
               MOVE  H-UYTK-H-BOKA      OF  H-TKMZBW04
                 TO  WK-UYTK-H-BOKA     OF  WK-BOKA-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨払出単価=["
      D             WK-SJTK-H-TNK       OF  WK-BOKA-CALC-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨払出単価=["
      D             WK-UYTK-H-TNK       OF  WK-BOKA-CALC-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨払出簿価=["
      D             WK-SJTK-H-BOKA      OF  WK-BOKA-CALC-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨払出簿価=["
      D             WK-UYTK-H-BOKA      OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-073
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
            MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1951簿価計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** SMZC1951簿価計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1951-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1956建玉計算をコールする
      ******************************************************************
       SMZC1956-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** SMZC1956建玉計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1956】建玉計算コールに接続用パラメータの設定を行なう
      *----------  建玉計算方法
           MOVE  WK-TGYOKU-CALC-HOU     OF  WK-CALC-PTN
             TO  TGYOKU-CALC-HOU        OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":建玉計算方法=["
      D             TGYOKU-CALC-HOU     OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.a09取引分析-先物フラグ＝'1'の場合
           IF  WK-TORI-BUNSEKI-FT-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.a09取引分析-先物フラグ=["
      D          WK-TORI-BUNSEKI-FT-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  権利行使・割当フラグ←ワーク取引分析-先物.権利行使・割当フラグ
             MOVE  WK-KRKS-WARIATE-FLG   OF  WK-TORI-BUNSEKI-FT
               TO  KRKS-WARIATE-FLG      OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":権利行使・割当フラグ=["
      D             KRKS-WARIATE-FLG     OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.a09取引分析-先物フラグ=["
      D          WK-TORI-BUNSEKI-FT-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.市場通貨異動後建玉約定金額残
             MOVE  WK-SJTK-IDOG-TG-YJKNZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-TG-YJKNZN   OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.運用通貨異動後建玉約定金額残
             MOVE  WK-UYTK-IDOG-TG-YJKNZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-TG-YJKNZN   OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.市場通貨異動後建玉手数料残
             MOVE  WK-SJTK-IDOG-TG-TSRZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-TG-TSRZN    OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.運用通貨異動後建玉手数料残
             MOVE  WK-UYTK-IDOG-TG-TSRZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-TG-TSRZN    OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.市場通貨異動後建玉消費税残
             MOVE  WK-SJTK-IDOG-TG-S-TAXZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-TG-S-TAXZN  OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.運用通貨異動後建玉消費税残
             MOVE  WK-UYTK-IDOG-TG-S-TAXZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-TG-S-TAXZN  OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.市場通貨異動後建玉その他費用残
             MOVE  WK-SJTK-IDOG-TG-ELS-HZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-TG-ELS-HZN  OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.運用通貨異動後建玉その他費用残
             MOVE  WK-UYTK-IDOG-TG-ELS-HZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-TG-ELS-HZN  OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.市場通貨異動後建玉精算金額残
             MOVE  WK-SJTK-IDOG-TG-SSKGZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-TG-SSKGZN   OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.運用通貨異動後建玉精算金額残
             MOVE  WK-UYTK-IDOG-TG-SSKGZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-TG-SSKGZN   OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-BOKAZN      OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-BOKAZN      OF  PARM-SMZC1956-ARG1
      *----------  直前の残高異動.オプションＬ／Ｓフラグ
             MOVE  WK-OP-L-S-FLG         OF  WK-TZ-ZN-IDO
               TO  OP-L-S-FLG            OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.市場通貨異動後建玉約定金額残=["
      D             SJTK-IDOG-TG-YJKNZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.運用通貨異動後建玉約定金額残=["
      D             UYTK-IDOG-TG-YJKNZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.市場通貨異動後建玉手数料残=["
      D             SJTK-IDOG-TG-TSRZN   OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.運用通貨異動後建玉手数料残=["
      D             UYTK-IDOG-TG-TSRZN   OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.市場通貨異動後建玉消費税残=["
      D             SJTK-IDOG-TG-S-TAXZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.運用通貨異動後建玉消費税残=["
      D             UYTK-IDOG-TG-S-TAXZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.市場通貨異動後建玉その他費用残=["
      D             SJTK-IDOG-TG-ELS-HZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.運用通貨異動後建玉その他費用残=["
      D             UYTK-IDOG-TG-ELS-HZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.市場通貨異動後建玉精算金額残=["
      D             SJTK-IDOG-TG-SSKGZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.運用通貨異動後建玉精算金額残=["
      D             UYTK-IDOG-TG-SSKGZN  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後簿価残高=["
      D             SJTK-IDOG-BOKAZN     OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後簿価残高=["
      D             UYTK-IDOG-BOKAZN     OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.オプションＬ／Ｓフラグ=["
      D             OP-L-S-FLG           OF PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  異動簿価.市場通貨異動簿価
           MOVE  WK-SJTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
             TO  SJTK-IDO-BOKA         OF  PARM-SMZC1956-ARG1
      *----------  異動簿価.運用通貨異動簿価
           MOVE  WK-UYTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
             TO  UYTK-IDO-BOKA         OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動簿価.市場通貨異動簿価=["
      D             SJTK-IDO-BOKA      OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動簿価.運用通貨異動簿価=["
      D             UYTK-IDO-BOKA      OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.e09個別計算９フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-9-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e09個別計算９フラグ=["
      D             WK-KOBETSU-CALC-9-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算９.市場通貨手数料（建玉精算金額）
             MOVE  SJTK-TESRY-HIYO-TSK   OF  PARM-SMZC1406-ARG2
               TO  SJTK-TESRY-HIYO-TSK   OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.市場通貨消費税（建玉精算金額）
             MOVE  SJTK-SHOHI-TAX-TSK    OF  PARM-SMZC1406-ARG2
               TO  SJTK-SHOHI-TAX-TSK    OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.市場通貨その他費用（建玉精算金額）
             MOVE  SJTK-ELS-HIYO-TSK     OF  PARM-SMZC1406-ARG2
               TO  SJTK-ELS-HIYO-TSK     OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.運用通貨手数料（建玉精算金額）
             MOVE  UYTK-TESRY-HIYO-TSK   OF  PARM-SMZC1406-ARG2
               TO  UYTK-TESRY-HIYO-TSK   OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.運用通貨消費税（建玉精算金額）
             MOVE  UYTK-SHOHI-TAX-TSK    OF  PARM-SMZC1406-ARG2
               TO  UYTK-SHOHI-TAX-TSK    OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.運用通貨その他費用（建玉精算金額）
             MOVE  UYTK-ELS-HIYO-TSK     OF  PARM-SMZC1406-ARG2
               TO  UYTK-ELS-HIYO-TSK     OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.市場通貨手数料（建玉費用）
             MOVE  SJTK-TESRY-HIYO-THY   OF  PARM-SMZC1406-ARG2
               TO  SJTK-TESRY-HIYO-THY   OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.市場通貨消費税（建玉費用）
             MOVE  SJTK-SHOHI-TAX-THY    OF  PARM-SMZC1406-ARG2
               TO  SJTK-SHOHI-TAX-THY    OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.市場通貨その他費用（建玉費用）
             MOVE  SJTK-ELS-HIYO-THY     OF  PARM-SMZC1406-ARG2
               TO  SJTK-ELS-HIYO-THY     OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.運用通貨手数料（建玉費用）
             MOVE  UYTK-TESRY-HIYO-THY   OF  PARM-SMZC1406-ARG2
               TO  UYTK-TESRY-HIYO-THY   OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.運用通貨消費税（建玉費用）
             MOVE  UYTK-SHOHI-TAX-THY    OF  PARM-SMZC1406-ARG2
               TO  UYTK-SHOHI-TAX-THY    OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算９.運用通貨その他費用（建玉費用）
             MOVE  UYTK-ELS-HIYO-THY     OF  PARM-SMZC1406-ARG2
               TO  UYTK-ELS-HIYO-THY     OF  KOBETSU-KOMK-CALC-9-PARM
               OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.市場通貨手数料（建玉精算金額）=["
      D             SJTK-TESRY-HIYO-TSK  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.市場通貨消費税（建玉精算金額）=["
      D             SJTK-SHOHI-TAX-TSK  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":個別項目計算９.市場通貨その他費用（建玉精算金額）=["
      D             SJTK-ELS-HIYO-TSK  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨手数料（建玉精算金額）=["
      D             UYTK-TESRY-HIYO-TSK  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨消費税（建玉精算金額）=["
      D             UYTK-SHOHI-TAX-TSK  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":個別項目計算９.運用通貨その他費用（建玉精算金額）=["
      D             UYTK-ELS-HIYO-TSK  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.市場通貨手数料（建玉費用）=["
      D             SJTK-TESRY-HIYO-THY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.市場通貨消費税（建玉費用）=["
      D             SJTK-SHOHI-TAX-THY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":個別項目計算９.市場通貨その他費用（建玉費用）=["
      D             SJTK-ELS-HIYO-THY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨手数料（建玉費用）=["
      D             UYTK-TESRY-HIYO-THY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨消費税（建玉費用）=["
      D             UYTK-SHOHI-TAX-THY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨その他費用（建玉費用）=["
      D             UYTK-ELS-HIYO-THY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e09個別計算９フラグ=["
      D             WK-KOBETSU-CALC-9-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e10個別計算１０フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-10-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e10個別計算１０フラグ=["
      D            WK-KOBETSU-CALC-10-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１０.市場通貨手数料（建玉精算金額）
             MOVE  SJTK-TESRY-HIYO-TSK   OF  PARM-SMZC1407-ARG2
               TO  SJTK-TESRY-HIYO-TSK   OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨消費税（建玉精算金額）
             MOVE  SJTK-SHOHI-TAX-TSK    OF  PARM-SMZC1407-ARG2
               TO  SJTK-SHOHI-TAX-TSK    OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨その他費用（建玉精算金額）
             MOVE  SJTK-ELS-HIYO-TSK     OF  PARM-SMZC1407-ARG2
               TO  SJTK-ELS-HIYO-TSK     OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨手数料（建玉精算金額）
             MOVE  UYTK-TESRY-HIYO-TSK   OF  PARM-SMZC1407-ARG2
               TO  UYTK-TESRY-HIYO-TSK   OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨消費税（建玉精算金額）
             MOVE  UYTK-SHOHI-TAX-TSK    OF  PARM-SMZC1407-ARG2
               TO  UYTK-SHOHI-TAX-TSK    OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨その他費用（建玉精算金額）
             MOVE  UYTK-ELS-HIYO-TSK     OF  PARM-SMZC1407-ARG2
               TO  UYTK-ELS-HIYO-TSK     OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨手数料（売買金額）
             MOVE  SJTK-TESRY-BS-KN      OF  PARM-SMZC1407-ARG2
               TO  SJTK-TESRY-BS-KN      OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨消費税（売買金額）
             MOVE  SJTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1407-ARG2
               TO  SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨その他費用（売買金額）
             MOVE  SJTK-ELS-HIYO-BS-KN   OF  PARM-SMZC1407-ARG2
               TO  SJTK-ELS-HIYO-BS-KN   OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨手数料（売買金額）
             MOVE  UYTK-TESRY-BS-KN      OF  PARM-SMZC1407-ARG2
               TO  UYTK-TESRY-BS-KN      OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨消費税（売買金額）
             MOVE  UYTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1407-ARG2
               TO  UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨その他費用（売買金額）
             MOVE  UYTK-ELS-HIYO-BS-KN   OF  PARM-SMZC1407-ARG2
               TO  UYTK-ELS-HIYO-BS-KN   OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨手数料（建玉費用）
             MOVE  SJTK-TESRY-HIYO-THY   OF  PARM-SMZC1407-ARG2
               TO  SJTK-TESRY-HIYO-THY   OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨消費税（建玉費用）
             MOVE  SJTK-SHOHI-TAX-THY    OF  PARM-SMZC1407-ARG2
               TO  SJTK-SHOHI-TAX-THY    OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.市場通貨その他費用（建玉費用）
             MOVE  SJTK-ELS-HIYO-THY     OF  PARM-SMZC1407-ARG2
               TO  SJTK-ELS-HIYO-THY     OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨手数料（建玉費用）
             MOVE  UYTK-TESRY-HIYO-THY   OF  PARM-SMZC1407-ARG2
               TO  UYTK-TESRY-HIYO-THY   OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨消費税（建玉費用）
             MOVE  UYTK-SHOHI-TAX-THY    OF  PARM-SMZC1407-ARG2
               TO  UYTK-SHOHI-TAX-THY    OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１０.運用通貨その他費用（建玉費用）
             MOVE  UYTK-ELS-HIYO-THY     OF  PARM-SMZC1407-ARG2
               TO  UYTK-ELS-HIYO-THY     OF  KOBETSU-KOMK-CALC-10-PARM
               OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨手数料（建玉精算金額）=["
      D             SJTK-TESRY-HIYO-TSK  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨消費税（建玉精算金額）=["
      D             SJTK-SHOHI-TAX-TSK  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算１０.市場通貨その他費用（建玉精算金額）=["
      D             SJTK-ELS-HIYO-TSK  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨手数料（建玉精算金額）=["
      D             UYTK-TESRY-HIYO-TSK  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨消費税（建玉精算金額）=["
      D             UYTK-SHOHI-TAX-TSK  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算１０.運用通貨その他費用（建玉精算金額）=["
      D             UYTK-ELS-HIYO-TSK  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨その他費用（売買金額）=["
      D             SJTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨その他費用（売買金額）=["
      D             UYTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨手数料（建玉費用）=["
      D             SJTK-TESRY-HIYO-THY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨消費税（建玉費用）=["
      D             SJTK-SHOHI-TAX-THY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算１０.市場通貨その他費用（建玉費用）=["
      D             SJTK-ELS-HIYO-THY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨手数料（建玉費用）=["
      D             UYTK-TESRY-HIYO-THY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨消費税（建玉費用）=["
      D             UYTK-SHOHI-TAX-THY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算１０.運用通貨その他費用（建玉費用）=["
      D             UYTK-ELS-HIYO-THY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e10個別計算１０フラグ=["
      D            WK-KOBETSU-CALC-10-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e16個別計算１６フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-16-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e16個別計算１６"
      D             "フラグ=["WK-KOBETSU-CALC-16-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１６.市場通貨手数料（売買金額）
             MOVE  SJTK-TESRY-BS-KN      OF  PARM-SMZC1413-ARG2
               TO  SJTK-TESRY-BS-KN      OF  KOBETSU-KOMK-CALC-16-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１６.運用通貨手数料（売買金額）
             MOVE  UYTK-TESRY-BS-KN      OF  PARM-SMZC1413-ARG2
               TO  UYTK-TESRY-BS-KN      OF  KOBETSU-KOMK-CALC-16-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１６.市場通貨消費税（売買金額）
             MOVE  SJTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1413-ARG2
               TO  SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-16-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１６.運用通貨消費税（売買金額）
             MOVE  UYTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1413-ARG2
               TO  UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-16-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１６.市場通貨その他費用（売買金額）
             MOVE  SJTK-ELS-HIYO-BS-KN   OF  PARM-SMZC1413-ARG2
               TO  SJTK-ELS-HIYO-BS-KN   OF  KOBETSU-KOMK-CALC-16-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１６.運用通貨その他費用（売買金額）
             MOVE  UYTK-ELS-HIYO-BS-KN   OF  PARM-SMZC1413-ARG2
               TO  UYTK-ELS-HIYO-BS-KN   OF  KOBETSU-KOMK-CALC-16-PARM
               OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１６.市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-16-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１６.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-16-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１６.市場通貨その他費用（売買金額）=["
      D             SJTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-16-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１６.運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-16-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１６.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-16-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１６.運用通貨その他費用（売買金額）=["
      D             UYTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-16-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e16個別計算１６"
      D             "フラグ=["WK-KOBETSU-CALC-16-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e17個別計算１７フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-17-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e17個別計算１７"
      D             "フラグ=["WK-KOBETSU-CALC-17-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１７.市場通貨手数料（売買金額）
             MOVE  SJTK-TESRY-BS-KN      OF  PARM-SMZC1414-ARG2
               TO  SJTK-TESRY-BS-KN      OF  KOBETSU-KOMK-CALC-17-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１７.運用通貨手数料（売買金額）
             MOVE  UYTK-TESRY-BS-KN      OF  PARM-SMZC1414-ARG2
               TO  UYTK-TESRY-BS-KN      OF  KOBETSU-KOMK-CALC-17-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１７.市場通貨消費税（売買金額）
             MOVE  SJTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1414-ARG2
               TO  SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-17-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１７.運用通貨消費税（売買金額）
             MOVE  UYTK-SHOHI-TAX-BS-KN  OF  PARM-SMZC1414-ARG2
               TO  UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-17-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１７.市場通貨その他費用（売買金額）
             MOVE  SJTK-ELS-HIYO-BS-KN   OF  PARM-SMZC1414-ARG2
               TO  SJTK-ELS-HIYO-BS-KN   OF  KOBETSU-KOMK-CALC-17-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算１７.運用通貨その他費用（売買金額）
             MOVE  UYTK-ELS-HIYO-BS-KN   OF  PARM-SMZC1414-ARG2
               TO  UYTK-ELS-HIYO-BS-KN   OF  KOBETSU-KOMK-CALC-17-PARM
               OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１７.市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-17-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１７.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-17-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１７.市場通貨その他費用（売買金額）=["
      D             SJTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-17-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１７.運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-17-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１７.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-17-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１７.運用通貨その他費用（売買金額）=["
      D             UYTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-17-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e17個別計算１７"
      D             "フラグ=["WK-KOBETSU-CALC-17-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e21個別計算２１フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-21-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e21個別計算２１フラグ=["
      D            WK-KOBETSU-CALC-21-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２１.市場通貨手数料（建玉精算金額）
             MOVE  SJTK-TESRY-HIYO-TSK   OF  PARM-SMZC1418-ARG2
               TO  SJTK-TESRY-HIYO-TSK   OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.市場通貨消費税（建玉精算金額）
             MOVE  SJTK-SHOHI-TAX-TSK    OF  PARM-SMZC1418-ARG2
               TO  SJTK-SHOHI-TAX-TSK    OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.市場通貨その他費用（建玉精算金額）
             MOVE  SJTK-ELS-HIYO-TSK     OF  PARM-SMZC1418-ARG2
               TO  SJTK-ELS-HIYO-TSK     OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.運用通貨手数料（建玉精算金額）
             MOVE  UYTK-TESRY-HIYO-TSK   OF  PARM-SMZC1418-ARG2
               TO  UYTK-TESRY-HIYO-TSK   OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.運用通貨消費税（建玉精算金額）
             MOVE  UYTK-SHOHI-TAX-TSK    OF  PARM-SMZC1418-ARG2
               TO  UYTK-SHOHI-TAX-TSK    OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.運用通貨その他費用（建玉精算金額）
             MOVE  UYTK-ELS-HIYO-TSK     OF  PARM-SMZC1418-ARG2
               TO  UYTK-ELS-HIYO-TSK     OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.市場通貨手数料（建玉費用）
             MOVE  SJTK-TESRY-HIYO-THY   OF  PARM-SMZC1418-ARG2
               TO  SJTK-TESRY-HIYO-THY   OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.市場通貨消費税（建玉費用）
             MOVE  SJTK-SHOHI-TAX-THY    OF  PARM-SMZC1418-ARG2
               TO  SJTK-SHOHI-TAX-THY    OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.市場通貨その他費用（建玉費用）
             MOVE  SJTK-ELS-HIYO-THY     OF  PARM-SMZC1418-ARG2
               TO  SJTK-ELS-HIYO-THY     OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.運用通貨手数料（建玉費用）
             MOVE  UYTK-TESRY-HIYO-THY   OF  PARM-SMZC1418-ARG2
               TO  UYTK-TESRY-HIYO-THY   OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.運用通貨消費税（建玉費用）
             MOVE  UYTK-SHOHI-TAX-THY    OF  PARM-SMZC1418-ARG2
               TO  UYTK-SHOHI-TAX-THY    OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２１.運用通貨その他費用（建玉費用）
             MOVE  UYTK-ELS-HIYO-THY     OF  PARM-SMZC1418-ARG2
               TO  UYTK-ELS-HIYO-THY     OF  KOBETSU-KOMK-CALC-21-PARM
               OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨手数料（建玉精算金額）=["
      D             SJTK-TESRY-HIYO-TSK  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨消費税（建玉精算金額）=["
      D             SJTK-SHOHI-TAX-TSK  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算２１.市場通貨その他費用（建玉精算金額）=["
      D             SJTK-ELS-HIYO-TSK  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨手数料（建玉精算金額）=["
      D             UYTK-TESRY-HIYO-TSK  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨消費税（建玉精算金額）=["
      D             UYTK-SHOHI-TAX-TSK  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算２１.運用通貨その他費用（建玉精算金額）=["
      D             UYTK-ELS-HIYO-TSK  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨手数料（建玉費用）=["
      D             SJTK-TESRY-HIYO-THY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨消費税（建玉費用）=["
      D             SJTK-SHOHI-TAX-THY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算２１.市場通貨その他費用（建玉費用）=["
      D             SJTK-ELS-HIYO-THY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨手数料（建玉費用）=["
      D             UYTK-TESRY-HIYO-THY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨消費税（建玉費用）=["
      D             UYTK-SHOHI-TAX-THY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算２１.運用通貨その他費用（建玉費用）=["
      D             UYTK-ELS-HIYO-THY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e21個別計算２１フラグ=["
      D            WK-KOBETSU-CALC-21-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a02相対取引フラグ＝'1'の場合
           IF  WK-AITAI-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a02相対取引"
      D             "フラグ=["WK-AITAI-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  相対取引.建時約定金額（市場通貨）
             MOVE  WK-S-KSG-TH-YJKG      OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-YJKG         OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時現地手数料（市場通貨）
             MOVE  WK-S-KSG-TH-G-TSR     OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-G-TSR        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時現地消費税（市場通貨）
             MOVE  WK-S-KSG-TH-G-SHZ     OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-G-SHZ        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時現地その他費用（市場通貨）
             MOVE  WK-S-KSG-TH-G-THY     OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-G-THY        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時運用国手数料（市場通貨）
             MOVE  WK-S-KSG-TH-U-TSR     OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-U-TSR        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時運用国消費税（市場通貨）
             MOVE  WK-S-KSG-TH-U-SHZ     OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-U-SHZ        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時運用国その他費用（市場通貨）
             MOVE  WK-S-KSG-TH-U-THY     OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-U-THY        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時約定金額（運用通貨）
             MOVE  WK-U-KSG-TH-YJKG      OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-YJKG         OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時現地手数料（運用通貨）
             MOVE  WK-U-KSG-TH-G-TSR     OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-G-TSR        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時現地消費税（運用通貨）
             MOVE  WK-U-KSG-TH-G-SHZ     OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-G-SHZ        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時現地その他費用（運用通貨）
             MOVE  WK-U-KSG-TH-G-THY     OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-G-THY        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時運用国手数料（運用通貨）
             MOVE  WK-U-KSG-TH-U-TSR     OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-U-TSR        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時運用国消費税（運用通貨）
             MOVE  WK-U-KSG-TH-U-SHZ     OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-U-SHZ        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時運用国その他費用（運用通貨）
             MOVE  WK-U-KSG-TH-U-THY     OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-U-THY        OF  PARM-SMZC1956-ARG1
      *----------  相対取引.資産負債・買建売建フラグ
             MOVE  WK-TATE-FLG           OF  WK-MEG-BETU-DMN-INFO
               TO  TATE-FLG              OF  PARM-SMZC1956-ARG1
      *----------  相対取引.引継ＯＰ約定金額（市場通貨）
             MOVE  WK-S-KSG-HTOP-YJKG    OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-HTOP-YJKG       OF  PARM-SMZC1956-ARG1
      *----------  相対取引.引継ＯＰ約定金額（運用通貨）
             MOVE  WK-U-KSG-HTOP-YJKG    OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-HTOP-YJKG       OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ約定金額（市場通貨）
             MOVE  WK-S-KSG-TH-OP-YJKG   OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-OP-YJKG      OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ約定金額（運用通貨）
             MOVE  WK-U-KSG-TH-OP-YJKG   OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-OP-YJKG      OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ現地手数料（市場通貨）
             MOVE  WK-S-KSG-TH-OP-G-TSR  OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-OP-G-TSR     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ運用国手数料（市場通貨）
             MOVE  WK-S-KSG-TH-OP-U-TSR  OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-OP-U-TSR     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ現地手数料（運用通貨）
             MOVE  WK-U-KSG-TH-OP-G-TSR  OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-OP-G-TSR     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ運用国手数料（運用通貨）
             MOVE  WK-U-KSG-TH-OP-U-TSR  OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-OP-U-TSR     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ現地消費税（市場通貨)
             MOVE  WK-S-KSG-TH-OP-G-SHZ  OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-OP-G-SHZ     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ運用国消費税（市場通貨)
             MOVE  WK-S-KSG-TH-OP-U-SHZ  OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-OP-U-SHZ     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ現地消費税（運用通貨）
             MOVE  WK-U-KSG-TH-OP-G-SHZ  OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-OP-G-SHZ     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ運用国消費税（運用通貨）
             MOVE  WK-U-KSG-TH-OP-U-SHZ  OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-OP-U-SHZ     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ現地その他費用（市場通貨）
             MOVE  WK-S-KSG-TH-OP-G-THY  OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-OP-G-THY     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ運用国その他費用（市場通貨）
             MOVE  WK-S-KSG-TH-OP-U-THY  OF  WK-AITAI-TRHK-DATA
               TO  S-KSG-TH-OP-U-THY     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ現地その他費用（運用通貨）
             MOVE  WK-U-KSG-TH-OP-G-THY  OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-OP-G-THY     OF  PARM-SMZC1956-ARG1
      *----------  相対取引.建時ＯＰ運用国その他費用（運用通貨）
             MOVE  WK-U-KSG-TH-OP-U-THY  OF  WK-AITAI-TRHK-DATA
               TO  U-KSG-TH-OP-U-THY     OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":相対取引.建時約定金額（市場通貨）=["
      D             S-KSG-TH-YJKG        OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時現地手数料（市場通貨）=["
      D             S-KSG-TH-G-TSR       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時現地消費税（市場通貨）=["
      D             S-KSG-TH-G-SHZ       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時現地その他費用（市場通貨）"
      D             "=["S-KSG-TH-G-THY   OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時運用国手数料（市場通貨）=["
      D             S-KSG-TH-U-TSR       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時運用国費税（市場通貨）=["
      D             S-KSG-TH-U-SHZ       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時運用国その他費用（市場通貨"
      D             "）=["S-KSG-TH-U-THY   OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時約定金額（運用通貨）=["
      D             U-KSG-TH-YJKG        OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時現地手数料（運用通貨）=["
      D             U-KSG-TH-G-TSR       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時現地消費税（運用通貨）=["
      D             U-KSG-TH-G-SHZ       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時現地その他費用（運用通貨）"
      D             "=["U-KSG-TH-G-THY   OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時運用国手数料（運用通貨）=["
      D             U-KSG-TH-U-TSR       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時運用国費税（運用通貨）=["
      D             U-KSG-TH-U-SHZ       OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時運用国その他費用（運用通貨"
      D             "）=["U-KSG-TH-U-THY  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.引継ＯＰ約定金額（市場通貨）=["
      D             S-KSG-HTOP-YJKG      OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.引継ＯＰ約定金額（運用通貨）=["
      D             U-KSG-HTOP-YJKG      OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ約定金額（市場通貨）=["
      D             S-KSG-TH-OP-YJKG     OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ約定金額（運用通貨）=["
      D             U-KSG-TH-OP-YJKG     OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ現地手数料（市場通貨）"
      D             "=["S-KSG-TH-OP-G-TSR    OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ運用国手数料（市場通貨"
      D             "）=["S-KSG-TH-OP-U-TSR  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ現地手数料（運用通貨）"
      D             "=["U-KSG-TH-OP-G-TSR    OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ運用国手数料（市場通貨"
      D             "）=["U-KSG-TH-OP-U-TSR  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ現地消費税（市場通貨）"
      D             "=["S-KSG-TH-OP-G-SHZ    OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ運用国消費税（市場通貨"
      D             "）=["S-KSG-TH-OP-U-SHZ  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ現地消費税（運用通貨）"
      D             "=["U-KSG-TH-OP-G-SHZ    OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ運用国消費税（運用通貨"
      D             "）=["U-KSG-TH-OP-U-SHZ  OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ現地その他費用（市場通"
      D             "貨）=["S-KSG-TH-OP-G-THY OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ運用国その他費用（市場"
      D             "通貨）=["S-KSG-TH-OP-U-THY OF PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ現地その他費用（運用通"
      D             "貨）=["U-KSG-TH-OP-G-THY OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時ＯＰ運用国その他費用（運用"
      D             "通貨）=["U-KSG-TH-OP-U-THY OF PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a02相対取引"
      D             "フラグ=["WK-AITAI-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG    OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ"
      D             "=["WK-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引.約定金額（市場通貨換算額)
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1956-ARG1
      *----------  取引.約定金額（運用通貨換算額)
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額)=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額)=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ"
      D             "=["WK-TORI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e20個別計算２０フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-20-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e20個別計算２０フラグ=["
      D            WK-KOBETSU-CALC-20-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２０.市場通貨手数料（払出建時金額）
             MOVE  SJTK-TESRY-HIYO-HTK   OF  PARM-SMZC1417-ARG2
               TO  SJTK-TESRY-HIYO-HTK   OF  KOBETSU-KOMK-CALC-20-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２０.市場通貨消費税（払出建時金額）
             MOVE  SJTK-SHOHI-TAX-HTK    OF  PARM-SMZC1417-ARG2
               TO  SJTK-SHOHI-TAX-HTK    OF  KOBETSU-KOMK-CALC-20-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２０.市場通貨その他費用（払出建時金額）
             MOVE  SJTK-ELS-HIYO-HTK     OF  PARM-SMZC1417-ARG2
               TO  SJTK-ELS-HIYO-HTK     OF  KOBETSU-KOMK-CALC-20-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２０.運用通貨手数料（払出建時金額）
             MOVE  UYTK-TESRY-HIYO-HTK   OF  PARM-SMZC1417-ARG2
               TO  UYTK-TESRY-HIYO-HTK   OF  KOBETSU-KOMK-CALC-20-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２０.運用通貨消費税（払出建時金額）
             MOVE  UYTK-SHOHI-TAX-HTK    OF  PARM-SMZC1417-ARG2
               TO  UYTK-SHOHI-TAX-HTK    OF  KOBETSU-KOMK-CALC-20-PARM
               OF  PARM-SMZC1956-ARG1
      *----------  個別項目計算２０.運用通貨その他費用（払出建時金額）
             MOVE  UYTK-ELS-HIYO-HTK     OF  PARM-SMZC1417-ARG2
               TO  UYTK-ELS-HIYO-HTK     OF  KOBETSU-KOMK-CALC-20-PARM
               OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２０.市場通貨手数料（払出建時金額）=["
      D             SJTK-TESRY-HIYO-HTK  OF  KOBETSU-KOMK-CALC-20-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２０.市場通貨消費税（払出建時金額）=["
      D             SJTK-SHOHI-TAX-HTK  OF  KOBETSU-KOMK-CALC-20-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算２０.市場通貨その他費用（払出建時金額）=["
      D             SJTK-ELS-HIYO-HTK  OF  KOBETSU-KOMK-CALC-20-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２０.運用通貨手数料（払出建時金額）=["
      D             UYTK-TESRY-HIYO-HTK  OF  KOBETSU-KOMK-CALC-20-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２０.運用通貨消費税（払出建時金額）=["
      D             UYTK-SHOHI-TAX-HTK  OF  KOBETSU-KOMK-CALC-20-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D         ":個別項目計算２０.運用通貨その他費用（払出建時金額）=["
      D             UYTK-ELS-HIYO-HTK  OF  KOBETSU-KOMK-CALC-20-PARM
      D             OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e20個別計算２０フラグ=["
      D            WK-KOBETSU-CALC-20-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  異動後数量残高
           MOVE  WK-IDOG-SRYZN          OF  WK-SURYO-CALC-KEKKA
             TO  IDOG-SRYZN             OF  PARM-SMZC1956-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動後数量残高=["
      D             IDOG-SRYZN          OF  PARM-SMZC1956-ARG1"]"
      *-----------------------------------------------------------------
      *---------- ②【SMZC1956】建玉計算コールをコールして、リターンパッケージを取得する
           CALL  "SMZC1956"              USING  PARM-SMZC1956-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1956)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク建玉計算結果を初期化
             INITIALIZE  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果=["
      D             WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨異動後建玉約定金額残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-TG-YJKNZN
               OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉約定金額残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-TG-YJKNZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉約定金額残
      *----------  ←リターンパッケージ.市場通貨異動後建玉約定金額残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-TG-YJKNZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-IDOG-TG-YJKNZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後建玉約定金額残=["
      D             WK-SJTK-IDOG-TG-YJKNZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉約定金額残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-TG-YJKNZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉約定金額残←ARG1.直前残高異動.市場通貨異動後建玉約定金額残
               MOVE  WK-SJTK-IDOG-TG-YJKNZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-TG-YJKNZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後建玉約定金額残=["
      D             WK-SJTK-IDOG-TG-YJKNZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後建玉約定金額残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-TG-YJKNZN
             OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉約定金額残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-TG-YJKNZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉約定金額残
      *----------  ←リターンパッケージ.運用通貨異動後建玉約定金額残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-TG-YJKNZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-IDOG-TG-YJKNZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後建玉約定金額残=["
      D             WK-UYTK-IDOG-TG-YJKNZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉約定金額残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-TG-YJKNZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉約定金額残←ARG1.直前残高異動.運用通貨異動後建玉約定金額残
               MOVE  WK-UYTK-IDOG-TG-YJKNZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-TG-YJKNZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後建玉約定金額残=["
      D             WK-UYTK-IDOG-TG-YJKNZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨建玉手数料.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-TG-TSR   OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.市場通貨建玉手数料.編集フラグ=["
      D             EDIT-FLG OF SJTK-TG-TSR  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨建玉手数料←リターンパッケージ.市場通貨建玉手数料.バリュー
               MOVE  OUT-VALUES          OF  SJTK-TG-TSR
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-TG-TSR      OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.市場通貨建玉手数料=["
      D             WK-SJTK-TG-TSR      OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.市場通貨建玉手数料.編集フラグ=["
      D             EDIT-FLG OF SJTK-TG-TSR  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨建玉手数料.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-TG-TSR   OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.運用通貨建玉手数料.編集フラグ=["
      D             EDIT-FLG OF UYTK-TG-TSR  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨建玉手数料←リターンパッケージ.運用通貨建玉手数料.バリュー
               MOVE  OUT-VALUES          OF  UYTK-TG-TSR
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-TG-TSR      OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.運用通貨建玉手数料=["
      D             WK-UYTK-TG-TSR      OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.運用通貨建玉手数料.編集フラグ=["
      D             EDIT-FLG OF UYTK-TG-TSR  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後建玉手数料残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-TG-TSRZN
             OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉手数料残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-TG-TSRZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉手数料残←リターンパッケージ.市場通貨異動後建玉手数料残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-TG-TSRZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-IDOG-TG-TSRZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後建玉手数料残=["
      D             WK-SJTK-IDOG-TG-TSRZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉手数料残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-TG-TSRZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉手数料残←ARG1.直前残高異動.市場通貨異動後建玉手数料残
               MOVE  WK-SJTK-IDOG-TG-TSRZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-TG-TSRZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後建玉手数料残=["
      D             WK-SJTK-IDOG-TG-TSRZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後建玉手数料残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-TG-TSRZN
               OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉手数料残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-TG-TSRZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉手数料残←リターンパッケージ.運用通貨異動後建玉手数料残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-TG-TSRZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-IDOG-TG-TSRZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後建玉手数料残=["
      D             WK-UYTK-IDOG-TG-TSRZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉手数料残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-TG-TSRZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉手数料残←ARG1.直前残高異動.運用通貨異動後建玉手数料残
               MOVE  WK-UYTK-IDOG-TG-TSRZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-TG-TSRZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後建玉手数料残=["
      D             WK-UYTK-IDOG-TG-TSRZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨建玉消費税.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-TG-S-TAX  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.市場通貨建玉消費税.編集フラグ=["
      D            EDIT-FLG  OF  SJTK-TG-S-TAX  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨建玉消費税←リターンパッケージ.市場通貨建玉消費税.バリュー
               MOVE  OUT-VALUES          OF  SJTK-TG-S-TAX
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-TG-S-TAX    OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.市場通貨建玉消費税=["
      D             WK-SJTK-TG-S-TAX     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.市場通貨建玉消費税.編集フラグ=["
      D            EDIT-FLG  OF  SJTK-TG-S-TAX  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨建玉消費税.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-TG-S-TAX  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.運用通貨建玉消費税.編集フラグ=["
      D            EDIT-FLG  OF  UYTK-TG-S-TAX  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨建玉消費税←リターンパッケージ.運用通貨建玉消費税.バリュー
               MOVE  OUT-VALUES          OF  UYTK-TG-S-TAX
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-TG-S-TAX    OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.運用通貨建玉消費税=["
      D             WK-UYTK-TG-S-TAX     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.運用通貨建玉消費税.編集フラグ=["
      D            EDIT-FLG  OF  UYTK-TG-S-TAX  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後建玉消費税残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-TG-S-TAXZN
                 OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.市場通貨異動後建玉消費税残.編集フラグ=["
      D        EDIT-FLG OF SJTK-IDOG-TG-S-TAXZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉消費税残←リターンパッケージ.市場通貨異動後建玉消費税残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-TG-S-TAXZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-IDOG-TG-S-TAXZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後建玉消費税残=["
      D             WK-SJTK-IDOG-TG-S-TAXZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.市場通貨異動後建玉消費税残.編集フラグ=["
      D        EDIT-FLG OF SJTK-IDOG-TG-S-TAXZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉消費税残←ARG1.直前残高異動.市場通貨異動後建玉消費税残
               MOVE  WK-SJTK-IDOG-TG-S-TAXZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-TG-S-TAXZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後建玉消費税残=["
      D             WK-SJTK-IDOG-TG-S-TAXZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後建玉消費税残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-TG-S-TAXZN
                 OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.運用通貨異動後建玉消費税残.編集フラグ=["
      D        EDIT-FLG OF UYTK-IDOG-TG-S-TAXZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉消費税残←リターンパッケージ.運用通貨異動後建玉消費税残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-TG-S-TAXZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-IDOG-TG-S-TAXZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後建玉消費税残=["
      D             WK-UYTK-IDOG-TG-S-TAXZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":リターンパッケージ.運用通貨異動後建玉消費税残.編集フラグ=["
      D        EDIT-FLG OF UYTK-IDOG-TG-S-TAXZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉消費税残←ARG1.直前残高異動.運用通貨異動後建玉消費税残
               MOVE  WK-UYTK-IDOG-TG-S-TAXZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-TG-S-TAXZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後建玉消費税残=["
      D             WK-UYTK-IDOG-TG-S-TAXZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨建玉その他費用.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-TG-ELS-HIYO  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨建玉その他費用.編集フラグ=["
      D            EDIT-FLG OF SJTK-TG-ELS-HIYO OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨建玉その他費用←リターンパッケージ.市場通貨建玉その他費用.バリュー
               MOVE  OUT-VALUES          OF  SJTK-TG-ELS-HIYO
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-TG-ELS-HIYO
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨建玉その他費用=["
      D             WK-SJTK-TG-ELS-HIYO  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨建玉その他費用.編集フラグ=["
      D            EDIT-FLG OF SJTK-TG-ELS-HIYO OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨建玉その他費用.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-TG-ELS-HIYO  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨建玉その他費用.編集フラグ=["
      D            EDIT-FLG OF UYTK-TG-ELS-HIYO OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨建玉その他費用←リターンパッケージ.運用通貨建玉その他費用.バリュー
               MOVE  OUT-VALUES          OF  UYTK-TG-ELS-HIYO
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-TG-ELS-HIYO
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨建玉その他費用=["
      D             WK-UYTK-TG-ELS-HIYO  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨建玉その他費用.編集フラグ=["
      D            EDIT-FLG OF UYTK-TG-ELS-HIYO OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後建玉その他費用残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-TG-ELS-HZN
                 OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉その他費用残.編集フラグ=["
      D        EDIT-FLG OF SJTK-IDOG-TG-ELS-HZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉その他費用残
      *----------  ←リターンパッケージ.市場通貨異動後建玉その他費用残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-TG-ELS-HZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-IDOG-TG-ELS-HZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク建玉計算結果.市場通貨異動後建玉その他費用残=["
      D             WK-SJTK-IDOG-TG-ELS-HZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉その他費用残.編集フラグ=["
      D        EDIT-FLG OF SJTK-IDOG-TG-ELS-HZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉その他費用残←ARG1.直前残高異動.市場通貨異動後建玉その他費用残
               MOVE  WK-SJTK-IDOG-TG-ELS-HZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-TG-ELS-HZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク建玉計算結果.市場通貨異動後建玉その他費用残=["
      D             WK-SJTK-IDOG-TG-ELS-HZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後建玉その他費用残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-TG-ELS-HZN
                 OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉その他費用残.編集フラグ=["
      D        EDIT-FLG OF UYTK-IDOG-TG-ELS-HZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉その他費用残
      *----------  ←リターンパッケージ.運用通貨異動後建玉その他費用残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-TG-ELS-HZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-IDOG-TG-ELS-HZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク建玉計算結果.運用通貨異動後建玉その他費用残=["
      D             WK-UYTK-IDOG-TG-ELS-HZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉その他費用残.編集フラグ=["
      D        EDIT-FLG OF UYTK-IDOG-TG-ELS-HZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉その他費用残←ARG1.直前残高異動.運用通貨異動後建玉その他費用残
               MOVE  WK-UYTK-IDOG-TG-ELS-HZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-TG-ELS-HZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク建玉計算結果.運用通貨異動後建玉その他費用残=["
      D             WK-UYTK-IDOG-TG-ELS-HZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨建玉精算金額.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-TG-SSKG  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":リターンパッケージ.市場通貨建玉精算金額.編集フラグ=["
      D             EDIT-FLG OF SJTK-TG-SSKG OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨建玉精算金額←リターンパッケージ.市場通貨建玉精算金額.バリュー
               MOVE  OUT-VALUES          OF  SJTK-TG-SSKG
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-TG-SSKG     OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨建玉精算金額=["
      D             WK-SJTK-TG-SSKG     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":リターンパッケージ.市場通貨建玉精算金額.編集フラグ=["
      D             EDIT-FLG OF SJTK-TG-SSKG OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨建玉精算金額.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-TG-SSKG  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":リターンパッケージ.運用通貨建玉精算金額.編集フラグ=["
      D             EDIT-FLG OF UYTK-TG-SSKG OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨建玉精算金額←リターンパッケージ.運用通貨建玉精算金額.バリュー
               MOVE  OUT-VALUES          OF  UYTK-TG-SSKG
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-TG-SSKG     OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨建玉精算金額=["
      D             WK-UYTK-TG-SSKG     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":リターンパッケージ.運用通貨建玉精算金額.編集フラグ=["
      D             EDIT-FLG OF UYTK-TG-SSKG OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後建玉精算金額残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-TG-SSKGZN
                 OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉精算金額残.編集フラグ=["
      D         EDIT-FLG OF SJTK-IDOG-TG-SSKGZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉精算金額残
      *----------  ←リターンパッケージ.市場通貨異動後建玉精算金額残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-TG-SSKGZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-IDOG-TG-SSKGZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":ワーク建玉計算結果.市場通貨異動後建玉精算金額残=["
      D             WK-SJTK-IDOG-TG-SSKGZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後建玉精算金額残.編集フラグ=["
      D         EDIT-FLG OF SJTK-IDOG-TG-SSKGZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後建玉精算金額残←ARG1.直前残高異動.市場通貨異動後建玉精算金額残
               MOVE  WK-SJTK-IDOG-TG-SSKGZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-TG-SSKGZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":ワーク建玉計算結果.市場通貨異動後建玉精算金額残=["
      D             WK-SJTK-IDOG-TG-SSKGZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後建玉精算金額残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-TG-SSKGZN
                 OF  PARM-SMZC1956-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉精算金額残.編集フラグ=["
      D         EDIT-FLG OF UYTK-IDOG-TG-SSKGZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉精算金額残
      *----------  ←リターンパッケージ.運用通貨異動後建玉精算金額残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-TG-SSKGZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-IDOG-TG-SSKGZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":ワーク建玉計算結果.運用通貨異動後建玉精算金額残=["
      D             WK-UYTK-IDOG-TG-SSKGZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後建玉精算金額残.編集フラグ=["
      D         EDIT-FLG OF UYTK-IDOG-TG-SSKGZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後建玉精算金額残←ARG1.直前残高異動.運用通貨異動後建玉精算金額残
               MOVE  WK-UYTK-IDOG-TG-SSKGZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-TG-SSKGZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":ワーク建玉計算結果.運用通貨異動後建玉精算金額残=["
      D             WK-UYTK-IDOG-TG-SSKGZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨異動簿価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDO-BOKA   OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF SJTK-IDO-BOKA  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動簿価←リターンパッケージ.市場通貨異動簿価.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDO-BOKA
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-IDO-BOKA    OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.市場通貨異動簿価=["
      D             WK-SJTK-IDO-BOKA     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.市場通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF SJTK-IDO-BOKA  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨異動簿価.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDO-BOKA   OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF UYTK-IDO-BOKA  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動簿価←リターンパッケージ.運用通貨異動簿価.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDO-BOKA
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-IDO-BOKA    OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.運用通貨異動簿価=["
      D             WK-UYTK-IDO-BOKA     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.運用通貨異動簿価.編集フラグ=["
      D             EDIT-FLG OF UYTK-IDO-BOKA  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨引継前受・前払プレミアム.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-HT-PPAR-PMM  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨引継前受・前払プレミアム.編集フラグ=["
      D           EDIT-FLG OF SJTK-HT-PPAR-PMM  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨引継前受・前払プレミアム
      *----------  ←リターンパッケージ.市場通貨引継前受・前払プレミアム.バリュー
               MOVE  OUT-VALUES           OF  SJTK-HT-PPAR-PMM
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-HT-PPAR-PMM  OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":ワーク建玉計算結果.市場通貨引継前受・前払プレミアム=["
      D             WK-SJTK-HT-PPAR-PMM  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨引継前受・前払プレミアム.編集フラグ=["
      D           EDIT-FLG OF SJTK-HT-PPAR-PMM  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨引継前受・前払プレミアム.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-HT-PPAR-PMM  OF  PARM-SMZC1956-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨引継前受・前払プレミアム.編集フラグ=["
      D           EDIT-FLG OF UYTK-HT-PPAR-PMM  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨引継前受・前払プレミアム
      *----------  ←リターンパッケージ.運用通貨引継前受・前払プレミアム.バリュー
               MOVE  OUT-VALUES           OF  UYTK-HT-PPAR-PMM
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-HT-PPAR-PMM  OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":ワーク建玉計算結果.運用通貨引継前受・前払プレミアム=["
      D             WK-UYTK-HT-PPAR-PMM  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨引継前受・前払プレミアム.編集フラグ=["
      D           EDIT-FLG OF UYTK-HT-PPAR-PMM  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後簿価残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-BOKAZN
                 OF  PARM-SMZC1956-ARG2  = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後簿価"
      D            "残高.編集フラグ=["EDIT-FLG  OF
      D             SJTK-IDOG-BOKAZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後簿価残高←リターンパッケージ.市場通貨異動後簿価残高.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-BOKAZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-SJTK-IDOG-BOKAZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨異動後簿価残高.編集フラグ=["
      D            EDIT-FLG OF SJTK-IDOG-BOKAZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.市場通貨異動後簿価残高←ARG1.直前残高異動.市場通貨異動後簿価残高
               MOVE  WK-SJTK-IDOG-BOKAZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-BOKAZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後簿価残高=["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後簿価残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-BOKAZN
                 OF  PARM-SMZC1956-ARG2  = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後簿価"
      D            "残高.編集フラグ=["EDIT-FLG  OF
      D             UYTK-IDOG-BOKAZN  OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後簿価残高←リターンパッケージ.運用通貨異動後簿価残高.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-BOKAZN
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-UYTK-IDOG-BOKAZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨異動後簿価残高.編集フラグ=["
      D            EDIT-FLG OF UYTK-IDOG-BOKAZN OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.運用通貨異動後簿価残高←ARG1.直前残高異動.運用通貨異動後簿価残高
               MOVE  WK-UYTK-IDOG-BOKAZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-BOKAZN
                 OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後簿価残高=["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.オプションＬ／Ｓフラグ.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  OP-L-S-FLG  OF  PARM-SMZC1956-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.オプションＬ／"
      D            "Ｓフラグ=["EDIT-FLG  OF
      D             OP-L-S-FLG   OF PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.オプションＬ／Ｓフラグ←リターンパッケージ.オプションＬ／Ｓフラグ.バリュー
               MOVE  OUT-VALUES          OF  OP-L-S-FLG
                 OF  PARM-SMZC1956-ARG2
                 TO  WK-OP-L-S-FLG       OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.オプションＬ／Ｓフラグ=["
      D             WK-OP-L-S-FLG        OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.オプションＬ／"
      D            "Ｓフラグ=["EDIT-FLG  OF
      D             OP-L-S-FLG   OF PARM-SMZC1956-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.直前残高異動.オプションＬ／Ｓフラグ=["
      D             WK-OP-L-S-FLG        OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク建玉計算結果.オプションＬ／Ｓフラグ←ARG1.直前残高異動.オプションＬ／Ｓフラグ
               MOVE  WK-OP-L-S-FLG       OF  WK-TZ-ZN-IDO
                 TO  WK-OP-L-S-FLG       OF  WK-TGYOKU-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.オプションＬ／Ｓフラグ=["
      D             WK-OP-L-S-FLG        OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1956-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1956-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1956-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-074
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1956建玉計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** SMZC1956建玉計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1956-EXT.
           EXIT.
      ******************************************************************
      *    異動計算-個別項目計算１１
      ******************************************************************
       SMZC1408-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算-個別項目計算１１ START ***"
      *-----------------------------------------------------------------
      *----------  A)異動計算-個別項目計算１１【SMZC1408】に接続用パラメータの設定を行なう
      *----------  オプションＬ／Ｓフラグ
           MOVE  WK-OP-L-S-FLG           OF  WK-TGYOKU-CALC-KEKKA
             TO  OP-L-S-FLG              OF  PARM-SMZC1408-ARG1
      *----------  権利行使・割当フラグ
           MOVE  WK-KRKS-WARIATE-FLG     OF  WK-TORI-BUNSEKI-FT
             TO  KRKS-WARIATE-FLG        OF  PARM-SMZC1408-ARG1
      *----------  仕訳フラグ
           MOVE  BBSNEKI-SWK-FLG         OF  PARM-SMZJ1916-ARG2
             TO  SWK-FLG                 OF  PARM-SMZC1408-ARG1
      *----------  市場通貨異動簿価
           MOVE  WK-SJTK-IDO-BOKA        OF  WK-TGYOKU-CALC-KEKKA
             TO  SJTK-IDO-BOKA           OF  PARM-SMZC1408-ARG1
      *----------  運用通貨異動簿価
           MOVE  WK-UYTK-IDO-BOKA        OF  WK-TGYOKU-CALC-KEKKA
             TO  UYTK-IDO-BOKA           OF  PARM-SMZC1408-ARG1
      *----------  市場通貨引継前受・前払プレミアム
           MOVE  WK-SJTK-HT-PPAR-PMM     OF  WK-TGYOKU-CALC-KEKKA
             TO  SJTK-HT-PPAR-PMM        OF  PARM-SMZC1408-ARG1
      *----------  運用通貨引継前受・前払プレミアム
           MOVE  WK-UYTK-HT-PPAR-PMM     OF  WK-TGYOKU-CALC-KEKKA
             TO  UYTK-HT-PPAR-PMM        OF  PARM-SMZC1408-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":オプションＬ／Ｓフラグ=["
      D             OP-L-S-FLG           OF  PARM-SMZC1408-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":権利行使・割当フラグ=["
      D             KRKS-WARIATE-FLG     OF  PARM-SMZC1408-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳フラグ=["
      D             SWK-FLG              OF  PARM-SMZC1408-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価=["
      D             SJTK-IDO-BOKA        OF  PARM-SMZC1408-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価=["
      D             UYTK-IDO-BOKA        OF  PARM-SMZC1408-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨引継前受・前払プレミアム=["
      D             SJTK-HT-PPAR-PMM     OF  PARM-SMZC1408-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨引継前受・前払プレミアム=["
      D             UYTK-HT-PPAR-PMM     OF  PARM-SMZC1408-ARG1"]"
      *-----------------------------------------------------------------
      *---------- B)異動計算-個別項目計算１１【SMZC1408】をコールして、リターンパッケージを取得する
           CALL  "SMZC1408"              USING  PARM-SMZC1408-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1408)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-075
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算-個別項目計算１１  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 異動計算-個別項目計算１１ END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1408-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1952前払金計算をコールする
      ******************************************************************
       SMZC1952-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1952前払金計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1952】前払金計算コールに接続用パラメータの設定を行なう
      *----------  前払金計算方法
           MOVE  WK-MAEBR-KIN-CALC-HOU  OF  WK-CALC-PTN
             TO  MAEBR-KIN-CALC-HOU     OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":前払金計算方法=["
      D             MAEBR-KIN-CALC-HOU  OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.c01通貨フラグ＝'1'の場合
           IF  WK-TUKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  通貨デフォールト端数処理
             MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
               TO  TUKA-DEF-HASU-SYRI-PARM
               OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c02異動計算フラグ＝'1'の場合
           IF  WK-IDO-CALC-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  前払金償却方法
             MOVE  WK-MAEKIN-SHOUKYK-HOU
               OF  WK-YIDOU-CALC-PARM
               TO  MAEKIN-SHOUKYK-HOU    OF  PARM-SMZC1952-ARG1
      *----------  前払金償却分端数
             MOVE  WK-MAEKIN-SHOUKYK-HASU
               OF  WK-YIDOU-CALC-PARM
               TO  MAEKIN-SHOUKYK-HASU   OF  PARM-SMZC1952-ARG1
      *----------  払出簿価計算方法
             MOVE  WK-DEBET-BOKA-CALC-HOU
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-CALC-HOU   OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.前払金償却方法=["
      D             MAEKIN-SHOUKYK-HOU   OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.前払金償却分端数=["
      D             MAEKIN-SHOUKYK-HASU  OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価計算方法=["
      D             DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  銘柄別断面情報.処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-MEG-BETU-DMN-INFO
             TO  SYORI-YMD               OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.処理実行日=["
      D             SYORI-YMD            OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.起動ID
           MOVE  WK-KIDOU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  KIDOU-ID                OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.起動ID=["
      D             KIDOU-ID             OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  RIYO-CMP-CD             OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.利用会社コード=["
      D             RIYO-CMP-CD          OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             TO  FUND-CD                 OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ファンドコード=["
      D             FUND-CD              OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  PTF-CD                  OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ポートフォリオコード=["
      D             PTF-CD               OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.開始基準日
           MOVE  WK-KAISI-KJN-YMD        OF  WK-MEG-BETU-DMN-INFO
             TO  KAISI-KJN-YMD           OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.開始基準日=["
      D             KAISI-KJN-YMD        OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.基準日
           MOVE  WK-KJN-YMD              OF  WK-MEG-BETU-DMN-INFO
             TO  KJN-YMD                 OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.基準日=["
      D             KJN-YMD              OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.銘柄コード
           MOVE  WK-MEG-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  MEG-CD                  OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄コード=["
      D             MEG-CD               OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  SEC-SBT-CD              OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.証券種別コード=["
      D             SEC-SBT-CD           OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  TATE-FLG                OF  MEG-DNM-JOHO-PARM
             OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":銘柄別断面情報.資産負債・買建売建フラグ=["
      D           TATE-FLG OF MEG-DNM-JOHO-PARM OF PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.玉ID
           MOVE  WK-GYOKU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  GYOKU-ID                OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.玉ID=["
      D             GYOKU-ID             OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.差分更新From日
           MOVE  WK-SABON-UPDATE-FROM    OF  WK-MEG-BETU-DMN-INFO
             TO  SABON-UPDATE-FROM       OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.差分更新From日=["
      D             SABON-UPDATE-FROM    OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄種類=["
      D             MEG-CD-SHRU         OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄別断面情報.再計算区分
           MOVE  WK-SAI-CALC-KBN         OF  WK-MEG-BETU-DMN-INFO
             TO  SAI-CALC-KBN            OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.再計算区分=["
      D             SAI-CALC-KBN         OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  市場通貨コード
           MOVE  WK-SIJO-TUKA-CD         OF  WK-DATA-IN
             TO  SIJO-TUKA-CD            OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             SIJO-TUKA-CD         OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.運用通貨異動後前払金残
             MOVE  WK-UYTK-IDOG-PPAYZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-PPAYZN      OF  PARM-SMZC1952-ARG1
      *----------  直前の残高異動.市場通貨異動後前払金残
             MOVE  WK-SJTK-IDOG-PPAYZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-PPAYZN      OF  PARM-SMZC1952-ARG1
      *----------  直前の残高異動.運用通貨異動後前受金残
             MOVE  WK-UYTK-IDOG-ARECZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-ARECZN      OF  PARM-SMZC1952-ARG1
      *----------  直前の残高異動.市場通貨異動後前受金残
             MOVE  WK-SJTK-IDOG-ARECZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-ARECZN      OF  PARM-SMZC1952-ARG1
      *----------  直前の残高異動.運用通貨異動後仮払金残
             MOVE  WK-UYTK-IDOG-SPAYZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-SPAYZN      OF  PARM-SMZC1952-ARG1
      *----------  直前の残高異動.市場通貨異動後仮払金残
             MOVE  WK-SJTK-IDOG-SPAYZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-SPAYZN      OF  PARM-SMZC1952-ARG1
      *----------  直前の残高異動.異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-TZ-ZN-IDO
               TO  IDOG-SRYZN            OF  TYOKUZEN-ZANDAKA-IDO-PARM
                                         OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後前払金残=["
      D             UYTK-IDOG-PPAYZN     OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後前払金残=["
      D             SJTK-IDOG-PPAYZN     OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後前受金残=["
      D             UYTK-IDOG-ARECZN     OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後前受金残=["
      D             SJTK-IDOG-ARECZN     OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後仮払金残=["
      D             UYTK-IDOG-SPAYZN     OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後仮払金残=["
      D             SJTK-IDOG-SPAYZN     OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.異動後数量残高        =["
      D             IDOG-SRYZN           OF  TYOKUZEN-ZANDAKA-IDO-PARM
      D                                  OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.原取引ＩＤ
             MOVE  WK-TORI-ID            OF  WK-TARGET-TORI-INFO
               TO  TORI-ID               OF  PARM-SMZC1952-ARG1
      *----------  取引データ.受渡日
             MOVE  WK-UKE-YMD            OF  WK-TORI-DATA
               TO  UKE-YMD               OF  PARM-SMZC1952-ARG1
      *----------  取引データ.既経過利息（市場通貨換算額）
             MOVE  WK-S-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  S-KSG-G-KKKRS         OF  PARM-SMZC1952-ARG1
      *----------  取引データ.既経過利息（運用通貨換算額）
             MOVE  WK-U-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  U-KSG-G-KKKRS         OF  PARM-SMZC1952-ARG1
      *----------  取引データ.経過利息区分
             MOVE  WK-KKRS-KBN           OF  WK-TORI-DATA
               TO  KKRS-KBN              OF  PARM-SMZC1952-ARG1
      *----------  取引データ.効力発生日
             MOVE  WK-KOURYOKU-YMD       OF  WK-TORI-DATA
               TO  KOURYOKU-YMD          OF  PARM-SMZC1952-ARG1
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1952-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1952-ARG1
      *----------  取引データ.異動数量
             MOVE  WK-IDO-SURYO          OF  WK-TORI-DATA
               TO  IDO-SURYO             OF  TORI-HIKI-PARM
               OF  PARM-SMZC1952-ARG1
      *----------  取引データ.権利数量
             MOVE  WK-KENRI-SURYO        OF  WK-TORI-DATA
               TO  KENRI-SURYO           OF  TORI-HIKI-PARM
               OF  PARM-SMZC1952-ARG1
      *----------  取引データ.資産負債・買建売建フラグ
             MOVE  WK-TATE-FLG           OF  WK-MEG-BETU-DMN-INFO
               TO  TATE-FLG              OF  TORI-HIKI-PARM
               OF  PARM-SMZC1952-ARG1
      *----------  取引データ.取引事由
             MOVE  WK-TORI-JIYU          OF  WK-TORI-DATA
               TO  TORI-JIYU             OF  TORI-HIKI-PARM
               OF  PARM-SMZC1952-ARG1
      *----------  取引データ.約定日
             MOVE  WK-YKJ-YMD            OF  WK-TORI-DATA
               TO  YAKU-YMD              OF  TORI-HIKI-PARM
               OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ.原取引ＩＤ=["
      D             TORI-ID             OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.受渡日=["
      D             UKE-YMD             OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":取引データ.既経過利息（市場通貨換算額）=["
      D             S-KSG-G-KKKRS       OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":取引データ.既経過利息（運用通貨換算額）=["
      D             U-KSG-G-KKKRS       OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.経過利息区分=["
      D             KKRS-KBN            OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.効力発生日=["
      D             KOURYOKU-YMD        OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG        OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG        OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.異動数量=["
      D             IDO-SURYO           OF  TORI-HIKI-PARM
      D             OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.権利数量=["
      D             KENRI-SURYO         OF  TORI-HIKI-PARM
      D             OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.資産負債・買建売建フラグ=["
      D             TATE-FLG OF TORI-HIKI-PARM OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.取引事由=["
      D             TORI-JIYU           OF  TORI-HIKI-PARM
      D             OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定日=["
      D             YAKU-YMD            OF  TORI-HIKI-PARM
      D             OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  計上基準日
           MOVE  WK-KEIJOU-KIJUNBI       OF  WK-TARGET-TORI-INFO
             TO  KEIJOU-KIJUNBI          OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":計上基準日=["
      D             KEIJOU-KIJUNBI       OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  異動数量
           MOVE  WK-IDO-SURYO            OF  WK-SURYO-CALC-KEKKA
             TO  IDO-SURYO               OF  ZN-IDO-DATA-PARM
             OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動数量=["
      D      IDO-SURYO  OF  ZN-IDO-DATA-PARM  OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  異動後数量残高
           MOVE  WK-IDOG-SRYZN           OF  WK-SURYO-CALC-KEKKA
             TO  IDOG-SRYZN              OF  ZN-IDO-DATA-PARM
             OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動後数量残高=["
      D      IDOG-SRYZN OF  ZN-IDO-DATA-PARM  OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  市場通貨前払金異動額
           IF  WK-SJTK-PPAYIDOG-FLG  =  CNS-C1
           THEN
             MOVE  WK-SJTK-PPAYIDOG      OF  WK-TORI-IDO
               TO  SJTK-PPAYIDOG         OF  PARM-SMZC1952-ARG1
           ELSE
             MOVE  WK-S-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  SJTK-PPAYIDOG         OF  PARM-SMZC1952-ARG1
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金異動額  = ["
      D             SJTK-PPAYIDOG        OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  運用通貨前払金異動額
           IF  WK-UYTK-PPAYIDOG-FLG  =  CNS-C1
           THEN
             MOVE  WK-UYTK-PPAYIDOG      OF  WK-TORI-IDO
               TO  UYTK-PPAYIDOG         OF  PARM-SMZC1952-ARG1
           ELSE
             MOVE  WK-U-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  UYTK-PPAYIDOG         OF  PARM-SMZC1952-ARG1
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額  = ["
      D             UYTK-PPAYIDOG        OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *----------  銘柄属性データ
      *---------- 初期利払起算日
           MOVE  WK-SHOKI-RIBAR-KS-YMD   OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  SHOKI-RIBAR-KS-YMD      OF  PARM-SMZC1952-ARG1
      *---------- 初期利払日
           MOVE  WK-SHOKI-RIBAR-YMD      OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  SHOKI-RIBAR-YMD         OF  PARM-SMZC1952-ARG1
      *---------- 最終利払起算日
           MOVE  WK-LAST-RIBAR-KISAN-YMD OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  LAST-RIBAR-KISAN-YMD    OF  PARM-SMZC1952-ARG1
      *---------- 最終利払日
           MOVE  WK-LAST-RIBAR-YMD       OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  LAST-RIBAR-YMD          OF  PARM-SMZC1952-ARG1
      *----------  利払回数
           MOVE  WK-RIBAR-KAISU          OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  RIBAR-KAISU             OF  PARM-SMZC1952-ARG1
      *----------  利払日１
           MOVE  WK-RIBAR-YMD-1          OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  RIBAR-YMD-1             OF  PARM-SMZC1952-ARG1
      *----------  利払日２
           MOVE  WK-RIBAR-YMD-2          OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  RIBAR-YMD-2             OF  PARM-SMZC1952-ARG1
      *----------  利払日３
           MOVE  WK-RIBAR-YMD-3          OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  RIBAR-YMD-3             OF  PARM-SMZC1952-ARG1
      *----------  利払日４
           MOVE  WK-RIBAR-YMD-4          OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  RIBAR-YMD-4             OF  PARM-SMZC1952-ARG1
      *----------  銘柄属性データ1
      *----------  利払日休日処理区分
           MOVE  WK-RIBAR-YMD-QJT-SR-KBN OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  RIBAR-YMD-QJT-SR-KBN    OF  PARM-SMZC1952-ARG1
      *----------  初期利払日休日処理区分
           MOVE  WK-SHOKI-RB-YMD-QJT-KBN OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  SHOKI-RB-YMD-QJT-KBN    OF  PARM-SMZC1952-ARG1
      *----------  終期利払日休日処理区分
           MOVE  WK-SHUKI-RB-YMD-QJT-KBN OF  WK-MEG-SKJO-DATA
                                         OF  WK-DATA-IN
             TO  SHUKI-RB-YMD-QJT-KBN    OF  PARM-SMZC1952-ARG1
      *----------  銘柄属性データ2
           MOVE  WK-MEG-SKJO-DATA-2      OF  WK-DATA-IN
             TO  MEG-SKJO-DATA-2         OF  PARM-SMZC1952-ARG1
      *----------  銘柄属性データ3
           MOVE  WK-MEG-SKJO-DATA-3      OF  WK-DATA-IN
             TO  MEG-SKJO-DATA-3         OF  PARM-SMZC1952-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ  = ["
      D             MEG-SKJO-DATA        OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ1 = ["
      D             MEG-SKJO-DATA-1      OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID "銘柄属性データ2.償還日  =["
      D             SHOKAN-YMD           OF
      D             MEG-SKJO-DATA-2      OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID "銘柄属性データ2.償還日休日処理区分  =["
      D             SHOKAN-QJT-SYRI-KBN  OF
      D             MEG-SKJO-DATA-2      OF  PARM-SMZC1952-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":WK-MEG-SKJO-DATA-3 = ["
      D             WK-MEG-SKJO-DATA-3   OF  WK-DATA-IN"]"
      D    DISPLAY  CNS-PGM-ID "銘柄属性データ3.利払日数  =["
      D             KEKA-NISU            OF
      D             MEG-SKJO-DATA-3      OF  PARM-SMZC1952-ARG1"]"
      *-----------------------------------------------------------------
      *---------- ②【SMZC1952】前払金計算コールをコールして、リターンパッケージを取得する
           CALL  "SMZC1952"              USING  PARM-SMZC1952-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1952)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
           WHEN  CNS-RTN-000
      *----------  A)ワーク前払金計算結果を初期化
             INITIALIZE  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果=["
      D             WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨前払金異動額.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-PPAYIDOG  OF  PARM-SMZC1952-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨前払金異動額.編集フラグ=["EDIT-FLG
      D             OF  SJTK-PPAYIDOG  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨前払金異動額←リターンパッケージ.市場通貨前払金異動額.バリュー
               MOVE  OUT-VALUES          OF  SJTK-PPAYIDOG
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-SJTK-PPAYIDOG    OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.市場通貨前払金異動額=["
      D             WK-SJTK-PPAYIDOG     OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨前払金異動額.編集フラグ=["EDIT-FLG
      D             OF  SJTK-PPAYIDOG  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨前払金異動額.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-PPAYIDOG  OF  PARM-SMZC1952-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨前払金異動額.編集フラグ=["EDIT-FLG
      D             OF  UYTK-PPAYIDOG  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨前払金異動額←リターンパッケージ.運用通貨前払金異動額.バリュー
               MOVE  OUT-VALUES          OF  UYTK-PPAYIDOG
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-UYTK-PPAYIDOG    OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.運用通貨前払金異動額=["
      D             WK-UYTK-PPAYIDOG     OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨前払金異動額.編集フラグ=["EDIT-FLG
      D             OF  UYTK-PPAYIDOG  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後前払金残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-PPAYZN
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後前払金残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-PPAYZN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨異動後前払金残←リターンパッケージ.市場通貨異動後前払金残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-PPAYZN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-SJTK-IDOG-PPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.市場通貨異動後前払金残=["
      D             WK-SJTK-IDOG-PPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨異動後前払金残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-PPAYZN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨異動後前払金残←ARG1.直前残高異動.市場通貨異動後前払金残
               MOVE  WK-SJTK-IDOG-PPAYZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-PPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.市場通貨異動後前払金残=["
      D             WK-SJTK-IDOG-PPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後前払金残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-PPAYZN
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後前払金残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-PPAYZN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨異動後前払金残←リターンパッケージ.運用通貨異動後前払金残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-PPAYZN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-UYTK-IDOG-PPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.運用通貨異動後前払金残=["
      D             WK-UYTK-IDOG-PPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨異動後前払金残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-PPAYZN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨異動後前払金残←ARG1.直前残高異動.運用通貨異動後前払金残
               MOVE  WK-UYTK-IDOG-PPAYZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-PPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.運用通貨異動後前払金残=["
      D             WK-UYTK-IDOG-PPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨異動後前受金残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-ARECZN  OF  PARM-SMZC1952-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨異動後前受金残.編集フラグ=["
      D            EDIT-FLG OF SJTK-IDOG-ARECZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨異動後前受金残←リターンパッケージ.市場通貨異動後前受金残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-ARECZN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-SJTK-IDOG-ARECZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.市場通貨異動後前受金残=["
      D             WK-SJTK-IDOG-ARECZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨異動後前受金残.編集フラグ=["
      D            EDIT-FLG OF SJTK-IDOG-ARECZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨異動後前受金残←ARG1.直前残高異動.市場通貨異動後前受金残
               MOVE  WK-SJTK-IDOG-ARECZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-ARECZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.市場通貨異動後前受金残=["
      D             WK-SJTK-IDOG-ARECZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後前受金残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-ARECZN  OF  PARM-SMZC1952-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨異動後前受金残.編集フラグ=["
      D            EDIT-FLG OF UYTK-IDOG-ARECZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨異動後前受金残←リターンパッケージ.運用通貨異動後前受金残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-ARECZN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-UYTK-IDOG-ARECZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.運用通貨異動後前受金残=["
      D             WK-UYTK-IDOG-ARECZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨異動後前受金残.編集フラグ=["
      D            EDIT-FLG OF UYTK-IDOG-ARECZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨異動後前受金残←ARG1.直前残高異動.運用通貨異動後前受金残
               MOVE  WK-UYTK-IDOG-ARECZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-ARECZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.運用通貨異動後前受金残=["
      D             WK-UYTK-IDOG-ARECZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨異動後仮払金残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-SPAYZN  OF  PARM-SMZC1952-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨異動後仮払金残.編集フラグ=["
      D            EDIT-FLG OF SJTK-IDOG-SPAYZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨異動後仮払金残←リターンパッケージ.市場通貨異動後仮払金残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-SPAYZN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-SJTK-IDOG-SPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.市場通貨異動後仮払金残=["
      D             WK-SJTK-IDOG-SPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.市場通貨異動後仮払金残.編集フラグ=["
      D            EDIT-FLG OF SJTK-IDOG-SPAYZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨異動後仮払金残←ARG1.直前残高異動.市場通貨異動後仮払金残
               MOVE  WK-SJTK-IDOG-SPAYZN  OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-SPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.市場通貨異動後仮払金残=["
      D             WK-SJTK-IDOG-SPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後仮払金残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-SPAYZN  OF  PARM-SMZC1952-ARG2
               = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨異動後仮払金残.編集フラグ=["
      D            EDIT-FLG OF UYTK-IDOG-SPAYZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨異動後仮払金残←リターンパッケージ.運用通貨異動後仮払金残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-SPAYZN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-UYTK-IDOG-SPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.運用通貨異動後仮払金残=["
      D             WK-UYTK-IDOG-SPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":リターンパッケージ.運用通貨異動後仮払金残.編集フラグ=["
      D            EDIT-FLG OF UYTK-IDOG-SPAYZN OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨異動後仮払金残←ARG1.直前残高異動.運用通貨異動後仮払金残
               MOVE  WK-UYTK-IDOG-SPAYZN  OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-SPAYZN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク前払金計算結果.運用通貨異動後仮払金残=["
      D             WK-UYTK-IDOG-SPAYZN  OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨前払金償却額（マイナス期間分）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-PPAY-SKK-MINU-KKN
                 OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨前払金償却額"
      D             "（マイナス期間分）.編集フラグ=["EDIT-FLG
      D             OF  SJTK-PPAY-SKK-MINU-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨前払金償却額（マイナス期間分）
      *----------  ←リターンパッケージ.市場通貨前払金償却額（マイナス期間分）.バリュー
               MOVE  OUT-VALUES          OF  SJTK-PPAY-SKK-MINU-KKN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-SJTK-PPAY-SKK-MINU-KKN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.市場通貨前払金償却"
      D             "額（マイナス期間分）=["WK-SJTK-PPAY-SKK-MINU-KKN
      D              OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨前払金償却額"
      D             "（マイナス期間分）.編集フラグ=["EDIT-FLG
      D             OF  SJTK-PPAY-SKK-MINU-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨前払金償却額（マイナス期間分）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-PPAY-SKK-MINU-KKN
                 OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨前払金償却額"
      D             "（マイナス期間分）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-PPAY-SKK-MINU-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨前払金償却額（マイナス期間分）
      *----------  ←リターンパッケージ.運用通貨前払金償却額（マイナス期間分）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-PPAY-SKK-MINU-KKN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-UYTK-PPAY-SKK-MINU-KKN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.運用通貨前払金償却"
      D             "額（マイナス期間分）=["WK-UYTK-PPAY-SKK-MINU-KKN
      D              OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨前払金償却額"
      D             "（マイナス期間分）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-PPAY-SKK-MINU-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨前払金償却額（プラス期間分）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-PPAY-SKK-PULS-KKN
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨前払金償却額"
      D             "（プラス期間分）.編集フラグ=["EDIT-FLG
      D             OF  SJTK-PPAY-SKK-PULS-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.市場通貨前払金償却額（プラス期間分）
      *----------  ←リターンパッケージ.市場通貨前払金償却額（プラス期間分）.バリュー
               MOVE  OUT-VALUES          OF  SJTK-PPAY-SKK-PULS-KKN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-SJTK-PPAY-SKK-PULS-KKN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.市場通貨前払金償却"
      D             "額（プラス期間分）=["WK-SJTK-PPAY-SKK-PULS-KKN
      D              OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨前払金償却額"
      D             "（プラス期間分）.編集フラグ=["EDIT-FLG
      D             OF  SJTK-PPAY-SKK-PULS-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨前払金償却額（プラス期間分）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-PPAY-SKK-PULS-KKN
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨前払金償却額"
      D             "（プラス期間分）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-PPAY-SKK-PULS-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.運用通貨前払金償却額（プラス期間分）
      *----------  ←リターンパッケージ.運用通貨前払金償却額（プラス期間分）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-PPAY-SKK-PULS-KKN
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-UYTK-PPAY-SKK-PULS-KKN
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.運用通貨前払金償却"
      D             "額（プラス期間分）=["WK-UYTK-PPAY-SKK-PULS-KKN
      D              OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨前払金償却額"
      D             "（プラス期間分）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-PPAY-SKK-PULS-KKN  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.直前の前払金未償却数量サマリ.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  TZ-MK-MSKK-SRY-SUM
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.直前の前払金未償却"
      D             "数量サマリ.編集フラグ=["EDIT-FLG
      D             OF  TZ-MK-MSKK-SRY-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.直前の前払金未償却数量サマリ
      *----------  ←リターンパッケージ.直前の前払金未償却数量サマリ.バリュー
               MOVE  OUT-VALUES          OF  TZ-MK-MSKK-SRY-SUM
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-TZ-MK-MSKK-SRY-SUM
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *----------  ARG2.直前の前払金未償却数量サマリ
      *----------  ←    リターンパッケージ.直前の前払金未償却数量サマリ.バリュー
               MOVE  OUT-VALUES          OF  TZ-MK-MSKK-SRY-SUM
                 OF  PARM-SMZC1952-ARG2
                 TO  TZ-MK-MSKK-SRY-SUM  OF  PARM-SMZJ1910-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.直前の前払金未"
      D             "償却数量サマリ=["WK-TZ-MK-MSKK-SRY-SUM
      D              OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.直前の前払金未償却数量サマリ=["
      D              TZ-MK-MSKK-SRY-SUM  OF  PARM-SMZJ1910-ARG2"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.直前の前払金未償却"
      D             "数量サマリ.編集フラグ=["EDIT-FLG
      D             OF  TZ-MK-MSKK-SRY-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.直前の前払金未償却数量サマリ（利金）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  TZ-MK-MSKK-SRY-RIKIN-SUM
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.直前の前払金未償却"
      D             "数量サマリ（利金）.編集フラグ=["EDIT-FLG
      D           OF  TZ-MK-MSKK-SRY-RIKIN-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.直前の前払金未償却数量サマリ（利金）
      *----------  ←リターンパッケージ.直前の前払金未償却数量サマリ（利金）.バリュー
               MOVE  OUT-VALUES          OF  TZ-MK-MSKK-SRY-RIKIN-SUM
                 OF  PARM-SMZC1952-ARG2
                 TO  WK-TZ-MK-MSKK-SRY-RIKIN-SUM
                 OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.直前の前払金未"
      D           "償却数量サマリ（利金）=["WK-TZ-MK-MSKK-SRY-RIKIN-SUM
      D              OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.直前の前払金未償却"
      D             "数量サマリ（利金）.編集フラグ=["EDIT-FLG
      D           OF  TZ-MK-MSKK-SRY-RIKIN-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.直前の市場通貨前払金サマリ.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  TZ-SJTK-PPAY-SUM
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":リターンパッケージ.直前の市場通貨前払金サマリ=["
      D         EDIT-FLG  OF  TZ-SJTK-PPAY-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.直前の市場通貨前払金サマリ
      *----------  ←   リターンパッケージ.直前の市場通貨前払金サマリ.バリュー
               MOVE  OUT-VALUES          OF  TZ-SJTK-PPAY-SUM
                 OF  PARM-SMZC1952-ARG2
                 TO  TZ-SJTK-PPAY-SUM  OF  PARM-SMZJ1910-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.直前の市場通貨前払金サマリ=["
      D              TZ-SJTK-PPAY-SUM  OF  PARM-SMZJ1910-ARG2"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":リターンパッケージ.直前の市場通貨前払金サマリ=["
      D         EDIT-FLG  OF  TZ-SJTK-PPAY-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.直前の運用通貨前払金サマリ.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  TZ-UYTK-PPAY-SUM
             OF  PARM-SMZC1952-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":リターンパッケージ.直前の運用通貨前払金サマリ=["
      D         EDIT-FLG  OF  TZ-UYTK-PPAY-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.直前の運用通貨前払金サマリ
      *----------  ←   リターンパッケージ.直前の運用通貨前払金サマリ.バリュー
               MOVE  OUT-VALUES          OF  TZ-UYTK-PPAY-SUM
                 OF  PARM-SMZC1952-ARG2
                 TO  TZ-UYTK-PPAY-SUM  OF  PARM-SMZJ1910-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.直前の運用通貨前払金サマリ=["
      D              TZ-UYTK-PPAY-SUM  OF  PARM-SMZJ1910-ARG2"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":リターンパッケージ.直前の運用通貨前払金サマリ=["
      D         EDIT-FLG  OF  TZ-UYTK-PPAY-SUM  OF PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.売却パタン=["
      D             BAKYK-PTN         OF  PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク前払金計算結果.売却パタン←リターンパッケージ.売却パタン
             MOVE  BAKYK-PTN          OF  PARM-SMZC1952-ARG2
               TO  WK-BAKYK-PTN       OF  WK-MAEBR-KIN-CALC-KEKKA
      *----------  ワーク前払金計算結果.購入パタン←リターンパッケージ.購入パタン
             MOVE  KOUNYU-PTN         OF  PARM-SMZC1952-ARG2
               TO  WK-KOUNYU-PTN      OF  WK-MAEBR-KIN-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.売却パタン=["
      D             WK-BAKYK-PTN      OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク前払金計算結果.購入パタン=["
      D             WK-KOUNYU-PTN     OF  WK-MAEBR-KIN-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1952-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1952-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1952-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           WHEN  CNS-RTN-113
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-076
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-113
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1952前払金計算  データ取得不能"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           WHEN  OTHER
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-077
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1952前払金計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** SMZC1952前払金計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1952-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1953売買損益計算をコールする
      ******************************************************************
       SMZC1953-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1953売買損益計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1953】売買損益計算コールに接続用パラメータの設定を行なう
      *----------  売買損益計算方法
           MOVE  WK-BBSONEKI-CALC-HOU   OF  WK-CALC-PTN
             TO  BBSNEKI-CLAC-HOU       OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":売買損益計算方法=["
      D             BBSNEKI-CLAC-HOU    OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.c01通貨フラグ＝'1'の場合
           IF  WK-TUKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  通貨デフォールト端数処理
             MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
               TO  TUKA-DEF-HASU-SYRI-PARM
               OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c02異動計算フラグ＝'1'の場合
           IF  WK-IDO-CALC-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  払出簿価計算方法
             MOVE  WK-DEBET-BOKA-CALC-HOU
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1953-ARG1
      *----------  払出簿価端数（市場通貨）
             MOVE  WK-DEBET-BOKA-HASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-HASU-BC   OF  PARM-SMZC1953-ARG1
      *----------  払出単価桁数（市場通貨）
             MOVE  WK-DEBET-TNK-KETASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-KETASU-BC  OF  PARM-SMZC1953-ARG1
      *----------  払出単価端数（市場通貨）
             MOVE  WK-DEBET-TNK-HASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-HASU-BC    OF  PARM-SMZC1953-ARG1
      *----------  払出簿価端数（運用通貨）
             MOVE  WK-DEBET-BOKA-HASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-HASU-LC   OF  PARM-SMZC1953-ARG1
      *----------  払出単価桁数（運用通貨）
             MOVE  WK-DEBET-TNK-KETASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-KETASU-LC  OF  PARM-SMZC1953-ARG1
      *----------  払出単価端数（運用通貨）
             MOVE  WK-DEBET-TNK-HASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-HASU-LC    OF  PARM-SMZC1953-ARG1
      *----------  簿価為替レート適用フラグ
             MOVE  WK-BOKA-KWS-TEKIYO-FLG
               OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1953-ARG1
      *----------  簿価為替レート端数
             MOVE  WK-BOKA-KWS-HASU     OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-HASU        OF  PARM-SMZC1953-ARG1
      *----------  簿価為替レート桁数
             MOVE  WK-BOKA-KWS-KETASU   OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-KETASU      OF  PARM-SMZC1953-ARG1
      *----------  按分簿価端数
             MOVE  WK-ANB-BOKA-HASU     OF  WK-YIDOU-CALC-PARM
               TO  ANB-BOKA-HASU        OF  PARM-SMZC1953-ARG1
      *----------  按分単価端数
             MOVE  WK-ANB-TNK-HASU      OF  WK-YIDOU-CALC-PARM
               TO  ANB-TNK-HASU         OF  PARM-SMZC1953-ARG1
      *----------  按分単価桁数
             MOVE  WK-ANB-TNK-KETASU    OF  WK-YIDOU-CALC-PARM
               TO  ANB-TNK-KETASU       OF  PARM-SMZC1953-ARG1
      *----------  前払金償却分端数
             MOVE  WK-MAEKIN-SHOUKYK-HASU
               OF  WK-YIDOU-CALC-PARM
               TO  MAEKIN-SHOUKYK-HASU  OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価計算方法=["
      D             DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（市場通貨"
      D             "）=["DEBET-BOKA-HASU-BC  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（市場通貨"
      D             "）=["DEBET-TNK-KETASU-BC  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（市場通貨"
      D             "）=["DEBET-TNK-HASU-BC  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（運用通貨"
      D             "）=["DEBET-BOKA-HASU-LC  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（運用通貨"
      D             "）=["DEBET-TNK-KETASU-LC  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（運用通貨"
      D             "）=["DEBET-TNK-HASU-LC  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート適用フラ"
      D             "グ=["BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート端数=["
      D             BOKA-KWS-HASU        OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート桁数=["
      D             BOKA-KWS-KETASU      OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分簿価端数=["
      D             ANB-BOKA-HASU        OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価端数=["
      D             ANB-TNK-HASU         OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価桁数=["
      D             ANB-TNK-KETASU       OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.前払金償却分端数=["
      D             MAEKIN-SHOUKYK-HASU  OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c04仕訳基準フラグ＝'1'の場合
           IF  WK-SWK-KJN-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c04仕訳基準"
      D             "フラグ=["WK-SWK-KJN-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益の計上フラグ
             MOVE  WK-UYTK-KWS-SNEKI-FLG
               OF  WK-SWK-KJN
               TO  UYTK-KWS-SNEKI-FLG    OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":為替差損益の計上フラグ=["
      D             UYTK-KWS-SNEKI-FLG   OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c04仕訳基準"
      D             "フラグ=["WK-SWK-KJN-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c05仕訳パターン分析フラグ＝'1'の場合
           IF  WK-SWK-PATTERN-BUNSEKI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1916.ARG2.売買損益仕訳フラグ=["
      D             BBSNEKI-SWK-FLG      OF  PARM-SMZJ1916-ARG2"]"
      *-----------------------------------------------------------------
      *----------  仕訳フラグ
             MOVE  BBSNEKI-SWK-FLG       OF  PARM-SMZJ1916-ARG2
               TO  SWK-FLG               OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":仕訳フラグ=["
      D             SWK-FLG              OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a07取引分析-オプションフラグ＝'1'の場合
           IF  WK-TORI-BUNSEKI-OPT-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a07取引分析-オ"
      D             "プションフラグ=["WK-TORI-BUNSEKI-OPT-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  コール／プットフラグ
             MOVE  WK-CALL-PUT-FLG       OF  WK-TORI-BUNSEKI-OPT
               TO  CALL-PUT-FLG          OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":コール／プットフラグ=["
      D             CALL-PUT-FLG         OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a07取引分析-オ"
      D             "プションフラグ=["WK-TORI-BUNSEKI-OPT-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-BOKAZN      OF  PARM-SMZC1953-ARG1
      *----------  直前の残高異動.市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-BOKAZN      OF  PARM-SMZC1953-ARG1
      *----------  直前の残高異動.異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-TZ-ZN-IDO
               TO  IDOG-SRYZN            OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後簿価残高=["
      D             UYTK-IDOG-BOKAZN     OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後簿価残高=["
      D             SJTK-IDOG-BOKAZN     OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.異動後数量残高        =["
      D             IDOG-SRYZN           OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d02簿価計算結果フラグ＝'1'の場合
           IF  WK-BOKA-CALC-KEKKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d02簿価計算結果"
      D             "フラグ=["WK-BOKA-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動簿価
             MOVE  WK-SJTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
               TO  SJTK-IDO-BOKA         OF  PARM-SMZC1953-ARG1
      *----------  運用通貨異動簿価
             MOVE  WK-UYTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
               TO  UYTK-IDO-BOKA         OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価=["
      D             SJTK-IDO-BOKA      OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価=["
      D             UYTK-IDO-BOKA      OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d02簿価計算結果"
      D             "フラグ=["WK-BOKA-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d01数量計算結果フラグ＝'1'の場合
           IF  WK-SURYO-CALC-KEKKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d01数量計算結果"
      D             "フラグ=["WK-SURYO-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  異動数量
             MOVE  WK-IDO-SURYO        OF  WK-SURYO-CALC-KEKKA
               TO  IDO-SURYO           OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動数量=["
      D             IDO-SURYO          OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d01数量計算結果"
      D             "フラグ=["WK-SURYO-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e07個別計算７フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-7-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e07個別計算７"
      D             "フラグ=["WK-KOBETSU-CALC-7-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨売買金額
             MOVE  UYTK-BS-KN            OF  PARM-SMZC1404-ARG2
               TO  UYTK-BS-KN            OF  KOBETSU-KOMK-CALC-7-PARM
               OF  PARM-SMZC1953-ARG1
      *----------  市場通貨売買金額
             MOVE  SJTK-BS-KN            OF  PARM-SMZC1404-ARG2
               TO  SJTK-BS-KN            OF  KOBETSU-KOMK-CALC-7-PARM
               OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨売買金額=["
      D             UYTK-BS-KN          OF  KOBETSU-KOMK-CALC-7-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買金額=["
      D             SJTK-BS-KN          OF  KOBETSU-KOMK-CALC-7-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e07個別計算７"
      D             "フラグ=["WK-KOBETSU-CALC-7-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e08個別計算８フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-8-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e08個別計算８"
      D             "フラグ=["WK-KOBETSU-CALC-8-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨売買金額
             MOVE  UYTK-BS-KN            OF  PARM-SMZC1405-ARG2
               TO  UYTK-BS-KN            OF  KOBETSU-KOMK-CALC-8-PARM
               OF  PARM-SMZC1953-ARG1
      *----------  市場通貨売買金額
             MOVE  SJTK-BS-KN            OF  PARM-SMZC1405-ARG2
               TO  SJTK-BS-KN            OF  KOBETSU-KOMK-CALC-8-PARM
               OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨売買金額=["
      D             UYTK-BS-KN           OF  KOBETSU-KOMK-CALC-8-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買金額=["
      D             SJTK-BS-KN           OF  KOBETSU-KOMK-CALC-8-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e08個別計算８"
      D             "フラグ=["WK-KOBETSU-CALC-8-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e10個別計算１０フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-10-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e10個別計算１０"
      D             "フラグ=["WK-KOBETSU-CALC-10-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１０.市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  SJTK-TESRY-BS-KN        OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１０.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１０.市場通貨その他費用（売買金額）
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１０.運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1407-ARG2
             TO  UYTK-TESRY-BS-KN        OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１０.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1407-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１０.運用通貨その他費用（売買金額）
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1407-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨その他費用（売買金額）=["
      D             SJTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN     OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨その他費用（売買金額）=["
      D             UYTK-ELS-HIYO-BS-KN OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e10個別計算１０"
      D             "フラグ=["WK-KOBETSU-CALC-10-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e11個別計算１１フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-11-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e11個別計算１１"
      D             "フラグ=["WK-KOBETSU-CALC-11-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１１.市場通貨前受・前払プレミアム計上額(売買損益)
           MOVE  BC-MAEUKE-MAEBR-VOLUME-BS
             OF  PARM-SMZC1408-ARG2
             TO  SJTK-MAEUKE-PARPM-KJYGK-BSNEKI
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１１.運用通貨前受・前払プレミアム計上額(売買損益)
           MOVE  LC-MAEUKE-MAEBR-VOLUME-BS
             OF  PARM-SMZC1408-ARG2
             TO  UYTK-MAEUKE-PARPM-KJYGK-BSNEKI
             OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":個別項目計算１１.市場通貨前受・前払プレ"
      D             "ミアム計上額(売買損益)=["
      D        SJTK-MAEUKE-PARPM-KJYGK-BSNEKI  OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算１１.運用通貨前受・前払プレ"
      D             "ミアム計上額(売買損益)=["
      D        UYTK-MAEUKE-PARPM-KJYGK-BSNEKI  OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e11個別計算１１"
      D             "フラグ=["WK-KOBETSU-CALC-11-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e15個別計算１５フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-15-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e15個別計算１５"
      D             "フラグ=["WK-KOBETSU-CALC-15-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１５.市場通貨買売金額
           MOVE  BC-BS-KN                OF  PARM-SMZC1412-ARG2
             TO  SJTK-BS-KN              OF  KOBETSU-KOMK-CALC-15-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１５.運用通貨買売金額
           MOVE  LC-BS-KN                OF  PARM-SMZC1412-ARG2
             TO  UYTK-BS-KN              OF  KOBETSU-KOMK-CALC-15-PARM
             OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":個別項目計算１５.市場通貨買売金額=["
      D             SJTK-BS-KN           OF  KOBETSU-KOMK-CALC-15-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算１５.運用通貨買売金額=["
      D             UYTK-BS-KN           OF  KOBETSU-KOMK-CALC-15-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e15個別計算１５"
      D             "フラグ=["WK-KOBETSU-CALC-15-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e18個別計算１８フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-18-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e18個別計算１８"
      D             "フラグ=["WK-KOBETSU-CALC-18-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１８.市場通貨売買損益
             MOVE  SJTK-BBSNEKI          OF  PARM-SMZC1415-ARG2
               TO  SJTK-BBSNEKI          OF  KOBETSU-KOMK-CALC-18-PARM
               OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算１８.運用通貨売買損益
             MOVE  UYTK-BBSNEKI          OF  PARM-SMZC1415-ARG2
               TO  UYTK-BBSNEKI          OF  KOBETSU-KOMK-CALC-18-PARM
               OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":個別項目計算１８.市場通貨売買損益=["
      D             SJTK-BBSNEKI         OF  KOBETSU-KOMK-CALC-18-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算１８.運用通貨売買損益=["
      D             UYTK-BBSNEKI         OF  KOBETSU-KOMK-CALC-18-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e18個別計算１８"
      D             "フラグ=["WK-KOBETSU-CALC-18-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *---------- 運用通貨予備売買金額←ワーク運用通貨予備売買金額
           MOVE  WK-UYTK-YOBI-BS-KN
             TO  UYTK-YOBI-BS-KN         OF  PARM-SMZC1953-ARG1
      *---------- 市場通貨予備売買金額←ワーク市場通貨予備売買金額
           MOVE  WK-SJTK-YOBI-BS-KN
             TO  SJTK-YOBI-BS-KN         OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":運用通貨予備売買金額=["
      D             UYTK-YOBI-BS-KN      OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨予備売買金額=["
      D             SJTK-YOBI-BS-KN      OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.為替レート（市場／運用）
             MOVE  WK-K-S-U-KWS          OF  WK-TARGET-TORI-INFO
               TO  S-U-KWS               OF  PARM-SMZC1953-ARG1
      *----------  取引データ.資産負債・買建売建フラグ
             MOVE  WK-TATE-FLG           OF  WK-MEG-BETU-DMN-INFO
               TO  TATE-FLG              OF  PARM-SMZC1953-ARG1
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1953-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1953-ARG1
      *----------  取引データ.既経過利息（市場通貨換算額）
             MOVE  WK-S-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  S-KSG-G-KKKRS         OF  PARM-SMZC1953-ARG1
      *----------  取引データ.既経過利息（運用通貨換算額）
             MOVE  WK-U-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  U-KSG-G-KKKRS         OF  PARM-SMZC1953-ARG1
      *----------  取引データ.精算金額（市場通貨換算額）
             MOVE  WK-S-KSG-SSKG         OF  WK-TORI-DATA
               TO  S-KSG-SSKG            OF  PARM-SMZC1953-ARG1
      *----------  取引データ.精算金額（運用通貨換算額）
             MOVE  WK-U-KSG-SSKG         OF  WK-TORI-DATA
               TO  U-KSG-G-SSKG          OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ.為替レート（市場／運用）=["
      D             S-U-KWS             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG        OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG        OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.既経過利息（市場通貨換算額）"
      D             "=["S-KSG-G-KKKRS   OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.既経過利息（運用通貨換算額）"
      D             "=["U-KSG-G-KKKRS   OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.精算金額（市場通貨換算額）"
      D             "=["S-KSG-SSKG      OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.精算金額（運用通貨換算額）"
      D             "=["U-KSG-G-SSKG    OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a02相対取引フラグ＝'1'の場合
           IF  WK-AITAI-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a02相対取引"
      D             "フラグ=["WK-AITAI-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  相対取引.決済単価
           MOVE  WK-KS-TANKA             OF  WK-AITAI-TRHK-DATA
             TO  KS-TANKA                OF  PARM-SMZC1953-ARG1
      *----------  相対取引.権利行使価格
           MOVE  WK-KRKS-KKK             OF  WK-AITAI-TRHK-DATA
             TO  KRKS-KKK                OF  PARM-SMZC1953-ARG1
      *----------  相対取引.建時単価
           MOVE  WK-TATE-TANKA           OF  WK-AITAI-TRHK-DATA
             TO  TATE-TANKA              OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":相対取引.決済単価=["
      D             KS-TANKA             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.権利行使価格=["
      D             KRKS-KKK             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引.建時単価=["
      D             TATE-TANKA           OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a02相対取引"
      D             "フラグ=["WK-AITAI-TORI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e21個別計算２１フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-21-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e03個別計算２１"
      D             "フラグ=["WK-KOBETSU-CALC-21-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２１.市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1418-ARG2
             TO  SJTK-TESRY-BS-KN        OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算２１.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1418-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算２１.市場通貨その他費用（売買金額）
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1418-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.市場通貨日歩（売買金額）
           MOVE  SJTK-HIBU-BS-KN         OF  PARM-SMZC1418-ARG2
             TO  SJTK-HIBU-BS-KN         OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.市場通貨逆日歩（売買金額）
           MOVE  SJTK-GHIBU-BS-KN        OF  PARM-SMZC1418-ARG2
             TO  SJTK-GHIBU-BS-KN        OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.市場通貨管理費（売買金額）
           MOVE  SJTK-KRH-BS-KN          OF  PARM-SMZC1418-ARG2
             TO  SJTK-KRH-BS-KN          OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.市場通貨管理費消費税（売買金額）
           MOVE  SJTK-KRH-SHZ-BS-KN      OF  PARM-SMZC1418-ARG2
             TO  SJTK-KRH-SHZ-BS-KN      OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算２１.運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1418-ARG2
             TO  UYTK-TESRY-BS-KN        OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算２１.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1418-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算２１.運用通貨その他費用（売買金額）
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1418-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.運用通貨日歩（売買金額）
           MOVE  UYTK-HIBU-BS-KN         OF  PARM-SMZC1418-ARG2
             TO  UYTK-HIBU-BS-KN         OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.運用通貨逆日歩（売買金額）
           MOVE  UYTK-GHIBU-BS-KN        OF  PARM-SMZC1418-ARG2
             TO  UYTK-GHIBU-BS-KN        OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.運用通貨管理費（売買金額）
           MOVE  UYTK-KRH-BS-KN          OF  PARM-SMZC1418-ARG2
             TO  UYTK-KRH-BS-KN          OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 個別項目計算２１.運用通貨管理費消費税（売買金額）
           MOVE  UYTK-KRH-SHZ-BS-KN      OF  PARM-SMZC1418-ARG2
             TO  UYTK-KRH-SHZ-BS-KN      OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨その他費用（売買金額）=["
      D             SJTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨日歩（売買金額）      =["
      D             SJTK-HIBU-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨逆日歩（売買金額）=["
      D             SJTK-GHIBU-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨管理費（売買金額）=["
      D             SJTK-KRH-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":個別項目計算２１.市場通貨管理費消費税（売買金額）=["
      D             SJTK-KRH-SHZ-BS-KN  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨その他費用（売買金額）=["
      D             UYTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨日歩（売買金額）      =["
      D             UYTK-HIBU-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨逆日歩（売買金額）=["
      D             UYTK-GHIBU-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨管理費（売買金額）=["
      D             UYTK-KRH-BS-KN    OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":個別項目計算２１.運用通貨管理費消費税（売買金額）=["
      D             UYTK-KRH-SHZ-BS-KN  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e21個別計算２１"
      D             "フラグ=["WK-KOBETSU-CALC-21-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
            CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a11取引分析-為替差損益フラグ＝'1'の場合
           IF  WK-TRBNSEKI-KWSNEKI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a11取引分析-為替"
      D             "差損益フラグ=["WK-TRBNSEKI-KWSNEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *---------- 為替差損益フラグ
           MOVE  WK-KWS-SNEKI-FLG
             TO  KWS-SNEKI-FLG           OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":為替差損益フラグ=["
      D             KWS-SNEKI-FLG        OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a11取引分析-為替"
      D             "差損益フラグ=["WK-TRBNSEKI-KWSNEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e22個別計算２２フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-22-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２２.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1953-ARG1
      *----------  個別項目計算２２.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1953-ARG1
      *---------- 運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1953-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1953-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
            CONTINUE
           END-IF
      *---------- ②【SMZC1953】売買損益計算コールをコールして、リターンパッケージを取得する
           CALL  "SMZC1953"              USING  PARM-SMZC1953-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1953)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク売買損益計算結果を初期化
             INITIALIZE  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売買損益計算結果=["
      D             WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨売買損益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-BBSNEKI  OF  PARM-SMZC1953-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨売買損益.編集フラグ=["EDIT-FLG
      D             OF  SJTK-BBSNEKI  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.市場通貨売買損益←リターンパッケージ.市場通貨売買損益.バリュー
               MOVE  OUT-VALUES          OF  SJTK-BBSNEKI
                 OF  PARM-SMZC1953-ARG2
                 TO  WK-SJTK-BBSNEKI     OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.市場通貨売買損益=["
      D             WK-SJTK-BBSNEKI      OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨売買損益.編集フラグ=["EDIT-FLG
      D             OF  SJTK-BBSNEKI  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨売買損益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-BBSNEKI  OF  PARM-SMZC1953-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨売買損益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-BBSNEKI  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.運用通貨売買損益←リターンパッケージ.運用通貨売買損益.バリュー
               MOVE  OUT-VALUES          OF  UYTK-BBSNEKI
                 OF  PARM-SMZC1953-ARG2
                 TO  WK-UYTK-BBSNEKI     OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.運用通貨売買損益=["
      D             WK-UYTK-BBSNEKI      OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨売買損益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-BBSNEKI  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.為替差損益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-KWS-SNEKI OF  PARM-SMZC1953-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.為替差損益.編集フラグ=["
      D           EDIT-FLG  OF  UYTK-KWS-SNEKI  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.為替差損益←リターンパッケージ.為替差損益.バリュー
               MOVE  OUT-VALUES          OF  UYTK-KWS-SNEKI
                 OF  PARM-SMZC1953-ARG2
                 TO  WK-UYTK-KWS-SNEKI
                 OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売買損益計算結果.為替差損益=["
      D             WK-UYTK-KWS-SNEKI    OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージ.為替差損益.編集フラグ=["
      D           EDIT-FLG  OF  UYTK-KWS-SNEKI  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.為替差損益（市場）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-KWS-SNEKI-SJ  OF  PARM-SMZC1953-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.為替差損益（市場）.編集フラグ=["
      D        EDIT-FLG  OF  UYTK-KWS-SNEKI-SJ  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.為替差損益（市場）←リターンパッケージ.為替差損益（市場）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-KWS-SNEKI-SJ
                 OF  PARM-SMZC1953-ARG2
                 TO  WK-UYTK-KWS-SNEKI-SJ
                 OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.為替差損益（市場）=["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.為替差損益（市場）.編集フラグ=["
      D        EDIT-FLG  OF  UYTK-KWS-SNEKI-SJ  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.為替差損益（利金）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-KWS-SNEKI-RK  OF  PARM-SMZC1953-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.為替差損益（利金）.編集フラグ=["
      D        EDIT-FLG  OF  UYTK-KWS-SNEKI-RK  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.為替差損益（利金）←リターンパッケージ.為替差損益（利金）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-KWS-SNEKI-RK
                 OF  PARM-SMZC1953-ARG2
                 TO  WK-UYTK-KWS-SNEKI-RK
                 OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.為替差損益（利金）=["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":リターンパッケージ.為替差損益（利金）.編集フラグ=["
      D        EDIT-FLG  OF  UYTK-KWS-SNEKI-RK  OF PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1953-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1953-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1953-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-078
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1953売買損益計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
           IF  WK-TORI-IDO-FLG = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-SJTK-BBSNEKI  OF  WK-TORI-IDO  NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨売買損益=["
      D             WK-SJTK-BBSNEKI      OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.市場通貨売買損益 ← ワーク取引異動.市場通貨売買損益
               MOVE  WK-SJTK-BBSNEKI     OF  WK-TORI-IDO
                 TO  WK-SJTK-BBSNEKI     OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.市場通貨売買損益=["
      D             WK-SJTK-BBSNEKI      OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨売買損益が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  WK-UYTK-BBSNEKI  OF  WK-TORI-IDO  NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨売買損益=["
      D             WK-UYTK-BBSNEKI      OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.運用通貨売買損益 ← ワーク取引異動.運用通貨売買損益
             MOVE  WK-UYTK-BBSNEKI       OF  WK-TORI-IDO
               TO  WK-UYTK-BBSNEKI       OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.運用通貨売買損益=["
      D             WK-UYTK-BBSNEKI      OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨売買損益が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  WK-UYTK-KWS-SNEKI OF  WK-TORI-IDO  NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益=["
      D             WK-UYTK-KWS-SNEKI     OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.為替差損益 ← ワーク取引異動.為替差損益
               MOVE  WK-UYTK-KWS-SNEKI    OF  WK-TORI-IDO
                 TO  WK-UYTK-KWS-SNEKI    OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.為替差損益=["
      D             WK-UYTK-KWS-SNEKI    OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  WK-UYTK-KWS-SNEKI-SJ OF WK-TORI-IDO NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（市場）=["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.為替差損益 （市場）← ワーク取引異動.為替差損益（市場）
               MOVE  WK-UYTK-KWS-SNEKI-SJ  OF  WK-TORI-IDO
                 TO  WK-UYTK-KWS-SNEKI-SJ  OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.為替差損益（市場）=["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.為替差損益（市場）が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  WK-UYTK-KWS-SNEKI-RK OF WK-TORI-IDO NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）=["
      D             WK-UYTK-KWS-SNEKI-RK     OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク売買損益計算結果.為替差損益（利金） ← ワーク取引異動.為替差損益（利金）
               MOVE  WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO
                 TO  WK-UYTK-KWS-SNEKI-RK  OF  WK-BBSONEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.為替差損益（利金）=["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.為替差損益（利金）が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1953売買損益計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1953-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1954その他損益計算をコールする
      ******************************************************************
       SMZC1954-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1954その他損益計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1954】その他損益計算コールに接続用パラメータの設定を行なう
      *----------  その他損益計算方法
           MOVE  WK-ELS-SNEKI-CALC-HOU   OF  WK-CALC-PTN
             TO  ELS-SNEKI-CALC-HOU      OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":その他損益計算方法=["
      D             ELS-SNEKI-CALC-HOU  OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.e03個別計算３フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-3-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *----------  個別項目計算３.運用通貨手数料（費用計上）
           MOVE  UYTK-TESRY-HIYO-KJY     OF  PARM-SMZC1400-ARG2
             TO  UYTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算３.運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1400-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算３.運用通貨その他費用（費用計上）
           MOVE  UYTK-ELS-HIYO-KJY       OF  PARM-SMZC1400-ARG2
             TO  UYTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算３.市場通貨手数料（費用計上）
           MOVE  SJTK-TESRY-HIYO-KJY     OF  PARM-SMZC1400-ARG2
             TO  SJTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算３.市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1400-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算３.市場通貨その他費用（費用計上）
           MOVE  SJTK-ELS-HIYO-KJY       OF  PARM-SMZC1400-ARG2
             TO  SJTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e03個別計算３"
      D             "フラグ=["WK-KOBETSU-CALC-3-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.運用通貨手数料（費用計上）=["
      D             UYTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.運用通貨その他費用（費用計上）=["
      D             UYTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.市場通貨手数料（費用計上）=["
      D             SJTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.市場通貨その他費用（費用計上）=["
      D             SJTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e03個別計算３"
      D             "フラグ=["WK-KOBETSU-CALC-3-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e09個別計算９フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-9-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e09個別計算９フラグ=["
      D             WK-KOBETSU-CALC-9-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算９.運用通貨手数料（費用計上）
           MOVE  UYTK-TESRY-HIYO-KJY     OF  PARM-SMZC1406-ARG2
             TO  UYTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-9-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算９.運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1406-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-9-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算９.運用通貨その他費用（費用計上）
           MOVE  UYTK-ELS-HIYO-KJY       OF  PARM-SMZC1406-ARG2
             TO  UYTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-9-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算９.市場通貨手数料（費用計上）
           MOVE  SJTK-TESRY-HIYO-KJY     OF  PARM-SMZC1406-ARG2
             TO  SJTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-9-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算９.市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1406-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-9-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算９.市場通貨その他費用（費用計上）
           MOVE  SJTK-ELS-HIYO-KJY       OF  PARM-SMZC1406-ARG2
             TO  SJTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-9-PARM
             OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨手数料（費用計上）=["
      D             UYTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.運用通貨その他費用（費用計上）=["
      D             UYTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.市場通貨手数料（費用計上）=["
      D             SJTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算９.市場通貨その他費用（費用計上）=["
      D             SJTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-9-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク素データ分析結果.e09個別計算９フラグ=["
      D             WK-KOBETSU-CALC-9-FLG OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e10個別計算１０フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-10-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e10個別計算１０"
      D             "フラグ=["WK-KOBETSU-CALC-10-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１０.運用通貨手数料（費用計上）
           MOVE  UYTK-TESRY-HIYO-KJY     OF  PARM-SMZC1407-ARG2
             TO  UYTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算１０.運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1407-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算１０.運用通貨その他費用（費用計上）
           MOVE  UYTK-ELS-HIYO-KJY       OF  PARM-SMZC1407-ARG2
             TO  UYTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算１０.市場通貨手数料（費用計上）
           MOVE  SJTK-TESRY-HIYO-KJY     OF  PARM-SMZC1407-ARG2
             TO  SJTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算１０.市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1407-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算１０.市場通貨その他費用（費用計上）
           MOVE  SJTK-ELS-HIYO-KJY       OF  PARM-SMZC1407-ARG2
             TO  SJTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-10-PARM
             OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨手数料（費用計上）=["
      D             UYTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.運用通貨その他費用（費用計上）=["
      D             UYTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨手数料（費用計上）=["
      D             SJTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算１０.市場通貨その他費用（費用計上）=["
      D             SJTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-10-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e10個別計算１０"
      D             "フラグ=["WK-KOBETSU-CALC-10-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e21個別計算２１フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-21-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e21個別計算２１"
      D             "フラグ=["WK-KOBETSU-CALC-21-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２１.市場通貨手数料（費用計上）
           MOVE  SJTK-TESRY-HIYO-KJY     OF  PARM-SMZC1418-ARG2
             TO  SJTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算２１.市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1418-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算２１.市場通貨その他費用（費用計上）
           MOVE  SJTK-ELS-HIYO-KJY       OF  PARM-SMZC1418-ARG2
             TO  SJTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算２１.運用通貨手数料（費用計上）
           MOVE  UYTK-TESRY-HIYO-KJY     OF  PARM-SMZC1418-ARG2
             TO  UYTK-TESRY-HIYO-KJY     OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算２１.運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1418-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算２１.運用通貨その他費用（費用計上）
           MOVE  UYTK-ELS-HIYO-KJY       OF  PARM-SMZC1418-ARG2
             TO  UYTK-ELS-HIYO-KJY       OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.市場通貨日歩（費用計上）
           MOVE  SJTK-HIBU-HIYO-KJY      OF  PARM-SMZC1418-ARG2
             TO  SJTK-HIBU-HIYO-KJY      OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.市場通貨逆日歩（費用計上）
           MOVE  SJTK-GHIBU-HIYO-KJY     OF  PARM-SMZC1418-ARG2
             TO  SJTK-GHIBU-HIYO-KJY     OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.市場通貨管理費（費用計上）
           MOVE  SJTK-KRH-HIYO-KJY       OF  PARM-SMZC1418-ARG2
             TO  SJTK-KRH-HIYO-KJY       OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.市場通貨管理費消費税（費用計上）
           MOVE  SJTK-KRH-SHZ-HIYO-KJY   OF  PARM-SMZC1418-ARG2
             TO  SJTK-KRH-SHZ-HIYO-KJY   OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.運用通貨日歩（費用計上）
           MOVE  UYTK-HIBU-HIYO-KJY      OF  PARM-SMZC1418-ARG2
             TO  UYTK-HIBU-HIYO-KJY      OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.運用通貨逆日歩（費用計上）
           MOVE  UYTK-GHIBU-HIYO-KJY     OF  PARM-SMZC1418-ARG2
             TO  UYTK-GHIBU-HIYO-KJY     OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.運用通貨管理費（費用計上）
           MOVE  UYTK-KRH-HIYO-KJY       OF  PARM-SMZC1418-ARG2
             TO  UYTK-KRH-BS-HIYO-KJY    OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 個別項目計算２１.運用通貨管理費消費税（費用計上）
           MOVE  UYTK-KRH-SHZ-HIYO-KJY   OF  PARM-SMZC1418-ARG2
             TO  UYTK-KRH-SHZ-HIYO-KJY   OF  KOBETSU-KOMK-CALC-21-PARM
             OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨手数料（費用計上）=["
      D             UYTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨その他費用（費用計上）=["
      D             UYTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨手数料（費用計上）=["
      D             SJTK-TESRY-HIYO-KJY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY   OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨その他費用（費用計上）=["
      D             SJTK-ELS-HIYO-KJY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨日歩（費用計上）      =["
      D             SJTK-HIBU-HIYO-KJY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨逆日歩（費用計上）=["
      D             SJTK-GHIBU-HIYO-KJY   OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.市場通貨管理費（費用計上）=["
      D             SJTK-KRH-HIYO-KJY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":個別項目計算２１.市場通貨管理費消費税（費用計上）=["
      D             SJTK-KRH-SHZ-HIYO-KJY OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨日歩（費用計上）      =["
      D             UYTK-HIBU-HIYO-KJY  OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨逆日歩（費用計上）=["
      D             UYTK-GHIBU-HIYO-KJY   OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２１.運用通貨管理費（費用計上）=["
      D             UYTK-KRH-BS-HIYO-KJY OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":個別項目計算２１.運用通貨管理費消費税（費用計上）=["
      D             UYTK-KRH-SHZ-HIYO-KJY OF  KOBETSU-KOMK-CALC-21-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e21個別計算２１"
      D             "フラグ=["WK-KOBETSU-CALC-21-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.現地源泉税（運用通貨換算額）
             MOVE  WK-U-KSG-G-GSZ        OF  WK-TORI-DATA
               TO  U-KSG-G-GSZ           OF  PARM-SMZC1954-ARG1
      *----------  取引データ.国内源泉税（運用通貨換算額）
             MOVE  WK-NAI-TAX-U-KSG      OF  WK-TORI-DATA
               TO  NAI-TAX-U-KSG         OF  PARM-SMZC1954-ARG1
      *----------  取引データ.現地源泉税（市場通貨換算額）
             MOVE  WK-S-KSG-G-GSZ        OF  WK-TORI-DATA
               TO  S-KSG-G-GSZ           OF  PARM-SMZC1954-ARG1
      *----------  取引データ.現地消費税（市場通貨換算額）
             MOVE  WK-S-KSG-G-SHZ        OF  WK-TORI-DATA
               TO  S-KSG-G-SHZ           OF  PARM-SMZC1954-ARG1
      *----------  取引データ.現地消費税（運用通貨換算額）
            MOVE  WK-U-KSG-G-SHZ        OF  WK-TORI-DATA
               TO  U-KSG-G-SHZ           OF  PARM-SMZC1954-ARG1
      *----------  取引データ.運用国消費税（運用通貨換算額）
             MOVE  WK-U-KSG-U-SHZ        OF  WK-TORI-DATA
               TO  U-KSG-U-SHZ           OF  PARM-SMZC1954-ARG1
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1954-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1954-ARG1
      *----------  取引データ.資産負債・買建売建フラグ
             MOVE  WK-TATE-FLG           OF  WK-TORI-DATA
               TO  TATE-FLG              OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ.現地源泉税（運用通貨換算額）"
      D             "=["U-KSG-G-GSZ      OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.国内源泉税（運用通貨換算額）"
      D             "=["NAI-TAX-U-KSG    OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地源泉税（市場通貨換算額）"
      D             "=["S-KSG-G-GSZ      OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地消費税（市場通貨換算額）"
      D             "=["S-KSG-G-SHZ      OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.現地消費税（運用通貨換算額）"
      D             "=["U-KSG-G-SHZ      OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.運用国消費税（運用通貨換算額"
      D             "）=["U-KSG-U-SHZ    OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.資産負債・買建売建フラグ=["
      D             TATE-FLG             OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c05仕訳パターン分析フラグ＝'1'の場合
           IF  WK-SWK-PATTERN-BUNSEKI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1916.ARG2.その他損益仕訳フラグ=["
      D             ELS-SNEKI-SWK-FLG    OF  PARM-SMZJ1916-ARG2"]"
      *-----------------------------------------------------------------
      *----------  仕訳フラグ
             MOVE  ELS-SNEKI-SWK-FLG     OF  PARM-SMZJ1916-ARG2
               TO  SWK-FLG               OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":仕訳フラグ=["
      D             SWK-FLG              OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e22個別計算２２フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-22-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２２.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1954-ARG1
      *----------  個別項目計算２２.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1954-ARG1
      *---------- 運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1954-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1954-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
            CONTINUE
           END-IF
      *---------- ②【SMZC1954】その他損益計算をコールして、リターンパッケージを取得する
           CALL  "SMZC1954"              USING  PARM-SMZC1954-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1954)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワークその他損益計算結果を初期化
             INITIALIZE  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークその他損益計算結果=["
      D             WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨手数料.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-TESRY  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨手数料.編集フラグ=["EDIT-FLG
      D             OF  SJTK-TESRY       OF PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.市場通貨手数料←リターンパッケージ.市場通貨手数料.バリュー
               MOVE  OUT-VALUES          OF  SJTK-TESRY
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-SJTK-TSR         OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.市場通貨手数料=["
      D             WK-SJTK-TSR          OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨手数料.編集フラグ=["EDIT-FLG
      D             OF  SJTK-TESRY       OF PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨手数料.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-TESRY  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨手数料.編集フラグ=["EDIT-FLG
      D             OF  UYTK-TESRY       OF PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.運用通貨手数料←リターンパッケージ.運用通貨手数料.バリュー
               MOVE  OUT-VALUES          OF  UYTK-TESRY
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-UYTK-TSR         OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.運用通貨手数料=["
      D             WK-UYTK-TSR          OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨手数料.編集フラグ=["EDIT-FLG
      D             OF  UYTK-TESRY       OF PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨消費税.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-SHOHI-TAX  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨消費税.編集フラグ=["EDIT-FLG
      D             OF  SJTK-SHOHI-TAX   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.市場通貨消費税←リターンパッケージ.市場通貨消費税.バリュー
               MOVE  OUT-VALUES          OF  SJTK-SHOHI-TAX
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-SJTK-S-TAX       OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.市場通貨消費税=["
      D             WK-SJTK-S-TAX        OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨消費税.編集フラグ=["EDIT-FLG
      D             OF  SJTK-SHOHI-TAX   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨消費税.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-SHOHI-TAX  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨消費税.編集フラグ=["EDIT-FLG
      D             OF  UYTK-SHOHI-TAX   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.運用通貨消費税←リターンパッケージ.運用通貨消費税.バリュー
               MOVE  OUT-VALUES          OF  UYTK-SHOHI-TAX
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-UYTK-S-TAX       OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.運用通貨消費税=["
      D             WK-UYTK-S-TAX        OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨消費税.編集フラグ=["EDIT-FLG
      D             OF  UYTK-SHOHI-TAX   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨その他損益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-ELS-SNEKI  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨その他損益.編集フラグ=["EDIT-FLG
      D             OF  SJTK-ELS-SNEKI   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.市場通貨その他損益←リターンパッケージ.市場通貨その他損益.バリュー
               MOVE  OUT-VALUES          OF  SJTK-ELS-SNEKI
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-SJTK-ELS-SNEKI   OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.市場通貨その他損益=["
      D             WK-SJTK-ELS-SNEKI    OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨その他損益.編集フラグ=["EDIT-FLG
      D             OF  SJTK-ELS-SNEKI   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨その他損益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-ELS-SNEKI  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨その他損益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-ELS-SNEKI   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.運用通貨その他損益←リターンパッケージ.運用通貨その他損益.バリュー
               MOVE  OUT-VALUES          OF  UYTK-ELS-SNEKI
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-UYTK-ELS-SNEKI   OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.運用通貨その他損益=["
      D             WK-UYTK-ELS-SNEKI    OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨その他損益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-ELS-SNEKI   OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨源泉税.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-GENSEN-TAX  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨源泉税.編集フラグ=["EDIT-FLG
      D             OF  SJTK-GENSEN-TAX  OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.市場通貨源泉税←リターンパッケージ.市場通貨源泉税.バリュー
               MOVE  OUT-VALUES          OF  SJTK-GENSEN-TAX
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-SJTK-GENSEN-TAX  OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.市場通貨源泉税=["
      D             WK-SJTK-GENSEN-TAX   OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨源泉税.編集フラグ=["EDIT-FLG
      D             OF  SJTK-GENSEN-TAX  OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨源泉税.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-GENSEN-TAX  OF  PARM-SMZC1954-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨源泉税.編集フラグ=["EDIT-FLG
      D             OF  UYTK-GENSEN-TAX  OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークその他損益計算結果.運用通貨源泉税←リターンパッケージ.運用通貨源泉税.バリュー
               MOVE  OUT-VALUES          OF  UYTK-GENSEN-TAX
                 OF  PARM-SMZC1954-ARG2
                 TO  WK-UYTK-GENSEN-TAX  OF  WK-ELS-SNEKI-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークその他損益計算結果.運用通貨源泉税=["
      D             WK-UYTK-GENSEN-TAX   OF  WK-ELS-SNEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨源泉税.編集フラグ=["EDIT-FLG
      D             OF  UYTK-GENSEN-TAX  OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1954-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1954-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1954-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-079
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1954その他損益計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1954その他損益計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1954-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1955損益勘定計算をコールする
      ******************************************************************
       SMZC1955-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1955損益勘定計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1955】損益勘定計算コールに接続用パラメータの設定を行なう
      *----------  損益勘定計算方法
           MOVE  WK-RKSEKJ-CALC-HOU     OF  WK-CALC-PTN
             TO  SNEKI-KNJ-CLAC         OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":損益勘定計算方法=["
      D             SNEKI-KNJ-CLAC      OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.c01通貨フラグ＝'1'の場合
           IF  WK-TUKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  通貨デフォールト端数処理
             MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
               TO  TUKA-DEF-HASU-SYRI-PARM
               OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c02異動計算フラグ＝'1'の場合
           IF  WK-IDO-CALC-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  払出簿価計算方法
             MOVE  WK-DEBET-BOKA-CALC-HOU
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1955-ARG1
      *----------  払出簿価端数（市場通貨）
             MOVE  WK-DEBET-BOKA-HASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-HASU-BC   OF  PARM-SMZC1955-ARG1
      *----------  払出単価桁数（市場通貨）
             MOVE  WK-DEBET-TNK-KETASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-KETASU-BC  OF  PARM-SMZC1955-ARG1
      *----------  払出単価端数（市場通貨）
             MOVE  WK-DEBET-TNK-HASU-BC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-HASU-BC    OF  PARM-SMZC1955-ARG1
      *----------  払出簿価端数（運用通貨）
             MOVE  WK-DEBET-BOKA-HASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-BOKA-HASU-LC   OF  PARM-SMZC1955-ARG1
      *----------  払出単価桁数（運用通貨）
             MOVE  WK-DEBET-TNK-KETASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-KETASU-LC  OF  PARM-SMZC1955-ARG1
      *----------  払出単価端数（運用通貨）
             MOVE  WK-DEBET-TNK-HASU-LC
               OF  WK-YIDOU-CALC-PARM
               TO  DEBET-TNK-HASU-LC    OF  PARM-SMZC1955-ARG1
      *----------  簿価為替レート適用フラグ
             MOVE  WK-BOKA-KWS-TEKIYO-FLG
               OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1955-ARG1
      *----------  簿価為替レート端数
             MOVE  WK-BOKA-KWS-HASU     OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-HASU        OF  PARM-SMZC1955-ARG1
      *----------  簿価為替レート桁数
             MOVE  WK-BOKA-KWS-KETASU   OF  WK-YIDOU-CALC-PARM
               TO  BOKA-KWS-KETASU      OF  PARM-SMZC1955-ARG1
      *----------  按分簿価端数
             MOVE  WK-ANB-BOKA-HASU     OF  WK-YIDOU-CALC-PARM
               TO  ANB-BOKA-HASU        OF  PARM-SMZC1955-ARG1
      *----------  按分単価端数
             MOVE  WK-ANB-TNK-HASU      OF  WK-YIDOU-CALC-PARM
               TO  ANB-TNK-HASU         OF  PARM-SMZC1955-ARG1
      *----------  按分単価桁数
             MOVE  WK-ANB-TNK-KETASU    OF  WK-YIDOU-CALC-PARM
               TO  ANB-TNK-KETASU       OF  PARM-SMZC1955-ARG1
      *----------  前払金償却分端数
             MOVE  WK-MAEKIN-SHOUKYK-HASU
               OF  WK-YIDOU-CALC-PARM
               TO  MAEKIN-SHOUKYK-HASU  OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価計算方法=["
      D             DEBET-BOKA-CALC-HOU  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（市場通貨"
      D             "）=["DEBET-BOKA-HASU-BC  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（市場通貨"
      D             "）=["DEBET-TNK-KETASU-BC  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（市場通貨"
      D             "）=["DEBET-TNK-HASU-BC  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出簿価端数（運用通貨"
      D             "）=["DEBET-BOKA-HASU-LC  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価桁数（運用通貨"
      D             "）=["DEBET-TNK-KETASU-LC  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.払出単価端数（運用通貨"
      D             "）=["DEBET-TNK-HASU-LC  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート適用フラ"
      D             "グ=["BOKA-KWS-TEKIYO-FLG  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート端数=["
      D             BOKA-KWS-HASU        OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.簿価為替レート桁数=["
      D             BOKA-KWS-KETASU      OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分簿価端数=["
      D             ANB-BOKA-HASU        OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価端数=["
      D             ANB-TNK-HASU         OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.按分単価桁数=["
      D             ANB-TNK-KETASU       OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン.前払金償却分端数=["
      D             MAEKIN-SHOUKYK-HASU  OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c02異動計算"
      D             "フラグ=["WK-IDO-CALC-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c04仕訳基準フラグ＝'1'の場合
           IF  WK-SWK-KJN-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c04仕訳基準"
      D             "フラグ=["WK-SWK-KJN-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益の計上フラグ
             MOVE  WK-UYTK-KWS-SNEKI-FLG
               OF  WK-SWK-KJN
               TO  UYTK-KWS-SNEKI-FLG    OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":為替差損益の計上フラグ=["
      D             UYTK-KWS-SNEKI-FLG   OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c04仕訳基準"
      D             "フラグ=["WK-SWK-KJN-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.c05仕訳パターン分析フラグ＝'1'の場合
           IF  WK-SWK-PATTERN-BUNSEKI-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1916.ARG2.雑損益仕訳フラグ=["
      D             ZASSONN-SNEKI-SWK-FLG  OF  PARM-SMZJ1916-ARG2"]"
      *-----------------------------------------------------------------
      *----------  仕訳フラグ
             MOVE  ZASSONN-SNEKI-SWK-FLG
               OF  PARM-SMZJ1916-ARG2
               TO  SWK-FLG               OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":仕訳フラグ=["
      D             SWK-FLG              OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c05仕訳パターン"
      D             "分析フラグ=["WK-SWK-PATTERN-BUNSEKI-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-BOKAZN      OF  PARM-SMZC1955-ARG1
      *----------  直前の残高異動.市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-BOKAZN      OF  PARM-SMZC1955-ARG1
      *----------  直前の残高異動.異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-TZ-ZN-IDO
               TO  IDOG-SRYZN            OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後簿価残高=["
      D             UYTK-IDOG-BOKAZN     OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後簿価残高=["
      D             SJTK-IDOG-BOKAZN     OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.異動後数量残高=["
      D             IDOG-SRYZN           OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d02簿価計算結果フラグ＝'1'の場合
           IF  WK-BOKA-CALC-KEKKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d02簿価計算結果"
      D             "フラグ=["WK-BOKA-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動簿価
             MOVE  WK-SJTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
               TO  SJTK-IDO-BOKA         OF  PARM-SMZC1955-ARG1
      *----------  運用通貨異動簿価
             MOVE  WK-UYTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
               TO  UYTK-IDO-BOKA         OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価=["
      D             SJTK-IDO-BOKA      OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価=["
      D             UYTK-IDO-BOKA      OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d02簿価計算結果"
      D             "フラグ=["WK-BOKA-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d04前払金計算結果フラグ＝'1'の場合
           IF  WK-MAEBR-KIN-CALC-KEKKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨前払金償却額（プラス期間分）
             MOVE  WK-SJTK-PPAYIDOG
               OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  SJTK-PPAY-SKK-PULS-KKN
               OF  PARM-SMZC1955-ARG1
      *----------  運用通貨前払金償却額（プラス期間分）
             MOVE  WK-UYTK-PPAYIDOG
               OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  UYTK-PPAY-SKK-PULS-KKN
               OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金償却額（プラス期間分）=["
      D             SJTK-PPAY-SKK-PULS-KKN  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金償却額（プラス期間分）=["
      D             UYTK-PPAY-SKK-PULS-KKN  OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e11個別計算１１フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-11-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e11個別計算１１"
      D             "フラグ=["WK-KOBETSU-CALC-11-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算１１.市場通貨前受・前払プレミアム計上額(雑損益)
           MOVE  BC-MAEUKE-MAEBR-VOLUME-GK
             OF  PARM-SMZC1408-ARG2
             TO  BC-MAEUKE-MAEBR-OLUME-GK
             OF  PARM-SMZC1955-ARG1
      *----------  個別項目計算１１.運用通貨前受・前払プレミアム計上額(雑損益)
           MOVE  LC-MAEUKE-MAEBR-VOLUME-GK
             OF  PARM-SMZC1408-ARG2
             TO  LC-MAEUKE-MAEBR-OLUME-GK
             OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":個別項目計算１１.市場通貨前受・前払プレ"
      D             "ミアム計上額(雑損益)=["
      D             BC-MAEUKE-MAEBR-OLUME-GK  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":個別項目計算１１.運用通貨前受・前払プレ"
      D             "ミアム計上額(雑損益)=["
      D             LC-MAEUKE-MAEBR-OLUME-GK  OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e11個別計算１１"
      D             "フラグ=["WK-KOBETSU-CALC-11-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1955-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1955-ARG1
      *----------  取引データ.為替レート（市場／運用）
             MOVE  WK-K-S-U-KWS          OF  WK-TARGET-TORI-INFO
               TO  S-U-KWS               OF  PARM-SMZC1955-ARG1
      *----------  取引データ.資産負債・買建売建フラグ
             MOVE  WK-TATE-FLG           OF  WK-MEG-BETU-DMN-INFO
               TO  TATE-FLG              OF  PARM-SMZC1955-ARG1
      *----------  取引データ.既経過利息（市場通貨換算額）
             MOVE  WK-S-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  S-KSG-G-KKKRS         OF  PARM-SMZC1955-ARG1
      *----------  取引データ.既経過利息（運用通貨換算額）
             MOVE  WK-U-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  U-KSG-G-KKKRS         OF  PARM-SMZC1955-ARG1
      *----------  取引.調整損益
             MOVE  WK-CHOSEI-SNEKI       OF  WK-TORI-DATA
               TO  CHOSEI-SNEKI          OF  PARM-SMZC1955-ARG1
      *----------  取引.経過利息為替レート（市場／運用）
             MOVE  WK-K-KEKA-RSK-KWS     OF  WK-TARGET-TORI-INFO
               TO  KEKA-RSK-S-U-KWS      OF  PARM-SMZC1955-ARG1
      *----------  取引データ.異動数量
             MOVE  WK-IDO-SURYO          OF  WK-TORI-DATA
               TO  TRHK-IDO-SURYO        OF  PARM-SMZC1955-ARG1
      *----------  取引データ.権利数量
             MOVE  WK-KENRI-SURYO        OF  WK-TORI-DATA
               TO  KENRI-SURYO           OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG        OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG        OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.為替レート（市場／運用）=["
      D             S-U-KWS             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":取引データ.既経過利息（市場通貨換算額）=["
      D             S-KSG-G-KKKRS       OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":取引データ.既経過利息（運用通貨換算額）=["
      D             U-KSG-G-KKKRS       OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":取引データ.調整損益                    =["
      D             CHOSEI-SNEKI        OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.経過利息為替レート（市場／運用）=["
      D             KEKA-RSK-S-U-KWS    OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.異動数量=["
      D             TRHK-IDO-SURYO      OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.権利数量=["
      D             KENRI-SURYO         OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d04前払金計算結果フラグ＝'1'の場合
           IF  WK-MAEBR-KIN-CALC-KEKKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨前払金異動額
             MOVE  WK-SJTK-PPAYIDOG
               OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  SJTK-PPAYIDOG
               OF  PARM-SMZC1955-ARG1
      *----------  運用通貨前払金異動額
             MOVE  WK-UYTK-PPAYIDOG
               OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  UYTK-PPAYIDOG
               OF  PARM-SMZC1955-ARG1
      *----------  市場通貨前払金償却額（マイナス期間分）
             MOVE  WK-SJTK-PPAY-SKK-MINU-KKN
               OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  SJTK-PPAY-SKK-MINU-KKN
               OF  PARM-SMZC1955-ARG1
      *----------  運用通貨前払金償却額（マイナス期間分）
             MOVE  WK-UYTK-PPAY-SKK-MINU-KKN
               OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  UYTK-PPAY-SKK-MINU-KKN
               OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":市場通貨前払金異動額=["
      D             SJTK-PPAYIDOG           OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":運用通貨前払金異動額=["
      D             UYTK-PPAYIDOG           OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":市場通貨前払金償却額（マイナス期間分）=["
      D             SJTK-PPAY-SKK-MINU-KKN  OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":運用通貨前払金償却額（マイナス期間分）=["
      D             UYTK-PPAY-SKK-MINU-KKN  OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d04前払金計算結果フラグ＝'1'の場合
           IF  WK-MAEBR-KIN-CALC-KEKKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  売却パタン
             MOVE  WK-BAKYK-PTN       OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  BAKYK-PTN          OF  PARM-SMZC1955-ARG1
      *----------  購入パタン
             MOVE  WK-KOUNYU-PTN      OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  KOUNYU-PTN         OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":売却パタン=["
      D             BAKYK-PTN         OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":購入パタン=["
      D             BAKYK-PTN         OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e03個別計算３フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-3-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e03個別計算３"
      D             "フラグ=["WK-KOBETSU-CALC-3-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算３.市場通貨手数料（売買金額）
           MOVE  SJTK-TESRY-BS-KN        OF  PARM-SMZC1400-ARG2
             TO  SJTK-TESRY-BS-KN        OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1955-ARG1
      *----------  個別項目計算３.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1400-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1955-ARG1
      *----------  個別項目計算３.市場通貨その他費用（売買金額）
           MOVE  SJTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1400-ARG2
             TO  SJTK-ELS-HIYO-BS-KN     OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1955-ARG1
      *----------  個別項目計算３.運用通貨手数料（売買金額）
           MOVE  UYTK-TESRY-BS-KN        OF  PARM-SMZC1400-ARG2
             TO  UYTK-TESRY-BS-KN        OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1955-ARG1
      *----------  個別項目計算３.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1400-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1955-ARG1
      *----------  個別項目計算３.運用通貨その他費用（売買金額）
           MOVE  UYTK-ELS-HIYO-BS-KN     OF  PARM-SMZC1400-ARG2
             TO  UYTK-ELS-HIYO-BS-KN     OF  KOBETSU-KOMK-CALC-3-PARM
             OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.市場通貨手数料（売買金額）=["
      D             SJTK-TESRY-BS-KN    OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.市場通貨その他費用（売買金額）=["
      D             SJTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.運用通貨手数料（売買金額）=["
      D             UYTK-TESRY-BS-KN    OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算３.運用通貨その他費用（売買金額）=["
      D             UYTK-ELS-HIYO-BS-KN  OF  KOBETSU-KOMK-CALC-3-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e03個別計算３"
      D             "フラグ=["WK-KOBETSU-CALC-3-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.d04前払金計算結果フラグ＝'1'の場合
           IF  WK-MAEBR-KIN-CALC-KEKKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の前払金未償却数量サマリ
             MOVE  WK-TZ-MK-MSKK-SRY-SUM  OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  TZ-MK-MSKK-SRY-SUM     OF  PARM-SMZC1955-ARG1
      *----------  直前の前払金未償却数量サマリ（利金）
             MOVE  WK-TZ-MK-MSKK-SRY-RIKIN-SUM
                                          OF  WK-MAEBR-KIN-CALC-KEKKA
               TO  TZ-MK-MSKK-SRY-RIKIN-SUM
                                          OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の前払金未償却数量サマリ=["
      D             TZ-MK-MSKK-SRY-SUM    OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の前払金未償却数量サマリ（利金）=["
      D             TZ-MK-MSKK-SRY-RIKIN-SUM  OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.d04前払金計算結"
      D             "果フラグ=["WK-MAEBR-KIN-CALC-KEKKA-FLG
      D              OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.e22個別計算２２フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-22-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２２.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1955-ARG1
      *----------  個別項目計算２２.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1955-ARG1
      *---------- 市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1955-ARG1
      *---------- 運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1955-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1955-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
            CONTINUE
           END-IF
      *---------- ②【SMZC1955】損益勘定計算をコールして、リターンパッケージを取得する
           CALL  "SMZC1955"              USING  PARM-SMZC1955-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1955)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク損益勘定計算結果を初期化
             INITIALIZE  WK-RKSEKJ-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク損益勘定計算結果=["
      D             WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨利金等損益勘定.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-RKSEKJ  OF  PARM-SMZC1955-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  SJTK-RKSEKJ      OF PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク損益勘定計算結果.市場通貨利金等損益勘定←リターンパッケージ.市場通貨利金等損益勘定.バリュー
               MOVE  OUT-VALUES          OF  SJTK-RKSEKJ
                 OF  PARM-SMZC1955-ARG2
                 TO  WK-SJTK-RKSEKJ      OF  WK-RKSEKJ-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ      OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  SJTK-RKSEKJ      OF PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨利金等損益勘定.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-RKSEKJ  OF  PARM-SMZC1955-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  UYTK-RKSEKJ      OF PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク損益勘定計算結果.運用通貨利金等損益勘定←リターンパッケージ.運用通貨利金等損益勘定.バリュー
               MOVE  OUT-VALUES          OF  UYTK-RKSEKJ
                 OF  PARM-SMZC1955-ARG2
                 TO  WK-UYTK-RKSEKJ      OF  WK-RKSEKJ-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  UYTK-RKSEKJ      OF PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.為替差損益（利金）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-KWS-SNEKI-RK  OF  PARM-SMZC1955-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "為替差損益（利金）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-KWS-SNEKI-RK  OF  PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク損益勘定計算結果.為替差損益（利金）←リターンパッケージ.為替差損益（利金）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-KWS-SNEKI-RK
                 OF  PARM-SMZC1955-ARG2
                 TO  WK-UYTK-KWS-SNEKI-RK
                 OF  WK-RKSEKJ-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.為替差損益（利金）=["
      D             WK-UYTK-KWS-SNEKI-RK   OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "為替差損益（利金）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-KWS-SNEKI-RK  OF  PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1955-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1955-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1955-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-080
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1955損益勘定計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
           IF  WK-TORI-IDO-FLG = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-SJTK-RKSEKJ  OF  WK-TORI-IDO  NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ      OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク損益勘定計算結果.市場通貨利金等損益勘定 ← ワーク取引異動.市場通貨利金等損益勘定
               MOVE  WK-SJTK-RKSEKJ     OF  WK-TORI-IDO
                 TO  WK-SJTK-RKSEKJ     OF  WK-RKSEKJ-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ      OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨利金等損益勘定が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  WK-UYTK-RKSEKJ  OF  WK-TORI-IDO  NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ      OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク損益勘定計算結果.運用通貨利金等損益勘定 ← ワーク取引異動.運用通貨利金等損益勘定
               MOVE  WK-UYTK-RKSEKJ     OF  WK-TORI-IDO
                 TO  WK-UYTK-RKSEKJ     OF  WK-RKSEKJ-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ      OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨利金等損益勘定が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  WK-UYTK-KWS-SNEKI-RK OF WK-TORI-IDO NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益（利金）=["
      D             WK-UYTK-KWS-SNEKI-RK     OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク損益勘定計算結果.為替差損益（利金） ← ワーク取引異動.為替差損益（利金）
               MOVE  WK-UYTK-KWS-SNEKI-RK  OF  WK-TORI-IDO
                 TO  WK-UYTK-KWS-SNEKI-RK  OF  WK-RKSEKJ-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.為替差損益（利金）=["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.為替差損益（利金）が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1955損益勘定計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1955-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1957源泉税還付予定計算をコールする
      ******************************************************************
       SMZC1957-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1957源泉税還付予定計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1957】源泉税還付予定計算コールに接続用パラメータの設定を行なう
      *----------  源泉税還付予定計算方法
           MOVE  WK-GSZKP-CALC-HOU      OF  WK-CALC-PTN
             TO  GENSEN-KNP-CALC-HOU    OF  PARM-SMZC1957-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":源泉税還付予定計算方法=["
      D             GENSEN-KNP-CALC-HOU  OF  PARM-SMZC1957-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.c01通貨フラグ＝'1'の場合
           IF  WK-TUKA-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  通貨デフォールト端数処理
             MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
               TO  TUKA-DEF-HASU-SYRI-PARM
               OF  PARM-SMZC1957-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DEF-HASU-SYRI-PARM  OF  PARM-SMZC1957-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.c01通貨フラグ=["
      D             WK-TUKA-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.市場通貨異動後源泉税還付予定額残高
             MOVE  WK-SJTK-IDOG-GSZKP-YTZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-GSZKP-YTZN  OF  PARM-SMZC1957-ARG1
      *----------  直前の残高異動.運用通貨異動後源泉税還付予定額残高
             MOVE  WK-UYTK-IDOG-GSZKP-YTZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-GSZKP-YTZN  OF  PARM-SMZC1957-ARG1
      *----------  直前の残高異動.異動後数量残高
             MOVE  WK-IDOG-SRYZN         OF  WK-TZ-ZN-IDO
               TO  IDOG-SURYOU-ZNDU      OF  PARM-SMZC1957-ARG1
      *----------  直前の残高異動.決済通貨異動後源泉税還付予定額残高
             MOVE  WK-KSTK-IDOG-GSZKP-YTZN
               OF  WK-TZ-ZN-IDO
               TO  KSTK-IDOG-GSZKP-YTZN  OF  PARM-SMZC1957-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後源泉税還付"
      D             "予定額残高=["
      D             SJTK-IDOG-GSZKP-YTZN  OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後源泉税還付"
      D             "予定額残高=["
      D             UYTK-IDOG-GSZKP-YTZN  OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.異動後数量残高        =["
      D             IDOG-SURYOU-ZNDU      OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D           ":直前の残高異動.決済通貨異動後源泉税還付予定額残高=["
      D             KSTK-IDOG-GSZKP-YTZN  OF  PARM-SMZC1957-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1957-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1957-ARG1
      *----------  取引データ.異動数量
             MOVE  WK-IDO-SURYO          OF  WK-TORI-DATA
               TO  IDO-SURYOU            OF  PARM-SMZC1957-ARG1
      *----------  取引データ.約定金額
             MOVE  WK-G-YJKG             OF  WK-TORI-DATA
               TO  G-YJKG                OF  PARM-SMZC1957-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG        OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG        OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.異動数量=["
      D             IDO-SURYOU          OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引データ.約定金額=["
      D             G-YJKG              OF  PARM-SMZC1957-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク還付金異動計算特殊フラグ
           MOVE  WK-KANPKIN-IDO-FLG
             TO  KANPKIN-IDO-FLG         OF  PARM-SMZC1957-ARG1
      *----------  ワーク取引異動.市場通貨源泉税還付予定異動額
           MOVE  WK-SJTK-GSZKP-YTIDOG    OF WK-TORI-IDO
             TO  SJTK-GSZKP-YTIDOG       OF  PARM-SMZC1957-ARG1
      *----------  ワーク取引異動.運用通貨源泉税還付予定異動額
           MOVE  WK-UYTK-GSZKP-YTIDOG    OF WK-TORI-IDO
             TO  UYTK-GSZKP-YTIDOG       OF  PARM-SMZC1957-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":還付金異動計算特殊フラグ=["
      D             KANPKIN-IDO-FLG      OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定異動額=["
      D             SJTK-GSZKP-YTIDOG    OF  PARM-SMZC1957-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定異動額=["
      D             UYTK-GSZKP-YTIDOG    OF  PARM-SMZC1957-ARG1"]"
      *-----------------------------------------------------------------
      *---------- ②【SMZC1957】源泉税還付予定計算をコールして、リターンパッケージを取得する
           CALL  "SMZC1957"              USING  PARM-SMZC1957-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1957)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク源泉税還付予定計算結果を初期化
             INITIALIZE  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果=["
      D             WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨源泉税還付予定異動額.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-GSZKP-YTIDOG  OF  PARM-SMZC1957-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨源泉税還付予定異動額.編集フラグ=["EDIT-FLG
      D             OF  SJTK-GSZKP-YTIDOG  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.市場通貨源泉税還付予定異動額
      *----------  ←リターンパッケージ.市場通貨源泉税還付予定異動額.バリュー
               MOVE  OUT-VALUES          OF  SJTK-GSZKP-YTIDOG
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-SJTK-GSZKP-YTIDOG
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.市場通貨源"
      D             "泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨源泉税還付予定異動額.編集フラグ=["EDIT-FLG
      D             OF  SJTK-GSZKP-YTIDOG  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨源泉税還付予定異動額.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-GSZKP-YTIDOG  OF  PARM-SMZC1957-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨源泉税還付予定異動額.編集フラグ=["EDIT-FLG
      D             OF  UYTK-GSZKP-YTIDOG  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.運用通貨源泉税還付予定異動額
      *----------  ←リターンパッケージ.運用通貨源泉税還付予定異動額.バリュー
               MOVE  OUT-VALUES          OF  UYTK-GSZKP-YTIDOG
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-UYTK-GSZKP-YTIDOG
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.運用通貨源"
      D             "泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨源泉税還付予定異動額.編集フラグ=["EDIT-FLG
      D             OF  UYTK-GSZKP-YTIDOG  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨異動後源泉税還付予定額残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-GSZKP-YTZN
                 OF  PARM-SMZC1957-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後源泉税"
      D             "還付予定額残高.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-GSZKP-YTZN  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.市場通貨異動後源泉税還付予定額残高
      *----------  ←リターンパッケージ.市場通貨異動後源泉税還付予定額残高.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-GSZKP-YTZN
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-SJTK-IDOG-GSZKP-YTZN
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.市場通貨異"
      D             "動後源泉税還付予定額残高=["
      D           WK-SJTK-IDOG-GSZKP-YTZN  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後源泉税"
      D             "還付予定額残高.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-GSZKP-YTZN  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.市場通貨異動後源泉税還付予定額残高
      *----------  ←ARG1.直前残高異動.市場通貨異動後源泉税還付予定額残高
               MOVE  WK-SJTK-IDOG-GSZKP-YTZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-GSZKP-YTZN
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.市場通貨異"
      D             "動後源泉税還付予定額残高=["
      D           WK-SJTK-IDOG-GSZKP-YTZN  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後源泉税還付予定額残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-GSZKP-YTZN
                 OF  PARM-SMZC1957-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後源泉税"
      D             "還付予定額残高.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-GSZKP-YTZN  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.運用通貨異動後源泉税還付予定額残高
      *----------  ←リターンパッケージ.運用通貨異動後源泉税還付予定額残高.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-GSZKP-YTZN
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-UYTK-IDOG-GSZKP-YTZN
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.運用通貨異"
      D             "動後源泉税還付予定額残高=["
      D           WK-UYTK-IDOG-GSZKP-YTZN  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後源泉税"
      D             "還付予定額残高.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-GSZKP-YTZN  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.運用通貨異動後源泉税還付予定額残高
      *----------  ←ARG1.直前残高異動.運用通貨異動後源泉税還付予定額残高
               MOVE  WK-UYTK-IDOG-GSZKP-YTZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-GSZKP-YTZN
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.運用通貨異"
      D             "動後源泉税還付予定額残高=["
      D           WK-UYTK-IDOG-GSZKP-YTZN  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.為替差損益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-KWS-SNEKI  OF  PARM-SMZC1957-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "為替差損益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-KWS-SNEKI  OF  PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.為替差損益←リターンパッケージ.為替差損益.バリュー
               MOVE  OUT-VALUES          OF  UYTK-KWS-SNEKI
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-UYTK-KWS-SNEKI
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク源泉税還付予定計算結果.為替差損益=["
      D             WK-UYTK-KWS-SNEKI   OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "為替差損益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-KWS-SNEKI  OF  PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.為替差損益（市場）.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-KWS-SNEKI-SJ  OF  PARM-SMZC1957-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "為替差損益（市場）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-KWS-SNEKI-SJ  OF  PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.為替差損益（市場）←リターンパッケージ.為替差損益（市場）.バリュー
               MOVE  OUT-VALUES          OF  UYTK-KWS-SNEKI-SJ
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-UYTK-KWS-SNEKI-SJ
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク源泉税還付予定計算結果.為替差損益=["
      D             WK-UYTK-KWS-SNEKI-SJ   OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "為替差損益（市場）.編集フラグ=["EDIT-FLG
      D             OF  UYTK-KWS-SNEKI-SJ  OF  PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.市場通貨利金等損益勘定.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-RKSEKJ  OF  PARM-SMZC1957-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  SJTK-RKSEKJ  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.市場通貨利金等損益勘定
      *----------  ←リターンパッケージ.市場通貨利金等損益勘定.バリュー
               MOVE  OUT-VALUES          OF  SJTK-RKSEKJ
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-SJTK-RKSEKJ      OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":ワーク源泉税還付予定計算結果.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ       OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "市場通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  SJTK-RKSEKJ  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.運用通貨利金等損益勘定.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-RKSEKJ  OF  PARM-SMZC1957-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  UYTK-RKSEKJ  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.運用通貨利金等損益勘定
      *----------  ←リターンパッケージ.運用通貨利金等損益勘定.バリュー
               MOVE  OUT-VALUES          OF  UYTK-RKSEKJ
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-UYTK-RKSEKJ      OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":ワーク源泉税還付予定計算結果.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ       OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "運用通貨利金等損益勘定.編集フラグ=["EDIT-FLG
      D             OF  UYTK-RKSEKJ  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.決済通貨源泉税還付予定異動額.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  KSTK-GSZKP-YTIDOG  OF  PARM-SMZC1957-ARG2
                 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "決済通貨源泉税還付予定異動額.編集フラグ=["EDIT-FLG
      D             OF  KSTK-GSZKP-YTIDOG  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.決済通貨源泉税還付予定異動額
      *----------  ←リターンパッケージ.決済通貨源泉税還付予定異動額.バリュー
               MOVE  OUT-VALUES          OF  KSTK-GSZKP-YTIDOG
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-KSTK-GSZKP-YTIDOG  OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "決済通貨源泉税還付予定異動額=["
      D             WK-KSTK-GSZKP-YTIDOG  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ."
      D             "決済通貨源泉税還付予定異動額.編集フラグ=["EDIT-FLG
      D             OF  KSTK-GSZKP-YTIDOG  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *----------  リターンパッケージ.決済通貨異動後源泉税還付予定額残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  KSTK-IDOG-GSZKP-YTZN
                 OF  PARM-SMZC1957-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.決済通貨異動後源泉税"
      D             "還付予定額残高.編集フラグ=["EDIT-FLG
      D             OF  KSTK-IDOG-GSZKP-YTZN  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.決済通貨異動後源泉税還付予定額残高
      *----------  ←リターンパッケージ.決済通貨異動後源泉税還付予定額残高.バリュー
               MOVE  OUT-VALUES          OF  KSTK-IDOG-GSZKP-YTZN
                 OF  PARM-SMZC1957-ARG2
                 TO  WK-KSTK-IDOG-GSZKP-YTZN
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.決済通貨異"
      D             "動後源泉税還付予定額残高=["
      D           WK-KSTK-IDOG-GSZKP-YTZN  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.決済通貨異動後源泉税"
      D             "還付予定額残高.編集フラグ=["EDIT-FLG
      D             OF KSTK-IDOG-GSZKP-YTZN  OF PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.決済通貨異動後源泉税還付予定額残高
      *----------  ←ARG1.直前残高異動.決済通貨異動後源泉税還付予定額残高
               MOVE  WK-KSTK-IDOG-GSZKP-YTZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-KSTK-IDOG-GSZKP-YTZN
                 OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果.決済通貨異"
      D             "動後源泉税還付予定額残高=["
      D           WK-KSTK-IDOG-GSZKP-YTZN  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1957-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1957-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1957-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-081
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1957源泉税還付予定計算をコール 異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
           IF  WK-TORI-IDO-FLG = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-SJTK-RKSEKJ  OF  WK-TORI-IDO  NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ      OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.市場通貨利金等損益勘定 ← ワーク取引異動.市場通貨利金等損益勘定
               MOVE  WK-SJTK-RKSEKJ     OF  WK-TORI-IDO
                 TO  WK-SJTK-RKSEKJ     OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":ワーク源泉税還付予定計算結果.市場通貨利金等損益勘定=["
      D             WK-SJTK-RKSEKJ      OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨利金等損益勘定が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  WK-UYTK-RKSEKJ  OF  WK-TORI-IDO  NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ      OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.運用通貨利金等損益勘定 ← ワーク取引異動.運用通貨利金等損益勘定
               MOVE  WK-UYTK-RKSEKJ     OF  WK-TORI-IDO
                 TO  WK-UYTK-RKSEKJ     OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D         ":ワーク源泉税還付予定計算結果.運用通貨利金等損益勘定=["
      D             WK-UYTK-RKSEKJ      OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨利金等損益勘定が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク還付金異動計算特殊フラグ=["
      D                        WK-KANPKIN-IDO-FLG"]"
      *-----------------------------------------------------------------
             IF WK-KANPKIN-IDO-FLG NOT = CNS-FLG-1 THEN
               IF  WK-SJTK-GSZKP-YTIDOG OF WK-TORI-IDO NOT = CNS-SYOKITI
                OR WK-UYTK-GSZKP-YTIDOG OF WK-TORI-IDO NOT = CNS-SYOKITI
                THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG   OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG   OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  A)ワーク取引異動.市場通貨源泉税還付予定異動額≠999999999999999.999
      *----------  or ワーク取引異動.運用通貨源泉税還付予定異動額≠999999999999999.999の場合
                 INITIALIZE  PARM-SMZJ1921-INOUT
      *----------  計算種類
                 MOVE  CNS-CALC-SHRU-10
                   TO  CALC-SHRU           OF  PARM-SMZJ1921-ARG1
      *----------  計算項番
                 MOVE  WK-GSZKP-CALC-HOU   OF  WK-CALC-PTN
                   TO  CALC-KOBN           OF  PARM-SMZJ1921-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":計算種類         =["
      D             CALC-SHRU            OF  PARM-SMZJ1921-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計算項番         =["
      D             CALC-KOBN            OF  PARM-SMZJ1921-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":C/A位置付けフラグ=["
      D             CA-POS-FLG           OF  PARM-SMZJ1921-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":*** SMZJ1912増減情報判断 START ***"
      *-----------------------------------------------------------------
                 CALL  "SMZJ1921"          USING  PARM-SMZJ1921-INOUT
                                                  PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** SMZJ1921増減情報判断 END ***"
      *-----------------------------------------------------------------
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG    OF  WK-TORI-IDO"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG   OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
                 CONTINUE
               END-IF
               IF WK-SJTK-GSZKP-YTIDOG  OF WK-TORI-IDO NOT = CNS-SYOKITI
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG       OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  B)ワーク取引異動.市場通貨源泉税還付予定異動額≠999999999999999.999の場合
      *----------  ワーク源泉税還付予定計算結果.市場通貨源泉税還付予定異動額
                 MOVE  WK-SJTK-GSZKP-YTIDOG   OF  WK-TORI-IDO
                   TO  WK-SJTK-GSZKP-YTIDOG   OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG   OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
                 IF  ZOUGEN-FLG   OF  PARM-SMZJ1921-ARG2 = CNS-FLG-1
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1921】.ARG2.増減フラグ=["
      D             ZOUGEN-FLG           OF  PARM-SMZJ1921-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.市場通貨異動後源泉税還付予定額残高
                   COMPUTE  WK-SJTK-IDOG-GSZKP-YTZN
                        OF  WK-GSZKP-YT-CALC-KEKKA
                         =  WK-SJTK-IDOG-GSZKP-YTZN  OF WK-TZ-ZN-IDO +
                          WK-SJTK-GSZKP-YTIDOG OF WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "市場通貨異動後源泉税還付予定額残高=["
      D             WK-SJTK-IDOG-GSZKP-YTZN OF WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
                 ELSE
                   CONTINUE
                 END-IF
                 IF  ZOUGEN-FLG   OF  PARM-SMZJ1921-ARG2 = CNS-FLG-2
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1921】.ARG2.増減フラグ=["
      D             ZOUGEN-FLG           OF  PARM-SMZJ1921-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.市場通貨異動後源泉税還付予定額残高
                   COMPUTE  WK-SJTK-IDOG-GSZKP-YTZN
                        OF  WK-GSZKP-YT-CALC-KEKKA
                         =  WK-SJTK-IDOG-GSZKP-YTZN  OF  WK-TZ-ZN-IDO -
                          WK-SJTK-GSZKP-YTIDOG OF WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "市場通貨異動後源泉税還付予定額残高=["
      D             WK-SJTK-IDOG-GSZKP-YTZN OF WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
                 ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1921】.ARG2.増減フラグ=["
      D             ZOUGEN-FLG           OF  PARM-SMZJ1921-ARG2"]"
      *-----------------------------------------------------------------
                   CONTINUE
                 END-IF
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.市場通貨源泉税還付予定異動額=["
      D             WK-SJTK-GSZKP-YTIDOG       OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
                 CONTINUE
               END-IF
               IF WK-UYTK-GSZKP-YTIDOG  OF WK-TORI-IDO NOT = CNS-SYOKITI
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG       OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  C)ワーク取引異動.運用通貨源泉税還付予定異動額≠999999999999999.999の場合
      *----------  ワーク源泉税還付予定計算結果.運用通貨源泉税還付予定異動額←ワーク取引異動.運用通貨源泉税還付予定異動額
                 MOVE  WK-UYTK-GSZKP-YTIDOG   OF  WK-TORI-IDO
                   TO  WK-UYTK-GSZKP-YTIDOG   OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "運用通貨源泉税還付予定異動額=["
      D              WK-UYTK-GSZKP-YTIDOG  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
                 IF  ZOUGEN-FLG   OF  PARM-SMZJ1921-ARG2 = CNS-FLG-1
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1921】.ARG2.増減フラグ=["
      D             ZOUGEN-FLG           OF  PARM-SMZJ1921-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.運用通貨異動後源泉税還付予定額残高
                   COMPUTE  WK-UYTK-IDOG-GSZKP-YTZN
                        OF  WK-GSZKP-YT-CALC-KEKKA
                         =  WK-UYTK-IDOG-GSZKP-YTZN  OF  WK-TZ-ZN-IDO +
                          WK-UYTK-GSZKP-YTIDOG OF WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "運用通貨異動後源泉税還付予定額残高=["
      D             WK-UYTK-IDOG-GSZKP-YTZN OF WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
                 ELSE
                   CONTINUE
                 END-IF
                 IF  ZOUGEN-FLG   OF  PARM-SMZJ1921-ARG2 = CNS-FLG-2
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1921】.ARG2.増減フラグ=["
      D             ZOUGEN-FLG           OF  PARM-SMZJ1921-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.運用通貨異動後源泉税還付予定額残高
                   COMPUTE  WK-UYTK-IDOG-GSZKP-YTZN
                        OF  WK-GSZKP-YT-CALC-KEKKA
                         =  WK-UYTK-IDOG-GSZKP-YTZN  OF  WK-TZ-ZN-IDO -
                          WK-UYTK-GSZKP-YTIDOG OF WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "運用通貨異動後源泉税還付予定額残高=["
      D             WK-UYTK-IDOG-GSZKP-YTZN OF WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
                 ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ1921】.ARG2.増減フラグ=["
      D             ZOUGEN-FLG           OF  PARM-SMZJ1921-ARG2"]"
      *-----------------------------------------------------------------
                   CONTINUE
                 END-IF
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク取引異動.運用通貨源泉税還付予定異動額=["
      D             WK-UYTK-GSZKP-YTIDOG   OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
                 CONTINUE
               END-IF
             ELSE
               CONTINUE
             END-IF
             IF  WK-UYTK-KWS-SNEKI OF WK-TORI-IDO NOT = CNS-SYOKITI
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益=["
      D             WK-UYTK-KWS-SNEKI     OF  WK-TORI-IDO"]"
      *-----------------------------------------------------------------
      *----------  ワーク源泉税還付予定計算結果.為替差損益 ← ワーク取引異動.為替差損益
               MOVE  WK-UYTK-KWS-SNEKI    OF  WK-TORI-IDO
                 TO  WK-UYTK-KWS-SNEKI    OF  WK-GSZKP-YT-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク源泉税還付予定計算結果.為替差損益=["
      D             WK-UYTK-KWS-SNEKI  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引異動.為替差損益が初期値"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引異動データあるフラグ=["
      D             WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1957源泉税還付予定計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1957-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1959ノンカバー未収未払計算をコールする
      ******************************************************************
       SMZC1959-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D          ":*** SMZC1959ノンカバー未収未払計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1959】ノンカバー未収未払計算コールに接続用パラメータの設定を行なう
      *----------  ノンカバー未収未払計算方法
           MOVE  WK-NONCOV-MSMH-CALC-HOU
             OF  WK-CALC-PTN
             TO  NONCOV-MISYU-MIHAR-CALC-HOU
             OF  PARM-SMZC1959-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ノンカバー未収未払計算方法=["
      D            NONCOV-MISYU-MIHAR-CALC-HOU OF  PARM-SMZC1959-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.a10取引分析-未収未払フラグ＝'1'の場合
           IF  WK-TORI-BUNSEKI-MSMH-FLG
               OF  WK-SO-DATA-BENSEKI-KEKKA = CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a10取引分析-未収"
      D             "未払フラグ=["WK-TORI-BUNSEKI-MSMH-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  未収未払フラグ
             MOVE  WK-MISYU-MIHAR-FLG    OF  WK-TORI-BUNSEK-MSMH
               TO  MISYU-MIHAR-FLG       OF  PARM-SMZC1959-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収未払フラグ=["
      D             MISYU-MIHAR-FLG      OF  PARM-SMZC1959-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a10取引分析-未収"
      D             "未払フラグ=["WK-TORI-BUNSEKI-MSMH-FLG
      D             OF WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  キャッシュフロー2回有効フラグ
           MOVE  WK-CASH-FLOW-2-FLG
             TO  CASH-FLOW-2-FLG         OF  PARM-SMZC1959-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー2回有効フラグ=["
      D           CASH-FLOW-2-FLG         OF  PARM-SMZC1959-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.市場通貨異動後ノンカバー未収金残高
             MOVE  WK-SJTK-IDOG-NOCV-MSKZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-NOCV-MSKZN  OF  PARM-SMZC1959-ARG1
      *----------  直前の残高異動.運用通貨異動後ノンカバー未収金残高
             MOVE  WK-UYTK-IDOG-NOCV-MSKZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-NOCV-MSKZN  OF  PARM-SMZC1959-ARG1
      *----------  直前の残高異動.市場通貨異動後ノンカバー未払金残高
             MOVE  WK-SJTK-IDOG-NOCV-MBKZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-NOCV-MBKZN  OF  PARM-SMZC1959-ARG1
      *----------  直前の残高異動.運用通貨異動後ノンカバー未払金残高
             MOVE  WK-UYTK-IDOG-NOCV-MBKZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-NOCV-MBKZN  OF  PARM-SMZC1959-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後ノンカバー"
      D             "未収金残高=["
      D             SJTK-IDOG-NOCV-MSKZN  OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後ノンカバー"
      D             "未収金残高=["
      D             UYTK-IDOG-NOCV-MSKZN  OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後ノンカバー"
      D             "未払金残高=["
      D             SJTK-IDOG-NOCV-MBKZN  OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後ノンカバー"
      D             "未払金残高=["
      D             UYTK-IDOG-NOCV-MBKZN  OF  PARM-SMZC1959-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1959-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1959-ARG1
      *----------  取引.現地手数料（市場通貨換算額）
             MOVE  WK-S-KSG-G-TSR        OF  WK-TORI-DATA
               TO  S-KSG-G-TSR           OF  PARM-SMZC1959-ARG1
      *----------  取引.現地消費税（市場通貨換算額）
             MOVE  WK-S-KSG-G-SHZ        OF  WK-TORI-DATA
               TO  S-KSG-G-SHZ           OF  PARM-SMZC1959-ARG1
      *----------  取引.現地その他費用（市場通貨換算額）
             MOVE  WK-S-KSG-G-THY        OF  WK-TORI-DATA
               TO  S-KSG-G-THY           OF  PARM-SMZC1959-ARG1
      *----------  取引.現地手数料（運用通貨換算額）
             MOVE  WK-U-KSG-G-TSR        OF  WK-TORI-DATA
               TO  U-KSG-G-TSR           OF  PARM-SMZC1959-ARG1
      *----------  取引.現地消費税（運用通貨換算額）
             MOVE  WK-U-KSG-G-SHZ        OF  WK-TORI-DATA
               TO  U-KSG-G-SHZ           OF  PARM-SMZC1959-ARG1
      *----------  取引.現地その他費用（運用通貨換算額）
             MOVE  WK-U-KSG-G-THY        OF  WK-TORI-DATA
               TO  U-KSG-G-THY           OF  PARM-SMZC1959-ARG1
      *----------  取引.資金決済方法
             MOVE  WK-KESAI-HOHO         OF  WK-TORI-DATA
               TO  KESAI-HOHO            OF  PARM-SMZC1959-ARG1
      *----------  取引.経過利息区分
             MOVE  WK-KKRS-KBN           OF  WK-TORI-DATA
               TO  KKRS-KBN              OF  PARM-SMZC1959-ARG1
      *----------  取引.既経過利息（運用通貨換算額）
             MOVE  WK-U-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  U-KSG-G-KKKRS         OF  PARM-SMZC1959-ARG1
      *----------  取引.既経過利息（市場通貨換算額）
             MOVE  WK-S-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  S-KSG-G-KKKRS         OF  PARM-SMZC1959-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG        OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG        OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（市場通貨換算額）=["
      D             S-KSG-G-TSR      OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（市場通貨換算額）=["
      D             S-KSG-G-SHZ      OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（市場通貨換算額）=["
      D             S-KSG-G-THY  OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地手数料（運用通貨換算額）=["
      D             U-KSG-G-TSR          OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地その他費用（運用通貨換算額）=["
      D             U-KSG-G-THY          OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.資金決済方法=["
      D             KESAI-HOHO           OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.経過利息区分=["
      D             KKRS-KBN             OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.既経過利息（運用通貨換算額）=["
      D             U-KSG-G-KKKRS        OF  PARM-SMZC1959-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.既経過利息（市場通貨換算額）=["
      D             S-KSG-G-KKKRS        OF  PARM-SMZC1959-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *---------- ②【SMZC1959】ノンカバー未収未払計算をコールして、リターンパッケージを取得する
           CALL  "SMZC1959"              USING  PARM-SMZC1959-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1959)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワークノンカバー未収未払計算結果を初期化
             INITIALIZE  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果=["
      D             WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨異動後ノンカバー未収金残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-NOCV-MSKZN
                 OF  PARM-SMZC1959-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後ノンカ"
      D             "バー未収金残高.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-NOCV-MSKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.市場通貨異動後ノンカバー未収金残高
      *----------  ←リターンパッケージ.市場通貨異動後ノンカバー未収金残高.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-NOCV-MSKZN
                 OF  PARM-SMZC1959-ARG2
                 TO  WK-SJTK-IDOG-NOCV-MSKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.市場通"
      D             "貨異動後ノンカバー未収金残高=["
      D             WK-SJTK-IDOG-NOCV-MSKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後ノンカ"
      D             "バー未収金残高.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-NOCV-MSKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.市場通貨異動後ノンカバー未収金残高
      *----------  ←ARG1.直前残高異動.市場通貨異動後ノンカバー未収金残高
               MOVE  WK-SJTK-IDOG-NOCV-MSKZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-NOCV-MSKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.市場通"
      D             "貨異動後ノンカバー未収金残高=["
      D             WK-SJTK-IDOG-NOCV-MSKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後ノンカバー未収金残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-NOCV-MSKZN
                 OF  PARM-SMZC1959-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後ノンカ"
      D             "バー未収金残高.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-NOCV-MSKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.運用通貨異動後ノンカバー未収金残高
      *----------  ←リターンパッケージ.運用通貨異動後ノンカバー未収金残高.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-NOCV-MSKZN
                 OF  PARM-SMZC1959-ARG2
                 TO  WK-UYTK-IDOG-NOCV-MSKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.運用通"
      D             "貨異動後ノンカバー未収金残高=["
      D             WK-UYTK-IDOG-NOCV-MSKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後ノンカ"
      D             "バー未収金残高.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-NOCV-MSKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.運用通貨異動後ノンカバー未収金残高
      *----------  ←ARG1.直前残高異動.運用通貨異動後ノンカバー未収金残高.バリュー
               MOVE  WK-UYTK-IDOG-NOCV-MSKZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-NOCV-MSKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.運用通"
      D             "貨異動後ノンカバー未収金残高=["
      D             WK-UYTK-IDOG-NOCV-MSKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨異動後ノンカバー未払金残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-NOCV-MBKZN
                 OF  PARM-SMZC1959-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後ノンカ"
      D             "バー未払金残高.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-NOCV-MBKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.市場通貨異動後ノンカバー未払金残高
      *----------  ←リターンパッケージ.市場通貨異動後ノンカバー未払金残高.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-NOCV-MBKZN
                 OF  PARM-SMZC1959-ARG2
                 TO  WK-SJTK-IDOG-NOCV-MBKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.市場通"
      D             "貨異動後ノンカバー未払金残高=["
      D             WK-SJTK-IDOG-NOCV-MBKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後ノンカ"
      D             "バー未払金残高.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-NOCV-MBKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.市場通貨異動後ノンカバー未払金残高
      *----------  ←ARG1.直前残高異動.市場通貨異動後ノンカバー未払金残高
               MOVE  WK-SJTK-IDOG-NOCV-MBKZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-NOCV-MBKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.市場通"
      D             "貨異動後ノンカバー未払金残高=["
      D             WK-SJTK-IDOG-NOCV-MBKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後ノンカバー未払金残高.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-NOCV-MBKZN
                 OF  PARM-SMZC1959-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後ノンカ"
      D             "バー未払金残高.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-NOCV-MBKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.運用通貨異動後ノンカバー未払金残高
      *----------  ←リターンパッケージ.運用通貨異動後ノンカバー未払金残高.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-NOCV-MBKZN
                 OF  PARM-SMZC1959-ARG2
                 TO  WK-UYTK-IDOG-NOCV-MBKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.運用通"
      D             "貨異動後ノンカバー未払金残高=["
      D             WK-UYTK-IDOG-NOCV-MBKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後ノンカ"
      D             "バー未払金残高.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-NOCV-MBKZN  OF PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワークノンカバー未収未払計算結果.運用通貨異動後ノンカバー未払金残高
      *----------  ←ARG1.直前残高異動.運用通貨異動後ノンカバー未払金残高.バリュー
               MOVE  WK-UYTK-IDOG-NOCV-MBKZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-NOCV-MBKZN
                 OF  WK-NONCOV-MSMH-CALC-KEKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークノンカバー未収未払計算結果.運用通"
      D             "貨異動後ノンカバー未払金残高=["
      D             WK-UYTK-IDOG-NOCV-MBKZN
      D             OF  WK-NONCOV-MSMH-CALC-KEKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1959-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1959-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1959-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-082
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":SMZC1959ノンカバー未収未払計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":*** SMZC1959ノンカバー未収未払計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1959-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1960未払費用計算をコールする
      ******************************************************************
       SMZC1960-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1960未払費用計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1960】未払費用計算コールに接続用パラメータの設定を行なう
      *----------  未払費用計算方法
           MOVE  WK-MISYU-HIYO-CALC-HOU  OF  WK-CALC-PTN
             TO  MBHYZN-CALC-HOU         OF  PARM-SMZC1960-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未払費用計算方法=["
      D             MBHYZN-CALC-HOU      OF  PARM-SMZC1960-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.市場通貨異動後未払費用残
             MOVE  WK-SJTK-IDOG-MBHYZN   OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-MBHYZN      OF  PARM-SMZC1960-ARG1
      *----------  直前の残高異動.運用通貨異動後未払費用残
             MOVE  WK-UYTK-IDOG-MBHYZN   OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-MBHYZN      OF  PARM-SMZC1960-ARG1
      *----------  直前の残高異動.市場通貨異動後未払消費税残
             MOVE  WK-SJTK-IDOG-MB-S-TAXZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDOG-MB-S-TAXZN  OF  PARM-SMZC1960-ARG1
      *----------  直前の残高異動.運用通貨異動後未払消費税残
             MOVE  WK-UYTK-IDOG-MB-S-TAXZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDOG-MB-S-TAXZN  OF  PARM-SMZC1960-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後未払費用残"
      D             "=["SJTK-IDOG-MBHYZN  OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後未払費用残"
      D             "=["UYTK-IDOG-MBHYZN  OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.市場通貨異動後未払消費税残=["
      D             SJTK-IDOG-MB-S-TAXZN  OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":直前の残高異動.運用通貨異動後未払消費税残=["
      D             UYTK-IDOG-MB-S-TAXZN  OF  PARM-SMZC1960-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1960-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1960-ARG1
      *----------  取引データ.現地消費税（市場通貨換算額）
             MOVE  WK-S-KSG-G-SHZ        OF  WK-TORI-DATA
               TO  S-KSG-G-SHZ           OF  PARM-SMZC1960-ARG1
      *----------  取引データ.現地消費税（運用通貨換算額）
             MOVE  WK-U-KSG-G-SHZ        OF  WK-TORI-DATA
               TO  U-KSG-G-SHZ           OF  PARM-SMZC1960-ARG1
      *----------  取引データ.運用国消費税（運用通貨換算額）
             MOVE  WK-U-KSG-U-SHZ        OF  WK-TORI-DATA
               TO  U-KSG-U-SHZ           OF  PARM-SMZC1960-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（市場通貨換算額）=["
      D             S-KSG-G-SHZ          OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ          OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.運用国消費税（運用通貨換算額）=["
      D             U-KSG-U-SHZ          OF  PARM-SMZC1960-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  約定ベース消費税受渡計上フラグ
           MOVE  WK-YKJ-SHOHI-JUN
             TO  YKJ-SHOHI-JUN-FLG       OF  PARM-SMZC1960-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":約定ベース消費税受渡計上フラグ=["
      D             YKJ-SHOHI-JUN-FLG    OF  PARM-SMZC1960-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.e22個別計算２２フラグ＝'1'の場合
           IF  WK-KOBETSU-CALC-22-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  個別項目計算２２.市場通貨消費税（売買金額）
           MOVE  SJTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1960-ARG1
      *----------  個別項目計算２２.運用通貨消費税（売買金額）
           MOVE  UYTK-SHOHI-TAX-BS-KN    OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-BS-KN    OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1960-ARG1
      *---------- 市場通貨消費税（費用計上）
           MOVE  SJTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  SJTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1960-ARG1
      *---------- 運用通貨消費税（費用計上）
           MOVE  UYTK-SHOHI-TAX-KJY      OF  PARM-SMZC1419-ARG2
             TO  UYTK-SHOHI-TAX-KJY      OF  KOBETSU-KOMK-CALC-22-PARM
             OF  PARM-SMZC1960-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（売買金額）=["
      D             SJTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（売買金額）=["
      D             UYTK-SHOHI-TAX-BS-KN  OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.市場通貨消費税（費用計上）=["
      D             SJTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1960-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":個別項目計算２２.運用通貨消費税（費用計上）=["
      D             UYTK-SHOHI-TAX-KJY    OF  KOBETSU-KOMK-CALC-22-PARM
      D             OF  PARM-SMZC1960-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.e22個別計算２２"
      D             "フラグ=["WK-KOBETSU-CALC-22-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
            CONTINUE
           END-IF
      *---------- ②【SMZC1960】未払費用計算をコールして、リターンパッケージを取得する
           CALL  "SMZC1960"              USING  PARM-SMZC1960-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1960)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク未払費用計算結果を初期化
             INITIALIZE  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果=["
      D             WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨異動後未払費用残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-MBHYZN
                 OF  PARM-SMZC1960-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後未払費"
      D             "用残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-MBHYZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.市場通貨異動後未払費用残
      *----------  ←リターンパッケージ.市場通貨異動後未払費用残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-MBHYZN
                 OF  PARM-SMZC1960-ARG2
                 TO  WK-SJTK-IDOG-MBHYZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.市場通貨異動後未"
      D             "払費用残=["WK-SJTK-IDOG-MBHYZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後未払費"
      D             "用残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-MBHYZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.市場通貨異動後未払費用残←ARG1.直前残高異動.市場通貨異動後未払費用残
               MOVE  WK-SJTK-IDOG-MBHYZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-MBHYZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.市場通貨異動後未"
      D             "払費用残=["WK-SJTK-IDOG-MBHYZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後未払費用残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-MBHYZN
                 OF  PARM-SMZC1960-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後未払費"
      D             "用残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-MBHYZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.運用通貨異動後未払費用残
      *----------  ←リターンパッケージ.運用通貨異動後未払費用残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-MBHYZN
                 OF  PARM-SMZC1960-ARG2
                 TO  WK-UYTK-IDOG-MBHYZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.運用通貨異動後未"
      D             "払費用残=["WK-UYTK-IDOG-MBHYZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後未払費"
      D             "用残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-MBHYZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.運用通貨異動後未払費用残←ARG1.直前残高異動.運用通貨異動後未払費用残
               MOVE  WK-UYTK-IDOG-MBHYZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-MBHYZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.運用通貨異動後未"
      D             "払費用残=["WK-UYTK-IDOG-MBHYZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨異動後未払消費税残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDOG-MB-S-TAXZN
                 OF  PARM-SMZC1960-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後未払消"
      D             "費税残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-MB-S-TAXZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.市場通貨異動後未払消費税残
      *----------  ←リターンパッケージ.市場通貨異動後未払消費税残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDOG-MB-S-TAXZN
                 OF  PARM-SMZC1960-ARG2
                 TO  WK-SJTK-IDOG-MB-TAXZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.市場通貨異動後未"
      D             "払消費税残=["WK-SJTK-IDOG-MB-TAXZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後未払消"
      D             "費税残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDOG-MB-S-TAXZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.市場通貨異動後未払消費税残←ARG1.直前残高異動.市場通貨異動後未払消費税残
               MOVE  WK-SJTK-IDOG-MB-S-TAXZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-MB-TAXZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.市場通貨異動後未"
      D             "払消費税残=["WK-SJTK-IDOG-MB-TAXZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後未払消費税残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDOG-MB-S-TAXZN
                 OF  PARM-SMZC1960-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後未払消"
      D             "費税残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-MB-S-TAXZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.運用通貨異動後未払消費税残
      *----------  ←リターンパッケージ.運用通貨異動後未払消費税残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDOG-MB-S-TAXZN
                 OF  PARM-SMZC1960-ARG2
                 TO  WK-UYTK-IDOG-MB-TAXZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.運用通貨異動後未"
      D             "払消費税残=["WK-UYTK-IDOG-MB-TAXZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後未払費"
      D             "用残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDOG-MB-S-TAXZN  OF PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク未払費用計算結果.運用通貨異動後未払消費税残←ARG1.直前残高異動.運用通貨異動後未払消費税残
               MOVE  WK-UYTK-IDOG-MB-S-TAXZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-MB-TAXZN
                 OF  WK-MISYU-HIYO-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク未払費用計算結果.運用通貨異動後未"
      D             "払消費税残=["WK-UYTK-IDOG-MB-TAXZN
      D             OF  WK-MISYU-HIYO-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1960-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1960-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1960-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-083
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1960未払費用計算をコール  異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1960未払費用計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1960-EXT.
           EXIT.
      ******************************************************************
      *    SMZC1961移管項目計算をコールする
      ******************************************************************
       SMZC1961-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1961移管項目計算をコール START ***"
      *-----------------------------------------------------------------
      *----------  ①【SMZC1961】移管項目計算コールに接続用パラメータの設定を行なう
      *----------  移管項目計算方法
           MOVE  WK-IKAN-KMOK-CALC       OF  WK-CALC-PTN
             TO  IKAN-CALC-HOU           OF  PARM-SMZC1961-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":移管項目計算方法=["
      D             IKAN-CALC-HOU        OF  PARM-SMZC1961-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク素データ分析結果.b01直前残高異動フラグ＝'1'の場合
           IF  WK-CHOKZ-ZADAKA-IDOU-FLG  OF  WK-SO-DATA-BENSEKI-KEKKA
               =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  直前の残高異動.市場通貨異動後移管評価損益残
             MOVE  WK-SJTK-IDOG-IK-HKSEZN
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDO-SENK         OF  PARM-SMZC1961-ARG1
      *----------  直前の残高異動.市場通貨異動後移管未収収益
             MOVE  WK-SJTK-IDOG-IK-MSSHEKI
               OF  WK-TZ-ZN-IDO
               TO  SJTK-IDO-SUEKI        OF  PARM-SMZC1961-ARG1
      *----------  直前の残高異動.運用通貨異動後移管評価損益残
             MOVE  WK-UYTK-IDOG-IK-HKSEZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDO-SENK         OF  PARM-SMZC1961-ARG1
      *----------  直前の残高異動.運用通貨異動後移管未収収益
             MOVE  WK-UYTK-IDOG-IK-MSSHEKI
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDO-SUEKI        OF  PARM-SMZC1961-ARG1
      *----------  直前の残高異動.運用通貨異動後移管前払金評価損益残
             MOVE  WK-UYTK-IDOG-IK-PPHKZN
               OF  WK-TZ-ZN-IDO
               TO  UYTK-IDO-MAE-SENK     OF  PARM-SMZC1961-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後移管評価損"
      D             "益残=["SJTK-IDO-SENK   OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.市場通貨異動後移管未収収"
      D             "益=["SJTK-IDO-SUEKI   OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後移管評価損"
      D             "益残=["UYTK-IDO-SENK   OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後移管未収収"
      D             "益=["UYTK-IDO-SUEKI   OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の残高異動.運用通貨異動後移管前払金"
      D             "評価損益残=["
      D             UYTK-IDO-MAE-SENK  OF  PARM-SMZC1961-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.b01直前残高異動"
      D             "フラグ=["WK-CHOKZ-ZADAKA-IDOU-FLG
      D             OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  ワーク素データ分析結果.a01取引フラグ＝'1'の場合
           IF  WK-TORI-FLG   OF  WK-SO-DATA-BENSEKI-KEKKA  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  取引データ.約定金額（市場通貨換算額）
             MOVE  WK-S-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  S-KSG-G-YJKG          OF  PARM-SMZC1961-ARG1
      *----------  取引データ.精算金額（市場通貨換算額）
             MOVE  WK-S-KSG-SSKG         OF  WK-TORI-DATA
               TO  S-KSG-SSKG            OF  PARM-SMZC1961-ARG1
      *----------  取引データ.約定金額（運用通貨換算額）
             MOVE  WK-U-KSG-G-YJKG       OF  WK-TORI-DATA
               TO  U-KSG-G-YJKG          OF  PARM-SMZC1961-ARG1
      *----------  取引データ.精算金額（運用通貨換算額）
             MOVE  WK-U-KSG-SSKG         OF  WK-TORI-DATA
               TO  U-KSG-G-SSKG        OF  PARM-SMZC1961-ARG1
      *----------  取引データ.既経過利息（運用通貨換算額）
             MOVE  WK-U-KSG-G-KKKRS      OF  WK-TORI-DATA
               TO  U-KSG-G-KKKRS         OF  PARM-SMZC1961-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG         OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.精算金額（市場通貨換算額）=["
      D             S-KSG-SSKG           OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG         OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.精算金額（運用通貨換算額）=["
      D             U-KSG-G-SSKG         OF  PARM-SMZC1961-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引.既経過利息（運用通貨換算額）=["
      D             U-KSG-G-KKKRS        OF  PARM-SMZC1961-ARG1"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク素データ分析結果.a01取引フラグ=["
      D             WK-TORI-FLG          OF  WK-SO-DATA-BENSEKI-KEKKA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *---------- ②【SMZC1961】移管項目計算をコールして、リターンパッケージを取得する
           CALL  "SMZC1961"              USING  PARM-SMZC1961-INOUT
                                                PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC1961)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG          =["
      D             COUNTER              OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  A)ワーク移管項目計算結果を初期化
             INITIALIZE  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果=["
      D             WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージ.市場通貨異動後移管評価損益残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDO-SENK
                 OF  PARM-SMZC1961-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後移管評"
      D             "価損益残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDO-SENK  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.市場通貨異動後移管評価損益残
      *----------  ←リターンパッケージ.市場通貨異動後移管評価損益残.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDO-SENK
                 OF  PARM-SMZC1961-ARG2
                 TO  WK-SJTK-IDOG-IK-HKSEZN
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.市場通貨異動後"
      D             "移管評価損益残残=["WK-SJTK-IDOG-IK-HKSEZN
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後移管評"
      D             "価損益残.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDO-SENK  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.市場通貨異動後移管評価損益残
      *----------  ←ARG1.直前残高異動.市場通貨異動後移管評価損益残
               MOVE  WK-SJTK-IDOG-IK-HKSEZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-IK-HKSEZN
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.市場通貨異動後"
      D             "移管評価損益残残=["WK-SJTK-IDOG-IK-HKSEZN
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後移管評価損益残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDO-SENK
                 OF  PARM-SMZC1961-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後移管評"
      D             "価損益残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDO-SENK  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.運用通貨異動後移管評価損益残
      *----------  ←リターンパッケージ.運用通貨異動後移管評価損益残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDO-SENK
                 OF  PARM-SMZC1961-ARG2
                 TO  WK-UYTK-IDOG-IK-HKSEZN
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.運用通貨異動後"
      D             "移管評価損益残残=["WK-UYTK-IDOG-IK-HKSEZN
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後移管評"
      D             "価損益残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDO-SENK  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.運用通貨異動後移管評価損益残
      *----------  ←ARG1.直前残高異動.運用通貨異動後移管評価損益残
               MOVE  WK-UYTK-IDOG-IK-HKSEZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-IK-HKSEZN
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.運用通貨異動後"
      D             "移管評価損益残残=["WK-UYTK-IDOG-IK-HKSEZN
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.市場通貨異動後移管未収収益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  SJTK-IDO-SUEKI
                 OF  PARM-SMZC1961-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後移管未"
      D             "収収益.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDO-SUEKI  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.市場通貨異動後移管未収収益
      *----------  ←リターンパッケージ.市場通貨異動後移管未収収益.バリュー
               MOVE  OUT-VALUES          OF  SJTK-IDO-SUEKI
                 OF  PARM-SMZC1961-ARG2
                 TO  WK-SJTK-IDOG-IK-MSSHEKI
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.市場通貨異動後"
      D             "移管未収収益=["WK-SJTK-IDOG-IK-MSSHEKI
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.市場通貨異動後移管未"
      D             "収収益.編集フラグ=["EDIT-FLG
      D             OF  SJTK-IDO-SUEKI  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.市場通貨異動後移管未収収益
      *----------  ←ARG1.直前残高異動.市場通貨異動後移管未収収益
               MOVE  WK-SJTK-IDOG-IK-MSSHEKI
                 OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-IK-MSSHEKI
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.市場通貨異動後"
      D             "移管未収収益=["WK-SJTK-IDOG-IK-MSSHEKI
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後移管未収収益.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDO-SUEKI
                 OF  PARM-SMZC1961-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後移管"
      D             "未収収益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDO-SUEKI  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.運用通貨異動後移管未収収益
      *----------  ←リターンパッケージ.運用通貨異動後移管未収収益.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDO-SUEKI
                 OF  PARM-SMZC1961-ARG2
                 TO  WK-UYTK-IDOG-IK-MSSHEKI
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.運用通貨異動後"
      D             "移管未収収益=["WK-UYTK-IDOG-IK-MSSHEKI
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後移管"
      D             "未収収益.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDO-SUEKI  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.運用通貨異動後移管未収収益
      *----------  ←ARG1.直前残高異動.運用通貨異動後移管未収収益
               MOVE  WK-UYTK-IDOG-IK-MSSHEKI
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-IK-MSSHEKI
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.運用通貨異動後"
      D             "移管未収収益=["WK-UYTK-IDOG-IK-MSSHEKI
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.運用通貨異動後移管前払金評価損益残.編集フラグ＝'1'の場合
             IF  EDIT-FLG  OF  UYTK-IDO-MAE-SENK
                 OF  PARM-SMZC1961-ARG2 = CNS-FLG-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後移管"
      D             "前払金評価損益残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDO-MAE-SENK  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.運用通貨異動後移管前払金評価損益残
      *----------  ←リターンパッケージ.運用通貨異動後移管前払金評価損益残.バリュー
               MOVE  OUT-VALUES          OF  UYTK-IDO-MAE-SENK
                 OF  PARM-SMZC1961-ARG2
                 TO  WK-UYTK-IDOG-IK-PPHKZN
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.運用通貨異動後"
      D             "移管前払金評価損益残=["WK-UYTK-IDOG-IK-PPHKZN
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.運用通貨異動後移管"
      D             "前払金評価損益残.編集フラグ=["EDIT-FLG
      D             OF  UYTK-IDO-MAE-SENK  OF PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク移管項目計算結果.運用通貨異動後移管前払金評価損益残
      *----------  ←ARG1.直前残高異動.運用通貨異動後移管前払金評価損益残
               MOVE  WK-UYTK-IDOG-IK-PPHKZN
                 OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-IK-PPHKZN
                 OF  WK-IKAN-KMOK-CALC-KEKKA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク移管項目計算結果.運用通貨異動後"
      D             "移管前払金評価損益残=["WK-UYTK-IDOG-IK-PPHKZN
      D             OF  WK-IKAN-KMOK-CALC-KEKKA"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  リターンパッケージ.警告フラグ≠' '(スペース)の場合
             IF  WARN-FLG  OF  PARM-SMZC1961-ARG2 NOT = SPACE
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ARG2.警告情報数
               COMPUTE  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2
                     =  WARN-INFO-SU  OF  PARM-SMZJ1910-ARG2 + 1
      *----------  ARG2.警告情報.警告フラグ
               MOVE  WARN-FLG         OF  PARM-SMZC1961-ARG2
                 TO  WARN-FLG
                 OF  PARM-SMZJ1910-ARG2(WARN-INFO-SU
                 OF  PARM-SMZJ1910-ARG2)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報数=["
      D             WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.警告情報.警告フラグ=["WARN-FLG  OF
      D    PARM-SMZJ1910-ARG2(WARN-INFO-SU OF  PARM-SMZJ1910-ARG2)"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG          OF  PARM-SMZC1961-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-084
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG )
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZC1961移管項目計算をコール 異常"
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名            =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                        =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                    =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード                =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ  =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                  =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** SMZC1961移管項目計算をコール END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZC1961-EXT.
           EXIT.
      ******************************************************************
      *    4.1.6.残高異動データ編集
      ******************************************************************
       TKMZBW06-HENSYU-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 4.1.6.残高異動データ編集 START ***"
      *-----------------------------------------------------------------
      *----------  1)【SMZJ4014】証券種別判定に接続用パラメータの設定を行なう
      *----------  証券種別コード
             MOVE  WK-SEC-SBT-CD         OF  WK-MEG-BETU-DMN-INFO
               TO  SEC-SBT-CD            OF  PARM-SMZJ4014-ARG1
      *----------  判定対象区分
             MOVE  CNS-HANTEI-TARGET-KBN-5
               TO  HANTEI-TARGET-KBN     OF  PARM-SMZJ4014-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD           OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分=["
      D             HANTEI-TARGET-KBN    OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":*** SMZJ4014証券種別判定 CALL ***"
      *-----------------------------------------------------------------
      *---------- 【SMZJ4014】証券種別判定をコールして、リターンパッケージを取得する
             CALL  "SMZJ4014"            USING  PARM-SMZJ4014-INOUT
                                                PARM-RTNPKG
      *----------  ワーク商品区分
             MOVE  SWK-FLG-SYOHIN-KBN    OF  PARM-SMZJ4014-ARG2
               TO  WK-SYOHIN-KBN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク商品区分=["WK-SYOHIN-KBN"]"
      *-----------------------------------------------------------------
      *----------  2)ワーク残高異動計算データを編集する
      *----------  処理実行日
           MOVE  WK-SYORI-YMD            OF  WK-MEG-BETU-DMN-INFO
             TO  WK-SYORI-YMD            OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.処理実行日= ["
      D             WK-SYORI-YMD         OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  起動ID
           MOVE  WK-KIDOU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  WK-KIDOU-ID             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.起動ID= ["
      D             WK-KIDOU-ID          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  WK-RIYO-CMP-CD          OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "利用会社コード= ["
      D             WK-RIYO-CMP-CD       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  ファンドコード
           MOVE  WK-FUND-CD              OF  WK-MEG-BETU-DMN-INFO
             TO  WK-FUND-CD              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "ファンドコード= ["
      D             WK-FUND-CD           OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  WK-PTF-CD               OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "ポートフォリオコード= ["
      D             WK-PTF-CD            OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  原取引ID
           MOVE  WK-TORI-ID              OF  WK-TARGET-TORI-INFO
             TO  WK-TORI-ID              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.原取引ID= ["
      D             WK-TORI-ID           OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  計上基準日
           MOVE  WK-KEIJOU-KIJUNBI       OF  WK-TARGET-TORI-INFO
             TO  WK-KEIJOU-KIJUNBI       OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.計上基準日= ["
      D             WK-KEIJOU-KIJUNBI    OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  赤黒区分
           MOVE  WK-ZOFKU-AKA-KBN        OF  WK-TARGET-TORI-INFO
             TO  WK-AKA-KBN              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.赤黒区分= ["
      D             WK-AKA-KBN           OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  取引連関ID
           MOVE  WK-THRK-ID              OF  WK-TORI-DATA
             TO  WK-THRK-ID              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.取引連関ID= ["
      D             WK-THRK-ID           OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-MEG-BETU-DMN-INFO
             TO  WK-SEC-SBT-CD           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "証券種別コード= ["
      D             WK-SEC-SBT-CD        OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  取引内容
           MOVE  WK-TORI-NAIY            OF  WK-TORI-DATA
             TO  WK-TORI-NAIY            OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.取引内容= ["
      D             WK-TORI-NAIY         OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  取引事由
           MOVE  WK-TORI-JIYU            OF  WK-TORI-DATA
             TO  WK-TORI-JIYU            OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.取引事由= ["
      D             WK-TORI-JIYU         OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨コード
           MOVE  WK-SJTK-CD              OF  WK-TORI-DATA
             TO  WK-SIJO-TUKA-CD         OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨コード= ["
      D             WK-SIJO-TUKA-CD      OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  銘柄コード
           MOVE  WK-MEG-CD               OF  WK-MEG-BETU-DMN-INFO
             TO  WK-MEG-CD               OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.銘柄コード= ["
      D             WK-MEG-CD            OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG             OF  WK-MEG-BETU-DMN-INFO
             TO  WK-TATE-FLG             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "資産負債・買建売建フラグ= ["
      D             WK-TATE-FLG          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  玉ＩＤ
           MOVE  WK-GYOKU-ID             OF  WK-MEG-BETU-DMN-INFO
             TO  WK-GYOKU-ID             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.玉ＩＤ= ["
      D             WK-GYOKU-ID          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  約定日
           MOVE  WK-YKJ-YMD              OF  WK-TORI-DATA
             TO  WK-YKJ-YMD              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.約定日= ["
      D             WK-YKJ-YMD           OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  受渡日
           MOVE  WK-UKE-YMD              OF  WK-TARGET-TORI-INFO
             TO  WK-UKE-YMD              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.受渡日= ["
      D             WK-UKE-YMD           OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク商品区分= ["
      D             WK-SYOHIN-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.建玉計算方法= ["
      D             WK-TGYOKU-CALC-HOU   OF  WK-CALC-PTN"]"
      *-----------------------------------------------------------------
           IF  WK-TGYOKU-CALC-HOU        OF  WK-CALC-PTN  NOT = ZERO
             AND  WK-SYOHIN-KBN  =  CNS-SYOHIN-KBN-2
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.市場通貨異動簿価= ["
      D             WK-SJTK-IDO-BOKA     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動簿価
             MOVE  WK-SJTK-IDO-BOKA      OF  WK-TGYOKU-CALC-KEKKA
               TO  WK-SJTK-IDO-BOKA      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動簿価= ["
      D             WK-SJTK-IDO-BOKA     OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク建玉計算結果.運用通貨異動簿価= ["
      D             WK-UYTK-IDO-BOKA     OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動簿価
             MOVE  WK-UYTK-IDO-BOKA      OF  WK-TGYOKU-CALC-KEKKA
               TO  WK-UYTK-IDO-BOKA      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動簿価= ["
      D             WK-UYTK-IDO-BOKA     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.建玉計算方法= ["
      D             WK-TGYOKU-CALC-HOU   OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.市場通貨異動簿価= ["
      D             WK-SJTK-IDO-BOKA     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動簿価
             MOVE  WK-SJTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
               TO  WK-SJTK-IDO-BOKA      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動簿価= ["
      D             WK-SJTK-IDO-BOKA     OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果.運用通貨異動簿価= ["
      D             WK-UYTK-IDO-BOKA     OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動簿価
             MOVE  WK-UYTK-IDO-BOKA      OF  WK-BOKA-CALC-KEKKA
               TO  WK-UYTK-IDO-BOKA      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動簿価= ["
      D             WK-UYTK-IDO-BOKA     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
      *----------  市場通貨簿価単価
           MOVE  WK-SJTK-BOKA-TNK        OF  WK-BOKA-CALC-KEKKA
             TO  WK-SJTK-BOKA-TNK        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨簿価単価= ["
      D             WK-SJTK-BOKA-TNK     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨簿価単価
           MOVE  WK-UYTK-BOKA-TNK        OF  WK-BOKA-CALC-KEKKA
             TO  WK-UYTK-BOKA-TNK        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨簿価単価= ["
      D             WK-UYTK-BOKA-TNK     OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.乗算/除算区分= ["WK-JZ-JS-KBN-IN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果."
      D             "市場通貨異動後簿価残高= ["
      D             WK-SJTK-IDOG-BOKAZN     OF   WK-BOKA-CALC-KEKKA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク簿価計算結果."
      D             "運用通貨異動後簿価残高= ["
      D             WK-UYTK-IDOG-BOKAZN     OF   WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  簿価為替レート
           IF  WK-JZ-JS-KBN-IN  =  CNS-JZ-JS-KBN-1
           THEN
             IF  WK-SJTK-IDOG-BOKAZN OF WK-BOKA-CALC-KEKKA
               = ZERO
             THEN
               MOVE  ZERO  TO  WK-BOKA-KWS  OF  WK-ZN-IDO-CALC-DATE
             ELSE
               COMPUTE  WK-BOKA-KWS          OF  WK-ZN-IDO-CALC-DATE
                     =  WK-UYTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA /
                        WK-SJTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA
             END-IF
           ELSE
             IF  WK-UYTK-IDOG-BOKAZN OF WK-BOKA-CALC-KEKKA
               = ZERO
             THEN
               MOVE  ZERO  TO  WK-BOKA-KWS  OF  WK-ZN-IDO-CALC-DATE
             ELSE
               COMPUTE  WK-BOKA-KWS          OF  WK-ZN-IDO-CALC-DATE
                     =  WK-SJTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA /
                        WK-UYTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "簿価為替レート= ["
      D             WK-BOKA-KWS          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨払出簿価
           MOVE  WK-SJTK-H-BOKA          OF  WK-BOKA-CALC-KEKKA
             TO  WK-SJTK-H-BOKA          OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨払出簿価= ["
      D             WK-SJTK-H-BOKA       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨払出簿価
           MOVE  WK-UYTK-H-BOKA          OF  WK-BOKA-CALC-KEKKA
             TO  WK-UYTK-H-BOKA          OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨払出簿価= ["
      D             WK-UYTK-H-BOKA       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨払出単価
           MOVE  WK-SJTK-H-TNK           OF  WK-BOKA-CALC-KEKKA
             TO  WK-SJTK-H-TNK           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨払出単価= ["
      D             WK-SJTK-H-TNK        OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨払出単価
           MOVE  WK-UYTK-H-TNK           OF  WK-BOKA-CALC-KEKKA
             TO  WK-UYTK-H-TNK           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨払出単価= ["
      D             WK-UYTK-H-TNK        OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  異動数量
           MOVE  WK-IDO-SURYO            OF  WK-SURYO-CALC-KEKKA
             TO  WK-IDO-SURYO            OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "異動数量= ["
      D             WK-IDO-SURYO        OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.経過利息区分= ["
      D             WK-KKRS-KBN         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  異動数量（利付）
           IF  WK-KKRS-KBN              OF  WK-TORI-DATA
            =  CNS-KKRS-KBN-5
           THEN
             MOVE  ZERO
               TO  WK-IDO-SURYO-RIT     OF  WK-ZN-IDO-CALC-DATE
           ELSE
             MOVE  WK-IDO-SURYO-RIT     OF  WK-SURYO-CALC-KEKKA
               TO  WK-IDO-SURYO-RIT     OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "異動数量（利付）= ["
      D             WK-IDO-SURYO-RIT     OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク商品区分= ["
      D             WK-SYOHIN-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.建玉計算方法= ["
      D             WK-TGYOKU-CALC-HOU   OF  WK-CALC-PTN"]"
      *-----------------------------------------------------------------
           IF  WK-TGYOKU-CALC-HOU        OF  WK-CALC-PTN  NOT = ZERO
             AND  WK-SYOHIN-KBN  =  CNS-SYOHIN-KBN-2
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.市場通貨異動後簿価残高= ["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-TGYOKU-CALC-KEKKA
               TO  WK-SJTK-IDOG-BOKAZN   OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後簿価残高= ["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク建玉計算結果.運用通貨異動後簿価残高= ["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-TGYOKU-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-TGYOKU-CALC-KEKKA
               TO  WK-UYTK-IDOG-BOKAZN   OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後簿価残高= ["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.建玉計算方法= ["
      D             WK-TGYOKU-CALC-HOU   OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.市場通貨異動後簿価残高= ["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後簿価残高
             MOVE  WK-SJTK-IDOG-BOKAZN   OF  WK-BOKA-CALC-KEKKA
               TO  WK-SJTK-IDOG-BOKAZN   OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後簿価残高= ["
      D             WK-SJTK-IDOG-BOKAZN  OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク簿価計算結果.運用通貨異動後簿価残高= ["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-BOKA-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後簿価残高
             MOVE  WK-UYTK-IDOG-BOKAZN   OF  WK-BOKA-CALC-KEKKA
               TO  WK-UYTK-IDOG-BOKAZN   OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後簿価残高= ["
      D             WK-UYTK-IDOG-BOKAZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
      *----------  異動後数量残高
           MOVE  WK-IDOG-SRYZN           OF  WK-SURYO-CALC-KEKKA
             TO  WK-IDOG-SRYZN           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "異動後数量残高= ["
      D             WK-IDOG-SRYZN        OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.経過利息区分= ["
      D             WK-KKRS-KBN          OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  異動後数量残高（利付）
           IF  WK-KKRS-KBN               OF  WK-TORI-DATA
            =  CNS-KKRS-KBN-5
           THEN
             MOVE  ZERO
               TO  WK-IDOG-SRYZN-RIT     OF  WK-ZN-IDO-CALC-DATE
           ELSE
             MOVE  WK-IDOG-SRYZN-RIT     OF  WK-SURYO-CALC-KEKKA
               TO  WK-IDOG-SRYZN-RIT     OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "異動後数量残高（利付）= ["
      D             WK-IDOG-SRYZN-RIT    OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨前払金異動額
           MOVE  WK-SJTK-PPAYIDOG        OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-SJTK-PPAYIDOG        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨前払金異動額= ["
      D             WK-SJTK-PPAYIDOG     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨前払金異動額
           MOVE  WK-UYTK-PPAYIDOG        OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-UYTK-PPAYIDOG        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨前払金異動額= ["
      D             WK-UYTK-PPAYIDOG     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後前払金残
           MOVE  WK-SJTK-IDOG-PPAYZN     OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-SJTK-IDOG-PPAYZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後前払金残= ["
      D             WK-SJTK-IDOG-PPAYZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後前払金残
           MOVE  WK-UYTK-IDOG-PPAYZN     OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-UYTK-IDOG-PPAYZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後前払金残= ["
      D             WK-UYTK-IDOG-PPAYZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後前受金残
           MOVE  WK-SJTK-IDOG-ARECZN     OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-SJTK-IDOG-ARECZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後前受金残= ["
      D             WK-SJTK-IDOG-ARECZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後前受金残
           MOVE  WK-UYTK-IDOG-ARECZN     OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-UYTK-IDOG-ARECZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後前受金残= ["
      D             WK-UYTK-IDOG-ARECZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後仮払金残
           MOVE  WK-SJTK-IDOG-SPAYZN     OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-SJTK-IDOG-SPAYZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後仮払金残= ["
      D             WK-SJTK-IDOG-SPAYZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後仮払金残
           MOVE  WK-UYTK-IDOG-SPAYZN     OF  WK-MAEBR-KIN-CALC-KEKKA
             TO  WK-UYTK-IDOG-SPAYZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後仮払金残= ["
      D             WK-UYTK-IDOG-SPAYZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨売買損益
           MOVE  WK-SJTK-BBSNEKI         OF  WK-BBSONEKI-CALC-KEKKA
             TO  WK-SJTK-BBSNEKI         OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨売買損益= ["
      D             WK-SJTK-BBSNEKI      OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨売買損益
           MOVE  WK-UYTK-BBSNEKI         OF  WK-BBSONEKI-CALC-KEKKA
             TO  WK-UYTK-BBSNEKI         OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨売買損益= ["
      D             WK-UYTK-BBSNEKI      OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           IF  WK-GSZKP-CALC-HOU         OF  WK-CALC-PTN  NOT = ZERO
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTPK
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTLL
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTLK
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTPL
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク計算パターン.源泉税還付予定計算方法= ["
      D             WK-GSZKP-CALC-HOU    OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク源泉税還付予定計算結果.為替差損益= ["
      D             WK-UYTK-KWS-SNEKI    OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益
             MOVE  WK-UYTK-KWS-SNEKI     OF  WK-GSZKP-YT-CALC-KEKKA
               TO  WK-UYTK-KWS-SNEKI     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "為替差損益= ["
      D             WK-UYTK-KWS-SNEKI    OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク計算パターン.源泉税還付予定計算方法= ["
      D             WK-GSZKP-CALC-HOU    OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売買損益計算結果.為替差損益= ["
      D             WK-UYTK-KWS-SNEKI    OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益
             MOVE  WK-UYTK-KWS-SNEKI     OF  WK-BBSONEKI-CALC-KEKKA
               TO  WK-UYTK-KWS-SNEKI     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "為替差損益= ["
      D             WK-UYTK-KWS-SNEKI    OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
           IF  WK-RKSEKJ-CALC-HOU        OF  WK-CALC-PTN  NOT = ZERO
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.損益勘定計算方法= ["
      D             WK-RKSEKJ-CALC-HOU   OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.為替差損益（利金）= ["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益（利金）
             MOVE  WK-UYTK-KWS-SNEKI-RK  OF  WK-RKSEKJ-CALC-KEKKA
               TO  WK-UYTK-KWS-SNEKI-RK  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "為替差損益（利金）= ["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計算パターン.損益勘定計算方法= ["
      D             WK-RKSEKJ-CALC-HOU   OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.為替差損益（利金）= ["
      D             WK-UYTK-KWS-SNEKI-RK   OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益（利金）
             MOVE  WK-UYTK-KWS-SNEKI-RK  OF  WK-BBSONEKI-CALC-KEKKA
               TO  WK-UYTK-KWS-SNEKI-RK  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "為替差損益（利金）= ["
      D             WK-UYTK-KWS-SNEKI-RK  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
           IF  WK-GSZKP-CALC-HOU         OF  WK-CALC-PTN  NOT = ZERO
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTPK
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTLL
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTLK
            AND   WK-TORI-JIYU           OF  WK-TORI-DATA NOT = CNS-FTPL
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク計算パターン.源泉税還付予定計算方法= ["
      D             WK-GSZKP-CALC-HOU   OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID
      D            ":ワーク源泉税還付予定計算結果.為替差損益（市場）= ["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益（市場）
             MOVE  WK-UYTK-KWS-SNEKI-SJ  OF  WK-GSZKP-YT-CALC-KEKKA
               TO  WK-UYTK-KWS-SNEKI-SJ  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "為替差損益（市場）= ["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク計算パターン.源泉税還付予定計算方法= ["
      D             WK-GSZKP-CALC-HOU   OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク売買損益計算結果.為替差損益（市場）= ["
      D             WK-UYTK-KWS-SNEKI-SJ   OF  WK-BBSONEKI-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  為替差損益（市場）
             MOVE  WK-UYTK-KWS-SNEKI-SJ  OF  WK-BBSONEKI-CALC-KEKKA
               TO  WK-UYTK-KWS-SNEKI-SJ  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "為替差損益（市場）= ["
      D             WK-UYTK-KWS-SNEKI-SJ  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
      *----------  市場通貨手数料
           MOVE  WK-SJTK-TSR             OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-SJTK-TSR             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨手数料= ["
      D             WK-SJTK-TSR          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨手数料
           MOVE  WK-UYTK-TSR             OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-UYTK-TSR             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨手数料= ["
      D             WK-UYTK-TSR          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨消費税
           MOVE  WK-SJTK-S-TAX           OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-SJTK-S-TAX           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨消費税= ["
      D             WK-SJTK-S-TAX        OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨消費税
           MOVE  WK-UYTK-S-TAX           OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-UYTK-S-TAX           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨消費税= ["
      D             WK-UYTK-S-TAX        OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨源泉税
           MOVE  WK-SJTK-GENSEN-TAX      OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-SJTK-GENSEN-TAX      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨源泉税= ["
      D             WK-SJTK-GENSEN-TAX   OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨源泉税
           MOVE  WK-UYTK-GENSEN-TAX      OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-UYTK-GENSEN-TAX      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨源泉税= ["
      D             WK-UYTK-GENSEN-TAX   OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨その他損益
           MOVE  WK-SJTK-ELS-SNEKI       OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-SJTK-ELS-SNEKI       OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨その他損益= ["
      D             WK-SJTK-ELS-SNEKI    OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨その他損益
           MOVE  WK-UYTK-ELS-SNEKI       OF  WK-ELS-SNEKI-CALC-KEKKA
             TO  WK-UYTK-ELS-SNEKI       OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨その他損益= ["
      D             WK-UYTK-ELS-SNEKI    OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           IF  WK-GSZKP-CALC-HOU         OF  WK-CALC-PTN  NOT = ZERO
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク計算パターン.源泉税還付予定計算方法= ["
      D             WK-GSZKP-CALC-HOU    OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "市場通貨利金等損益勘定= ["
      D             WK-SJTK-RKSEKJ       OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨利金等損益勘定
             MOVE  WK-SJTK-RKSEKJ        OF  WK-GSZKP-YT-CALC-KEKKA
               TO  WK-SJTK-RKSEKJ        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨利金等損益勘定= ["
      D             WK-SJTK-RKSEKJ       OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ワーク源泉税還付予定計算結果."
      D             "運用通貨利金等損益勘定= ["
      D             WK-UYTK-RKSEKJ       OF  WK-GSZKP-YT-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨利金等損益勘定
             MOVE  WK-UYTK-RKSEKJ        OF  WK-GSZKP-YT-CALC-KEKKA
               TO  WK-UYTK-RKSEKJ        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨利金等損益勘定= ["
      D             WK-UYTK-RKSEKJ       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク計算パターン.源泉税還付予定計算方法= ["
      D             WK-GSZKP-CALC-HOU    OF  WK-CALC-PTN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.市場通貨利金等損益勘定= ["
      D             WK-SJTK-RKSEKJ       OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  市場通貨利金等損益勘定
             MOVE  WK-SJTK-RKSEKJ        OF  WK-RKSEKJ-CALC-KEKKA
               TO  WK-SJTK-RKSEKJ        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨利金等損益勘定= ["
      D             WK-SJTK-RKSEKJ       OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク損益勘定計算結果.運用通貨利金等損益勘定= ["
      D             WK-UYTK-RKSEKJ       OF  WK-RKSEKJ-CALC-KEKKA"]"
      *-----------------------------------------------------------------
      *----------  運用通貨利金等損益勘定
             MOVE  WK-UYTK-RKSEKJ        OF  WK-RKSEKJ-CALC-KEKKA
               TO  WK-UYTK-RKSEKJ        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨利金等損益勘定= ["
      D             WK-UYTK-RKSEKJ       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
      *----------  異動計上順序
           MOVE  WK-SRJUN                OF  WK-TARGET-TORI-INFO
             TO  WK-IDO-KJY-JUN          OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "異動計上順序= ["
      D             WK-IDO-KJY-JUN       OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.商品別取引区分= ["
      D             WK-SHB-TORI-KBN      OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.相対取引.建時単価=["
      D             WK-TATE-TANKA        OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.直前残高異動.建玉単価= ["
      D             WK-TGYOKU-TNK        OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
      *----------  建玉単価
           IF  WK-SHB-TORI-KBN  =  CNS-SHB-TORI-KBN-1
           THEN
             MOVE  WK-TATE-TANKA           OF  WK-AITAI-TRHK-DATA
               TO  WK-TGYOKU-TNK           OF  WK-ZN-IDO-CALC-DATE
           ELSE
             MOVE  WK-TGYOKU-TNK           OF  WK-TZ-ZN-IDO
               TO  WK-TGYOKU-TNK           OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.建玉単価= ["
      D             WK-TGYOKU-TNK        OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.商品別取引区分= ["
      D             WK-SHB-TORI-KBN      OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.取引データ.為替レート（市場／運用）=["
      D              WK-S-U-KWS          OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.直前残高異動.建玉為替レート=["
      D             WK-TGYOKU-KWS-RATE   OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
      *----------  ARG1.取引データ.商品別取引区分＝'1'
           IF  WK-SHB-TORI-KBN  =  CNS-SHB-TORI-KBN-1
           THEN
      *----------  建玉為替レート
             MOVE  WK-S-U-KWS            OF  WK-TORI-DATA
               TO  WK-TGYOKU-KWS-RATE    OF  WK-ZN-IDO-CALC-DATE
           ELSE
      *----------  建玉為替レート
             MOVE  WK-TGYOKU-KWS-RATE    OF  WK-TZ-ZN-IDO
               TO  WK-TGYOKU-KWS-RATE    OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.建玉為替レート= ["
      D             WK-TGYOKU-KWS-RATE   OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.商品別取引区分= ["
      D             WK-SHB-TORI-KBN      OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.現地ブローカー= ["
      D             WK-G-BRK             OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.直前残高異動.建玉ブローカー= ["
      D             WK-TGYOKU-BRK        OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
      *----------  ARG1.取引データ.商品別取引区分＝'1'
           IF  WK-SHB-TORI-KBN  =  CNS-SHB-TORI-KBN-1
           THEN
      *----------  建玉ブローカー
             MOVE  WK-G-BRK              OF  WK-TORI-DATA
               TO  WK-TGYOKU-BRK         OF  WK-ZN-IDO-CALC-DATE
           ELSE
      *----------  建玉ブローカー
             MOVE  WK-TGYOKU-BRK         OF  WK-TZ-ZN-IDO
               TO  WK-TGYOKU-BRK         OF  WK-ZN-IDO-CALC-DATE
           END-IF
           IF  WK-TGYOKU-BRK             OF  WK-TZ-ZN-IDO  NOT = SPACE
           AND WK-TGYOKU-BRK             OF  WK-TZ-ZN-IDO  NOT =
               WK-G-BRK                  OF  WK-TORI-DATA
           THEN
      *----------  建玉ブローカー
             MOVE  WK-TGYOKU-BRK         OF  WK-TZ-ZN-IDO
               TO  WK-TGYOKU-BRK         OF  WK-ZN-IDO-CALC-DATE
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.建玉ブローカー= ["
      D             WK-TGYOKU-BRK        OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.商品別取引区分= ["
      D             WK-SHB-TORI-KBN      OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.相対取引データ.建時現地約定日= ["
      D             WK-TATE-G-YKJ-YMD    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.直前残高異動.建玉約定日= ["
      D             WK-TGYOKU-YKJ-YMD    OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
      *----------  建玉約定日
           IF  WK-SHB-TORI-KBN  =  CNS-SHB-TORI-KBN-1
           THEN
             MOVE  WK-TATE-G-YKJ-YMD     OF  WK-AITAI-TRHK-DATA
               TO  WK-TGYOKU-YKJ-YMD     OF  WK-ZN-IDO-CALC-DATE
           ELSE
             MOVE  WK-TGYOKU-YKJ-YMD     OF  WK-TZ-ZN-IDO
               TO  WK-TGYOKU-YKJ-YMD     OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.建玉約定日= ["
      D             WK-TGYOKU-YKJ-YMD    OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後建玉約定金額残
           MOVE  WK-SJTK-IDOG-TG-YJKNZN  OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-IDOG-TG-YJKNZN  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後建玉約定金額残= ["
      D             WK-SJTK-IDOG-TG-YJKNZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後建玉約定金額残
           MOVE  WK-UYTK-IDOG-TG-YJKNZN  OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-IDOG-TG-YJKNZN  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後建玉約定金額残= ["
      D             WK-UYTK-IDOG-TG-YJKNZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨建玉手数料
           MOVE  WK-SJTK-TG-TSR          OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-TG-TSR          OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨建玉手数料= ["
      D             WK-SJTK-TG-TSR       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨建玉手数料
           MOVE  WK-UYTK-TG-TSR          OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-TG-TSR          OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨建玉手数料= ["
      D             WK-UYTK-TG-TSR       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後建玉手数料残
           MOVE  WK-SJTK-IDOG-TG-TSRZN   OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-IDOG-TG-TSRZN   OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後建玉手数料残= ["
      D             WK-SJTK-IDOG-TG-TSRZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後建玉手数料残
           MOVE  WK-UYTK-IDOG-TG-TSRZN   OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-IDOG-TG-TSRZN   OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後建玉手数料残= ["
      D             WK-UYTK-IDOG-TG-TSRZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨建玉消費税
           MOVE  WK-SJTK-TG-S-TAX        OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-TG-S-TAX        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨建玉消費税= ["
      D             WK-SJTK-TG-S-TAX     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨建玉消費税
           MOVE  WK-UYTK-TG-S-TAX        OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-TG-S-TAX        OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨建玉消費税= ["
      D             WK-UYTK-TG-S-TAX     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後建玉消費税残
           MOVE  WK-SJTK-IDOG-TG-S-TAXZN
             OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-IDOG-TG-S-TAXZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後建玉消費税残= ["
      D             WK-SJTK-IDOG-TG-S-TAXZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後建玉消費税残
           MOVE  WK-UYTK-IDOG-TG-S-TAXZN
             OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-IDOG-TG-S-TAXZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後建玉消費税残= ["
      D             WK-UYTK-IDOG-TG-S-TAXZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨建玉その他費用
           MOVE  WK-SJTK-TG-ELS-HIYO     OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-TG-ELS-HIYO     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨建玉その他費用= ["
      D             WK-SJTK-IDOG-TG-ELS-HZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨建玉その他費用
           MOVE  WK-UYTK-TG-ELS-HIYO     OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-TG-ELS-HIYO     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨建玉その他費用= ["
      D             WK-UYTK-IDOG-TG-ELS-HZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後建玉その他費用残
           MOVE  WK-SJTK-IDOG-TG-ELS-HZN
             OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-IDOG-TG-ELS-HZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後建玉その他費用残= ["
      D             WK-SJTK-IDOG-TG-ELS-HZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後建玉その他費用残
           MOVE  WK-UYTK-IDOG-TG-ELS-HZN
             OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-IDOG-TG-ELS-HZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後建玉その他費用残= ["
      D             WK-UYTK-IDOG-TG-ELS-HZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨建玉精算金額
           MOVE  WK-SJTK-TG-SSKG         OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-TG-SSKG         OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨建玉精算金額= ["
      D             WK-SJTK-TG-SSKG  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨建玉精算金額
           MOVE  WK-UYTK-TG-SSKG         OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-TG-SSKG         OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨建玉精算金額= ["
      D             WK-UYTK-TG-SSKG  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後建玉精算金額残
           MOVE  WK-SJTK-IDOG-TG-SSKGZN  OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-IDOG-TG-SSKGZN  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後建玉精算金額残= ["
      D             WK-SJTK-IDOG-TG-SSKGZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後建玉精算金額残
           MOVE  WK-UYTK-IDOG-TG-SSKGZN  OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-IDOG-TG-SSKGZN  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後建玉精算金額残= ["
      D             WK-UYTK-IDOG-TG-SSKGZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨引継前受・前払プレミアム
           MOVE  WK-SJTK-HT-PPAR-PMM     OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-SJTK-HT-PPAR-PMM     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨引継前受・前払プレミアム= ["
      D             WK-SJTK-HT-PPAR-PMM  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨引継前受・前払プレミアム
           MOVE  WK-UYTK-HT-PPAR-PMM     OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-UYTK-HT-PPAR-PMM     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨引継前受・前払プレミアム= ["
      D             WK-UYTK-HT-PPAR-PMM  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  ＯＰ資産負債・買建売建フラグ
           MOVE  WK-OP-L-S-FLG           OF  WK-TGYOKU-CALC-KEKKA
             TO  WK-OP-TATE-FLG          OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "ＯＰ資産負債・買建売建フラグ= ["
      D             WK-OP-TATE-FLG       OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨源泉税還付予定異動額
           MOVE  WK-SJTK-GSZKP-YTIDOG    OF  WK-GSZKP-YT-CALC-KEKKA
             TO  WK-SJTK-GSZKP-YTIDOG    OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨源泉税還付予定異動額= ["
      D             WK-SJTK-GSZKP-YTIDOG  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨源泉税還付予定異動額
           MOVE  WK-UYTK-GSZKP-YTIDOG    OF  WK-GSZKP-YT-CALC-KEKKA
             TO  WK-UYTK-GSZKP-YTIDOG    OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨源泉税還付予定異動額= ["
      D             WK-UYTK-GSZKP-YTIDOG  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  決済通貨源泉税還付予定異動額
           MOVE  WK-KSTK-GSZKP-YTIDOG    OF  WK-GSZKP-YT-CALC-KEKKA
             TO  WK-KSTK-GSZKP-YTIDOG    OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "決済通貨源泉税還付予定異動額= ["
      D             WK-KSTK-GSZKP-YTIDOG  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後源泉税還付予定額残高
           MOVE  WK-SJTK-IDOG-GSZKP-YTZN
             OF  WK-GSZKP-YT-CALC-KEKKA
             TO  WK-SJTK-IDOG-GSZKP-YTZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後源泉税還付予定額残高= ["
      D             WK-SJTK-IDOG-GSZKP-YTZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後源泉税還付予定額残高
           MOVE  WK-UYTK-IDOG-GSZKP-YTZN
             OF  WK-GSZKP-YT-CALC-KEKKA
             TO  WK-UYTK-IDOG-GSZKP-YTZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後源泉税還付予定額残高= ["
      D             WK-UYTK-IDOG-GSZKP-YTZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  決済通貨異動後源泉税還付予定額残高
           MOVE  WK-KSTK-IDOG-GSZKP-YTZN
             OF  WK-GSZKP-YT-CALC-KEKKA
             TO  WK-KSTK-IDOG-GSZKP-YTZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "決済通貨異動後源泉税還付予定額残高= ["
      D             WK-KSTK-IDOG-GSZKP-YTZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後ノンカバー未収金残高
           MOVE  WK-SJTK-IDOG-NOCV-MSKZN
             OF  WK-NONCOV-MSMH-CALC-KEKA
             TO  WK-SJTK-IDOG-NOCV-MSKZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後ノンカバー未収金残高= ["
      D             WK-SJTK-IDOG-NOCV-MSKZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後ノンカバー未収金残高
           MOVE  WK-UYTK-IDOG-NOCV-MSKZN
             OF  WK-NONCOV-MSMH-CALC-KEKA
             TO  WK-UYTK-IDOG-NOCV-MSKZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用貨異動後ノンカバー未収金残高= ["
      D             WK-UYTK-IDOG-NOCV-MSKZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後ノンカバー未払金残高
           MOVE  WK-SJTK-IDOG-NOCV-MBKZN
             OF  WK-NONCOV-MSMH-CALC-KEKA
             TO  WK-SJTK-IDOG-NOCV-MBKZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後ノンカバー未払金残高= ["
      D             WK-SJTK-IDOG-NOCV-MBKZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後ノンカバー未払金残高
           MOVE  WK-UYTK-IDOG-NOCV-MBKZN
             OF  WK-NONCOV-MSMH-CALC-KEKA
             TO  WK-UYTK-IDOG-NOCV-MBKZN
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後ノンカバー未払金残高= ["
      D             WK-UYTK-IDOG-NOCV-MBKZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後未払費用残
           MOVE  WK-SJTK-IDOG-MBHYZN     OF  WK-MISYU-HIYO-CALC-KEKKA
             TO  WK-SJTK-IDOG-MBHYZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後未払費用残= ["
      D             WK-SJTK-IDOG-MBHYZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後未払費用残
           MOVE  WK-UYTK-IDOG-MBHYZN     OF  WK-MISYU-HIYO-CALC-KEKKA
             TO  WK-UYTK-IDOG-MBHYZN     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後未払費用残= ["
      D             WK-UYTK-IDOG-MBHYZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後未払消費税残
           MOVE  WK-SJTK-IDOG-MB-TAXZN   OF  WK-MISYU-HIYO-CALC-KEKKA
             TO  WK-SJTK-IDOG-MB-S-TAXZN OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後未払消費税残= ["
      D             WK-SJTK-IDOG-MB-S-TAXZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後未払消費税残
           MOVE  WK-UYTK-IDOG-MB-TAXZN   OF  WK-MISYU-HIYO-CALC-KEKKA
             TO  WK-UYTK-IDOG-MB-S-TAXZN OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後未払消費税残= ["
      D             WK-UYTK-IDOG-MB-S-TAXZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後移管評価損益残
           MOVE  WK-SJTK-IDOG-IK-HKSEZN  OF  WK-IKAN-KMOK-CALC-KEKKA
             TO  WK-SJTK-IDOG-IK-HKSEZN  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後移管評価損益残= ["
      D             WK-SJTK-IDOG-IK-HKSEZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後移管評価損益残
           MOVE  WK-UYTK-IDOG-IK-HKSEZN  OF  WK-IKAN-KMOK-CALC-KEKKA
             TO  WK-UYTK-IDOG-IK-HKSEZN  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後移管評価損益残= ["
      D             WK-UYTK-IDOG-IK-HKSEZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  市場通貨異動後移管未収収益
           MOVE  WK-SJTK-IDOG-IK-MSSHEKI
             OF  WK-IKAN-KMOK-CALC-KEKKA
             TO  WK-SJTK-IDOG-IK-MSSHEKI
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "市場通貨異動後移管未収収益= ["
      D             WK-SJTK-IDOG-IK-MSSHEKI  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後移管未収収益
           MOVE  WK-UYTK-IDOG-IK-MSSHEKI
             OF  WK-IKAN-KMOK-CALC-KEKKA
             TO  WK-UYTK-IDOG-IK-MSSHEKI
             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後移管未収収益= ["
      D             WK-UYTK-IDOG-IK-MSSHEKI  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  運用通貨異動後移管前払金評価損益残
           MOVE  WK-UYTK-IDOG-IK-PPHKZN  OF  WK-IKAN-KMOK-CALC-KEKKA
             TO  WK-UYTK-IDOG-IK-PPHKZN  OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D             "運用通貨異動後移管前払金評価損益残= ["
      D             WK-UYTK-IDOG-IK-PPHKZN  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  削除区分
           MOVE  SPACE
             TO  WK-SAKUJO-KBN           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.削除区分= ["
      D             WK-SAKUJO-KBN        OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  短期スタート・エンド経過利息
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.取引データ.受取利息金額= ["
      D             WK-UKETR-RSK-KG  OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.直前残高異動.短期スタート・エンド経過利息= ["
      D             WK-SHORT-STEN-KEKA-RSK  OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
           IF  WK-UKETR-RSK-KG  OF  WK-TORI-DATA  NOT = 0
           THEN
               MOVE  WK-UKETR-RSK-KG         OF  WK-TORI-DATA
                 TO  WK-SHORT-STEN-KEKA-RSK  OF  WK-ZN-IDO-CALC-DATE
           ELSE
               MOVE  WK-SHORT-STEN-KEKA-RSK  OF  WK-TZ-ZN-IDO
                 TO  WK-SHORT-STEN-KEKA-RSK  OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク残高異動計算データ.短期スタート・エンド経過利息= ["
      D             WK-SHORT-STEN-KEKA-RSK   OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  短期スタート日
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.取引データ.スタート日（放出日）= ["
      D             WK-ST-YMD  OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.直前残高異動.短期スタート日= ["
      D             WK-SHORT-START-YMD  OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
           IF  WK-ST-YMD  OF  WK-TORI-DATA  NOT = 0
           THEN
             MOVE  WK-ST-YMD            OF  WK-TORI-DATA
               TO  WK-SHORT-START-YMD   OF  WK-ZN-IDO-CALC-DATE
           ELSE
             MOVE  WK-SHORT-START-YMD   OF  WK-TZ-ZN-IDO
               TO  WK-SHORT-START-YMD   OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.短期スタート日= ["
      D             WK-SHORT-START-YMD   OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  短期エンド日
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.取引データ.受渡ベースエンド日= ["
      D             WK-UKE-END-YMD  OF  WK-TORI-DATA"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.直前残高異動.短期エンド日= ["
      D             WK-SHORT-END-YMD  OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
           IF  WK-UKE-END-YMD  OF  WK-TORI-DATA  NOT = 0
           THEN
               MOVE  WK-UKE-END-YMD    OF  WK-TORI-DATA
               TO    WK-SHORT-END-YMD  OF  WK-ZN-IDO-CALC-DATE
           ELSE
               MOVE  WK-SHORT-END-YMD  OF  WK-TZ-ZN-IDO
               TO    WK-SHORT-END-YMD  OF  WK-ZN-IDO-CALC-DATE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.短期エンド日= ["
      D             WK-SHORT-END-YMD   OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  投資対象国コード
           MOVE  WK-TSTSK-CD             OF  WK-TORI-DATA
             TO  WK-TSTSK-CD             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.投資対象国コード= ["
      D             WK-TSTSK-CD          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  発行国コード
           MOVE  WK-HAKO-CD              OF  WK-TORI-DATA
             TO  WK-HAKO-CD              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.発行国コード= ["
      D             WK-HAKO-CD           OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  数量単位
           MOVE  WK-SURYO-TANI           OF  WK-TORI-DATA
             TO  WK-SURYO-TANI           OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.数量単位= ["
      D             WK-SURYO-TANI        OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           IF  WK-TORI-JIYU   OF  WK-TORI-DATA  =  CNS-TORI-JIYU-INFI
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由= ["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
      *----------  初期設定金額
             MOVE  WK-UYTK-IDOG-TG-SSKGZN
               OF  WK-TGYOKU-CALC-KEKKA
               TO  WK-SHOKI-SET-KGK      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.初期設定金額= ["
      D             WK-SHOKI-SET-KGK     OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.取引データ.取引事由= ["
      D             WK-TORI-JIYU         OF  WK-TORI-DATA"]"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
           IF  WK-TORI-IDO-FLG  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動データあるフラグ= ["WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
      *----------  作成フラグ
             MOVE  CNS-SK-FLG-4
               TO  WK-SK-FLG             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.作成フラグ= ["
      D             WK-SK-FLG            OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動データあるフラグ= ["WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
      *----------  作成フラグ
             MOVE  CNS-SK-FLG-3
               TO  WK-SK-FLG             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.作成フラグ= ["
      D             WK-SK-FLG            OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
      *----------  作成ログインユーザ会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  WK-SK-LOGIN-CMP-CD      OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク残高異動計算データ.作成ログインユーザ会社コード= ["
      D             WK-SK-LOGIN-CMP-CD   OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  作成ユーザＩＤ
           MOVE  SPACE
             TO  WK-SK-SID               OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.作成ユーザＩＤ= ["
      D             WK-SK-SID            OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  作成プログラムＩＤ
           MOVE  CNS-PGM-ID
             TO  WK-SK-PGMID             OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.作成プログラムＩＤ= ["
      D             WK-SK-PGMID          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           IF  WK-TORI-IDO-FLG  =  CNS-FLG-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動データあるフラグ= ["WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
      *----------  更新フラグ
             MOVE  CNS-UPD-FLG-4
               TO  WK-UPD-FLG            OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.更新フラグ= ["
      D             WK-UPD-FLG          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引異動データあるフラグ= ["WK-TORI-IDO-FLG"]"
      *-----------------------------------------------------------------
      *----------  更新フラグ
             MOVE  CNS-UPD-FLG-3
               TO  WK-UPD-FLG            OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.更新フラグ= ["
      D             WK-UPD-FLG          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
           END-IF
      *----------  更新ログインユーザ会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-MEG-BETU-DMN-INFO
             TO  WK-UPD-LOGIN-CMP-CD     OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ.更新ログインユ"
      D             "ーザ会社コード= ["
      D             WK-UPD-LOGIN-CMP-CD  OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  更新ユーザＩＤ
           MOVE  SPACE
             TO  WK-UPD-SID              OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.更新ユーザＩＤ= ["
      D             WK-UPD-SID          OF  WK-ZN-IDO-CALC-DATE"]"
      *-----------------------------------------------------------------
      *----------  更新プログラムＩＤ
           MOVE  CNS-PGM-ID
             TO  WK-UPD-PGMID            OF  WK-ZN-IDO-CALC-DATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高異動計算データ.更新プログラムＩＤ= ["
      D             WK-UPD-PGMID         OF  WK-ZN-IDO-CALC-DATE"]"
      D    DISPLAY  CNS-PGM-ID":*** 4.1.6.残高異動データ編集 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-HENSYU-EXT.
           EXIT.
      ******************************************************************
      *                 3.3.1 後処理
      ******************************************************************
       END-RTN                SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***   後処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1910-ARG1=["
      D             PARM-SMZJ1910-ARG1   OF PARM-SMZJ1910-INOUT"]"
      *-----------------------------------------------------------------
      *----------  リターンパッケージセットルーチンをコールする
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージセットルーチンSCZY1170開始"
      *-----------------------------------------------------------------
           CALL  "SCZY1170"              USING  PARM-SCZY1170-IN
                                                PARM-SCZY1170-RTNPKG
           MOVE  PARM-SCZY1170-RTNPKG    TO  PARM-SMZJ1910-ARG3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":  PARM-SCZY1170-RTNPKG   = ["
      D      PARM-SCZY1170-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":  PARM-SMZJ1910-ARG3     = ["
      D      PARM-SMZJ1910-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":  COUNT = ["
      D      COUNTER OF PARM-SMZJ1910-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":  エラー検知プログラム名 = ["
      D      ERR-PGM-ID
      D      OF PARM-SMZJ1910-ARG3(COUNTER  OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  ポジション = ["
      D      ERR-POS
      D      OF PARM-SMZJ1910-ARG3(COUNTER  OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  リターンコード = ["
      D      RTN-CD
      D      OF PARM-SMZJ1910-ARG3(COUNTER  OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  詳細リターンコード = ["
      D      DETAIL-RTN-CD
      D      OF PARM-SMZJ1910-ARG3(COUNTER  OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  詳細リターンコードデコードフラグ = ["
      D      DETAIL-RTN-CD-FLG
      D      OF PARM-SMZJ1910-ARG3(COUNTER  OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  フリーメッセージ = ["
      D      FREE-MSG
      D      OF PARM-SMZJ1910-ARG3(COUNTER  OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID
      D             ": リターンパッケージセットルーチンSCZY1170終了"
      D    DISPLAY  CNS-PGM-ID": ***   後処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       END-EXT.
           EXIT.
      ******************************************************************
      *                 3.4.1 エラー処理
      ******************************************************************
       ERR-RTN                SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  エラー処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1910-ARG2    OF PARM-SMZJ1910-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ1910-ARG2=["
      D             PARM-SMZJ1910-ARG2  OF PARM-SMZJ1910-INOUT"]"
      D    DISPLAY  CNS-PGM-ID ":取引カーソルオープンフラグ=["
      D             FLG-TKMXTR00-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":取引カーソルオープンフラグ1=["
      D             FLG-TKMXTR00-CR-1-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":取引カーソルオープンフラグ2=["
      D             FLG-TKMXTR00-CR-2-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":対象取引情報カーソルオープンフラグ=["
      D             FLG-TKMZBW04-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":残高履歴カーソルオープンフラグ=["
      D             FLG-TKMZZR00-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データカーソルオープン"
      D             "フラグ=["FLG-TKMZBW06-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データカーソル2オープン"
      D             "フラグ=["FLG-TKMZBW06-CR2-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データカーソルオープン"
      D             "フラグ2=["FLG-TKMZBW06-CR-2-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":残高異動カーソルオープンフラグ=["
      D             FLG-TKMZZI00-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":取引異動カーソルオープンフラグ=["
      D             FLG-TKMXTI00-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":取引カーソルオープンフラグ11=["
      D             FLG-TKMXTR00-CR-11-OPEN"]"
      D    DISPLAY  CNS-PGM-ID ":対応本体取引異動"
      D             "カーソルオープンフラグ=["
      D             FLG-TKMXTI00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
      *----------  取引カーソルをクローズする
           IF  FLG-TKMXTR00-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTR00-CR-OPEN
             EXEC  SQL
                 CLOSE TKMXTR00_CUR
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  取引カーソル1をクローズする
           IF  FLG-TKMXTR00-CR-1-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR_1 CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTR00-CR-1-OPEN
             EXEC  SQL
                 CLOSE TKMXTR00_CUR_1
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR_1 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  取引カーソル2をクローズする
           IF  FLG-TKMXTR00-CR-2-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR_2 CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTR00-CR-2-OPEN
             EXEC  SQL
                 CLOSE TKMXTR00_CUR_2
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR_2 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  対象取引情報カーソルをクローズする
           IF  FLG-TKMZBW04-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW04_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMZBW04-CR-OPEN
             EXEC  SQL
                 CLOSE TKMZBW04_CUR
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW04_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高履歴カーソルをクローズする
           IF  FLG-TKMZZR00-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZR00_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMZZR00-CR-OPEN
             EXEC  SQL
                 CLOSE TKMZZR00_CUR
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZR00_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高異動計算データカーソルをクローズする
           IF  FLG-TKMZBW06-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR-OPEN
             EXEC  SQL
                 CLOSE TKMZBW06_CUR
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高異動計算データカーソルをクローズする
           IF  FLG-TKMZBW06-CR2-OPEN = CNS-ON                           @3212SEINO@
           THEN                                                         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR2 CLOSE処理を行く"          @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR2-OPEN       @3212SEINO@
             EXEC  SQL                                                  @3212SEINO@
                 CLOSE TKMZBW06_CUR2                                    @3212SEINO@
             END-EXEC                                                   @3212SEINO@
           ELSE                                                         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR2 CLOSE処理を行かない"      @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             CONTINUE
           END-IF
      *----------  残高異動計算データカーソル2をクローズする
           IF  FLG-TKMZBW06-CR-2-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR_2 CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR-2-OPEN
             EXEC  SQL
                 CLOSE TKMZBW06_CUR_2
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR_2 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  取引異動カーソルをクローズする
           IF  FLG-TKMXTI00-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTI00-CR-OPEN
             EXEC  SQL
                 CLOSE TKMXTI00_CUR
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  取引異動カーソルをクローズする
           IF  FLG-TKMXTI00-CR-13-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CUR3 CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTI00-CR-13-OPEN
             EXEC  SQL
                 CLOSE TKMXTI00_CUR3
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CUR3 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  取引異動カーソルをクローズする
           IF  FLG-TKMXTI00-CR-2-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CUR2 CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTI00-CR-2-OPEN
             EXEC  SQL
                 CLOSE TKMXTI00_CUR2
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CUR2 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  取引カーソルをクローズする
           IF  FLG-TKMXTR00-CR-11-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR_11 CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTR00-CR-11-OPEN
             EXEC  SQL
                 CLOSE TKMXTR00_CUR_11
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTR00_CUR_11 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  対応本体取引異動カーソルをクローズする
           IF  FLG-TKMXTI00-CR-1-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CR_1 CLOSE処理を行く"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-TKMXTI00-CR-1-OPEN
             EXEC  SQL
                 CLOSE TKMXTI00_CUR_1
             END-EXEC
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMXTI00_CUR_1 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  リターンパッケージセットルーチンをコールする
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":リターンパッケージセットルーチンSCZY1170開始"
      *-----------------------------------------------------------------
           CALL  "SCZY1170"              USING  PARM-SCZY1170-IN
                                                PARM-SCZY1170-RTNPKG
           MOVE  PARM-SCZY1170-RTNPKG    TO  PARM-SMZJ1910-ARG3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":  PARM-SCZY1170-RTNPKG   = ["
      D      PARM-SCZY1170-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":  PARM-SMZJ1910-ARG3     = ["
      D      PARM-SMZJ1910-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":  COUNT = ["
      D      COUNTER OF PARM-SMZJ1910-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":  エラー検知プログラム名 = ["
      D      ERR-PGM-ID
      D      OF PARM-SMZJ1910-ARG3(COUNTER   OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  ポジション = ["
      D      ERR-POS
      D      OF PARM-SMZJ1910-ARG3(COUNTER   OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  リターンコード = ["
      D      RTN-CD
      D      OF PARM-SMZJ1910-ARG3(COUNTER   OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  詳細リターンコード = ["
      D      DETAIL-RTN-CD
      D      OF PARM-SMZJ1910-ARG3(COUNTER   OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  詳細リターンコードデコードフラグ = ["
      D      DETAIL-RTN-CD-FLG
      D      OF PARM-SMZJ1910-ARG3(COUNTER   OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID":  フリーメッセージ = ["
      D      FREE-MSG
      D      OF PARM-SMZJ1910-ARG3(COUNTER   OF PARM-SMZJ1910-ARG3)"]"
      D    DISPLAY  CNS-PGM-ID
      D             ": リターンパッケージセットルーチンSCZY1170終了"
      D    DISPLAY  CNS-PGM-ID": ***  エラー処理  END  ***"
      D    DISPLAY  CNS-PGM-ID": ***  SMZJ1910処理  異常終了  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-EXT.
           GOBACK.
