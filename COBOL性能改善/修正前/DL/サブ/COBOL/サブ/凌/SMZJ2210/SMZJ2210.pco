      ******************************************************************
      * $Header$
      ******************************************************************
      *
      * システムＩＤ   : T-STAR
      * システム名称   : 次期TSTARシステム
      * プログラムＩＤ : SMZJ2210
      * プログラム名称 : 銘柄別残高計算
      * 処理概要       : 各残高データより、各履歴情報を作成する。
      * 参照ＤＢ       : 未収収益計算データ（TKMZBW08）
      *                : 未収収益（TKMZMS00）
      *                : 残高異動計算データ（TKMZBW06）
      *                : 資金簿価異動計算データ（TKMZBW07）
      * 引数           : IN   基準日断面情報
      *                : IN   銘柄別断面情報
      *                : IN   開始時残高履歴情報
      *                : IN   開始時資金残履歴情報
      *                : IN   開始時元本残高情報
      *                : IN   異動計算パターン
      *                : IN   基準日の経過利息データ
      *                : IN   決算前の未収収益計上
      *                : IN   決算後の未収収益計上
      *                : IN   未収配当計算コールフラグ
      *                : IN   債券過去経過利息計算コールフラグ
      *                : IN   その他未収配当計算コールフラグ
      *                : IN   再計算数量単位
      *                : IN   跨ぎ市場通貨前払金異動額集計
      *                : IN   跨ぎ運用通貨前払金異動額集計
      *                : IN   約定ベース受渡順フラグ
      *                : IN   取引属性データエリア
      *                : IN   欠落断面有無フラグ
      *                : IN   投資対象国コード
      *                : IN   発行国コード
      *                : OUT  基準日別更新区分
      *                : OUT  履歴作成フラグ
      *                : OUT  保有残マイナスフラグ1（市場通貨簿価)
      *                : OUT  保有残マイナスフラグ1（運用通貨簿価)
      *                : OUT  保有残マイナスフラグ1（数量残高）
      *                : OUT  決算日断面区分1
      *                : OUT  保有残マイナスフラグ2（市場通貨簿価）
      *                : OUT  保有残マイナスフラグ2（運用通貨簿価）
      *                : OUT  保有残マイナスフラグ2（数量残高）
      *                : OUT  決算日断面区分2
      *                : OUT  RTNパッケージ
      *
      * 改訂履歴
      * 年月日        区分     所属    担当     内容
      * ------------  ----    ------  -------  -------------
      * 20080212      新規     SCS     尹吉磊    新規作成
      * 20080602      修正     SCS     梁偉
      * 20080725      修正     SCS     梁偉      残タスク9
      * 20080818      修正     SCS     于瓊      残タスク26
      * 20080918      修正     SCS     楊超
      * 20081119      修正     SCS     張凌翔    修正
      * 20090206      修正     SCS     周運棟    残タスク91対応
      * 20090212      修正     SCS     李菁      残タスク147対応
      * 20090212      修正     SCS     徐曉俊    残タスク202対応
      * 20090413      修正     SCS     王 粒     総合障害259
      * 20090422      修正     SCS     顧建鋒    テーマ24対応
      * 20090506      修正     SCS     王飛      連結障害1724
      * 20090519      修正     SCS     王飛      テーマ302対応
      * 20090528      修正     SCS     王飛      連結障害1774
      * 20090603      修正     SCS     何傑文    総合障害677
      * 20090604      修正     SCS     王飛      総合障害867
      * 20090617      修正     SCS     王飛      テーマ295
      * 20090619      修正     SCS     何傑文    総合障害739
      * 20090622      修正     SCS     何傑文    総合障害941
      * 20090626      修正     SCS     李菁      テーマ760
      * 20090706      修正     SCS     徐曉俊    総合障害1367,総合障害351
      * 20090721      修正     SCS     王飛      総合障害1639
      * 20090728      修正     SCS     顧建鋒    総合障害1345
      * 20090731      修正     SCS     顧建鋒    総合障害1511
      * 20090813      修正     SCS     王飛      連結障害2008
      * 20090817      修正     SCS     王飛      総合障害1595
      * 20090819      修正     SCS     何傑文    総合障害1679
      * 20090820      修正     SCS     何傑文    総合障害1871
      * 20090824      修正     SCS     王飛      テーマ1307
      * 20090825      修正     SCS     惲旭来    総合障害2382対応
      * 20091010      修正     SCS     何傑文    総合障害2882対応
      * 20091021      修正     SCS     王飛      総合障害2793
      * 20091027      修正     SCS     顧建鋒    テーマ1770
      * 20091028      修正     SCS     顧建鋒    テーマ1557
      * 20091029      修正     SCS     楊超      テーマ1623
      * 20091116      修正     SCS     顧建鋒    テーマ1841
      * 20091125      修正     SCS     王飛      テーマ2070
      * 20091127      修正     SCS     王飛      本番障害対応20091126
      * 20091208      修正     SCS     王飛      テーマ2182
      * 20091222      修正     SCS     王飛      総合障害3813
      * 20100220      修正     SCS     張香桃    GIPS2.0性能
      * 20100415      修正     SCS     徐玲      GIPS2.0追いつき対応
      * 20100611      修正     SCS     陳幸縁    テーマ2851
      * 20100618      修正     SCS     樊玉華    テーマ2812
      * 20100624      修正     SCS     樊玉華    テーマ2871
      * 20100728      修正     SCS     陳幸縁    本番
      * 20110420      修正     SCS     兪巧芳   テーマ3212-1性能改善対応
      * 20110706      修正     SCS     陳幸縁   テーマ3049
      * 20110923      修正     SCS     高帥     テーマ3311
      * 20130121      修正     SCS     朱銘茜   テーマ3467
      ******************************************************************
       IDENTIFICATION         DIVISION.
       PROGRAM-ID.    SMZJ2210.
       AUTHOR.        Nomura.
       DATE-WRITTEN.  08-02-12.
       DATE-COMPILED.
      ******************************************************************
      *
      *        環  境  部
      *
      ******************************************************************
       ENVIRONMENT            DIVISION.
       CONFIGURATION          SECTION.
       SOURCE-COMPUTER.       L1000V.
      *SOURCE-COMPUTER.       L1000V   WITH DEBUGGING MODE.
       OBJECT-COMPUTER.       RP5470.
       INPUT-OUTPUT           SECTION.
       FILE-CONTROL.
      ******************************************************************
      *
      *        デ  ー  タ  部
      *
      ******************************************************************
       DATA                   DIVISION.
      ******************************************************************
      *        作業場所節
      ******************************************************************
       WORKING-STORAGE        SECTION.
       01  IDNAME                  PIC  X(80)  VALUE
       "$Id$".
      ******************************************************************
      *                コンスタント  エリア
      ******************************************************************
      *---------- 共通コンスタント定義の宣言
       01  CONSTANT-AREA.
         05  CNS-MZCNS.
           COPY "MZCNS.cpy".
      *---------- プログラム名
         05  CNS-PGM-ID            PIC  X(08)  VALUE  "SMZJ2210".
      *----------  未収収益計算データ
         05  CNS-TBL-TKMZBW08      PIC  X(08)  VALUE  "TKMZBW08".
      *----------  未収収益
         05  CNS-TBL-TKMZMS00      PIC  X(08)  VALUE  "TKMZMS00".
      *----------  残高履歴計算データ
         05  CNS-TBL-TKMZBW11      PIC  X(08)  VALUE  "TKMZBW11".
      *----------  残高異動計算データ
         05  CNS-TBL-TKMZBW06      PIC  X(08)  VALUE  "TKMZBW06".
      *----------  資金残履歴計算データ
         05  CNS-TBL-TKMZBW12      PIC  X(08)  VALUE  "TKMZBW12".
      *----------  資金簿価異動計算データ
         05  CNS-TBL-TKMZBW07      PIC  X(08)  VALUE  "TKMZBW07".
      *----------  元本残高計算データ
         05  CNS-TBL-TKMZBW13      PIC  X(08)  VALUE  "TKMZBW13".
      *----------  元本残高計算データ
         05  CNS-TBL-TKMZBW02      PIC  X(08)  VALUE  "TKMZBW02".
      *----------  残高履歴
         05  CNS-TBL-TKMZZR00      PIC  X(08)  VALUE  "TKMZZR00".
      *----------  資金残履歴
         05  CNS-TBL-TKMZSR00      PIC  X(08)  VALUE  "TKMZSR00".
      *----------  元本残高
         05  CNS-TBL-TKMZGZ00      PIC  X(08)  VALUE  "TKMZGZ00".
      *----------  残高異動
         05  CNS-TBL-TKMZZI00      PIC  X(08)  VALUE  "TKMZZI00".
      *----------  資金簿価異動
         05  CNS-TBL-TKMZSI00      PIC  X(08)  VALUE  "TKMZSI00".
      *----------  債券過去経過利息
         05  CNS-TBL-TKMZKR00      PIC  X(08)  VALUE  "TKMZKR00".
      *----------  FLG
         05  CNS-X-0               PIC  X(01)  VALUE  "0".
         05  CNS-X-1               PIC  X(01)  VALUE  "1".
         05  CNS-X-2               PIC  X(01)  VALUE  "2".
         05  CNS-X-8               PIC  X(01)  VALUE  "8".
         05  CNS-X-6               PIC  X(01)  VALUE  "6".
         05  CNS-X-7               PIC  X(01)  VALUE  "7".
         05  CNS-X-A               PIC  X(01)  VALUE  "a".
         05  CNS-1                 PIC  9(01)  VALUE  1.
         05  CNS-0                 PIC  9(01)  VALUE  0.                @3212SEINO@@
      *---------- -1
         05  CNS-MINUS             PIC  S9(01) VALUE  -1.
      *----------  資産/負債・買建/売建フラグ
         05  CNS-TATE-FLG-L        PIC  X(01)  VALUE  "L".
         05  CNS-TATE-FLG-S        PIC  X(01)  VALUE  "S".
      *----------  銘柄種類
         05  CNS-MEG-CD-SHRU-1     PIC  X(01)  VALUE  "1".
         05  CNS-MEG-CD-SHRU-2     PIC  X(01)  VALUE  "2".
         05  CNS-MEG-CD-SHRU-3     PIC  X(01)  VALUE  "3".
         05  CNS-MEG-CD-SHRU2-1    PIC  X(01)  VALUE  "1".
         05  CNS-MEG-CD-SHRU2-2    PIC  X(01)  VALUE  "2".
         05  CNS-MEG-CD-SHRU2-3    PIC  X(01)  VALUE  "3".
      *----------  再計算区分
         05  CNS-SAI-CALC-KBN-2    PIC  X(01)  VALUE  "2".
      *----------  基準日種類
         05  CNS-KJN-YMD-SHRU-0    PIC  X(01)  VALUE  "0".
         05  CNS-KJN-YMD-SHRU-4    PIC  X(01)  VALUE  "4".
         05  CNS-KJN-YMD-SHRU-5    PIC  X(01)  VALUE  "5".
      *----------  有効残高区分
         05  CNS-YUKO-ZN-KBN-0     PIC  X(01)  VALUE  "0".
         05  CNS-YUKO-ZN-KBN-1     PIC  X(01)  VALUE  "1".
      *----------  履歴作成フラグ
         05  CNS-RIREKI-SAKUSEI-FLG-1
                                   PIC  9(01)  VALUE  1.
      *----------  パラメータエラーメッセージ
         05  CNS-SQL-MSG-SELECT    PIC  X(17)  VALUE
                                               " SQL-MSG(SELECT):".
         05  CNS-SQL-MSG-INSERT    PIC  X(17)  VALUE
                                               " SQL-MSG(INSERT):".
         05  CNS-SQL-MSG-UPDATE    PIC  X(17)  VALUE
                                               " SQL-MSG(UPDATE):".
      *----------  サブRTN戻り値
         05  CNS-RTN-140           PIC  X(03)  VALUE  "140".
         05  CNS-999999999999999-999
                                   PIC  S9(15)V9(03)
                                   VALUE  999999999999999.999.
         05  CNS-99999999-9999999999
                                   PIC  S9(08)V9(10)
                                   VALUE  99999999.9999999999.
         05  CNS-999999999999-999999
                                   PIC  S9(12)V9(06)
                                   VALUE  999999999999.999999.
      *----------  SELECT  投資対象国コード
         05  CNS-TSTSK-CD          PIC  X(08)  VALUE  "TSTSK_CD".
      *----------  SELECT  発行国コード
         05  CNS-HAKO-CD           PIC  X(07)  VALUE  "HAKO_CD".
         05  CNS-MS                PIC  X(02)  VALUE  "MS".
         05  CNS-KR                PIC  X(02)  VALUE  "KR".
      *----------  エラーポジション
         05  CNS-063               PIC  9(03)  VALUE  063.
         05  CNS-064               PIC  9(03)  VALUE  064.
         05  CNS-065               PIC  9(03)  VALUE  065.
         05  CNS-066               PIC  9(03)  VALUE  066.
         05  CNS-067               PIC  9(03)  VALUE  067.
         05  CNS-068               PIC  9(03)  VALUE  068.
         05  CNS-069               PIC  9(03)  VALUE  069.
         05  CNS-070               PIC  9(03)  VALUE  070.
      *----------  証券種別コード
         05  CNS-OOXZ              PIC  X(04)  VALUE  "OOXZ".
      *******    テーマNo.3049  20110706 修正  開始    ***************
         05  CNS-EXC               PIC  X(03)  VALUE  "EXC".
      *******    テーマNo.3049  20110706 修正  終了    ***************
         05  CNS-EXCB              PIC  X(04)  VALUE  "EXCB".
         05  CNS-EXCS              PIC  X(04)  VALUE  "EXCS".
         05  CNS-CASH              PIC  X(04)  VALUE  "CASH".           20110923
      ******************************************************************
      *                ORACLE ホスト変数定義
      ******************************************************************
      *----------  ＳＱＬコミュニケーション領域
           EXEC  SQL  INCLUDE  SQLCA             END-EXEC.
           EXEC  SQL  INCLUDE  ORACA             END-EXEC.
           EXEC  SQL  BEGIN   DECLARE   SECTION  END-EXEC.
       01  HST-AREA.
      *----------  残高異動計算データTBL(別紙1-16)
         05  H-TKMZBW06-16-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *----------  起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *----------  資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *----------  玉ＩＤ
           10  H-GYOKU-ID          PIC  X(10).
      *----------  異動計上順序
           10  H-IDO-KJY-JUN       PIC  S9(08).
      *----------  残高異動計算データTBL(別紙1-16)
         05  H-TKMZBW06-16.
      *----------  取引事由
           10  H-TORI-JIYU         PIC  X(04).
      *----------  市場通貨払出単価
           10  H-SJTK-H-TNK        PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  H-UYTK-H-TNK        PIC  S9(08)V9(10).
      *----------  残高異動TBL(別紙1-17)
         05  H-TKMZZI00-17-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *----------  資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *----------  玉ＩＤ
           10  H-GYOKU-ID          PIC  X(10).
      *----------  計上基準日
           10  H-KEIJOU-KIJUNBI-K  PIC  S9(08).
      *----------  計上基準日
           10  H-KEIJOU-KIJUNBI-J  PIC  S9(08).
      *----------  原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *----------  残高異動TBL(別紙1-17)
         05  H-TKMZZI00-17.
      *----------  取引事由
           10  H-TORI-JIYU         PIC  X(04).
      *----------  市場通貨払出単価
           10  H-SJTK-H-TNK        PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  H-UYTK-H-TNK        PIC  S9(08)V9(10).
      *---------- 別紙1-13
         05  H-TKMZBW08.
      *---------- 市場通貨未収収益
           10  H-SJTK-MS-SHEKI     PIC  S9(18)V9(18).
      *---------- 市場通貨源泉税
           10  H-SJTK-GENSEN-TAX   PIC  S9(18)V9(18).
      *---------- 運用通貨未収収益
           10  H-UYTK-MS-SHEKI     PIC  S9(18)V9(18).
      *---------- 運用通貨源泉税
           10  H-UYTK-GENSEN-TAX   PIC  S9(18)V9(18).
      *---------- SUM(評価為替レート)
           10  H-SUM-HYK-KWS       PIC  S9(18)V9(18).
      *---------- SUM(源泉税評価為替レート)
           10  H-SUM-GENS-TAX-HYK-KWS
                                   PIC  S9(18)V9(18).
      *---------- MAX(評価為替レート)
           10  H-MAX-HYK-KWS       PIC  S9(18)V9(18).
      *---------- MAX(源泉税評価為替レート)
           10  H-MAX-GENS-TAX-HYK-KWS
                                   PIC  S9(18)V9(18).
      *---------- 別紙1-13
         05  H-TKMZBW08-S.
      *---------- (1)
           10  H-RIYO-CMP-CD1      PIC  X(04).
           10  H-FUND-CD1          PIC  X(12).
           10  H-PTF-CD1           PIC  X(04).
           10  H-SEC-SBT-CD1       PIC  X(04).
           10  H-MEG-CD1           PIC  X(15).
           10  H-TATE-FLG1         PIC  X(01).
           10  H-GYOKU-ID1         PIC  X(10).
      *---------- (2)
           10  H-RIYO-CMP-CD2      PIC  X(04).
           10  H-FUND-CD2          PIC  X(12).
           10  H-PTF-CD2           PIC  X(04).
           10  H-SEC-SBT-CD2       PIC  X(04).
           10  H-MEG-CD2           PIC  X(15).
           10  H-TATE-FLG2         PIC  X(01).
           10  H-GYOKU-ID2         PIC  X(10).
           10  H-TEKIYO-FROM1      PIC  S9(08).
           10  H-KENRI-OTI-YMD1    PIC  S9(08).
      *---------- (3)
           10  H-SYORI-YMD1        PIC  S9(08).
           10  H-KIDOU-ID1         PIC  X(04).
           10  H-RIYO-CMP-CD3      PIC  X(04).
           10  H-FUND-CD3          PIC  X(12).
           10  H-PTF-CD3           PIC  X(04).
           10  H-SEC-SBT-CD3       PIC  X(04).
           10  H-MEG-CD3           PIC  X(15).
           10  H-TATE-FLG3         PIC  X(01).
           10  H-GYOKU-ID3         PIC  X(10).
      *---------- (4)
           10  H-SYORI-YMD2        PIC  S9(08).
           10  H-KIDOU-ID2         PIC  X(04).
           10  H-RIYO-CMP-CD4      PIC  X(04).
           10  H-FUND-CD4          PIC  X(12).
           10  H-PTF-CD4           PIC  X(04).
           10  H-SEC-SBT-CD4       PIC  X(04).
           10  H-MEG-CD4           PIC  X(15).
           10  H-TATE-FLG4         PIC  X(01).
           10  H-GYOKU-ID4         PIC  X(10).
           10  H-TEKIYO-FROM2      PIC  S9(08).
           10  H-KENRI-OTI-YMD2    PIC  S9(08).
         05  H-TKMZBW11-I.
           10  H-SYORI-YMD         PIC  S9(08).
           10  H-KIDOU-ID          PIC  X(04).
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-SEC-SBT-CD        PIC  X(04).
           10  H-MEG-CD            PIC  X(15).
           10  H-TATE-FLG          PIC  X(01).
           10  H-GYOKU-ID          PIC  X(10).
           10  H-KJN-YMD           PIC  S9(08).
           10  H-KSN-YMD-DMN-KBN   PIC  X(01).
           10  H-SIJO-TUKA-CD      PIC  X(04).
           10  H-SRYZN             PIC  S9(12)V9(06).
           10  H-SJTK-BOKAZN       PIC  S9(15)V9(03).
           10  H-UYTK-BOKAZN       PIC  S9(15)V9(03).
           10  H-SJTK-BOKA-TNK     PIC  S9(08)V9(10).
           10  H-UYTK-BOKA-TNK     PIC  S9(08)V9(10).
           10  H-BOKA-KWS          PIC  S9(08)V9(10).
           10  H-SJTK-PPAYZN       PIC  S9(15)V9(03).
           10  H-UYTK-PPAYZN       PIC  S9(15)V9(03).
           10  H-SJTK-ARECZN       PIC  S9(15)V9(03).
           10  H-UYTK-ARECZN       PIC  S9(15)V9(03).
           10  H-SJTK-SPAYZN       PIC  S9(15)V9(03).
           10  H-UYTK-SPAYZN       PIC  S9(15)V9(03).
           10  H-SJTK-H-TNK        PIC  S9(08)V9(10).
           10  H-UYTK-H-TNK        PIC  S9(08)V9(10).
           10  H-SAME-COST-KZK-FLG PIC  X(01).
           10  H-SJTK-KEKA-RSK     PIC  S9(12)V9(06).
           10  H-UYTK-KEKA-RSK     PIC  S9(12)V9(06).
           10  H-SJTK-MS-SHEKI     PIC  S9(15)V9(03).
           10  H-UYTK-MS-SHEKI     PIC  S9(15)V9(03).
           10  H-SJTK-GENSEN-TAX   PIC  S9(15)V9(03).
           10  H-UYTK-GENSEN-TAX   PIC  S9(15)V9(03).
           10  H-HYK-KWS           PIC  S9(08)V9(10).
           10  H-GENS-TAX-HYK-KWS  PIC  S9(08)V9(10).
           10  H-FACTOR-RENDOU-KESU
                                   PIC  S9(08)V9(10).
           10  H-SJTK-MSSE-KJMIG   PIC  S9(15)V9(03).
           10  H-UYTK-MSSE-KJMIG   PIC  S9(15)V9(03).
           10  H-SRYZN-RIT         PIC  S9(12)V9(06).
           10  H-TGYOKU-TNK        PIC  S9(08)V9(10).
           10  H-TGYOKU-KWS-RATE   PIC  S9(08)V9(10).
           10  H-TGYOKU-BRK        PIC  X(04).
           10  H-TGYOKU-YKJ-YMD    PIC  S9(08).
           10  H-SJTK-TG-YJKNZN    PIC  S9(15)V9(03).
           10  H-UYTK-TG-YJKNZN    PIC  S9(15)V9(03).
           10  H-SJTK-TG-TSRZN     PIC  S9(15)V9(03).
           10  H-UYTK-TG-TSRZN     PIC  S9(15)V9(03).
           10  H-SJTK-TG-S-TAXZN   PIC  S9(15)V9(03).
           10  H-UYTK-TG-S-TAXZN   PIC  S9(15)V9(03).
           10  H-SJTK-TG-ELS-HIYOZN
                                   PIC  S9(15)V9(03).
           10  H-UYTK-TG-ELS-HIYOZN
                                   PIC  S9(15)V9(03).
           10  H-SJTK-TG-SSKGZN    PIC  S9(15)V9(03).
           10  H-UYTK-TG-SSKGZN    PIC  S9(15)V9(03).
           10  H-OP-TATE-FLG       PIC  X(01).
           10  H-SJTK-GSZKP-YTZN   PIC  S9(15)V9(03).
           10  H-UYTK-GSZKP-YTZN   PIC  S9(15)V9(03).
           10  H-KSTK-GSZKP-YTZN   PIC  S9(12)V9(06).
           10  H-SJTK-NOCV-MSKZN   PIC  S9(15)V9(03).
           10  H-UYTK-NOCV-MSKZN   PIC  S9(15)V9(03).
           10  H-SJTK-NOCV-MBKZN   PIC  S9(15)V9(03).
           10  H-UYTK-NOCV-MBKZN   PIC  S9(15)V9(03).
           10  H-SHORT-STEN-KEKA-RSK
                                   PIC  S9(12)V9(06).
           10  H-SHORT-START-YMD   PIC  S9(08).
           10  H-SHORT-END-YMD     PIC  S9(08).
           10  H-KH-KAIKEI-BASE-FLG
                                   PIC  X(01).
           10  H-TSTSK-CD          PIC  X(04).
           10  H-HAKO-CD           PIC  X(04).
           10  H-SURYO-TANI        PIC  S9(12)V9(06).
           10  H-SJTK-MBHYZN       PIC  S9(15)V9(03).
           10  H-UYTK-MBHYZN       PIC  S9(15)V9(03).
           10  H-SJTK-MB-S-TAXZN   PIC  S9(15)V9(03).
           10  H-UYTK-MB-S-TAXZN   PIC  S9(15)V9(03).
           10  H-SJTK-IK-HKSEZN    PIC  S9(15)V9(03).
           10  H-UYTK-IK-HKSEZN    PIC  S9(15)V9(03).
           10  H-SJTK-IK-MSSHEKI   PIC  S9(15)V9(03).
           10  H-UYTK-IK-MSSHEKI   PIC  S9(15)V9(03).
           10  H-UYTK-IK-PPHKZN    PIC  S9(15)V9(03).
           10  H-SAKUJO-KBN        PIC  X(01).
           10  H-SK-DATE           PIC  X(14).
           10  H-SK-LOGIN-CMP-CD   PIC  X(04).
           10  H-SK-SID            PIC  X(20).
           10  H-SK-PGMID          PIC  X(16).
           10  H-UPD-DATE          PIC  X(14).
           10  H-UPD-LOGIN-CMP-CD  PIC  X(04).
           10  H-UPD-SID           PIC  X(20).
           10  H-UPD-PGMID         PIC  X(16).
         05  H-TKMZBW06.
           EXEC  SQL INCLUDE  "TKMZBW06.cpy" END-EXEC.
         05  H-TKMZBW06-TBL-KBN    PIC  S9(01).
         05  H-TKMZBW06-S.
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-SEC-SBT-CD        PIC  X(04).
           10  H-MEG-CD            PIC  X(15).
           10  H-TATE-FLG          PIC  X(01).
           10  H-GYOKU-ID          PIC  X(10).
           10  H-KEIJOU-KIJUNBI-1  PIC  S9(08).
           10  H-KEIJOU-KIJUNBI-2  PIC  S9(08).
           10  H-SYORI-YMD         PIC  S9(08).
           10  H-KIDOU-ID          PIC  X(04).
         05  H-TKMZBW12-I.
           10  H-SYORI-YMD         PIC  S9(08).
           10  H-KIDOU-ID          PIC  X(04).
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-KS-KOZA-NO        PIC  X(15).
           10  H-KJN-YMD           PIC  S9(08).
           10  H-KSN-YMD-DMN-KBN   PIC  X(01).
           10  H-SEC-SBT-CD        PIC  X(04).
           10  H-KOZA-TUKA-CD      PIC  X(04).
           10  H-SJTK-TJT-CASHZN   PIC  S9(15)V9(03).
           10  H-UYTK-TJT-CASHZN   PIC  S9(15)V9(03).
           10  H-SJTK-TJT-MSNKZN-UM
                                   PIC  S9(15)V9(03).
           10  H-UYTK-TJT-MSNKZN-UM
                                   PIC  S9(15)V9(03).
           10  H-SJTK-TJT-MSNKZN-SM
                                   PIC  S9(15)V9(03).
           10  H-UYTK-TJT-MSNKZN-SM
                                   PIC  S9(15)V9(03).
           10  H-SJTK-TJT-MBKZN-UM PIC  S9(15)V9(03).
           10  H-UYTK-TJT-MBKZN-UM PIC  S9(15)V9(03).
           10  H-SJTK-TJT-MBKZN-SM PIC  S9(15)V9(03).
           10  H-UYTK-TJT-MBKZN-SM PIC  S9(15)V9(03).
           10  H-BOKA-KWS          PIC  S9(08)V9(10).
           10  H-SJTK-MS-SHEKI     PIC  S9(15)V9(03).
           10  H-UYTK-MS-SHEKI     PIC  S9(15)V9(03).
           10  H-SJTK-GENSEN-TAX   PIC  S9(15)V9(03).
           10  H-UYTK-GENSEN-TAX   PIC  S9(15)V9(03).
           10  H-SK-LOGIN-CMP-CD   PIC  X(04).
           10  H-UPD-LOGIN-CMP-CD  PIC  X(04).
           10  H-SJTK-MSSE-KJMIG   PIC  S9(15)V9(03).
           10  H-UYTK-MSSE-KJMIG   PIC  S9(15)V9(03).
         05  H-TKMZBW07.
           EXEC  SQL INCLUDE  "TKMZBW07.cpy"  END-EXEC.
         05  H-TKMZBW07-TBL-KBN    PIC  S9(01).
         05  H-TKMZBW07-S.
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-KS-KOZA-NO        PIC  X(15).
           10  H-IDO-YMD-1         PIC  S9(08).
           10  H-IDO-YMD-2         PIC  S9(08).
           10  H-SYORI-YMD         PIC  S9(08).
           10  H-KIDOU-ID          PIC  X(04).
         05  H-TKMZBW13-I.
           10  H-SYORI-YMD         PIC  S9(08).
           10  H-KIDOU-ID          PIC  X(04).
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-KJN-YMD           PIC  S9(08).
           10  H-KSN-YMD-DMN-KBN   PIC  X(01).
           10  H-GNP-SRYZN         PIC  S9(12)V9(06).
           10  H-GNP-BOKAZN        PIC  S9(15)V9(03).
           10  H-SO-TN-KGK         PIC  S9(15)V9(03).
           10  H-SHOKI-SET-KGK     PIC  S9(15)V9(03).
           10  H-SK-LOGIN-CMP-CD   PIC  X(04).
           10  H-UPD-LOGIN-CMP-CD  PIC  X(04).
         05  H-TKMZBW02-U.
           10  H-KJN-YMD-DMN-SK-KBN
                                   PIC  X(01).
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-SYORI-YMD         PIC  S9(08).
           10  H-KIDOU-ID          PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-KJN-YMD           PIC  S9(08).
         05  H-TKMZZR00.
           EXEC  SQL INCLUDE  "TKMZZR00.cpy"  END-EXEC.
         05  H-TKMZZR00-S.
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-SEC-SBT-CD        PIC  X(04).
           10  H-MEG-CD            PIC  X(15).
           10  H-TATE-FLG          PIC  X(01).
           10  H-GYOKU-ID          PIC  X(10).
           10  H-KJN-YMD           PIC  S9(08).
         05  H-TKMZSR00.
           EXEC  SQL INCLUDE  "TKMZSR00.cpy"  END-EXEC.
         05  H-TKMZSR00-S.
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-KS-KOZA-NO        PIC  X(15).
           10  H-KJN-YMD           PIC  S9(08).
         05  H-TKMZGZ00.
           EXEC  SQL INCLUDE  "TKMZGZ00.cpy"  END-EXEC.
         05  H-TKMZGZ00-S.
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 別紙1-14
         05  H-TKMZKR-MS           PIC  X(04).
         05  H-TKMZKR-MS-S.
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-SEC-SBT-CD        PIC  X(04).
           10  H-MEG-CD            PIC  X(15).
           10  H-TATE-FLG          PIC  X(01).
           10  H-GYOKU-ID          PIC  X(10).
           10  H-MEG-CD-SHRU2      PIC  X(01).
           10  H-KAISI-KJN-YMD-NEXT
                                   PIC  S9(08).
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 別紙1-15
         05  H-TKMZBW11-S.
           10  H-RIYO-CMP-CD       PIC  X(04).
           10  H-SYORI-YMD         PIC  S9(08).
           10  H-KIDOU-ID          PIC  X(04).
           10  H-FUND-CD           PIC  X(12).
           10  H-PTF-CD            PIC  X(04).
           10  H-SEC-SBT-CD        PIC  X(04).
           10  H-MEG-CD            PIC  X(15).
           10  H-TATE-FLG          PIC  X(01).
           10  H-GYOKU-ID          PIC  X(10).
           10  H-KJN-YMD           PIC  S9(08).
         05  H-KJN-YMD-COUNT       PIC  9(08).
      *  05  SQLSTMT               PIC  X(4000).                        @3212SEINO@@
      *  05  SQLSTMT1              PIC  X(6000).                        @3212SEINO@@
      *  05  SQLSTMT2              PIC  X(13000).                       @3212SEINO@@
         05  SQLSTMT01             PIC  X(2500).                        @3212SEINO@@
         05  SQLSTMT02             PIC  X(1200).                        @3212SEINO@@
         05  SQLSTMT04-1           PIC  X(10000).                       @3212SEINO@@
         05  SQLSTMT04-2           PIC  X(10000).                       @3212SEINO@@
         05  SQLSTMT04-3           PIC  X(10000).                       @3212SEINO@@
         05  SQLSTMT04-4           PIC  X(10000).                       @3212SEINO@@
         05  SQLSTMT07             PIC  X(3000).                        @3212SEINO@@
         05  SQLSTMT12             PIC  X(800).                         @3212SEINO@@
         05  SQLSTMT13             PIC  X(6000).                        @3212SEINO@@
         05  SQLSTMT14-1           PIC  X(1000).                        @3212SEINO@@
         05  SQLSTMT14-2           PIC  X(1000).                        @3212SEINO@@
         05  SQLSTMT15             PIC  X(500).                         @3212SEINO@@
         05  SQLSTMT16             PIC  X(1000).                        @3212SEINO@@
         05  SQLSTMT17-1           PIC  X(1000).                        @3212SEINO@@
         05  SQLSTMT17-2           PIC  X(1000).                        @3212SEINO@@
         05  SQLSTMTIN01           PIC  X(3000).                        @3212SEINO@@
         05  SQLSTMTIN02           PIC  X(1500).                        @3212SEINO@@
         05  SQLSTMTIN03           PIC  X(1000).                        @3212SEINO@@
           EXEC  SQL  END DECLARE       SECTION  END-EXEC.
      ******************************************************************
      *    フラグエリア
      ******************************************************************
       01  FLG-AREA.
      *----------  残高異動計算データカーソルオープンフラグ1
         05  FLG-TKMZBW06-CR1-OPEN PIC  9(01).
      *----------  資金簿価異動計算データカーソルオープンフラグ
         05  FLG-TKMZBW07-CR-OPEN  PIC  9(01).
       01  FLG-AREA-CR.
      *----------  未収収益計算データカーソルオープンフラグ
         05  FLG-TKMZBW08-CR-OPEN  PIC  9(01).
      *----------  残高異動計算データカーソルオープンフラグ
         05  FLG-TKMZBW06-CR1-OPEN-PR                                   @3212SEINO@@
                                   PIC  9(01).                          @3212SEINO@@
         05  FLG-TKMZBW06-CR3-OPEN-PR                                   @3212SEINO@@
                                   PIC  9(01).                          @3212SEINO@@
      *----------  残高異動計算データカーソルオープンフラグ2
         05  FLG-TKMZBW06-CR2-OPEN PIC  9(01).
         05  FLG-TKMZBW06-CR4-OPEN PIC  9(01).
      *----------  残高異動計算データカーソルオープンフラグ16
         05  FLG-TKMZBW06-CR16-OPEN
                                   PIC  9(01).
      *----------  残高履歴カーソルオープンフラグ
         05  FLG-TKMZZR00-CR-OPEN  PIC  9(01).
      *----------  資金残履歴カーソルオープンフラグ
         05  FLG-TKMZSR00-CR-OPEN  PIC  9(01).
      *----------  元本残高カーソルオープンフラグ
         05  FLG-TKMZGZ00-CR-OPEN  PIC  9(01).
      *----------  未収収益と債券過去経過利息カーソルオープンフラグ
         05  FLG-TKMZMS-KR-CR-OPEN PIC  9(01).
         05  FLG-TKMZMS-KR-CR-OPEN2
                                   PIC  9(01).
      *----------  残高履歴計算データカーソルオープンフラグ
         05  FLG-TKMZBW11-CR-OPEN  PIC  9(01).
      *----------  残高異動カーソルオープンフラグ17
         05  FLG-TKMZZI00-CR17-OPEN
                                   PIC  9(01).
         05  FLG-TKMZZI00-CR17-OPEN2
                                   PIC  9(01).
      *----------  資金簿価異動計算データカーソルオープンフラグ         @3212SEINO@@
         05  FLG-TKMZBW07-CR-OPEN-PR                                    @3212SEINO@@
                                   PIC  9(01).                          @3212SEINO@@
         05  FLG-TKMZBW11-S10-INSERT                                    @3212SEINO@@
                                   PIC  9(01).                          @3212SEINO@@
         05  FLG-TKMZBW12-S11-INSERT                                    @3212SEINO@@
                                   PIC  9(01).                          @3212SEINO@@
         05  FLG-TKMZBW13-S12-INSERT                                    @3212SEINO@@
                                   PIC  9(01).                          @3212SEINO@@
       01  FIRST-SW                PIC  X(03)  VALUE  'YES'.            @3212SEINO@@
      ******************************************************************
      *                サブプログラム  パラメ－タ  エリア
      ******************************************************************
      *----------  ARG1リターンパッケージセットルーチン
       01  PARM-SCZY1170-IN.
           COPY  "SCZY1170.cpy".
      *----------  リターンパッケージセットルーチン
       01  PARM-SCZY1170-RTNPKG.
         05  PARM-SCZY1170-ARG2.
             COPY  "CZRTNPACKAGE.cpy".
      *----------  【SMZC9201】取引差分更新管理更新用ルーチン
       01  PARM-SMZC9201-INOUT.
           COPY  "SMZC9201.cpy".
      *----------  【SMZJ4012】取引事由判定
       01  PARM-SMZJ4012-INOUT.
           COPY  "SMZJ4012.cpy".
      *----------  【SMZJ4014】証券種別判定
       01  PARM-SMZJ4014-INOUT.
           COPY  "SMZJ4014.cpy".
      *----------  テーブルID取得ルーチンパラメータ
       01  PARM-SCZY1160-INOUT.
           COPY  "SCZY1160.cpy".
      *----------  ARG2リターンパッケージセットルーチン
       01  PARM-RTNPKG.
         05 PARM-RTNPKG-ARG2.
           COPY  "CZRTNPACKAGE.cpy".
      ******************************************************************
      *    ワークエリア
      ******************************************************************
       01  WORK-AREA.
      *----------  ワーク.市場通貨未収収益
         05  WK-SJTK-MS-SHEKI      PIC  S9(15)V9(03).
      *----------  ワーク.市場通貨源泉税
         05  WK-SJTK-GENSEN-TAX    PIC  S9(15)V9(03).
      *----------  ワーク.運用通貨未収収益
         05  WK-UYTK-MS-SHEKI      PIC  S9(15)V9(03).
      *----------  ワーク.運用通貨源泉税
         05  WK-UYTK-GENSEN-TAX    PIC  S9(15)V9(03).
      *----------  ワーク.権利付数量
         05  WK-RIT-SRY            PIC  S9(12)V9(06).
      *----------  ワーク.評価為替レート
         05  WK-HYK-KWS            PIC  S9(08)V9(10).
      *----------  ワーク.源泉税評価為替レート
         05  WK-GENS-TAX-HYK-KWS   PIC  S9(08)V9(10).
      *----------  基準日断面情報.処理実行日
         05  WK-SYORI-YMD          PIC  S9(08).
      *----------  基準日断面情報.起動ID
         05  WK-KIDOU-ID           PIC  X(04).
      *----------  基準日断面情報.基本会計ベースフラグ
         05  WK-KH-KAIKEI-BASE-FLG PIC  X(01).
      *----------  銘柄別断面情報.利用会社コード
         05  WK-RIYO-CMP-CD        PIC  X(04).
      *----------  銘柄別断面情報.ファンドコード
         05  WK-FUND-CD            PIC  X(12).
      *----------  銘柄別断面情報.ポートフォリオコード
         05  WK-PTF-CD             PIC  X(04).
      *----------  銘柄別断面情報.証券種別コード
         05  WK-SEC-SBT-CD         PIC  X(04).
      *----------  銘柄別断面情報.銘柄コード
         05  WK-MEG-CD             PIC  X(15).
      *----------  銘柄別断面情報.資産負債・買建売建フラグ
         05  WK-TATE-FLG           PIC  X(01).
      *----------  銘柄別断面情報.玉ID
         05  WK-GYOKU-ID           PIC  X(10).
      *----------  開始基準日
         05  WK-KAISI-KJN-YMD      PIC  S9(08).
      *----------  銘柄別断面情報.基準日
         05  WK-KJN-YMD            PIC  S9(08).
      *----------  銘柄別断面情報.銘柄種類
         05  WK-MEG-CD-SHRU        PIC  X(01).
      *----------  銘柄別断面情報.再計算区分
         05  WK-SAI-CALC-KBN       PIC  X(01).
      *----------  銘柄別断面情報.差分更新FROM日
         05  WK-SABON-UPDATE-FROM  PIC  S9(08).
      *----------  異動計算パターン.処理順序
         05  WK-SYRI-JUN           PIC  X(01).
      *---------- ポジション
         05  WK-ERR-POS            PIC  X(04).
      *---------- ポジション1
         05  WK-ERR-POS1           PIC  X(04).
      *---------- ポジション2
         05  WK-ERR-POS2           PIC  X(04).
      *---------- ワーク評価損益データフラグ
         05  WK-HYK-SNEKI-DATA-FLG PIC  X(01).
      *---------- ワーク件数
         05  WK-INDEX              PIC  9(03).
      *---------- ワーク計上フラグ
         05  WK-KEIJYO-FLG         PIC  X(01).
      *---------- ワーク普通フラグ
         05  WK-NORMAL-FLG         PIC  X(01).
      *---------- ワーク残高異動計算データ
         05  WK-TKMZBW06.
             COPY  "TKMZBW06.cpy".
         05  WK-TBL-KBN            PIC  9(01).
      *---------- ワーク残高異動計算データ(対象)
         05  WK-TKMZBW06-TASYOU.
             COPY  "TKMZBW06.cpy".
      *---------- ワーク残高異動計算データ(計上)
         05  WK-TKMZBW06-KEIJYO.
             COPY  "TKMZBW06.cpy".
      *---------- ワーク残高異動計算データ(普通)
         05  WK-TKMZBW06-NORMAL.
             COPY  "TKMZBW06.cpy".
      *---------- ワーク残高履歴更新
         05  WK-ZNRRK-KOUSIN.
      *---------- データ１フラグ
           10  WK-DATA-1-FLG       PIC  X(01).
      *---------- データ１
           10  WK-DATA-1.
               COPY  "TKMZBW11.cpy".
      *---------- データ１有効残高区分
           10  WK-DATA-1-YUKOU-ZN-KBN
                                   PIC  X(01).
      *---------- データ２フラグ
           10  WK-DATA-2-FLG       PIC  X(01).
      *---------- データ２
           10  WK-DATA-2.
               COPY  "TKMZBW11.cpy".
      *---------- データ２有効残高区分
           10  WK-DATA-2-YUKOU-ZN-KBN
                                   PIC  X(01).
      *---------- ワーク元本残高更新
         05  WK-GNPZN-KOUSIN.
      *---------- データ１フラグ
           10  WK-DATA-1-FLG       PIC  X(01).
      *---------- データ１
           10  WK-DATA-1.
               COPY  "TKMZBW13.cpy".
      *---------- データ１有効残高区分
           10  WK-DATA-1-YUKOU-ZN-KBN
                                   PIC  X(01).
      *---------- データ２フラグ
           10  WK-DATA-2-FLG       PIC  X(01).
      *---------- データ２
           10  WK-DATA-2.
               COPY  "TKMZBW13.cpy".
      *---------- データ２有効残高区分
           10  WK-DATA-2-YUKOU-ZN-KBN
                                   PIC  X(01).
      *---------- ワーク資金簿価異動計算データ
         05  WK-TKMZBW07.
             COPY  "TKMZBW07.cpy".
      *---------- ワーク資金簿価異動計算データ(対象)
         05  WK-TKMZBW07-TASYOU.
             COPY  "TKMZBW07.cpy".
      *---------- ワーク資金簿価異動計算データ(計上)
         05  WK-TKMZBW07-KEIJYO.
             COPY  "TKMZBW07.cpy".
      *---------- ワーク資金簿価異動計算データ(普通)
         05  WK-TKMZBW07-NORMAL.
             COPY  "TKMZBW07.cpy".
      *---------- ワーク資金残履歴更新
         05  WK-SKZN-KOUSIN.
      *---------- データ１フラグ
           10  WK-DATA-1-FLG       PIC  X(01).
      *---------- データ１
           10  WK-DATA-1.
               COPY  "TKMZBW12.cpy".
      *---------- データ１有効残高区分
           10  WK-DATA-1-YUKOU-ZN-KBN
                                   PIC  X(01).
      *---------- データ２フラグ
           10  WK-DATA-2-FLG       PIC  X(01).
      *---------- データ２
           10  WK-DATA-2.
               COPY  "TKMZBW12.cpy".
      *---------- データ２有効残高区分
           10  WK-DATA-2-YUKOU-ZN-KBN
                                   PIC  X(01).
      *---------- ワーク断面作成情報
         05  WK-DMN-SK-JH.
      *---------- 計上_決算後
           10  WK-KEIJYO-KSG       PIC  X(01).
      *---------- 普通_決算断面なし
           10  WK-NORMAL-NASI      PIC  X(01).
      *---------- 普通_決算前
           10  WK-NORMAL-MAE       PIC  X(01).
      *---------- 普通_決算後
           10  WK-NORMAL-ATO       PIC  X(01).
      *---------- 開始時_決算断面なし
           10  WK-START-NASI       PIC  X(01).
      *---------- 開始時_決算前
           10  WK-START-MAE        PIC  X(01).
      *---------- 開始時_決算後
           10  WK-START-ATO        PIC  X(01).
      *---------- 基準日別更新区分
           10  WK-KJB-KOUSIN-KBN   PIC  X(01).
      *---------- ワーク有効残高フラグ
         05  WK-YUKOU-ZN-FLG       PIC  X(01).
      *---------- ワーク残高履歴計算データ(対象)
         05  WK-TKMZBW11-TASYOU.
             COPY  "TKMZBW11.cpy".
      *---------- ワーク資金残履歴計算データ(対象)
         05  WK-TKMZBW12-TASYOU.
             COPY  "TKMZBW12.cpy".
      *---------- ワーク元本残高計算データ(対象)
         05  WK-TKMZBW13-TASYOU.
             COPY  "TKMZBW13.cpy".
      *---------- 売買フラグ
         05  WK-URIKAI-FLG         PIC  X(01).
      *---------- ワーク同一コスト継続フラグ
         05  WK-SAME-COST-KZK-FLG  PIC  X(01).
      *---------- ワーク未収収益/債券過去経過利息フラグ
         05  WK-MS-KR-FLG          PIC  X(02).
      *---------- ワーク売り続く証券区別区分
         05  WK-BUY-SEC-SBT-KBN    PIC  X(01).
      *---------- ワーク売り続く中間
         05  WK-URU-TUZUKI-MID.
      *---------- 取引事由
           10  WK-TORI-JIYU        PIC  X(04).
      *---------- 市場通貨払出単価
           10  WK-SJTK-H-TNK       PIC  S9(08)V9(10).
      *---------- 運用通貨払出単価
           10  WK-UYTK-H-TNK       PIC  S9(08)V9(10).
      *---------- ワークデータなしフラグ
         05  WK-DATA-NASI-FLG      PIC  X(01).
      *---------- ワーク未収収益/債券過去経過利息のエラーポジション
         05  WK-MSKR-ERPO-PRE      PIC  9(03).
         05  WK-MSKR-ERPO-OPEN     PIC  9(03).
         05  WK-MSKR-ERPO-FETCH    PIC  9(03).
         05  WK-MSKR-ERPO-CLOSE    PIC  9(03).
         05  WK-KJN-YMD-COUNT      PIC  9(08).
      ******************************************************************
      *    SQL  エリア
      ******************************************************************
       01  SQL-AREA.
      *----------  残高履歴（TKMZZR00 別紙1-1)
         05  SQL-SELECT-1-1.
           10  S-SELECT-1-1.
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  証券種別コード
             15  FILLER            PIC  X(12)  VALUE
                 "SEC_SBT_CD, ".
      *----------  銘柄コード
             15  FILLER            PIC  X(08)  VALUE
                 "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
             15  FILLER            PIC  X(10)  VALUE
                 "TATE_FLG, ".
      *----------  玉ＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "GYOKU_ID, ".
      *----------  基準日
             15  FILLER            PIC  X(09)  VALUE
                 "KJN_YMD, ".
      *----------  決算日断面区分
             15  FILLER            PIC  X(17)  VALUE
                 "KSN_YMD_DMN_KBN, ".
      *----------  市場通貨コード
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(SIJO_TUKA_CD,' '), ".
      *----------  数量残高
             15  FILLER            PIC  X(14)  VALUE
                 "NVL(SRYZN,0), ".
      *----------  市場通貨簿価残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_BOKAZN,0), ".
      *----------  運用通貨簿価残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_BOKAZN,0), ".
      *----------  市場通貨簿価単価
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_BOKA_TNK,0), ".
      *----------  運用通貨簿価単価
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_BOKA_TNK,0), ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(BOKA_KWS,0), ".
      *----------  市場通貨前払金残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_PPAYZN,0), ".
      *----------  運用通貨前払金残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_PPAYZN,0), ".
      *----------  市場通貨前受金残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_ARECZN,0), ".
      *----------  運用通貨前受金残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_ARECZN,0), ".
      *----------  市場通貨仮払金残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_SPAYZN,0), ".
      *----------  運用通貨仮払金残高
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_SPAYZN,0), ".
      *----------  市場通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SJTK_H_TNK,0), ".
      *----------  運用通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(UYTK_H_TNK,0), ".
      *----------  同一コスト継続フラグ
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SAME_COST_KZK_FLG,' '), ".
      *----------  市場通貨経過利息
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_KEKA_RSK,0), ".
      *----------  運用通貨経過利息
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_KEKA_RSK,0), ".
      *----------  市場通貨未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_MS_SHEKI,0), ".
      *----------  運用通貨未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_MS_SHEKI,0), ".
      *----------  市場通貨源泉税
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_GENSEN_TAX,0), ".
      *----------  運用通貨源泉税
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_GENSEN_TAX,0), ".
      *----------  評価為替レート
             15  FILLER            PIC  X(16)  VALUE
                 "NVL(HYK_KWS,0), ".
      *----------  源泉税評価為替レート
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(GENS_TAX_HYK_KWS,0), ".
      *----------  ファクター・連動係数
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(FACTOR_RENDOU_KESU,0), ".
      *----------  市場通貨未収収益計上・戻入額
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_MSSE_KJMIG,0), ".
      *----------  運用通貨未収収益計上・戻入額
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_MSSE_KJMIG,0), ".
      *----------  数量残高（利付）
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(SRYZN_RIT,0), ".
      *----------  建玉単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(TGYOKU_TNK,0), ".
      *----------  建玉為替レート
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(TGYOKU_KWS_RATE,0), ".
      *----------  建玉ブローカー
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(TGYOKU_BRK,' '), ".
      *----------  建玉約定日
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(TGYOKU_YKJ_YMD,0), ".
      *----------  市場通貨建玉約定金額残
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(SJTK_TG_YJKNZN,0), ".
      *----------  運用通貨建玉約定金額残
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_TG_YJKNZN,0), ".
      *----------  市場通貨建玉手数料残
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_TG_TSRZN,0), ".
      *----------  運用通貨建玉手数料残
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_TG_TSRZN,0), ".
      *----------  市場通貨建玉消費税残
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_TG_S_TAXZN,0), ".
      *----------  運用通貨建玉消費税残
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_TG_S_TAXZN,0), ".
      *----------  市場通貨建玉その他費用残
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_TG_ELS_HIYOZN,0), ".
      *----------  運用通貨建玉その他費用残
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_TG_ELS_HIYOZN,0), ".
      *----------  市場通貨建玉精算金額残
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(SJTK_TG_SSKGZN,0), ".
      *----------  運用通貨建玉精算金額残
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_TG_SSKGZN,0), ".
      *----------  ＯＰ資産負債・買建売建フラグ
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(OP_TATE_FLG,' '), ".
      *----------  市場通貨源泉税還付予定額残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_GSZKP_YTZN,0), ".
      *----------  運用通貨源泉税還付予定額残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_GSZKP_YTZN,0), ".
      *----------  決済通貨源泉税還付予定額残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(KSTK_GSZKP_YTZN,0), ".
      *----------  市場通貨ノンカバー未収金残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_NOCV_MSKZN,0), ".
      *----------  運用通貨ノンカバー未収金残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_NOCV_MSKZN,0), ".
      *----------  市場通貨ノンカバー未払金残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_NOCV_MBKZN,0), ".
      *----------  運用通貨ノンカバー未払金残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_NOCV_MBKZN,0), ".
      *----------  短期スタート・エンド経過利息
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SHORT_STEN_KEKA_RSK,0), ".
      *----------  短期スタート日
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SHORT_START_YMD,0), ".
      *----------  短期エンド日
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SHORT_END_YMD,0), ".
      *----------  基本会計ベースフラグ
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(KH_KAIKEI_BASE_FLG,' '), ".
      *----------  投資対象国コード
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(TSTSK_CD,' '), ".
      *----------  発行国コード
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(HAKO_CD,' '), ".
      *----------  数量単位
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SURYO_TANI,0), ".
      *----------  市場通貨未払費用残
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_MBHYZN,0), ".
      *----------  運用通貨未払費用残
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_MBHYZN,0), ".
      *----------  市場通貨未払消費税残
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_MB_S_TAXZN,0), ".
      *----------  運用通貨未払消費税残
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_MB_S_TAXZN,0), ".
      *----------  市場通貨移管評価損益残
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(SJTK_IK_HKSEZN,0), ".
      *----------  運用通貨移管評価損益残
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_IK_HKSEZN,0), ".
      *----------  市場通貨移管未収収益
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_IK_MSSHEKI,0), ".
      *----------  運用通貨移管未収収益
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_IK_MSSHEKI,0), ".
      *----------  運用通貨移管前払金評価損益残
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_IK_PPHKZN,0), ".
      *----------  削除区分
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SAKUJO_KBN,' '), ".
      *----------  作成日時
             15  FILLER            PIC  X(46)  VALUE
                 "NVL(TO_CHAR(SK_DATE,'YYYYMMDDHH24MISS'),' '), ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SK_LOGIN_CMP_CD,' '), ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_SID,' '), ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SK_PGMID,' '), ".
      *----------  更新日時
             15  FILLER            PIC  X(38)  VALUE
                 "TO_CHAR(UPD_DATE,'YYYYMMDDHH24MISS'), ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_PGMID".
      *----------  FROM
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL-TKMZZR00  PIC  X(13).
      *----------  WHERE
           10  S-WHERE-1-1.
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産/負債・買建/売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- 基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *---------- 決算日断面区分
             15  FILLER            PIC  X(34)  VALUE
                 " AND KSN_YMD_DMN_KBN IN ('0', '2')".
      *----------  資金残履歴（TKMZSR00 別紙1-2）
         05  SQL-SELECT-1-2.
           10  S-SELECT-1-2.
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  決済口座番号
             15  FILLER            PIC  X(12)  VALUE
                 "KS_KOZA_NO, ".
      *----------  基準日
             15  FILLER            PIC  X(09)  VALUE
                 "KJN_YMD, ".
      *----------  決算日断面区分
             15  FILLER            PIC  X(17)  VALUE
                 "KSN_YMD_DMN_KBN, ".
      *----------  証券種別コード
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SEC_SBT_CD,' '), ".
      *----------  決済口座通貨コード
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(KOZA_TUKA_CD,' '), ".
      *----------  市場通貨当日ＣＡＳＨ残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_TJT_CASHZN,0), ".
      *----------  運用通貨当日ＣＡＳＨ残高
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_TJT_CASHZN,0), ".
      *----------  市場通貨当日未収入金残高（内物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_TJT_MSNKZN_UM,0), ".
      *----------  運用通貨当日未収入金残高（内物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_TJT_MSNKZN_UM,0), ".
      *----------  市場通貨当日未収入金残高（外物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_TJT_MSNKZN_SM,0), ".
      *----------  運用通貨当日未収入金残高（外物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_TJT_MSNKZN_SM,0), ".
      *----------  市場通貨当日未払金残高（内物）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SJTK_TJT_MBKZN_UM,0), ".
      *----------  運用通貨当日未払金残高（内物）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(UYTK_TJT_MBKZN_UM,0), ".
      *----------  市場通貨当日未払金残高（外物）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SJTK_TJT_MBKZN_SM,0), ".
      *----------  運用通貨当日未払金残高（外物）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(UYTK_TJT_MBKZN_SM,0), ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(BOKA_KWS,0), ".
      *----------  市場通貨未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_MS_SHEKI,0), ".
      *----------  運用通貨未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_MS_SHEKI,0), ".
      *----------  市場通貨源泉税
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_GENSEN_TAX,0), ".
      *----------  運用通貨源泉税
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_GENSEN_TAX,0), ".
      *----------  削除区分
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SAKUJO_KBN,' '), ".
      *----------  作成日時
             15  FILLER            PIC  X(46)  VALUE
                 "NVL(TO_CHAR(SK_DATE,'YYYYMMDDHH24MISS'),' '), ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SK_LOGIN_CMP_CD,' '), ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_SID,' '), ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SK_PGMID,' '), ".
      *----------  更新日時
             15  FILLER            PIC  X(38)  VALUE
                 "TO_CHAR(UPD_DATE,'YYYYMMDDHH24MISS'), ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(11)  VALUE
                 "UPD_PGMID, ".
      *----------  市場通貨未収収益計上・戻入額
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_MSSE_KJMIG,0), ".
      *----------  運用通貨未収収益計上・戻入額
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_MSSE_KJMIG,0)".
      *----------  FROM
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL-TKMZSR00  PIC  X(13).
      *----------  WHERE
           10  S-WHERE-1-2.
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  決済口座番号
             15  FILLER            PIC  X(31)  VALUE
                 " AND KS_KOZA_NO = :P_KS_KOZA_NO".
      *----------  基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *----------  決算日断面区分
             15  FILLER            PIC  X(34)  VALUE
                 " AND KSN_YMD_DMN_KBN IN ('0', '2')".
      *---------- 残高履歴計算データ（TKMZBW11 別紙1-3,別紙1-5)
         05  SQL-INSERT-TKMZBW11.
           10  S-INSERT-TKMZBW11.
             15  FILLER            PIC  X(13)  VALUE
                 " INSERT INTO ".
             15  SQL-TBL-TKMZBW11  PIC  X(13).
             15  FILLER            PIC  X(02)  VALUE
                 " (".
             15  FILLER            PIC  X(11)  VALUE
                 " SYORI_YMD,".
             15  FILLER            PIC  X(11)  VALUE
                 " KIDOU_ID,".
             15  FILLER            PIC  X(13)  VALUE
                 " RIYO_CMP_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " FUND_CD,".
             15  FILLER            PIC  X(08)  VALUE
                 " PTF_CD,".
             15  FILLER            PIC  X(12)  VALUE
                 " SEC_SBT_CD,".
             15  FILLER            PIC  X(08)  VALUE
                 " MEG_CD,".
             15  FILLER            PIC  X(10)  VALUE
                 " TATE_FLG,".
             15  FILLER            PIC  X(10)  VALUE
                 " GYOKU_ID,".
             15  FILLER            PIC  X(09)  VALUE
                 " KJN_YMD,".
             15  FILLER            PIC  X(17)  VALUE
                 " KSN_YMD_DMN_KBN,".
             15  FILLER            PIC  X(14)  VALUE
                 " SIJO_TUKA_CD,".
             15  FILLER            PIC  X(07)  VALUE
                 " SRYZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " SJTK_BOKAZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " UYTK_BOKAZN,".
             15  FILLER            PIC  X(15)  VALUE
                 " SJTK_BOKA_TNK,".
             15  FILLER            PIC  X(15)  VALUE
                 " UYTK_BOKA_TNK,".
             15  FILLER            PIC  X(10)  VALUE
                 " BOKA_KWS,".
             15  FILLER            PIC  X(13)  VALUE
                 " SJTK_PPAYZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " UYTK_PPAYZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " SJTK_ARECZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " UYTK_ARECZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " SJTK_SPAYZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " UYTK_SPAYZN,".
             15  FILLER            PIC  X(12)  VALUE
                 " SJTK_H_TNK,".
             15  FILLER            PIC  X(12)  VALUE
                 " UYTK_H_TNK,".
             15  FILLER            PIC  X(19)  VALUE
                 " SAME_COST_KZK_FLG,".
             15  FILLER            PIC  X(15)  VALUE
                 " SJTK_KEKA_RSK,".
             15  FILLER            PIC  X(15)  VALUE
                 " UYTK_KEKA_RSK,".
             15  FILLER            PIC  X(15)  VALUE
                 " SJTK_MS_SHEKI,".
             15  FILLER            PIC  X(15)  VALUE
                 " UYTK_MS_SHEKI,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_GENSEN_TAX,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_GENSEN_TAX,".
             15  FILLER            PIC  X(09)  VALUE
                 " HYK_KWS,".
             15  FILLER            PIC  X(18)  VALUE
                 " GENS_TAX_HYK_KWS,".
             15  FILLER            PIC  X(20)  VALUE
                 " FACTOR_RENDOU_KESU,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_MSSE_KJMIG,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_MSSE_KJMIG,".
             15  FILLER            PIC  X(11)  VALUE
                 " SRYZN_RIT,".
             15  FILLER            PIC  X(12)  VALUE
                 " TGYOKU_TNK,".
             15  FILLER            PIC  X(17)  VALUE
                 " TGYOKU_KWS_RATE,".
             15  FILLER            PIC  X(12)  VALUE
                 " TGYOKU_BRK,".
             15  FILLER            PIC  X(16)  VALUE
                 " TGYOKU_YKJ_YMD,".
             15  FILLER            PIC  X(16)  VALUE
                 " SJTK_TG_YJKNZN,".
             15  FILLER            PIC  X(16)  VALUE
                 " UYTK_TG_YJKNZN,".
             15  FILLER            PIC  X(15)  VALUE
                 " SJTK_TG_TSRZN,".
             15  FILLER            PIC  X(15)  VALUE
                 " UYTK_TG_TSRZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_TG_S_TAXZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_TG_S_TAXZN,".
             15  FILLER            PIC  X(20)  VALUE
                 " SJTK_TG_ELS_HIYOZN,".
             15  FILLER            PIC  X(20)  VALUE
                 " UYTK_TG_ELS_HIYOZN,".
             15  FILLER            PIC  X(16)  VALUE
                 " SJTK_TG_SSKGZN,".
             15  FILLER            PIC  X(16)  VALUE
                 " UYTK_TG_SSKGZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " OP_TATE_FLG,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_GSZKP_YTZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_GSZKP_YTZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " KSTK_GSZKP_YTZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_NOCV_MSKZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_NOCV_MSKZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_NOCV_MBKZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_NOCV_MBKZN,".
             15  FILLER            PIC  X(21)  VALUE
                 " SHORT_STEN_KEKA_RSK,".
             15  FILLER            PIC  X(17)  VALUE
                 " SHORT_START_YMD,".
             15  FILLER            PIC  X(15)  VALUE
                 " SHORT_END_YMD,".
             15  FILLER            PIC  X(20)  VALUE
                 " KH_KAIKEI_BASE_FLG,".
             15  FILLER            PIC  X(10)  VALUE
                 " TSTSK_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " HAKO_CD,".
             15  FILLER            PIC  X(12)  VALUE
                 " SURYO_TANI,".
             15  FILLER            PIC  X(13)  VALUE
                 " SJTK_MBHYZN,".
             15  FILLER            PIC  X(13)  VALUE
                 " UYTK_MBHYZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_MB_S_TAXZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_MB_S_TAXZN,".
             15  FILLER            PIC  X(16)  VALUE
                 " SJTK_IK_HKSEZN,".
             15  FILLER            PIC  X(16)  VALUE
                 " UYTK_IK_HKSEZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_IK_MSSHEKI,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_IK_MSSHEKI,".
             15  FILLER            PIC  X(16)  VALUE
                 " UYTK_IK_PPHKZN,".
             15  FILLER            PIC  X(12)  VALUE
                 " SAKUJO_KBN,".
             15  FILLER            PIC  X(09)  VALUE
                 " SK_DATE,".
             15  FILLER            PIC  X(17)  VALUE
                 " SK_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(08)  VALUE
                 " SK_SID,".
             15  FILLER            PIC  X(10)  VALUE
                 " SK_PGMID,".
             15  FILLER            PIC  X(10)  VALUE
                 " UPD_DATE,".
             15  FILLER            PIC  X(18)  VALUE
                 " UPD_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " UPD_SID,".
             15  FILLER            PIC  X(12)  VALUE
                 " UPD_PGMID )".
      *----------  VALUES
           10  S-VALUES-TKMZBW11.
             15  FILLER            PIC  X(08)  VALUE
                 " VALUES ".
             15  FILLER            PIC  X(04)  VALUE
                 "  ( ".
             15  FILLER            PIC  X(13)  VALUE
                 ":P_SYORI_YMD,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_KIDOU_ID,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_RIYO_CMP_CD,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_FUND_CD,".
             15  FILLER            PIC  X(10)  VALUE
                 ":P_PTF_CD,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_SEC_SBT_CD,".
             15  FILLER            PIC  X(10)  VALUE
                 ":P_MEG_CD,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_TATE_FLG,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_GYOKU_ID,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_KJN_YMD,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_KSN_YMD_DMN_KBN,".
             15  FILLER            PIC  X(16)  VALUE
                 ":P_SIJO_TUKA_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 ":P_SRYZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_SJTK_BOKAZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_UYTK_BOKAZN,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_SJTK_BOKA_TNK,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_UYTK_BOKA_TNK,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_BOKA_KWS,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_SJTK_PPAYZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_UYTK_PPAYZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_SJTK_ARECZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_UYTK_ARECZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_SJTK_SPAYZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_UYTK_SPAYZN,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_SJTK_H_TNK,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_UYTK_H_TNK,".
             15  FILLER            PIC  X(21)  VALUE
                 ":P_SAME_COST_KZK_FLG,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_SJTK_KEKA_RSK,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_UYTK_KEKA_RSK,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_SJTK_MS_SHEKI,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_UYTK_MS_SHEKI,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_GENSEN_TAX,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_GENSEN_TAX,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_HYK_KWS,".
             15  FILLER            PIC  X(20)  VALUE
                 ":P_GENS_TAX_HYK_KWS,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_FACTOR_RENDOU_KESU,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_MSSE_KJMIG,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_MSSE_KJMIG,".
             15  FILLER            PIC  X(13)  VALUE
                 ":P_SRYZN_RIT,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_TGYOKU_TNK,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_TGYOKU_KWS_RATE,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_TGYOKU_BRK,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_TGYOKU_YKJ_YMD,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_SJTK_TG_YJKNZN,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_UYTK_TG_YJKNZN,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_SJTK_TG_TSRZN,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_UYTK_TG_TSRZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_TG_S_TAXZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_TG_S_TAXZN,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_SJTK_TG_ELS_HIYOZN,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_UYTK_TG_ELS_HIYOZN,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_SJTK_TG_SSKGZN,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_UYTK_TG_SSKGZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_OP_TATE_FLG,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_GSZKP_YTZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_GSZKP_YTZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_KSTK_GSZKP_YTZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_NOCV_MSKZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_NOCV_MSKZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_NOCV_MBKZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_NOCV_MBKZN,".
             15  FILLER            PIC  X(23)  VALUE
                 ":P_SHORT_STEN_KEKA_RSK,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SHORT_START_YMD,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_SHORT_END_YMD,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_KH_KAIKEI_BASE_FLG,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_TSTSK_CD,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_HAKO_CD,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_SURYO_TANI,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_SJTK_MBHYZN,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_UYTK_MBHYZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_MB_S_TAXZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_MB_S_TAXZN,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_SJTK_IK_HKSEZN,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_UYTK_IK_HKSEZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_IK_MSSHEKI,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_IK_MSSHEKI,".
             15  FILLER            PIC  X(18)  VALUE
                 ":P_UYTK_IK_PPHKZN,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(08)  VALUE
                 "SYSDATE,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SK_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(12)  VALUE
                 "'SMZJ2210',".
             15  FILLER            PIC  X(08)  VALUE
                 "SYSDATE,".
             15  FILLER            PIC  X(20)  VALUE
                 ":P_UPD_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(12)  VALUE
                 "'SMZJ2210' )".
      *----------  残高異動計算データ（TKMZBW06 別紙1-4)
         05  SQL-SELECT-1-4.
           10  S-SELECT-1-4.
             15  FILLER            PIC  X(07)  VALUE
               "SELECT ".
      *----------  処理実行日
             15  FILLER            PIC  X(12)  VALUE
                 " SYORI_YMD, ".
      *----------  起動ID
             15  FILLER            PIC  X(10)  VALUE
                 "KIDOU_ID, ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  原取引ID
             15  FILLER            PIC  X(09)  VALUE
                 "TORI_ID, ".
      *----------  計上基準日
             15  FILLER            PIC  X(16)  VALUE
                 "KEIJOU_KIJUNBI, ".
      *----------  赤黒区分
             15  FILLER            PIC  X(09)  VALUE
                 "AKA_KBN, ".
      *----------  誤計上№
             15  FILLER            PIC  X(12)  VALUE
                 "ERR_KJY_NO, ".
      *----------  誤計上区分
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(ERR_KJY_KBN,' '), ".
      *----------  取引連関ID
             15  FILLER            PIC  X(16)  VALUE
                 "NVL(THRK_ID,0), ".
      *----------  証券種別コード
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SEC_SBT_CD,' '), ".
      *----------  取引内容
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(TORI_NAIY,' '), ".
      *----------  取引事由
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(TORI_JIYU,' '), ".
      *----------  市場通貨コード
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(SIJO_TUKA_CD,' '), ".
      *----------  銘柄コード
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(MEG_CD,' '), ".
      *----------  資産負債・買建売建フラグ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(TATE_FLG,' '), ".
      *----------  玉ＩＤ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(GYOKU_ID,' '), ".
      *----------  約定日
             15  FILLER            PIC  X(16)  VALUE
                 "NVL(YKJ_YMD,0), ".
      *----------  受渡日
             15  FILLER            PIC  X(09)  VALUE
                 "UKE_YMD, ".
      *----------  市場通貨異動簿価
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_IDO_BOKA,0), ".
      *----------  運用通貨異動簿価
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_IDO_BOKA,0), ".
      *----------  市場通貨簿価単価
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_BOKA_TNK,0), ".
      *----------  運用通貨簿価単価
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_BOKA_TNK,0), ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(BOKA_KWS,0), ".
      *----------  市場通貨払出簿価
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_H_BOKA,0), ".
      *----------  運用通貨払出簿価
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_H_BOKA,0), ".
      *----------  市場通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SJTK_H_TNK,0), ".
      *----------  運用通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(UYTK_H_TNK,0), ".
      *----------  異動数量
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(IDO_SURYO,0), ".
      *----------  異動数量（利付）
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(IDO_SURYO_RIT,0), ".
      *----------  市場通貨異動後簿価残高
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(SJTK_IDOG_BOKAZN,0), ".
      *----------  運用通貨異動後簿価残高
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(UYTK_IDOG_BOKAZN,0), ".
      *----------  異動後数量残高
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(IDOG_SRYZN,0), ".
      *----------  異動後数量残高（利付）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(IDOG_SRYZN_RIT,0), ".
      *----------  市場通貨前払金異動額
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_PPAYIDOG,0), ".
      *----------  運用通貨前払金異動額
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_PPAYIDOG,0), ".
      *----------  市場通貨異動後前払金残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(SJTK_IDOG_PPAYZN,0), ".
      *----------  運用通貨異動後前払金残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(UYTK_IDOG_PPAYZN,0), ".
      *----------  市場通貨異動後前受金残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(SJTK_IDOG_ARECZN,0), ".
      *----------  運用通貨異動後前受金残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(UYTK_IDOG_ARECZN,0), ".
      *----------  市場通貨異動後仮払金残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(SJTK_IDOG_SPAYZN,0), ".
      *----------  運用通貨異動後仮払金残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(UYTK_IDOG_SPAYZN,0), ".
      *----------  市場通貨売買損益
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SJTK_BBSNEKI,0), ".
      *----------  運用通貨売買損益
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(UYTK_BBSNEKI,0), ".
      *----------  為替差損益
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_KWS_SNEKI,0), ".
      *----------  為替差損益（利金）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(UYTK_KWS_SNEKI_RK,0), ".
      *----------  為替差損益（市場）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(UYTK_KWS_SNEKI_SJ,0), ".
      *----------  市場通貨手数料
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SJTK_TSR,0), ".
      *----------  運用通貨手数料
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(UYTK_TSR,0), ".
      *----------  市場通貨消費税
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SJTK_S_TAX,0), ".
      *----------  運用通貨消費税
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(UYTK_S_TAX,0), ".
      *----------  市場通貨源泉税
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SJTK_GENSEN_TAX,0), ".
      *----------  運用通貨源泉税
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(UYTK_GENSEN_TAX,0), ".
      *----------  市場通貨その他損益
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(SJTK_ELS_SNEKI,0), ".
      *----------  運用通貨その他損益
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_ELS_SNEKI,0), ".
      *----------  市場通貨利金等損益勘定
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_RKSEKJ,0), ".
      *----------  運用通貨利金等損益勘定
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_RKSEKJ,0), ".
      *----------  異動計上順序
             15  FILLER            PIC  X(13)  VALUE
                 "IDO_KJY_JUN, ".
      *----------  建玉単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(TGYOKU_TNK,0), ".
      *----------  建玉為替レート
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(TGYOKU_KWS_RATE,0), ".
      *----------  建玉ブローカー
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(TGYOKU_BRK,' '), ".
      *----------  建玉約定日
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(TGYOKU_YKJ_YMD,0), ".
      *----------  市場通貨異動後建玉約定金額残
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_TG_YJKNZN,0), ".
      *----------  運用通貨異動後建玉約定金額残
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_TG_YJKNZN,0), ".
      *----------  市場通貨建玉手数料
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_TG_TSR,0), ".
      *----------  運用通貨建玉手数料
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_TG_TSR,0), ".
      *----------  市場通貨異動後建玉手数料残
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_IDOG_TG_TSRZN,0), ".
      *----------  運用通貨異動後建玉手数料残
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_IDOG_TG_TSRZN,0), ".
      *----------  市場通貨建玉消費税
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SJTK_TG_S_TAX,0), ".
      *----------  運用通貨建玉消費税
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(UYTK_TG_S_TAX,0), ".
      *----------  市場通貨異動後建玉消費税残
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(SJTK_IDOG_TG_S_TAXZN,0), ".
      *----------  運用通貨異動後建玉消費税残
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(UYTK_IDOG_TG_S_TAXZN,0), ".
      *----------  市場通貨建玉その他費用
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(SJTK_TG_ELS_HIYO,0), ".
      *----------  運用通貨建玉その他費用
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(UYTK_TG_ELS_HIYO,0), ".
      *----------  市場通貨異動後建玉その他費用残
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(SJTK_IDOG_TG_ELS_HZN,0), ".
      *----------  運用通貨異動後建玉その他費用残
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(UYTK_IDOG_TG_ELS_HZN,0), ".
      *----------  市場通貨建玉精算金額
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SJTK_TG_SSKG,0), ".
      *----------  運用通貨建玉精算金額
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(UYTK_TG_SSKG,0), ".
      *----------  市場通貨異動後建玉精算金額残
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_TG_SSKGZN,0), ".
      *----------  運用通貨異動後建玉精算金額残
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_TG_SSKGZN,0), ".
      *----------  市場通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(SJTK_HT_PPAR_PMM,0), ".
      *----------  運用通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(UYTK_HT_PPAR_PMM,0), ".
      *----------  ＯＰ資産負債・買建売建フラグ
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(OP_TATE_FLG,' '), ".
      *----------  市場通貨源泉税還付予定異動額
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SJTK_GSZKP_YTIDOG,0), ".
      *----------  運用通貨源泉税還付予定異動額
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(UYTK_GSZKP_YTIDOG,0), ".
      *----------  決済通貨源泉税還付予定異動額
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(KSTK_GSZKP_YTIDOG,0), ".
      *----------  市場通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(SJTK_IDOG_GSZKP_YTZN,0), ".
      *----------  運用通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(UYTK_IDOG_GSZKP_YTZN,0), ".
      *----------  決済通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(KSTK_IDOG_GSZKP_YTZN,0), ".
      *----------  市場通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(SJTK_IDOG_NOCV_MSKZN,0), ".
      *----------  運用通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(UYTK_IDOG_NOCV_MSKZN,0), ".
      *----------  市場通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(SJTK_IDOG_NOCV_MBKZN,0), ".
      *----------  運用通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(UYTK_IDOG_NOCV_MBKZN,0), ".
      *----------  市場通貨異動後未払費用残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(SJTK_IDOG_MBHYZN,0), ".
      *----------  運用通貨異動後未払費用残
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(UYTK_IDOG_MBHYZN,0), ".
      *----------  市場通貨異動後未払消費税残
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(SJTK_IDOG_MB_S_TAXZN,0), ".
      *----------  運用通貨異動後未払消費税残
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(UYTK_IDOG_MB_S_TAXZN,0), ".
      *----------  市場通貨異動後移管評価損益残
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_IK_HKSEZN,0), ".
      *----------  運用通貨異動後移管評価損益残
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_IK_HKSEZN,0), ".
      *----------  市場通貨異動後移管未収収益
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(SJTK_IDOG_IK_MSSHEKI,0), ".
      *----------  運用通貨異動後移管未収収益
             15  FILLER            PIC  X(29)  VALUE
                 "NVL(UYTK_IDOG_IK_MSSHEKI,0), ".
      *----------  運用通貨異動後移管前払金評価損益残
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_IK_PPHKZN,0), ".
      *----------  削除区分
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SAKUJO_KBN,' '), ".
      *----------  短期スタート・エンド経過利息
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SHORT_STEN_KEKA_RSK,0), ".
      *----------  短期スタート日
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(SHORT_START_YMD,0), ".
      *----------  短期エンド日
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SHORT_END_YMD,0), ".
      *----------  投資対象国コード
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(TSTSK_CD,' '), ".
      *----------  発行国コード
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(HAKO_CD,' '), ".
      *----------  数量単位
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SURYO_TANI,0), ".
      *----------  初期設定金額
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SHOKI_SET_KGK,0), ".
      *----------  作成フラグ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_FLG,' '), ".
      *----------  作成日時
             15  FILLER            PIC  X(46)  VALUE
                 "NVL(TO_CHAR(SK_DATE,'YYYYMMDDHH24MISS'),' '), ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SK_LOGIN_CMP_CD,' '), ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_SID,' '), ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SK_PGMID,' '), ".
      *----------  更新フラグ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_FLG, ".
      *----------  更新日時
             15  FILLER            PIC  X(38)  VALUE
                 "TO_CHAR(UPD_DATE,'YYYYMMDDHH24MISS'), ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(11)  VALUE
                 "UPD_PGMID, ".
      *----------  TBL区分
             15  FILLER            PIC  X(07)  VALUE
                 "TBL_KBN".
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  FILLER            PIC  X(08)  VALUE
                 "(SELECT ".
      *----------  処理実行日
             15  FILLER            PIC  X(12)  VALUE
                 " SYORI_YMD, ".
      *----------  起動ID
             15  FILLER            PIC  X(10)  VALUE
                 "KIDOU_ID, ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  原取引ID
             15  FILLER            PIC  X(09)  VALUE
                 "TORI_ID, ".
      *----------  計上基準日
             15  FILLER            PIC  X(16)  VALUE
                 "KEIJOU_KIJUNBI, ".
      *----------  赤黒区分
             15  FILLER            PIC  X(09)  VALUE
                 "AKA_KBN, ".
      *----------  誤計上№
             15  FILLER            PIC  X(12)  VALUE
                 "ERR_KJY_NO, ".
      *----------  誤計上区分
             15  FILLER            PIC  X(13)  VALUE
                 "ERR_KJY_KBN, ".
      *----------  取引連関ID
             15  FILLER            PIC  X(09)  VALUE
                 "THRK_ID, ".
      *----------  証券種別コード
             15  FILLER            PIC  X(12)  VALUE
                 "SEC_SBT_CD, ".
      *----------  取引内容
             15  FILLER            PIC  X(11)  VALUE
                 "TORI_NAIY, ".
      *----------  取引事由
             15  FILLER            PIC  X(11)  VALUE
                 "TORI_JIYU, ".
      *----------  市場通貨コード
             15  FILLER            PIC  X(14)  VALUE
                 "SIJO_TUKA_CD, ".
      *----------  銘柄コード
             15  FILLER            PIC  X(08)  VALUE
                 "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
             15  FILLER            PIC  X(10)  VALUE
                 "TATE_FLG, ".
      *----------  玉ＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "GYOKU_ID, ".
      *----------  約定日
             15  FILLER            PIC  X(09)  VALUE
                 "YKJ_YMD, ".
      *----------  受渡日
             15  FILLER            PIC  X(09)  VALUE
                 "UKE_YMD, ".
      *----------  市場通貨異動簿価
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_IDO_BOKA, ".
      *----------  運用通貨異動簿価
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_IDO_BOKA, ".
      *----------  市場通貨簿価単価
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_BOKA_TNK, ".
      *----------  運用通貨簿価単価
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_BOKA_TNK, ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(10)  VALUE
                 "BOKA_KWS, ".
      *----------  市場通貨払出簿価
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_H_BOKA, ".
      *----------  運用通貨払出簿価
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_H_BOKA, ".
      *----------  市場通貨払出単価
             15  FILLER            PIC  X(12)  VALUE
                 "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
             15  FILLER            PIC  X(12)  VALUE
                 "UYTK_H_TNK, ".
      *----------  異動数量
             15  FILLER            PIC  X(11)  VALUE
                 "IDO_SURYO, ".
      *----------  異動数量（利付）
             15  FILLER            PIC  X(15)  VALUE
                 "IDO_SURYO_RIT, ".
      *----------  市場通貨異動後簿価残高
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_BOKAZN, ".
      *----------  運用通貨異動後簿価残高
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_BOKAZN, ".
      *----------  異動後数量残高
             15  FILLER            PIC  X(12)  VALUE
                 "IDOG_SRYZN, ".
      *----------  異動後数量残高（利付）
             15  FILLER            PIC  X(16)  VALUE
                 "IDOG_SRYZN_RIT, ".
      *----------  市場通貨前払金異動額
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_PPAYIDOG, ".
      *----------  運用通貨前払金異動額
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_PPAYIDOG, ".
      *----------  市場通貨異動後前払金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_PPAYZN, ".
      *----------  運用通貨異動後前払金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_PPAYZN, ".
      *----------  市場通貨異動後前受金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_ARECZN, ".
      *----------  運用通貨異動後前受金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_ARECZN, ".
      *----------  市場通貨異動後仮払金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_SPAYZN, ".
      *----------  運用通貨異動後仮払金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_SPAYZN, ".
      *----------  市場通貨売買損益
             15  FILLER            PIC  X(14)  VALUE
                 "SJTK_BBSNEKI, ".
      *----------  運用通貨売買損益
             15  FILLER            PIC  X(14)  VALUE
                 "UYTK_BBSNEKI, ".
      *----------  為替差損益
             15  FILLER            PIC  X(16)  VALUE
                 "UYTK_KWS_SNEKI, ".
      *----------  為替差損益（利金）
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_KWS_SNEKI_RK, ".
      *----------  為替差損益（市場）
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_KWS_SNEKI_SJ, ".
      *----------  市場通貨手数料
             15  FILLER            PIC  X(10)  VALUE
                 "SJTK_TSR, ".
      *----------  運用通貨手数料
             15  FILLER            PIC  X(10)  VALUE
                 "UYTK_TSR, ".
      *----------  市場通貨消費税
             15  FILLER            PIC  X(12)  VALUE
                 "SJTK_S_TAX, ".
      *----------  運用通貨消費税
             15  FILLER            PIC  X(12)  VALUE
                 "UYTK_S_TAX, ".
      *----------  市場通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "SJTK_GENSEN_TAX, ".
      *----------  運用通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "UYTK_GENSEN_TAX, ".
      *----------  市場通貨その他損益
             15  FILLER            PIC  X(16)  VALUE
                 "SJTK_ELS_SNEKI, ".
      *----------  運用通貨その他損益
             15  FILLER            PIC  X(16)  VALUE
                 "UYTK_ELS_SNEKI, ".
      *----------  市場通貨利金等損益勘定
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_RKSEKJ, ".
      *----------  運用通貨利金等損益勘定
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_RKSEKJ, ".
      *----------  異動計上順序
             15  FILLER            PIC  X(13)  VALUE
                 "IDO_KJY_JUN, ".
      *----------  建玉単価
             15  FILLER            PIC  X(12)  VALUE
                 "TGYOKU_TNK, ".
      *----------  建玉為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "TGYOKU_KWS_RATE, ".
      *----------  建玉ブローカー
             15  FILLER            PIC  X(12)  VALUE
                 "TGYOKU_BRK, ".
      *----------  建玉約定日
             15  FILLER            PIC  X(16)  VALUE
                 "TGYOKU_YKJ_YMD, ".
      *----------  市場通貨異動後建玉約定金額残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_TG_YJKNZN, ".
      *----------  運用通貨異動後建玉約定金額残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_TG_YJKNZN, ".
      *----------  市場通貨建玉手数料
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_TG_TSR, ".
      *----------  運用通貨建玉手数料
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_TG_TSR, ".
      *----------  市場通貨異動後建玉手数料残
             15  FILLER            PIC  X(20)  VALUE
                 "SJTK_IDOG_TG_TSRZN, ".
      *----------  運用通貨異動後建玉手数料残
             15  FILLER            PIC  X(20)  VALUE
                 "UYTK_IDOG_TG_TSRZN, ".
      *----------  市場通貨建玉消費税
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_TG_S_TAX, ".
      *----------  運用通貨建玉消費税
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_TG_S_TAX, ".
      *----------  市場通貨異動後建玉消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_TG_S_TAXZN, ".
      *----------  運用通貨異動後建玉消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_TG_S_TAXZN, ".
      *----------  市場通貨建玉その他費用
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_TG_ELS_HIYO, ".
      *----------  運用通貨建玉その他費用
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_TG_ELS_HIYO, ".
      *----------  市場通貨異動後建玉その他費用残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_TG_ELS_HZN, ".
      *----------  運用通貨異動後建玉その他費用残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_TG_ELS_HZN, ".
      *----------  市場通貨建玉精算金額
             15  FILLER            PIC  X(14)  VALUE
                 "SJTK_TG_SSKG, ".
      *----------  運用通貨建玉精算金額
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_TG_SSKG, ".
      *----------  市場通貨異動後建玉精算金額残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_TG_SSKGZN, ".
      *----------  運用通貨異動後建玉精算金額残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_TG_SSKGZN, ".
      *----------  市場通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_HT_PPAR_PMM, ".
      *----------  運用通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_HT_PPAR_PMM, ".
      *----------  ＯＰ資産負債・買建売建フラグ
             15  FILLER            PIC  X(13)  VALUE
                 "OP_TATE_FLG, ".
      *----------  市場通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "SJTK_GSZKP_YTIDOG, ".
      *----------  運用通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_GSZKP_YTIDOG, ".
      *----------  決済通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "KSTK_GSZKP_YTIDOG, ".
      *----------  市場通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_GSZKP_YTZN, ".
      *----------  運用通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_GSZKP_YTZN, ".
      *----------  決済通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "KSTK_IDOG_GSZKP_YTZN, ".
      *----------  市場通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_NOCV_MSKZN, ".
      *----------  運用通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_NOCV_MSKZN, ".
      *----------  市場通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_NOCV_MBKZN, ".
      *----------  運用通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_NOCV_MBKZN, ".
      *----------  市場通貨異動後未払費用残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_MBHYZN, ".
      *----------  運用通貨異動後未払費用残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_MBHYZN, ".
      *----------  市場通貨異動後未払消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_MB_S_TAXZN, ".
      *----------  運用通貨異動後未払消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_MB_S_TAXZN, ".
      *----------  市場通貨異動後移管評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_IK_HKSEZN, ".
      *----------  運用通貨異動後移管評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_IK_HKSEZN, ".
      *----------  市場通貨異動後移管未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_IK_MSSHEKI, ".
      *----------  運用通貨異動後移管未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_IK_MSSHEKI, ".
      *----------  運用通貨異動後移管前払金評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_IK_PPHKZN, ".
      *----------  削除区分
             15  FILLER            PIC  X(12)  VALUE
                 "SAKUJO_KBN, ".
      *----------  短期スタート・エンド経過利息
             15  FILLER            PIC  X(21)  VALUE
                 "SHORT_STEN_KEKA_RSK, ".
      *----------  短期スタート日
             15  FILLER            PIC  X(17)  VALUE
                 "SHORT_START_YMD, ".
      *----------  短期エンド日
             15  FILLER            PIC  X(15)  VALUE
                 "SHORT_END_YMD, ".
      *----------  投資対象国コード
             15  FILLER            PIC  X(10)  VALUE
                 "TSTSK_CD, ".
      *----------  発行国コード
             15  FILLER            PIC  X(09)  VALUE
                 "HAKO_CD, ".
      *----------  数量単位
             15  FILLER            PIC  X(12)  VALUE
                 "SURYO_TANI, ".
      *----------  初期設定金額
             15  FILLER            PIC  X(15)  VALUE
                 "SHOKI_SET_KGK, ".
      *----------  作成フラグ
             15  FILLER            PIC  X(08)  VALUE
                 "SK_FLG, ".
      *----------  作成日時
             15  FILLER            PIC  X(09)  VALUE
                 "SK_DATE, ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(17)  VALUE
                 "SK_LOGIN_CMP_CD, ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(08)  VALUE
                 "SK_SID, ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "SK_PGMID, ".
      *----------  更新フラグ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_FLG, ".
      *----------  更新日時
             15  FILLER            PIC  X(10)  VALUE
                 "UPD_DATE, ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(11)  VALUE
                 "UPD_PGMID, ".
      *----------  TBL区分
             15  FILLER            PIC  X(12)  VALUE
                 "1 AS TBL_KBN".
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL-TKMZBW06  PIC  X(13).
      *----------  WHERE
           10  S-WHERE-1-4.
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産/負債・買建/売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *----------  計上基準日
             15  FILLER            PIC  X(38)  VALUE
                 " AND KEIJOU_KIJUNBI > :P_KAISI_KJN_YMD".
             15  FILLER            PIC  X(33)  VALUE
                 " AND KEIJOU_KIJUNBI <= :P_KJN_YMD".
      *---------- 処理実行日
             15  FILLER            PIC  X(29)  VALUE
                 " AND SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(29)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- UNION
             15  FILLER            PIC  X(07)  VALUE
                 " UNION ".
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
      *----------  処理実行日
             15  FILLER            PIC  X(16)  VALUE
                 "0 AS SYORI_YMD, ".
      *----------  起動ID
             15  FILLER            PIC  X(17)  VALUE
                 "' ' AS KIDOU_ID, ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  原取引ID
             15  FILLER            PIC  X(09)  VALUE
                 "TORI_ID, ".
      *----------  計上基準日
             15  FILLER            PIC  X(22)  VALUE
                 "T_AAA.KEIJOU_KIJUNBI, ".
      *----------  赤黒区分
             15  FILLER            PIC  X(09)  VALUE
                 "AKA_KBN, ".
      *----------  誤計上№
             15  FILLER            PIC  X(12)  VALUE
                 "ERR_KJY_NO, ".
      *----------  誤計上区分
             15  FILLER            PIC  X(13)  VALUE
                 "ERR_KJY_KBN, ".
      *----------  取引連関ID
             15  FILLER            PIC  X(09)  VALUE
                 "THRK_ID, ".
      *----------  証券種別コード
             15  FILLER            PIC  X(12)  VALUE
                 "SEC_SBT_CD, ".
      *----------  取引内容
             15  FILLER            PIC  X(11)  VALUE
                 "TORI_NAIY, ".
      *----------  取引事由
             15  FILLER            PIC  X(11)  VALUE
                 "TORI_JIYU, ".
      *----------  市場通貨コード
             15  FILLER            PIC  X(14)  VALUE
                 "SIJO_TUKA_CD, ".
      *----------  銘柄コード
             15  FILLER            PIC  X(08)  VALUE
                 "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
             15  FILLER            PIC  X(10)  VALUE
                 "TATE_FLG, ".
      *----------  玉ＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "GYOKU_ID, ".
      *----------  約定日
             15  FILLER            PIC  X(09)  VALUE
                 "YKJ_YMD, ".
      *----------  受渡日
             15  FILLER            PIC  X(09)  VALUE
                 "UKE_YMD, ".
      *----------  市場通貨異動簿価
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_IDO_BOKA, ".
      *----------  運用通貨異動簿価
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_IDO_BOKA, ".
      *----------  市場通貨簿価単価
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_BOKA_TNK, ".
      *----------  運用通貨簿価単価
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_BOKA_TNK, ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(10)  VALUE
                 "BOKA_KWS, ".
      *----------  市場通貨払出簿価
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_H_BOKA, ".
      *----------  運用通貨払出簿価
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_H_BOKA, ".
      *----------  市場通貨払出単価
             15  FILLER            PIC  X(12)  VALUE
                 "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
             15  FILLER            PIC  X(12)  VALUE
                 "UYTK_H_TNK, ".
      *----------  異動数量
             15  FILLER            PIC  X(11)  VALUE
                 "IDO_SURYO, ".
      *----------  異動数量（利付）
             15  FILLER            PIC  X(15)  VALUE
                 "IDO_SURYO_RIT, ".
      *----------  市場通貨異動後簿価残高
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_BOKAZN, ".
      *----------  運用通貨異動後簿価残高
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_BOKAZN, ".
      *----------  異動後数量残高
             15  FILLER            PIC  X(12)  VALUE
                 "IDOG_SRYZN, ".
      *----------  異動後数量残高（利付）
             15  FILLER            PIC  X(16)  VALUE
                 "IDOG_SRYZN_RIT, ".
      *----------  市場通貨前払金異動額
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_PPAYIDOG, ".
      *----------  運用通貨前払金異動額
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_PPAYIDOG, ".
      *----------  市場通貨異動後前払金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_PPAYZN, ".
      *----------  運用通貨異動後前払金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_PPAYZN, ".
      *----------  市場通貨異動後前受金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_ARECZN, ".
      *----------  運用通貨異動後前受金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_ARECZN, ".
      *----------  市場通貨異動後仮払金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_SPAYZN, ".
      *----------  運用通貨異動後仮払金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_SPAYZN, ".
      *----------  市場通貨売買損益
             15  FILLER            PIC  X(14)  VALUE
                 "SJTK_BBSNEKI, ".
      *----------  運用通貨売買損益
             15  FILLER            PIC  X(14)  VALUE
                 "UYTK_BBSNEKI, ".
      *----------  為替差損益
             15  FILLER            PIC  X(16)  VALUE
                 "UYTK_KWS_SNEKI, ".
      *----------  為替差損益（利金）
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_KWS_SNEKI_RK, ".
      *----------  為替差損益（市場）
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_KWS_SNEKI_SJ, ".
      *----------  市場通貨手数料
             15  FILLER            PIC  X(10)  VALUE
                 "SJTK_TSR, ".
      *----------  運用通貨手数料
             15  FILLER            PIC  X(10)  VALUE
                 "UYTK_TSR, ".
      *----------  市場通貨消費税
             15  FILLER            PIC  X(12)  VALUE
                 "SJTK_S_TAX, ".
      *----------  運用通貨消費税
             15  FILLER            PIC  X(12)  VALUE
                 "UYTK_S_TAX, ".
      *----------  市場通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "SJTK_GENSEN_TAX, ".
      *----------  運用通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "UYTK_GENSEN_TAX, ".
      *----------  市場通貨その他損益
             15  FILLER            PIC  X(16)  VALUE
                 "SJTK_ELS_SNEKI, ".
      *----------  運用通貨その他損益
             15  FILLER            PIC  X(16)  VALUE
                 "UYTK_ELS_SNEKI, ".
      *----------  市場通貨利金等損益勘定
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_RKSEKJ, ".
      *----------  運用通貨利金等損益勘定
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_RKSEKJ, ".
      *----------  異動計上順序
             15  FILLER            PIC  X(13)  VALUE
                 "IDO_KJY_JUN, ".
      *----------  建玉単価
             15  FILLER            PIC  X(12)  VALUE
                 "TGYOKU_TNK, ".
      *----------  建玉為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "TGYOKU_KWS_RATE, ".
      *----------  建玉ブローカー
             15  FILLER            PIC  X(12)  VALUE
                 "TGYOKU_BRK, ".
      *----------  建玉約定日
             15  FILLER            PIC  X(16)  VALUE
                 "TGYOKU_YKJ_YMD, ".
      *----------  市場通貨異動後建玉約定金額残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_TG_YJKNZN, ".
      *----------  運用通貨異動後建玉約定金額残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_TG_YJKNZN, ".
      *----------  市場通貨建玉手数料
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_TG_TSR, ".
      *----------  運用通貨建玉手数料
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_TG_TSR, ".
      *----------  市場通貨異動後建玉手数料残
             15  FILLER            PIC  X(20)  VALUE
                 "SJTK_IDOG_TG_TSRZN, ".
      *----------  運用通貨異動後建玉手数料残
             15  FILLER            PIC  X(20)  VALUE
                 "UYTK_IDOG_TG_TSRZN, ".
      *----------  市場通貨建玉消費税
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_TG_S_TAX, ".
      *----------  運用通貨建玉消費税
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_TG_S_TAX, ".
      *----------  市場通貨異動後建玉消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_TG_S_TAXZN, ".
      *----------  運用通貨異動後建玉消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_TG_S_TAXZN, ".
      *----------  市場通貨建玉その他費用
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_TG_ELS_HIYO, ".
      *----------  運用通貨建玉その他費用
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_TG_ELS_HIYO, ".
      *----------  市場通貨異動後建玉その他費用残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_TG_ELS_HZN, ".
      *----------  運用通貨異動後建玉その他費用残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_TG_ELS_HZN, ".
      *----------  市場通貨建玉精算金額
             15  FILLER            PIC  X(14)  VALUE
                 "SJTK_TG_SSKG, ".
      *----------  運用通貨建玉精算金額
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_TG_SSKG, ".
      *----------  市場通貨異動後建玉精算金額残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_TG_SSKGZN, ".
      *----------  運用通貨異動後建玉精算金額残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_TG_SSKGZN, ".
      *----------  市場通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_HT_PPAR_PMM, ".
      *----------  運用通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_HT_PPAR_PMM, ".
      *----------  ＯＰ資産負債・買建売建フラグ
             15  FILLER            PIC  X(13)  VALUE
                 "OP_TATE_FLG, ".
      *----------  市場通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "SJTK_GSZKP_YTIDOG, ".
      *----------  運用通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_GSZKP_YTIDOG, ".
      *----------  決済通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "KSTK_GSZKP_YTIDOG, ".
      *----------  市場通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_GSZKP_YTZN, ".
      *----------  運用通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_GSZKP_YTZN, ".
      *----------  決済通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "KSTK_IDOG_GSZKP_YTZN, ".
      *----------  市場通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_NOCV_MSKZN, ".
      *----------  運用通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_NOCV_MSKZN, ".
      *----------  市場通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_NOCV_MBKZN, ".
      *----------  運用通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_NOCV_MBKZN, ".
      *----------  市場通貨異動後未払費用残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_MBHYZN, ".
      *----------  運用通貨異動後未払費用残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_MBHYZN, ".
      *----------  市場通貨異動後未払消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_MB_S_TAXZN, ".
      *----------  運用通貨異動後未払消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_MB_S_TAXZN, ".
      *----------  市場通貨異動後移管評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_IK_HKSEZN, ".
      *----------  運用通貨異動後移管評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_IK_HKSEZN, ".
      *----------  市場通貨異動後移管未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_IK_MSSHEKI, ".
      *----------  運用通貨異動後移管未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_IK_MSSHEKI, ".
      *----------  運用通貨異動後移管前払金評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_IK_PPHKZN, ".
      *----------  削除区分
             15  FILLER            PIC  X(12)  VALUE
                 "SAKUJO_KBN, ".
      *----------  短期スタート・エンド経過利息
             15  FILLER            PIC  X(21)  VALUE
                 "SHORT_STEN_KEKA_RSK, ".
      *----------  短期スタート日
             15  FILLER            PIC  X(17)  VALUE
                 "SHORT_START_YMD, ".
      *----------  短期エンド日
             15  FILLER            PIC  X(15)  VALUE
                 "SHORT_END_YMD, ".
      *----------  投資対象国コード
             15  FILLER            PIC  X(10)  VALUE
                 "TSTSK_CD, ".
      *----------  発行国コード
             15  FILLER            PIC  X(09)  VALUE
                 "HAKO_CD, ".
      *----------  数量単位
             15  FILLER            PIC  X(12)  VALUE
                 "SURYO_TANI, ".
      *----------  初期設定金額
             15  FILLER            PIC  X(20)  VALUE
                 "0 AS SHOKI_SET_KGK, ".
      *----------  作成フラグ
             15  FILLER            PIC  X(08)  VALUE
                 "SK_FLG, ".
      *----------  作成日時
             15  FILLER            PIC  X(09)  VALUE
                 "SK_DATE, ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(17)  VALUE
                 "SK_LOGIN_CMP_CD, ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(08)  VALUE
                 "SK_SID, ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "SK_PGMID, ".
      *----------  更新フラグ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_FLG, ".
      *----------  更新日時
             15  FILLER            PIC  X(10)  VALUE
                 "UPD_DATE, ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(11)  VALUE
                 "UPD_PGMID, ".
      *----------  TBL区分
             15  FILLER            PIC  X(12)  VALUE
                 "2 AS TBL_KBN".
      *----------  FROM
             15  FILLER            PIC  X(15)  VALUE
                 " FROM ((SELECT ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  原取引ID
             15  FILLER            PIC  X(09)  VALUE
                 "TORI_ID, ".
      *----------  計上基準日
             15  FILLER            PIC  X(16)  VALUE
                 "KEIJOU_KIJUNBI, ".
      *----------  赤黒区分
             15  FILLER            PIC  X(09)  VALUE
                 "AKA_KBN, ".
      *----------  誤計上№
             15  FILLER            PIC  X(12)  VALUE
                 "ERR_KJY_NO, ".
      *----------  誤計上区分
             15  FILLER            PIC  X(13)  VALUE
                 "ERR_KJY_KBN, ".
      *----------  取引連関ID
             15  FILLER            PIC  X(09)  VALUE
                 "THRK_ID, ".
      *----------  証券種別コード
             15  FILLER            PIC  X(12)  VALUE
                 "SEC_SBT_CD, ".
      *----------  取引内容
             15  FILLER            PIC  X(11)  VALUE
                 "TORI_NAIY, ".
      *----------  取引事由
             15  FILLER            PIC  X(11)  VALUE
                 "TORI_JIYU, ".
      *----------  市場通貨コード
             15  FILLER            PIC  X(14)  VALUE
                 "SIJO_TUKA_CD, ".
      *----------  銘柄コード
             15  FILLER            PIC  X(08)  VALUE
                 "MEG_CD, ".
      *----------  資産負債・買建売建フラグ
             15  FILLER            PIC  X(10)  VALUE
                 "TATE_FLG, ".
      *----------  玉ＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "GYOKU_ID, ".
      *----------  約定日
             15  FILLER            PIC  X(09)  VALUE
                 "YKJ_YMD, ".
      *----------  受渡日
             15  FILLER            PIC  X(09)  VALUE
                 "UKE_YMD, ".
      *----------  市場通貨異動簿価
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_IDO_BOKA, ".
      *----------  運用通貨異動簿価
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_IDO_BOKA, ".
      *----------  市場通貨簿価単価
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_BOKA_TNK, ".
      *----------  運用通貨簿価単価
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_BOKA_TNK, ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(10)  VALUE
                 "BOKA_KWS, ".
      *----------  市場通貨払出簿価
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_H_BOKA, ".
      *----------  運用通貨払出簿価
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_H_BOKA, ".
      *----------  市場通貨払出単価
             15  FILLER            PIC  X(12)  VALUE
                 "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
             15  FILLER            PIC  X(12)  VALUE
                 "UYTK_H_TNK, ".
      *----------  異動数量
             15  FILLER            PIC  X(11)  VALUE
                 "IDO_SURYO, ".
      *----------  異動数量（利付）
             15  FILLER            PIC  X(15)  VALUE
                 "IDO_SURYO_RIT, ".
      *----------  市場通貨異動後簿価残高
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_BOKAZN, ".
      *----------  運用通貨異動後簿価残高
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_BOKAZN, ".
      *----------  異動後数量残高
             15  FILLER            PIC  X(12)  VALUE
                 "IDOG_SRYZN, ".
      *----------  異動後数量残高（利付）
             15  FILLER            PIC  X(16)  VALUE
                 "IDOG_SRYZN_RIT, ".
      *----------  市場通貨前払金異動額
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_PPAYIDOG, ".
      *----------  運用通貨前払金異動額
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_PPAYIDOG, ".
      *----------  市場通貨異動後前払金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_PPAYZN, ".
      *----------  運用通貨異動後前払金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_PPAYZN, ".
      *----------  市場通貨異動後前受金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_ARECZN, ".
      *----------  運用通貨異動後前受金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_ARECZN, ".
      *----------  市場通貨異動後仮払金残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_SPAYZN, ".
      *----------  運用通貨異動後仮払金残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_SPAYZN, ".
      *----------  市場通貨売買損益
             15  FILLER            PIC  X(14)  VALUE
                 "SJTK_BBSNEKI, ".
      *----------  運用通貨売買損益
             15  FILLER            PIC  X(14)  VALUE
                 "UYTK_BBSNEKI, ".
      *----------  為替差損益
             15  FILLER            PIC  X(16)  VALUE
                 "UYTK_KWS_SNEKI, ".
      *----------  為替差損益（利金）
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_KWS_SNEKI_RK, ".
      *----------  為替差損益（市場）
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_KWS_SNEKI_SJ, ".
      *----------  市場通貨手数料
             15  FILLER            PIC  X(10)  VALUE
                 "SJTK_TSR, ".
      *----------  運用通貨手数料
             15  FILLER            PIC  X(10)  VALUE
                 "UYTK_TSR, ".
      *----------  市場通貨消費税
             15  FILLER            PIC  X(12)  VALUE
                 "SJTK_S_TAX, ".
      *----------  運用通貨消費税
             15  FILLER            PIC  X(12)  VALUE
                 "UYTK_S_TAX, ".
      *----------  市場通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "SJTK_GENSEN_TAX, ".
      *----------  運用通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "UYTK_GENSEN_TAX, ".
      *----------  市場通貨その他損益
             15  FILLER            PIC  X(16)  VALUE
                 "SJTK_ELS_SNEKI, ".
      *----------  運用通貨その他損益
             15  FILLER            PIC  X(16)  VALUE
                 "UYTK_ELS_SNEKI, ".
      *----------  市場通貨利金等損益勘定
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_RKSEKJ, ".
      *----------  運用通貨利金等損益勘定
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_RKSEKJ, ".
      *----------  異動計上順序
             15  FILLER            PIC  X(13)  VALUE
                 "IDO_KJY_JUN, ".
      *----------  建玉単価
             15  FILLER            PIC  X(12)  VALUE
                 "TGYOKU_TNK, ".
      *----------  建玉為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "TGYOKU_KWS_RATE, ".
      *----------  建玉ブローカー
             15  FILLER            PIC  X(12)  VALUE
                 "TGYOKU_BRK, ".
      *----------  建玉約定日
             15  FILLER            PIC  X(16)  VALUE
                 "TGYOKU_YKJ_YMD, ".
      *----------  市場通貨異動後建玉約定金額残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_TG_YJKNZN, ".
      *----------  運用通貨異動後建玉約定金額残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_TG_YJKNZN, ".
      *----------  市場通貨建玉手数料
             15  FILLER            PIC  X(13)  VALUE
                 "SJTK_TG_TSR, ".
      *----------  運用通貨建玉手数料
             15  FILLER            PIC  X(13)  VALUE
                 "UYTK_TG_TSR, ".
      *----------  市場通貨異動後建玉手数料残
             15  FILLER            PIC  X(20)  VALUE
                 "SJTK_IDOG_TG_TSRZN, ".
      *----------  運用通貨異動後建玉手数料残
             15  FILLER            PIC  X(20)  VALUE
                 "UYTK_IDOG_TG_TSRZN, ".
      *----------  市場通貨建玉消費税
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_TG_S_TAX, ".
      *----------  運用通貨建玉消費税
             15  FILLER            PIC  X(15)  VALUE
                 "UYTK_TG_S_TAX, ".
      *----------  市場通貨異動後建玉消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_TG_S_TAXZN, ".
      *----------  運用通貨異動後建玉消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_TG_S_TAXZN, ".
      *----------  市場通貨建玉その他費用
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_TG_ELS_HIYO, ".
      *----------  運用通貨建玉その他費用
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_TG_ELS_HIYO, ".
      *----------  市場通貨異動後建玉その他費用残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_TG_ELS_HZN, ".
      *----------  運用通貨異動後建玉その他費用残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_TG_ELS_HZN, ".
      *----------  市場通貨建玉精算金額
             15  FILLER            PIC  X(14)  VALUE
                 "SJTK_TG_SSKG, ".
      *----------  運用通貨建玉精算金額
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_TG_SSKG, ".
      *----------  市場通貨異動後建玉精算金額残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_TG_SSKGZN, ".
      *----------  運用通貨異動後建玉精算金額残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_TG_SSKGZN, ".
      *----------  市場通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_HT_PPAR_PMM, ".
      *----------  運用通貨引継前受・前払プレミアム
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_HT_PPAR_PMM, ".
      *----------  ＯＰ資産負債・買建売建フラグ
             15  FILLER            PIC  X(13)  VALUE
                 "OP_TATE_FLG, ".
      *----------  市場通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "SJTK_GSZKP_YTIDOG, ".
      *----------  運用通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "UYTK_GSZKP_YTIDOG, ".
      *----------  決済通貨源泉税還付予定異動額
             15  FILLER            PIC  X(19)  VALUE
                 "KSTK_GSZKP_YTIDOG, ".
      *----------  市場通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_GSZKP_YTZN, ".
      *----------  運用通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_GSZKP_YTZN, ".
      *----------  決済通貨異動後源泉税還付予定額残高
             15  FILLER            PIC  X(22)  VALUE
                 "KSTK_IDOG_GSZKP_YTZN, ".
      *----------  市場通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_NOCV_MSKZN, ".
      *----------  運用通貨異動後ノンカバー未収金残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_NOCV_MSKZN, ".
      *----------  市場通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_NOCV_MBKZN, ".
      *----------  運用通貨異動後ノンカバー未払金残高
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_NOCV_MBKZN, ".
      *----------  市場通貨異動後未払費用残
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_IDOG_MBHYZN, ".
      *----------  運用通貨異動後未払費用残
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_IDOG_MBHYZN, ".
      *----------  市場通貨異動後未払消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_MB_S_TAXZN, ".
      *----------  運用通貨異動後未払消費税残
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_MB_S_TAXZN, ".
      *----------  市場通貨異動後移管評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "SJTK_IDOG_IK_HKSEZN, ".
      *----------  運用通貨異動後移管評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_IK_HKSEZN, ".
      *----------  市場通貨異動後移管未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "SJTK_IDOG_IK_MSSHEKI, ".
      *----------  運用通貨異動後移管未収収益
             15  FILLER            PIC  X(22)  VALUE
                 "UYTK_IDOG_IK_MSSHEKI, ".
      *----------  運用通貨異動後移管前払金評価損益残
             15  FILLER            PIC  X(21)  VALUE
                 "UYTK_IDOG_IK_PPHKZN, ".
      *----------  削除区分
             15  FILLER            PIC  X(12)  VALUE
                 "SAKUJO_KBN, ".
      *----------  短期スタート・エンド経過利息
             15  FILLER            PIC  X(21)  VALUE
                 "SHORT_STEN_KEKA_RSK, ".
      *----------  短期スタート日
             15  FILLER            PIC  X(17)  VALUE
                 "SHORT_START_YMD, ".
      *----------  短期エンド日
             15  FILLER            PIC  X(15)  VALUE
                 "SHORT_END_YMD, ".
      *----------  投資対象国コード
             15  FILLER            PIC  X(10)  VALUE
                 "TSTSK_CD, ".
      *----------  発行国コード
             15  FILLER            PIC  X(09)  VALUE
                 "HAKO_CD, ".
      *----------  数量単位
             15  FILLER            PIC  X(12)  VALUE
                 "SURYO_TANI, ".
      *----------  作成フラグ
             15  FILLER            PIC  X(08)  VALUE
                 "SK_FLG, ".
      *----------  作成日時
             15  FILLER            PIC  X(09)  VALUE
                 "SK_DATE, ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(17)  VALUE
                 "SK_LOGIN_CMP_CD, ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(08)  VALUE
                 "SK_SID, ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "SK_PGMID, ".
      *----------  更新フラグ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_FLG, ".
      *----------  更新日時
             15  FILLER            PIC  X(10)  VALUE
                 "UPD_DATE, ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(10)  VALUE
                 "UPD_PGMID ".
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
      *----------  残高異動
             15  SQL-TBL-TKMZZI00  PIC  X(13).
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産/負債・買建/売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *----------  計上基準日
             15  FILLER            PIC  X(38)  VALUE
                 " AND KEIJOU_KIJUNBI > :P_KAISI_KJN_YMD".
             15  FILLER            PIC  X(40)  VALUE
                 " AND KEIJOU_KIJUNBI <= :P_KJN_YMD) T_AAA".
             15  FILLER            PIC  X(10)  VALUE
                 " LEFT JOIN".
             15  FILLER            PIC  X(24)  VALUE
                 " (SELECT KEIJOU_KIJUNBI,".
             15  FILLER            PIC  X(31)  VALUE
                 " MAX(UKE_YMD) AS KJ_MAX_UKE_YMD".
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
      *----------  残高異動
             15  SQL-TBL2-TKMZZI00 PIC  X(13).
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産/負債・買建/売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *----------  計上基準日
             15  FILLER            PIC  X(38)  VALUE
                 " AND KEIJOU_KIJUNBI > :P_KAISI_KJN_YMD".
             15  FILLER            PIC  X(33)  VALUE
                 " AND KEIJOU_KIJUNBI <= :P_KJN_YMD".
             15  FILLER            PIC  X(31)  VALUE
                 " GROUP BY KEIJOU_KIJUNBI) T_BBB".
             15  FILLER            PIC  X(49)  VALUE
                 " ON T_AAA.KEIJOU_KIJUNBI = T_BBB.KEIJOU_KIJUNBI))".
             15  FILLER            PIC  X(18)  VALUE
                 " ORDER BY TBL_KBN,".
             15  FILLER            PIC  X(27)  VALUE
                 " DECODE(TBL_KBN,1,19800101,".
             15  WK-UKK-YMD        PIC  X(14).
             15  FILLER            PIC  X(07)  VALUE
                 ") DESC,".
             15  FILLER            PIC  X(17)  VALUE
                 " IDO_KJY_JUN DESC".
      *---------- 資金残履歴計算データ（TKMZBW12 別紙1-6,別紙1-8)
         05  SQL-INSERT-TKMZBW12.
           10  S-INSERT-TKMZBW12.
             15  FILLER            PIC  X(13)  VALUE
                 " INSERT INTO ".
             15  SQL-TBL-TKMZBW12  PIC  X(13).
             15  FILLER            PIC  X(02)  VALUE
                 " (".
             15  FILLER            PIC  X(11)  VALUE
                 " SYORI_YMD,".
             15  FILLER            PIC  X(10)  VALUE
                 " KIDOU_ID,".
             15  FILLER            PIC  X(13)  VALUE
                 " RIYO_CMP_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " FUND_CD,".
             15  FILLER            PIC  X(08)  VALUE
                 " PTF_CD,".
             15  FILLER            PIC  X(12)  VALUE
                 " KS_KOZA_NO,".
             15  FILLER            PIC  X(09)  VALUE
                 " KJN_YMD,".
             15  FILLER            PIC  X(17)  VALUE
                 " KSN_YMD_DMN_KBN,".
             15  FILLER            PIC  X(12)  VALUE
                 " SEC_SBT_CD,".
             15  FILLER            PIC  X(14)  VALUE
                 " KOZA_TUKA_CD,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_TJT_CASHZN,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_TJT_CASHZN,".
             15  FILLER            PIC  X(20)  VALUE
                 " SJTK_TJT_MSNKZN_UM,".
             15  FILLER            PIC  X(20)  VALUE
                 " UYTK_TJT_MSNKZN_UM,".
             15  FILLER            PIC  X(20)  VALUE
                 " SJTK_TJT_MSNKZN_SM,".
             15  FILLER            PIC  X(20)  VALUE
                 " UYTK_TJT_MSNKZN_SM,".
             15  FILLER            PIC  X(19)  VALUE
                 " SJTK_TJT_MBKZN_UM,".
             15  FILLER            PIC  X(19)  VALUE
                 " UYTK_TJT_MBKZN_UM,".
             15  FILLER            PIC  X(19)  VALUE
                 " SJTK_TJT_MBKZN_SM,".
             15  FILLER            PIC  X(19)  VALUE
                 " UYTK_TJT_MBKZN_SM,".
             15  FILLER            PIC  X(10)  VALUE
                 " BOKA_KWS,".
             15  FILLER            PIC  X(15)  VALUE
                 " SJTK_MS_SHEKI,".
             15  FILLER            PIC  X(15)  VALUE
                 " UYTK_MS_SHEKI,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_GENSEN_TAX,".
             15  FILLER            PIC  X(17)  VALUE
                 " UYTK_GENSEN_TAX,".
             15  FILLER            PIC  X(12)  VALUE
                 " SAKUJO_KBN,".
             15  FILLER            PIC  X(09)  VALUE
                 " SK_DATE,".
             15  FILLER            PIC  X(17)  VALUE
                 " SK_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(08)  VALUE
                 " SK_SID,".
             15  FILLER            PIC  X(10)  VALUE
                 " SK_PGMID,".
             15  FILLER            PIC  X(10)  VALUE
                 " UPD_DATE,".
             15  FILLER            PIC  X(18)  VALUE
                 " UPD_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " UPD_SID,".
             15  FILLER            PIC  X(12)  VALUE
                 " UPD_PGMID,".
             15  FILLER            PIC  X(17)  VALUE
                 " SJTK_MSSE_KJMIG,".
             15  FILLER            PIC  X(18)  VALUE
                 " UYTK_MSSE_KJMIG) ".
      *----------  VALUES
           10  S-VALUES-TKMZBW12.
             15  FILLER            PIC  X(09)  VALUE
                 "  VALUES ".
             15  FILLER            PIC  X(04)  VALUE
                 "  ( ".
             15  FILLER            PIC  X(13)  VALUE
                 ":P_SYORI_YMD,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_KIDOU_ID,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_RIYO_CMP_CD,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_FUND_CD,".
             15  FILLER            PIC  X(10)  VALUE
                 ":P_PTF_CD,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_KS_KOZA_NO,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_KJN_YMD,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_KSN_YMD_DMN_KBN,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_SEC_SBT_CD,".
             15  FILLER            PIC  X(16)  VALUE
                 ":P_KOZA_TUKA_CD,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_TJT_CASHZN,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_TJT_CASHZN,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_SJTK_TJT_MSNKZN_UM,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_UYTK_TJT_MSNKZN_UM,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_SJTK_TJT_MSNKZN_SM,".
             15  FILLER            PIC  X(22)  VALUE
                 ":P_UYTK_TJT_MSNKZN_SM,".
             15  FILLER            PIC  X(21)  VALUE
                 ":P_SJTK_TJT_MBKZN_UM,".
             15  FILLER            PIC  X(21)  VALUE
                 ":P_UYTK_TJT_MBKZN_UM,".
             15  FILLER            PIC  X(21)  VALUE
                 ":P_SJTK_TJT_MBKZN_SM,".
             15  FILLER            PIC  X(21)  VALUE
                 ":P_UYTK_TJT_MBKZN_SM,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_BOKA_KWS,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_SJTK_MS_SHEKI,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_UYTK_MS_SHEKI,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SJTK_GENSEN_TAX,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_UYTK_GENSEN_TAX,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(08)  VALUE
                 "SYSDATE,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SK_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(11)  VALUE
                 "'SMZJ2210',".
             15  FILLER            PIC  X(08)  VALUE
                 "SYSDATE,".
             15  FILLER            PIC  X(20)  VALUE
                 ":P_UPD_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(11)  VALUE
                 "'SMZJ2210',".
             15  FILLER            PIC  X(20)  VALUE
                 " :P_SJTK_MSSE_KJMIG,".
             15  FILLER            PIC  X(21)  VALUE
                 " :P_UYTK_MSSE_KJMIG) ".
      *----------  資金簿価異動計算データ（TKMZBW07 別紙1-7)
         05  SQL-SELECT-1-7.
           10  S-SELECT-1-7.
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
      *----------  処理実行日
             15  FILLER            PIC  X(12)  VALUE
                 " SYORI_YMD, ".
      *----------  起動ID
             15  FILLER            PIC  X(10)  VALUE
                 "KIDOU_ID, ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  原取引ID
             15  FILLER            PIC  X(09)  VALUE
                 "TORI_ID, ".
      *----------  決済口座番号
             15  FILLER            PIC  X(12)  VALUE
                 "KS_KOZA_NO, ".
      *----------  資金種別
             15  FILLER            PIC  X(11)  VALUE
                 "SIKIN_SBT, ".
      *----------  異動日
             15  FILLER            PIC  X(09)  VALUE
                 "IDO_YMD, ".
      *----------  増減区分
             15  FILLER            PIC  X(08)  VALUE
                 "ZG_KBN, ".
      *----------  赤黒区分
             15  FILLER            PIC  X(10)  VALUE
                 "AKA_KBN, ".
      *----------  誤計上№
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(ERR_KJY_NO,0), ".
      *----------  誤計上区分
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(ERR_KJY_KBN,' '), ".
      *----------  取引事由
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(TORI_JIYU,' '), ".
      *----------  取引連関ID
             15  FILLER            PIC  X(16)  VALUE
                 "NVL(THRK_ID,0), ".
      *----------  決済口座通貨コード
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(KOZA_TUKA_CD,' '), ".
      *----------  証券種別コード
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SEC_SBT_CD,' '), ".
      *----------  市場通貨資金簿価異動額
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_SK_BOKA_IDOGK,0), ".
      *----------  運用通貨資金簿価異動額
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_SK_BOKA_IDOGK,0), ".
      *----------  市場通貨払出簿価
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_H_BOKA,0), ".
      *----------  運用通貨払出簿価
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_H_BOKA,0), ".
      *----------  市場通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SJTK_H_TNK,0), ".
      *----------  運用通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(UYTK_H_TNK,0), ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(BOKA_KWS,0), ".
      *----------  市場通貨異動後ＣＡＳＨ残高
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_SK_BOKAZN,0), ".
      *----------  運用通貨異動後ＣＡＳＨ残高
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_SK_BOKAZN,0), ".
      *----------  市場通貨異動後未収入金残高（内物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_MSNKZN_UM,0), ".
      *----------  運用通貨異動後未収入金残高（内物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_MSNKZN_UM,0), ".
      *----------  市場通貨異動後未収入金残高（外物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_MSNKZN_SM,0), ".
      *----------  運用通貨異動後未収入金残高（外物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_MSNKZN_SM,0), ".
      *----------  市場通貨異動後未払金残高（内物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_IDOG_MBKZN_UM,0), ".
      *----------  運用通貨異動後未払金残高（内物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_IDOG_MBKZN_UM,0), ".
      *----------  市場通貨異動後未払金残高（外物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_IDOG_MBKZN_SM,0), ".
      *----------  運用通貨異動後未払金残高（外物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_IDOG_MBKZN_SM,0), ".
      *----------  為替差損益
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_KWS_SNEKI,0), ".
      *----------  市場通貨利金等損益勘定
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_RKSEKJ,0), ".
      *----------  運用通貨利金等損益勘定
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_RKSEKJ,0), ".
      *----------  異動計上順序
             15  FILLER            PIC  X(13)  VALUE
                 "IDO_KJY_JUN, ".
      *----------  削除区分
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SAKUJO_KBN,' '), ".
      *----------  作成フラグ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_FLG,' '), ".
      *----------  作成日時
             15  FILLER            PIC  X(46)  VALUE
                 "NVL(TO_CHAR(SK_DATE,'YYYYMMDDHH24MISS'),' '), ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SK_LOGIN_CMP_CD,' '), ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_SID,' '), ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SK_PGMID,' '), ".
      *----------  更新フラグ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_FLG, ".
      *----------  更新日時
             15  FILLER            PIC  X(38)  VALUE
                 "TO_CHAR(UPD_DATE,'YYYYMMDDHH24MISS'), ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(11)  VALUE
                 "UPD_PGMID, ".
      *----------  TBL区分
             15  FILLER            PIC  X(12)  VALUE
                 "1 AS TBL_KBN".
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL-TKMZBW07  PIC  X(13).
      *----------  WHERE
           10  S-WHERE-1-7.
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  決済口座番号
             15  FILLER            PIC  X(31)  VALUE
                 " AND KS_KOZA_NO = :P_KS_KOZA_NO".
      *----------  異動日
             15  FILLER            PIC  X(27)  VALUE
                 " AND IDO_YMD > :P_IDO_YMD_1".
             15  FILLER            PIC  X(28)  VALUE
                 " AND IDO_YMD <= :P_IDO_YMD_2".
      *---------- 処理実行日
             15  FILLER            PIC  X(29)  VALUE
                 " AND SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(29)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- UNION
             15  FILLER            PIC  X(07)  VALUE
                 " UNION ".
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
      *----------  処理実行日
             15  FILLER            PIC  X(16)  VALUE
                 "0 AS SYORI_YMD, ".
      *----------  起動ID
             15  FILLER            PIC  X(17)  VALUE
                 "' ' AS KIDOU_ID, ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  原取引ID
             15  FILLER            PIC  X(09)  VALUE
                 "TORI_ID, ".
      *----------  決済口座番号
             15  FILLER            PIC  X(12)  VALUE
                 "KS_KOZA_NO, ".
      *----------  資金種別
             15  FILLER            PIC  X(11)  VALUE
                 "SIKIN_SBT, ".
      *----------  異動日
             15  FILLER            PIC  X(09)  VALUE
                 "IDO_YMD, ".
      *----------  増減区分
             15  FILLER            PIC  X(08)  VALUE
                 "ZG_KBN, ".
      *----------  赤黒区分
             15  FILLER            PIC  X(10)  VALUE
                 "AKA_KBN, ".
      *----------  誤計上№
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(ERR_KJY_NO,0), ".
      *----------  誤計上区分
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(ERR_KJY_KBN,' '), ".
      *----------  取引事由
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(TORI_JIYU,' '), ".
      *----------  取引連関ID
             15  FILLER            PIC  X(16)  VALUE
                 "NVL(THRK_ID,0), ".
      *----------  決済口座通貨コード
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(KOZA_TUKA_CD,' '), ".
      *----------  証券種別コード
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SEC_SBT_CD,' '), ".
      *----------  市場通貨資金簿価異動額
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_SK_BOKA_IDOGK,0), ".
      *----------  運用通貨資金簿価異動額
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_SK_BOKA_IDOGK,0), ".
      *----------  市場通貨払出簿価
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_H_BOKA,0), ".
      *----------  運用通貨払出簿価
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_H_BOKA,0), ".
      *----------  市場通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SJTK_H_TNK,0), ".
      *----------  運用通貨払出単価
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(UYTK_H_TNK,0), ".
      *----------  簿価為替レート
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(BOKA_KWS,0), ".
      *----------  市場通貨異動後ＣＡＳＨ残高
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_SK_BOKAZN,0), ".
      *----------  運用通貨異動後ＣＡＳＨ残高
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_SK_BOKAZN,0), ".
      *----------  市場通貨異動後未収入金残高（内物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_MSNKZN_UM,0), ".
      *----------  運用通貨異動後未収入金残高（内物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_MSNKZN_UM,0), ".
      *----------  市場通貨異動後未収入金残高（外物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(SJTK_IDOG_MSNKZN_SM,0), ".
      *----------  運用通貨異動後未収入金残高（外物）
             15  FILLER            PIC  X(28)  VALUE
                 "NVL(UYTK_IDOG_MSNKZN_SM,0), ".
      *----------  市場通貨異動後未払金残高（内物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_IDOG_MBKZN_UM,0), ".
      *----------  運用通貨異動後未払金残高（内物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_IDOG_MBKZN_UM,0), ".
      *----------  市場通貨異動後未払金残高（外物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(SJTK_IDOG_MBKZN_SM,0), ".
      *----------  運用通貨異動後未払金残高（外物）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UYTK_IDOG_MBKZN_SM,0), ".
      *----------  為替差損益
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(UYTK_KWS_SNEKI,0), ".
      *----------  市場通貨利金等損益勘定
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(SJTK_RKSEKJ,0), ".
      *----------  運用通貨利金等損益勘定
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(UYTK_RKSEKJ,0), ".
      *----------  異動計上順序
             15  FILLER            PIC  X(13)  VALUE
                 "IDO_KJY_JUN, ".
      *----------  削除区分
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SAKUJO_KBN,' '), ".
      *----------  作成フラグ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_FLG,' '), ".
      *----------  作成日時
             15  FILLER            PIC  X(46)  VALUE
                 "NVL(TO_CHAR(SK_DATE,'YYYYMMDDHH24MISS'),' '), ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SK_LOGIN_CMP_CD,' '), ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_SID,' '), ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SK_PGMID,' '), ".
      *----------  更新フラグ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_FLG, ".
      *----------  更新日時
             15  FILLER            PIC  X(38)  VALUE
                 "TO_CHAR(UPD_DATE,'YYYYMMDDHH24MISS'), ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(18)  VALUE
                 "UPD_LOGIN_CMP_CD, ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(09)  VALUE
                 "UPD_SID, ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(11)  VALUE
                 "UPD_PGMID, ".
      *----------  TBL区分
             15  FILLER            PIC  X(12)  VALUE
                 "2 AS TBL_KBN".
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
      *----------  資金簿価異動
             15  SQL-TBL-TKMZSI00  PIC  X(13).
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  決済口座番号
             15  FILLER            PIC  X(31)  VALUE
                 " AND KS_KOZA_NO = :P_KS_KOZA_NO".
      *----------  異動日
             15  FILLER            PIC  X(27)  VALUE
                 " AND IDO_YMD > :P_IDO_YMD_1".
             15  FILLER            PIC  X(26)  VALUE
                 " AND IDO_YMD <= :P_KJN_YMD".
      *----------  ORDER BY
             15  FILLER            PIC  X(10)  VALUE
                 " ORDER BY ".
      *----------  異動日
             15  FILLER            PIC  X(14)  VALUE
                 "IDO_YMD DESC, ".
      *----------  計上順序
             15  FILLER            PIC  X(16)  VALUE
                 "IDO_KJY_JUN DESC".
      *---------- 元本残高計算データ（TKMZBW13 別紙1-9,別紙1-10)
         05  SQL-INSERT-TKMZBW13.
           10  S-INSERT-TKMZBW13.
             15  FILLER            PIC  X(13)  VALUE
                 " INSERT INTO ".
             15  SQL-TBL-TKMZBW13  PIC  X(13).
             15  FILLER            PIC  X(02)  VALUE
                 " (".
             15  FILLER            PIC  X(11)  VALUE
                 " SYORI_YMD,".
             15  FILLER            PIC  X(10)  VALUE
                 " KIDOU_ID,".
             15  FILLER            PIC  X(13)  VALUE
                 " RIYO_CMP_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " FUND_CD,".
             15  FILLER            PIC  X(08)  VALUE
                 " PTF_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " KJN_YMD,".
             15  FILLER            PIC  X(17)  VALUE
                 " KSN_YMD_DMN_KBN,".
             15  FILLER            PIC  X(11)  VALUE
                 " GNP_SRYZN,".
             15  FILLER            PIC  X(12)  VALUE
                 " GNP_BOKAZN,".
             15  FILLER            PIC  X(11)  VALUE
                 " SO_TN_KGK,".
             15  FILLER            PIC  X(15)  VALUE
                 " SHOKI_SET_KGK,".
             15  FILLER            PIC  X(12)  VALUE
                 " SAKUJO_KBN,".
             15  FILLER            PIC  X(09)  VALUE
                 " SK_DATE,".
             15  FILLER            PIC  X(17)  VALUE
                 " SK_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(08)  VALUE
                 " SK_SID,".
             15  FILLER            PIC  X(10)  VALUE
                 " SK_PGMID,".
             15  FILLER            PIC  X(10)  VALUE
                 " UPD_DATE,".
             15  FILLER            PIC  X(18)  VALUE
                 " UPD_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(09)  VALUE
                 " UPD_SID,".
             15  FILLER            PIC  X(12)  VALUE
                 " UPD_PGMID )".
      *----------  VALUES
           10  S-VALUES-TKMZBW13.
             15  FILLER            PIC  X(09)  VALUE
                 "  VALUES ".
             15  FILLER            PIC  X(04)  VALUE
                 "  ( ".
             15  FILLER            PIC  X(13)  VALUE
                 ":P_SYORI_YMD,".
             15  FILLER            PIC  X(12)  VALUE
                 ":P_KIDOU_ID,".
             15  FILLER            PIC  X(15)  VALUE
                 ":P_RIYO_CMP_CD,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_FUND_CD,".
             15  FILLER            PIC  X(10)  VALUE
                 ":P_PTF_CD,".
             15  FILLER            PIC  X(11)  VALUE
                 ":P_KJN_YMD,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_KSN_YMD_DMN_KBN,".
             15  FILLER            PIC  X(13)  VALUE
                 ":P_GNP_SRYZN,".
             15  FILLER            PIC  X(14)  VALUE
                 ":P_GNP_BOKAZN,".
             15  FILLER            PIC  X(13)  VALUE
                 ":P_SO_TN_KGK,".
             15  FILLER            PIC  X(17)  VALUE
                 ":P_SHOKI_SET_KGK,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(08)  VALUE
                 "SYSDATE,".
             15  FILLER            PIC  X(19)  VALUE
                 ":P_SK_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(11)  VALUE
                 "'SMZJ2210',".
             15  FILLER            PIC  X(08)  VALUE
                 "SYSDATE,".
             15  FILLER            PIC  X(20)  VALUE
                 ":P_UPD_LOGIN_CMP_CD,".
             15  FILLER            PIC  X(04)  VALUE
                 "' ',".
             15  FILLER            PIC  X(12)  VALUE
                 "'SMZJ2210' )".
      *---------- SELECT SQL文(別紙1-12)
         05  SQL-SELECT-1-12.
           10  S-SELECT-1-12.
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
      *----------  利用会社コード
             15  FILLER            PIC  X(13)  VALUE
                 "RIYO_CMP_CD, ".
      *----------  ファンドコード
             15  FILLER            PIC  X(09)  VALUE
                 "FUND_CD, ".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(08)  VALUE
                 "PTF_CD, ".
      *----------  基準日
             15  FILLER            PIC  X(09)  VALUE
                 "KJN_YMD, ".
      *----------  決算日断面区分
             15  FILLER            PIC  X(17)  VALUE
                 "KSN_YMD_DMN_KBN, ".
      *----------  元本数量残高
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(GNP_SRYZN,0), ".
      *----------  元本簿価残高
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(GNP_BOKAZN,0), ".
      *----------  総投入金額
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(SO_TN_KGK,0), ".
      *----------  初期設定金額
             15  FILLER            PIC  X(22)  VALUE
                 "NVL(SHOKI_SET_KGK,0), ".
      *----------  削除区分
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(SAKUJO_KBN,' '), ".
      *----------  作成日時
             15  FILLER            PIC  X(46)  VALUE
                 "NVL(TO_CHAR(SK_DATE,'YYYYMMDDHH24MISS'),' '), ".
      *----------  作成ログインユーザ会社コード
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(SK_LOGIN_CMP_CD,' '), ".
      *----------  作成ユーザＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(SK_SID,' '), ".
      *----------  作成プログラムＩＤ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(SK_PGMID,' '), ".
      *----------  更新日時
             15  FILLER            PIC  X(47)  VALUE
                 "NVL(TO_CHAR(UPD_DATE,'YYYYMMDDHH24MISS'),' '), ".
      *----------  更新ログインユーザ会社コード
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(UPD_LOGIN_CMP_CD,' '), ".
      *----------  更新ユーザＩＤ
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(UPD_SID,' '), ".
      *----------  更新プログラムＩＤ
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(UPD_PGMID,' ')".
      *----------  FROM
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL-TKMZGZ00  PIC  X(13).
      *----------  WHERE
           10  S-WHERE-1-12.
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *----------  決算日断面区分
             15  FILLER            PIC  X(34)  VALUE
                 " AND KSN_YMD_DMN_KBN IN ('0', '2')".
      *---------- SELECT SQL文(別紙1-13)
         05  SQL-SELECT-1-13.
           10  SQL-SELECT-1.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- SUM(市場通貨未収収益)
             15  FILLER            PIC  X(48)  VALUE
                 "NVL(SUM(SJTK_MS_SHEKI),0) AS SUM_SJTK_MS_SHEKI, ".
      *---------- SUM(市場通貨源泉税)
             15  FILLER            PIC  X(52)  VALUE
                 "NVL(SUM(SJTK_GENSEN_TAX),0) AS SUM_SJTK_GENSEN_TAX, ".
      *---------- SUM(運用通貨未収収益)
             15  FILLER            PIC  X(59)  VALUE
          "DECODE(SUM(DECODE(UYTK_MS_SHEKI_IN_MID,999999999999999.999,".
             15  FILLER            PIC  X(33)  VALUE
                 "NULL,UYTK_MS_SHEKI_IN_MID)),NULL,".
             15  FILLER            PIC  X(52)  VALUE
                 "999999999999999.999,SUM(DECODE(UYTK_MS_SHEKI_IN_MID,".
             15  FILLER            PIC  X(49)  VALUE
                 "999999999999999.999,NULL,UYTK_MS_SHEKI_IN_MID))) ".
             15  FILLER            PIC  X(22)  VALUE
                 "AS SUM_UYTK_MS_SHEKI, ".
      *---------- SUM(運用通貨源泉税)
             15  FILLER            PIC  X(61)  VALUE
        "DECODE(SUM(DECODE(UYTK_GENSEN_TAX_IN_MID,999999999999999.999,".
             15  FILLER            PIC  X(35)  VALUE
                "NULL,UYTK_GENSEN_TAX_IN_MID)),NULL,".
             15  FILLER            PIC  X(54)  VALUE
               "999999999999999.999,SUM(DECODE(UYTK_GENSEN_TAX_IN_MID,".
             15  FILLER            PIC  X(51)  VALUE
                "999999999999999.999,NULL,UYTK_GENSEN_TAX_IN_MID))) ".
             15  FILLER            PIC  X(24)  VALUE
                 "AS SUM_UYTK_GENSEN_TAX, ".
      *---------- SUM(評価為替レート)
             15  FILLER            PIC  X(53)  VALUE
                "DECODE(SUM(DECODE(HYK_KWS_IN_MID,99999999.9999999999,".
             15  FILLER            PIC  X(47)  VALUE
                 "NULL,HYK_KWS_IN_MID)),NULL,99999999.9999999999,".
             15  FILLER            PIC  X(51)  VALUE
                 "SUM(DECODE(HYK_KWS_IN_MID,99999999.9999999999,NULL,".
             15  FILLER            PIC  X(34)  VALUE
                 "HYK_KWS_IN_MID))) AS SUM_HYK_KWS, ".
      *---------- SUM(源泉税評価為替レート)
             15  FILLER            PIC  X(42)  VALUE
                 "DECODE(SUM(DECODE(GENS_TAX_HYK_KWS_IN_MID,".
             15  FILLER            PIC  X(56)  VALUE
             "99999999.9999999999,NULL,GENS_TAX_HYK_KWS_IN_MID)),NULL,".
             15  FILLER            PIC  X(55)  VALUE
              "99999999.9999999999,SUM(DECODE(GENS_TAX_HYK_KWS_IN_MID,".
             15  FILLER            PIC  X(52)  VALUE
               "99999999.9999999999,NULL,GENS_TAX_HYK_KWS_IN_MID))) ".
             15  FILLER            PIC  X(25)  VALUE
                 "AS SUM_GENS_TAX_HYK_KWS, ".
      *---------- MAX(評価為替レート)
             15  FILLER            PIC  X(53)  VALUE
                "DECODE(SUM(DECODE(HYK_KWS_IN_MID,99999999.9999999999,".
             15  FILLER            PIC  X(47)  VALUE
                 "NULL,HYK_KWS_IN_MID)),NULL,99999999.9999999999,".
             15  FILLER            PIC  X(46)  VALUE
                 "MAX(DECODE(HYK_KWS_IN_MID,99999999.9999999999,".
             15  FILLER            PIC  X(39)  VALUE
                 "NULL,HYK_KWS_IN_MID))) AS MAX_HYK_KWS, ".
      *---------- MAX(源泉税評価為替レート)
             15  FILLER            PIC  X(42)  VALUE
                 "DECODE(SUM(DECODE(GENS_TAX_HYK_KWS_IN_MID,".
             15  FILLER            PIC  X(56)  VALUE
             "99999999.9999999999,NULL,GENS_TAX_HYK_KWS_IN_MID)),NULL,".
             15  FILLER            PIC  X(55)  VALUE
              "99999999.9999999999,MAX(DECODE(GENS_TAX_HYK_KWS_IN_MID,".
             15  FILLER            PIC  X(52)  VALUE
                 "99999999.9999999999,NULL,GENS_TAX_HYK_KWS_IN_MID))) ".
             15  FILLER            PIC  X(23)  VALUE
                 "AS MAX_GENS_TAX_HYK_KWS".
           10  SQL-FROM.
             15  FILLER            PIC  X(08)  VALUE " FROM ( ".
      *---------- SELECT
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 市場通貨未収収益
             15  FILLER            PIC  X(25)  VALUE
                 "DECODE(T_GYOMU.TBL_KBN,2,".
             15  FILLER            PIC  X(26)  VALUE
                 "DECODE(T_TYUKAN.TBL_KBN,1,".
             15  FILLER            PIC  X(34)  VALUE
                 "DECODE(sign(T_GYOMU.TEKIYO_FROM - ".
             15  FILLER            PIC  X(22)  VALUE
                 "T_TYUKAN.TEKIYO_FROM),".
             15  FILLER            PIC  X(41)  VALUE
                 "0,DECODE(sign(T_GYOMU.SJTK_MS_SHEKI_IN - ".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999),".
             15  FILLER            PIC  X(25)  VALUE
                 "0,T_TYUKAN.SJTK_MS_SHEKI,".
             15  FILLER            PIC  X(26)  VALUE
                 "T_GYOMU.SJTK_MS_SHEKI_IN),".
             15  FILLER            PIC  X(41)  VALUE
                 "1,DECODE(sign(T_GYOMU.SJTK_MS_SHEKI_IN - ".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999),".
             15  FILLER            PIC  X(24)  VALUE
                 "0,T_GYOMU.SJTK_MS_SHEKI,".
             15  FILLER            PIC  X(26)  VALUE
                 "T_GYOMU.SJTK_MS_SHEKI_IN),".
             15  FILLER            PIC  X(27)  VALUE
                 "-1,T_TYUKAN.SJTK_MS_SHEKI),".
             15  FILLER            PIC  X(39)  VALUE
                 "DECODE(sign(T_GYOMU.SJTK_MS_SHEKI_IN - ".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999),".
             15  FILLER            PIC  X(24)  VALUE
                 "0,T_GYOMU.SJTK_MS_SHEKI,".
             15  FILLER            PIC  X(28)  VALUE
                 "T_GYOMU.SJTK_MS_SHEKI_IN) ),".
             15  FILLER            PIC  X(41)  VALUE
                 "T_TYUKAN.SJTK_MS_SHEKI) AS SJTK_MS_SHEKI,".
      *---------- 市場通貨源泉税
             15  FILLER            PIC  X(25)  VALUE
                 "DECODE(T_GYOMU.TBL_KBN,2,".
             15  FILLER            PIC  X(26)  VALUE
                 "DECODE(T_TYUKAN.TBL_KBN,1,".
             15  FILLER            PIC  X(34)  VALUE
                 "DECODE(sign(T_GYOMU.TEKIYO_FROM - ".
             15  FILLER            PIC  X(22)  VALUE
                 "T_TYUKAN.TEKIYO_FROM),".
             15  FILLER            PIC  X(43)  VALUE
                 "0,DECODE(sign(T_GYOMU.SJTK_GENSEN_TAX_IN - ".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999),".
             15  FILLER            PIC  X(27)  VALUE
                 "0,T_TYUKAN.SJTK_GENSEN_TAX,".
             15  FILLER            PIC  X(28)  VALUE
                 "T_GYOMU.SJTK_GENSEN_TAX_IN),".
             15  FILLER            PIC  X(43)  VALUE
                 "1,DECODE(sign(T_GYOMU.SJTK_GENSEN_TAX_IN - ".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999),".
             15  FILLER            PIC  X(26)  VALUE
                 "0,T_GYOMU.SJTK_GENSEN_TAX,".
             15  FILLER            PIC  X(28)  VALUE
                 "T_GYOMU.SJTK_GENSEN_TAX_IN),".
             15  FILLER            PIC  X(29)  VALUE
                 "-1,T_TYUKAN.SJTK_GENSEN_TAX),".
             15  FILLER            PIC  X(41)  VALUE
                 "DECODE(sign(T_GYOMU.SJTK_GENSEN_TAX_IN - ".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999),".
             15  FILLER            PIC  X(26)  VALUE
                 "0,T_GYOMU.SJTK_GENSEN_TAX,".
             15  FILLER            PIC  X(30)  VALUE
                 "T_GYOMU.SJTK_GENSEN_TAX_IN) ),".
             15  FILLER            PIC  X(45)  VALUE
                 "T_TYUKAN.SJTK_GENSEN_TAX) AS SJTK_GENSEN_TAX,".
      *---------- 権利落日
             15  FILLER            PIC  X(47)  VALUE
                 "DECODE(T_GYOMU.TBL_KBN,2,T_GYOMU.KENRI_OTI_YMD,".
             15  FILLER            PIC  X(24)  VALUE
                 "T_TYUKAN.KENRI_OTI_YMD) ".
      *---------- ワーク合計
             15  FILLER            PIC  X(32)  VALUE
                 "AS KENRI_OTI_YMD,1 AS WK_GOUKEI,".
      *---------- 運用通貨未収収益（入力値）_中間
             15  FILLER            PIC  X(25)  VALUE
                 "DECODE(T_GYOMU.TBL_KBN,2,".
             15  FILLER            PIC  X(26)  VALUE
                 "DECODE(T_TYUKAN.TBL_KBN,1,".
             15  FILLER            PIC  X(34)  VALUE
                 "DECODE(sign(T_GYOMU.TEKIYO_FROM - ".
             15  FILLER            PIC  X(22)  VALUE
                 "T_TYUKAN.TEKIYO_FROM),".
             15  FILLER            PIC  X(23)  VALUE
                 "-1,999999999999999.999,".
             15  FILLER            PIC  X(26)  VALUE
                 "T_GYOMU.UYTK_MS_SHEKI_IN),".
             15  FILLER            PIC  X(26)  VALUE
                 "T_GYOMU.UYTK_MS_SHEKI_IN),".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999) ".
             15  FILLER            PIC  X(24)  VALUE
                 "AS UYTK_MS_SHEKI_IN_MID,".
      *---------- 運用通貨源泉税（入力値）_中間
             15  FILLER            PIC  X(25)  VALUE
                 "DECODE(T_GYOMU.TBL_KBN,2,".
             15  FILLER            PIC  X(26)  VALUE
                 "DECODE(T_TYUKAN.TBL_KBN,1,".
             15  FILLER            PIC  X(34)  VALUE
                 "DECODE(sign(T_GYOMU.TEKIYO_FROM - ".
             15  FILLER            PIC  X(22)  VALUE
                 "T_TYUKAN.TEKIYO_FROM),".
             15  FILLER            PIC  X(23)  VALUE
                 "-1,999999999999999.999,".
             15  FILLER            PIC  X(28)  VALUE
                 "T_GYOMU.UYTK_GENSEN_TAX_IN),".
             15  FILLER            PIC  X(28)  VALUE
                 "T_GYOMU.UYTK_GENSEN_TAX_IN),".
             15  FILLER            PIC  X(21)  VALUE
                 "999999999999999.999) ".
             15  FILLER            PIC  X(26)  VALUE
                 "AS UYTK_GENSEN_TAX_IN_MID,".
      *---------- 評価為替レート（入力値）_中間
             15  FILLER            PIC  X(25)  VALUE
                 "DECODE(T_GYOMU.TBL_KBN,2,".
             15  FILLER            PIC  X(26)  VALUE
                 "DECODE(T_TYUKAN.TBL_KBN,1,".
             15  FILLER            PIC  X(34)  VALUE
                 "DECODE(sign(T_GYOMU.TEKIYO_FROM - ".
             15  FILLER            PIC  X(22)  VALUE
                 "T_TYUKAN.TEKIYO_FROM),".
             15  FILLER            PIC  X(23)  VALUE
                 "-1,99999999.9999999999,".
             15  FILLER            PIC  X(20)  VALUE
                 "T_GYOMU.HYK_KWS_IN),".
             15  FILLER            PIC  X(20)  VALUE
                 "T_GYOMU.HYK_KWS_IN),".
             15  FILLER            PIC  X(21)  VALUE
                 "99999999.9999999999) ".
             15  FILLER            PIC  X(18)  VALUE
                 "AS HYK_KWS_IN_MID,".
      *---------- 源泉税評価為替レート（入力値）_中間
             15  FILLER            PIC  X(25)  VALUE
                 "DECODE(T_GYOMU.TBL_KBN,2,".
             15  FILLER            PIC  X(26)  VALUE
                 "DECODE(T_TYUKAN.TBL_KBN,1,".
             15  FILLER            PIC  X(34)  VALUE
                 "DECODE(sign(T_GYOMU.TEKIYO_FROM - ".
             15  FILLER            PIC  X(22)  VALUE
                 "T_TYUKAN.TEKIYO_FROM),".
             15  FILLER            PIC  X(23)  VALUE
                 "-1,99999999.9999999999,".
             15  FILLER            PIC  X(29)  VALUE
                 "T_GYOMU.GENS_TAX_HYK_KWS_IN),".
             15  FILLER            PIC  X(29)  VALUE
                 "T_GYOMU.GENS_TAX_HYK_KWS_IN),".
             15  FILLER            PIC  X(21)  VALUE
                 "99999999.9999999999) ".
             15  FILLER            PIC  X(26)  VALUE
                 "AS GENS_TAX_HYK_KWS_IN_MID".
      *---------- FROM
             15  FILLER            PIC  X(07)  VALUE " FROM (".
      *---------- SELECT
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- テーマ2851
             15  FILLER            PIC  X(10)  VALUE
                "/*+ INDEX(".
             15  SQL-TKMZMS00-1-1  PIC  X(13).
             15  FILLER            PIC  X(01)  VALUE " ".
             15  SQL-TKMZMS00-1-2  PIC  X(13).
             15  FILLER            PIC  X(10)  VALUE "_PRKY) */ ".
      *---------- テーマ2851
      *---------- 市場通貨未収収益
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_MS_SHEKI, ".
      *---------- 市場通貨未収収益（入力値）
             15  FILLER            PIC  X(18)  VALUE
                 "SJTK_MS_SHEKI_IN, ".
      *---------- 市場通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "SJTK_GENSEN_TAX, ".
      *---------- 市場通貨源泉税（入力値）
             15  FILLER            PIC  X(20)  VALUE
                 "SJTK_GENSEN_TAX_IN, ".
      *---------- 運用通貨未収収益（入力値）
             15  FILLER            PIC  X(18)  VALUE
                 "UYTK_MS_SHEKI_IN, ".
      *---------- 運用通貨源泉税（入力値）
             15  FILLER            PIC  X(20)  VALUE
                 "UYTK_GENSEN_TAX_IN, ".
      *---------- 評価為替レート（入力値）
             15  FILLER            PIC  X(12)  VALUE
                 "HYK_KWS_IN, ".
      *---------- 源泉税評価為替レート（入力値）
             15  FILLER            PIC  X(21)  VALUE
                 "GENS_TAX_HYK_KWS_IN, ".
      *---------- 権利落日
             15  FILLER            PIC  X(15)  VALUE
                 "KENRI_OTI_YMD, ".
      *---------- 適用開始日
             15  FILLER            PIC  X(13)  VALUE
                 "TEKIYO_FROM, ".
      *---------- 2 AS テーブル種類
             15  FILLER            PIC  X(12)  VALUE
                 "2 AS TBL_KBN".
             15  FILLER            PIC  X(06)  VALUE " FROM ".
      *---------- 未収収益
             15  SQL-TKMZMS00-1    PIC  X(13).
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(29)  VALUE
                 " RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産/負債・買建/売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- (権利落日, 適用開始日)
             15  FILLER            PIC  X(36)  VALUE
                 " AND (KENRI_OTI_YMD, TEKIYO_FROM) IN".
             15  FILLER            PIC  X(09)  VALUE
                 "( SELECT ".
      *---------- テーマ2851
             15  FILLER            PIC  X(10)  VALUE
                "/*+ INDEX(".
             15  SQL-TKMZMS00-2-1  PIC  X(13).
             15  FILLER            PIC  X(01)  VALUE " ".
             15  SQL-TKMZMS00-2-2  PIC  X(13).
             15  FILLER            PIC  X(10)  VALUE "_PRKY) */ ".
      *---------- テーマ2851
             15  FILLER            PIC  X(33)  VALUE
                 "  KENRI_OTI_YMD, MAX(TEKIYO_FROM)".
             15  FILLER            PIC  X(06)  VALUE " FROM ".
      *---------- 未収収益
             15  SQL-TKMZMS00-2    PIC  X(13).
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(29)  VALUE
                 " RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産/負債・買建/売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- 適用開始日
             15  FILLER            PIC  X(34)  VALUE
                 " AND TEKIYO_FROM <= :P_TEKIYO_FROM".
      *---------- 権利落日
             15  FILLER            PIC  X(38)  VALUE
                 " AND KENRI_OTI_YMD <= :P_KENRI_OTI_YMD".
      *---------- GROUP BY
             15  FILLER            PIC  X(34)  VALUE
                 " GROUP BY KENRI_OTI_YMD)) T_GYOMU ".
      *---------- FULL JOIN
             15  FILLER            PIC  X(12)  VALUE " FULL JOIN (".
      *---------- SELECT
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 市場通貨未収収益
             15  FILLER            PIC  X(15)  VALUE
                 "SJTK_MS_SHEKI, ".
      *---------- 市場通貨源泉税
             15  FILLER            PIC  X(17)  VALUE
                 "SJTK_GENSEN_TAX, ".
      *---------- 権利落日
             15  FILLER            PIC  X(15)  VALUE
                 "KENRI_OTI_YMD, ".
      *---------- 適用開始日
             15  FILLER            PIC  X(13)  VALUE
                 "TEKIYO_FROM, ".
      *---------- 1 AS テーブル種類
             15  FILLER            PIC  X(12)  VALUE
                 "1 AS TBL_KBN".
             15  FILLER            PIC  X(06)  VALUE " FROM ".
      *---------- 未収収益計算データ
             15  SQL-TKMZBW08-1    PIC  X(13).
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 処理実行日
             15  FILLER            PIC  X(25)  VALUE
                 " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- (権利落日, 適用開始日)
             15  FILLER            PIC  X(36)  VALUE
                 " AND (KENRI_OTI_YMD, TEKIYO_FROM) IN".
             15  FILLER            PIC  X(41)  VALUE
                 "( SELECT  KENRI_OTI_YMD, MAX(TEKIYO_FROM)".
             15  FILLER            PIC  X(06)  VALUE " FROM ".
      *---------- 未収収益計算データ
             15  SQL-TKMZBW08-2    PIC  X(13).
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 処理実行日
             15  FILLER            PIC  X(25)  VALUE
                 " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- 適用開始日
             15  FILLER            PIC  X(34)  VALUE
                 " AND TEKIYO_FROM <= :P_TEKIYO_FROM".
      *---------- 権利落日
             15  FILLER            PIC  X(38)  VALUE
                 " AND KENRI_OTI_YMD <= :P_KENRI_OTI_YMD".
      *---------- GROUP BY 権利落日
             15  FILLER            PIC  X(35)  VALUE
                 " GROUP BY KENRI_OTI_YMD)) T_TYUKAN ".
      *---------- ON
             15  FILLER            PIC  X(04)  VALUE " ON ".
      *---------- T_GYOMU.権利落日 ＝ T_TYUKAN.権利落日)
             15  FILLER            PIC  X(50)  VALUE
                 "(T_GYOMU.KENRI_OTI_YMD = T_TYUKAN.KENRI_OTI_YMD) )".
      *---------- GROUP BY
             15  FILLER            PIC  X(20)  VALUE
                 " GROUP  BY WK_GOUKEI".
      *----------  債券過去経過利息,未収収益更新（TKMZKR00,TKMZMS00 別紙1-14)
         05  SQL-SELECT-1-14.
           10  S-SELECT1-1-14.
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
             15  S-TSHKKUNI        PIC  X(08).
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL-TKMZMS00  PIC  X(13).
      *----------  WHERE
           10  KR-WHERE-1-14.
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ＩＤ
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- 銘柄種類２
             15  FILLER            PIC  X(27)  VALUE
                 " AND :P_MEG_CD_SHRU2 <> '2'".
      *---------- 適用開始日
             15  FILLER            PIC  X(47)  VALUE
                 " AND (TEKIYO_FROM BETWEEN :P_KAISI_KJN_YMD_NEXT".
             15  FILLER            PIC  X(16)  VALUE
                 " AND :P_KJN_YMD)".
             15  FILLER            PIC  X(05)  VALUE
                 " AND ".
             15  S-TSHKKUNI        PIC  X(08).
             15  FILLER            PIC  X(07)  VALUE
                 " <> ' '".
      *---------- UNION
             15  FILLER            PIC  X(07)  VALUE
                 " UNION ".
           10  S-SELECT2-1-14.
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
             15  S-TSHKKUNI        PIC  X(08).
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL-TKMZKR00  PIC  X(13).
      *----------  WHERE
           10  MS-WHERE-1-14.
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ＩＤ
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- 銘柄種類２
             15  FILLER            PIC  X(26)  VALUE
                 " AND :P_MEG_CD_SHRU2 = '2'".
      *---------- 適用開始日
             15  FILLER            PIC  X(47)  VALUE
                 " AND (TEKIYO_FROM BETWEEN :P_KAISI_KJN_YMD_NEXT".
             15  FILLER            PIC  X(16)  VALUE
                 " AND :P_KJN_YMD)".
             15  FILLER            PIC  X(05)  VALUE
                 " AND ".
             15  S-TSHKKUNI        PIC  X(08).
             15  FILLER            PIC  X(07)  VALUE
                 " <> ' '".
      *----------  残高履歴計算データ（TKMZBW11 別紙1-15)
         05  SQL-SELECT-1-15.
           10  S-SELECT1-1-15.
             15  FILLER            PIC  X(07)  VALUE
                 "SELECT ".
             15  FILLER            PIC  X(15)  VALUE
                 "COUNT(KJN_YMD) ".
             15  FILLER            PIC  X(06)  VALUE
                 " FROM ".
             15  SQL-TBL1-TKMZBW11 PIC  X(13).
      *----------  WHERE
             15  FILLER            PIC  X(07)  VALUE
                 " WHERE ".
      *----------  利用会社コード
             15  FILLER            PIC  X(28)  VALUE
                 "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *----------  処理実行日
             15  FILLER            PIC  X(29)  VALUE
                 " AND SYORI_YMD = :P_SYORI_YMD".
      *----------  起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *----------  ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *----------  ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *----------  証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *----------  銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *----------  資産/負債・買建/売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *----------  玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *----------  基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *----------  残高異動計算データSQL文(別紙1-16)
         05  SQL-SELECT-1-16.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  取引事由
           10  FILLER              PIC  X(11)  VALUE  "TORI_JIYU, ".
      *----------  市場通貨払出単価
           10  FILLER              PIC  X(12)  VALUE  "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
           10  FILLER              PIC  X(11)  VALUE  "UYTK_H_TNK ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-16       PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  処理実行日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(12)  VALUE  "SYORI_YMD = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_SYORI_YMD".
      *----------  起動ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "KIDOU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_KIDOU_ID".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  証券種別コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "SEC_SBT_CD = ".
           10  FILLER              PIC  X(13)  VALUE  ":P_SEC_SBT_CD".
      *----------  銘柄コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "MEG_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_MEG_CD".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "TATE_FLG = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_TATE_FLG".
      *----------  玉ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "GYOKU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_GYOKU_ID".
      *----------  異動計上順序
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "IDO_KJY_JUN < ".
           10  FILLER              PIC  X(14)  VALUE  ":P_IDO_KJY_JUN".
      *----------  取引事由
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "TORI_JIYU NOT ".
           10  FILLER              PIC  X(54)  VALUE
               " IN ('DMY1','DMY2','DMY3','DMY4','DMY5','DMY6','DMY7',".
           10  FILLER              PIC  X(50)  VALUE
               "'DMY8','DMY9', 'TAX ','EXLC','EXLI','EXPC','EXPI',".
           10  FILLER              PIC  X(50)  VALUE
               "'CPN ','DIVS','DVAI','INTA','INTF','RCPB','RCPS') ".
      *----------  ORDER BY
           10  FILLER              PIC  X(10)  VALUE  " ORDER BY ".
      *----------  異動計上順序  降順
           10  FILLER              PIC  X(16)  VALUE
               "IDO_KJY_JUN DESC".
      *----------  残高異動SQL文(別紙1-17)
         05  SQL-SELECT-1-17.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  取引事由
           10  FILLER              PIC  X(11)  VALUE  "TORI_JIYU, ".
      *----------  市場通貨払出単価
           10  FILLER              PIC  X(12)  VALUE  "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
           10  FILLER              PIC  X(11)  VALUE  "UYTK_H_TNK ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-17       PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  証券種別コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "SEC_SBT_CD = ".
           10  FILLER              PIC  X(13)  VALUE  ":P_SEC_SBT_CD".
      *----------  銘柄コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "MEG_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_MEG_CD".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "TATE_FLG = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_TATE_FLG".
      *----------  玉ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "GYOKU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_GYOKU_ID".
      *----------  計上基準日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(15)  VALUE  "KEIJOU_KIJUNBI>".
           10  FILLER              PIC  X(19)  VALUE
                                                  ":P_KEIJOU_KIJUNBI_K".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(16)  VALUE "KEIJOU_KIJUNBI<=".
           10  FILLER              PIC  X(19)  VALUE
                                                  ":P_KEIJOU_KIJUNBI_J".
      *----------  原取引ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "TORI_ID <> ".
           10  FILLER              PIC  X(11)  VALUE  ":P_TORI_ID ".
      *----------  取引事由
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "TORI_JIYU NOT ".
           10  FILLER              PIC  X(54)  VALUE
               " IN ('DMY1','DMY2','DMY3','DMY4','DMY5','DMY6','DMY7',".
           10  FILLER              PIC  X(50)  VALUE
               "'DMY8','DMY9', 'TAX ','EXLC','EXLI','EXPC','EXPI',".
           10  FILLER              PIC  X(50)  VALUE
               "'CPN ','DIVS','DVAI','INTA','INTF','RCPB','RCPS') ".
      *----------  ORDER BY
           10  FILLER              PIC  X(10)  VALUE  " ORDER BY ".
      *----------  計上基準日または受渡日 DESC
           10  WK-UKK-YMD          PIC  X(14).
      *----------  異動計上順序  降順
           10  FILLER              PIC  X(23)  VALUE
               " DESC, IDO_KJY_JUN DESC".
      ******************************************************************
      *                エラーメッセージ
      ******************************************************************
       01  E-MSG-TBL.
      *----------  残高履歴（TKMZZR00 別紙1-1)
         05  WK-MSG-1-1.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZZR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *----------  利用会社コード
           10  FILLER              PIC  X(21)
               VALUE  "WHERE RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  証券種別コード
           10  FILLER              PIC  X(19)
               VALUE  " AND SEC_SBT_CD = '".
           10  WK-SQL-SEC-SBT-CD   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  銘柄コード
           10  FILLER              PIC  X(15)
               VALUE  " AND MEG_CD = '".
           10  WK-SQL-MEG-CD       PIC  X(15).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  資産/負債・買建/売建フラグ
           10  FILLER              PIC  X(17)
               VALUE  " AND TATE_FLG = '".
           10  WK-SQL-TATE-FLG     PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  玉ID
           10  FILLER              PIC  X(17)
               VALUE  " AND GYOKU_ID = '".
           10  WK-SQL-GYOKU-ID     PIC  X(10).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  基準日
           10  FILLER              PIC  X(15)
               VALUE  " AND KJN_YMD = ".
           10  WK-SQL-KJN-YMD      PIC  X(10).
      *----------  決算日断面区分
           10  FILLER              PIC  X(34)
               VALUE  " AND KSN_YMD_DMN_KBN IN ('0', '2')".
      *----------  資金残履歴（TKMZSR00 別紙1-2)
         05  WK-MSG-1-2.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZSR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *----------  利用会社コード
           10  FILLER              PIC  X(21)
               VALUE  "WHERE RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  決済口座番号
           10  FILLER              PIC  X(19)
               VALUE  " AND KS_KOZA_NO = '".
           10  WK-SQL-KS-KOZA-NO   PIC  X(15).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  基準日
           10  FILLER              PIC  X(15)
               VALUE  " AND KJN_YMD = ".
           10  WK-SQL-KJN-YMD      PIC  X(10).
      *----------  決算日断面区分
           10  FILLER              PIC  X(34)
               VALUE  " AND KSN_YMD_DMN_KBN IN ('0', '2')".
      *----------  元本残高（TKMZGZ00 別紙1-12)
         05  WK-MSG-1-12.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZGZ00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *----------  利用会社コード
           10  FILLER              PIC  X(21)
               VALUE  "WHERE RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  基準日
           10  FILLER              PIC  X(15)
               VALUE  " AND KJN_YMD = ".
           10  WK-SQL-KJN-YMD      PIC  X(10).
      *----------  決算日断面区分
           10  FILLER              PIC  X(34)
               VALUE  " AND KSN_YMD_DMN_KBN IN ('0', '2')".
      *----------  未収収益（TKMZMS00 別紙1-13)
         05  WK-MSG-1-13.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZMS00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *----------  利用会社コード
           10  FILLER              PIC  X(21)
               VALUE  "WHERE RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD1 PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD1     PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD1      PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  証券種別コード
           10  FILLER              PIC  X(19)
               VALUE  " AND SEC_SBT_CD = '".
           10  WK-SQL-SEC-SBT-CD1  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  銘柄コード
           10  FILLER              PIC  X(15)
               VALUE  " AND MEG_CD = '".
           10  WK-SQL-MEG-CD1      PIC  X(15).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  資産/負債・買建/売建フラグ
           10  FILLER              PIC  X(17)
               VALUE  " AND TATE_FLG = '".
           10  WK-SQL-TATE-FLG1    PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  玉ID
           10  FILLER              PIC  X(17)
               VALUE  " AND GYOKU_ID = '".
           10  WK-SQL-GYOKU-ID1    PIC  X(10).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 適用開始日
           10  FILLER              PIC  X(20)
               VALUE  " AND TEKIYO_FROM <= ".
           10  WK-SQL-TEKIYO-FROM1 PIC  9(08).
      *---------- 権利落日
           10  FILLER              PIC  X(22)
               VALUE  " AND KENRI_OTI_YMD <= ".
           10  WK-SQL-KENRI-OTI-YMD1
                                   PIC  9(08).
      *----------  未収収益計算データ(TKMZBW08)
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW08     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *---------- 処理実行日
           10  FILLER              PIC  X(13)
               VALUE  " SYORI_YMD = ".
           10  WK-SQL-SYORI-YMD    PIC  S9(08).
      *---------- 起動ID
           10  FILLER              PIC  X(18)
               VALUE  " AND  KIDOU_ID = '".
           10  WK-SQL-KIDOU-ID     PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  利用会社コード
           10  FILLER              PIC  X(20)
               VALUE  " AND RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD2 PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD2     PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD2      PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  証券種別コード
           10  FILLER              PIC  X(19)
               VALUE  " AND SEC_SBT_CD = '".
           10  WK-SQL-SEC-SBT-CD2  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  銘柄コード
           10  FILLER              PIC  X(15)
               VALUE  " AND MEG_CD = '".
           10  WK-SQL-MEG-CD2      PIC  X(15).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  資産/負債・買建/売建フラグ
           10  FILLER              PIC  X(17)
               VALUE  " AND TATE_FLG = '".
           10  WK-SQL-TATE-FLG2    PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  玉ID
           10  FILLER              PIC  X(17)
               VALUE  " AND GYOKU_ID = '".
           10  WK-SQL-GYOKU-ID2    PIC  X(10).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 適用開始日
           10  FILLER              PIC  X(20)
               VALUE  " AND TEKIYO_FROM <= ".
           10  WK-SQL-TEKIYO-FROM2 PIC  9(08).
      *---------- 権利落日
           10  FILLER              PIC  X(22)
               VALUE  " AND KENRI_OTI_YMD <= ".
           10  WK-SQL-KENRI-OTI-YMD2
                                   PIC  9(08).
      *---------- 残高履歴計算データ（TKMZBW11 別紙1-3,別紙1-5)
         05  WK-MSG-TKMZBW11.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW11     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(12)  VALUE
               " SYORI_YMD= ".
           10  WK-SQL-SYORI-YMD    PIC  S9(08).
           10  FILLER              PIC  X(13)  VALUE
               ", KIDOU_ID= '".
           10  WK-SQL-KIDOU-ID     PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(16)  VALUE
               ", RIYO_CMP_CD= '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(12)  VALUE
               ", FUND_CD= '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(11)  VALUE
               ", PTF_CD= '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(15)  VALUE
               ", SEC_SBT_CD= '".
           10  WK-SQL-SEC-SBT-CD   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(11)  VALUE
               ", MEG_CD= '".
           10  WK-SQL-MEG-CD       PIC  X(15).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(13)  VALUE
               ", TATE_FLG= '".
           10  WK-SQL-TATE-FLG     PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(13)  VALUE
               ", GYOKU_ID= '".
           10  WK-SQL-GYOKU-ID     PIC  X(10).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(11)  VALUE
               ", KJN_YMD= ".
           10  WK-SQL-KJN-YMD      PIC  S9(08).
           10  FILLER              PIC  X(20)  VALUE
               ", KSN_YMD_DMN_KBN= '".
           10  WK-SQL-KSN-YMD-DMN-KBN
                                   PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(17)  VALUE
               ", SIJO_TUKA_CD= '".
           10  WK-SQL-SIJO-TUKA-CD PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(09)  VALUE
               ", SRYZN= ".
           10  WK-SQL-SRYZN        PIC  S9(12)V9(06).
           10  FILLER              PIC  X(15)  VALUE
               ", SJTK_BOKAZN= ".
           10  WK-SQL-SJTK-BOKAZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(15)  VALUE
               ", UYTK_BOKAZN= ".
           10  WK-SQL-UYTK-BOKAZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(17)  VALUE
               ", SJTK_BOKA_TNK= ".
           10  WK-SQL-SJTK-BOKA-TNK
                                   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(17)  VALUE
               ", UYTK_BOKA_TNK= ".
           10  WK-SQL-UYTK-BOKA-TNK
                                   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(15)  VALUE
               ", SJTK_PPAYZN= ".
           10  WK-SQL-SJTK-PPAYZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(15)  VALUE
               ", UYTK_PPAYZN= ".
           10  WK-SQL-UYTK-PPAYZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(15)  VALUE
               ", SJTK_ARECZN= ".
           10  WK-SQL-SJTK-ARECZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(15)  VALUE
               ", UYTK_ARECZN= ".
           10  WK-SQL-UYTK-ARECZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(15)  VALUE
               ", SJTK_SPAYZN= ".
           10  WK-SQL-SJTK-SPAYZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(15)  VALUE
               ", UYTK_SPAYZN= ".
           10  WK-SQL-UYTK-SPAYZN  PIC  S9(15)V9(03).
           10  FILLER              PIC  X(14)  VALUE
               ", SJTK_H_TNK= ".
           10  WK-SQL-SJTK-H-TNK   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(14)  VALUE
               ", UYTK_H_TNK= ".
           10  WK-SQL-UYTK-H-TNK   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(22)  VALUE
               ", SAME_COST_KZK_FLG= '".
           10  WK-SQL-SAME-COST-KZK-FLG
                                   PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(17)  VALUE
               ", SJTK_KEKA_RSK= ".
           10  WK-SQL-SJTK-KEKA-RSK
                                   PIC  S9(12)V9(06).
           10  FILLER              PIC  X(17)  VALUE
               ", UYTK_KEKA_RSK= ".
           10  WK-SQL-UYTK-KEKA-RSK
                                   PIC  S9(12)V9(06).
           10  FILLER              PIC  X(17)  VALUE
               ", SJTK_MS_SHEKI= ".
           10  WK-SQL-SJTK-MS-SHEKI
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(17)  VALUE
               ", UYTK_MS_SHEKI= ".
           10  WK-SQL-UYTK-MS-SHEKI
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_GENSEN_TAX= ".
           10  WK-SQL-SJTK-GENSEN-TAX
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_GENSEN_TAX= ".
           10  WK-SQL-UYTK-GENSEN-TAX
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(11)  VALUE
               ", HYK_KWS= ".
           10  WK-SQL-HYK-KWS      PIC  S9(08)V9(10).
           10  FILLER              PIC  X(20)  VALUE
               ", GENS_TAX_HYK_KWS= ".
           10  WK-SQL-GENS-TAX-HYK-KWS
                                   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(22)  VALUE
               ", FACTOR_RENDOU_KESU= ".
           10  WK-SQL-FACTOR-RENDOU-KESU
                                   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_MSSE_KJMIG= ".
           10  WK-SQL-SJTK-MSSE-KJMIG
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_MSSE_KJMIG= ".
           10  WK-SQL-UYTK-MSSE-KJMIG
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(13)  VALUE
               ", SRYZN_RIT= ".
           10  WK-SQL-SRYZN-RIT    PIC  S9(12)V9(06).
           10  FILLER              PIC  X(14)  VALUE
               ", TGYOKU_TNK= ".
           10  WK-SQL-TGYOKU-TNK   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(19)  VALUE
               ", TGYOKU_KWS_RATE= ".
           10  WK-SQL-TGYOKU-KWS-RATE
                                   PIC  S9(08)V9(10).
           10  FILLER              PIC  X(15)  VALUE
               ", TGYOKU_BRK= '".
           10  WK-SQL-TGYOKU-BRK   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(18)  VALUE
               ", TGYOKU_YKJ_YMD= ".
           10  WK-SQL-TGYOKU-YKJ-YMD
                                   PIC  S9(08).
           10  FILLER              PIC  X(18)  VALUE
               ", SJTK_TG_YJKNZN= ".
           10  WK-SQL-SJTK-TG-YJKNZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(18)  VALUE
               ", UYTK_TG_YJKNZN= ".
           10  WK-SQL-UYTK-TG-YJKNZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(17)  VALUE
               ", SJTK_TG_TSRZN= ".
           10  WK-SQL-SJTK-TG-TSRZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(17)  VALUE
               ", UYTK_TG_TSRZN= ".
           10  WK-SQL-UYTK-TG-TSRZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_TG_S_TAXZN= ".
           10  WK-SQL-SJTK-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_TG_S_TAXZN= ".
           10  WK-SQL-UYTK-TG-S-TAXZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(22)  VALUE
               ", SJTK_TG_ELS_HIYOZN= ".
           10  WK-SQL-SJTK-TG-ELS-HIYOZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(22)  VALUE
               ", UYTK_TG_ELS_HIYOZN= ".
           10  WK-SQL-UYTK-TG-ELS-HIYOZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(18)  VALUE
               ", SJTK_TG_SSKGZN= ".
           10  WK-SQL-SJTK-TG-SSKGZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(18)  VALUE
               ", UYTK_TG_SSKGZN= ".
           10  WK-SQL-UYTK-TG-SSKGZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_GSZKP_YTZN= ".
           10  WK-SQL-SJTK-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_GSZKP_YTZN= ".
           10  WK-SQL-UYTK-GSZKP-YTZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_NOCV_MSKZN= ".
           10  WK-SQL-SJTK-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_NOCV_MSKZN= ".
           10  WK-SQL-UYTK-NOCV-MSKZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_NOCV_MBKZN= ".
           10  WK-SQL-SJTK-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_NOCV_MBKZN= ".
           10  WK-SQL-UYTK-NOCV-MBKZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(23)  VALUE
               ", SHORT_STEN_KEKA_RSK= ".
           10  WK-SQL-SHORT-STEN-KEKA-RSK
                                   PIC  S9(12)V9(06).
           10  FILLER              PIC  X(19)  VALUE
               ", SHORT_START_YMD= ".
           10  WK-SQL-SHORT-START-YMD
                                   PIC  S9(08).
           10  FILLER              PIC  X(17)  VALUE
               ", SHORT_END_YMD= ".
           10  WK-SQL-SHORT-END-YMD
                                   PIC  S9(08).
           10  FILLER              PIC  X(23)  VALUE
               ", KH_KAIKEI_BASE_FLG= '".
           10  WK-SQL-KH-KAIKEI-BASE-FLG
                                   PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(16)  VALUE
               ", SAKUJO_KBN=' '".
           10  FILLER              PIC  X(18)  VALUE
               ", SK_DATE= SYSDATE".
           10  FILLER              PIC  X(20)  VALUE
               ", SK_LOGIN_CMP_CD= '".
           10  WK-SQL-SK-LOGIN-CMP-CD
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(12)  VALUE
               ", SK_SID=' '".
           10  FILLER              PIC  X(20)  VALUE
               " SK_PGMID='SMZJ2210'".
           10  FILLER              PIC  X(19)  VALUE
               ", UPD_DATE= SYSDATE".
           10  FILLER              PIC  X(21)  VALUE
               ", UPD_LOGIN_CMP_CD= '".
           10  WK-SQL-UPD-LOGIN-CMP-CD
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(13)  VALUE
               ", UPD_SID=' '".
           10  FILLER              PIC  X(23)  VALUE
               ", UPD_PGMID= 'SMZJ2210'".
      *----------  残高異動計算データ（TKMZBW06 別紙1-4)
         05  WK-MSG-1-4.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW06     PIC  X(13).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  WK-TBL-TKMZZI00     PIC  X(13).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  WK-TBL2-TKMZZI00    PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               "RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(06)  VALUE
               "' AND ".
           10  FILLER              PIC  X(11)  VALUE
               "FUND_CD = '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(06)  VALUE
               "' AND ".
           10  FILLER              PIC  X(10)  VALUE
               "PTF_CD = '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(06)  VALUE
               "' AND ".
           10  FILLER              PIC  X(14)  VALUE
               "SEC_SBT_CD = '".
           10  WK-SQL-SEC-SBT-CD   PIC  X(04).
           10  FILLER              PIC  X(06)  VALUE
               "' AND ".
           10  FILLER              PIC  X(10)  VALUE
               "MEG_CD = '".
           10  WK-SQL-MEG-CD       PIC  X(15).
           10  FILLER              PIC  X(06)  VALUE
               "' AND ".
           10  FILLER              PIC  X(12)  VALUE
               "TATE_FLG = '".
           10  WK-SQL-TATE-FLG     PIC  X(01).
           10  FILLER              PIC  X(06)  VALUE
               "' AND ".
           10  FILLER              PIC  X(12)  VALUE
               "GYOKU_ID = '".
           10  WK-SQL-GYOKU-ID     PIC  X(10).
           10  FILLER              PIC  X(06)  VALUE
               "' AND ".
           10  FILLER              PIC  X(17)  VALUE
               "KEIJOU_KIJUNBI > ".
           10  WK-SQL-KEIJOU-KIJUNBI-1
                                   PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE
               " AND ".
           10  FILLER              PIC  X(18)  VALUE
               "KEIJOU_KIJUNBI <= ".
           10  WK-SQL-KEIJOU-KIJUNBI-2
                                   PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE
               " AND ".
           10  FILLER              PIC  X(12)  VALUE
               "SYORI_YMD = ".
           10  WK-SQL-SYORI-YMD    PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE
               " AND ".
           10  FILLER              PIC  X(12)  VALUE
               "KIDOU_ID = '".
           10  WK-SQL-KIDOU-ID     PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE
               "'".
      *----------  資金残履歴計算データ（TKMZBW12 別紙1-6,別紙1-8)
         05  WK-MSG-TKMZBW12.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW12     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(12)  VALUE
               " SYORI_YMD= ".
           10  WK-SQL-SYORI-YMD    PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               ", KIDOU_ID= '".
           10  WK-SQL-KIDOU-ID     PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(16)  VALUE
               ", RIYO_CMP_CD= '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(12)  VALUE
               ", FUND_CD= '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(11)  VALUE
               ", PTF_CD= '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(15)  VALUE
               ", KS_KOZA_NO= '".
           10  WK-SQL-KS-KOZA-NO   PIC  X(15).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(11)  VALUE
               ", KJN_YMD= ".
           10  WK-SQL-KJN-YMD      PIC  S9(08).
           10  FILLER              PIC  X(20)  VALUE
               ", KSN_YMD_DMN_KBN= '".
           10  WK-SQL-KSN-YMD-DMN-KBN
                                   PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(15)  VALUE
               ", SEC_SBT_CD= '".
           10  WK-SQL-SEC-SBT-CD   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(17)  VALUE
               ", KOZA_TUKA_CD= '".
           10  WK-SQL-KOZA-TUKA-CD PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_TJT_CASHZN= ".
           10  WK-SQL-SJTK-TJT-CASHZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_TJT_CASHZN= ".
           10  WK-SQL-UYTK-TJT-CASHZN
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(22)  VALUE
               ", SJTK_TJT_MSNKZN_UM= ".
           10  WK-SQL-SJTK-TJT-MSNKZN-UM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(22)  VALUE
               ", UYTK_TJT_MSNKZN_UM= ".
           10  WK-SQL-UYTK-TJT-MSNKZN-UM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(22)  VALUE
               ", SJTK_TJT_MSNKZN_SM= ".
           10  WK-SQL-SJTK-TJT-MSNKZN-SM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(22)  VALUE
               ", UYTK_TJT_MSNKZN_SM= ".
           10  WK-SQL-UYTK-TJT-MSNKZN-SM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(21)  VALUE
               ", SJTK_TJT_MBKZN_UM= ".
           10  WK-SQL-SJTK-TJT-MBKZN-UM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(21)  VALUE
               ", UYTK_TJT_MBKZN_UM= ".
           10  WK-SQL-UYTK-TJT-MBKZN-UM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(21)  VALUE
               ", SJTK_TJT_MBKZN_SM= ".
           10  WK-SQL-SJTK-TJT-MBKZN-SM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(21)  VALUE
               ", UYTK_TJT_MBKZN_SM= ".
           10  WK-SQL-UYTK-TJT-MBKZN-SM
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(12)  VALUE
               ", BOKA_KWS= ".
           10  WK-SQL-BOKA-KWS     PIC  S9(08)V9(10).
           10  FILLER              PIC  X(17)  VALUE
               ", SJTK_MS_SHEKI= ".
           10  WK-SQL-SJTK-MS-SHEKI
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(17)  VALUE
               ", UYTK_MS_SHEKI= ".
           10  WK-SQL-UYTK-MS-SHEKI
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", SJTK_GENSEN_TAX= ".
           10  WK-SQL-SJTK-GENSEN-TAX
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ", UYTK_GENSEN_TAX= ".
           10  WK-SQL-UYTK-GENSEN-TAX
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(16)  VALUE
               ", SAKUJO_KBN=' '".
           10  FILLER              PIC  X(17)  VALUE
               ", SK_DATE=SYSDATE".
           10  FILLER              PIC  X(20)  VALUE
               ", SK_LOGIN_CMP_CD= '".
           10  WK-SQL-SK-LOGIN-CMP-CD
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(12)  VALUE
               ", SK_SID=' '".
           10  FILLER              PIC  X(21)  VALUE
               ", SK_PGMID='SMZJ2210'".
           10  FILLER              PIC  X(19)  VALUE
               ", UPD_DATE= SYSDATE".
           10  FILLER              PIC  X(21)  VALUE
               ", UPD_LOGIN_CMP_CD= '".
           10  WK-SQL-UPD-LOGIN-CMP-CD
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(13)  VALUE
               ", UPD_SID=' '".
           10  FILLER              PIC  X(23)  VALUE
               ", UPD_PGMID= 'SMZJ2210'".
           10  FILLER              PIC  X(20)  VALUE
               ", SJTK_MSSE_KJMIG = ".
           10  WK-SQL-SJTK-MSSE-KJMIG
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(19)  VALUE
               ",UYTK_MSSE_KJMIG = ".
           10  WK-SQL-UYTK-MSSE-KJMIG
                                   PIC  S9(15)V9(03).
      *----------  資金簿価異動計算データ（TKMZBW07 別紙1-7)
         05  WK-MSG-1-7.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW07     PIC  X(13).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  WK-TBL-TKMZSI00     PIC  X(13).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  WK-TBL2-TKMZBW07    PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               "RIYO-CMP-CD = '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(02)  VALUE
               "',".
           10  FILLER              PIC  X(11)  VALUE
               "FUND-CD = '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(02)  VALUE
               "',".
           10  FILLER              PIC  X(25)  VALUE
               "PTF-CD = '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(02)  VALUE
               "',".
           10  FILLER              PIC  X(14)  VALUE
               "KS-KOZA-NO = '".
           10  WK-SQL-KS-KOZA-NO   PIC  X(15).
           10  FILLER              PIC  X(02)  VALUE
               "',".
           10  FILLER              PIC  X(12)  VALUE
               "IDO-YMD-1 = ".
           10  WK-SQL-IDO-YMD-1    PIC  S9(08).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  FILLER              PIC  X(12)  VALUE
               "IDO-YMD-2 = ".
           10  WK-SQL-IDO-YMD-2    PIC  S9(08).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  FILLER              PIC  X(13)  VALUE
               "SYORI-YMD  = ".
           10  WK-SQL-SYORI-YMD    PIC  S9(08).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  FILLER              PIC  X(12)  VALUE
               "KIDOU-ID = '".
           10  WK-SQL-KIDOU-ID     PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE
               "'".
      *----------  元本残高計算データ（TKMZBW13 別紙1-9,別紙1-10)
         05  WK-MSG-TKMZBW13.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZBW13     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(12)  VALUE
               " SYORI_YMD= ".
           10  WK-SQL-SYORI-YMD    PIC  S9(08).
           10  FILLER              PIC  X(13)  VALUE
               ", KIDOU_ID= '".
           10  WK-SQL-KIDOU-ID     PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(16)  VALUE
               ", RIYO_CMP_CD= '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(12)  VALUE
               ", FUND_CD= '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(11)  VALUE
               ", PTF_CD= '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(11)  VALUE
               ", KJN_YMD= ".
           10  WK-SQL-KJN-YMD      PIC  S9(08).
           10  FILLER              PIC  X(20)  VALUE
               ", KSN_YMD_DMN_KBN= '".
           10  WK-SQL-KSN-YMD-DMN-KBN
                                   PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(13)  VALUE
               ", GNP_SRYZN= ".
           10  WK-SQL-GNP-SRYZN    PIC  S9(12)V9(06).
           10  FILLER              PIC  X(14)  VALUE
               ", GNP_BOKAZN= ".
           10  WK-SQL-GNP-BOKAZN   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(13)  VALUE
               ", SO_TN_KGK= ".
           10  WK-SQL-SO-TN-KGK    PIC  S9(15)V9(03).
           10  FILLER              PIC  X(17)  VALUE
               ", SHOKI_SET_KGK= ".
           10  WK-SQL-SHOKI-SET-KGK
                                   PIC  S9(15)V9(03).
           10  FILLER              PIC  X(16)  VALUE
               ", SAKUJO_KBN=' '".
           10  FILLER              PIC  X(17)  VALUE
               ", SK_DATE=SYSDATE".
           10  FILLER              PIC  X(20)  VALUE
               ", SK_LOGIN_CMP_CD= '".
           10  WK-SQL-SK-LOGIN-CMP-CD
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(12)  VALUE
               ", SK_SID=' '".
           10  FILLER              PIC  X(20)  VALUE
               " SK_PGMID='SMZJ2210'".
           10  FILLER              PIC  X(19)  VALUE
               ", UPD_DATE= SYSDATE".
           10  FILLER              PIC  X(21)  VALUE
               ", UPD_LOGIN_CMP_CD= '".
           10  WK-SQL-UPD-LOGIN-CMP-CD
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
           10  FILLER              PIC  X(13)  VALUE
               ", UPD_SID=' '".
           10  FILLER              PIC  X(23)  VALUE
               ", UPD_PGMID= 'SMZJ2210'".
      *----------  残高履歴更新（TKMZKR00,TKMZMS00 別紙1-14)
         05  WK-MSG-1-14.
      *----------  未収収益（TKMZMS00）
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZMS00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *----------  利用会社コード
           10  FILLER              PIC  X(21)
               VALUE  "WHERE RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD1
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD1     PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD1      PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 証券種別コード
           10  FILLER              PIC  X(19)
               VALUE  " AND SEC_SBT_CD = '".
           10  WK-SQL-SEC-SBT-CD1  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 銘柄コード
           10  FILLER              PIC  X(15)
               VALUE  " AND MEG_CD = '".
           10  WK-SQL-MEG-CD1      PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 資産負債・買建売建フラグ
           10  FILLER              PIC  X(17)
               VALUE  " AND TATE_FLG = '".
           10  WK-SQL-TATE-FLG1    PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 玉ＩＤ
           10  FILLER              PIC  X(17)
               VALUE  " AND GYOKU_ID = '".
           10  WK-SQL-GYOKU-ID1    PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 銘柄種類２
           10  FILLER              PIC  X(05)
               VALUE  " AND ".
           10  WK-SQL-MEG-CD-SHRU2-1
                                   PIC  X(04).
           10  FILLER              PIC  X(07)
               VALUE  " <> '2'".
      *---------- 適用開始日
           10  FILLER              PIC  X(26)
               VALUE  " AND (TEKIYO_FROM BETWEEN ".
           10  WK-SQL-KAISI-KJN-YMD-NEXT1
                                   PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  WK-SQL-KJN-YMD1     PIC  S9(08).
           10  FILLER              PIC  X(01)  VALUE  ")".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  WK-SQL-S-TSHKKUNI1
                                   PIC  X(08).
           10  FILLER              PIC  X(07)  VALUE  " <> ' '".
      *----------  債券過去経過利息（TKMZKR00）
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL-TKMZKR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *----------  利用会社コード
           10  FILLER              PIC  X(21)
               VALUE  "WHERE RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD2
                                   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD2     PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD2      PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 証券種別コード
           10  FILLER              PIC  X(19)
               VALUE  " AND SEC_SBT_CD = '".
           10  WK-SQL-SEC-SBT-CD2  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 銘柄コード
           10  FILLER              PIC  X(15)
               VALUE  " AND MEG_CD = '".
           10  WK-SQL-MEG-CD2      PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 資産負債・買建売建フラグ
           10  FILLER              PIC  X(17)
               VALUE  " AND TATE_FLG = '".
           10  WK-SQL-TATE-FLG2    PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 玉ＩＤ
           10  FILLER              PIC  X(17)
               VALUE  " AND GYOKU_ID = '".
           10  WK-SQL-GYOKU-ID2    PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *---------- 銘柄種類２
           10  FILLER              PIC  X(05)
               VALUE  " AND ".
           10  WK-SQL-MEG-CD-SHRU2-2
                                   PIC  X(04).
           10  FILLER              PIC  X(06)
               VALUE  " = '2'".
      *---------- 適用開始日
           10  FILLER              PIC  X(26)
               VALUE  " AND (TEKIYO_FROM BETWEEN ".
           10  WK-SQL-KAISI-KJN-YMD-NEXT2
                                   PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  WK-SQL-KJN-YMD2     PIC  S9(08).
           10  FILLER              PIC  X(01)  VALUE  ")".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  WK-SQL-S-TSHKKUNI2
                                   PIC  X(08).
           10  FILLER              PIC  X(07)  VALUE  " <> ' '".
      *----------  残高履歴計算データ（TKMZBW11 別紙1-15)
         05  WK-MSG-1-15.
      *----------  残高履歴計算データ（TKMZBW11）
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TBL1-TKMZBW11    PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *----------  利用会社コード
           10  FILLER              PIC  X(21)
               VALUE  "WHERE RIYO_CMP_CD = '".
           10  WK-SQL-RIYO-CMP-CD  PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  処理実行日
           10  FILLER              PIC  X(17)
               VALUE  " AND SYORI_YMD = ".
           10  WK-SQL-SYORI-YMD    PIC  S9(08).
      *----------  起動ID
           10  FILLER              PIC  X(17)
               VALUE  " AND KIDOU_ID = '".
           10  WK-SQL-KIDOU-ID     PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ファンドコード
           10  FILLER              PIC  X(16)
               VALUE  " AND FUND_CD = '".
           10  WK-SQL-FUND-CD      PIC  X(12).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(15)
               VALUE  " AND PTF_CD = '".
           10  WK-SQL-PTF-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  証券種別コード
           10  FILLER              PIC  X(19)
               VALUE  " AND SEC_SBT_CD = '".
           10  WK-SQL-SEC-SBT-CD   PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  銘柄コード
           10  FILLER              PIC  X(15)
               VALUE  " AND MEG_CD = '".
           10  WK-SQL-MEG-CD       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  資産/負債・買建/売建フラグ
           10  FILLER              PIC  X(17)
               VALUE  " AND TATE_FLG = '".
           10  WK-SQL-TATE-FLG     PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  玉ID
           10  FILLER              PIC  X(17)
               VALUE  " AND GYOKU_ID = '".
           10  WK-SQL-GYOKU-ID     PIC  X(10).
           10  FILLER              PIC  X(01)  VALUE  "'".
      *----------  基準日
           10  FILLER              PIC  X(15)
               VALUE  " AND KJN_YMD = ".
           10  WK-SQL-KJN-YMD      PIC  X(10).
      *---------- SELECT SQL文(別紙1-16)
         05  WK-MSG-1-16.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZBW06     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD1     PIC  X(04).
           10  FILLER              PIC  X(18)  VALUE
               "' AND SYORI_YMD = ".
           10  WK-SYORI-YMD1       PIC  9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID1        PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD1         PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD1          PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC_SBT_CD ='".
           10  WK-SEC-SBT-CD1      PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND MEG_CD ='".
           10  WK-MEG-CD1          PIC  X(15).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG1        PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID1        PIC  X(10).
           10  FILLER              PIC  X(19)  VALUE
               " AND IDO-KJY-JUN < ".
           10  WK-IDO-KJY-JUN1     PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "TORI_JIYU NOT ".
           10  FILLER              PIC  X(54)  VALUE
               " IN ('DMY1','DMY2','DMY3','DMY4','DMY5','DMY6','DMY7',".
           10  FILLER              PIC  X(50)  VALUE
               "'DMY8','DMY9', 'TAX ','EXLC','EXLI','EXPC','EXPI',".
           10  FILLER              PIC  X(50)  VALUE
               "'CPN ','DIVS','DVAI','INTA','INTF','RCPB','RCPS') ".
      *---------- SELECT SQL文(別紙1-17)
         05  WK-MSG-1-17.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZBW06     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD1     PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD1         PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD1          PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC_SBT_CD ='".
           10  WK-SEC-SBT-CD1      PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND MEG_CD ='".
           10  WK-MEG-CD1          PIC  X(15).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG1        PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID1        PIC  X(10).
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(15)  VALUE  "KEIJOU_KIJUNBI>".
           10  WK-KEIJOU-KIJUNBI-K PIC  9(08).
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(16)  VALUE "KEIJOU_KIJUNBI<=".
           10  WK-KEIJOU-KIJUNBI-J PIC  9(08).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TORI_ID <>'".
           10  WK-TORI-ID1         PIC  S9(10).
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "TORI_JIYU NOT ".
           10  FILLER              PIC  X(54)  VALUE
               " IN ('DMY1','DMY2','DMY3','DMY4','DMY5','DMY6','DMY7',".
           10  FILLER              PIC  X(50)  VALUE
               "'DMY8','DMY9', 'TAX ','EXLC','EXLI','EXPC','EXPI',".
           10  FILLER              PIC  X(50)  VALUE
               "'CPN ','DIVS','DVAI','INTA','INTF','RCPB','RCPS') ".
      ******************************************************************
      *        連絡節
      ******************************************************************
       LINKAGE                SECTION.
       01  PARM-SMZJ2210-INOUT.
           COPY  "SMZJ2210.cpy".
       01  PARM-SMZJ2210-RTNPKG.
      *----------  RTNパッケージ
         05  PARM-SMZJ2210-ARG3.
           COPY  "CZRTNPACKAGE.cpy".
      ******************************************************************
      *
      *    PROCEDURE              DIVISION
      *
      ******************************************************************
       PROCEDURE              DIVISION
           USING  PARM-SMZJ2210-INOUT
                  PARM-SMZJ2210-RTNPKG.
      ******************************************************************
      *               銘柄別残高計算
      ******************************************************************
       BASE-RTN               SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ◇◆◇SMZJ2210  START◇◆◇  ***"
      *-----------------------------------------------------------------
      *----------   3.1 前処理
           PERFORM  INIT-RTN
      *----------   3.2 主処理
           PERFORM  MAIN-RTN
      *----------   3.3 後処理
           PERFORM  END-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ◇◆◇SMZJ2210  END◇◆◇  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       BASE-EXT.
           GOBACK.
      ******************************************************************
      *     3.1 前処理
      ******************************************************************
       INIT-RTN               SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  前処理  START  ***"
      *-----------------------------------------------------------------
      *----------   3.1.1 初期化処理
           PERFORM  INITIALIZE-RTN
      *----------   3.1.2 テーブルID取得処理
           PERFORM  TBL-ID-GET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  前処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       INIT-EXT.
           EXIT.
      ******************************************************************
      *     3.1.1 初期化処理
      ******************************************************************
       INITIALIZE-RTN         SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  初期化処理 START  ***"
      *-----------------------------------------------------------------
      *----------  初期化
           INITIALIZE  HST-AREA
                       FLG-AREA
                       WORK-AREA
                       SQL-AREA
                       E-MSG-TBL
                       PARM-SCZY1170-IN
                       PARM-SCZY1170-RTNPKG
                       PARM-SCZY1160-INOUT
                       PARM-SMZC9201-INOUT
                       PARM-SMZJ4012-INOUT
                       PARM-SMZJ4014-INOUT
                       PARM-RTNPKG
                       PARM-SMZJ2210-ARG2
                       PARM-SMZJ2210-ARG3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":FIRST-SW = ["FIRST-SW"]"
      *-----------------------------------------------------------------
      *----初回コール時のみFLAG-AREAを初期化する                        @3212SEINO@@
           IF  FIRST-SW = 'YES'                                         @3212SEINO@@
           THEN                                                         @3212SEINO@@
             INITIALIZE  FLG-AREA-CR                                    @3212SEINO@@
             MOVE  'NO '                TO  FIRST-SW                    @3212SEINO@@
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":FIRST-SW = ["FIRST-SW"]"
      D    DISPLAY  CNS-PGM-ID ":FLG-AREA-CR = ["FLG-AREA-CR"]"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":HST-AREA = ["HST-AREA"]"
      D    DISPLAY  CNS-PGM-ID ":FLG-AREA = ["FLG-AREA"]"
      D    DISPLAY  CNS-PGM-ID ":WORK-AREA= ["WORK-AREA"]"
      D    DISPLAY  CNS-PGM-ID ":SQL-AREA = ["SQL-AREA"]"
      D    DISPLAY  CNS-PGM-ID ":E-MSG-TBL =["E-MSG-TBL"]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SCZY1170-IN= ["
      D             PARM-SCZY1170-IN"]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SCZY1170-RTNPKG= ["
      D             PARM-SCZY1170-RTNPKG "]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SCZY1160-INOUT= ["
      D             PARM-SCZY1160-INOUT "]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SMZC9201-INOUT= ["
      D             PARM-SMZC9201-INOUT "]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SMZJ4012-INOUT= ["
      D             PARM-SMZJ4012-INOUT "]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SMZJ4014-INOUT= ["
      D             PARM-SMZJ4014-INOUT "]"
      D    DISPLAY  CNS-PGM-ID ":PARM-RTNPKG= ["
      D             PARM-RTNPKG "]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SMZJ2210-ARG2  = ["
      D             PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID ":PARM-SMZJ2210-ARG3  = ["
      D             PARM-SMZJ2210-ARG3"]"
      *-----------------------------------------------------------------
           MOVE  CNS-RTN-000
             TO  RTN-CD                  OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY CNS-PGM-ID":RTN-CD    OF  PARM-SCZY1170-ARG1=["
      D                        RTN-CD    OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *---------- 基準日断面情報.処理実行日
           MOVE  SYORI-YMD               OF  TKMZBW02-PARM
             TO  WK-SYORI-YMD
      *---------- 基準日断面情報.起動ID
           MOVE  KIDOU-ID                OF  TKMZBW02-PARM
             TO  WK-KIDOU-ID
      *---------- 基準日断面情報.基本会計ベースフラグ
           MOVE  KH-KAIKEI-BASE-FLG      OF  TKMZBW02-PARM
             TO  WK-KH-KAIKEI-BASE-FLG
      *----------  銘柄別断面情報.利用会社コード
           MOVE  RIYO-CMP-CD             OF  TKMZBW03-PARM
             TO  WK-RIYO-CMP-CD
      *----------  銘柄別断面情報.ファンドコード
           MOVE  FUND-CD                 OF  TKMZBW03-PARM
             TO  WK-FUND-CD
      *----------  銘柄別断面情報.ポートフォリオコード
           MOVE  PTF-CD                  OF  TKMZBW03-PARM
             TO  WK-PTF-CD
      *----------  銘柄別断面情報.証券種別コード
           MOVE  SEC-SBT-CD              OF  TKMZBW03-PARM
             TO  WK-SEC-SBT-CD
      *----------  銘柄別断面情報.銘柄コード
           MOVE  MEG-CD                  OF  TKMZBW03-PARM
             TO  WK-MEG-CD
      *----------  銘柄別断面情報.資産負債・買建売建フラグ
           MOVE  TATE-FLG                OF  TKMZBW03-PARM
             TO  WK-TATE-FLG
      *----------  銘柄別断面情報.玉ID
           MOVE  GYOKU-ID                OF  TKMZBW03-PARM
             TO  WK-GYOKU-ID
      *----------  銘柄別断面情報.開始基準日
           MOVE  KAISI-KJN-YMD           OF  TKMZBW03-PARM
             TO  WK-KAISI-KJN-YMD
      *----------  銘柄別断面情報.基準日
           MOVE  KJN-YMD                 OF  TKMZBW03-PARM
             TO  WK-KJN-YMD
      *----------  銘柄別断面情報.銘柄種類
           MOVE  MEG-CD-SHRU             OF  TKMZBW03-PARM
             TO  WK-MEG-CD-SHRU
      *----------  銘柄別断面情報.再計算区分
           MOVE  SAI-CALC-KBN            OF  TKMZBW03-PARM
             TO  WK-SAI-CALC-KBN
      *----------  銘柄別断面情報.差分更新FROM日
           MOVE  SABON-UPDATE-FROM       OF  TKMZBW03-PARM
             TO  WK-SABON-UPDATE-FROM
      *----------  異動計算パターン.処理順序
           MOVE  SYRI-JUN                OF  IDO-CALC-PARM
             TO  WK-SYRI-JUN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.利用会社コード= ["
      D             RIYO-CMP-CD          OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.ファンドコード= ["
      D             FUND-CD              OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.ポートフォリオコード=["
      D             PTF-CD               OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.基準日= ["
      D             KJN-YMD              OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.処理実行日= ["
      D             WK-SYORI-YMD"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.起動ID= ["
      D             WK-KIDOU-ID"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.基準日種類 = ["
      D             KJN-YMD-SHRU         OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.基本会計ベースフラグ=["
      D             WK-KH-KAIKEI-BASE-FLG"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.基準日断面作成区分=["
      D             KJN-YMD-DMN-SK-KBN   OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.開始基準日の翌日=["
      D             KAISI-KJN-YMD-NEXT   OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報."
      D                                       "仕訳基準パターンコード=["
      D             SKJN-PTN-CD   OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.利用会社コード= ["
      D             WK-RIYO-CMP-CD"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.ファンドコード= ["
      D             WK-FUND-CD"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.ポートフォリオコード=["
      D             WK-PTF-CD"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.処理実行日= ["
      D             SYORI-YMD     OF  TKMZBW03-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.起動ID=["
      D             KIDOU-ID      OF  TKMZBW03-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.開始基準日=["
      D             WK-KAISI-KJN-YMD"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.基準日=["
      D             WK-KJN-YMD"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.銘柄コード=["
      D             WK-MEG-CD"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.資産負債・買建"
      D             "売建フラグ=["WK-TATE-FLG"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.玉ID=["
      D             WK-GYOKU-ID"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.銘柄種類=["
      D             WK-MEG-CD-SHRU"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.銘柄種類2=["
      D             MEG-CD-SHRU2                   OF  TKMZBW03-PARM"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.差分更新FROM日=["
      D             WK-SABON-UPDATE-FROM"]"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.市場通貨コード=["
      D             SIJO-TUKA-CD                   OF  TKMZBW03-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.決算日断面区分=["
      D             KSN-YMD-DMN-KBN                OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨コード=["
      D             SIJO-TUKA-CD                   OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.数量残高=["
      D             SRYZN                          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.簿価為替レート=["
      D             BOKA-KWS                       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨簿価残高=["
      D             SJTK-BOKAZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨簿価残高=["
      D             UYTK-BOKAZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨簿価単価=["
      D             SJTK-BOKA-TNK                  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨簿価単価=["
      D             UYTK-BOKA-TNK                  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨前払金残=["
      D             SJTK-PPAYZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨前払金残=["
      D             UYTK-PPAYZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨前受金残=["
      D             SJTK-ARECZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨前受金残=["
      D             UYTK-ARECZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨仮払金残=["
      D             SJTK-SPAYZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨仮払金残=["
      D             UYTK-SPAYZN                    OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨払出単価=["
      D             SJTK-H-TNK                     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨払出単価=["
      D             UYTK-H-TNK                     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":開始時残高履歴情報.同一コスト継続フラグ=["
      D             SAME-COST-KZK-FLG              OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨未収収益計"
      D             "上・戻入額=[" SJTK-MSSE-KJMIG OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨未収収益計"
      D             "上・戻入額=[" UYTK-MSSE-KJMIG OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.数量残高（利付)=["
      D             SRYZN-RIT                      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.建玉単価=["
      D             TGYOKU-TNK                     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.建玉為替レート=["
      D             TGYOKU-KWS-RATE                OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.建玉ブローカー=["
      D             TGYOKU-BRK                     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.建玉約定日=["
      D             TGYOKU-YKJ-YMD                 OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨建玉約定"
      D             "金額残=["SJTK-TG-YJKNZN       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨建玉約定"
      D             "金額残=["UYTK-TG-YJKNZN       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨建玉手数"
      D             "料残=["SJTK-TG-TSRZN          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨建玉手数"
      D             "料残=["UYTK-TG-TSRZN          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨建玉消費"
      D             "税残=["SJTK-TG-S-TAXZN        OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨建玉消費"
      D             "税残=["UYTK-TG-S-TAXZN        OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨建玉その他"
      D             "費用残=["SJTK-TG-ELS-HIYOZN   OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨建玉その他"
      D             "費用残=["UYTK-TG-ELS-HIYOZN   OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨建玉精算金"
      D             "額残=["SJTK-TG-SSKGZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨建玉精算金"
      D             "額残=["UYTK-TG-SSKGZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報."
      D             "OP資産負債・買建売建フラグ"
      D             "    =["OP-TATE-FLG            OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨源泉税還付"
      D             "予定額残高=["SJTK-GSZKP-YTZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨源泉税還付"
      D             "予定額残高=["UYTK-GSZKP-YTZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.決済通貨源泉税還付"
      D             "予定額残高=["KSTK-GSZKP-YTZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨ノンカバー"
      D             "未収金残高=["SJTK-NOCV-MSKZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨ノンカバー"
      D             "未収金残高=["UYTK-NOCV-MSKZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨ノンカバー"
      D             "未払金残高=["SJTK-NOCV-MBKZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨ノンカバー"
      D             "未払金残高=["UYTK-NOCV-MBKZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.短期スタート・エンド"
      D             "経過利息=["SHORT-STEN-KEKA-RSK OF TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.短期スタート日=["
      D             SHORT-START-YMD                OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.短期エンド日=["
      D             SHORT-END-YMD                  OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.基本会計ベースフラ"
      D             "グ=["KH-KAIKEI-BASE-FLG       OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.投資対象国コード=["
      D             TSTSK-CD                       OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.発行国コード=["
      D             HAKO-CD                        OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.数量単位=["
      D             SURYO-TANI                     OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨未払"
      D             "費用残=["SJTK-MBHYZN          OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨未払"
      D             "費用残=["UYTK-MBHYZN          OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨未払"
      D             "消費税残=["SJTK-MB-S-TAXZN    OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨未払"
      D             "消費税残=["UYTK-MB-S-TAXZN    OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨移管評価"
      D             "損益残=["SJTK-IK-HKSEZN       OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨移管評価"
      D             "損益残=["UYTK-IK-HKSEZN       OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.市場通貨移管未収"
      D             "収益=["SJTK-IK-MSSHEKI        OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨移管未収"
      D             "収益=["UYTK-IK-MSSHEKI        OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.運用通貨移管前"
      D    "払金評価損益残=["UYTK-IK-PPHKZN        OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時残高履歴情報.削除区分=["
      D             SAKUJO-KBN                     OF  TKMZZR00-PARM "]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.決算日断面区分=["
      D             KSN-YMD-DMN-KBN                OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.証券種別コード=["
      D             SEC-SBT-CD                     OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.決済口座通貨コー"
      D             "ド=["KOZA-TUKA-CD             OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.簿価為替レート"
      D             "=["BOKA-KWS                   OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.市場通貨当日CASH"
      D             "残高=["SJTK-TJT-CASHZN        OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.運用通貨当日CASH"
      D             "残高=["UYTK-TJT-CASHZN        OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.市場通貨当日未収"
      D             "入金残高（内物）=["
      D             SJTK-TJT-MSNKZN-UM             OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.運用通貨当日未収"
      D             "入金残高（内物）=["
      D             UYTK-TJT-MSNKZN-UM             OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.市場通貨当日未収"
      D             "入金残高（外物）=["
      D             SJTK-TJT-MSNKZN-SM             OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.運用通貨当日未収"
      D             "入金残高（外物）=["
      D             UYTK-TJT-MSNKZN-SM             OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.市場通貨当日未払"
      D             "金残高（内物）=["
      D             SJTK-TJT-MBKZN-UM              OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.運用通貨当日未払"
      D             "金残高（内物）=["
      D             UYTK-TJT-MBKZN-UM              OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.市場通貨当日未払"
      D             "金残高（外物）=["
      D             SJTK-TJT-MBKZN-SM              OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時資金残履歴情報.運用通貨当日未払"
      D             "金残高（外物）=["
      D             UYTK-TJT-MBKZN-SM              OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG                OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG                OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時元本残高情報.決算日断面区分=["
      D             KSN-YMD-DMN-KBN                OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時元本残高情報.元本数量残高=["
      D             GNP-SRYZN                      OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時元本残高情報.元本簿価残高=["
      D             GNP-BOKAZN                     OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時元本残高情報.総投入金額=["
      D             SO-TN-KGK                      OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":開始時元本残高情報.初期設定金額=["
      D             SHOKI-SET-KGK                  OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":異動計算パターン.売り続く限り同一コス"
      D             "ト=["URI-TUDUKU-SAME-COST     OF IDO-CALC-PARM"]"
      D    DISPLAY  CNS-PGM-ID ":異動計算パターン.処理順序=["
      D             WK-SYRI-JUN"]"
      D    DISPLAY  CNS-PGM-ID ":基準日の経過利息データ.市場通貨経過"
      D             "利息=["SJTK-KEKA-RSK   OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID ":基準日の経過利息データ.運用通貨経過"
      D             "利息=["UYTK-KEKA-RSK   OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID ":基準日の経過利息データ.市場通貨未収"
      D             "収益=["SJTK-MS-SHEKI   OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID ":基準日の経過利息データ.運用通貨未収"
      D             "収益=["UYTK-MS-SHEKI   OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.市場通貨源泉税=["
      D             SJTK-GENSEN-TAX         OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.運用通貨源泉税=["
      D             UYTK-GENSEN-TAX         OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.評価為替レート=["
      D             HYK-KWS                 OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.源泉税評価為替"
      D             "レート=["
      D             GENS-TAX-HYK-KWS        OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID ":基準日の経過利息データ.ファクター・"
      D             "連動係数=["
      D             FACTOR-RENDOU-KESU      OF  KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID ":決算前の未収収益計上."
      D    DISPLAY  CNS-PGM-ID ":市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  KESSAN-ZE-M-RSK-KJY"]"
      D    DISPLAY  CNS-PGM-ID ":運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  KESSAN-ZE-M-RSK-KJY"]"
      D    DISPLAY  CNS-PGM-ID ":決算後の未収収益計上."
      D    DISPLAY  CNS-PGM-ID ":市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  KESSAN-GO-M-RSK-KJY"]"
      D    DISPLAY  CNS-PGM-ID ":運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  KESSAN-GO-M-RSK-KJY"]"
      D    DISPLAY  CNS-PGM-ID ":未収配当計算コールフラグ=["
      D             KEISAN-FLG1             OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":債券過去経過利息計算コールフラグ=["
      D             KEISAN-FLG2             OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":その他未収配当計算コールフラグ=["
      D             KEISAN-FLG3             OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":再計算数量単位=["
      D             SAIKS-SURYO-TANI        OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":跨ぎ市場通貨前払金異動額集計=["
      D             MATAGI-SJTK-PPAYIDOG    OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":跨ぎ運用通貨前払金異動額集計=["
      D             MATAGI-UYTK-PPAYIDOG    OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":約定ベース受渡順フラグ      =["
      D             YKJ-UKE-JUN-FLG         OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":欠落断面有無フラグ=["
      D             LACK-DMN-FLG            OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":投資対象国コード=["
      D             TSTSK-CD-IN             OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":発行国コード=["
      D             HAKO-CD-IN              OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ":取引存在フラグ=["                      @3212SEINO@@
      D             TRHK-SONZAI-FLG         OF  PARM-SMZJ2210-ARG1"]"   @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":差分更新モード取得ルート区分=["        @3212SEINO@@
      D             SABON-UPDATE-KBN        OF  PARM-SMZJ2210-ARG1"]"   @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID"****  初期化処理  END  ****"
      *-----------------------------------------------------------------
           CONTINUE.
       INITIALIZE-EXT.
           EXIT.
      ******************************************************************
      *    3.1.2 テーブルID取得処理
      ******************************************************************
       TBL-ID-GET-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  テーブルID取得  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-RTNPKG
                       PARM-SCZY1160-INOUT
      *----------利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  RIYO-CMP-CD             OF  PARM-SCZY1160-ARG1
      *----------  未収収益計算データ
           MOVE  CNS-TBL-TKMZBW08
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(1)
      *----------  未収収益
           MOVE  CNS-TBL-TKMZMS00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(2)
      *----------  残高履歴計算データ
           MOVE  CNS-TBL-TKMZBW11
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(3)
      *----------  残高異動計算データ
           MOVE  CNS-TBL-TKMZBW06
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(4)
      *----------  資金残履歴計算データ
           MOVE  CNS-TBL-TKMZBW12
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(5)
      *----------  資金簿価異動計算データ
           MOVE  CNS-TBL-TKMZBW07
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(6)
      *----------  元本残高計算データ
           MOVE  CNS-TBL-TKMZBW13
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(7)
      *----------  基準日断面情報
           MOVE  CNS-TBL-TKMZBW02
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(8)
      *----------  残高履歴
           MOVE  CNS-TBL-TKMZZR00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(9)
      *----------  資金残履歴
           MOVE  CNS-TBL-TKMZSR00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(10)
      *----------  元本残高
           MOVE  CNS-TBL-TKMZGZ00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(11)
      *----------  残高異動
           MOVE  CNS-TBL-TKMZZI00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(12)
      *----------  資金簿価異動
           MOVE  CNS-TBL-TKMZSI00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(13)
      *----------  債券過去経過利息
           MOVE  CNS-TBL-TKMZKR00
             TO  TBL-ID                  OF  PARM-SCZY1160-ARG1(14)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード =["
      D             RIYO-CMP-CD          OF PARM-SCZY1160-ARG1 "]"
      D    DISPLAY  CNS-PGM-ID ":未収収益計算データ  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(1) "]"
      D    DISPLAY  CNS-PGM-ID ":未収収益  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(2) "]"
      D    DISPLAY  CNS-PGM-ID ":残高履歴計算データ  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(3) "]"
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データ  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(4) "]"
      D    DISPLAY  CNS-PGM-ID ":資金残履歴計算データ  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(5) "]"
      D    DISPLAY  CNS-PGM-ID ":資金簿価異動計算データ  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(6) "]"
      D    DISPLAY  CNS-PGM-ID ":元本残高計算データ  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(7) "]"
      D    DISPLAY  CNS-PGM-ID ":基準日断面情報  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(8) "]"
      D    DISPLAY  CNS-PGM-ID ":残高履歴  =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(9) "]"
      D    DISPLAY  CNS-PGM-ID ":資金残履歴 =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(10)"]"
      D    DISPLAY  CNS-PGM-ID ":元本残高 =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(11)"]"
      D    DISPLAY  CNS-PGM-ID ":残高異動 =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(12)"]"
      D    DISPLAY  CNS-PGM-ID ":資金簿価異動 =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(13)"]"
      D    DISPLAY  CNS-PGM-ID ":債券過去経過利息 =["
      D             TBL-ID               OF PARM-SCZY1160-ARG1(14)"]"
      *-----------------------------------------------------------------
           CALL   "SCZY1160"           USING  PARM-SCZY1160-INOUT
                                              PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID ":PARM-RTNPKG=[" PARM-RTNPKG "]"
      D    DISPLAY  CNS-PGM-ID ":RTN-CD(SCZY1160)=["
      D             RTN-CD OF PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG) "]"
      D    DISPLAY  CNS-PGM-ID ":COUNTER OF  PARM-RTNPKG=["
      D             COUNTER              OF  PARM-RTNPKG "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *--------------------------------<DEBUG>--------------------------
      D    DISPLAY  CNS-PGM-ID ":*****  テーブルID取得  正常 *****"
      *-----------------------------------------------------------------
      *----------  未収収益計算データ
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(1)
               TO  SQL-TKMZBW08-1,
                   SQL-TKMZBW08-2,
                   WK-TBL-TKMZBW08
      *----------  未収収益
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(2)
               TO  SQL-TKMZMS00-1-1,
                   SQL-TKMZMS00-1-2,
                   SQL-TKMZMS00-2-1,
                   SQL-TKMZMS00-2-2,
                   SQL-TKMZMS00-1,
                   SQL-TKMZMS00-2,
                   WK-TBL-TKMZMS00       OF  WK-MSG-1-13,
                   SQL-TBL-TKMZMS00,
                   WK-TBL-TKMZMS00       OF  WK-MSG-1-14
      *----------  残高履歴計算データ
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(3)
               TO  SQL-TBL-TKMZBW11,
                   WK-TBL-TKMZBW11,
                   SQL-TBL1-TKMZBW11,
                   WK-TBL1-TKMZBW11
      *----------  残高異動計算データ
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(4)
               TO  SQL-TBL-TKMZBW06,
                   WK-TBL-TKMZBW06
      *----------  資金残履歴計算データ
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(5)
               TO  SQL-TBL-TKMZBW12,
                   WK-TBL-TKMZBW12
      *----------  資金簿価異動計算データ
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(6)
               TO  SQL-TBL-TKMZBW07,
                   WK-TBL-TKMZBW07,
                   WK-TBL2-TKMZBW07
      *----------  元本残高計算データ
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(7)
               TO  SQL-TBL-TKMZBW13,
                   WK-TBL-TKMZBW13
      *----------  残高履歴
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(9)
               TO  SQL-TBL-TKMZZR00,
                   WK-TBL-TKMZZR00
      *----------  資金残履歴
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(10)
               TO  SQL-TBL-TKMZSR00,
                   WK-TBL-TKMZSR00
      *----------  元本残高
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(11)
               TO  SQL-TBL-TKMZGZ00,
                   WK-TBL-TKMZGZ00
      *----------  残高異動
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(12)
               TO  SQL-TBL-TKMZZI00,
                   SQL-TBL2-TKMZZI00,
                   WK-TBL-TKMZZI00,
                   WK-TBL2-TKMZZI00
      *----------  資金簿価異動
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(13)
               TO  SQL-TBL-TKMZSI00,
                   WK-TBL-TKMZSI00
      *----------  債券過去経過利息
             MOVE  HENSYUGO-TBL-ID       OF  PARM-SCZY1160-ARG2(14)
               TO  SQL-TBL-TKMZKR00,
                   WK-TBL-TKMZKR00
      *--------------------------------<DEBUG>--------------------------
      D    DISPLAY  CNS-PGM-ID ":未収収益計算データ =["
      D             SQL-TKMZBW08-1"]"
      D    DISPLAY  CNS-PGM-ID ":未収収益 =["
      D             SQL-TKMZMS00-1"]"
      D    DISPLAY  CNS-PGM-ID ":残高履歴計算データ =["
      D             SQL-TBL-TKMZBW11"]"
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データ =["
      D             SQL-TBL-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID ":資金残履歴計算データ =["
      D             SQL-TBL-TKMZBW12"]"
      D    DISPLAY  CNS-PGM-ID ":資金簿価異動計算データ =["
      D             SQL-TBL-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID ":元本残高計算データ =["
      D             SQL-TBL-TKMZBW13"]"
      D    DISPLAY  CNS-PGM-ID ":残高履歴 =["
      D             SQL-TBL-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID ":資金残履歴 =["
      D             SQL-TBL-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID ":元本残高 =["
      D             SQL-TBL-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID ":残高異動 =["
      D             SQL-TBL-TKMZZI00"]"
      D    DISPLAY  CNS-PGM-ID ":資金簿価異動 =["
      D             SQL-TBL-TKMZSI00"]"
      D    DISPLAY  CNS-PGM-ID ":未収収益 =["
      D             SQL-TBL-TKMZMS00"]"
      D    DISPLAY  CNS-PGM-ID ":債券過去経過利息 =["
      D             SQL-TBL-TKMZKR00"]"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*****  テーブルID取得  異常 *****"
      *-----------------------------------------------------------------
      *----------  エラー
             MOVE  PARM-RTNPKG           TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-001
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-901
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  RTN-CD OF PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  FREE-MSG              OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** テーブルID取得  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TBL-ID-GET-EXT.
           EXIT.
      ******************************************************************
      *     3.2 主処理
      ******************************************************************
       MAIN-RTN               SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  主処理  START  ***"
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.銘柄種類=["
      D             WK-MEG-CD-SHRU"]"
      *-----------------------------------------------------------------
           EVALUATE  WK-MEG-CD-SHRU
             WHEN  CNS-MEG-CD-SHRU-1
      *----------  3.2.1 対象銘柄は物の場合の処理（ARG1.銘柄別断面情報.銘柄種類＝1：物の場合）
               PERFORM  TASYOU-MEG-MONO-RTN
             WHEN  CNS-MEG-CD-SHRU-3
      *----------  3.2.2 対象銘柄は資金の場合の処理（ARG1.銘柄別断面情報.銘柄種類＝3：資金の場合）
                PERFORM  TASYOU-MEG-SIKIN-RTN
             WHEN  CNS-MEG-CD-SHRU-2
      *----------  3.2.3 対象銘柄は元本の場合の処理（ARG1.銘柄別断面情報.銘柄種類＝2：元本の場合）
               PERFORM  TASYOU-MEG-GNPN-RTN
             WHEN  OTHER
      *----------  3.2.4 対象銘柄は上記以外の場合
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-002
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-800
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  ZERO
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               MOVE  "パラメータエラー"
                 TO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名=["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション=["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード=["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード=["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ=["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  主処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       MAIN-EXT.
           EXIT.
      ******************************************************************
      *    3.2.1対象銘柄は物の場合の処理
      ******************************************************************
       TASYOU-MEG-MONO-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象銘柄は物の場合の処理  START ***"
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.銘柄種類２=["
      D             MEG-CD-SHRU2        OF  TKMZBW03-PARM"]"
      *-----------------------------------------------------------------
           IF  MEG-CD-SHRU2  OF  TKMZBW03-PARM  = CNS-MEG-CD-SHRU2-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.銘柄種類２"
      D             "は株の場合のみ"
      *-----------------------------------------------------------------
      *---------- 3.2.1.1 基準日採用未収収益データを取得する。
             PERFORM  YMD-SAIYOU-MSSE-RTN
           ELSE
             CONTINUE
           END-IF
      *---------- 3.2.1.2 対応基準日の残高履歴を作成する。
           PERFORM  TASYOU-YMD-ZDRW-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象銘柄は物の場合の処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TASYOU-MEG-MONO-EXT.
           EXIT.
      ******************************************************************
      *    3.2.1.1 基準日採用未収収益データを取得する。
      ******************************************************************
       YMD-SAIYOU-MSSE-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 基準日採用未収収益データ"
      D             "を取得するの処理  START ***"
      *-----------------------------------------------------------------
      *---------- 未収収益計算データを取得する
             PERFORM  TKMZBW08-GET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 基準日採用未収収益データ"
      D             "を取得するの処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       YMD-SAIYOU-MSSE-EXT.
           EXIT.
      ******************************************************************
      *         未収収益計算データを取得する
      ******************************************************************
       TKMZBW08-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***未収収益計算データを取得する処理  START***"
      *-----------------------------------------------------------------
      *----------  未収収益計算データCURSOR PREPARE
           PERFORM  TKMZBW08-PREPARE-RTN
      *----------  未収収益計算データCURSOR OPEN
           PERFORM  TKMZBW08-OPEN-RTN
      *----------  未収収益計算データCURSOR FETCH
           PERFORM  TKMZBW08-FETCH-RTN
      *----------  未収収益計算データCURSOR CLOSE
      **** PERFORM  TKMZBW08-CLOSE-RTN                                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益計算データを取得する処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW08-GET-EXT.
           EXIT.
      ******************************************************************
      *    未収収益計算データCURSOR PREPARE
      ******************************************************************
       TKMZBW08-PREPARE-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 未収収益計算データ"
      D                       "CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT13                                        @3212SEINO@@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD1          OF  H-TKMZBW08-S,
                 H-RIYO-CMP-CD2          OF  H-TKMZBW08-S,
                 H-RIYO-CMP-CD3          OF  H-TKMZBW08-S,
                 H-RIYO-CMP-CD4          OF  H-TKMZBW08-S,
                 WK-SQL-RIYO-CMP-CD1     OF  WK-MSG-1-13,
                 WK-SQL-RIYO-CMP-CD2     OF  WK-MSG-1-13
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD1              OF  H-TKMZBW08-S,
                 H-FUND-CD2              OF  H-TKMZBW08-S,
                 H-FUND-CD3              OF  H-TKMZBW08-S,
                 H-FUND-CD4              OF  H-TKMZBW08-S,
                 WK-SQL-FUND-CD1         OF  WK-MSG-1-13,
                 WK-SQL-FUND-CD2         OF  WK-MSG-1-13
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD1               OF  H-TKMZBW08-S,
                 H-PTF-CD2               OF  H-TKMZBW08-S,
                 H-PTF-CD3               OF  H-TKMZBW08-S,
                 H-PTF-CD4               OF  H-TKMZBW08-S,
                 WK-SQL-PTF-CD1          OF  WK-MSG-1-13,
                 WK-SQL-PTF-CD2          OF  WK-MSG-1-13
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD
             TO  H-SEC-SBT-CD1           OF  H-TKMZBW08-S,
                 H-SEC-SBT-CD2           OF  H-TKMZBW08-S,
                 H-SEC-SBT-CD3           OF  H-TKMZBW08-S,
                 H-SEC-SBT-CD4           OF  H-TKMZBW08-S,
                 WK-SQL-SEC-SBT-CD1      OF  WK-MSG-1-13,
                 WK-SQL-SEC-SBT-CD2      OF  WK-MSG-1-13
      *----------  銘柄コード
           MOVE  WK-MEG-CD
             TO  H-MEG-CD1               OF  H-TKMZBW08-S,
                 H-MEG-CD2               OF  H-TKMZBW08-S,
                 H-MEG-CD3               OF  H-TKMZBW08-S,
                 H-MEG-CD4               OF  H-TKMZBW08-S,
                 WK-SQL-MEG-CD1          OF  WK-MSG-1-13,
                 WK-SQL-MEG-CD2          OF  WK-MSG-1-13
      *----------  資産/負債・買建/売建フラグ
           MOVE  WK-TATE-FLG
             TO  H-TATE-FLG1             OF  H-TKMZBW08-S,
                 H-TATE-FLG2             OF  H-TKMZBW08-S,
                 H-TATE-FLG3             OF  H-TKMZBW08-S,
                 H-TATE-FLG4             OF  H-TKMZBW08-S,
                 WK-SQL-TATE-FLG1        OF  WK-MSG-1-13,
                 WK-SQL-TATE-FLG2        OF  WK-MSG-1-13
      *---------- 玉ID
           MOVE  WK-GYOKU-ID
             TO  H-GYOKU-ID1             OF  H-TKMZBW08-S,
                 H-GYOKU-ID2             OF  H-TKMZBW08-S,
                 H-GYOKU-ID3             OF  H-TKMZBW08-S,
                 H-GYOKU-ID4             OF  H-TKMZBW08-S,
                 WK-SQL-GYOKU-ID1        OF  WK-MSG-1-13,
                 WK-SQL-GYOKU-ID2        OF  WK-MSG-1-13
      *---------- 適用開始日
           MOVE  WK-KJN-YMD
             TO  H-TEKIYO-FROM1          OF  H-TKMZBW08-S,
                 H-TEKIYO-FROM2          OF  H-TKMZBW08-S,
                 WK-SQL-TEKIYO-FROM1     OF  WK-MSG-1-13,
                 WK-SQL-TEKIYO-FROM2     OF  WK-MSG-1-13
      *---------- 権利落日
           MOVE  WK-KJN-YMD
             TO  H-KENRI-OTI-YMD1        OF  H-TKMZBW08-S,
                 H-KENRI-OTI-YMD2        OF  H-TKMZBW08-S,
                 WK-SQL-KENRI-OTI-YMD1   OF  WK-MSG-1-13,
                 WK-SQL-KENRI-OTI-YMD2   OF  WK-MSG-1-13
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD
             TO  H-SYORI-YMD1            OF  H-TKMZBW08-S,
                 H-SYORI-YMD2            OF  H-TKMZBW08-S,
                 WK-SQL-SYORI-YMD        OF  WK-MSG-1-13
      *---------- 起動ID
           MOVE  WK-KIDOU-ID
             TO  H-KIDOU-ID1             OF  H-TKMZBW08-S,
                 H-KIDOU-ID2             OF  H-TKMZBW08-S,
                 WK-SQL-KIDOU-ID         OF  WK-MSG-1-13
           MOVE  SQL-SELECT-1-13         TO  SQLSTMT13                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD1       OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD1           OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD1            OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード=["
      D             H-SEC-SBT-CD1        OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード=["
      D             H-MEG-CD1            OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産/負債・買建/売建フラグ=["
      D             H-TATE-FLG1          OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ID=["
      D             H-GYOKU-ID1          OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":権利落日=["
      D             H-KENRI-OTI-YMD1     OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":適用開始日=["
      D             H-TEKIYO-FROM1       OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日=["
      D             H-SYORI-YMD1         OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID=["
      D             H-KIDOU-ID1          OF  H-TKMZBW08-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT13=[" SQLSTMT13 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW08-CR-OPEN=["                @3212SEINO@@
      D                            FLG-TKMZBW08-CR-OPEN "]"             @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZBW08-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  未収収益計算データCURSOR PREPARE
             EXEC  SQL
                 PREPARE  S1  FROM  :SQLSTMT13
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":未収収益計算データ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-003
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-13         DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 未収収益計算データ"
      D                        "CURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW08-PREPARE-EXT.
           EXIT.
      ******************************************************************
      *    未収収益計算データCURSOR OPEN
      ******************************************************************
       TKMZBW08-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益計算データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZBW08-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
             EXEC  SQL
                 DECLARE  TKMZBW08_CUR  CURSOR  FOR  S1
             END-EXEC
             CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":未収収益計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZBW08_CUR
               USING :H-TKMZBW08-S.H-RIYO-CMP-CD1,
                     :H-TKMZBW08-S.H-FUND-CD1,
                     :H-TKMZBW08-S.H-PTF-CD1,
                     :H-TKMZBW08-S.H-SEC-SBT-CD1,
                     :H-TKMZBW08-S.H-MEG-CD1,
                     :H-TKMZBW08-S.H-TATE-FLG1,
                     :H-TKMZBW08-S.H-GYOKU-ID1,
                     :H-TKMZBW08-S.H-RIYO-CMP-CD2,
                     :H-TKMZBW08-S.H-FUND-CD2,
                     :H-TKMZBW08-S.H-PTF-CD2,
                     :H-TKMZBW08-S.H-SEC-SBT-CD2,
                     :H-TKMZBW08-S.H-MEG-CD2,
                     :H-TKMZBW08-S.H-TATE-FLG2,
                     :H-TKMZBW08-S.H-GYOKU-ID2,
                     :H-TKMZBW08-S.H-TEKIYO-FROM1,
                     :H-TKMZBW08-S.H-KENRI-OTI-YMD1,
                     :H-TKMZBW08-S.H-SYORI-YMD1,
                     :H-TKMZBW08-S.H-KIDOU-ID1,
                     :H-TKMZBW08-S.H-RIYO-CMP-CD3,
                     :H-TKMZBW08-S.H-FUND-CD3,
                     :H-TKMZBW08-S.H-PTF-CD3,
                     :H-TKMZBW08-S.H-SEC-SBT-CD3,
                     :H-TKMZBW08-S.H-MEG-CD3,
                     :H-TKMZBW08-S.H-TATE-FLG3,
                     :H-TKMZBW08-S.H-GYOKU-ID3,
                     :H-TKMZBW08-S.H-SYORI-YMD2,
                     :H-TKMZBW08-S.H-KIDOU-ID2,
                     :H-TKMZBW08-S.H-RIYO-CMP-CD4,
                     :H-TKMZBW08-S.H-FUND-CD4,
                     :H-TKMZBW08-S.H-PTF-CD4,
                     :H-TKMZBW08-S.H-SEC-SBT-CD4,
                     :H-TKMZBW08-S.H-MEG-CD4,
                     :H-TKMZBW08-S.H-TATE-FLG4,
                     :H-TKMZBW08-S.H-GYOKU-ID4,
                     :H-TKMZBW08-S.H-TEKIYO-FROM2,
                     :H-TKMZBW08-S.H-KENRI-OTI-YMD2
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":未収収益計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMZBW08-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN FLAG=["
      D             FLG-TKMZBW08-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-004
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-13         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益計算データCURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW08-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    未収収益計算データCURSOR FETCH
      ******************************************************************
       TKMZBW08-FETCH-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
               FETCH TKMZBW08_CUR
               INTO  :H-TKMZBW08.H-SJTK-MS-SHEKI,
                     :H-TKMZBW08.H-SJTK-GENSEN-TAX,
                     :H-TKMZBW08.H-UYTK-MS-SHEKI,
                     :H-TKMZBW08.H-UYTK-GENSEN-TAX,
                     :H-TKMZBW08.H-SUM-HYK-KWS,
                     :H-TKMZBW08.H-SUM-GENS-TAX-HYK-KWS,
                     :H-TKMZBW08.H-MAX-HYK-KWS,
                     :H-TKMZBW08.H-MAX-GENS-TAX-HYK-KWS
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":未収収益計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SUM(市場通貨未収収益)=["
      D             H-SJTK-MS-SHEKI     OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":SUM(市場通貨源泉税)=["
      D             H-SJTK-GENSEN-TAX   OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":SUM(運用通貨未収収益) =["
      D             H-UYTK-MS-SHEKI     OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":SUM(運用通貨源泉税)=["
      D             H-UYTK-GENSEN-TAX   OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":SUM(評価為替レート)=["
      D             H-SUM-HYK-KWS       OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":SUM(源泉税評価為替レート)=["
      D             H-SUM-GENS-TAX-HYK-KWS
      D                                 OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":MAX(評価為替レート)=["
      D             H-MAX-HYK-KWS       OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":MAX(源泉税評価為替レート)=["
      D             H-MAX-GENS-TAX-HYK-KWS
      D                                 OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.未収配当計算コールフラグ=["
      D             KEISAN-FLG1         OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
               IF  KEISAN-FLG1 OF PARM-SMZJ2210-ARG1 = CNS-X-1
               THEN
      *---------- ワーク.市場通貨未収収益 ← 「別紙1-13 SQL説明」.SUM_市場通貨未収収益
                 MOVE  H-SJTK-MS-SHEKI    OF  H-TKMZBW08
                   TO  WK-SJTK-MS-SHEKI
      *---------- ワーク.市場通貨源泉税 ← 「別紙1-13 SQL説明」.SUM_市場通貨源泉税
                 MOVE  H-SJTK-GENSEN-TAX  OF  H-TKMZBW08
                   TO  WK-SJTK-GENSEN-TAX
               ELSE
      *---------- ワーク.市場通貨未収収益 ← 999999999999999.999
                 MOVE  CNS-999999999999999-999
                   TO  WK-SJTK-MS-SHEKI
      *---------- ワーク.市場通貨源泉税 ← 999999999999999.999
                 MOVE  CNS-999999999999999-999
                   TO  WK-SJTK-GENSEN-TAX
               END-IF
      *---------- ワーク.運用通貨未収収益 ← 「別紙1-13 SQL説明」.SUM_運用通貨未収収益
               MOVE  H-UYTK-MS-SHEKI    OF  H-TKMZBW08
                 TO  WK-UYTK-MS-SHEKI
      *---------- ワーク.運用通貨源泉税 ← 「別紙1-13 SQL説明」.SUM_運用通貨源泉税
               MOVE  H-UYTK-GENSEN-TAX  OF  H-TKMZBW08
                 TO  WK-UYTK-GENSEN-TAX
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク.市場通貨未収収益    =["
      D             WK-SJTK-MS-SHEKI"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク.市場通貨源泉税      =["
      D             WK-SJTK-GENSEN-TAX"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク.運用通貨未収収益    =["
      D             WK-UYTK-MS-SHEKI"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク.運用通貨源泉税      =["
      D             WK-UYTK-GENSEN-TAX"]"
      D    DISPLAY  CNS-PGM-ID":SUM(評価為替レート)=["
      D             H-SUM-HYK-KWS       OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":MAX(評価為替レート)=["
      D             H-MAX-HYK-KWS       OF  H-TKMZBW08"]"
      *-----------------------------------------------------------------
               IF  H-SUM-HYK-KWS        OF  H-TKMZBW08
                =  H-MAX-HYK-KWS        OF  H-TKMZBW08
               THEN
                 MOVE  H-SUM-HYK-KWS    OF  H-TKMZBW08
                   TO  WK-HYK-KWS
               ELSE
      *---------- ワーク.評価為替レート ← 99999999.9999999999
                 MOVE  CNS-99999999-9999999999
                   TO  WK-HYK-KWS
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク.評価為替レート=["WK-HYK-KWS"]"
      D    DISPLAY  CNS-PGM-ID":SUM(源泉税評価為替レート)=["
      D             H-SUM-GENS-TAX-HYK-KWS
      D                                 OF  H-TKMZBW08"]"
      D    DISPLAY  CNS-PGM-ID":MAX(源泉税評価為替レート)=["
      D             H-MAX-GENS-TAX-HYK-KWS
      D                                 OF  H-TKMZBW08"]"
      *-----------------------------------------------------------------
               IF  H-SUM-GENS-TAX-HYK-KWS OF  H-TKMZBW08
                =  H-MAX-GENS-TAX-HYK-KWS OF  H-TKMZBW08
               THEN
                 MOVE  H-SUM-GENS-TAX-HYK-KWS
                   OF  H-TKMZBW08
                   TO  WK-GENS-TAX-HYK-KWS
               ELSE
      *---------- ワーク.源泉税評価為替レート ← 99999999.9999999999
                 MOVE  CNS-99999999-9999999999
                   TO  WK-GENS-TAX-HYK-KWS
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク.源泉税評価為替レート=["
      D             WK-GENS-TAX-HYK-KWS"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":未収収益計算データCURSOR FETCH NOTFOUNDの場合"
      *-----------------------------------------------------------------
      *---------- ワーク.運用通貨未収収益 ← 999999999999999.999
               MOVE  CNS-999999999999999-999
                 TO  WK-UYTK-MS-SHEKI
      *---------- ワーク.運用通貨源泉税 ← 999999999999999.999
               MOVE  CNS-999999999999999-999
                 TO  WK-UYTK-GENSEN-TAX
      *---------- ワーク.評価為替レート ← 99999999.9999999999
               MOVE  CNS-99999999-9999999999
                 TO  WK-HYK-KWS
      *---------- ワーク.源泉税評価為替レート ← 99999999.9999999999
               MOVE  CNS-99999999-9999999999
                 TO  WK-GENS-TAX-HYK-KWS
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク.運用通貨未収収益    =["
      D             WK-UYTK-MS-SHEKI"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク.運用通貨源泉税      =["
      D             WK-UYTK-GENSEN-TAX"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク.評価為替レート      =["
      D             WK-HYK-KWS"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク.源泉税評価為替レート=["
      D             WK-GENS-TAX-HYK-KWS"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-005
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                      WK-MSG-1-13       DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益計算データCURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW08-FETCH-EXT.
           EXIT.
      ******************************************************************
      *   未収収益計算データCURSOR CLOSE
      ******************************************************************
      *TKMZBW08-CLOSE-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 未収収益計算データCURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW08-CR-OPEN= ["
      *D             FLG-TKMZBW08-CR-OPEN "]"
      *-----------------------------------------------------------------
      *    EXEC  SQL
      *      CLOSE TKMZBW08_CUR
      *    END-EXEC
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D           "未収収益計算データCUR CLOSE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":未収収益計算データCURSOR CLOSE  正常"
      *-----------------------------------------------------------------
      *       MOVE  CNS-OFF               TO  FLG-TKMZBW08-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":CUR OPEN FLAG =["
      *D             FLG-TKMZBW08-CR-OPEN "]"
      *-----------------------------------------------------------------
      *     ELSE
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":未収収益計算データCURSOR CLOSE  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *         TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
      *       MOVE  CNS-POS-006
      *         TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
      *      STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-13         DELIMITED  BY  SIZE
      *         INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
      *      PERFORM  ERR-RTN
      *     END-IF
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***未収収益計算データ"
      *D             "CURSOR CLOSE END ***"
      *-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW08-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *     3.2.1.2 対応基準日の残高履歴を作成する
      ******************************************************************
       TASYOU-YMD-ZDRW-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***対応基準日の残高履歴を作成する処理  START***"
      *-----------------------------------------------------------------
      *----------  ワーク件数
             MOVE  ZERO                  TO  WK-INDEX
      *----------  ワーク計上フラグ
             MOVE  CNS-X-0               TO  WK-KEIJYO-FLG
      *----------  ワーク普通フラグ
             MOVE  CNS-X-0               TO  WK-NORMAL-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク件数      =["WK-INDEX"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***1)残高異動計算データ取得 START ***"
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.差分更新FROM日=["   @3212SEINO@@
      D             WK-SABON-UPDATE-FROM"]"                             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":ARG1.取引存在フラグ=["                  @3212SEINO@@
      D             TRHK-SONZAI-FLG         OF  PARM-SMZJ2210-ARG1"]"   @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":ARG1.差分更新モード取得ルート区分=["    @3212SEINO@@
      D             SABON-UPDATE-KBN        OF  PARM-SMZJ2210-ARG1"]"   @3212SEINO@@
      *-----------------------------------------------------------------
           IF TRHK-SONZAI-FLG  OF  PARM-SMZJ2210-ARG1 = CNS-X-0         @3212SEINO@@
             AND (WK-SABON-UPDATE-FROM = CNS-0                          @3212SEINO@@
                OR (WK-SABON-UPDATE-FROM NOT = CNS-0                    @3212SEINO@@
                    AND SABON-UPDATE-KBN  OF PARM-SMZJ2210-ARG1 = CNS-1 @3212SEINO@@
                   )                                                    @3212SEINO@@
                 )                                                      @3212SEINO@@
             AND WK-SAI-CALC-KBN = CNS-X-1                              @3212SEINO@@
           THEN                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           ELSE                                                         @3212SEINO@@
      *---------- 1)残高異動計算データ取得
             PERFORM  TKMZBW06-GET1-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分=["WK-TBL-KBN"]"
      *-----------------------------------------------------------------
             IF  WK-TBL-KBN             = 2
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分＝2（残高異動TBL）の場合"
      *-----------------------------------------------------------------
               PERFORM  TKMZZR00-GET-RTN
             ELSE
               CONTINUE
             END-IF
           END-IF                                                       @3212SEINO@@
      *---------- 2)ワーク断面作成情報編集
           PERFORM  DMN-JH-EDIT-RTN
      *---------- 3)ワーク残高履歴更新編集
           PERFORM  ZNRRK-UD-EDIT-RTN
      *---------- 5)残高履歴計算データ更新
           PERFORM  ZNRRK-CALC-UD-RTN
      *---------- 6)取引差分更新管理更新
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":欠落断面有無フラグ=["LACK-DMN-FLG"]"
      *-----------------------------------------------------------------
           IF  LACK-DMN-FLG        NOT   = 1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":欠落断面有無フラグ≠1（あり）の場合"
      *-----------------------------------------------------------------
             PERFORM  TRHK-SABON-UD-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***対応基準日の残高履歴を作成する処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TASYOU-YMD-ZDRW-EXT.
           EXIT.
      ******************************************************************
      *         1)残高異動計算データ取得
      ******************************************************************
       TKMZBW06-GET1-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":1)残高異動計算データ取得  START"
      *-----------------------------------------------------------------
      *----------  残高異動計算データCURSOR PREPARE
           PERFORM  TKMZBW06-PRE1-RTN
      *----------  残高異動計算データCURSOR OPEN
           PERFORM  TKMZBW06-OPEN1-RTN
      *----------  残高異動計算データCURSOR FETCH
           PERFORM  TKMZBW06-FETCH1-RTN
             UNTIL  FLG-TKMZBW06-CR1-OPEN  =  CNS-OFF
      *----------  残高異動計算データCURSOR CLOSE
      *    PERFORM  TKMZBW06-CLOSE1-RTN                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":1)残高異動計算データ取得  END"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-GET1-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データCURSOR PREPARE
      ******************************************************************
       TKMZBW06-PRE1-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 残高異動計算データ"
      D                       "CURSOR PREPARE1 START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZBW06-S
                       SQLSTMT04-1
                       SQLSTMT04-3
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD           OF  H-TKMZBW06-S,
                 WK-SQL-RIYO-CMP-CD      OF  WK-MSG-1-4
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD               OF  H-TKMZBW06-S,
                 WK-SQL-FUND-CD          OF  WK-MSG-1-4
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD                OF  H-TKMZBW06-S,
                 WK-SQL-PTF-CD           OF  WK-MSG-1-4
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD
             TO  H-SEC-SBT-CD            OF  H-TKMZBW06-S,
                 WK-SQL-SEC-SBT-CD       OF  WK-MSG-1-4
      *----------  銘柄コード
           MOVE  WK-MEG-CD
             TO  H-MEG-CD                OF  H-TKMZBW06-S,
                 WK-SQL-MEG-CD           OF  WK-MSG-1-4
      *----------  資産/負債・買建/売建フラグ
           MOVE  WK-TATE-FLG
             TO  H-TATE-FLG              OF  H-TKMZBW06-S,
                 WK-SQL-TATE-FLG         OF  WK-MSG-1-4
      *---------- 玉ID
           MOVE  WK-GYOKU-ID
             TO  H-GYOKU-ID              OF  H-TKMZBW06-S,
                 WK-SQL-GYOKU-ID         OF  WK-MSG-1-4
      *---------- 計上基準日1
           MOVE  WK-KAISI-KJN-YMD
             TO  H-KEIJOU-KIJUNBI-1      OF  H-TKMZBW06-S,
                 WK-SQL-KEIJOU-KIJUNBI-1 OF  WK-MSG-1-4
      *---------- 計上基準日2
           MOVE  WK-KJN-YMD
             TO  H-KEIJOU-KIJUNBI-2      OF  H-TKMZBW06-S,
                 WK-SQL-KEIJOU-KIJUNBI-2 OF  WK-MSG-1-4
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD
             TO  H-SYORI-YMD             OF  H-TKMZBW06-S,
                 WK-SQL-SYORI-YMD        OF  WK-MSG-1-4
      *---------- 起動ID
           MOVE  WK-KIDOU-ID
             TO  H-KIDOU-ID              OF  H-TKMZBW06-S,
                 WK-SQL-KIDOU-ID         OF  WK-MSG-1-4
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD            OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード=["
      D             H-SEC-SBT-CD         OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード=["
      D             H-MEG-CD             OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産/負債・買建/売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ID=["
      D             H-GYOKU-ID           OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":計上基準日1=["
      D             H-KEIJOU-KIJUNBI-1   OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":計上基準日2=["
      D             H-KEIJOU-KIJUNBI-2   OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日=["
      D             H-SYORI-YMD          OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID=["
      D             H-KIDOU-ID           OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.異動計算パターン.処理順序=["
      D             WK-SYRI-JUN"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.基準日断面情報.基本会計"
      D             "ベースフラグ=["WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
      *---------- ORDER BY
           IF (WK-SYRI-JUN               =  "5"
           OR  WK-SYRI-JUN               =  "6"
           OR  WK-SYRI-JUN               =  "7"
           OR  WK-SYRI-JUN               =  "8")
           AND WK-KH-KAIKEI-BASE-FLG     =  "1"
           THEN
      *---------- 受渡日
             MOVE  "UKE_YMD"
               TO  WK-UKK-YMD            OF  SQL-SELECT-1-4
             MOVE  SQL-SELECT-1-4          TO  SQLSTMT04-1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ORDER-BY =["
      D             WK-UKK-YMD           OF  SQL-SELECT-1-4"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT04-1=[" SQLSTMT04-1 "]"
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR1-OPEN-PR=["
      D                          FLG-TKMZBW06-CR1-OPEN-PR "]"
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR1-OPEN-PR = CNS-OFF                     @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  残高異動計算データCURSOR PREPARE
               EXEC  SQL
                 PREPARE  S3_1  FROM  :SQLSTMT04-1
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-007
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-4         DELIMITED  BY  SIZE
                   INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           ELSE
             MOVE  "KEIJOU_KIJUNBI"
               TO  WK-UKK-YMD            OF  SQL-SELECT-1-4
             MOVE  SQL-SELECT-1-4          TO  SQLSTMT04-3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ORDER-BY =["
      D             WK-UKK-YMD           OF  SQL-SELECT-1-4"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT04-3=[" SQLSTMT04-3 "]"
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR3-OPEN-PR=["
      D                          FLG-TKMZBW06-CR3-OPEN-PR "]"
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR3-OPEN-PR = CNS-OFF                     @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  残高異動計算データCURSOR PREPARE
               EXEC  SQL
                 PREPARE  S3_3  FROM  :SQLSTMT04-3
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-007
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-4         DELIMITED  BY  SIZE
                   INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高異動計算データ"
      D                        "CURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-PRE1-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データCURSOR OPEN
      ******************************************************************
       TKMZBW06-OPEN1-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN START ***"
      D    DISPLAY  CNS-PGM-ID ":ARG1.異動計算パターン.処理順序=["
      D             WK-SYRI-JUN"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.基準日断面情報.基本会計"
      D             "ベースフラグ=["WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
      *---------- ORDER BY
           IF (WK-SYRI-JUN               =  "5"
           OR  WK-SYRI-JUN               =  "6"
           OR  WK-SYRI-JUN               =  "7"
           OR  WK-SYRI-JUN               =  "8")
           AND WK-KH-KAIKEI-BASE-FLG     =  "1"
           THEN
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR1-OPEN-PR = CNS-OFF                     @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZBW06_CUR1_1  CURSOR  FOR  S3_1
               END-EXEC
               CONTINUE                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZBW06_CUR1_1
                 USING :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-SYORI-YMD,
                       :H-TKMZBW06-S.H-KIDOU-ID,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2
             END-EXEC
           ELSE
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR3-OPEN-PR = CNS-OFF                     @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZBW06_CUR1_3  CURSOR  FOR  S3_3
               END-EXEC
               CONTINUE                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZBW06_CUR1_3
                 USING :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-SYORI-YMD,
                       :H-TKMZBW06-S.H-KIDOU-ID,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2
             END-EXEC
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":残高異動計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMZBW06-CR1-OPEN
      *---------- ORDER BY
             IF (WK-SYRI-JUN               =  "5"
             OR  WK-SYRI-JUN               =  "6"
             OR  WK-SYRI-JUN               =  "7"
             OR  WK-SYRI-JUN               =  "8")
             AND WK-KH-KAIKEI-BASE-FLG     =  "1"
             THEN
               MOVE  CNS-ON                TO  FLG-TKMZBW06-CR1-OPEN-PR @3212SEINO@@
             ELSE
               MOVE  CNS-ON                TO  FLG-TKMZBW06-CR3-OPEN-PR @3212SEINO@@
             END-IF
      *----------  ワーク件数
      *      MOVE  ZERO                  TO  WK-INDEX                   @3212SEINO@@
      *----------  ワーク計上フラグ
      *      MOVE  CNS-X-0               TO  WK-KEIJYO-FLG              @3212SEINO@@
      *----------  ワーク普通フラグ
      *      MOVE  CNS-X-0               TO  WK-NORMAL-FLG              @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":TKMZBW06 CURSOR OPEN FLAG=["
      D             FLG-TKMZBW06-CR1-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR1-OPEN-PR=["             @3212SEINO@@
      D                         FLG-TKMZBW06-CR1-OPEN-PR"]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR3-OPEN-PR=["             @3212SEINO@@
      D                         FLG-TKMZBW06-CR3-OPEN-PR"]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":ワーク件数      =["WK-INDEX"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-008
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-4         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-OPEN1-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データCURSOR FETCH
      ******************************************************************
       TKMZBW06-FETCH1-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-TKMZBW06,
                       H-TKMZBW06-TBL-KBN
      *---------- ORDER BY
           IF (WK-SYRI-JUN               =  "5"
           OR  WK-SYRI-JUN               =  "6"
           OR  WK-SYRI-JUN               =  "7"
           OR  WK-SYRI-JUN               =  "8")
           AND WK-KH-KAIKEI-BASE-FLG     =  "1"
           THEN
             EXEC SQL
               FETCH TKMZBW06_CUR1_1
               INTO  :H-TKMZBW06,
                     :H-TKMZBW06-TBL-KBN
             END-EXEC
           ELSE
             EXEC SQL
               FETCH TKMZBW06_CUR1_3
               INTO  :H-TKMZBW06,
                     :H-TKMZBW06-TBL-KBN
             END-EXEC
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":残高異動計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  正常"
      *-----------------------------------------------------------------
      *----------  ワーク残高異動計算データ
               MOVE  H-TKMZBW06         TO  WK-TKMZBW06
      *----------  ワークTBL区分
               MOVE  H-TKMZBW06-TBL-KBN TO  WK-TBL-KBN
      *----------  ワーク件数
               COMPUTE  WK-INDEX  =  WK-INDEX + CNS-1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ."
      D    DISPLAY  CNS-PGM-ID":処理実行日                    =["
      D             SYORI-YMD           OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                 =["
      D             KIDOU-ID            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード         =["
      D             RIYO-CMP-CD         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード         =["
      D             FUND-CD             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード   =["
      D             PTF-CD              OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID               =["
      D             TORI-ID             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":計上基準日             =["
      D             KEIJOU-KIJUNBI      OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分               =["
      D             AKA-KBN             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№               =["
      D             ERR-KJY-NO          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分             =["
      D             ERR-KJY-KBN         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID             =["
      D             THRK-ID             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード         =["
      D             SEC-SBT-CD          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":取引内容               =["
      D             TORI-NAIY           OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":取引事由               =["
      D             TORI-JIYU           OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード         =["
      D             SIJO-TUKA-CD        OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード             =["
      D             MEG-CD              OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ                 =["
      D             GYOKU-ID            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":約定日                 =["
      D             YKJ-YMD             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":受渡日                 =["
      D             UKE-YMD             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価       =["
      D             SJTK-IDO-BOKA       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価       =["
      D             UYTK-IDO-BOKA       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価       =["
      D             SJTK-BOKA-TNK       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価       =["
      D             UYTK-BOKA-TNK       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート         =["
      D             BOKA-KWS            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価       =["
      D             SJTK-H-BOKA         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価       =["
      D             UYTK-H-BOKA         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価       =["
      D             SJTK-H-TNK          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価       =["
      D             UYTK-H-TNK          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":異動数量               =["
      D             IDO-SURYO           OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":異動数量（利付）       =["
      D             IDO-SURYO-RIT       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高 =["
      D             SJTK-IDOG-BOKAZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高 =["
      D             UYTK-IDOG-BOKAZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高         =["
      D             IDOG-SRYZN          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高（利付） =["
      D             IDOG-SRYZN-RIT      OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金異動額   =["
      D             SJTK-PPAYIDOG       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額   =["
      D             UYTK-PPAYIDOG       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前払金残 =["
      D             SJTK-IDOG-PPAYZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前払金残 =["
      D             UYTK-IDOG-PPAYZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前受金残 =["
      D             SJTK-IDOG-ARECZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前受金残 =["
      D             UYTK-IDOG-ARECZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後仮払金残 =["
      D             SJTK-IDOG-SPAYZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後仮払金残 =["
      D             UYTK-IDOG-SPAYZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買損益       =["
      D             SJTK-BBSNEKI        OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨売買損益       =["
      D             UYTK-BBSNEKI        OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益             =["
      D             UYTK-KWS-SNEKI      OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（利金）     =["
      D             UYTK-KWS-SNEKI-RK   OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（市場）     =["
      D             UYTK-KWS-SNEKI-SJ   OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料         =["
      D             SJTK-TSR            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料         =["
      D             UYTK-TSR            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税         =["
      D             SJTK-S-TAX          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税         =["
      D             UYTK-S-TAX          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税         =["
      D             SJTK-GENSEN-TAX     OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税         =["
      D             UYTK-GENSEN-TAX     OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他損益     =["
      D             SJTK-ELS-SNEKI      OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他損益     =["
      D             UYTK-ELS-SNEKI      OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定 =["
      D             SJTK-RKSEKJ         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定 =["
      D             UYTK-RKSEKJ         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序           =["
      D             IDO-KJY-JUN         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価               =["
      D             TGYOKU-TNK          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート         =["
      D             TGYOKU-KWS-RATE     OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー         =["
      D             TGYOKU-BRK          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日             =["
      D             TGYOKU-YKJ-YMD      OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉約定金額残=["
      D             SJTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉約定金額残=["
      D             UYTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料     =["
      D             SJTK-TG-TSR         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料     =["
      D             UYTK-TG-TSR         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉手数料残=["
      D             SJTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉手数料残=["
      D             UYTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税     =["
      D             SJTK-TG-S-TAX       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税     =["
      D             UYTK-TG-S-TAX       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉消費税残=["
      D             SJTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉消費税残=["
      D             UYTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用  =["
      D             SJTK-TG-ELS-HIYO    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用  =["
      D             UYTK-TG-ELS-HIYO    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉その他費用残=["
      D             SJTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉その他費用残=["
      D             UYTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額   =["
      D             SJTK-TG-SSKG        OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額   =["
      D             UYTK-TG-SSKG        OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉精算金額残=["
      D             SJTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉精算金額残=["
      D             UYTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨引継前受・前払プレミアム=["
      D             SJTK-HT-PPAR-PMM    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨引継前受・前払プレミアム=["
      D             UYTK-HT-PPAR-PMM    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ=["
      D             OP-TATE-FLG         OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定異動額=["
      D             SJTK-GSZKP-YTIDOG   OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定異動額  =["
      D             UYTK-GSZKP-YTIDOG   OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨源泉税還付予定異動額=["
      D             KSTK-GSZKP-YTIDOG   OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後源泉税還付予定額残高=["
      D             SJTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後源泉税還付予定額残高=["
      D             UYTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨異動後源泉税還付予定額残高=["
      D             KSTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未収金残高=["
      D             SJTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未収金残高=["
      D             UYTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未払金残高=["
      D             SJTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未払金残高=["
      D             UYTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払費用残=["
      D             SJTK-IDOG-MBHYZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払費用残=["
      D             UYTK-IDOG-MBHYZN    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払消費税残=["
      D             SJTK-IDOG-MB-S-TAXZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払消費税残=["
      D             UYTK-IDOG-MB-S-TAXZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管評価損益残=["
      D             SJTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管評価損益残=["
      D             UYTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管未収収益=["
      D             SJTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管未収収益=["
      D             UYTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管前払金評価損益残=["
      D             UYTK-IDOG-IK-PPHKZN OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":削除区分               =["
      D             SAKUJO-KBN          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息=["
      D             SHORT-STEN-KEKA-RSK OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日         =["
      D             SHORT-START-YMD     OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日           =["
      D             SHORT-END-YMD       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード       =["
      D             TSTSK-CD            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード           =["
      D             HAKO-CD             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":数量単位               =["
      D             SURYO-TANI          OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":初期設定金額           =["
      D             SHOKI-SET-KGK       OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ             =["
      D             SK-FLG              OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":作成日時               =["
      D             SK-DATE             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード=["
      D             SK-LOGIN-CMP-CD     OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ         =["
      D             SK-SID              OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ     =["
      D             SK-PGMID            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ             =["
      D             UPD-FLG             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":更新日時               =["
      D             UPD-DATE            OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード=["
      D             UPD-LOGIN-CMP-CD    OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ         =["
      D             UPD-SID             OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ     =["
      D             UPD-PGMID           OF  WK-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分  =["WK-TBL-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク件数     =["WK-INDEX"]"
      *-----------------------------------------------------------------
      *----------  評価計上判定
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***【SMZJ4012】取引事由判定  START***"
      *-----------------------------------------------------------------
               INITIALIZE  PARM-SMZJ4012-INOUT
                           PARM-RTNPKG
      *----------  取引事由
               MOVE  TORI-JIYU          OF  WK-TKMZBW06
                 TO  TORI-JIYU          OF  PARM-SMZJ4012-INOUT
      *----------  判定対象区分
               MOVE  CNS-X-1
                 TO  HANTEI-TARGET-KBN  OF  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由     =["
      D              TORI-JIYU          OF  PARM-SMZJ4012-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分 =["
      D              HANTEI-TARGET-KBN  OF  PARM-SMZJ4012-INOUT"]"
      *-----------------------------------------------------------------
               CALL  "SMZJ4012"         USING  PARM-SMZJ4012-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4012)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
               IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                 =  CNS-RTN-000
               THEN
      *----------  ワーク評価損益データフラグ
                 MOVE  HYK-SNEKI-DATA-FLG OF  PARM-SMZJ4012-ARG2
                   TO  WK-HYK-SNEKI-DATA-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク評価損益データフラグ     =["
      D             WK-HYK-SNEKI-DATA-FLG"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***【SMZJ4012】取引事由判定  END***"
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク評価損益データフラグ     =["
      D             WK-HYK-SNEKI-DATA-FLG"]"
      *-----------------------------------------------------------------
               EVALUATE  WK-HYK-SNEKI-DATA-FLG
      *----------  ワーク評価損益データフラグ＝'8'(評価損益計上)の場合
                 WHEN  CNS-X-8
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク件数     =["WK-INDEX"]"
      *-----------------------------------------------------------------
                   IF  WK-INDEX  =  CNS-1
                   THEN
      *----------  ワーク残高異動計算データ(計上)
                     MOVE  WK-TKMZBW06  TO  WK-TKMZBW06-KEIJYO
      *----------  ワーク計上フラグ
                     MOVE  CNS-X-1      TO  WK-KEIJYO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(計上)."
      D    DISPLAY  CNS-PGM-ID":処理実行日                    =["
      D             SYORI-YMD           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                        =["
      D             KIDOU-ID            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード                =["
      D             RIYO-CMP-CD         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード                =["
      D             FUND-CD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード          =["
      D             PTF-CD              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                      =["
      D             TORI-ID             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":計上基準日                    =["
      D             KEIJOU-KIJUNBI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                      =["
      D             AKA-KBN             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№                      =["
      D             ERR-KJY-NO          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                    =["
      D             ERR-KJY-KBN         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                    =["
      D             THRK-ID             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード                =["
      D             SEC-SBT-CD          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引内容                      =["
      D             TORI-NAIY           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引事由                      =["
      D             TORI-JIYU           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード                =["
      D             SIJO-TUKA-CD        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード                    =["
      D             MEG-CD              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ      =["
      D             TATE-FLG            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ                        =["
      D             GYOKU-ID            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":約定日                        =["
      D             YKJ-YMD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":受渡日                        =["
      D             UKE-YMD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価              =["
      D             SJTK-IDO-BOKA       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価              =["
      D             UYTK-IDO-BOKA       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価              =["
      D             SJTK-BOKA-TNK       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価              =["
      D             UYTK-BOKA-TNK       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート                =["
      D             BOKA-KWS            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価              =["
      D             SJTK-H-BOKA         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価              =["
      D             UYTK-H-BOKA         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             SJTK-H-TNK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             UYTK-H-TNK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動数量                      =["
      D             IDO-SURYO           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動数量（利付）              =["
      D             IDO-SURYO-RIT       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高        =["
      D             SJTK-IDOG-BOKAZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高        =["
      D             UYTK-IDOG-BOKAZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高                =["
      D             IDOG-SRYZN          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高（利付）        =["
      D             IDOG-SRYZN-RIT      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金異動額          =["
      D             SJTK-PPAYIDOG       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額          =["
      D             UYTK-PPAYIDOG       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前払金残        =["
      D             SJTK-IDOG-PPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前払金残        =["
      D             UYTK-IDOG-PPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前受金残        =["
      D             SJTK-IDOG-ARECZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前受金残        =["
      D             UYTK-IDOG-ARECZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後仮払金残        =["
      D             SJTK-IDOG-SPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後仮払金残        =["
      D             UYTK-IDOG-SPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買損益              =["
      D             SJTK-BBSNEKI        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨売買損益              =["
      D             UYTK-BBSNEKI        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                    =["
      D             UYTK-KWS-SNEKI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（利金）            =["
      D             UYTK-KWS-SNEKI-RK   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（市場）            =["
      D             UYTK-KWS-SNEKI-SJ   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料                =["
      D             SJTK-TSR            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料                =["
      D             UYTK-TSR            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税                =["
      D             SJTK-S-TAX          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税                =["
      D             UYTK-S-TAX          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税                =["
      D             SJTK-GENSEN-TAX     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税                =["
      D             UYTK-GENSEN-TAX     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他損益            =["
      D             SJTK-ELS-SNEKI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他損益            =["
      D             UYTK-ELS-SNEKI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定        =["
      D             SJTK-RKSEKJ         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定        =["
      D             UYTK-RKSEKJ         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序                  =["
      D             IDO-KJY-JUN         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価                      =["
      D             TGYOKU-TNK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート                =["
      D             TGYOKU-KWS-RATE     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー                =["
      D             TGYOKU-BRK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日                    =["
      D             TGYOKU-YKJ-YMD      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉約定金額残  =["
      D             SJTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉約定金額残  =["
      D             UYTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料            =["
      D             SJTK-TG-TSR         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料            =["
      D             UYTK-TG-TSR         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉手数料残    =["
      D             SJTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉手数料残    =["
      D             UYTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税            =["
      D             SJTK-TG-S-TAX       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税            =["
      D             UYTK-TG-S-TAX       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉消費税残    =["
      D             SJTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉消費税残    =["
      D             UYTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用        =["
      D             SJTK-TG-ELS-HIYO    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用        =["
      D             UYTK-TG-ELS-HIYO    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉その他費用残=["
      D             SJTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉その他費用残=["
      D             UYTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額          =["
      D             SJTK-TG-SSKG        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額          =["
      D             UYTK-TG-SSKG        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉精算金額残  =["
      D             SJTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉精算金額残  =["
      D             UYTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨引継前受・前払プレミアム=["
      D             SJTK-HT-PPAR-PMM    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨引継前受・前払プレミアム=["
      D             UYTK-HT-PPAR-PMM    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ  =["
      D             OP-TATE-FLG         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定異動額  =["
      D             SJTK-GSZKP-YTIDOG   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定異動額  =["
      D             UYTK-GSZKP-YTIDOG   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後源泉税還付予定額残高=["
      D             SJTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後源泉税還付予定額残高=["
      D             UYTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未収金残高=["
      D             SJTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未収金残高=["
      D             UYTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未払金残高=["
      D             SJTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未払金残高=["
      D             UYTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払費用残      =["
      D             SJTK-IDOG-MBHYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払費用残      =["
      D             UYTK-IDOG-MBHYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管評価損益残  =["
      D             SJTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管評価損益残  =["
      D             UYTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管未収収益    =["
      D             SJTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管未収収益    =["
      D             UYTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管前払金評価損益残=["
      D             UYTK-IDOG-IK-PPHKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                      =["
      D             SAKUJO-KBN          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息  =["
      D             SHORT-STEN-KEKA-RSK OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日                =["
      D             SHORT-START-YMD     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日                  =["
      D             SHORT-END-YMD       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード              =["
      D             TSTSK-CD            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード                  =["
      D             HAKO-CD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":数量単位                      =["
      D             SURYO-TANI          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":初期設定金額                  =["
      D             SHOKI-SET-KGK       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                    =["
      D             SK-FLG              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                      =["
      D             SK-DATE             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード  =["
      D             SK-LOGIN-CMP-CD     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ                =["
      D             SK-SID              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ            =["
      D             SK-PGMID            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                    =["
      D             UPD-FLG             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                      =["
      D             UPD-DATE            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード  =["
      D             UPD-LOGIN-CMP-CD    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ                =["
      D             UPD-SID             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ            =["
      D             UPD-PGMID           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      *-----------------------------------------------------------------
                   ELSE
                     CONTINUE
                   END-IF
      *----------  ワーク評価損益データフラグ＝'7'(切り離し法評価損益計上)の場合
                 WHEN OTHER
      *----------  ワーク残高異動計算データ(普通)
                   MOVE  WK-TKMZBW06    TO  WK-TKMZBW06-NORMAL
      *----------  ワーク普通フラグ
                   MOVE  CNS-X-1        TO  WK-NORMAL-FLG
      *----------  残高異動計算データカーソルオープンフラグ
                   MOVE  CNS-OFF        TO  FLG-TKMZBW06-CR1-OPEN
                   IF  WK-HYK-SNEKI-DATA-FLG  =  CNS-X-7
                   THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク件数     =["WK-INDEX"]"
      *-----------------------------------------------------------------
                     IF  WK-INDEX  =  CNS-1
                     THEN
      *----------  ワーク残高異動計算データ(計上)
                       MOVE  WK-TKMZBW06  TO  WK-TKMZBW06-KEIJYO
      *----------  ワーク計上フラグ
                       MOVE  CNS-X-1      TO  WK-KEIJYO-FLG
      *----------  ワーク残高異動計算データ(普通)
                       MOVE  WK-TKMZBW06  TO  WK-TKMZBW06-NORMAL
      *----------  ワーク普通フラグ
                       MOVE  CNS-X-1      TO  WK-NORMAL-FLG
      *----------  残高異動計算データカーソルオープンフラグ
                       MOVE  CNS-OFF      TO  FLG-TKMZBW06-CR1-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(計上)."
      D    DISPLAY  CNS-PGM-ID":処理実行日                    =["
      D             SYORI-YMD           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                        =["
      D             KIDOU-ID            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード                =["
      D             RIYO-CMP-CD         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード                =["
      D             FUND-CD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード          =["
      D             PTF-CD              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                      =["
      D             TORI-ID             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":計上基準日                    =["
      D             KEIJOU-KIJUNBI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                      =["
      D             AKA-KBN             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№                      =["
      D             ERR-KJY-NO          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                    =["
      D             ERR-KJY-KBN         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                    =["
      D             THRK-ID             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード                =["
      D             SEC-SBT-CD          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引内容                      =["
      D             TORI-NAIY           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引事由                      =["
      D             TORI-JIYU           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード                =["
      D             SIJO-TUKA-CD        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード                    =["
      D             MEG-CD              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ      =["
      D             TATE-FLG            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ                        =["
      D             GYOKU-ID            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":約定日                        =["
      D             YKJ-YMD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":受渡日                        =["
      D             UKE-YMD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価              =["
      D             SJTK-IDO-BOKA       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価              =["
      D             UYTK-IDO-BOKA       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価              =["
      D             SJTK-BOKA-TNK       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価              =["
      D             UYTK-BOKA-TNK       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート                =["
      D             BOKA-KWS            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価              =["
      D             SJTK-H-BOKA         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価              =["
      D             UYTK-H-BOKA         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             SJTK-H-TNK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             UYTK-H-TNK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動数量                      =["
      D             IDO-SURYO           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動数量（利付）              =["
      D             IDO-SURYO-RIT       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高        =["
      D             SJTK-IDOG-BOKAZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高        =["
      D             UYTK-IDOG-BOKAZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高                =["
      D             IDOG-SRYZN          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高（利付）        =["
      D             IDOG-SRYZN-RIT      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金異動額          =["
      D             SJTK-PPAYIDOG       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額          =["
      D             UYTK-PPAYIDOG       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前払金残        =["
      D             SJTK-IDOG-PPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前払金残        =["
      D             UYTK-IDOG-PPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前受金残        =["
      D             SJTK-IDOG-ARECZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前受金残        =["
      D             UYTK-IDOG-ARECZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後仮払金残        =["
      D             SJTK-IDOG-SPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後仮払金残        =["
      D             UYTK-IDOG-SPAYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買損益              =["
      D             SJTK-BBSNEKI        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨売買損益              =["
      D             UYTK-BBSNEKI        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                    =["
      D             UYTK-KWS-SNEKI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（利金）            =["
      D             UYTK-KWS-SNEKI-RK   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（市場）            =["
      D             UYTK-KWS-SNEKI-SJ   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料                =["
      D             SJTK-TSR            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料                =["
      D             UYTK-TSR            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税                =["
      D             SJTK-S-TAX          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税                =["
      D             UYTK-S-TAX          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税                =["
      D             SJTK-GENSEN-TAX     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税                =["
      D             UYTK-GENSEN-TAX     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他損益            =["
      D             SJTK-ELS-SNEKI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他損益            =["
      D             UYTK-ELS-SNEKI      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定        =["
      D             SJTK-RKSEKJ         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定        =["
      D             UYTK-RKSEKJ         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序                  =["
      D             IDO-KJY-JUN         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価                      =["
      D             TGYOKU-TNK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート                =["
      D             TGYOKU-KWS-RATE     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー                =["
      D             TGYOKU-BRK          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日                    =["
      D             TGYOKU-YKJ-YMD      OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉約定金額残  =["
      D             SJTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉約定金額残  =["
      D             UYTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料            =["
      D             SJTK-TG-TSR         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料            =["
      D             UYTK-TG-TSR         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉手数料残    =["
      D             SJTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉手数料残    =["
      D             UYTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税            =["
      D             SJTK-TG-S-TAX       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税            =["
      D             UYTK-TG-S-TAX       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉消費税残    =["
      D             SJTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉消費税残    =["
      D             UYTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用        =["
      D             SJTK-TG-ELS-HIYO    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用        =["
      D             UYTK-TG-ELS-HIYO    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉その他費用残=["
      D             SJTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉その他費用残=["
      D             UYTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額          =["
      D             SJTK-TG-SSKG        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額          =["
      D             UYTK-TG-SSKG        OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉精算金額残  =["
      D             SJTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉精算金額残  =["
      D             UYTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨引継前受・前払プレミアム=["
      D             SJTK-HT-PPAR-PMM    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨引継前受・前払プレミアム=["
      D             UYTK-HT-PPAR-PMM    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ  =["
      D             OP-TATE-FLG         OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定異動額  =["
      D             SJTK-GSZKP-YTIDOG   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定異動額  =["
      D             UYTK-GSZKP-YTIDOG   OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後源泉税還付予定額残高=["
      D             SJTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後源泉税還付予定額残高=["
      D             UYTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未収金残高=["
      D             SJTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未収金残高=["
      D             UYTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未払金残高=["
      D             SJTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未払金残高=["
      D             UYTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払費用残      =["
      D             SJTK-IDOG-MBHYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払費用残      =["
      D             UYTK-IDOG-MBHYZN    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管評価損益残  =["
      D             SJTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管評価損益残  =["
      D             UYTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管未収収益    =["
      D             SJTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管未収収益    =["
      D             UYTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管前払金評価損益残=["
      D             UYTK-IDOG-IK-PPHKZN OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                      =["
      D             SAKUJO-KBN          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息  =["
      D             SHORT-STEN-KEKA-RSK OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日                =["
      D             SHORT-START-YMD     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日                  =["
      D             SHORT-END-YMD       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード              =["
      D             TSTSK-CD            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード                  =["
      D             HAKO-CD             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":数量単位                      =["
      D             SURYO-TANI          OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":初期設定金額                  =["
      D             SHOKI-SET-KGK       OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                    =["
      D             SK-FLG              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                      =["
      D             SK-DATE             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード  =["
      D             SK-LOGIN-CMP-CD     OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ                =["
      D             SK-SID              OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ            =["
      D             SK-PGMID            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                    =["
      D             UPD-FLG             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                      =["
      D             UPD-DATE            OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード  =["
      D             UPD-LOGIN-CMP-CD    OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ                =["
      D             UPD-SID             OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ            =["
      D             UPD-PGMID           OF  WK-TKMZBW06-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      *-----------------------------------------------------------------
                     ELSE
                       CONTINUE
                     END-IF
                   ELSE
                     CONTINUE
                   END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(普通)."
      D    DISPLAY  CNS-PGM-ID":処理実行日                    =["
      D             SYORI-YMD           OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                        =["
      D             KIDOU-ID            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード                =["
      D             RIYO-CMP-CD         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード                =["
      D             FUND-CD             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード          =["
      D             PTF-CD              OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                      =["
      D             TORI-ID             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":計上基準日                    =["
      D             KEIJOU-KIJUNBI      OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                      =["
      D             AKA-KBN             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№                      =["
      D             ERR-KJY-NO          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                    =["
      D             ERR-KJY-KBN         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                    =["
      D             THRK-ID             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード                =["
      D             SEC-SBT-CD          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":取引内容                      =["
      D             TORI-NAIY           OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":取引事由                      =["
      D             TORI-JIYU           OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード                =["
      D             SIJO-TUKA-CD        OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード                    =["
      D             MEG-CD              OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ      =["
      D             TATE-FLG            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ                        =["
      D             GYOKU-ID            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":約定日                        =["
      D             YKJ-YMD             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":受渡日                        =["
      D             UKE-YMD             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価              =["
      D             SJTK-IDO-BOKA       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価              =["
      D             UYTK-IDO-BOKA       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価              =["
      D             SJTK-BOKA-TNK       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価              =["
      D             UYTK-BOKA-TNK       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート                =["
      D             BOKA-KWS            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価              =["
      D             SJTK-H-BOKA         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価              =["
      D             UYTK-H-BOKA         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             SJTK-H-TNK          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             UYTK-H-TNK          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":異動数量                      =["
      D             IDO-SURYO           OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":異動数量（利付）              =["
      D             IDO-SURYO-RIT       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高        =["
      D             SJTK-IDOG-BOKAZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高        =["
      D             UYTK-IDOG-BOKAZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高                =["
      D             IDOG-SRYZN          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高（利付）        =["
      D             IDOG-SRYZN-RIT      OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金異動額          =["
      D             SJTK-PPAYIDOG       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額          =["
      D             UYTK-PPAYIDOG       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前払金残        =["
      D             SJTK-IDOG-PPAYZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前払金残        =["
      D             UYTK-IDOG-PPAYZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前受金残        =["
      D             SJTK-IDOG-ARECZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前受金残        =["
      D             UYTK-IDOG-ARECZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後仮払金残        =["
      D             SJTK-IDOG-SPAYZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後仮払金残        =["
      D             UYTK-IDOG-SPAYZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買損益              =["
      D             SJTK-BBSNEKI        OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨売買損益              =["
      D             UYTK-BBSNEKI        OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                    =["
      D             UYTK-KWS-SNEKI      OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（利金）            =["
      D             UYTK-KWS-SNEKI-RK   OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（市場）            =["
      D             UYTK-KWS-SNEKI-SJ   OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料                =["
      D             SJTK-TSR            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料                =["
      D             UYTK-TSR            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税                =["
      D             SJTK-S-TAX          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税                =["
      D             UYTK-S-TAX          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税                =["
      D             SJTK-GENSEN-TAX     OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税                =["
      D             UYTK-GENSEN-TAX     OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他損益            =["
      D             SJTK-ELS-SNEKI      OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他損益            =["
      D             UYTK-ELS-SNEKI      OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定        =["
      D             SJTK-RKSEKJ         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定        =["
      D             UYTK-RKSEKJ         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序                  =["
      D             IDO-KJY-JUN         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価                      =["
      D             TGYOKU-TNK          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート                =["
      D             TGYOKU-KWS-RATE     OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー                =["
      D             TGYOKU-BRK          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日                    =["
      D             TGYOKU-YKJ-YMD      OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉約定金額残  =["
      D             SJTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉約定金額残  =["
      D             UYTK-IDOG-TG-YJKNZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料            =["
      D             SJTK-TG-TSR         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料            =["
      D             UYTK-TG-TSR         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉手数料残    =["
      D             SJTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉手数料残    =["
      D             UYTK-IDOG-TG-TSRZN  OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税            =["
      D             SJTK-TG-S-TAX       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税            =["
      D             UYTK-TG-S-TAX       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉消費税残    =["
      D             SJTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉消費税残    =["
      D             UYTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用        =["
      D             SJTK-TG-ELS-HIYO    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用        =["
      D             UYTK-TG-ELS-HIYO    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉その他費用残=["
      D             SJTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉その他費用残=["
      D             UYTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額          =["
      D             SJTK-TG-SSKG        OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額          =["
      D             UYTK-TG-SSKG        OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉精算金額残  =["
      D             SJTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉精算金額残  =["
      D             UYTK-IDOG-TG-SSKGZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨引継前受・前払プレミアム=["
      D             SJTK-HT-PPAR-PMM    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨引継前受・前払プレミアム=["
      D             UYTK-HT-PPAR-PMM    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ  =["
      D             OP-TATE-FLG         OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定異動額  =["
      D             SJTK-GSZKP-YTIDOG   OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定異動額  =["
      D             UYTK-GSZKP-YTIDOG   OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後源泉税還付予定額残高=["
      D             SJTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後源泉税還付予定額残高=["
      D             UYTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未収金残高=["
      D             SJTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未収金残高=["
      D             UYTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未払金残高=["
      D             SJTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未払金残高=["
      D             UYTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払費用残      =["
      D             SJTK-IDOG-MBHYZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払費用残      =["
      D             UYTK-IDOG-MBHYZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管評価損益残  =["
      D             SJTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管評価損益残  =["
      D             UYTK-IDOG-IK-HKSEZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管未収収益    =["
      D             SJTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管未収収益    =["
      D             UYTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管前払金評価損益残=["
      D             UYTK-IDOG-IK-PPHKZN OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                      =["
      D             SAKUJO-KBN          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息  =["
      D             SHORT-STEN-KEKA-RSK OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日                =["
      D             SHORT-START-YMD     OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日                  =["
      D             SHORT-END-YMD       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード              =["
      D             TSTSK-CD            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード                  =["
      D             HAKO-CD             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":数量単位                      =["
      D             SURYO-TANI          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":初期設定金額                  =["
      D             SHOKI-SET-KGK       OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                    =["
      D             SK-FLG              OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                      =["
      D             SK-DATE             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード  =["
      D             SK-LOGIN-CMP-CD     OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ                =["
      D             SK-SID              OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ            =["
      D             SK-PGMID            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                    =["
      D             UPD-FLG             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                      =["
      D             UPD-DATE            OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード  =["
      D             UPD-LOGIN-CMP-CD    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ                =["
      D             UPD-SID             OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ            =["
      D             UPD-PGMID           OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データカーソルオープンフラグ=["
      D             FLG-TKMZBW06-CR1-OPEN"]"
      *-----------------------------------------------------------------
               END-EVALUATE
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  残高異動計算データカーソルオープンフラグ
               MOVE  CNS-OFF            TO  FLG-TKMZBW06-CR1-OPEN
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-009
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-4       DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-FETCH1-EXT.
           EXIT.
      ******************************************************************
      *   残高異動計算データCURSOR CLOSE
      ******************************************************************
      *TKMZBW06-CLOSE1-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 残高異動計算データCURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR1-OPEN= ["
      *D             FLG-TKMZBW06-CR1-OPEN "]"
      *-----------------------------------------------------------------
      *    EXEC  SQL
      *      CLOSE TKMZBW06_CUR1
      *    END-EXEC
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D           "残高異動計算データCUR CLOSE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
      *    IF  SQLCODE = CNS-SQL-NORMAL
      *    THEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR CLOSE  正常"
      *-----------------------------------------------------------------
      *      MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR1-OPEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":CUR OPEN FLAG =["
      *D             FLG-TKMZBW06-CR1-OPEN "]"
      *-----------------------------------------------------------------
      *    ELSE
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR CLOSE  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
      *      MOVE  CNS-PGM-ID
      *        TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
      *      MOVE  CNS-POS-010
      *        TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
      *      MOVE  CNS-RTN-900
      *        TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
      *      MOVE  SQLCODE
      *        TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *        TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
      *      STRING  CNS-SQL-MSG-SELECT,
      *              WK-MSG-1-4         DELIMITED  BY  SIZE
      *        INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
      *      PERFORM  ERR-RTN
      *    END-IF
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***残高異動計算データ"
      *D             "CURSOR CLOSE END ***"
      *-----------------------------------------------------------------
      *    CONTINUE.
      *TKMZBW06-CLOSE1-EXT.
      *    EXIT.
      ******************************************************************
      *        開始時残高履歴再設定処理
      ******************************************************************
       TKMZZR00-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴再設定処理  START"
      *-----------------------------------------------------------------
      *----------  残高履歴CURSOR PREPARE
           PERFORM  TKMZZR00-PRE-RTN
      *----------  残高履歴CURSOR OPEN
           PERFORM  TKMZZR00-OPEN-RTN
      *----------  残高履歴CURSOR FETCH
           PERFORM  TKMZZR00-FETCH-RTN
      *----------  残高履歴CURSOR CLOSE
      **** PERFORM  TKMZZR00-CLOSE-RTN                                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴再設定処理  END"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZZR00-GET-EXT.
           EXIT.
      ******************************************************************
      *    残高履歴CURSOR PREPARE
      ******************************************************************
       TKMZZR00-PRE-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 残高履歴CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZZR00-S
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD           OF  H-TKMZZR00-S,
                 WK-SQL-RIYO-CMP-CD      OF  WK-MSG-1-1
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD               OF  H-TKMZZR00-S,
                 WK-SQL-FUND-CD          OF  WK-MSG-1-1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD                OF  H-TKMZZR00-S,
                 WK-SQL-PTF-CD           OF  WK-MSG-1-1
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD
             TO  H-SEC-SBT-CD            OF  H-TKMZZR00-S,
                 WK-SQL-SEC-SBT-CD       OF  WK-MSG-1-1
      *----------  銘柄コード
           MOVE  WK-MEG-CD
             TO  H-MEG-CD                OF  H-TKMZZR00-S,
                 WK-SQL-MEG-CD           OF  WK-MSG-1-1
      *----------  資産/負債・買建/売建フラグ
           MOVE  WK-TATE-FLG
             TO  H-TATE-FLG              OF  H-TKMZZR00-S,
                 WK-SQL-TATE-FLG         OF  WK-MSG-1-1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID
             TO  H-GYOKU-ID              OF  H-TKMZZR00-S,
                 WK-SQL-GYOKU-ID         OF  WK-MSG-1-1
      *---------- 基準日
           MOVE  WK-KAISI-KJN-YMD
             TO  H-KJN-YMD               OF  H-TKMZZR00-S,
                 WK-SQL-KJN-YMD          OF  WK-MSG-1-1
           INITIALIZE  SQLSTMT01                                        @3212SEINO@@
           MOVE  SQL-SELECT-1-1          TO  SQLSTMT01                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD            OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード=["
      D             H-SEC-SBT-CD         OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード=["
      D             H-MEG-CD             OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産/負債・買建/売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ID=["
      D             H-GYOKU-ID           OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日=["
      D             H-KJN-YMD            OF  H-TKMZZR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT01=[" SQLSTMT01 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZR00-CR-OPEN=["                @3212SEINO@@
      D                          FLG-TKMZZR00-CR-OPEN"]"                @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZZR00-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  残高履歴CURSOR PREPARE
             EXEC  SQL
               PREPARE  S6  FROM  :SQLSTMT01                            @3212SEINO@@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":残高履歴"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-011
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1         DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZZR00-PRE-EXT.
           EXIT.
      ******************************************************************
      *    残高履歴CURSOR OPEN
      ******************************************************************
       TKMZZR00-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZZR00-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZZR00_CUR  CURSOR  FOR  S6
             END-EXEC
             CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZZR00_CUR
               USING :H-TKMZZR00-S.H-RIYO-CMP-CD,
                     :H-TKMZZR00-S.H-FUND-CD,
                     :H-TKMZZR00-S.H-PTF-CD,
                     :H-TKMZZR00-S.H-SEC-SBT-CD,
                     :H-TKMZZR00-S.H-MEG-CD,
                     :H-TKMZZR00-S.H-TATE-FLG,
                     :H-TKMZZR00-S.H-GYOKU-ID,
                     :H-TKMZZR00-S.H-KJN-YMD
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMZZR00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":TKMZZR00 CURSOR OPEN FLAG=["
      D             FLG-TKMZZR00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-012
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-1         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZZR00-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    残高履歴CURSOR FETCH
      ******************************************************************
       TKMZZR00-FETCH-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-TKMZZR00
           EXEC SQL
             FETCH TKMZZR00_CUR
             INTO  :H-TKMZZR00
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH  正常"
      *-----------------------------------------------------------------
      *----------  決算日断面区分
               MOVE  KSN-YMD-DMN-KBN     OF  H-TKMZZR00
                 TO  KSN-YMD-DMN-KBN     OF  TKMZZR00-PARM
      *----------  市場通貨コード
               MOVE  SIJO-TUKA-CD        OF  H-TKMZZR00
                 TO  SIJO-TUKA-CD        OF  TKMZZR00-PARM
      *----------  数量残高
               MOVE  SRYZN               OF  H-TKMZZR00
                 TO  SRYZN               OF  TKMZZR00-PARM
      *----------  簿価為替レート
               MOVE  BOKA-KWS            OF  H-TKMZZR00
                 TO  BOKA-KWS            OF  TKMZZR00-PARM
      *----------  市場通貨簿価残高
               MOVE  SJTK-BOKAZN         OF  H-TKMZZR00
                 TO  SJTK-BOKAZN         OF  TKMZZR00-PARM
      *----------  運用通貨簿価残高
               MOVE  UYTK-BOKAZN         OF  H-TKMZZR00
                 TO  UYTK-BOKAZN         OF  TKMZZR00-PARM
      *----------  市場通貨簿価単価
               MOVE  SJTK-BOKA-TNK       OF  H-TKMZZR00
                 TO  SJTK-BOKA-TNK       OF  TKMZZR00-PARM
      *----------  運用通貨簿価単価
               MOVE  UYTK-BOKA-TNK       OF  H-TKMZZR00
                 TO  UYTK-BOKA-TNK       OF  TKMZZR00-PARM
      *----------  市場通貨前払金残
               MOVE  SJTK-PPAYZN         OF  H-TKMZZR00
                 TO  SJTK-PPAYZN         OF  TKMZZR00-PARM
      *----------  運用通貨前払金残
               MOVE  UYTK-PPAYZN         OF  H-TKMZZR00
                 TO  UYTK-PPAYZN         OF  TKMZZR00-PARM
      *----------  市場通貨前受金残
               MOVE  SJTK-ARECZN         OF  H-TKMZZR00
                 TO  SJTK-ARECZN         OF  TKMZZR00-PARM
      *----------  運用通貨前受金残
               MOVE  UYTK-ARECZN         OF  H-TKMZZR00
                 TO  UYTK-ARECZN         OF  TKMZZR00-PARM
      *----------  市場通貨仮払金残
               MOVE  SJTK-SPAYZN         OF  H-TKMZZR00
                 TO  SJTK-SPAYZN         OF  TKMZZR00-PARM
      *----------  運用通貨仮払金残
               MOVE  UYTK-SPAYZN         OF  H-TKMZZR00
                 TO  UYTK-SPAYZN         OF  TKMZZR00-PARM
      *----------  市場通貨払出単価
               MOVE  SJTK-H-TNK          OF  H-TKMZZR00
                 TO  SJTK-H-TNK          OF  TKMZZR00-PARM
      *----------  運用通貨払出単価
               MOVE  UYTK-H-TNK          OF  H-TKMZZR00
                 TO  UYTK-H-TNK          OF  TKMZZR00-PARM
      *----------  同一コスト継続フラグ
               MOVE  SAME-COST-KZK-FLG   OF  H-TKMZZR00
                 TO  SAME-COST-KZK-FLG   OF  TKMZZR00-PARM
      *----------  市場通貨未収収益計上・戻入額
               MOVE  SJTK-MSSE-KJMIG     OF  H-TKMZZR00
                 TO  SJTK-MSSE-KJMIG     OF  TKMZZR00-PARM
      *----------  運用通貨未収収益計上・戻入額
               MOVE  UYTK-MSSE-KJMIG     OF  H-TKMZZR00
                 TO  UYTK-MSSE-KJMIG     OF  TKMZZR00-PARM
      *----------  数量残高（利付）
               MOVE  SRYZN-RIT           OF  H-TKMZZR00
                 TO  SRYZN-RIT           OF  TKMZZR00-PARM
      *----------  建玉単価
               MOVE  TGYOKU-TNK          OF  H-TKMZZR00
                 TO  TGYOKU-TNK          OF  TKMZZR00-PARM
      *----------  建玉為替レート
               MOVE  TGYOKU-KWS-RATE     OF  H-TKMZZR00
                 TO  TGYOKU-KWS-RATE     OF  TKMZZR00-PARM
      *----------  建玉ブローカー
               MOVE  TGYOKU-BRK          OF  H-TKMZZR00
                 TO  TGYOKU-BRK          OF  TKMZZR00-PARM
      *----------  建玉約定日
               MOVE  TGYOKU-YKJ-YMD      OF  H-TKMZZR00
                 TO  TGYOKU-YKJ-YMD      OF  TKMZZR00-PARM
      *----------  市場通貨建玉約定金額残
               MOVE  SJTK-TG-YJKNZN      OF  H-TKMZZR00
                 TO  SJTK-TG-YJKNZN      OF  TKMZZR00-PARM
      *----------  運用通貨建玉約定金額残
               MOVE  UYTK-TG-YJKNZN      OF  H-TKMZZR00
                 TO  UYTK-TG-YJKNZN      OF  TKMZZR00-PARM
      *----------  市場通貨建玉手数料残
               MOVE  SJTK-TG-TSRZN       OF  H-TKMZZR00
                 TO  SJTK-TG-TSRZN       OF  TKMZZR00-PARM
      *----------  運用通貨建玉手数料残
               MOVE  UYTK-TG-TSRZN       OF  H-TKMZZR00
                 TO  UYTK-TG-TSRZN       OF  TKMZZR00-PARM
      *----------  市場通貨建玉消費税残
               MOVE  SJTK-TG-S-TAXZN     OF  H-TKMZZR00
                 TO  SJTK-TG-S-TAXZN     OF  TKMZZR00-PARM
      *----------  運用通貨建玉消費税残
               MOVE  UYTK-TG-S-TAXZN     OF  H-TKMZZR00
                 TO  UYTK-TG-S-TAXZN     OF  TKMZZR00-PARM
      *----------  市場通貨建玉その他費用残
               MOVE  SJTK-TG-ELS-HIYOZN  OF  H-TKMZZR00
                 TO  SJTK-TG-ELS-HIYOZN  OF  TKMZZR00-PARM
      *----------  運用通貨建玉その他費用残
               MOVE  UYTK-TG-ELS-HIYOZN  OF  H-TKMZZR00
                 TO  UYTK-TG-ELS-HIYOZN  OF  TKMZZR00-PARM
      *----------  市場通貨建玉精算金額残
               MOVE  SJTK-TG-SSKGZN      OF  H-TKMZZR00
                 TO  SJTK-TG-SSKGZN      OF  TKMZZR00-PARM
      *----------  運用通貨建玉精算金額残
               MOVE  UYTK-TG-SSKGZN      OF  H-TKMZZR00
                 TO  UYTK-TG-SSKGZN      OF  TKMZZR00-PARM
      *----------  OP資産負債・買建売建フラグ
               MOVE  OP-TATE-FLG         OF  H-TKMZZR00
                 TO  OP-TATE-FLG         OF  TKMZZR00-PARM
      *----------  市場通貨源泉税還付予定額残高
               MOVE  SJTK-GSZKP-YTZN     OF  H-TKMZZR00
                 TO  SJTK-GSZKP-YTZN     OF  TKMZZR00-PARM
      *----------  運用通貨源泉税還付予定額残高
               MOVE  UYTK-GSZKP-YTZN     OF  H-TKMZZR00
                 TO  UYTK-GSZKP-YTZN     OF  TKMZZR00-PARM
      *----------  決済通貨源泉税還付予定額残高
               MOVE  KSTK-GSZKP-YTZN     OF  H-TKMZZR00
                 TO  KSTK-GSZKP-YTZN     OF  TKMZZR00-PARM
      *----------  市場通貨ノンカバー未収金残高
               MOVE  SJTK-NOCV-MSKZN     OF  H-TKMZZR00
                 TO  SJTK-NOCV-MSKZN     OF  TKMZZR00-PARM
      *----------  運用通貨ノンカバー未収金残高
               MOVE  UYTK-NOCV-MSKZN     OF  H-TKMZZR00
                 TO  UYTK-NOCV-MSKZN     OF  TKMZZR00-PARM
      *----------  市場通貨ノンカバー未払金残高
               MOVE  SJTK-NOCV-MBKZN     OF  H-TKMZZR00
                 TO  SJTK-NOCV-MBKZN     OF  TKMZZR00-PARM
      *----------  運用通貨ノンカバー未払金残高
               MOVE  UYTK-NOCV-MBKZN     OF  H-TKMZZR00
                 TO  UYTK-NOCV-MBKZN     OF  TKMZZR00-PARM
      *----------  短期スタート・エンド経過利息
               MOVE  SHORT-STEN-KEKA-RSK OF  H-TKMZZR00
                 TO  SHORT-STEN-KEKA-RSK OF  TKMZZR00-PARM
      *----------  短期スタート日
               MOVE  SHORT-START-YMD     OF  H-TKMZZR00
                 TO  SHORT-START-YMD     OF  TKMZZR00-PARM
      *----------  短期エンド日
               MOVE  SHORT-END-YMD       OF  H-TKMZZR00
                 TO  SHORT-END-YMD       OF  TKMZZR00-PARM
      *----------  基本会計ベースフラグ
               MOVE  KH-KAIKEI-BASE-FLG  OF  H-TKMZZR00
                 TO  KH-KAIKEI-BASE-FLG  OF  TKMZZR00-PARM
      *----------  投資対象国コード
               MOVE  TSTSK-CD            OF  H-TKMZZR00
                 TO  TSTSK-CD            OF  TKMZZR00-PARM
      *----------  発行国コード
               MOVE  HAKO-CD             OF  H-TKMZZR00
                 TO  HAKO-CD             OF  TKMZZR00-PARM
      *----------  数量単位
               MOVE  SURYO-TANI          OF  H-TKMZZR00
                 TO  SURYO-TANI          OF  TKMZZR00-PARM
      *----------  市場通貨未払費用残
               MOVE  SJTK-MBHYZN         OF  H-TKMZZR00
                 TO  SJTK-MBHYZN         OF  TKMZZR00-PARM
      *----------  運用通貨未払費用残
               MOVE  UYTK-MBHYZN         OF  H-TKMZZR00
                 TO  UYTK-MBHYZN         OF  TKMZZR00-PARM
      *----------  市場通貨未払消費税残
               MOVE  SJTK-MB-S-TAXZN     OF  H-TKMZZR00
                 TO  SJTK-MB-S-TAXZN     OF  TKMZZR00-PARM
      *----------  運用通貨未払消費税残
               MOVE  UYTK-MB-S-TAXZN     OF  H-TKMZZR00
                 TO  UYTK-MB-S-TAXZN     OF  TKMZZR00-PARM
      *----------  市場通貨移管評価損益残
               MOVE  SJTK-IK-HKSEZN      OF  H-TKMZZR00
                 TO  SJTK-IK-HKSEZN      OF  TKMZZR00-PARM
      *----------  運用通貨移管評価損益残
               MOVE  UYTK-IK-HKSEZN      OF  H-TKMZZR00
                 TO  UYTK-IK-HKSEZN      OF  TKMZZR00-PARM
      *----------  市場通貨移管未収収益
               MOVE  SJTK-IK-MSSHEKI     OF  H-TKMZZR00
                 TO  SJTK-IK-MSSHEKI     OF  TKMZZR00-PARM
      *----------  運用通貨移管未収収益
               MOVE  UYTK-IK-MSSHEKI     OF  H-TKMZZR00
                 TO  UYTK-IK-MSSHEKI     OF  TKMZZR00-PARM
      *----------  運用通貨移管前払金評価損益残
               MOVE  UYTK-IK-PPHKZN      OF  H-TKMZZR00
                 TO  UYTK-IK-PPHKZN      OF  TKMZZR00-PARM
      *----------  削除区分
               MOVE  SAKUJO-KBN          OF  H-TKMZZR00
                 TO  SAKUJO-KBN          OF  TKMZZR00-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.開始時残高履歴情報"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分    =["
      D             KSN-YMD-DMN-KBN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード    =["
      D             SIJO-TUKA-CD        OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":数量残高          =["
      D             SRYZN               OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート    =["
      D             BOKA-KWS            OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価残高  =["
      D             SJTK-BOKAZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価残高  =["
      D             UYTK-BOKAZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価  =["
      D             SJTK-BOKA-TNK       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価  =["
      D             UYTK-BOKA-TNK       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金残  =["
      D             SJTK-PPAYZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金残  =["
      D             UYTK-PPAYZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前受金残  =["
      D             SJTK-ARECZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前受金残  =["
      D             UYTK-ARECZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨仮払金残  =["
      D             SJTK-SPAYZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨仮払金残  =["
      D             UYTK-SPAYZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価  =["
      D             SJTK-H-TNK          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価  =["
      D             UYTK-H-TNK          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":同一コスト継続フラグ=["
      D             SAME-COST-KZK-FLG   OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":数量残高（利付）  =["
      D             SRYZN-RIT           OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価          =["
      D             TGYOKU-TNK          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート    =["
      D             TGYOKU-KWS-RATE     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー    =["
      D             TGYOKU-BRK          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日        =["
      D             TGYOKU-YKJ-YMD      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉約定金額残=["
      D             SJTK-TG-YJKNZN      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉約定金額残=["
      D             UYTK-TG-YJKNZN      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料残  =["
      D             SJTK-TG-TSRZN       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料残  =["
      D             UYTK-TG-TSRZN       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税残  =["
      D             SJTK-TG-S-TAXZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税残  =["
      D             UYTK-TG-S-TAXZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用残=["
      D             SJTK-TG-ELS-HIYOZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用残=["
      D             UYTK-TG-ELS-HIYOZN  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額残 =["
      D             SJTK-TG-SSKGZN      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額残 =["
      D             UYTK-TG-SSKGZN      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":OP資産負債・買建売建フラグ=["
      D             OP-TATE-FLG         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定額残高=["
      D             SJTK-GSZKP-YTZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定額残高=["
      D             UYTK-GSZKP-YTZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨源泉税還付予定額残高=["
      D             KSTK-GSZKP-YTZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨ノンカバー未収金残高=["
      D             SJTK-NOCV-MSKZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨ノンカバー未収金残高=["
      D             UYTK-NOCV-MSKZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨ノンカバー未払金残高=["
      D             SJTK-NOCV-MBKZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨ノンカバー未払金残高=["
      D             UYTK-NOCV-MBKZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息=["
      D             SHORT-STEN-KEKA-RSK OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日        =["
      D             SHORT-START-YMD     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日          =["
      D             SHORT-END-YMD       OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ  =["
      D             KH-KAIKEI-BASE-FLG  OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード      =["
      D             TSTSK-CD            OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード          =["
      D             HAKO-CD             OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":数量単位              =["
      D             SURYO-TANI          OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未払費用残    =["
      D             SJTK-MBHYZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未払費用残    =["
      D             UYTK-MBHYZN         OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未払消費税残  =["
      D             SJTK-MB-S-TAXZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未払消費税残  =["
      D             UYTK-MB-S-TAXZN     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨移管評価損益残=["
      D             SJTK-IK-HKSEZN      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管評価損益残=["
      D             UYTK-IK-HKSEZN      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨移管未収収益  =["
      D             SJTK-IK-MSSHEKI     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管未収収益  =["
      D             UYTK-IK-MSSHEKI     OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管前払金評価損益残=["
      D             UYTK-IK-PPHKZN      OF  TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":削除区分              =["
      D             SAKUJO-KBN          OF  TKMZZR00-PARM"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
               INITIALIZE  TKMZZR00-PARM OF  PARM-SMZJ2210-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.開始時残高履歴情報=["
      D             TKMZZR00-PARM        OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-013
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1       DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 残高履歴CURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZZR00-FETCH-EXT.
           EXIT.
      ******************************************************************
      *   残高履歴CURSOR CLOSE
      ******************************************************************
      *TKMZZR00-CLOSE-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR CLOSE START ***"
      *-----------------------------------------------------------------
      *    EXEC  SQL
      *      CLOSE TKMZZR00_CUR
      *    END-EXEC
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"残高履歴CUR CLOSE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
      *    IF  SQLCODE = CNS-SQL-NORMAL
      *    THEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR CLOSE  正常"
      *-----------------------------------------------------------------
      *      MOVE  CNS-OFF              TO  FLG-TKMZZR00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZR00-CR-OPEN =["
      *D             FLG-TKMZZR00-CR-OPEN "]"
      *-----------------------------------------------------------------
      *    ELSE
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR CLOSE  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *         TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
      *       MOVE  CNS-POS-014
      *         TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-1         DELIMITED  BY  SIZE
      *         INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
      *       PERFORM  ERR-RTN
      *     END-IF
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***残高履歴CURSOR CLOSE END ***"
      *-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZZR00-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    2)ワーク断面作成情報編集
      ******************************************************************
       DMN-JH-EDIT-RTN        SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク断面作成情報編集  START "
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.基準日断面情報.基準日種類=["
      D             KJN-YMD-SHRU        OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
             IF  KJN-YMD-SHRU  OF  TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-0
               OR  KJN-YMD-SHRU  OF TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-4
               OR  KJN-YMD-SHRU  OF TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-5
             THEN
               IF  WK-KEIJYO-FLG  =  CNS-X-1
               THEN
                 IF  WK-NORMAL-FLG  =  CNS-X-0
                 THEN
      *--------  計上_決算後
                   MOVE  CNS-X-2
                     TO  WK-KEIJYO-KSG     OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI    OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE     OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO     OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI     OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE      OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO      OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-2
                     TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
                 ELSE
      *--------  計上_決算後
                   MOVE  CNS-X-2
                     TO  WK-KEIJYO-KSG     OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI    OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE     OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO     OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI     OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE      OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO      OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-2
                     TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
                 END-IF
               ELSE
                 IF  WK-NORMAL-FLG  =  CNS-X-1
                 THEN
      *--------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-1
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 ELSE
      *--------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-1
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 END-IF
               END-IF
             ELSE
               IF  WK-KEIJYO-FLG  =  CNS-X-1
               THEN
                 IF  WK-NORMAL-FLG  =  CNS-X-0
                 THEN
      *----------  計上_決算後
                   MOVE  CNS-X-1
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-1
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 ELSE
      *----------  計上_決算後
                   MOVE  CNS-X-1
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-1
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 END-IF
               ELSE
                 IF  WK-NORMAL-FLG  =  CNS-X-1
                 THEN
      *----------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG         OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI        OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-1
                     TO  WK-NORMAL-MAE         OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-1
                   TO  WK-NORMAL-ATO         OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI         OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE          OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO          OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN     OF  WK-DMN-SK-JH
                 ELSE
      *----------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG         OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI        OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE         OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-0
                   TO  WK-NORMAL-ATO         OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI         OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-1
                     TO  WK-START-MAE          OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-1
                     TO  WK-START-ATO          OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN     OF  WK-DMN-SK-JH
                 END-IF
               END-IF
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.計上_決算後=["
      D             WK-KEIJYO-KSG       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算断面なし=["
      D             WK-NORMAL-NASI      OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算前=["
      D             WK-NORMAL-MAE       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算後=["
      D             WK-NORMAL-ATO       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク断面作成情報.開始時_決算断面なし=["
      D             WK-START-NASI       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.開始時_決算前=["
      D             WK-START-MAE        OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.開始時_決算後=["
      D             WK-START-ATO        OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.基準日別更新区分=["
      D             WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク断面作成情報編集 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DMN-JH-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    3)ワーク残高履歴更新編集
      ******************************************************************
       ZNRRK-UD-EDIT-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク残高履歴更新編集  START "
      D    DISPLAY  CNS-PGM-ID":ワーク同一コスト継続フラグ=["
      D             WK-SAME-COST-KZK-FLG"]"
      *-----------------------------------------------------------------
           MOVE  CNS-X-0
             TO  WK-SAME-COST-KZK-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク同一コスト継続フラグ=["
      D             WK-SAME-COST-KZK-FLG"]"
      *-----------------------------------------------------------------
      *---------- ②証券種別は売り続く有効対象判断
           PERFORM  SMZJ4014-RTN
      *---------- ③ワーク計上フラグ=0 且つ ワーク普通フラグ＝1 且つ ワーク売り続く証券区別区分='1'(有効)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["
      D             WK-KEIJYO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["
      D             WK-NORMAL-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く証券区別区分=["
      D             WK-BUY-SEC-SBT-KBN"]"
      *-----------------------------------------------------------------
           IF  WK-KEIJYO-FLG  =  CNS-X-0  AND
               WK-NORMAL-FLG  =  CNS-X-1  AND
               WK-BUY-SEC-SBT-KBN  =  CNS-X-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=0 且つ "
      D             "ワーク普通フラグ＝1 "
      D             "且つ ワーク売り続く証券区別区分='1'(有効)"
      *-----------------------------------------------------------------
      *---------- A)取引事由判定
             PERFORM  SMZJ4012-RTN
      *---------- B)直前残高異動データを取得する
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D               ":ARG1.異動計算パターン.売り続く限り同一コスト=["
      D             URI-TUDUKU-SAME-COST  OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売買フラグ     =["
      D             WK-URIKAI-FLG"]"
      *-----------------------------------------------------------------
             IF  URI-TUDUKU-SAME-COST  OF  PARM-SMZJ2210-ARG1 = CNS-X-1
             AND WK-URIKAI-FLG = CNS-X-2
             THEN
      *---------- (a)残高異動計算データから取得
               PERFORM  SELECT-TKMZBW06-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ=["
      D             WK-DATA-NASI-FLG"]"
      *-----------------------------------------------------------------
               IF  WK-DATA-NASI-FLG  =  CNS-X-1
               THEN
      *---------- (b)残高異動から取得
                 PERFORM  SELECT-TKMZZI00-RTN
               ELSE
                 CONTINUE
               END-IF
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(普通)."
      D    DISPLAY  CNS-PGM-ID":取引事由                      =["
      D             TORI-JIYU           OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             SJTK-H-TNK          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             UYTK-H-TNK          OF  WK-TKMZBW06-NORMAL"]"
      *-----------------------------------------------------------------
      *---------- ワーク売り続く中間
      *---------- 取引事由
               MOVE  TORI-JIYU          OF  WK-TKMZBW06-NORMAL
                 TO  WK-TORI-JIYU       OF  WK-URU-TUZUKI-MID
      *---------- 市場通貨払出単価
               MOVE  SJTK-H-TNK         OF  WK-TKMZBW06-NORMAL
                 TO  WK-SJTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *---------- 運用通貨払出単価
               MOVE  UYTK-H-TNK         OF  WK-TKMZBW06-NORMAL
                 TO  WK-UYTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く中間."
      D    DISPLAY  CNS-PGM-ID":取引事由                      =["
      D             WK-TORI-JIYU        OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             WK-SJTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             WK-UYTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      *-----------------------------------------------------------------
             END-IF
      *---------- C)ワークデータなしフラグ≠1の場合、売買フラグの決定処理
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ=["
      D             WK-DATA-NASI-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-DATA-NASI-FLG  NOT=  CNS-X-1
             THEN
               PERFORM  SMZJ4012C-RTN
             ELSE
               CONTINUE
             END-IF
      *---------- D)ワークデータなしフラグ≠1の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ=["
      D             WK-DATA-NASI-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-DATA-NASI-FLG  NOT=  CNS-X-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D               ":ARG1.異動計算パターン.売り続く限り同一コスト=["
      D             URI-TUDUKU-SAME-COST  OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売買フラグ     =["
      D             WK-URIKAI-FLG"]"
      *-----------------------------------------------------------------
               IF  URI-TUDUKU-SAME-COST   OF  PARM-SMZJ2210-ARG1
                =  CNS-X-1  AND
                  WK-URIKAI-FLG = CNS-X-1
               THEN
      *---------- ワーク同一コスト継続フラグ
                 MOVE  CNS-X-1            TO  WK-SAME-COST-KZK-FLG
               ELSE
      *---------- ワーク同一コスト継続フラグ
                 MOVE  CNS-X-0            TO  WK-SAME-COST-KZK-FLG
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク同一コスト継続フラグ=["
      D             WK-SAME-COST-KZK-FLG"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
      *---------- E)ワーク同一コスト継続フラグ＝'1'の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク同一コスト継続フラグ=["
      D             WK-SAME-COST-KZK-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-SAME-COST-KZK-FLG  =  CNS-X-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く中間."
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             WK-SJTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             WK-UYTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      *-----------------------------------------------------------------
      *---------- ワーク残高異動計算データ(普通)
      *---------- 市場通貨払出単価
               MOVE  WK-SJTK-H-TNK      OF  WK-URU-TUZUKI-MID
                 TO  SJTK-H-TNK         OF  WK-TKMZBW06-NORMAL
      *---------- 運用通貨払出単価
               MOVE  WK-UYTK-H-TNK      OF  WK-URU-TUZUKI-MID
                 TO  UYTK-H-TNK         OF  WK-TKMZBW06-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(普通)."
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             SJTK-H-TNK          OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             UYTK-H-TNK          OF  WK-TKMZBW06-NORMAL"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":①ワーク断面作成情報.計上_決算後=["
      D             WK-KEIJYO-KSG       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-KEIJYO-KSG  OF  WK-DMN-SK-JH  =  CNS-X-1  OR
               WK-KEIJYO-KSG  OF  WK-DMN-SK-JH  =  CNS-X-2
           THEN
      *----------  ワーク残高異動計算データ(対象)
             MOVE  WK-TKMZBW06-KEIJYO   TO  WK-TKMZBW06-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(対象)=["
      D             WK-TKMZBW06-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-5 編集要領
             PERFORM  EDIT-1-5-RTN
      *----------  ワーク残高履歴計算データ(対象).決算日断面区分
             IF  WK-KEIJYO-KSG  OF  WK-DMN-SK-JH  =  CNS-X-1
             THEN
               MOVE  CNS-X-2
                 TO  KSN-YMD-DMN-KBN    OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  CNS-X-0
                 TO  KSN-YMD-DMN-KBN    OF  WK-TKMZBW11-TASYOU
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-1-RTN
      *----------  ワーク残高履歴更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ２
             MOVE  WK-TKMZBW11-TASYOU
               TO  WK-DATA-2            OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-ZNRRK-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２=["
      D             WK-DATA-2           OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":②ワーク断面作成情報."
      D    "普通_決算断面なし=["
      D             WK-NORMAL-NASI      OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-NASI  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク残高異動計算データ(対象)
             MOVE  WK-TKMZBW06-NORMAL   TO  WK-TKMZBW06-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(対象)=["
      D             WK-TKMZBW06-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-5 編集要領
             PERFORM  EDIT-1-5-RTN
      *----------  ワーク残高履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-0
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-1-RTN
      *----------  ワーク残高履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１
             MOVE  WK-TKMZBW11-TASYOU
               TO  WK-DATA-1            OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-ZNRRK-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":③ワーク断面作成情報.普通_決算前=["
      D             WK-NORMAL-MAE       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-MAE  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク残高異動計算データ(対象)
             MOVE  WK-TKMZBW06-NORMAL   TO  WK-TKMZBW06-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(対象)=["
      D             WK-TKMZBW06-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-5 編集要領
             PERFORM  EDIT-1-5-RTN
      *----------  ワーク残高履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-1
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-1-RTN
      *----------  ワーク残高履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１
             MOVE  WK-TKMZBW11-TASYOU
               TO  WK-DATA-1            OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-ZNRRK-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":④ワーク断面作成情報.普通_決算後=["
      D             WK-NORMAL-ATO       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-ATO  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク残高異動計算データ(対象)
             MOVE  WK-TKMZBW06-NORMAL   TO  WK-TKMZBW06-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(対象)=["
      D             WK-TKMZBW06-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-5 編集要領
             PERFORM  EDIT-1-5-RTN
      *----------  ワーク残高履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-2
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-1-RTN
      *----------  ワーク残高履歴更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ２
             MOVE  WK-TKMZBW11-TASYOU
               TO  WK-DATA-2            OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-ZNRRK-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２=["
      D             WK-DATA-2           OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑤ワーク断面作成情報."
      D    "開始時_決算断面なし=["
      D             WK-START-NASI       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-NASI  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-3 編集要領
             PERFORM  EDIT-1-3-RTN
      *----------  ワーク残高履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-0
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-1-RTN
      *----------  ワーク残高履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１
             MOVE  WK-TKMZBW11-TASYOU
               TO  WK-DATA-1            OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-ZNRRK-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑥ワーク断面作成情報.開始時_決算前=["
      D             WK-START-MAE        OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-MAE   OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-3 編集要領
             PERFORM  EDIT-1-3-RTN
      *----------  ワーク残高履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-1
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-1-RTN
      *----------  ワーク残高履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１
             MOVE  WK-TKMZBW11-TASYOU
               TO  WK-DATA-1            OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-ZNRRK-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑦ワーク断面作成情報.開始時_決算後=["
      D             WK-START-ATO        OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-ATO   OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-3 編集要領
             PERFORM  EDIT-1-3-RTN
      *----------  ワーク残高履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-2
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-1-RTN
      *----------  ワーク残高履歴更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ２
             MOVE  WK-TKMZBW11-TASYOU
               TO  WK-DATA-2            OF  WK-ZNRRK-KOUSIN
      *----------  ワーク残高履歴更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-ZNRRK-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２=["
      D             WK-DATA-2           OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク残高履歴更新編集  END "
      *-----------------------------------------------------------------
           CONTINUE.
       ZNRRK-UD-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ4014】取引事由判定
      ******************************************************************
       SMZJ4014-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 【SMZJ4014】証券種別判定  START "
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4014-INOUT
                       PARM-RTNPKG
      *----------  証券種別
           MOVE  SEC-SBT-CD            OF  TKMZBW03-PARM
             TO  SEC-SBT-CD            OF  PARM-SMZJ4014-ARG1
      *----------  判定対象区分
           MOVE  CNS-X-A
             TO  HANTEI-TARGET-KBN     OF  PARM-SMZJ4014-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":証券種別コード=["
      D             SEC-SBT-CD         OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID  ":判定対象区分=["
      D             HANTEI-TARGET-KBN  OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID  ":CALL SMZJ4014 STAR"
      *-----------------------------------------------------------------
           CALL  "SMZJ4014"            USING  PARM-SMZJ4014-INOUT
                                              PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":CALL SMZJ4014 END"
      D    DISPLAY  CNS-PGM-ID  ":売り続く証券種別区分=["
      D             BUY-SEC-SBT-KBN    OF  PARM-SMZJ4014-ARG2"]"
      *-----------------------------------------------------------------
      *----------  ワーク売り続く証券種別区分
             MOVE  BUY-SEC-SBT-KBN    OF  PARM-SMZJ4014-ARG2
               TO  WK-BUY-SEC-SBT-KBN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID  ":ワーク売り続く証券種別区分=["
      D             WK-BUY-SEC-SBT-KBN"]"
      D    DISPLAY  CNS-PGM-ID": 【SMZJ4014】証券種別判定  END "
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4014-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ4012】取引事由判定
      ******************************************************************
       SMZJ4012-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 【SMZJ4012】取引事由判定  START "
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4012-INOUT
                       PARM-RTNPKG
      *----------  取引事由
           MOVE  TORI-JIYU              OF  WK-TKMZBW06-NORMAL
             TO  TORI-JIYU              OF  PARM-SMZJ4012-INOUT
      *----------  判定対象区分
           MOVE  CNS-X-6
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由     =["
      D              TORI-JIYU          OF  PARM-SMZJ4012-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分 =["
      D              HANTEI-TARGET-KBN  OF  PARM-SMZJ4012-INOUT"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4012"             USING  PARM-SMZJ4012-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4012)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
             =  CNS-RTN-000
           THEN
      *----------  売買フラグ
             MOVE  URIKAI-FLG           OF  PARM-SMZJ4012-ARG2
               TO  WK-URIKAI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":売買フラグ     =["
      D             WK-URIKAI-FLG"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 【SMZJ4012】取引事由判定  END "
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4012-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ4012】取引事由判定
      ******************************************************************
       SMZJ4012C-RTN          SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 【SMZJ4012】取引事由判定  START "
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4012-INOUT
                       PARM-RTNPKG
      *----------  取引事由
           MOVE  WK-TORI-JIYU           OF  WK-URU-TUZUKI-MID
             TO  TORI-JIYU              OF  PARM-SMZJ4012-INOUT
      *----------  判定対象区分
           MOVE  CNS-X-6
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由     =["
      D              TORI-JIYU          OF  PARM-SMZJ4012-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分 =["
      D              HANTEI-TARGET-KBN  OF  PARM-SMZJ4012-INOUT"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4012"             USING  PARM-SMZJ4012-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4012)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
             =  CNS-RTN-000
           THEN
      *----------  売買フラグ
             MOVE  URIKAI-FLG           OF  PARM-SMZJ4012-ARG2
               TO  WK-URIKAI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":売買フラグ     =["
      D             WK-URIKAI-FLG"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 【SMZJ4012】取引事由判定  END "
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4012C-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データを取得する(別紙1-16)
      ******************************************************************
       SELECT-TKMZBW06-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データを取得(別紙1-16) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT16                                        @3212SEINO@@
      *----------  利用会社コード
           MOVE  RIYO-CMP-CD            OF  TKMZBW03-PARM
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW06-16-S,
                 WK-RIYO-CMP-CD1        OF  WK-MSG-1-16
      *----------  処理実行日
           MOVE  SYORI-YMD              OF  TKMZBW03-PARM
             TO  H-SYORI-YMD            OF  H-TKMZBW06-16-S,
                 WK-SYORI-YMD1          OF  WK-MSG-1-16
      *----------  起動ID
           MOVE  KIDOU-ID               OF  TKMZBW03-PARM
             TO  H-KIDOU-ID             OF  H-TKMZBW06-16-S,
                 WK-KIDOU-ID1           OF  WK-MSG-1-16
      *----------  ファンドコード
           MOVE  FUND-CD                OF  TKMZBW03-PARM
             TO  H-FUND-CD              OF  H-TKMZBW06-16-S,
                 WK-FUND-CD1            OF  WK-MSG-1-16
      *----------  ポートフォリオコード
           MOVE  PTF-CD                 OF  TKMZBW03-PARM
             TO  H-PTF-CD               OF  H-TKMZBW06-16-S,
                 WK-PTF-CD1             OF  WK-MSG-1-16
      *----------  証券種別コード
           MOVE  SEC-SBT-CD             OF  TKMZBW03-PARM
             TO  H-SEC-SBT-CD           OF  H-TKMZBW06-16-S,
                 WK-SEC-SBT-CD1         OF  WK-MSG-1-16
      *----------  銘柄コード
           MOVE  MEG-CD                 OF  TKMZBW03-PARM
             TO  H-MEG-CD               OF  H-TKMZBW06-16-S,
                 WK-MEG-CD1             OF  WK-MSG-1-16
      *----------  資産負債・買建売建フラグ
           MOVE  TATE-FLG               OF  TKMZBW03-PARM
             TO  H-TATE-FLG             OF  H-TKMZBW06-16-S,
                 WK-TATE-FLG1           OF  WK-MSG-1-16
      *----------  玉ＩＤ
           MOVE  GYOKU-ID               OF  TKMZBW03-PARM
             TO  H-GYOKU-ID             OF  H-TKMZBW06-16-S
                 WK-GYOKU-ID1           OF  WK-MSG-1-16
      *----------  異動計上順序
           MOVE  IDO-KJY-JUN            OF  WK-TKMZBW06-NORMAL
             TO  H-IDO-KJY-JUN          OF  H-TKMZBW06-16-S,
                 WK-IDO-KJY-JUN1        OF  WK-MSG-1-16
      *----------  TBL
           MOVE  SQL-TBL-TKMZBW06
             TO  SQL-TBL-ID-16          OF  SQL-SELECT-1-16,
                 WK-MSG-TKMZBW06        OF  WK-MSG-1-16
           MOVE  SQL-SELECT-1-16        TO  SQLSTMT16                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日          =["
      D             H-SYORI-YMD          OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID              =["
      D             H-KIDOU-ID           OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード      =["
      D             H-SEC-SBT-CD         OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード          =["
      D             H-MEG-CD             OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産負債・買建売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ＩＤ              =["
      D             H-GYOKU-ID           OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":異動計上順序        =["
      D             H-IDO-KJY-JUN        OF  H-TKMZBW06-16-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT16=[" SQLSTMT16 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR16-OPEN=["              @3212SEINO@@
      D                          FLG-TKMZBW06-CR16-OPEN "]"             @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZBW06-CR16-OPEN = CNS-OFF                         @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  残高異動計算データCURSOR PREPARE
             EXEC  SQL
               PREPARE  S16  FROM  :SQLSTMT16
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D       ":残高異動計算データCURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-015
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-16         DELIMITED  BY  SIZE
                 INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZBW06_CUR3  CURSOR  FOR  S16
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZBW06_CUR3
               USING :H-TKMZBW06-16-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON              TO  FLG-TKMZBW06-CR16-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR16-OPEN=["
      D             FLG-TKMZBW06-CR16-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-016
               TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-16         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZBW06_CUR3
             INTO  :H-TKMZBW06-16
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *----------  ワーク取引事由
               MOVE  H-TORI-JIYU        OF  H-TKMZBW06-16
                 TO  WK-TORI-JIYU       OF  WK-URU-TUZUKI-MID
      *----------  ワーク市場通貨払出単価
               MOVE  H-SJTK-H-TNK       OF  H-TKMZBW06-16
                 TO  WK-SJTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *----------  ワーク運用通貨払出単価
               MOVE  H-UYTK-H-TNK       OF  H-TKMZBW06-16
                 TO  WK-UYTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く中間."
      D    DISPLAY  CNS-PGM-ID":取引事由                      =["
      D             WK-TORI-JIYU        OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             WK-SJTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             WK-UYTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  ワークデータなしフラグ ← 1
               MOVE  CNS-X-1            TO  WK-DATA-NASI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ=["
      D                                              WK-DATA-NASI-FLG"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-017
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-16      DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH END ***"
      *-----------------------------------------------------------------@3212SEINO@@
      *D*  DISPLAY  CNS-PGM-ID                                          @3212SEINO@@
      *D*           ":*** 残高異動計算データCURSOR CLOSE START ***"     @3212SEINO@@
      *D*  DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR16-OPEN= ["             @3212SEINO@@
      *D*           FLG-TKMZBW06-CR16-OPEN "]"                          @3212SEINO@@
      *-----------------------------------------------------------------
      ***  EXEC  SQL                                                    @3212SEINO@@
      ***    CLOSE TKMZBW06_CUR3                                        @3212SEINO@@
      ***  END-EXEC                                                     @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D*  DISPLAY  CNS-PGM-ID"残高異動計算データ"                      @3212SEINO@@
      *D*           "CUR CLOSE SQLCODE=["SQLCODE"]"                     @3212SEINO@@
      *-----------------------------------------------------------------
      ***  IF  SQLCODE = CNS-SQL-NORMAL                                 @3212SEINO@@
      ***  THEN                                                         @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D*  DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR CLOSE  正常"   @3212SEINO@@
      *-----------------------------------------------------------------
      ***    MOVE  CNS-OFF               TO  FLG-TKMZBW06-CR16-OPEN     @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D*  DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR16-OPEN =["             @3212SEINO@@
      *D*           FLG-TKMZBW06-CR16-OPEN "]"                          @3212SEINO@@
      *-----------------------------------------------------------------
      ***  ELSE                                                         @3212SEINO@@
      *----------  エラー検知プログラム名
      ***      MOVE  CNS-PGM-ID                                         @3212SEINO@@
      ***        TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1          @3212SEINO@@
      *----------  ポジション
      ***      MOVE  CNS-POS-018                                        @3212SEINO@@
      ***        TO  ERR-POS            OF  PARM-SCZY1170-ARG1          @3212SEINO@@
      *----------  リターンコード
      ***      MOVE  CNS-RTN-900                                        @3212SEINO@@
      ***        TO  RTN-CD             OF  PARM-SCZY1170-ARG1          @3212SEINO@@
      *----------  詳細リターンコード
      ***      MOVE  SQLCODE                                            @3212SEINO@@
      ***        TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1          @3212SEINO@@
      *----------  詳細リターンコードデコードフラグ
      ***      MOVE  CNS-DETAIL-1                                       @3212SEINO@@
      ***        TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1          @3212SEINO@@
      *---------- フリーメッセージ
      ***      STRING  CNS-SQL-MSG-SELECT,                              @3212SEINO@@
      ***              WK-MSG-1-16      DELIMITED  BY  SIZE             @3212SEINO@@
      ***        INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1          @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D*  DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["         @3212SEINO@@
      *D*           ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"       @3212SEINO@@
      *D*  DISPLAY  CNS-PGM-ID":ERR-POS                     =["         @3212SEINO@@
      *D*           ERR-POS             OF  PARM-SCZY1170-ARG1"]"       @3212SEINO@@
      *D*  DISPLAY  CNS-PGM-ID":RTN-CD                      =["         @3212SEINO@@
      *D*           RTN-CD              OF  PARM-SCZY1170-ARG1"]"       @3212SEINO@@
      *D*  DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["         @3212SEINO@@
      *D*           DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"       @3212SEINO@@
      *D*  DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["         @3212SEINO@@
      *D*           DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"       @3212SEINO@@
      *D*  DISPLAY  CNS-PGM-ID":FREE-MSG                    =["         @3212SEINO@@
      *D*           FREE-MSG            OF  PARM-SCZY1170-ARG1"]"       @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  エラー処理
      ***      PERFORM  ERR-RTN                                         @3212SEINO@@
      ***  END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D*  DISPLAY  CNS-PGM-ID ":***残高異動計算データCUR CLOSE END ***"@3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データを取得(別紙1-16) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SELECT-TKMZBW06-EXT.
           EXIT.
      ******************************************************************
      *    残高異動を取得する(別紙1-17)
      ******************************************************************
       SELECT-TKMZZI00-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動を取得(別紙1-17) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
      ***  INITIALIZE  SQLSTMT                                          @3212SEINO@@
           INITIALIZE  SQLSTMT17-1                                      @3212SEINO@@
                       SQLSTMT17-2                                      @3212SEINO@@
      *----------  利用会社コード
           MOVE  RIYO-CMP-CD            OF  TKMZBW03-PARM
             TO  H-RIYO-CMP-CD          OF  H-TKMZZI00-17-S,
                 WK-RIYO-CMP-CD1        OF  WK-MSG-1-17
      *----------  ファンドコード
           MOVE  FUND-CD                OF  TKMZBW03-PARM
             TO  H-FUND-CD              OF  H-TKMZZI00-17-S,
                 WK-FUND-CD1            OF  WK-MSG-1-17
      *----------  ポートフォリオコード
           MOVE  PTF-CD                 OF  TKMZBW03-PARM
             TO  H-PTF-CD               OF  H-TKMZZI00-17-S,
                 WK-PTF-CD1             OF  WK-MSG-1-17
      *----------  証券種別コード
           MOVE  SEC-SBT-CD             OF  TKMZBW03-PARM
             TO  H-SEC-SBT-CD           OF  H-TKMZZI00-17-S,
                 WK-SEC-SBT-CD1         OF  WK-MSG-1-17
      *----------  銘柄コード
           MOVE  MEG-CD                 OF  TKMZBW03-PARM
             TO  H-MEG-CD               OF  H-TKMZZI00-17-S,
                 WK-MEG-CD1             OF  WK-MSG-1-17
      *----------  資産負債・買建売建フラグ
           MOVE  TATE-FLG               OF  TKMZBW03-PARM
             TO  H-TATE-FLG             OF  H-TKMZZI00-17-S,
                 WK-TATE-FLG1           OF  WK-MSG-1-17
      *----------  玉ＩＤ
           MOVE  GYOKU-ID               OF  TKMZBW03-PARM
             TO  H-GYOKU-ID             OF  H-TKMZZI00-17-S
                 WK-GYOKU-ID1           OF  WK-MSG-1-17
      *----------  計上基準日
           MOVE  KAISI-KJN-YMD          OF  TKMZBW03-PARM
             TO  H-KEIJOU-KIJUNBI-K     OF  H-TKMZZI00-17-S
                 WK-KEIJOU-KIJUNBI-K    OF  WK-MSG-1-17
           MOVE  KJN-YMD                OF  TKMZBW03-PARM
             TO  H-KEIJOU-KIJUNBI-J     OF  H-TKMZZI00-17-S
                 WK-KEIJOU-KIJUNBI-J    OF  WK-MSG-1-17
      *----------  原取引ID
           MOVE  TORI-ID                OF  WK-TKMZBW06-NORMAL
             TO  H-TORI-ID              OF  H-TKMZZI00-17-S
                 WK-TORI-ID1            OF  WK-MSG-1-17
      *---------- ORDER BY
           IF  YKJ-UKE-JUN-FLG          OF  PARM-SMZJ2210-ARG1
            =  CNS-X-1
           THEN
      *---------- 受渡日
             MOVE  "UKE_YMD"
               TO  WK-UKK-YMD            OF  SQL-SELECT-1-17
           ELSE
             MOVE  "KEIJOU_KIJUNBI"
               TO  WK-UKK-YMD            OF  SQL-SELECT-1-17
           END-IF
      *----------  TBL
           MOVE  SQL-TBL-TKMZZI00
             TO  SQL-TBL-ID-17           OF  SQL-SELECT-1-17,
                 WK-MSG-TKMZBW06         OF  WK-MSG-1-17
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード      =["
      D             H-SEC-SBT-CD         OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード          =["
      D             H-MEG-CD             OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産負債・買建売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ＩＤ              =["
      D             H-GYOKU-ID           OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.銘柄別断面情報.開始基準日=["
      D             H-KEIJOU-KIJUNBI-K   OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.銘柄別断面情報.基準日=["
      D             H-KEIJOU-KIJUNBI-J   OF  H-TKMZZI00-17-S"]"
      D    DISPLAY  CNS-PGM-ID ":原取引ID            =["
      D             H-TORI-ID            OF  H-TKMZZI00-17-S"]"
      *D*  DISPLAY  CNS-PGM-ID ":SQLSTMT=[" SQLSTMT "]"                 @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":YKJ-UKE-JUN-FLG OF PARM-SMZJ2210-ARG1="
      D             "["YKJ-UKE-JUN-FLG       OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
           IF  YKJ-UKE-JUN-FLG          OF  PARM-SMZJ2210-ARG1
            =  CNS-X-1
           THEN
             MOVE  SQL-SELECT-1-17         TO  SQLSTMT17-1              @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ARG1.約定ベース受渡順フラグ＝'1'"      @3212SEINO@@
      D                          "の場合、受渡日"                       @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT17-1=[" SQLSTMT17-1 "]"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZI00-CR17-OPEN=["              @3212SEINO@@
      D                          FLG-TKMZZI00-CR17-OPEN "]"             @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
             IF  FLG-TKMZZI00-CR17-OPEN = CNS-OFF                       @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  残高異動CURSOR PREPARE
      ***  EXEC  SQL                                                    @3212SEINO@@
      ***    PREPARE  S17  FROM  :SQLSTMT                               @3212SEINO@@
      ***  END-EXEC                                                     @3212SEINO@@
               EXEC  SQL                                                @3212SEINO@@
                 PREPARE  S17_1  FROM  :SQLSTMT17-1                     @3212SEINO@@
               END-EXEC                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D       ":残高異動CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-019
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-17         DELIMITED  BY  SIZE
                   INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZZI00_CUR3_1  CURSOR  FOR  S17_1
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZZI00_CUR3_1
                 USING :H-TKMZZI00-17-S
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               MOVE  CNS-ON              TO  FLG-TKMZZI00-CR17-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZI00-CR17-OPEN=["
      D             FLG-TKMZZI00-CR17-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-020
                 TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-17        DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
             EXEC SQL
               FETCH TKMZZI00_CUR3_1
               INTO  :H-TKMZZI00-17
             END-EXEC
           ELSE
             MOVE  SQL-SELECT-1-17         TO  SQLSTMT17-2              @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ARG1.約定ベース受渡順フラグ<>'1'"      @3212SEINO@@
      D                          "の場合、計上基準日"                   @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT17-2=[" SQLSTMT17-2 "]"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZI00-CR17-OPEN2=["             @3212SEINO@@
      D                          FLG-TKMZZI00-CR17-OPEN2 "]"            @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
             IF  FLG-TKMZZI00-CR17-OPEN2 = CNS-OFF                      @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  残高異動CURSOR PREPARE
      ***  EXEC  SQL                                                    @3212SEINO@@
      ***    PREPARE  S17  FROM  :SQLSTMT                               @3212SEINO@@
      ***  END-EXEC                                                     @3212SEINO@@
               EXEC  SQL                                                @3212SEINO@@
                 PREPARE  S17_2  FROM  :SQLSTMT17-2                     @3212SEINO@@
               END-EXEC                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D       ":残高異動CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-019
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-17         DELIMITED  BY  SIZE
                   INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZZI00_CUR3_2  CURSOR  FOR  S17_2
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZZI00_CUR3_2
                 USING :H-TKMZZI00-17-S
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE  =  CNS-SQL-NORMAL
             THEN
               MOVE  CNS-ON              TO  FLG-TKMZZI00-CR17-OPEN2
      *-----------------<DEBUG>-----------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZI00-CR17-OPEN2=["
      D             FLG-TKMZZI00-CR17-OPEN2"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-020
                 TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-17        DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
             EXEC SQL
               FETCH TKMZZI00_CUR3_2
               INTO  :H-TKMZZI00-17
             END-EXEC
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *----------  ワークデータなしフラグ ← 0
               MOVE  CNS-X-0            TO  WK-DATA-NASI-FLG
      *----------  ワーク取引事由
               MOVE  H-TORI-JIYU        OF  H-TKMZZI00-17
                 TO  WK-TORI-JIYU        OF  WK-URU-TUZUKI-MID
      *----------  ワーク市場通貨払出単価
               MOVE  H-SJTK-H-TNK       OF  H-TKMZZI00-17
                 TO  WK-SJTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *----------  ワーク運用通貨払出単価
               MOVE  H-UYTK-H-TNK       OF  H-TKMZZI00-17
                 TO  WK-UYTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ        =["
      D             WK-DATA-NASI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く中間."
      D    DISPLAY  CNS-PGM-ID":取引事由                      =["
      D             WK-TORI-JIYU        OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             WK-SJTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             WK-UYTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  ワーク同一コスト継続フラグ
               MOVE  SAME-COST-KZK-FLG  OF  TKMZZR00-PARM
                 TO  WK-SAME-COST-KZK-FLG
      *----------  ワーク市場通貨払出単価
               MOVE  SJTK-H-TNK         OF  TKMZZR00-PARM
                 TO  WK-SJTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *----------  ワーク運用通貨払出単価
               MOVE  UYTK-H-TNK         OF  TKMZZR00-PARM
                 TO  WK-UYTK-H-TNK      OF  WK-URU-TUZUKI-MID
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク同一コスト継続フラグ    =["
      D             WK-SAME-COST-KZK-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く中間."
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価              =["
      D             WK-SJTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価              =["
      D             WK-UYTK-H-TNK       OF  WK-URU-TUZUKI-MID "]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-021
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-17      DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID
      *D             ":*** 残高異動CURSOR CLOSE START ***"              @3212SEINO@@
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZI00-CR17-OPEN= ["            @3212SEINO@@
      *D             FLG-TKMZZI00-CR17-OPEN "]"                         @3212SEINO@@
      *-----------------------------------------------------------------
      *    EXEC  SQL                                                    @3212SEINO@@
      *      CLOSE TKMZZI00_CUR3                                        @3212SEINO@@
      *    END-EXEC                                                     @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"残高異動"                               @3212SEINO@@
      *D             "CUR CLOSE SQLCODE=["SQLCODE"]"                    @3212SEINO@@
      *-----------------------------------------------------------------
      *    IF  SQLCODE = CNS-SQL-NORMAL                                 @3212SEINO@@
      *    THEN                                                         @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動CURSOR CLOSE  正常"            @3212SEINO@@
      *-----------------------------------------------------------------
      *       MOVE  CNS-OFF               TO  FLG-TKMZZI00-CR17-OPEN    @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZI00-CR17-OPEN =["            @3212SEINO@@
      *D             FLG-TKMZZI00-CR17-OPEN "]"                         @3212SEINO@@
      *-----------------------------------------------------------------
      *     ELSE                                                        @3212SEINO@@
      *----------  エラー検知プログラム名
      *         MOVE  CNS-PGM-ID                                        @3212SEINO@@
      *           TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1         @3212SEINO@@
      *----------  ポジション
      *         MOVE  WK-MSKR-ERPO-FETCH                                @3212SEINO@@
      *           TO  ERR-POS            OF  PARM-SCZY1170-ARG1         @3212SEINO@@
      *----------  リターンコード
      *         MOVE  CNS-RTN-900                                       @3212SEINO@@
      *           TO  RTN-CD             OF  PARM-SCZY1170-ARG1         @3212SEINO@@
      *----------  詳細リターンコード
      *         MOVE  SQLCODE                                           @3212SEINO@@
      *           TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1         @3212SEINO@@
      *----------  詳細リターンコードデコードフラグ
      *         MOVE  CNS-DETAIL-1                                      @3212SEINO@@
      *           TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1         @3212SEINO@@
      *---------- フリーメッセージ
      *         STRING  CNS-SQL-MSG-SELECT,                             @3212SEINO@@
      *                 WK-MSG-1-17      DELIMITED  BY  SIZE            @3212SEINO@@
      *           INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1         @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["        @3212SEINO@@
      *D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@@
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["        @3212SEINO@@
      *D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@@
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["        @3212SEINO@@
      *D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@@
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["        @3212SEINO@@
      *D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@@
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["        @3212SEINO@@
      *D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@@
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["        @3212SEINO@@
      *D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"      @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  エラー処理
      *         PERFORM  ERR-RTN                                        @3212SEINO@@
      *     END-IF                                                      @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***残高異動CUR CLOSE END ***"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動を取得(別紙1-17) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SELECT-TKMZZI00-EXT.
           EXIT.
      ******************************************************************
      *    5)残高履歴計算データ更新
      ******************************************************************
       ZNRRK-CALC-UD-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 残高履歴計算データ更新  START "
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-1-YUKOU-ZN-KBN  OF  WK-ZNRRK-KOUSIN = CNS-X-1 OR
               WK-DATA-2-YUKOU-ZN-KBN  OF  WK-ZNRRK-KOUSIN = CNS-X-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD  "]"
      *-----------------------------------------------------------------
      *******    テーマNo.3049  20110705 修正  開始    ***************
            IF    WK-SEC-SBT-CD(1:3)  NOT  =  CNS-EXC
      *       AND WK-SEC-SBT-CD  NOT  =  CNS-EXCB
      *       AND WK-SEC-SBT-CD  NOT  =  CNS-EXCS
      *******    テーマNo.3049  20110705 修正  終了    ***************
            THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.投資対象国コード=["
      D             TSTSK-CD            OF  WK-DATA-1
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.投資対象国コード=["
      D             TSTSK-CD            OF  WK-DATA-2
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  A)(ワーク残高履歴更新.データ１.投資対象国コード＝SPACE
      *----------  AND ワーク残高履歴更新.データ１有効残高区分＝'1'(有効))
      *----------  OR (ワーク残高履歴更新.データ２.投資対象国コード＝SPACE
      *----------  AND ワーク残高履歴更新.データ２有効残高区分＝'1'(有効))の場合、
             IF ( TSTSK-CD  OF  WK-DATA-1 OF  WK-ZNRRK-KOUSIN = SPACE
              AND WK-DATA-1-YUKOU-ZN-KBN  OF  WK-ZNRRK-KOUSIN = CNS-X-1)
              OR ( TSTSK-CD OF  WK-DATA-2 OF  WK-ZNRRK-KOUSIN = SPACE
              AND WK-DATA-2-YUKOU-ZN-KBN  OF  WK-ZNRRK-KOUSIN = CNS-X-1)
             THEN
               MOVE  CNS-MS   TO  WK-MS-KR-FLG
               MOVE  CNS-063  TO  WK-MSKR-ERPO-PRE
               MOVE  CNS-064  TO  WK-MSKR-ERPO-OPEN
               MOVE  CNS-065  TO  WK-MSKR-ERPO-FETCH
               MOVE  CNS-066  TO  WK-MSKR-ERPO-CLOSE
               PERFORM  TSHKCODE-GET-RTN
             ELSE
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.発行国コード=["
      D             HAKO-CD             OF  WK-DATA-1
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.発行国コード=["
      D             HAKO-CD             OF  WK-DATA-2
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  B)(ワーク残高履歴更新.データ１.発行国コード＝SPACE
      *----------  AND  ワーク残高履歴更新.データ１有効残高区分＝'1'(有効))
      *----------  OR (ワーク残高履歴更新.データ２.発行国コード＝SPACE
      *----------  AND ワーク残高履歴更新.データ２有効残高区分＝'1'(有効))の場合、
             IF ( HAKO-CD   OF  WK-DATA-1 OF  WK-ZNRRK-KOUSIN = SPACE
              AND WK-DATA-1-YUKOU-ZN-KBN  OF  WK-ZNRRK-KOUSIN = CNS-X-1)
              OR ( HAKO-CD  OF  WK-DATA-2 OF  WK-ZNRRK-KOUSIN = SPACE
              AND WK-DATA-2-YUKOU-ZN-KBN  OF  WK-ZNRRK-KOUSIN = CNS-X-1)
             THEN
               MOVE  CNS-KR   TO  WK-MS-KR-FLG
               MOVE  CNS-067  TO  WK-MSKR-ERPO-PRE
               MOVE  CNS-068  TO  WK-MSKR-ERPO-OPEN
               MOVE  CNS-069  TO  WK-MSKR-ERPO-FETCH
               MOVE  CNS-070  TO  WK-MSKR-ERPO-CLOSE
               PERFORM  TSHKCODE-GET-RTN
             ELSE
               CONTINUE
             END-IF
            ELSE
             CONTINUE
            END-IF
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-1-FLG  OF  WK-ZNRRK-KOUSIN  =  CNS-X-1  AND
               WK-DATA-1-YUKOU-ZN-KBN   OF  WK-ZNRRK-KOUSIN = CNS-X-1
           THEN
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.資産負債・買建"
      D             "売建フラグ=["WK-TATE-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-TATE-FLG  =  CNS-TATE-FLG-L
             THEN
      *----------  A)ワーク残高履歴更新.データ１.市場通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ１.市場通貨未収収益計上・戻入額＋ARG1.決算前の未収収益計上.市場通貨未収収益
               COMPUTE  SJTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  SJTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     +  SJTK-MS-SHEKI  OF  KESSAN-ZE-M-RSK-KJY
      *----------  ワーク残高履歴更新.データ１.運用通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ１.運用通貨未収収益計上・戻入額＋ARG1.決算前の未収収益計上.運用通貨未収収益
               COMPUTE  UYTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  UYTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     +  UYTK-MS-SHEKI  OF  KESSAN-ZE-M-RSK-KJY
             ELSE
      *----------  A)ワーク残高履歴更新.データ１.市場通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ１.市場通貨未収収益計上・戻入額－ARG1.決算前の未収収益計上.市場通貨未収収益
               COMPUTE  SJTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  SJTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     -  SJTK-MS-SHEKI  OF  KESSAN-ZE-M-RSK-KJY
      *----------  ワーク残高履歴更新.データ１.運用通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ１.運用通貨未収収益計上・戻入額－ARG1.決算前の未収収益計上.運用通貨未収収益
               COMPUTE  UYTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  UYTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     -  UYTK-MS-SHEKI  OF  KESSAN-ZE-M-RSK-KJY
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.市場通貨未収収益計上"
      D             "・戻入額=["
      D             SJTK-MSSE-KJMIG   OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.運用通貨未収収益計上"
      D             "・戻入額=["
      D             UYTK-MSSE-KJMIG   OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.銘柄別断面情報.資産/負債・買建/売建フラグ=["
      D             TATE-FLG            OF  TKMZBW03-PARM"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.市場通貨未収収益=["
      D             SJTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.決算前の未収収益計上.市場通貨未収収益=["
      D             SJTK-MS-SHEKI  OF  KESSAN-ZE-M-RSK-KJY"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.運用通貨未収収益=["
      D             UYTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.決算前の未収収益計上.運用通貨未収収益=["
      D             UYTK-MS-SHEKI  OF  KESSAN-ZE-M-RSK-KJY"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.市場通貨未収収益≠999999999999999.999の場合、
             IF  SJTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999999-999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.市場通貨未"
      D             "収収益≠999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ市場通貨前払金異動額集計=["
      D             MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.市場通貨未収収益←
      *ワーク残高履歴更新.データ１.市場通貨未収収益－ワーク残高履歴更新.データ１.市場通貨未収収益計上・戻入額
      * ＋ARG1.跨ぎ市場通貨前払金異動額集計
               COMPUTE  SJTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  SJTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     -  SJTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.市場通貨未"
      D             "収収益=999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.市場通貨未"
      D             "収収益計上・戻入額 =["
      D    SJTK-MSSE-KJMIG     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  SJTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                 =  CNS-999999999999999-999
             AND SJTK-MSSE-KJMIG  OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
             NOT = ZERO
             THEN
               COMPUTE  SJTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  CNS-MINUS
                     *  SJTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
               CONTINUE
             END-IF
      *----------  ワーク残高履歴更新.データ１.運用通貨未収収益≠999999999999999.999の場合、
             IF  UYTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999999-999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.運用通貨未"
      D             "収収益≠999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ運用通貨前払金異動額集計=["
      D             MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.運用通貨未収収益←
      *ワーク残高履歴更新.データ１.運用通貨未収収益－ワーク残高履歴更新.データ１.運用通貨未収収益計上・戻入額
      * ＋ARG1.跨ぎ運用通貨前払金異動額集計
               COMPUTE  UYTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  UYTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     -  UYTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.運用通貨未"
      D             "収収益=999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.運用通貨未"
      D             "収収益計上・戻入額 = ["
      D    UYTK-MSSE-KJMIG  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.市場通貨未収収益=["
      D             SJTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.運用通貨未収収益=["
      D             UYTK-MS-SHEKI OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":データ１.市場通貨経過利息=["
      D             SJTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.市場通貨経過利息≠999999999999.999999の場合、
             IF  SJTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999-999999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.市場通貨経"
      D             "過利息≠999999999999.999999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ市場通貨前払金異動額集計=["
      D             MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.市場通貨経過利息←
      *ワーク残高履歴更新.データ１.市場通貨経過利息 ＋ARG1.跨ぎ市場通貨前払金異動額集計
               COMPUTE  SJTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  SJTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.市場通貨経"
      D             "過利息=999999999999.999999の場合"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.市場通貨経過利息=["
      D             SJTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":データ１.運用通貨経過利息=["
      D             UYTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.運用通貨経過利息≠999999999999.999999の場合、
             IF  UYTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999-999999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.運用通貨経"
      D             "過利息≠999999999999.999999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ運用通貨前払金異動額集計=["
      D             MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.運用通貨経過利息←
      *ワーク残高履歴更新.データ１.運用通貨経過利息 ＋ARG1.跨ぎ運用通貨前払金異動額集計
               COMPUTE  UYTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     =  UYTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１.運用通貨経"
      D             "過利息=999999999999.999999の場合"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.運用通貨経過利息=["
      D             UYTK-KEKA-RSK OF WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  D)簿価残マイナスチェック(ワーク残高履歴更新.データ1.証券種別コード≠OOXZの場合は、行う)
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ1."
      D             "証券種別コード=["
      D             SEC-SBT-CD       OF  WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１."
      D             "市場通貨簿価残高=["
      D             SJTK-BOKAZN      OF  WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ1.証券種別コード≠OOXZの場合は、行う
             IF  SEC-SBT-CD          OF  WK-DATA-1 OF WK-ZNRRK-KOUSIN
             NOT  =  CNS-OOXZ
             THEN
      *----------  ワーク残高履歴更新.データ１.市場通貨簿価残高<0の場合
               IF  SJTK-BOKAZN  OF WK-DATA-1 OF WK-ZNRRK-KOUSIN  <  ZERO
               THEN
                 MOVE  CNS-X-1
                   TO  MINUS-SJTK-FLG-1   OF  PARM-SMZJ2210-ARG2
                 MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-1
                                          OF  WK-ZNRRK-KOUSIN
                   TO  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
               ELSE
                 CONTINUE
               END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（市場通貨"
      D    "簿価)=["MINUS-SJTK-FLG-1      OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分1=["
      D             KSN-YMD-DMN-KBN-1     OF  PARM-SMZJ2210-ARG2"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１."
      D             "運用通貨簿価残高=["
      D             UYTK-BOKAZN      OF WK-DATA-1  OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF WK-DATA-1  OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.運用通貨簿価残高<0の場合
               IF  UYTK-BOKAZN OF WK-DATA-1 OF WK-ZNRRK-KOUSIN  <  ZERO
               THEN
                 MOVE  CNS-X-1
                   TO  MINUS-UYTK-FLG-1   OF  PARM-SMZJ2210-ARG2
                 MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-1
                                          OF  WK-ZNRRK-KOUSIN
                   TO  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
               ELSE
                 CONTINUE
               END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（運用通貨"
      D    "簿価)=["MINUS-UYTK-FLG-1      OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分1 =["
      D             KSN-YMD-DMN-KBN-1     OF  PARM-SMZJ2210-ARG2"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１."
      D             "数量残高=["
      D             SRYZN            OF  WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-1 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ１.数量残高<0の場合
               IF  SRYZN  OF WK-DATA-1    OF WK-ZNRRK-KOUSIN  <  ZERO
               THEN
                 MOVE  CNS-X-1
                   TO  MINUS-SRYZN-FLG-1  OF  PARM-SMZJ2210-ARG2
                 MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-1
                                          OF  WK-ZNRRK-KOUSIN
                   TO  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
               ELSE
                 CONTINUE
               END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（数量残高)=["
      D             MINUS-SRYZN-FLG-1   OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分1 =["
      D             KSN-YMD-DMN-KBN-1   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
             ELSE
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ1."
      D    "証券種別コード = OOXZの場合 処理続く"
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（市場通貨"
      D    "簿価)=["MINUS-SJTK-FLG-1    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（運用通貨"
      D    "簿価)=["MINUS-UYTK-FLG-1    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（数量残高)=["
      D             MINUS-SRYZN-FLG-1   OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分1 =["
      D             KSN-YMD-DMN-KBN-1   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             MOVE  WK-DATA-1       OF  WK-ZNRRK-KOUSIN
               TO  H-TKMZBW11-I
             MOVE  SYORI-YMD       OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SYORI-YMD       OF  WK-MSG-TKMZBW11
             MOVE  KIDOU-ID        OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KIDOU-ID        OF  WK-MSG-TKMZBW11
             MOVE  RIYO-CMP-CD     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-RIYO-CMP-CD     OF  WK-MSG-TKMZBW11
             MOVE  FUND-CD         OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-FUND-CD         OF  WK-MSG-TKMZBW11
             MOVE  PTF-CD          OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-PTF-CD          OF  WK-MSG-TKMZBW11
             MOVE  SEC-SBT-CD      OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SEC-SBT-CD      OF  WK-MSG-TKMZBW11
             MOVE  MEG-CD          OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-MEG-CD          OF  WK-MSG-TKMZBW11
             MOVE  TATE-FLG        OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TATE-FLG        OF  WK-MSG-TKMZBW11
             MOVE  GYOKU-ID        OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-GYOKU-ID        OF  WK-MSG-TKMZBW11
             MOVE  KJN-YMD         OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KJN-YMD         OF  WK-MSG-TKMZBW11
             MOVE  KSN-YMD-DMN-KBN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KSN-YMD-DMN-KBN OF  WK-MSG-TKMZBW11
             MOVE  SIJO-TUKA-CD    OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SIJO-TUKA-CD    OF  WK-MSG-TKMZBW11
             MOVE  SRYZN           OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SRYZN           OF  WK-MSG-TKMZBW11
             MOVE  SJTK-BOKAZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-BOKAZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-BOKAZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-BOKAZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-BOKA-TNK   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-BOKA-TNK   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-BOKA-TNK   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-BOKA-TNK   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-PPAYZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-PPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-PPAYZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-PPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-ARECZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-ARECZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-ARECZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-ARECZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-SPAYZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-SPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-SPAYZN     OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-SPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-H-TNK      OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-H-TNK      OF  WK-MSG-TKMZBW11
             MOVE  UYTK-H-TNK      OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-H-TNK      OF  WK-MSG-TKMZBW11
             MOVE  SAME-COST-KZK-FLG
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SAME-COST-KZK-FLG
                                          OF  WK-MSG-TKMZBW11
             MOVE  SJTK-KEKA-RSK   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-KEKA-RSK   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-KEKA-RSK   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-KEKA-RSK   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-MS-SHEKI   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-MS-SHEKI   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-MS-SHEKI   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-MS-SHEKI   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-GENSEN-TAX OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-GENSEN-TAX OF  WK-MSG-TKMZBW11
             MOVE  UYTK-GENSEN-TAX OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-GENSEN-TAX OF  WK-MSG-TKMZBW11
             MOVE  HYK-KWS         OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-HYK-KWS         OF  WK-MSG-TKMZBW11
             MOVE  GENS-TAX-HYK-KWS
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-GENS-TAX-HYK-KWS
                                   OF  WK-MSG-TKMZBW11
             MOVE  FACTOR-RENDOU-KESU
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-FACTOR-RENDOU-KESU
                                   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-MSSE-KJMIG
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-MSSE-KJMIG
                                   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-MSSE-KJMIG
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-MSSE-KJMIG
                                   OF  WK-MSG-TKMZBW11
             MOVE  SRYZN-RIT       OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SRYZN-RIT       OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-TNK      OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-TNK      OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-KWS-RATE OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-KWS-RATE OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-BRK      OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-BRK      OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-YKJ-YMD  OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-YKJ-YMD  OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-YJKNZN  OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-YJKNZN  OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-YJKNZN  OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-YJKNZN  OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-TSRZN   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-TSRZN   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-TSRZN   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-TSRZN   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-S-TAXZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-S-TAXZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-S-TAXZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-S-TAXZN OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-ELS-HIYOZN
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-ELS-HIYOZN
                                   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-ELS-HIYOZN
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-ELS-HIYOZN
                                   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-SSKGZN  OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-SSKGZN  OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-SSKGZN  OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-SSKGZN  OF  WK-MSG-TKMZBW11
             MOVE  SJTK-GSZKP-YTZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-GSZKP-YTZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-GSZKP-YTZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-GSZKP-YTZN OF  WK-MSG-TKMZBW11
             MOVE  SJTK-NOCV-MSKZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-NOCV-MSKZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-NOCV-MSKZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-NOCV-MSKZN OF  WK-MSG-TKMZBW11
             MOVE  SJTK-NOCV-MBKZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-NOCV-MBKZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-NOCV-MBKZN OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-NOCV-MBKZN OF  WK-MSG-TKMZBW11
             MOVE  SHORT-STEN-KEKA-RSK
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SHORT-STEN-KEKA-RSK
                                   OF  WK-MSG-TKMZBW11
             MOVE  SHORT-START-YMD OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SHORT-START-YMD OF  WK-MSG-TKMZBW11
             MOVE  SHORT-END-YMD   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SHORT-END-YMD   OF  WK-MSG-TKMZBW11
             MOVE  KH-KAIKEI-BASE-FLG
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KH-KAIKEI-BASE-FLG
                                   OF  WK-MSG-TKMZBW11
             MOVE  SK-LOGIN-CMP-CD OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SK-LOGIN-CMP-CD OF  WK-MSG-TKMZBW11
             MOVE  UPD-LOGIN-CMP-CD
                                   OF  WK-DATA-1  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UPD-LOGIN-CMP-CD
                                   OF  WK-MSG-TKMZBW11
             MOVE  CNS-POS-022          TO  WK-ERR-POS
             MOVE  CNS-POS-023          TO  WK-ERR-POS1
             MOVE  CNS-POS-024          TO  WK-ERR-POS2
             PERFORM  TKMZBW11-INSERT-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新."
      D             "データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.銘柄別断面情報.資産/負債・買建/売建フラグ=["
      D             TATE-FLG            OF  TKMZBW03-PARM"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ2.市場通貨未収収益=["
      D             SJTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.決算後の未収収益計上.市場通貨未収収益=["
      D             SJTK-MS-SHEKI  OF  KESSAN-GO-M-RSK-KJY"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ2.運用通貨未収収益=["
      D             UYTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.決算後の未収収益計上.運用通貨未収収益=["
      D             UYTK-MS-SHEKI  OF  KESSAN-GO-M-RSK-KJY"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-2-FLG  OF  WK-ZNRRK-KOUSIN  =  CNS-X-1  AND
               WK-DATA-2-YUKOU-ZN-KBN   OF  WK-ZNRRK-KOUSIN = CNS-X-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ": 銘柄別断面情報.資産負債・買建"
      D             "売建フラグ=["WK-TATE-FLG"]"
      *-----------------------------------------------------------------
             IF  WK-TATE-FLG  =  CNS-TATE-FLG-L
             THEN
      *----------  A)ワーク残高履歴更新.データ２.市場通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ２.市場通貨未収収益計上・戻入額＋ARG1.決算後の未収収益計上.市場通貨未収収益
               COMPUTE  SJTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  SJTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     +  SJTK-MS-SHEKI  OF  KESSAN-GO-M-RSK-KJY
      *----------  ワーク残高履歴更新.データ２.運用通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ２.運用通貨未収収益計上・戻入額＋ARG1.決算後の未収収益計上.運用通貨未収収益
               COMPUTE  UYTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  UYTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     +  UYTK-MS-SHEKI  OF  KESSAN-GO-M-RSK-KJY
             ELSE
      *----------  A)ワーク残高履歴更新.データ２.市場通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ２.市場通貨未収収益計上・戻入額－ARG1.決算後の未収収益計上.市場通貨未収収益
               COMPUTE  SJTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  SJTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     -  SJTK-MS-SHEKI  OF  KESSAN-GO-M-RSK-KJY
      *----------  ワーク残高履歴更新.データ２.運用通貨未収収益計上・戻入額←
      *ワーク残高履歴更新.データ２.運用通貨未収収益計上・戻入額－ARG1.決算後の未収収益計上.運用通貨未収収益
               COMPUTE  UYTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  UYTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     -  UYTK-MS-SHEKI  OF  KESSAN-GO-M-RSK-KJY
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.市場通貨未収収益計上"
      D             "・戻入額=["
      D             SJTK-MSSE-KJMIG   OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.運用通貨未収収益計上"
      D             "・戻入額=["
      D             UYTK-MSSE-KJMIG   OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ2.市場通貨未収収益≠999999999999999.999の場合、
             IF  SJTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999999-999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２.市場通貨未"
      D             "収収益≠999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ市場通貨前払金異動額集計=["
      D             MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ２.市場通貨未収収益←
      *ワーク残高履歴更新.データ２.市場通貨未収収益－ワーク残高履歴更新.データ２.市場通貨未収収益計上・戻入額
      * ＋ARG1.跨ぎ市場通貨前払金異動額集計
               COMPUTE  SJTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  SJTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     -  SJTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２.市場通貨未"
      D             "収収益=999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２.市場通貨未"
      D             "収収益計上・戻入額 = ["
      D    SJTK-MSSE-KJMIG  OF WK-DATA-2  OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             IF  SJTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                 = CNS-999999999999999-999
             AND SJTK-MSSE-KJMIG  OF WK-DATA-2  OF  WK-ZNRRK-KOUSIN
             NOT = ZERO
             THEN
               COMPUTE  SJTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  CNS-MINUS
                     *  SJTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
               CONTINUE
             END-IF
      *----------  ワーク残高履歴更新.データ２.運用通貨未収収益≠999999999999999.999の場合、
             IF  UYTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999999-999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２.運用通貨未"
      D             "収収益≠999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ運用通貨前払金異動額集計=["
      D             MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ２.運用通貨未収収益←
      *ワーク残高履歴更新.データ２.運用通貨未収収益－ワーク残高履歴更新.データ２.運用通貨未収収益計上・戻入額
      * ＋ARG1.跨ぎ運用通貨前払金異動額集計
               COMPUTE  UYTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  UYTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     -  UYTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２.運用通貨未"
      D             "収収益=999999999999999.999の場合"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２.運用通貨未"
      D             "収収益計上・戻入額 = ["
      D    UYTK-MSSE-KJMIG  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.市場通貨未収収益=["
      D             SJTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.運用通貨未収収益=["
      D             UYTK-MS-SHEKI OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":データ2.市場通貨経過利息=["
      D             SJTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ2.市場通貨経過利息≠999999999999.999999の場合、
             IF  SJTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999-999999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2.市場通貨経"
      D             "過利息≠999999999999.999999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ市場通貨前払金異動額集計=["
      D             MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ2.市場通貨経過利息←
      *ワーク残高履歴更新.データ2.市場通貨経過利息－【SMZJ2211】.ARG2.跨ぎ市場通貨前払金異動額集計
               COMPUTE  SJTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  SJTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-SJTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2.市場通貨経"
      D             "過利息=999999999999.999999の場合"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ2.市場通貨経過利息=["
      D             SJTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":データ2.運用通貨経過利息=["
      D             UYTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ2.運用通貨経過利息≠999999999999.999999の場合、
             IF  UYTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
             NOT = CNS-999999999999-999999
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2.運用通貨経"
      D             "過利息≠999999999999.999999の場合"
      D    DISPLAY  CNS-PGM-ID":ARG1.跨ぎ運用通貨前払金異動額集計=["
      D             MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ2.運用通貨経過利息←
      *ワーク残高履歴更新.データ2.運用通貨経過利息－【SMZJ2211】.ARG2.跨ぎ運用通貨前払金異動額集計
               COMPUTE  UYTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     =  UYTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN
                     +  MATAGI-UYTK-PPAYIDOG  OF  PARM-SMZJ2210-ARG1
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2.運用通貨経"
      D             "過利息=999999999999.999999の場合"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ2.運用通貨経過利息=["
      D             UYTK-KEKA-RSK OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  D)簿価残マイナスチェック(ワーク残高履歴更新.データ２.証券種別コード≠OOXZの場合は、行う)
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２."
      D             "証券種別コード=["
      D             SEC-SBT-CD       OF  WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2."
      D             "市場通貨簿価残高=["
      D             SJTK-BOKAZN      OF  WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ２.証券種別コード≠OOXZの場合は、行う
             IF  SEC-SBT-CD          OF  WK-DATA-2 OF WK-ZNRRK-KOUSIN
             NOT  =  CNS-OOXZ
             THEN
      *----------  ワーク残高履歴更新.データ2.市場通貨簿価残高<0の場合
               IF  SJTK-BOKAZN  OF WK-DATA-2 OF WK-ZNRRK-KOUSIN  <  ZERO
               THEN
                 MOVE  CNS-X-1
                   TO  MINUS-SJTK-FLG-2   OF  PARM-SMZJ2210-ARG2
                 MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-2
                                          OF  WK-ZNRRK-KOUSIN
                   TO  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
               ELSE
                 CONTINUE
               END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（市場通貨"
      D    "簿価)=["MINUS-SJTK-FLG-2      OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分2 =["
      D             KSN-YMD-DMN-KBN-2     OF  PARM-SMZJ2210-ARG2"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2."
      D             "運用通貨簿価残高=["
      D             UYTK-BOKAZN      OF  WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ2.運用通貨簿価残高<0の場合
               IF  UYTK-BOKAZN OF WK-DATA-2 OF WK-ZNRRK-KOUSIN  <  ZERO
               THEN
                 MOVE  CNS-X-1
                   TO  MINUS-UYTK-FLG-2   OF  PARM-SMZJ2210-ARG2
                 MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-2
                                          OF  WK-ZNRRK-KOUSIN
                   TO  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
               ELSE
                 CONTINUE
               END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（運用通貨"
      D    "簿価)=["MINUS-UYTK-FLG-2      OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分2 =["
      D             KSN-YMD-DMN-KBN-2     OF  PARM-SMZJ2210-ARG2"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2."
      D             "数量残高=["
      D             SRYZN            OF WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-2 OF WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク残高履歴更新.データ2.数量残高<0の場合
               IF  SRYZN    OF WK-DATA-2  OF WK-ZNRRK-KOUSIN  <  ZERO
               THEN
                 MOVE  CNS-X-1
                   TO  MINUS-SRYZN-FLG-2  OF  PARM-SMZJ2210-ARG2
                 MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-2
                                          OF  WK-ZNRRK-KOUSIN
                   TO  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
               ELSE
                 CONTINUE
               END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（数量残高)=["
      D             MINUS-SRYZN-FLG-2    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分2 =["
      D             KSN-YMD-DMN-KBN-2    OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
             ELSE
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ2."
      D    "証券種別コード = OOXZの場合 処理続く"
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（市場通貨"
      D    "簿価)=["MINUS-SJTK-FLG-2    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（運用通貨"
      D    "簿価)=["MINUS-UYTK-FLG-2    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（数量残高)=["
      D             MINUS-SRYZN-FLG-2   OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分2 =["
      D             KSN-YMD-DMN-KBN-2   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
             MOVE  WK-DATA-2       OF  WK-ZNRRK-KOUSIN
               TO  H-TKMZBW11-I
             MOVE  SYORI-YMD       OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SYORI-YMD       OF  WK-MSG-TKMZBW11
             MOVE  KIDOU-ID        OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KIDOU-ID        OF  WK-MSG-TKMZBW11
             MOVE  RIYO-CMP-CD     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-RIYO-CMP-CD     OF  WK-MSG-TKMZBW11
             MOVE  FUND-CD         OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-FUND-CD         OF  WK-MSG-TKMZBW11
             MOVE  PTF-CD          OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-PTF-CD          OF  WK-MSG-TKMZBW11
             MOVE  SEC-SBT-CD      OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SEC-SBT-CD      OF  WK-MSG-TKMZBW11
             MOVE  MEG-CD          OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-MEG-CD          OF  WK-MSG-TKMZBW11
             MOVE  TATE-FLG        OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TATE-FLG        OF  WK-MSG-TKMZBW11
             MOVE  GYOKU-ID        OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-GYOKU-ID        OF  WK-MSG-TKMZBW11
             MOVE  KJN-YMD         OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KJN-YMD         OF  WK-MSG-TKMZBW11
             MOVE  KSN-YMD-DMN-KBN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KSN-YMD-DMN-KBN OF  WK-MSG-TKMZBW11
             MOVE  SIJO-TUKA-CD    OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SIJO-TUKA-CD    OF  WK-MSG-TKMZBW11
             MOVE  SRYZN           OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SRYZN           OF  WK-MSG-TKMZBW11
             MOVE  SJTK-BOKAZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-BOKAZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-BOKAZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-BOKAZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-BOKA-TNK   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-BOKA-TNK   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-BOKA-TNK   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-BOKA-TNK   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-PPAYZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-PPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-PPAYZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-PPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-ARECZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-ARECZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-ARECZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-ARECZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-SPAYZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-SPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  UYTK-SPAYZN     OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-SPAYZN     OF  WK-MSG-TKMZBW11
             MOVE  SJTK-H-TNK      OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-H-TNK      OF  WK-MSG-TKMZBW11
             MOVE  UYTK-H-TNK      OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-H-TNK      OF  WK-MSG-TKMZBW11
             MOVE  SAME-COST-KZK-FLG
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SAME-COST-KZK-FLG
                                   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-KEKA-RSK   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-KEKA-RSK   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-KEKA-RSK   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-KEKA-RSK   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-MS-SHEKI   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-MS-SHEKI   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-MS-SHEKI   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-MS-SHEKI   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-GENSEN-TAX OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-GENSEN-TAX OF  WK-MSG-TKMZBW11
             MOVE  UYTK-GENSEN-TAX OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-GENSEN-TAX OF  WK-MSG-TKMZBW11
             MOVE  HYK-KWS         OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-HYK-KWS         OF  WK-MSG-TKMZBW11
             MOVE  GENS-TAX-HYK-KWS
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-GENS-TAX-HYK-KWS
                                   OF  WK-MSG-TKMZBW11
             MOVE  FACTOR-RENDOU-KESU
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-FACTOR-RENDOU-KESU
                                   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-MSSE-KJMIG
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-MSSE-KJMIG
                                   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-MSSE-KJMIG
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-MSSE-KJMIG
                                   OF  WK-MSG-TKMZBW11
             MOVE  SRYZN-RIT       OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SRYZN-RIT       OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-TNK      OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-TNK      OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-KWS-RATE OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-KWS-RATE OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-BRK      OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-BRK      OF  WK-MSG-TKMZBW11
             MOVE  TGYOKU-YKJ-YMD  OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-TGYOKU-YKJ-YMD  OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-YJKNZN  OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-YJKNZN  OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-YJKNZN  OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-YJKNZN  OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-TSRZN   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-TSRZN   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-TSRZN   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-TSRZN   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-S-TAXZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-S-TAXZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-S-TAXZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-S-TAXZN OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-ELS-HIYOZN
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-ELS-HIYOZN
                                   OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-ELS-HIYOZN
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-ELS-HIYOZN
                                   OF  WK-MSG-TKMZBW11
             MOVE  SJTK-TG-SSKGZN  OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-TG-SSKGZN  OF  WK-MSG-TKMZBW11
             MOVE  UYTK-TG-SSKGZN  OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-TG-SSKGZN  OF  WK-MSG-TKMZBW11
             MOVE  SJTK-GSZKP-YTZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-GSZKP-YTZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-GSZKP-YTZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-GSZKP-YTZN OF  WK-MSG-TKMZBW11
             MOVE  SJTK-NOCV-MSKZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-NOCV-MSKZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-NOCV-MSKZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-NOCV-MSKZN OF  WK-MSG-TKMZBW11
             MOVE  SJTK-NOCV-MBKZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SJTK-NOCV-MBKZN OF  WK-MSG-TKMZBW11
             MOVE  UYTK-NOCV-MBKZN OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UYTK-NOCV-MBKZN OF  WK-MSG-TKMZBW11
             MOVE  SHORT-STEN-KEKA-RSK
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SHORT-STEN-KEKA-RSK
                                   OF  WK-MSG-TKMZBW11
             MOVE  SHORT-START-YMD OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SHORT-START-YMD OF  WK-MSG-TKMZBW11
             MOVE  SHORT-END-YMD   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SHORT-END-YMD   OF  WK-MSG-TKMZBW11
             MOVE  KH-KAIKEI-BASE-FLG
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-KH-KAIKEI-BASE-FLG
                                   OF  WK-MSG-TKMZBW11
             MOVE  SK-LOGIN-CMP-CD OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-SK-LOGIN-CMP-CD OF  WK-MSG-TKMZBW11
             MOVE  UPD-LOGIN-CMP-CD
                                   OF  WK-DATA-2  OF  WK-ZNRRK-KOUSIN
               TO  WK-SQL-UPD-LOGIN-CMP-CD
                                   OF  WK-MSG-TKMZBW11
             MOVE  CNS-POS-025          TO  WK-ERR-POS
             MOVE  CNS-POS-026          TO  WK-ERR-POS1
             MOVE  CNS-POS-027          TO  WK-ERR-POS2
             PERFORM  TKMZBW11-INSERT-RTN
           ELSE
             CONTINUE
           END-IF
      *----------  ③ワーク残高履歴更新.データ１有効残高区分＝'1'(有効)
      *----------  または ワーク残高履歴更新.データ２有効残高区分＝'1'(有効)の場合、
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１有効残高区分"
      D             "=["WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２有効残高区分"
      D             "=["WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-1-YUKOU-ZN-KBN   OF  WK-ZNRRK-KOUSIN = CNS-X-1 OR
               WK-DATA-2-YUKOU-ZN-KBN   OF  WK-ZNRRK-KOUSIN = CNS-X-1
           THEN
      *----------  ARG2.履歴作成フラグ
             MOVE  CNS-RIREKI-SAKUSEI-FLG-1
               TO  RIREKI-SAKUSEI-FLG   OF  PARM-SMZJ2210-ARG2
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.履歴作成フラグ=["
      D             RIREKI-SAKUSEI-FLG  OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID": 残高履歴計算データ更新  END "
      *-----------------------------------------------------------------
           CONTINUE.
       ZNRRK-CALC-UD-EXT.
           EXIT.
      ******************************************************************
      *    未収収益と債券過去経過利息からデータを取得する
      ******************************************************************
       TSHKCODE-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 未収収益と債券過去経過利息からデータを取得する"
      D    " START ***"
      *-----------------------------------------------------------------
      *----------  未収収益と債券過去経過利息からデータCURSOR PREPARE
           PERFORM  TKMZMS-KR-PRE-RTN
      *----------  未収収益と債券過去経過利息からデータCURSOR OPEN
           PERFORM  TKMZMS-KR-OPEN-RTN
      *----------  未収収益と債券過去経過利息からデータCURSOR FETCH
           PERFORM  TKMZMS-KR-FETCH-RTN
      *----------  未収収益と債券過去経過利息からデータCURSOR CLOSE
      *    PERFORM  TKMZMS-KR-CLOSE-RTN                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 未収収益と債券過去経過利息からデータを取得する"
      D    " END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TSHKCODE-GET-EXT.
           EXIT.
      ******************************************************************
      *    未収収益と債券過去経過利息からデータCURSOR PREPARE
      ******************************************************************
       TKMZMS-KR-PRE-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 未収収益と債券過去経過利息からデータCURSOR PREPARE"
      D    " START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク未収収益/債券過去経過利息フラグ=["
      D             WK-MS-KR-FLG"]"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZKR-MS-S
                       SQLSTMT14-1                                      @3212SEINO@@
                       SQLSTMT14-2                                      @3212SEINO@@
      *----------  未収収益/債券過去経過利息フラグ
           IF  WK-MS-KR-FLG = CNS-MS
           THEN
             MOVE  CNS-TSTSK-CD
               TO  S-TSHKKUNI           OF  S-SELECT1-1-14,
                   S-TSHKKUNI           OF  KR-WHERE-1-14,
                   S-TSHKKUNI           OF  S-SELECT2-1-14,
                   S-TSHKKUNI           OF  MS-WHERE-1-14,
                   WK-SQL-S-TSHKKUNI1   OF  WK-MSG-1-14,
                   WK-SQL-S-TSHKKUNI2   OF  WK-MSG-1-14
           ELSE
             MOVE  CNS-HAKO-CD
               TO  S-TSHKKUNI           OF  S-SELECT1-1-14,
                   S-TSHKKUNI           OF  KR-WHERE-1-14,
                   S-TSHKKUNI           OF  S-SELECT2-1-14,
                   S-TSHKKUNI           OF  MS-WHERE-1-14,
                   WK-SQL-S-TSHKKUNI1   OF  WK-MSG-1-14,
                   WK-SQL-S-TSHKKUNI2   OF  WK-MSG-1-14
           END-IF
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD           OF  H-TKMZKR-MS-S,
                 WK-SQL-RIYO-CMP-CD1     OF  WK-MSG-1-14,
                 WK-SQL-RIYO-CMP-CD2     OF  WK-MSG-1-14
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD               OF  H-TKMZKR-MS-S,
                 WK-SQL-FUND-CD1         OF  WK-MSG-1-14,
                 WK-SQL-FUND-CD2         OF  WK-MSG-1-14
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD                OF  H-TKMZKR-MS-S,
                 WK-SQL-PTF-CD1          OF  WK-MSG-1-14,
                 WK-SQL-PTF-CD2          OF  WK-MSG-1-14
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD
             TO  H-SEC-SBT-CD            OF  H-TKMZKR-MS-S,
                 WK-SQL-SEC-SBT-CD1      OF  WK-MSG-1-14,
                 WK-SQL-SEC-SBT-CD2      OF  WK-MSG-1-14
      *----------  銘柄コード
           MOVE  WK-MEG-CD
             TO  H-MEG-CD                OF  H-TKMZKR-MS-S,
                 WK-SQL-MEG-CD1          OF  WK-MSG-1-14,
                 WK-SQL-MEG-CD2          OF  WK-MSG-1-14
      *----------  資産/負債・買建/売建フラグ
           MOVE  WK-TATE-FLG
             TO  H-TATE-FLG              OF  H-TKMZKR-MS-S,
                 WK-SQL-TATE-FLG1        OF  WK-MSG-1-14,
                 WK-SQL-TATE-FLG2        OF  WK-MSG-1-14
      *---------- 玉ID
           MOVE  WK-GYOKU-ID
             TO  H-GYOKU-ID              OF  H-TKMZKR-MS-S,
                 WK-SQL-GYOKU-ID1        OF  WK-MSG-1-14,
                 WK-SQL-GYOKU-ID2        OF  WK-MSG-1-14
      *---------- 銘柄種類２
           MOVE  MEG-CD-SHRU2            OF  TKMZBW03-PARM
                                         OF  PARM-SMZJ2210-ARG1
             TO  H-MEG-CD-SHRU2          OF  H-TKMZKR-MS-S,
                 WK-SQL-MEG-CD-SHRU2-1   OF  WK-MSG-1-14,
                 WK-SQL-MEG-CD-SHRU2-2   OF  WK-MSG-1-14
      *----------  開始基準日の翌日
           MOVE  KAISI-KJN-YMD-NEXT      OF  TKMZBW02-PARM
                                         OF  PARM-SMZJ2210-ARG1
             TO  H-KAISI-KJN-YMD-NEXT    OF  H-TKMZKR-MS-S,
                 WK-SQL-KAISI-KJN-YMD-NEXT1
                                         OF  WK-MSG-1-14,
                 WK-SQL-KAISI-KJN-YMD-NEXT2
                                         OF  WK-MSG-1-14
      *----------  基準日
           MOVE  WK-KJN-YMD
             TO  H-KJN-YMD               OF  H-TKMZKR-MS-S,
                 WK-SQL-KJN-YMD1         OF  WK-MSG-1-14,
                 WK-SQL-KJN-YMD2         OF  WK-MSG-1-14
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD           OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD               OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD                OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード=["
      D             H-SEC-SBT-CD            OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード=["
      D             H-MEG-CD                OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産/負債・買建/売建フラグ=["
      D             H-TATE-FLG              OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ID=["
      D             H-GYOKU-ID              OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄種類２=["
      D             H-MEG-CD-SHRU2          OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":開始基準日の翌日=["
      D             H-KAISI-KJN-YMD-NEXT    OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日=["
      D             H-KJN-YMD               OF  H-TKMZKR-MS-S"]"
      D    DISPLAY  CNS-PGM-ID":ワーク未収収益/債券過去経過利息フラグ=["
      D             WK-MS-KR-FLG"]"
      *-----------------------------------------------------------------
           IF  WK-MS-KR-FLG = CNS-MS
           THEN
             MOVE  SQL-SELECT-1-14         TO  SQLSTMT14-1              @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT14-1=[" SQLSTMT14-1 "]"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZMS-KR-CR-OPEN=["               @3212SEINO@@
      D                          FLG-TKMZMS-KR-CR-OPEN "]"              @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
             IF  FLG-TKMZMS-KR-CR-OPEN = CNS-OFF                        @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  未収収益と債券過去経過利息からデータCURSOR PREPARE
               EXEC  SQL                                                @3212SEINO@@
                 PREPARE  S9_1  FROM  :SQLSTMT14-1                      @3212SEINO@@
               END-EXEC                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":未収収益と債券過去経過利息からデータ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  WK-MSKR-ERPO-PRE
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-14        DELIMITED  BY  SIZE
                   INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           ELSE
             MOVE  SQL-SELECT-1-14         TO  SQLSTMT14-2              @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT14-2=[" SQLSTMT14-2 "]"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZMS-KR-CR-OPEN2=["              @3212SEINO@@
      D                          FLG-TKMZMS-KR-CR-OPEN2 "]"             @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
             IF  FLG-TKMZMS-KR-CR-OPEN2 = CNS-OFF                       @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  未収収益と債券過去経過利息からデータCURSOR PREPARE
               EXEC  SQL                                                @3212SEINO@@
                 PREPARE  S9_2  FROM  :SQLSTMT14-2                      @3212SEINO@@
               END-EXEC                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":未収収益と債券過去経過利息からデータ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  WK-MSKR-ERPO-PRE
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-14        DELIMITED  BY  SIZE
                   INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 未収収益と債券過去経過利息から"
      D             "データCURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZMS-KR-PRE-EXT.
           EXIT.
      ******************************************************************
      *    未収収益と債券過去経過利息からデータCURSOR OPEN
      ******************************************************************
       TKMZMS-KR-OPEN-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益と債券過去経過利息からデータ"
      D             "CURSOR OPEN START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク未収収益/債券過去経過利息フラグ=["
      D             WK-MS-KR-FLG"]"
      *-----------------------------------------------------------------
           IF  WK-MS-KR-FLG = CNS-MS
           THEN
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
             IF  FLG-TKMZMS-KR-CR-OPEN = CNS-OFF                        @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZMSKR_CUR_1  CURSOR  FOR  S9_1
               END-EXEC
               CONTINUE                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D        "CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZMSKR_CUR_1
                 USING :H-TKMZKR-MS-S.H-RIYO-CMP-CD,
                       :H-TKMZKR-MS-S.H-FUND-CD,
                       :H-TKMZKR-MS-S.H-PTF-CD,
                       :H-TKMZKR-MS-S.H-SEC-SBT-CD,
                       :H-TKMZKR-MS-S.H-MEG-CD,
                       :H-TKMZKR-MS-S.H-TATE-FLG,
                       :H-TKMZKR-MS-S.H-GYOKU-ID,
                       :H-TKMZKR-MS-S.H-MEG-CD-SHRU2,
                       :H-TKMZKR-MS-S.H-KAISI-KJN-YMD-NEXT,
                       :H-TKMZKR-MS-S.H-KJN-YMD,
                       :H-TKMZKR-MS-S.H-RIYO-CMP-CD,
                       :H-TKMZKR-MS-S.H-FUND-CD,
                       :H-TKMZKR-MS-S.H-PTF-CD,
                       :H-TKMZKR-MS-S.H-SEC-SBT-CD,
                       :H-TKMZKR-MS-S.H-MEG-CD,
                       :H-TKMZKR-MS-S.H-TATE-FLG,
                       :H-TKMZKR-MS-S.H-GYOKU-ID,
                       :H-TKMZKR-MS-S.H-MEG-CD-SHRU2,
                       :H-TKMZKR-MS-S.H-KAISI-KJN-YMD-NEXT,
                       :H-TKMZKR-MS-S.H-KJN-YMD
             END-EXEC
           ELSE
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
             IF  FLG-TKMZMS-KR-CR-OPEN2 = CNS-OFF                       @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZMSKR_CUR_2  CURSOR  FOR  S9_2
               END-EXEC
               CONTINUE                                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D        "CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZMSKR_CUR_2
                 USING :H-TKMZKR-MS-S.H-RIYO-CMP-CD,
                       :H-TKMZKR-MS-S.H-FUND-CD,
                       :H-TKMZKR-MS-S.H-PTF-CD,
                       :H-TKMZKR-MS-S.H-SEC-SBT-CD,
                       :H-TKMZKR-MS-S.H-MEG-CD,
                       :H-TKMZKR-MS-S.H-TATE-FLG,
                       :H-TKMZKR-MS-S.H-GYOKU-ID,
                       :H-TKMZKR-MS-S.H-MEG-CD-SHRU2,
                       :H-TKMZKR-MS-S.H-KAISI-KJN-YMD-NEXT,
                       :H-TKMZKR-MS-S.H-KJN-YMD,
                       :H-TKMZKR-MS-S.H-RIYO-CMP-CD,
                       :H-TKMZKR-MS-S.H-FUND-CD,
                       :H-TKMZKR-MS-S.H-PTF-CD,
                       :H-TKMZKR-MS-S.H-SEC-SBT-CD,
                       :H-TKMZKR-MS-S.H-MEG-CD,
                       :H-TKMZKR-MS-S.H-TATE-FLG,
                       :H-TKMZKR-MS-S.H-GYOKU-ID,
                       :H-TKMZKR-MS-S.H-MEG-CD-SHRU2,
                       :H-TKMZKR-MS-S.H-KAISI-KJN-YMD-NEXT,
                       :H-TKMZKR-MS-S.H-KJN-YMD
             END-EXEC
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":未収収益と債券過去経過利息からデータ"
      D           "CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             IF  WK-MS-KR-FLG = CNS-MS
             THEN
               MOVE  CNS-ON                TO  FLG-TKMZMS-KR-CR-OPEN
             ELSE
               MOVE  CNS-ON                TO  FLG-TKMZMS-KR-CR-OPEN2
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":TKMZMS-KR CURSOR OPEN FLAG=["
      D             FLG-TKMZMS-KR-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":TKMZMS-KR CURSOR OPEN FLAG2=["
      D             FLG-TKMZMS-KR-CR-OPEN2"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  WK-MSKR-ERPO-OPEN
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-14        DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益と債券過去経過利息からデータ"
      D             "CURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZMS-KR-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    未収収益と債券過去経過利息からデータCURSOR FETCH
      ******************************************************************
       TKMZMS-KR-FETCH-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益と債券過去経過利息からデータ"
      D             "CURSOR FETCH START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク未収収益/債券過去経過利息フラグ=["
      D             WK-MS-KR-FLG"]"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-TKMZKR-MS
           IF  WK-MS-KR-FLG = CNS-MS
           THEN
             EXEC SQL
               FETCH TKMZMSKR_CUR_1
               INTO  :H-TKMZKR-MS
             END-EXEC
           ELSE
             EXEC SQL
               FETCH TKMZMSKR_CUR_2
               INTO  :H-TKMZKR-MS
             END-EXEC
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CURSOR FETCH  正常"
      *-----------------------------------------------------------------
               IF  WK-MS-KR-FLG = CNS-MS
               THEN
      *----------  ワーク残高履歴更新.データ１.投資対象国コード
                 IF  TSTSK-CD OF WK-DATA-1  OF  WK-ZNRRK-KOUSIN = SPACE
                 THEN
      *----------  取得した投資対象国コード
                   MOVE  H-TKMZKR-MS
                     TO  TSTSK-CD           OF  WK-DATA-1
                                            OF  WK-ZNRRK-KOUSIN
                 ELSE
                   CONTINUE
                 END-IF
      *----------  ワーク残高履歴更新.データ２.投資対象国コード
                 IF  TSTSK-CD OF WK-DATA-2  OF  WK-ZNRRK-KOUSIN = SPACE
                 THEN
      *----------  取得した投資対象国コード
                   MOVE  H-TKMZKR-MS
                     TO  TSTSK-CD           OF  WK-DATA-2
                                            OF  WK-ZNRRK-KOUSIN
                 ELSE
                   CONTINUE
                 END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取得した投資対象国コード=["
      D             H-TKMZKR-MS"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.投資対象国コード=["
      D             TSTSK-CD                OF  WK-DATA-1
      D                                     OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.投資対象国コード=["
      D             TSTSK-CD                OF  WK-DATA-2
      D                                     OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
               ELSE
      *----------  ワーク残高履歴更新.データ１.発行国コード
                 IF  HAKO-CD  OF WK-DATA-1  OF  WK-ZNRRK-KOUSIN = SPACE
                 THEN
      *----------  取得した発行国コード
                   MOVE  H-TKMZKR-MS
                     TO  HAKO-CD            OF  WK-DATA-1
                                            OF  WK-ZNRRK-KOUSIN
                 ELSE
                   CONTINUE
                 END-IF
      *----------  ワーク残高履歴更新.データ１.発行国コード
                 IF  HAKO-CD  OF WK-DATA-2  OF  WK-ZNRRK-KOUSIN = SPACE
                 THEN
      *----------  取得した発行国コード
                   MOVE  H-TKMZKR-MS
                     TO  HAKO-CD            OF  WK-DATA-2
                                            OF  WK-ZNRRK-KOUSIN
                 ELSE
                   CONTINUE
                 END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取得した発行国コード=["
      D             H-TKMZKR-MS"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.発行国コード=["
      D             HAKO-CD                OF  WK-DATA-1
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.発行国コード=["
      D             HAKO-CD                OF  WK-DATA-2
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
               END-IF
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":NOTFOUND(テーマ2871)-IN"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.投資対象国コード=["
      D             TSTSK-CD               OF  WK-DATA-1
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.投資対象国コード=["
      D             TSTSK-CD               OF  WK-DATA-2
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.発行国コード=["
      D             HAKO-CD                OF  WK-DATA-1
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.発行国コード=["
      D             HAKO-CD                OF  WK-DATA-2
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
               IF  WK-MS-KR-FLG = CNS-MS
               THEN
      *----------  ワーク残高履歴更新.データ１.投資対象国コード
                IF  TSTSK-CD OF WK-DATA-1  OF  WK-ZNRRK-KOUSIN = SPACE
                THEN
                  MOVE  TSTSK-CD-IN        OF PARM-SMZJ2210-ARG1
                    TO  TSTSK-CD           OF  WK-DATA-1
                                           OF  WK-ZNRRK-KOUSIN
                ELSE
                  CONTINUE
                END-IF
      *----------  ワーク残高履歴更新.データ２.投資対象国コード
                IF  TSTSK-CD OF WK-DATA-2  OF  WK-ZNRRK-KOUSIN = SPACE
                THEN
                  MOVE  TSTSK-CD-IN        OF PARM-SMZJ2210-ARG1
                    TO  TSTSK-CD           OF  WK-DATA-2
                                           OF  WK-ZNRRK-KOUSIN
                ELSE
                  CONTINUE
                END-IF
               ELSE
      *----------  ワーク残高履歴更新.データ１.発行国コード
                IF  HAKO-CD  OF WK-DATA-1  OF  WK-ZNRRK-KOUSIN = SPACE
                THEN
                  MOVE  HAKO-CD-IN         OF PARM-SMZJ2210-ARG1
                    TO  HAKO-CD            OF  WK-DATA-1
                                           OF  WK-ZNRRK-KOUSIN
                ELSE
                  CONTINUE
                END-IF
      *----------  ワーク残高履歴更新.データ２.発行国コード
                IF  HAKO-CD  OF WK-DATA-2  OF  WK-ZNRRK-KOUSIN = SPACE
                THEN
                  MOVE  HAKO-CD-IN         OF PARM-SMZJ2210-ARG1
                    TO  HAKO-CD            OF  WK-DATA-2
                                           OF  WK-ZNRRK-KOUSIN
                ELSE
                  CONTINUE
                END-IF
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":NOTFOUND(テーマ2871)-OUT"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.投資対象国コード=["
      D             TSTSK-CD               OF  WK-DATA-1
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.投資対象国コード=["
      D             TSTSK-CD               OF  WK-DATA-2
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ１.発行国コード=["
      D             HAKO-CD                OF  WK-DATA-1
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク残高履歴更新.データ２.発行国コード=["
      D             HAKO-CD                OF  WK-DATA-2
      D                                    OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
            WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      D             "CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  WK-MSKR-ERPO-FETCH
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-14      DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 未収収益と債券過去経過利息からデータ"
      D             "CURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZMS-KR-FETCH-EXT.
           EXIT.
      ******************************************************************
      *    未収収益と債券過去経過利息からデータCURSOR CLOSE
      ******************************************************************
      *TKMZMS-KR-CLOSE-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 未収収益と債券過去経過利息からデータ"
      *D             "CURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID":TKMZMS-KR CURSOR OPEN FLAG=["
      *D             FLG-TKMZMS-KR-CR-OPEN"]"
      *-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZMSKR_CUR
      *     END-EXEC
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"未収収益と債券過去経過利息からデータ"
      *D           "CUR CLOSE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      *D             "CURSOR CLOSE  正常"
      *-----------------------------------------------------------------
      *       MOVE  CNS-OFF              TO  FLG-TKMZMS-KR-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":TKMZMS-KR CURSOR OPEN FLAG =["
      *D             FLG-TKMZMS-KR-CR-OPEN "]"
      *-----------------------------------------------------------------
      *    ELSE
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息からデータ"
      *D             "CURSOR CLOSE  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *         TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
      *       MOVE  WK-MSKR-ERPO-CLOSE
      *         TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-14        DELIMITED  BY  SIZE
      *         INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
      *      PERFORM  ERR-RTN
      *    END-IF
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":***未収収益と債券過去経過利息からデータ"
      *D             "CURSOR CLOSE END ***"
      *-----------------------------------------------------------------
      *    CONTINUE.
      *TKMZMS-KR-CLOSE-EXT.
      *    EXIT.
      ******************************************************************
      *    残高履歴計算データにINSERTする
      ******************************************************************
       TKMZBW11-INSERT-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 残高履歴計算データにINSERTする START ***"
      *-----------------------------------------------------------------
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日  =["
      D             H-SYORI-YMD          OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":起動ID  =["
      D             H-KIDOU-ID           OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             H-FUND-CD            OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             H-SEC-SBT-CD         OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             H-MEG-CD             OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ=["
      D             H-GYOKU-ID           OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             H-KJN-YMD            OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分=["
      D             H-KSN-YMD-DMN-KBN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             H-SIJO-TUKA-CD       OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":数量残高=["
      D             H-SRYZN              OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価残高=["
      D             H-SJTK-BOKAZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価残高=["
      D             H-UYTK-BOKAZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価=["
      D             H-SJTK-BOKA-TNK      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価=["
      D             H-UYTK-BOKA-TNK      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート=["
      D             H-BOKA-KWS           OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金残高=["
      D             H-SJTK-PPAYZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金残高=["
      D             H-UYTK-PPAYZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前受金残高=["
      D             H-SJTK-ARECZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前受金残高=["
      D             H-UYTK-ARECZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨仮払金残高=["
      D             H-SJTK-SPAYZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨仮払金残高=["
      D             H-UYTK-SPAYZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価=["
      D             H-SJTK-H-TNK         OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価=["
      D             H-UYTK-H-TNK         OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":同一コスト継続フラグ=["
      D             H-SAME-COST-KZK-FLG  OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨経過利息=["
      D             H-SJTK-KEKA-RSK      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨経過利息=["
      D             H-UYTK-KEKA-RSK      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益=["
      D             H-SJTK-MS-SHEKI      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益=["
      D             H-UYTK-MS-SHEKI      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税=["
      D             H-SJTK-GENSEN-TAX    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税=["
      D             H-UYTK-GENSEN-TAX    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":評価為替レート=["
      D             H-HYK-KWS            OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":源泉税評価為替レート=["
      D             H-GENS-TAX-HYK-KWS   OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":ファクター・連動係数=["
      D             H-FACTOR-RENDOU-KESU OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益計上・戻入額=["
      D             H-SJTK-MSSE-KJMIG    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益計上・戻入額=["
      D             H-UYTK-MSSE-KJMIG    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":数量残高（利付）=["
      D             H-SRYZN-RIT          OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価=["
      D             H-TGYOKU-TNK         OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート=["
      D             H-TGYOKU-KWS-RATE    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー=["
      D             H-TGYOKU-BRK         OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日=["
      D             H-TGYOKU-YKJ-YMD     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉約定金額残=["
      D             H-SJTK-TG-YJKNZN     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉約定金額残=["
      D             H-UYTK-TG-YJKNZN     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料残=["
      D             H-SJTK-TG-TSRZN      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料残=["
      D             H-UYTK-TG-TSRZN      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税残=["
      D             H-SJTK-TG-S-TAXZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税残=["
      D             H-UYTK-TG-S-TAXZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用残=["
      D             H-SJTK-TG-ELS-HIYOZN OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用残=["
      D             H-UYTK-TG-ELS-HIYOZN OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額残=["
      D             H-SJTK-TG-SSKGZN     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額残=["
      D             H-UYTK-TG-SSKGZN     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ=["
      D             H-OP-TATE-FLG        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定額残高=["
      D             H-SJTK-GSZKP-YTZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定額残高=["
      D             H-UYTK-GSZKP-YTZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨源泉税還付予定額残高=["
      D             H-KSTK-GSZKP-YTZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨ノンカバー未収金残高=["
      D             H-SJTK-NOCV-MSKZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨ノンカバー未収金残高=["
      D             H-UYTK-NOCV-MSKZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨ノンカバー未払金残高=["
      D             H-SJTK-NOCV-MBKZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨ノンカバー未払金残高=["
      D             H-UYTK-NOCV-MBKZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息=["
      D             H-SHORT-STEN-KEKA-RSK OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日=["
      D             H-SHORT-START-YMD    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日=["
      D             H-SHORT-END-YMD      OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ=["
      D             H-KH-KAIKEI-BASE-FLG OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード=["
      D             H-TSTSK-CD           OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード=["
      D             H-HAKO-CD            OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":数量単位=["
      D             H-SURYO-TANI         OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未払費用残=["
      D             H-SJTK-MBHYZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未払費用残=["
      D             H-UYTK-MBHYZN        OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未払消費税残=["
      D             H-SJTK-MB-S-TAXZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未払消費税残=["
      D             H-UYTK-MB-S-TAXZN    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨移管評価損益残=["
      D             H-SJTK-IK-HKSEZN     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管評価損益残=["
      D             H-UYTK-IK-HKSEZN     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨移管未収収益=["
      D             H-SJTK-IK-MSSHEKI    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管未収収益=["
      D             H-UYTK-IK-MSSHEKI    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管前払金評価損益残=["
      D             H-UYTK-IK-PPHKZN     OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード=["
      D             H-SK-LOGIN-CMP-CD    OF  H-TKMZBW11-I"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード=["
      D             H-UPD-LOGIN-CMP-CD   OF  H-TKMZBW11-I"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMTIN01                                      @3212SEINO@@
      *----ＳＱＬ文
           MOVE  SQL-INSERT-TKMZBW11     TO  SQLSTMTIN01                @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMTIN01=["SQLSTMTIN01"]"            @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW11-S10-INSERT=["              @3212SEINO@@
      D                           FLG-TKMZBW11-S10-INSERT"]"            @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
           IF  FLG-TKMZBW11-S10-INSERT = CNS-OFF                        @3212SEINO@@
           THEN                                                         @3212SEINO@@
      **** EXEC SQL                                                     @3212SEINO@@
      ****     PREPARE S6 FROM :SQLSTMT                                 @3212SEINO@@
      **** END-EXEC                                                     @3212SEINO@@
             EXEC SQL                                                   @3212SEINO@@
                 PREPARE S10 FROM :SQLSTMTIN01                          @3212SEINO@@
             END-EXEC                                                   @3212SEINO@@
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ"
      D             "PREPARE SQLCODE =["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ PREPARE  正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ PREPARE  異常"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW11     DELIMITED  BY  SIZE
                 INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      **** EXEC SQL                                                     @3212SEINO@@
      ****     EXECUTE S6                                               @3212SEINO@@
           EXEC SQL                                                     @3212SEINO@@
               EXECUTE S10                                              @3212SEINO@@
                 USING :H-TKMZBW11-I.H-SYORI-YMD,
                       :H-TKMZBW11-I.H-KIDOU-ID,
                       :H-TKMZBW11-I.H-RIYO-CMP-CD,
                       :H-TKMZBW11-I.H-FUND-CD,
                       :H-TKMZBW11-I.H-PTF-CD,
                       :H-TKMZBW11-I.H-SEC-SBT-CD,
                       :H-TKMZBW11-I.H-MEG-CD,
                       :H-TKMZBW11-I.H-TATE-FLG,
                       :H-TKMZBW11-I.H-GYOKU-ID,
                       :H-TKMZBW11-I.H-KJN-YMD,
                       :H-TKMZBW11-I.H-KSN-YMD-DMN-KBN,
                       :H-TKMZBW11-I.H-SIJO-TUKA-CD,
                       :H-TKMZBW11-I.H-SRYZN,
                       :H-TKMZBW11-I.H-SJTK-BOKAZN,
                       :H-TKMZBW11-I.H-UYTK-BOKAZN,
                       :H-TKMZBW11-I.H-SJTK-BOKA-TNK,
                       :H-TKMZBW11-I.H-UYTK-BOKA-TNK,
                       :H-TKMZBW11-I.H-BOKA-KWS,
                       :H-TKMZBW11-I.H-SJTK-PPAYZN,
                       :H-TKMZBW11-I.H-UYTK-PPAYZN,
                       :H-TKMZBW11-I.H-SJTK-ARECZN,
                       :H-TKMZBW11-I.H-UYTK-ARECZN,
                       :H-TKMZBW11-I.H-SJTK-SPAYZN,
                       :H-TKMZBW11-I.H-UYTK-SPAYZN,
                       :H-TKMZBW11-I.H-SJTK-H-TNK,
                       :H-TKMZBW11-I.H-UYTK-H-TNK,
                       :H-TKMZBW11-I.H-SAME-COST-KZK-FLG,
                       :H-TKMZBW11-I.H-SJTK-KEKA-RSK,
                       :H-TKMZBW11-I.H-UYTK-KEKA-RSK,
                       :H-TKMZBW11-I.H-SJTK-MS-SHEKI,
                       :H-TKMZBW11-I.H-UYTK-MS-SHEKI,
                       :H-TKMZBW11-I.H-SJTK-GENSEN-TAX,
                       :H-TKMZBW11-I.H-UYTK-GENSEN-TAX,
                       :H-TKMZBW11-I.H-HYK-KWS,
                       :H-TKMZBW11-I.H-GENS-TAX-HYK-KWS,
                       :H-TKMZBW11-I.H-FACTOR-RENDOU-KESU,
                       :H-TKMZBW11-I.H-SJTK-MSSE-KJMIG,
                       :H-TKMZBW11-I.H-UYTK-MSSE-KJMIG,
                       :H-TKMZBW11-I.H-SRYZN-RIT,
                       :H-TKMZBW11-I.H-TGYOKU-TNK,
                       :H-TKMZBW11-I.H-TGYOKU-KWS-RATE,
                       :H-TKMZBW11-I.H-TGYOKU-BRK,
                       :H-TKMZBW11-I.H-TGYOKU-YKJ-YMD,
                       :H-TKMZBW11-I.H-SJTK-TG-YJKNZN,
                       :H-TKMZBW11-I.H-UYTK-TG-YJKNZN,
                       :H-TKMZBW11-I.H-SJTK-TG-TSRZN,
                       :H-TKMZBW11-I.H-UYTK-TG-TSRZN,
                       :H-TKMZBW11-I.H-SJTK-TG-S-TAXZN,
                       :H-TKMZBW11-I.H-UYTK-TG-S-TAXZN,
                       :H-TKMZBW11-I.H-SJTK-TG-ELS-HIYOZN,
                       :H-TKMZBW11-I.H-UYTK-TG-ELS-HIYOZN,
                       :H-TKMZBW11-I.H-SJTK-TG-SSKGZN,
                       :H-TKMZBW11-I.H-UYTK-TG-SSKGZN,
                       :H-TKMZBW11-I.H-OP-TATE-FLG,
                       :H-TKMZBW11-I.H-SJTK-GSZKP-YTZN,
                       :H-TKMZBW11-I.H-UYTK-GSZKP-YTZN,
                       :H-TKMZBW11-I.H-KSTK-GSZKP-YTZN,
                       :H-TKMZBW11-I.H-SJTK-NOCV-MSKZN,
                       :H-TKMZBW11-I.H-UYTK-NOCV-MSKZN,
                       :H-TKMZBW11-I.H-SJTK-NOCV-MBKZN,
                       :H-TKMZBW11-I.H-UYTK-NOCV-MBKZN,
                       :H-TKMZBW11-I.H-SHORT-STEN-KEKA-RSK,
                       :H-TKMZBW11-I.H-SHORT-START-YMD,
                       :H-TKMZBW11-I.H-SHORT-END-YMD,
                       :H-TKMZBW11-I.H-KH-KAIKEI-BASE-FLG,
                       :H-TKMZBW11-I.H-TSTSK-CD,
                       :H-TKMZBW11-I.H-HAKO-CD,
                       :H-TKMZBW11-I.H-SURYO-TANI,
                       :H-TKMZBW11-I.H-SJTK-MBHYZN,
                       :H-TKMZBW11-I.H-UYTK-MBHYZN,
                       :H-TKMZBW11-I.H-SJTK-MB-S-TAXZN,
                       :H-TKMZBW11-I.H-UYTK-MB-S-TAXZN,
                       :H-TKMZBW11-I.H-SJTK-IK-HKSEZN,
                       :H-TKMZBW11-I.H-UYTK-IK-HKSEZN,
                       :H-TKMZBW11-I.H-SJTK-IK-MSSHEKI,
                       :H-TKMZBW11-I.H-UYTK-IK-MSSHEKI,
                       :H-TKMZBW11-I.H-UYTK-IK-PPHKZN,
                       :H-TKMZBW11-I.H-SK-LOGIN-CMP-CD,
                       :H-TKMZBW11-I.H-UPD-LOGIN-CMP-CD
           END-EXEC
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ"
      D             " INSERT SQLCODE =["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               MOVE  CNS-ON             TO  FLG-TKMZBW11-S10-INSERT     @3212SEINO@@
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ INSERT  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW11-S10-INSERT=["              @3212SEINO@@
      D                         FLG-TKMZBW11-S10-INSERT"]"              @3212SEINO@@
      *-----------------------------------------------------------------
      *        CONTINUE                                                 @3212SEINO@@
             WHEN  CNS-SQL-UNIQUE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ INSERT 一意制約違反"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS1
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-300
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW11   DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
             WHEN OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ INSERT  異常"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS2
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW11   DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 残高履歴計算データにINSERTする END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW11-INSERT-EXT.
           EXIT.
      ******************************************************************
      *    6）取引差分更新管理更新
      ******************************************************************
       TRHK-SABON-UD-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 取引差分更新管理更新  START "
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG          OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新."
      D    "データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG          OF  WK-ZNRRK-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高履歴更新."
      D    "データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN OF  WK-ZNRRK-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  (WK-DATA-1-FLG  OF  WK-ZNRRK-KOUSIN  =  CNS-X-1  AND
                WK-DATA-1-YUKOU-ZN-KBN OF  WK-ZNRRK-KOUSIN = CNS-X-1) OR
               (WK-DATA-2-FLG  OF  WK-ZNRRK-KOUSIN  =  CNS-X-1  AND
                WK-DATA-2-YUKOU-ZN-KBN OF  WK-ZNRRK-KOUSIN = CNS-X-1)
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  START "
      *-----------------------------------------------------------------
      *----------  機能区分
             MOVE  CNS-X-2
               TO  MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT
      *----------  更新データ区分
             MOVE  CNS-X-1
               TO  UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT
      *----------  OL/BT区分
             MOVE  CNS-BT
               TO  OL-BT-KBN            OF  PARM-SMZC9201-INOUT
      *----------  有効残高区分
             MOVE  CNS-YUKO-ZN-KBN-1
               TO  YUKO-ZN-KBN          OF  PARM-SMZC9201-ARG1
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  PARM-SMZC9201-ARG2
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  PARM-SMZC9201-ARG2
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  PARM-SMZC9201-ARG2
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  PARM-SMZC9201-ARG2
      *----------  銘柄コード
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  MEG-CD               OF  PARM-SMZC9201-ARG2
      *----------  資産負債・買建売建フラグ
             MOVE  TATE-FLG             OF  TKMZBW03-PARM
               TO  TATE-FLG             OF  PARM-SMZC9201-ARG2
      *----------  玉ID
             MOVE  GYOKU-ID             OF  TKMZBW03-PARM
               TO  GYOKU-ID             OF  PARM-SMZC9201-ARG2
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  PARM-SMZC9201-ARG2
      *----------  最終有効日
             MOVE  ZERO
               TO  LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG2
      *----------  基本会計ベースフラグ
             MOVE  KH-KAIKEI-BASE-FLG   OF  TKMZBW02-PARM
               TO  KIHON-KAIKEI-BASE-FLG
                                        OF  PARM-SMZC9201-ARG2
      *----------  取引属性データエリア
             MOVE  TORI-ZOKUSEI-AREA    OF  PARM-SMZJ2210-ARG1
               TO  TORI-ZOKUSEI-AREA    OF  PARM-SMZC9201-ARG1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             MENU-KINOU-KBN      OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":更新データ区分  =["
      D             UPD-DATA-KBN        OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分  =["
      D             OL-BT-KBN           OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":有効残高区分  =["
      D             YUKO-ZN-KBN         OF  PARM-SMZC9201-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             RIYO-CMP-CD         OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             FUND-CD             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード  =["
      D             MEG-CD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ  =["
      D             TATE-FLG            OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":玉ID  =["
      D             GYOKU-ID            OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日  =["
      D             KJN-YMD             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終有効日  =["
      D             LAST-YUKO-YMD       OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ  =["
      D             KIHON-KAIKEI-BASE-FLG
      D                                 OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID ":取引属性データエリア         =["
      D             TORI-ZOKUSEI-AREA   OF  PARM-SMZC9201-ARG1"]"
      *-----------------------------------------------------------------
             CALL  "SMZC9201"           USING  PARM-SMZC9201-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC9201)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
               =  CNS-RTN-000
             THEN
               CONTINUE
             ELSE
      *----------  エラー
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-028
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-901
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  END "
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           IF  (WK-DATA-1-FLG  OF  WK-ZNRRK-KOUSIN  =  CNS-X-1  AND
                WK-DATA-1-YUKOU-ZN-KBN OF  WK-ZNRRK-KOUSIN = CNS-X-0) OR
               (WK-DATA-2-FLG  OF  WK-ZNRRK-KOUSIN  =  CNS-X-1  AND
                WK-DATA-2-YUKOU-ZN-KBN OF  WK-ZNRRK-KOUSIN = CNS-X-0)
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  START "
      *-----------------------------------------------------------------
      *----------  機能区分
             MOVE  CNS-X-2
               TO  MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT
      *----------  更新データ区分
             MOVE  CNS-X-1
               TO  UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT
      *----------  OL/BT区分
             MOVE  CNS-BT
               TO  OL-BT-KBN            OF  PARM-SMZC9201-INOUT
      *----------  有効残高区分
             MOVE  CNS-YUKO-ZN-KBN-0
               TO  YUKO-ZN-KBN          OF  PARM-SMZC9201-ARG1
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  PARM-SMZC9201-ARG2
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  PARM-SMZC9201-ARG2
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  PARM-SMZC9201-ARG2
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  PARM-SMZC9201-ARG2
      *----------  銘柄コード
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  MEG-CD               OF  PARM-SMZC9201-ARG2
      *----------  資産負債・買建売建フラグ
             MOVE  TATE-FLG             OF  TKMZBW03-PARM
               TO  TATE-FLG             OF  PARM-SMZC9201-ARG2
      *----------  玉ID
             MOVE  GYOKU-ID             OF  TKMZBW03-PARM
               TO  GYOKU-ID             OF  PARM-SMZC9201-ARG2
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  PARM-SMZC9201-ARG2
      *----------  最終有効日
             MOVE  KEIJOU-KIJUNBI       OF  WK-TKMZBW06-NORMAL
               TO  LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG2
      *----------  基本会計ベースフラグ
             MOVE  KH-KAIKEI-BASE-FLG   OF  TKMZBW02-PARM
               TO  KIHON-KAIKEI-BASE-FLG
                                        OF  PARM-SMZC9201-ARG2
      *----------  取引属性データエリア
             MOVE  TORI-ZOKUSEI-AREA    OF  PARM-SMZJ2210-ARG1
               TO  TORI-ZOKUSEI-AREA    OF  PARM-SMZC9201-ARG1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             MENU-KINOU-KBN      OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":更新データ区分  =["
      D             UPD-DATA-KBN        OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分  =["
      D             OL-BT-KBN           OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":有効残高区分  =["
      D             YUKO-ZN-KBN         OF  PARM-SMZC9201-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             RIYO-CMP-CD         OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             FUND-CD             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード  =["
      D             MEG-CD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ  =["
      D             TATE-FLG            OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":玉ID  =["
      D             GYOKU-ID            OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日  =["
      D             KJN-YMD             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終有効日  =["
      D             LAST-YUKO-YMD       OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ  =["
      D             KIHON-KAIKEI-BASE-FLG
      D                                 OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID ":取引属性データエリア         =["
      D             TORI-ZOKUSEI-AREA   OF  PARM-SMZC9201-ARG1"]"
      *-----------------------------------------------------------------
             CALL  "SMZC9201"           USING  PARM-SMZC9201-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC9201)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
               =  CNS-RTN-000
             THEN
               CONTINUE
             ELSE
      *----------  エラー
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-029
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-901
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  END "
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 取引差分更新管理更新  END "
      *-----------------------------------------------------------------
           CONTINUE.
       TRHK-SABON-UD-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2 対象銘柄は資金の場合の処理
      ******************************************************************
       TASYOU-MEG-SIKIN-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 対象銘柄は資金の場合の処理  START "
      *-----------------------------------------------------------------
      *---------- 3.2.2.1 対応基準日の資金残履歴を作成する
             PERFORM  TASYOU-YMD-SKZRW-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 対象銘柄は資金の場合の処理  END "
      *-----------------------------------------------------------------
           CONTINUE.
       TASYOU-MEG-SIKIN-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.1 対応基準日の資金残履歴を作成する
      ******************************************************************
       TASYOU-YMD-SKZRW-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 対応基準日の資金残履歴を作成する"
      D             " の処理  START "
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN"]"
      *-----------------------------------------------------------------
           PERFORM  TKMZBW07-GET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分=["WK-TBL-KBN"]"
      *-----------------------------------------------------------------
           IF  WK-TBL-KBN         = 2
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワークTBL区分＝2（資金簿価異動TBL）の場合"
      *-----------------------------------------------------------------
             PERFORM  TKMZSR00-GET-RTN
           ELSE
             CONTINUE
           END-IF
      *---------- 2)ワーク断面作成情報編集
           PERFORM  DMN-JH-EDIT2-RTN
      *---------- 3)ワーク資金残履歴更新編集
           PERFORM  SKZN-KOUSIN-EDIT-RTN
      *---------- 5)資金残履歴計算データ更新
           PERFORM  SKZN-CALC-KOUSIN-RTN
      *---------- 6)取引差分更新管理更新
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":欠落断面有無フラグ=["LACK-DMN-FLG"]"
      *-----------------------------------------------------------------
           IF  LACK-DMN-FLG        NOT   = 1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":欠落断面有無フラグ≠1（あり）の場合"
      *-----------------------------------------------------------------
             PERFORM  TRHK-SABON-UD2-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***対応基準日の資金残履歴を作成する処理 END ***"
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象銘柄は資金の場合の処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TASYOU-YMD-SKZRW-EXT.
           EXIT.
      ******************************************************************
      *    資金簿価異動計算データTBLから最大処理順の異動データを取得する
      ******************************************************************
       TKMZBW07-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 資金簿価異動計算データTBLから最大処理"
      D             "順の異動データを取得   START"
      *-----------------------------------------------------------------
      *----------  資金簿価異動計算データCURSOR PREPARE
           PERFORM  TKMZBW07-PREPARE-RTN
      *----------  資金簿価異動計算データCURSOR OPEN
           PERFORM  TKMZBW07-OPEN-RTN
      *----------  資金簿価異動計算データCURSOR FETCH
           PERFORM  TKMZBW07-FETCH-RTN
             UNTIL  FLG-TKMZBW07-CR-OPEN  =  CNS-OFF
      *----------  資金簿価異動計算データCURSOR CLOSE
      **** PERFORM  TKMZBW07-CLOSE-RTN                                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 資金簿価異動計算データTBLから最大処理"
      D             "順の異動データを取得   END"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW07-GET-EXT.
           EXIT.
      ******************************************************************
      *    資金簿価異動計算データCURSOR PREPARE
      ******************************************************************
       TKMZBW07-PREPARE-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 資金簿価異動計算データ"
      D                       "CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZBW07-S
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD           OF  H-TKMZBW07-S,
                 WK-SQL-RIYO-CMP-CD      OF  WK-MSG-1-7
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD               OF  H-TKMZBW07-S,
                 WK-SQL-FUND-CD          OF  WK-MSG-1-7
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD                OF  H-TKMZBW07-S,
                 WK-SQL-PTF-CD           OF  WK-MSG-1-7
      *---------- 決済口座番号
           MOVE  WK-MEG-CD
             TO  H-KS-KOZA-NO            OF  H-TKMZBW07-S,
                 WK-SQL-KS-KOZA-NO       OF  WK-MSG-1-7
      *---------- 異動日1
           MOVE  WK-KAISI-KJN-YMD
             TO  H-IDO-YMD-1             OF  H-TKMZBW07-S,
                 WK-SQL-IDO-YMD-1        OF  WK-MSG-1-7
      *---------- 異動日2
           MOVE  WK-KJN-YMD
             TO  H-IDO-YMD-2             OF  H-TKMZBW07-S,
                 WK-SQL-IDO-YMD-2        OF  WK-MSG-1-7
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD
             TO  H-SYORI-YMD             OF  H-TKMZBW07-S,
                 WK-SQL-SYORI-YMD        OF  WK-MSG-1-7
      *---------- 起動ID
           MOVE  WK-KIDOU-ID
             TO  H-KIDOU-ID              OF  H-TKMZBW07-S,
                 WK-SQL-KIDOU-ID         OF  WK-MSG-1-7
           INITIALIZE  SQLSTMT07                                        @3212SEINO@@
           MOVE  SQL-SELECT-1-7          TO  SQLSTMT07                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD            OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":決済口座番号=["
      D             H-KS-KOZA-NO         OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":異動日1=["
      D             H-IDO-YMD-1          OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":異動日2=["
      D             H-IDO-YMD-2          OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日=["
      D             H-SYORI-YMD          OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID=["
      D             H-KIDOU-ID           OF  H-TKMZBW07-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT07=[" SQLSTMT07 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW07-CR-OPEN-PR=["             @3212SEINO@@
      D                          FLG-TKMZBW07-CR-OPEN-PR"]"             @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
           IF  FLG-TKMZBW07-CR-OPEN-PR = CNS-OFF                        @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  資金簿価異動計算データCURSOR PREPARE
             EXEC  SQL
               PREPARE  S4  FROM  :SQLSTMT07                            @3212SEINO@@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":資金簿価異動計算データ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-030
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-7         DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金簿価異動計算データ"
      D                        "CURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW07-PREPARE-EXT.
           EXIT.
      ******************************************************************
      *    資金簿価異動計算データCURSOR OPEN
      ******************************************************************
       TKMZBW07-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 資金簿価異動計算データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
           IF  FLG-TKMZBW07-CR-OPEN-PR = CNS-OFF                        @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZBW07_CUR  CURSOR  FOR  S4
             END-EXEC
             CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":資金簿価異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZBW07_CUR
               USING :H-TKMZBW07-S.H-RIYO-CMP-CD,
                     :H-TKMZBW07-S.H-FUND-CD,
                     :H-TKMZBW07-S.H-PTF-CD,
                     :H-TKMZBW07-S.H-KS-KOZA-NO,
                     :H-TKMZBW07-S.H-IDO-YMD-1,
                     :H-TKMZBW07-S.H-IDO-YMD-2,
                     :H-TKMZBW07-S.H-SYORI-YMD,
                     :H-TKMZBW07-S.H-KIDOU-ID,
                     :H-TKMZBW07-S.H-RIYO-CMP-CD,
                     :H-TKMZBW07-S.H-FUND-CD,
                     :H-TKMZBW07-S.H-PTF-CD,
                     :H-TKMZBW07-S.H-KS-KOZA-NO,
                     :H-TKMZBW07-S.H-IDO-YMD-1,
                     :H-TKMZBW07-S.H-IDO-YMD-2
           END-EXEC
      *----------------------単体テスト專用-----------------------------
      *    MOVE  CNS-SQL-UNIQUE           TO  SQLCODE
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":資金簿価異動計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMZBW07-CR-OPEN
             MOVE  CNS-ON                TO  FLG-TKMZBW07-CR-OPEN-PR    @3212SEINO@@
      *----------  ワーク件数
             MOVE  ZERO                  TO  WK-INDEX
      *----------  ワーク計上フラグ
             MOVE  CNS-X-0               TO  WK-KEIJYO-FLG
      *----------  ワーク普通フラグ
             MOVE  CNS-X-0               TO  WK-NORMAL-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN FLAG=["
      D             FLG-TKMZBW07-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW07-CR-OPEN-PR=["              @3212SEINO@@
      D                         FLG-TKMZBW07-CR-OPEN-PR"]"              @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":ワーク件数      =["WK-INDEX"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-031
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-7         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 資金簿価異動計算データCURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW07-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    資金簿価異動計算データCURSOR FETCH
      ******************************************************************
       TKMZBW07-FETCH-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 資金簿価異動計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-TKMZBW07,
                       H-TKMZBW07-TBL-KBN
           EXEC SQL
             FETCH TKMZBW07_CUR
             INTO  :H-TKMZBW07,
                   :H-TKMZBW07-TBL-KBN
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":資金簿価異動計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCURSOR FETCH 正常"
      *-----------------------------------------------------------------
      *----------  ワーク資金簿価異動計算データ
               MOVE  H-TKMZBW07         TO  WK-TKMZBW07
      *----------  ワークTBL区分
               MOVE  H-TKMZBW07-TBL-KBN TO  WK-TBL-KBN
      *----------  ワーク件数
               COMPUTE  WK-INDEX  =  WK-INDEX + CNS-1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ."
      D    DISPLAY  CNS-PGM-ID":処理実行日                =["
      D             SYORI-YMD              OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                    =["
      D             KIDOU-ID               OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード            =["
      D             RIYO-CMP-CD            OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード            =["
      D             FUND-CD                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード      =["
      D             PTF-CD                 OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                  =["
      D             TORI-ID                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号              =["
      D             KS-KOZA-NO             OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":資金種別                  =["
      D             SIKIN-SBT              OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":異動日                    =["
      D             IDO-YMD                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":増減区分                  =["
      D             ZG-KBN                 OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                  =["
      D             AKA-KBN                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№                  =["
      D             ERR-KJY-NO             OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                =["
      D             ERR-KJY-KBN            OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":取引事由                  =["
      D             TORI-JIYU              OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                =["
      D             THRK-ID                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード        =["
      D             KOZA-TUKA-CD           OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード            =["
      D             SEC-SBT-CD             OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨資金簿価異動額    =["
      D             SJTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨資金簿価異動額    =["
      D             UYTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価          =["
      D             SJTK-H-BOKA            OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価          =["
      D             UYTK-H-BOKA            OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価          =["
      D             SJTK-H-TNK             OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価          =["
      D             UYTK-H-TNK             OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート            =["
      D             BOKA-KWS               OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ＣＡＳＨ残高=["
      D             SJTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ＣＡＳＨ残高=["
      D             UYTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（内物）=["
      D             SJTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（内物）=["
      D             UYTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（外物）=["
      D             SJTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（外物）=["
      D             UYTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（内物） =["
      D             SJTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（内物） =["
      D             UYTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（外物） =["
      D             SJTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（外物） =["
      D             UYTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                =["
      D             UYTK-KWS-SNEKI         OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定    =["
      D             SJTK-RKSEKJ            OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定    =["
      D             UYTK-RKSEKJ            OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序              =["
      D             IDO-KJY-JUN            OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                  =["
      D             SAKUJO-KBN             OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                =["
      D             SK-FLG                 OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                  =["
      D             SK-DATE                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード=["
      D             SK-LOGIN-CMP-CD        OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ            =["
      D             SK-SID                 OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ        =["
      D             SK-PGMID               OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                =["
      D             UPD-FLG                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                  =["
      D             UPD-DATE               OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード     =["
      D             UPD-LOGIN-CMP-CD       OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ            =["
      D             UPD-SID                OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ        =["
      D             UPD-PGMID              OF  WK-TKMZBW07"]"
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分  =["WK-TBL-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク件数     =["WK-INDEX"]"
      *-----------------------------------------------------------------
      *----------  評価計上判定
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***【SMZJ4012】取引事由判定  START***"
      *-----------------------------------------------------------------
               INITIALIZE  PARM-SMZJ4012-INOUT
                           PARM-RTNPKG
      *----------  取引事由
               MOVE  TORI-JIYU          OF  WK-TKMZBW07
                 TO  TORI-JIYU          OF  PARM-SMZJ4012-INOUT
      *----------  判定対象区分
               MOVE  CNS-X-1
                 TO  HANTEI-TARGET-KBN  OF  PARM-SMZJ4012-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由     =["
      D              TORI-JIYU          OF  PARM-SMZJ4012-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分 =["
      D              HANTEI-TARGET-KBN  OF  PARM-SMZJ4012-INOUT"]"
      *-----------------------------------------------------------------
               CALL  "SMZJ4012"         USING  PARM-SMZJ4012-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4012)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
               IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                 =  CNS-RTN-000
               THEN
      *----------  ワーク評価損益データフラグ
                 MOVE  HYK-SNEKI-DATA-FLG  OF  PARM-SMZJ4012-ARG2
                   TO  WK-HYK-SNEKI-DATA-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク評価損益データフラグ     =["
      D             WK-HYK-SNEKI-DATA-FLG"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***【SMZJ4012】取引事由判定  END***"
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク評価損益データフラグ     =["
      D             WK-HYK-SNEKI-DATA-FLG"]"
      *-----------------------------------------------------------------
               EVALUATE  WK-HYK-SNEKI-DATA-FLG
      *----------  ワーク評価損益データフラグ＝'8'(評価損益計上)の場合
                 WHEN  CNS-X-8
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク件数     =["WK-INDEX"]"
      *-----------------------------------------------------------------
                   IF  WK-INDEX  =  CNS-1
                   THEN
      *----------  ワーク資金簿価異動計算データ(計上)
                     MOVE  WK-TKMZBW07  TO  WK-TKMZBW07-KEIJYO
      *----------  ワーク計上フラグ
                     MOVE  CNS-X-1      TO  WK-KEIJYO-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ(計上)."
      D    DISPLAY  CNS-PGM-ID":処理実行日                       =["
      D             SYORI-YMD              OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                           =["
      D             KIDOU-ID               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード                   =["
      D             RIYO-CMP-CD            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード                   =["
      D             FUND-CD                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード             =["
      D             PTF-CD                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                         =["
      D             TORI-ID                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号                     =["
      D             KS-KOZA-NO             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":資金種別                         =["
      D             SIKIN-SBT              OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動日                           =["
      D             IDO-YMD                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":増減区分                         =["
      D             ZG-KBN                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                         =["
      D             AKA-KBN                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№                         =["
      D             ERR-KJY-NO             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                       =["
      D             ERR-KJY-KBN            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                       =["
      D             THRK-ID                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード               =["
      D             KOZA-TUKA-CD           OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード                   =["
      D             SEC-SBT-CD             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨資金簿価異動額           =["
      D             SJTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨資金簿価異動額           =["
      D             UYTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価                 =["
      D             SJTK-H-BOKA            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価                 =["
      D             UYTK-H-BOKA            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価                 =["
      D             SJTK-H-TNK             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価                 =["
      D             UYTK-H-TNK             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート                   =["
      D             BOKA-KWS               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ＣＡＳＨ残高       =["
      D             SJTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ＣＡＳＨ残高       =["
      D             UYTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（内物）=["
      D             SJTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（内物）=["
      D             UYTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（外物）=["
      D             SJTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（外物）=["
      D             UYTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（内物） =["
      D             SJTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（内物） =["
      D             UYTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（外物） =["
      D             SJTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（外物） =["
      D             UYTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                       =["
      D             UYTK-KWS-SNEKI         OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定           =["
      D             SJTK-RKSEKJ            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定           =["
      D             UYTK-RKSEKJ            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序                     =["
      D             IDO-KJY-JUN            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                         =["
      D             SAKUJO-KBN             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                       =["
      D             SK-FLG                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                         =["
      D             SK-DATE                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード     =["
      D             SK-LOGIN-CMP-CD        OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ                   =["
      D             SK-SID                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ               =["
      D             SK-PGMID               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                       =["
      D             UPD-FLG                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                         =["
      D             UPD-DATE               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード     =["
      D             UPD-LOGIN-CMP-CD       OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ                   =["
      D             UPD-SID                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ               =["
      D             UPD-PGMID              OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      *-----------------------------------------------------------------
                   ELSE
                     CONTINUE
                   END-IF
      *----------  ワーク評価損益データフラグ＝'2'(評価損益戻入) OR '5'(評価損益でない)の場合
                 WHEN  OTHER
      *----------  ワーク資金簿価異動計算データ(普通)
                   MOVE  WK-TKMZBW07    TO  WK-TKMZBW07-NORMAL
      *----------  ワーク普通フラグ
                   MOVE  CNS-X-1        TO  WK-NORMAL-FLG
      *----------  残高異動計算データカーソルオープンフラグ
                   MOVE  CNS-OFF        TO  FLG-TKMZBW07-CR-OPEN
                   IF  WK-HYK-SNEKI-DATA-FLG  =  CNS-X-7
                   THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク件数     =["WK-INDEX"]"
      *-----------------------------------------------------------------
                     IF  WK-INDEX  =  CNS-1
                     THEN
      *----------  ワーク資金簿価異動計算データ(計上)
                       MOVE  WK-TKMZBW07  TO  WK-TKMZBW07-KEIJYO
      *----------  ワーク計上フラグ
                       MOVE  CNS-X-1      TO  WK-KEIJYO-FLG
      *----------  ワーク資金簿価異動計算データ(普通)
                       MOVE  WK-TKMZBW07  TO  WK-TKMZBW07-NORMAL
      *----------  ワーク普通フラグ
                       MOVE  CNS-X-1      TO  WK-NORMAL-FLG
      *----------  残高異動計算データカーソルオープンフラグ
                       MOVE  CNS-OFF      TO  FLG-TKMZBW07-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ(計上)."
      D    DISPLAY  CNS-PGM-ID":処理実行日                       =["
      D             SYORI-YMD              OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                           =["
      D             KIDOU-ID               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード                   =["
      D             RIYO-CMP-CD            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード                   =["
      D             FUND-CD                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード             =["
      D             PTF-CD                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                         =["
      D             TORI-ID                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号                     =["
      D             KS-KOZA-NO             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":資金種別                         =["
      D             SIKIN-SBT              OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動日                           =["
      D             IDO-YMD                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":増減区分                         =["
      D             ZG-KBN                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                         =["
      D             AKA-KBN                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№                         =["
      D             ERR-KJY-NO             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                       =["
      D             ERR-KJY-KBN            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                       =["
      D             THRK-ID                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード               =["
      D             KOZA-TUKA-CD           OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード                   =["
      D             SEC-SBT-CD             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨資金簿価異動額           =["
      D             SJTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨資金簿価異動額           =["
      D             UYTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価                 =["
      D             SJTK-H-BOKA            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価                 =["
      D             UYTK-H-BOKA            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価                 =["
      D             SJTK-H-TNK             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価                 =["
      D             UYTK-H-TNK             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート                   =["
      D             BOKA-KWS               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ＣＡＳＨ残高       =["
      D             SJTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ＣＡＳＨ残高       =["
      D             UYTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（内物）=["
      D             SJTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（内物）=["
      D             UYTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（外物）=["
      D             SJTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（外物）=["
      D             UYTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（内物） =["
      D             SJTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（内物） =["
      D             UYTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（外物） =["
      D             SJTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（外物） =["
      D             UYTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                       =["
      D             UYTK-KWS-SNEKI         OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定           =["
      D             SJTK-RKSEKJ            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定           =["
      D             UYTK-RKSEKJ            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序                     =["
      D             IDO-KJY-JUN            OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                         =["
      D             SAKUJO-KBN             OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                       =["
      D             SK-FLG                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                         =["
      D             SK-DATE                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード     =["
      D             SK-LOGIN-CMP-CD        OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ                   =["
      D             SK-SID                 OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ               =["
      D             SK-PGMID               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                       =["
      D             UPD-FLG                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                         =["
      D             UPD-DATE               OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード     =["
      D             UPD-LOGIN-CMP-CD       OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ                   =["
      D             UPD-SID                OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ               =["
      D             UPD-PGMID              OF  WK-TKMZBW07-KEIJYO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      *-----------------------------------------------------------------
                     ELSE
                       CONTINUE
                     END-IF
                   ELSE
                     CONTINUE
                   END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ(普通)."
      D    DISPLAY  CNS-PGM-ID":処理実行日                       =["
      D             SYORI-YMD              OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                           =["
      D             KIDOU-ID               OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード                   =["
      D             RIYO-CMP-CD            OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード                   =["
      D             FUND-CD                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード             =["
      D             PTF-CD                 OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                         =["
      D             TORI-ID                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号                     =["
      D             KS-KOZA-NO             OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":資金種別                         =["
      D             SIKIN-SBT              OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":異動日                           =["
      D             IDO-YMD                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":増減区分                         =["
      D             ZG-KBN                 OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                         =["
      D             AKA-KBN                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":誤計上№                         =["
      D             ERR-KJY-NO             OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                       =["
      D             ERR-KJY-KBN            OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                       =["
      D             THRK-ID                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード               =["
      D             KOZA-TUKA-CD           OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード                   =["
      D             SEC-SBT-CD             OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨資金簿価異動額           =["
      D             SJTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨資金簿価異動額           =["
      D             UYTK-SK-BOKA-IDOGK     OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価                 =["
      D             SJTK-H-BOKA            OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価                 =["
      D             UYTK-H-BOKA            OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価                 =["
      D             SJTK-H-TNK             OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価                 =["
      D             UYTK-H-TNK             OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート                   =["
      D             BOKA-KWS               OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ＣＡＳＨ残高       =["
      D             SJTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ＣＡＳＨ残高       =["
      D             UYTK-IDOG-SK-BOKAZN    OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（内物）=["
      D             SJTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（内物）=["
      D             UYTK-IDOG-MSNKZN-UM    OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（外物）=["
      D             SJTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（外物）=["
      D             UYTK-IDOG-MSNKZN-SM    OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（内物） =["
      D             SJTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（内物） =["
      D             UYTK-IDOG-MBKZN-UM     OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（外物） =["
      D             SJTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（外物） =["
      D             UYTK-IDOG-MBKZN-SM     OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                       =["
      D             UYTK-KWS-SNEKI         OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定           =["
      D             SJTK-RKSEKJ            OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定           =["
      D             UYTK-RKSEKJ            OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序                     =["
      D             IDO-KJY-JUN            OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                         =["
      D             SAKUJO-KBN             OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                       =["
      D             SK-FLG                 OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                         =["
      D             SK-DATE                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード     =["
      D             SK-LOGIN-CMP-CD        OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ                   =["
      D             SK-SID                 OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ               =["
      D             SK-PGMID               OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                       =["
      D             UPD-FLG                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                         =["
      D             UPD-DATE               OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード     =["
      D             UPD-LOGIN-CMP-CD       OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ                   =["
      D             UPD-SID                OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ               =["
      D             UPD-PGMID              OF  WK-TKMZBW07-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データカーソルオープンフラグ=["
      D             FLG-TKMZBW07-CR-OPEN"]"
      *-----------------------------------------------------------------
               END-EVALUATE
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCURSOR"
      D             " FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  資金簿価異動計算データカーソルオープンフラグ
               MOVE  CNS-OFF            TO  FLG-TKMZBW07-CR-OPEN
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCURSOR FETCH 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-032
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-7        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 資金簿価異動計算データCURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW07-FETCH-EXT.
           EXIT.
      ******************************************************************
      *   資金簿価異動計算データCURSOR CLOSE
      ******************************************************************
      *TKMZBW07-CLOSE-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 資金簿価異動計算データCURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW07-CR-OPEN= ["
      *D             FLG-TKMZBW07-CR-OPEN "]"
      *-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZBW07_CUR
      *     END-EXEC
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D           "資金簿価異動計算データCUR CLOSE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCURSOR CLOSE 正常"
      *-----------------------------------------------------------------
      *       MOVE  CNS-OFF               TO  FLG-TKMZBW07-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":CUR OPEN FLAG =["
      *D             FLG-TKMZBW07-CR-OPEN "]"
      *-----------------------------------------------------------------
      *     ELSE
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データCURSOR CLOSE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *        TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
      *       MOVE  CNS-POS-033
      *         TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-7          DELIMITED  BY  SIZE
      *         INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      **----------  エラー処理
      *       PERFORM  ERR-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***資金簿価異動計算データ"
      *D             "CURSOR CLOSE END ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW07-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *        開始時資金残履歴再設定処理
      ******************************************************************
       TKMZSR00-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴再設定処理  START"
      *-----------------------------------------------------------------
      *----------  資金残履歴CURSOR PREPARE
           PERFORM  TKMZSR00-PRE-RTN
      *----------  資金残履歴CURSOR OPEN
           PERFORM  TKMZSR00-OPEN-RTN
      *----------  資金残履歴CURSOR FETCH
           PERFORM  TKMZSR00-FETCH-RTN
      *----------  資金残履歴CURSOR CLOSE
      **** PERFORM  TKMZSR00-CLOSE-RTN                                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴再設定処理  END"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSR00-GET-EXT.
           EXIT.
      ******************************************************************
      *    資金残履歴CURSOR PREPARE
      ******************************************************************
       TKMZSR00-PRE-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 資金残履歴CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZSR00-S
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD           OF  H-TKMZSR00-S,
                 WK-SQL-RIYO-CMP-CD      OF  WK-MSG-1-2
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD               OF  H-TKMZSR00-S,
                 WK-SQL-FUND-CD          OF  WK-MSG-1-2
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD                OF  H-TKMZSR00-S,
                 WK-SQL-PTF-CD           OF  WK-MSG-1-2
      *----------  決済口座番号
           MOVE  WK-MEG-CD
             TO  H-KS-KOZA-NO            OF  H-TKMZSR00-S,
                 WK-SQL-KS-KOZA-NO       OF  WK-MSG-1-2
      *---------- 基準日
           MOVE  WK-KAISI-KJN-YMD
             TO  H-KJN-YMD               OF  H-TKMZSR00-S,
                 WK-SQL-KJN-YMD          OF  WK-MSG-1-2
           INITIALIZE  SQLSTMT02                                        @3212SEINO@@
           MOVE  SQL-SELECT-1-2          TO  SQLSTMT02                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMZSR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD            OF  H-TKMZSR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZSR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":決済口座番号  =["
      D             H-KS-KOZA-NO         OF  H-TKMZSR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日=["
      D             H-KJN-YMD            OF  H-TKMZSR00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT02=[" SQLSTMT02 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZSR00-CR-OPEN=["                @3212SEINO@@
      D                          FLG-TKMZSR00-CR-OPEN"]"                @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZSR00-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  資金残履歴CURSOR PREPARE
             EXEC  SQL
               PREPARE  S7  FROM  :SQLSTMT02                            @3212SEINO@@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":資金残履歴"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-034
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-2         DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSR00-PRE-EXT.
           EXIT.
      ******************************************************************
      *    資金残履歴CURSOR OPEN
      ******************************************************************
       TKMZSR00-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZSR00-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZSR00_CUR  CURSOR  FOR  S7
             END-EXEC
             CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":資金残履歴CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZSR00_CUR
               USING :H-TKMZSR00-S.H-RIYO-CMP-CD,
                     :H-TKMZSR00-S.H-FUND-CD,
                     :H-TKMZSR00-S.H-PTF-CD,
                     :H-TKMZSR00-S.H-KS-KOZA-NO,
                     :H-TKMZSR00-S.H-KJN-YMD
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMZSR00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":TKMZSR00 CURSOR OPEN FLAG=["
      D             FLG-TKMZSR00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-035
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-2         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSR00-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    資金残履歴CURSOR FETCH
      ******************************************************************
       TKMZSR00-FETCH-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-TKMZSR00
           EXEC SQL
             FETCH TKMZSR00_CUR
             INTO  :H-TKMZSR00
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR FETCH  正常"
      *-----------------------------------------------------------------
      *----------  決算日断面区分
               MOVE  KSN-YMD-DMN-KBN     OF  H-TKMZSR00
                 TO  KSN-YMD-DMN-KBN     OF  TKMZSR00-PARM
      *----------  証券種別コード
               MOVE  SEC-SBT-CD          OF  H-TKMZSR00
                 TO  SEC-SBT-CD          OF  TKMZSR00-PARM
      *----------  決済口座通貨コード
               MOVE  KOZA-TUKA-CD        OF  H-TKMZSR00
                 TO  KOZA-TUKA-CD        OF  TKMZSR00-PARM
      *----------  簿価為替レート
               MOVE  BOKA-KWS            OF  H-TKMZSR00
                 TO  BOKA-KWS            OF  TKMZSR00-PARM
      *----------  市場通貨当日CASH残高
               MOVE  SJTK-TJT-CASHZN     OF  H-TKMZSR00
                 TO  SJTK-TJT-CASHZN     OF  TKMZSR00-PARM
      *----------  運用通貨当日CASH残高
               MOVE  UYTK-TJT-CASHZN     OF  H-TKMZSR00
                 TO  UYTK-TJT-CASHZN     OF  TKMZSR00-PARM
      *----------  市場通貨当日未収入金残高（内物）
               MOVE  SJTK-TJT-MSNKZN-UM  OF  H-TKMZSR00
                 TO  SJTK-TJT-MSNKZN-UM  OF  TKMZSR00-PARM
      *----------  運用通貨当日未収入金残高（内物）
               MOVE  UYTK-TJT-MSNKZN-UM  OF  H-TKMZSR00
                 TO  UYTK-TJT-MSNKZN-UM  OF  TKMZSR00-PARM
      *----------  市場通貨当日未収入金残高（外物）
               MOVE  SJTK-TJT-MSNKZN-SM  OF  H-TKMZSR00
                 TO  SJTK-TJT-MSNKZN-SM  OF  TKMZSR00-PARM
      *----------  運用通貨当日未収入金残高（外物）
               MOVE  UYTK-TJT-MSNKZN-SM  OF  H-TKMZSR00
                 TO  UYTK-TJT-MSNKZN-SM  OF  TKMZSR00-PARM
      *----------  市場通貨当日未払金残高（内物）
               MOVE  SJTK-TJT-MBKZN-UM   OF  H-TKMZSR00
                 TO  SJTK-TJT-MBKZN-UM   OF  TKMZSR00-PARM
      *----------  運用通貨当日未払金残高（内物）
               MOVE  UYTK-TJT-MBKZN-UM   OF  H-TKMZSR00
                 TO  UYTK-TJT-MBKZN-UM   OF  TKMZSR00-PARM
      *----------  市場通貨当日未払金残高（外物）
               MOVE  SJTK-TJT-MBKZN-SM   OF  H-TKMZSR00
                 TO  SJTK-TJT-MBKZN-SM   OF  TKMZSR00-PARM
      *----------  運用通貨当日未払金残高（外物）
               MOVE  UYTK-TJT-MBKZN-SM   OF  H-TKMZSR00
                 TO  UYTK-TJT-MBKZN-SM   OF  TKMZSR00-PARM
      *----------  市場通貨未収収益計上・戻入額
               MOVE  SJTK-MSSE-KJMIG     OF  H-TKMZSR00
                 TO  SJTK-MSSE-KJMIG     OF  TKMZSR00-PARM
      *----------  運用通貨未収収益計上・戻入額
               MOVE  UYTK-MSSE-KJMIG     OF  H-TKMZSR00
                 TO  UYTK-MSSE-KJMIG     OF  TKMZSR00-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.開始時資金残履歴情報"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分      =["
      D             KSN-YMD-DMN-KBN     OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード      =["
      D             SEC-SBT-CD          OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード  =["
      D             KOZA-TUKA-CD        OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート      =["
      D             BOKA-KWS            OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日CASH残高=["
      D             SJTK-TJT-CASHZN     OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日CASH残高=["
      D             UYTK-TJT-CASHZN     OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未収入金残高（内物）=["
      D             SJTK-TJT-MSNKZN-UM  OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未収入金残高（内物）=["
      D             UYTK-TJT-MSNKZN-UM  OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未収入金残高（外物）=["
      D             SJTK-TJT-MSNKZN-SM  OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未収入金残高（外物）=["
      D             UYTK-TJT-MSNKZN-SM  OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未払金残高（内物）  =["
      D             SJTK-TJT-MBKZN-UM   OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未払金残高（内物）  =["
      D             UYTK-TJT-MBKZN-UM   OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未払金残高（外物）  =["
      D             SJTK-TJT-MBKZN-SM   OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未払金残高（外物）  =["
      D             UYTK-TJT-MBKZN-SM   OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID"市場通貨未収収益計上・戻入額   =["
      D             SJTK-MSSE-KJMIG     OF  TKMZSR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益計上・戻入額  =["
      D             UYTK-MSSE-KJMIG     OF  TKMZSR00-PARM"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
               INITIALIZE  TKMZSR00-PARM OF  PARM-SMZJ2210-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.開始時資金残履歴情報=["
      D             TKMZSR00-PARM        OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-036
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-2       DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 資金残履歴CURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSR00-FETCH-EXT.
           EXIT.
      ******************************************************************
      *   資金残履歴CURSOR CLOSE
      ******************************************************************
      * TKMZSR00-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR CLOSE START ***"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZSR00_CUR
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"資金残履歴CUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF              TO  FLG-TKMZSR00-CR-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZSR00-CR-OPEN =["
      *D             FLG-TKMZSR00-CR-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *         TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      **----------  ポジション
      *       MOVE  CNS-POS-037
      *         TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      **----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      **---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-2         DELIMITED  BY  SIZE
      *         INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      **-----------------------------------------------------------------
      **----------  エラー処理
      *       PERFORM  ERR-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***資金残履歴CURSOR CLOSE END ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZSR00-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    2)ワーク断面作成情報編集
      ******************************************************************
       DMN-JH-EDIT2-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク断面作成情報編集  START "
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.基準日断面情報.基準日種類=["
      D             KJN-YMD-SHRU         OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
             IF  KJN-YMD-SHRU  OF  TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-0
               OR  KJN-YMD-SHRU  OF TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-4
               OR  KJN-YMD-SHRU  OF TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-5
             THEN
               IF  WK-KEIJYO-FLG  =  CNS-X-1
               THEN
                 IF  WK-NORMAL-FLG  =  CNS-X-0
                 THEN
      *--------  計上_決算後
                   MOVE  CNS-X-2
                     TO  WK-KEIJYO-KSG     OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI    OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE     OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO     OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI     OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE      OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO      OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-2
                     TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
                 ELSE
      *--------  計上_決算後
                   MOVE  CNS-X-2
                     TO  WK-KEIJYO-KSG     OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI    OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE     OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO     OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI     OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE      OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO      OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-2
                     TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
                 END-IF
               ELSE
                 IF  WK-NORMAL-FLG  =  CNS-X-1
                 THEN
      *--------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-1
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 ELSE
      *--------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *--------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *--------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                   MOVE  CNS-X-1
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 END-IF
               END-IF
             ELSE
               IF  WK-KEIJYO-FLG  =  CNS-X-1
               THEN
                 IF  WK-NORMAL-FLG  =  CNS-X-0
                 THEN
      *----------  計上_決算後
                   MOVE  CNS-X-1
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-1
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 ELSE
      *----------  計上_決算後
                   MOVE  CNS-X-1
                     TO  WK-KEIJYO-KSG       OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI      OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-1
                     TO  WK-NORMAL-MAE       OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO       OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI       OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE        OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO        OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH
                 END-IF
               ELSE
                 IF  WK-NORMAL-FLG  =  CNS-X-1
                 THEN
      *----------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG         OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI        OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-1
                     TO  WK-NORMAL-MAE         OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-1
                     TO  WK-NORMAL-ATO         OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI         OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-0
                     TO  WK-START-MAE          OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-0
                     TO  WK-START-ATO          OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN     OF  WK-DMN-SK-JH
                 ELSE
      *----------  計上_決算後
                   MOVE  CNS-X-0
                     TO  WK-KEIJYO-KSG         OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-NASI        OF  WK-DMN-SK-JH
      *----------  普通_決算前
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-MAE         OF  WK-DMN-SK-JH
      *----------  普通_決算後
                   MOVE  CNS-X-0
                     TO  WK-NORMAL-ATO         OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                   MOVE  CNS-X-0
                     TO  WK-START-NASI         OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                   MOVE  CNS-X-1
                     TO  WK-START-MAE          OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                   MOVE  CNS-X-1
                     TO  WK-START-ATO          OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                   MOVE  CNS-X-0
                     TO  WK-KJB-KOUSIN-KBN     OF  WK-DMN-SK-JH
                 END-IF
               END-IF
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.計上_決算後=["
      D             WK-KEIJYO-KSG       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算断面なし=["
      D             WK-NORMAL-NASI      OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算前=["
      D             WK-NORMAL-MAE       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算後=["
      D             WK-NORMAL-ATO       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク断面作成情報.開始時_決算断面なし=["
      D             WK-START-NASI       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.開始時_決算前=["
      D             WK-START-MAE        OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.開始時_決算後=["
      D             WK-START-ATO        OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.基準日別更新区分=["
      D             WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク断面作成情報編集 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DMN-JH-EDIT2-EXT.
           EXIT.
      ******************************************************************
      *    3)ワーク資金残履歴更新編集
      ******************************************************************
       SKZN-KOUSIN-EDIT-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク資金残履歴更新編集  START "
      D    DISPLAY  CNS-PGM-ID":①ワーク断面作成情報.計上_決算後=["
      D             WK-KEIJYO-KSG       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-KEIJYO-KSG  OF  WK-DMN-SK-JH  =  CNS-X-1  OR
               WK-KEIJYO-KSG  OF  WK-DMN-SK-JH  =  CNS-X-2
           THEN
      *----------  ワーク資金簿価異動計算データ(対象)
             MOVE  WK-TKMZBW07-KEIJYO   TO  WK-TKMZBW07-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ(対象)=["
      D             WK-TKMZBW07-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-8 編集要領
             PERFORM  EDIT-1-8-RTN
      *----------  ワーク資金残履歴計算データ(対象).決算日断面区分
             IF  WK-KEIJYO-KSG  OF  WK-DMN-SK-JH  =  CNS-X-1
             THEN
               MOVE  CNS-X-2
                 TO  KSN-YMD-DMN-KBN    OF  WK-TKMZBW12-TASYOU
             ELSE
               MOVE  CNS-X-0
                 TO  KSN-YMD-DMN-KBN    OF  WK-TKMZBW12-TASYOU
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-2-RTN
      *----------  ワーク資金残履歴更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ２
             MOVE  WK-TKMZBW12-TASYOU
               TO  WK-DATA-2            OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-SKZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２=["
      D             WK-DATA-2           OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":②ワーク断面作成情報."
      D    "普通_決算断面なし=["
      D             WK-NORMAL-NASI      OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-NASI  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク資金簿価異動計算データ(対象)
             MOVE  WK-TKMZBW07-NORMAL   TO  WK-TKMZBW07-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ(対象)=["
      D             WK-TKMZBW07-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-8 編集要領
             PERFORM  EDIT-1-8-RTN
      *----------  ワーク資金残履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-0
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-2-RTN
      *----------  ワーク資金残履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１
             MOVE  WK-TKMZBW12-TASYOU
               TO  WK-DATA-1            OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-SKZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":③ワーク断面作成情報.普通_決算前=["
      D             WK-NORMAL-MAE       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-MAE  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク資金簿価異動計算データ(対象)
             MOVE  WK-TKMZBW07-NORMAL   TO  WK-TKMZBW07-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ(対象)=["
      D             WK-TKMZBW07-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-8 編集要領
             PERFORM  EDIT-1-8-RTN
      *----------  ワーク資金残履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-1
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-2-RTN
      *----------  ワーク資金残履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１
             MOVE  WK-TKMZBW12-TASYOU
               TO  WK-DATA-1            OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-SKZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":④ワーク断面作成情報.普通_決算後=["
      D             WK-NORMAL-ATO       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-ATO  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク資金簿価異動計算データ(対象)
             MOVE  WK-TKMZBW07-NORMAL   TO  WK-TKMZBW07-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金簿価異動計算データ(対象)=["
      D             WK-TKMZBW07-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-8 編集要領
             PERFORM  EDIT-1-8-RTN
      *----------  ワーク資金残履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-2
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-2-RTN
      *----------  ワーク資金残履歴更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ２
             MOVE  WK-TKMZBW12-TASYOU
               TO  WK-DATA-2            OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-SKZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２=["
      D             WK-DATA-2           OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑤ワーク断面作成情報."
      D    "開始時_決算断面なし=["
      D             WK-START-NASI       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-NASI  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-6 編集要領
             PERFORM  EDIT-1-6-RTN
      *----------  ワーク資金残履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-0
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-2-RTN
      *----------  ワーク資金残履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１
             MOVE  WK-TKMZBW12-TASYOU
               TO  WK-DATA-1            OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-SKZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑥ワーク断面作成情報.開始時_決算前=["
      D             WK-START-MAE        OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-MAE   OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-6 編集要領
             PERFORM  EDIT-1-6-RTN
      *----------  ワーク資金残履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-1
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-2-RTN
      *----------  ワーク資金残履歴更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１
             MOVE  WK-TKMZBW12-TASYOU
               TO  WK-DATA-1            OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-SKZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１=["
      D             WK-DATA-1           OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑦ワーク断面作成情報.開始時_決算後=["
      D             WK-START-ATO        OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-ATO   OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-6 編集要領
             PERFORM  EDIT-1-6-RTN
      *----------  ワーク資金残履歴計算データ(対象).決算日断面区分
             MOVE  CNS-X-2
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-2-RTN
      *----------  ワーク資金残履歴更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ２
             MOVE  WK-TKMZBW12-TASYOU
               TO  WK-DATA-2            OF  WK-SKZN-KOUSIN
      *----------  ワーク資金残履歴更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-SKZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２=["
      D             WK-DATA-2           OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク資金残履歴更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク資金残履歴更新編集  END "
      *-----------------------------------------------------------------
           CONTINUE.
       SKZN-KOUSIN-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    5)資金残履歴計算データ更新
      ******************************************************************
       SKZN-CALC-KOUSIN-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 資金残履歴計算データ更新  START "
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG          OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新."
      D    "データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-1-FLG  OF  WK-SKZN-KOUSIN  =  CNS-X-1  AND
               WK-DATA-1-YUKOU-ZN-KBN   OF  WK-SKZN-KOUSIN = CNS-X-1
           THEN
      *----------  A)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG         OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":決算前の未収収益計上."
      D    DISPLAY  CNS-PGM-ID ":市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  KESSAN-ZE-M-RSK-KJY"]"
      *-----------------------------------------------------------------
             COMPUTE  SJTK-MSSE-KJMIG       OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                      = SJTK-MSSE-KJMIG     OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                      + SJTK-MS-SHEKI       OF  KESSAN-ZE-M-RSK-KJY
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG         OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG         OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":決算前の未収収益計上."
      D    DISPLAY  CNS-PGM-ID ":運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  KESSAN-ZE-M-RSK-KJY"]"
      *-----------------------------------------------------------------
             COMPUTE  UYTK-MSSE-KJMIG       OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                      = UYTK-MSSE-KJMIG     OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                      + UYTK-MS-SHEKI       OF  KESSAN-ZE-M-RSK-KJY
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG         OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  B)
      *----------  (a)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG         OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
             IF  SJTK-MS-SHEKI              OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                 NOT = CNS-999999999999999-999
             THEN
               COMPUTE  SJTK-MS-SHEKI       OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                        = SJTK-MS-SHEKI     OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                        - SJTK-MSSE-KJMIG   OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
             ELSE
               CONTINUE
             END-IF
      *----------  (b)
             IF  SJTK-MS-SHEKI              OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                 = CNS-999999999999999-999  AND
                 SJTK-MSSE-KJMIG            OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                 NOT = ZERO
             THEN
               COMPUTE  SJTK-MS-SHEKI       OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                        = SJTK-MSSE-KJMIG   OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                        * CNS-MINUS
             ELSE
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG         OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  (c)
             IF  UYTK-MS-SHEKI              OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                 NOT = CNS-999999999999999-999
             THEN
               COMPUTE  UYTK-MS-SHEKI       OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                        = UYTK-MS-SHEKI     OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
                        - UYTK-MSSE-KJMIG   OF  WK-DATA-1
                                            OF  WK-SKZN-KOUSIN
             ELSE
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ１."
      D             "運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  WK-DATA-1
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  C)簿価残マイナスチェック
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１."         20110923
      D             "証券種別コード=["                                  20110923
      D             SEC-SBT-CD       OF  WK-DATA-1 OF WK-SKZN-KOUSIN"]" 20110923
      *-----------------------------------------------------------------20110923
             IF  SEC-SBT-CD          OF  WK-DATA-1 OF WK-SKZN-KOUSIN    20110923
             =   CNS-CASH                                               20110923
             THEN                                                       20110923
      *-------------------<DEBUG>---------------------------------------20110923
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１."
      D             "市場通貨当日ＣＡＳＨ残高=["
      D             SJTK-TJT-CASHZN  OF  WK-DATA-1 OF WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-1 OF WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク資金残履歴更新.データ１.市場通貨当日ＣＡＳＨ残高<0の場合
             IF  SJTK-TJT-CASHZN  OF WK-DATA-1 OF WK-SKZN-KOUSIN  < ZERO
             THEN
               MOVE  CNS-X-1
                 TO  MINUS-SJTK-FLG-1   OF  PARM-SMZJ2210-ARG2
               MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-1 OF WK-SKZN-KOUSIN
                 TO  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
             ELSE
               CONTINUE
             END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（市場通貨"
      D    "簿価)=["MINUS-SJTK-FLG-1    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分1 =["
      D             KSN-YMD-DMN-KBN-1   OF  PARM-SMZJ2210-ARG2"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１."
      D             "運用通貨当日ＣＡＳＨ残高=["
      D             UYTK-TJT-CASHZN  OF  WK-DATA-1 OF WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-1 OF WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク資金残履歴更新.データ１.運用通貨当日ＣＡＳＨ残高<0の場合
             IF  UYTK-TJT-CASHZN  OF WK-DATA-1 OF WK-SKZN-KOUSIN  < ZERO
             THEN
               MOVE  CNS-X-1
                 TO  MINUS-UYTK-FLG-1   OF  PARM-SMZJ2210-ARG2
               MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-1 OF WK-SKZN-KOUSIN
                 TO  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
             ELSE
               CONTINUE
             END-IF
             ELSE                                                       20110923
               CONTINUE                                                 20110923
             END-IF                                                     20110923
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ1（運用通貨"
      D    "簿価)=["MINUS-UYTK-FLG-1   OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分1 =["
      D             KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
             MOVE  SYORI-YMD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SYORI-YMD          OF  H-TKMZBW12-I
             MOVE  KIDOU-ID
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-KIDOU-ID           OF  H-TKMZBW12-I
             MOVE  RIYO-CMP-CD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-RIYO-CMP-CD        OF  H-TKMZBW12-I
             MOVE  FUND-CD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-FUND-CD            OF  H-TKMZBW12-I
             MOVE  PTF-CD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-PTF-CD             OF  H-TKMZBW12-I
             MOVE  KS-KOZA-NO
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-KS-KOZA-NO         OF  H-TKMZBW12-I
             MOVE  KJN-YMD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-KJN-YMD            OF  H-TKMZBW12-I
             MOVE  KSN-YMD-DMN-KBN
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-KSN-YMD-DMN-KBN    OF  H-TKMZBW12-I
             MOVE  SEC-SBT-CD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SEC-SBT-CD         OF  H-TKMZBW12-I
             MOVE  KOZA-TUKA-CD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-KOZA-TUKA-CD       OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-CASHZN
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-CASHZN    OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-CASHZN
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-CASHZN    OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MSNKZN-UM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MSNKZN-UM
                                        OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MSNKZN-UM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MSNKZN-UM
                                        OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MSNKZN-SM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MSNKZN-SM
                                        OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MSNKZN-SM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MSNKZN-SM
                                        OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MBKZN-UM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MBKZN-UM  OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MBKZN-UM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MBKZN-UM  OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MBKZN-SM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MBKZN-SM  OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MBKZN-SM
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MBKZN-SM  OF  H-TKMZBW12-I
             MOVE  BOKA-KWS
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-BOKA-KWS           OF  H-TKMZBW12-I
             MOVE  SJTK-MS-SHEKI
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-MS-SHEKI      OF  H-TKMZBW12-I
             MOVE  UYTK-MS-SHEKI
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-MS-SHEKI      OF  H-TKMZBW12-I
             MOVE  SJTK-GENSEN-TAX
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-GENSEN-TAX    OF  H-TKMZBW12-I
             MOVE  UYTK-GENSEN-TAX
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-GENSEN-TAX    OF  H-TKMZBW12-I
             MOVE  SK-LOGIN-CMP-CD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SK-LOGIN-CMP-CD    OF  H-TKMZBW12-I
             MOVE  UPD-LOGIN-CMP-CD
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UPD-LOGIN-CMP-CD   OF  H-TKMZBW12-I
             MOVE  SYORI-YMD       OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SYORI-YMD     OF  WK-MSG-TKMZBW12
             MOVE  KIDOU-ID        OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KIDOU-ID      OF  WK-MSG-TKMZBW12
             MOVE  SJTK-MSSE-KJMIG
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-MSSE-KJMIG    OF  H-TKMZBW12-I
             MOVE  UYTK-MSSE-KJMIG
               OF  WK-DATA-1            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-MSSE-KJMIG    OF  H-TKMZBW12-I
             MOVE  RIYO-CMP-CD     OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-RIYO-CMP-CD   OF  WK-MSG-TKMZBW12
             MOVE  FUND-CD         OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-FUND-CD       OF  WK-MSG-TKMZBW12
             MOVE  PTF-CD          OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-PTF-CD        OF  WK-MSG-TKMZBW12
             MOVE  KS-KOZA-NO      OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KS-KOZA-NO    OF  WK-MSG-TKMZBW12
             MOVE  KJN-YMD         OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KJN-YMD       OF  WK-MSG-TKMZBW12
             MOVE  KSN-YMD-DMN-KBN OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KSN-YMD-DMN-KBN
                                        OF  WK-MSG-TKMZBW12
             MOVE  SEC-SBT-CD      OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SEC-SBT-CD    OF  WK-MSG-TKMZBW12
             MOVE  KOZA-TUKA-CD    OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KOZA-TUKA-CD  OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-CASHZN OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-CASHZN
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-CASHZN OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-CASHZN
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MSNKZN-UM OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MSNKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MSNKZN-UM OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MSNKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MSNKZN-SM OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MSNKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MSNKZN-SM OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MSNKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MBKZN-UM  OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MBKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MBKZN-UM  OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MBKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MBKZN-SM  OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MBKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MBKZN-SM  OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MBKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  BOKA-KWS        OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-BOKA-KWS      OF  WK-MSG-TKMZBW12
             MOVE  SJTK-MS-SHEKI   OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-MS-SHEKI
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-MS-SHEKI   OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-MS-SHEKI
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-GENSEN-TAX OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-GENSEN-TAX
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-GENSEN-TAX OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-GENSEN-TAX
                                        OF  WK-MSG-TKMZBW12
             MOVE  SK-LOGIN-CMP-CD OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SK-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW12
             MOVE  UPD-LOGIN-CMP-CD  OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UPD-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-MSSE-KJMIG   OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-MSSE-KJMIG
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-MSSE-KJMIG   OF  WK-DATA-1  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-MSSE-KJMIG
                                        OF  WK-MSG-TKMZBW12
             MOVE  CNS-POS-038          TO  WK-ERR-POS
             MOVE  CNS-POS-039          TO  WK-ERR-POS1
             MOVE  CNS-POS-040          TO  WK-ERR-POS2
             PERFORM  TKMZBW12-INSERT-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新."
      D    "データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-2-FLG  OF  WK-SKZN-KOUSIN  =  CNS-X-1  AND
               WK-DATA-2-YUKOU-ZN-KBN OF  WK-SKZN-KOUSIN = CNS-X-1
           THEN
      *----------  A)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG         OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":決算後の未収収益計上."
      D    DISPLAY  CNS-PGM-ID ":市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  KESSAN-GO-M-RSK-KJY"]"
      *-----------------------------------------------------------------
             COMPUTE  SJTK-MSSE-KJMIG       OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                      = SJTK-MSSE-KJMIG     OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                      + SJTK-MS-SHEKI       OF  KESSAN-GO-M-RSK-KJY
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG         OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG         OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":決算後の未収収益計上."
      D    DISPLAY  CNS-PGM-ID ":運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  KESSAN-GO-M-RSK-KJY"]"
      *-----------------------------------------------------------------
             COMPUTE  UYTK-MSSE-KJMIG       OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                      = UYTK-MSSE-KJMIG     OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                      + UYTK-MS-SHEKI       OF  KESSAN-GO-M-RSK-KJY
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG         OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  B)
      *----------  (a)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG         OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
             IF  SJTK-MS-SHEKI              OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                 NOT = CNS-999999999999999-999
             THEN
               COMPUTE  SJTK-MS-SHEKI       OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                        = SJTK-MS-SHEKI     OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                        - SJTK-MSSE-KJMIG   OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
             ELSE
               CONTINUE
             END-IF
      *----------  (b)
             IF  SJTK-MS-SHEKI              OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                 = CNS-999999999999999-999  AND
                 SJTK-MSSE-KJMIG            OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                 NOT = ZERO
             THEN
               COMPUTE  SJTK-MS-SHEKI       OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                        = SJTK-MSSE-KJMIG   OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                        * CNS-MINUS
             ELSE
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "市場通貨未収収益=["
      D             SJTK-MS-SHEKI           OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG         OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  (c)
             IF  UYTK-MS-SHEKI              OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                 NOT = CNS-999999999999999-999
             THEN
               COMPUTE  UYTK-MS-SHEKI       OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                        = UYTK-MS-SHEKI     OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
                        - UYTK-MSSE-KJMIG   OF  WK-DATA-2
                                            OF  WK-SKZN-KOUSIN
             ELSE
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ワーク資金残履歴更新.データ２."
      D             "運用通貨未収収益=["
      D             UYTK-MS-SHEKI           OF  WK-DATA-2
      D                                     OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  C)簿価残マイナスチェック
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２."         20110923
      D             "証券種別コード=["                                  20110923
      D             SEC-SBT-CD       OF  WK-DATA-2 OF WK-SKZN-KOUSIN"]" 20110923
      *-----------------------------------------------------------------20110923
             IF  SEC-SBT-CD          OF  WK-DATA-2 OF WK-SKZN-KOUSIN    20110923
             =   CNS-CASH                                               20110923
             THEN                                                       20110923
      *-------------------<DEBUG>---------------------------------------20110923
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ2."
      D             "市場通貨当日ＣＡＳＨ残高=["
      D             SJTK-TJT-CASHZN  OF  WK-DATA-2 OF WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ2."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-2 OF WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク資金残履歴更新.データ2.市場通貨当日ＣＡＳＨ残高<0の場合
             IF  SJTK-TJT-CASHZN  OF WK-DATA-2 OF WK-SKZN-KOUSIN  < ZERO
             THEN
               MOVE  CNS-X-1
                 TO  MINUS-SJTK-FLG-2   OF  PARM-SMZJ2210-ARG2
               MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-2 OF WK-SKZN-KOUSIN
                 TO  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
             ELSE
               CONTINUE
             END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（市場通貨)=["
      D             MINUS-SJTK-FLG-2    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分2 =["
      D             KSN-YMD-DMN-KBN-2   OF  PARM-SMZJ2210-ARG2"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ2."
      D             "運用通貨当日ＣＡＳＨ残高=["
      D             UYTK-TJT-CASHZN  OF  WK-DATA-2 OF WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ2."
      D             "決算日断面区分=["
      D             KSN-YMD-DMN-KBN  OF  WK-DATA-2 OF WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
      *----------  ワーク資金残履歴更新.データ2.運用通貨当日ＣＡＳＨ残高<0の場合
             IF  UYTK-TJT-CASHZN  OF WK-DATA-2 OF WK-SKZN-KOUSIN  < ZERO
             THEN
               MOVE  CNS-X-1
                 TO  MINUS-UYTK-FLG-2   OF  PARM-SMZJ2210-ARG2
               MOVE  KSN-YMD-DMN-KBN    OF  WK-DATA-2 OF WK-SKZN-KOUSIN
                 TO  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
             ELSE
               CONTINUE
             END-IF
             ELSE                                                       20110923
               CONTINUE                                                 20110923
             END-IF                                                     20110923
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.保有残マイナスフラグ2（運用通貨)=["
      D             MINUS-UYTK-FLG-2    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.決算日断面区分2 =["
      D             KSN-YMD-DMN-KBN-2   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
             MOVE  SYORI-YMD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SYORI-YMD          OF  H-TKMZBW12-I
             MOVE  KIDOU-ID
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-KIDOU-ID           OF  H-TKMZBW12-I
             MOVE  RIYO-CMP-CD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-RIYO-CMP-CD        OF  H-TKMZBW12-I
             MOVE  FUND-CD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-FUND-CD            OF  H-TKMZBW12-I
             MOVE  PTF-CD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-PTF-CD             OF  H-TKMZBW12-I
             MOVE  KS-KOZA-NO
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-KS-KOZA-NO         OF  H-TKMZBW12-I
             MOVE  KJN-YMD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-KJN-YMD            OF  H-TKMZBW12-I
             MOVE  KSN-YMD-DMN-KBN
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-KSN-YMD-DMN-KBN    OF  H-TKMZBW12-I
             MOVE  SEC-SBT-CD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SEC-SBT-CD         OF  H-TKMZBW12-I
             MOVE  KOZA-TUKA-CD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-KOZA-TUKA-CD       OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-CASHZN
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-CASHZN    OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-CASHZN
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-CASHZN    OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MSNKZN-UM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MSNKZN-UM
                                        OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MSNKZN-UM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MSNKZN-UM
                                        OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MSNKZN-SM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MSNKZN-SM
                                        OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MSNKZN-SM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MSNKZN-SM
                                        OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MBKZN-UM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MBKZN-UM  OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MBKZN-UM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MBKZN-UM  OF  H-TKMZBW12-I
             MOVE  SJTK-TJT-MBKZN-SM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-TJT-MBKZN-SM  OF  H-TKMZBW12-I
             MOVE  UYTK-TJT-MBKZN-SM
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-TJT-MBKZN-SM  OF  H-TKMZBW12-I
             MOVE  BOKA-KWS
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-BOKA-KWS           OF  H-TKMZBW12-I
             MOVE  SJTK-MS-SHEKI
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-MS-SHEKI      OF  H-TKMZBW12-I
             MOVE  UYTK-MS-SHEKI
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-MS-SHEKI      OF  H-TKMZBW12-I
             MOVE  SJTK-GENSEN-TAX
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-GENSEN-TAX    OF  H-TKMZBW12-I
             MOVE  UYTK-GENSEN-TAX
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-GENSEN-TAX    OF  H-TKMZBW12-I
             MOVE  SK-LOGIN-CMP-CD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SK-LOGIN-CMP-CD    OF  H-TKMZBW12-I
             MOVE  UPD-LOGIN-CMP-CD
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UPD-LOGIN-CMP-CD   OF  H-TKMZBW12-I
             MOVE  SJTK-MSSE-KJMIG
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-SJTK-MSSE-KJMIG    OF  H-TKMZBW12-I
             MOVE  UYTK-MSSE-KJMIG
               OF  WK-DATA-2            OF  WK-SKZN-KOUSIN
               TO  H-UYTK-MSSE-KJMIG    OF  H-TKMZBW12-I
             MOVE  SYORI-YMD       OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SYORI-YMD     OF  WK-MSG-TKMZBW12
             MOVE  KIDOU-ID        OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KIDOU-ID      OF  WK-MSG-TKMZBW12
             MOVE  RIYO-CMP-CD     OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-RIYO-CMP-CD   OF  WK-MSG-TKMZBW12
             MOVE  FUND-CD         OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-FUND-CD       OF  WK-MSG-TKMZBW12
             MOVE  PTF-CD          OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-PTF-CD        OF  WK-MSG-TKMZBW12
             MOVE  KS-KOZA-NO      OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KS-KOZA-NO    OF  WK-MSG-TKMZBW12
             MOVE  KJN-YMD         OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KJN-YMD       OF  WK-MSG-TKMZBW12
             MOVE  KSN-YMD-DMN-KBN OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KSN-YMD-DMN-KBN
                                        OF  WK-MSG-TKMZBW12
             MOVE  SEC-SBT-CD      OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SEC-SBT-CD    OF  WK-MSG-TKMZBW12
             MOVE  KOZA-TUKA-CD    OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-KOZA-TUKA-CD  OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-CASHZN OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-CASHZN
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-CASHZN OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-CASHZN
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MSNKZN-UM OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MSNKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MSNKZN-UM OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MSNKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MSNKZN-SM OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MSNKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MSNKZN-SM OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MSNKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MBKZN-UM  OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MBKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MBKZN-UM  OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MBKZN-UM
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-TJT-MBKZN-SM  OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-TJT-MBKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-TJT-MBKZN-SM  OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-TJT-MBKZN-SM
                                        OF  WK-MSG-TKMZBW12
             MOVE  BOKA-KWS        OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-BOKA-KWS      OF  WK-MSG-TKMZBW12
             MOVE  SJTK-MS-SHEKI   OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-MS-SHEKI
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-MS-SHEKI   OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-MS-SHEKI
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-GENSEN-TAX OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-GENSEN-TAX
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-GENSEN-TAX OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-GENSEN-TAX
                                        OF  WK-MSG-TKMZBW12
             MOVE  SK-LOGIN-CMP-CD OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SK-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW12
             MOVE  UPD-LOGIN-CMP-CD  OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UPD-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW12
             MOVE  SJTK-MSSE-KJMIG   OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-SJTK-MSSE-KJMIG
                                        OF  WK-MSG-TKMZBW12
             MOVE  UYTK-MSSE-KJMIG   OF  WK-DATA-2  OF  WK-SKZN-KOUSIN
               TO  WK-SQL-UYTK-MSSE-KJMIG
                                        OF  WK-MSG-TKMZBW12
             MOVE  CNS-POS-041          TO  WK-ERR-POS
             MOVE  CNS-POS-042          TO  WK-ERR-POS1
             MOVE  CNS-POS-043          TO  WK-ERR-POS2
             PERFORM  TKMZBW12-INSERT-RTN
           ELSE
             CONTINUE
           END-IF
      *----------  ③ワーク資金残履歴更新.データ１有効残高区分＝'1'(有効)
      *----------  または ワーク資金残履歴更新.データ２有効残高区分＝'1'(有効)の場合、
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新"
      D             ".データ１有効残高区分=["WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新"
      D             ".データ２有効残高区分=["WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-1-YUKOU-ZN-KBN   OF  WK-SKZN-KOUSIN = CNS-X-1 OR
               WK-DATA-2-YUKOU-ZN-KBN   OF  WK-SKZN-KOUSIN = CNS-X-1
           THEN
      *----------  ARG2.履歴作成フラグ
             MOVE  CNS-RIREKI-SAKUSEI-FLG-1
               TO  RIREKI-SAKUSEI-FLG   OF  PARM-SMZJ2210-ARG2
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.履歴作成フラグ=["
      D             RIREKI-SAKUSEI-FLG  OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID": 資金残履歴計算データ更新  END "
      *-----------------------------------------------------------------
           CONTINUE.
       SKZN-CALC-KOUSIN-EXT.
           EXIT.
      ******************************************************************
      *    資金残履歴計算データにINSERTする
      ******************************************************************
       TKMZBW12-INSERT-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 資金残履歴計算データにINSERTする START ***"
      *-----------------------------------------------------------------
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日  =["
      D             H-SYORI-YMD          OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":起動ID  =["
      D             H-KIDOU-ID           OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             H-FUND-CD            OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号=["
      D             H-KS-KOZA-NO         OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":基準日  =["
      D             H-KJN-YMD            OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分  =["
      D             H-KSN-YMD-DMN-KBN    OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード  =["
      D             H-SEC-SBT-CD         OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード  =["
      D             H-KOZA-TUKA-CD       OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日ＣＡＳＨ残高  =["
      D             H-SJTK-TJT-CASHZN    OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日ＣＡＳＨ残高  =["
      D             H-UYTK-TJT-CASHZN    OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未収入金残高（内物）=["
      D             H-SJTK-TJT-MSNKZN-UM OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未収入金残高（内物）=["
      D             H-UYTK-TJT-MSNKZN-UM OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未収入金残高（外物）=["
      D             H-SJTK-TJT-MSNKZN-SM OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未収入金残高（外物）=["
      D             H-UYTK-TJT-MSNKZN-SM OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未払金残高（内物）=["
      D             H-SJTK-TJT-MBKZN-UM  OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未払金残高（内物）=["
      D             H-UYTK-TJT-MBKZN-UM  OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未払金残高（外物）=["
      D             H-SJTK-TJT-MBKZN-SM  OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未払金残高（外物）=["
      D             H-UYTK-TJT-MBKZN-SM  OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード=["
      D             H-SK-LOGIN-CMP-CD    OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード=["
      D             H-UPD-LOGIN-CMP-CD   OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID ":市場通貨未収収益計上・戻入額=["
      D             H-SJTK-MSSE-KJMIG    OF  H-TKMZBW12-I"]"
      D    DISPLAY  CNS-PGM-ID ":運用通貨未収収益計上・戻入額=["
      D             H-UYTK-MSSE-KJMIG    OF  H-TKMZBW12-I"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMTIN02                                      @3212SEINO@@
      *----ＳＱＬ文
           MOVE  SQL-INSERT-TKMZBW12     TO  SQLSTMTIN02                @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMTIN02=["SQLSTMTIN02"]"            @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW12-S11-INSERT=["              @3212SEINO@@
      D                           FLG-TKMZBW12-S11-INSERT"]"            @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
           IF  FLG-TKMZBW12-S11-INSERT = CNS-OFF                        @3212SEINO@@
           THEN                                                         @3212SEINO@@
      **** EXEC SQL                                                     @3212SEINO@@
      ****     PREPARE S7 FROM :SQLSTMT                                 @3212SEINO@@
      **** END-EXEC                                                     @3212SEINO@@
             EXEC SQL                                                   @3212SEINO@@
                 PREPARE S11 FROM :SQLSTMTIN02                          @3212SEINO@@
             END-EXEC                                                   @3212SEINO@@
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴計算データ"
      D             "PREPARE SQLCODE =["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴計算データ PREPARE  正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴計算データ PREPARE  異常"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW12     DELIMITED  BY  SIZE
                 INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      **** EXEC SQL                                                     @3212SEINO@@
      ****     EXECUTE S7                                               @3212SEINO@@
      ****       USING :H-TKMZBW12-I                                    @3212SEINO@@
      **** END-EXEC                                                     @3212SEINO@@
           EXEC SQL                                                     @3212SEINO@@
               EXECUTE S11                                              @3212SEINO@@
                 USING :H-TKMZBW12-I                                    @3212SEINO@@
           END-EXEC                                                     @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴計算データ"
      D             " INSERT SQLCODE =["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               MOVE  CNS-ON             TO  FLG-TKMZBW12-S11-INSERT     @3212SEINO@@
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴計算データ INSERT  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW12-S11-INSERT["               @3212SEINO@@
      D                         FLG-TKMZBW12-S11-INSERT"]"              @3212SEINO@@
      *-----------------------------------------------------------------
      *        CONTINUE                                                 @3212SEINO@@
             WHEN  CNS-SQL-UNIQUE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":資金残履歴計算データ INSERT 一意制約違反"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS1
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-300
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW12   DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
             WHEN OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴計算データ INSERT  異常"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS2
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW12   DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 資金残履歴計算データにINSERTする END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW12-INSERT-EXT.
           EXIT.
      ******************************************************************
      *    6）取引差分更新管理更新
      ******************************************************************
       TRHK-SABON-UD2-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 取引差分更新管理更新  START "
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新."
      D             "データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-SKZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴更新."
      D             "データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-SKZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  (WK-DATA-1-FLG  OF  WK-SKZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-1-YUKOU-ZN-KBN OF  WK-SKZN-KOUSIN = CNS-X-1) OR
               (WK-DATA-2-FLG  OF  WK-SKZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-2-YUKOU-ZN-KBN OF  WK-SKZN-KOUSIN = CNS-X-1)
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  START "
      *-----------------------------------------------------------------
      *----------  機能区分
             MOVE  CNS-X-2
               TO  MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT
      *----------  更新データ区分
             MOVE  CNS-X-2
               TO  UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT
      *----------  OL/BT区分
             MOVE  CNS-BT
               TO  OL-BT-KBN            OF  PARM-SMZC9201-INOUT
      *----------  有効残高区分
             MOVE  CNS-YUKO-ZN-KBN-1
               TO  YUKO-ZN-KBN          OF  PARM-SMZC9201-ARG1
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  PARM-SMZC9201-ARG3
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  PARM-SMZC9201-ARG3
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  PARM-SMZC9201-ARG3
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  PARM-SMZC9201-ARG3
      *----------  決済口座番号
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  KS-KOZA-NO           OF  PARM-SMZC9201-ARG3
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  PARM-SMZC9201-ARG3
      *----------  最終有効日
             MOVE  ZERO
               TO  LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG3
      *----------  取引属性データエリア
             MOVE  TORI-ZOKUSEI-AREA    OF  PARM-SMZJ2210-ARG1
               TO  TORI-ZOKUSEI-AREA    OF  PARM-SMZC9201-ARG1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             MENU-KINOU-KBN      OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":更新データ区分  =["
      D             UPD-DATA-KBN        OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分  =["
      D             OL-BT-KBN           OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":有効残高区分  =["
      D             YUKO-ZN-KBN         OF  PARM-SMZC9201-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             RIYO-CMP-CD         OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             FUND-CD             OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号  =["
      D             KS-KOZA-NO          OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":基準日  =["
      D             KJN-YMD             OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":最終有効日  =["
      D             LAST-YUKO-YMD       OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID ":取引属性データエリア         =["
      D             TORI-ZOKUSEI-AREA   OF  PARM-SMZC9201-ARG1"]"
      *-----------------------------------------------------------------
             CALL  "SMZC9201"           USING  PARM-SMZC9201-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC9201)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
               =  CNS-RTN-000
             THEN
               CONTINUE
             ELSE
      *----------  エラー
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-044
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-901
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  END "
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           IF  (WK-DATA-1-FLG  OF  WK-SKZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-1-YUKOU-ZN-KBN OF  WK-SKZN-KOUSIN = CNS-X-0) OR
               (WK-DATA-2-FLG  OF  WK-SKZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-2-YUKOU-ZN-KBN OF  WK-SKZN-KOUSIN = CNS-X-0)
           THEN
             PERFORM  TKMZBW11-GET-RTN
             IF  WK-KJN-YMD-COUNT  =  ZERO
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  START "
      *-----------------------------------------------------------------
      *----------  機能区分
               MOVE  CNS-X-2
                 TO  MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT
      *----------  更新データ区分
               MOVE  CNS-X-2
                 TO  UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT
      *----------  OL/BT区分
               MOVE  CNS-BT
                 TO  OL-BT-KBN            OF  PARM-SMZC9201-INOUT
      *----------  有効残高区分
               MOVE  CNS-YUKO-ZN-KBN-0
                 TO  YUKO-ZN-KBN          OF  PARM-SMZC9201-ARG1
      *----------  利用会社コード
               MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
                 TO  RIYO-CMP-CD          OF  PARM-SMZC9201-ARG3
      *----------  ファンドコード
               MOVE  FUND-CD              OF  TKMZBW03-PARM
                 TO  FUND-CD              OF  PARM-SMZC9201-ARG3
      *----------  ポートフォリオコード
               MOVE  PTF-CD               OF  TKMZBW03-PARM
                 TO  PTF-CD               OF  PARM-SMZC9201-ARG3
      *----------  証券種別コード
               MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
                 TO  SEC-SBT-CD           OF  PARM-SMZC9201-ARG3
      *----------  決済口座番号
               MOVE  MEG-CD               OF  TKMZBW03-PARM
                 TO  KS-KOZA-NO           OF  PARM-SMZC9201-ARG3
      *----------  基準日
               MOVE  KJN-YMD              OF  TKMZBW03-PARM
                 TO  KJN-YMD              OF  PARM-SMZC9201-ARG3
      *----------  最終有効日
               MOVE  IDO-YMD              OF  WK-TKMZBW07-NORMAL
                 TO  LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG3
      *----------  取引属性データエリア
             MOVE  TORI-ZOKUSEI-AREA    OF  PARM-SMZJ2210-ARG1
               TO  TORI-ZOKUSEI-AREA    OF  PARM-SMZC9201-ARG1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":更新データ区分  =["
      D             UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分  =["
      D             OL-BT-KBN            OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":有効残高区分  =["
      D             YUKO-ZN-KBN         OF  PARM-SMZC9201-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             RIYO-CMP-CD          OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             FUND-CD              OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD               OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD           OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号  =["
      D             KS-KOZA-NO           OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":基準日  =["
      D             KJN-YMD              OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID":最終有効日  =["
      D             LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG3"]"
      D    DISPLAY  CNS-PGM-ID ":取引属性データエリア         =["
      D             TORI-ZOKUSEI-AREA   OF  PARM-SMZC9201-ARG1"]"
      *-----------------------------------------------------------------
               CALL  "SMZC9201"           USING  PARM-SMZC9201-INOUT
                                                 PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC9201)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
               IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
               =  CNS-RTN-000
               THEN
                 CONTINUE
               ELSE
      *----------  エラー
                 MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-045
                   TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-901
                   TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                   TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-0
                   TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 MOVE  SPACE
                   TO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  END "
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 取引差分更新管理更新  END "
      *-----------------------------------------------------------------
           CONTINUE.
       TRHK-SABON-UD2-EXT.
           EXIT.
      ******************************************************************
      *        残高履歴計算データ
      ******************************************************************
       TKMZBW11-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ  START"
      *-----------------------------------------------------------------
      *----------  残高履歴計算データCURSOR PREPARE
           PERFORM  TKMZBW11-PRE-RTN
      *----------  残高履歴計算データCURSOR OPEN
           PERFORM  TKMZBW11-OPEN-RTN
      *----------  残高履歴計算データCURSOR FETCH
           PERFORM  TKMZBW11-FETCH-RTN
      *----------  残高履歴計算データCURSOR CLOSE
      **** PERFORM  TKMZBW11-CLOSE-RTN                                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データ  END"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW11-GET-EXT.
           EXIT.
      ******************************************************************
      *    残高履歴計算データCURSOR PREPARE
      ******************************************************************
       TKMZBW11-PRE-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴計算データCURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZBW11-S
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW11-S,
                 WK-SQL-RIYO-CMP-CD     OF  WK-MSG-1-15
      *----------  処理実行日
           MOVE  WK-SYORI-YMD
             TO  H-SYORI-YMD            OF  H-TKMZBW11-S,
                 WK-SQL-SYORI-YMD       OF  WK-MSG-1-15
      *----------  起動ID
           MOVE  WK-KIDOU-ID
             TO  H-KIDOU-ID             OF  H-TKMZBW11-S,
                 WK-SQL-KIDOU-ID        OF  WK-MSG-1-15
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD              OF  H-TKMZBW11-S,
                 WK-SQL-FUND-CD         OF  WK-MSG-1-15
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD               OF  H-TKMZBW11-S,
                 WK-SQL-PTF-CD          OF  WK-MSG-1-15
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD
             TO  H-SEC-SBT-CD           OF  H-TKMZBW11-S,
                 WK-SQL-SEC-SBT-CD      OF  WK-MSG-1-15
      *----------  銘柄コード
           MOVE  WK-MEG-CD
             TO  H-MEG-CD               OF  H-TKMZBW11-S,
                 WK-SQL-MEG-CD          OF  WK-MSG-1-15
      *----------  資産/負債・買建/売建フラグ
           MOVE  WK-TATE-FLG
             TO  H-TATE-FLG             OF  H-TKMZBW11-S,
                 WK-SQL-TATE-FLG        OF  WK-MSG-1-15
      *----------  玉ID
           MOVE  WK-GYOKU-ID
             TO  H-GYOKU-ID             OF  H-TKMZBW11-S,
                 WK-SQL-GYOKU-ID        OF  WK-MSG-1-15
      *----------  基準日
           MOVE  WK-KJN-YMD
             TO  H-KJN-YMD              OF  H-TKMZBW11-S,
                 WK-SQL-KJN-YMD         OF  WK-MSG-1-15
           INITIALIZE  SQLSTMT15                                        @3212SEINO@@
           MOVE  SQL-SELECT-1-15          TO  SQLSTMT15                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード   = ["
      D             H-RIYO-CMP-CD          OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日       = ["
      D             H-SYORI-YMD            OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID           = ["
      D             H-KIDOU-ID             OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード   = ["
      D             H-FUND-CD              OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード= ["
      D             H-PTF-CD               OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード   = ["
      D             H-SEC-SBT-CD           OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード       = ["
      D             H-MEG-CD               OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産/負債・買建/売建フラグ= ["
      D             H-TATE-FLG             OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ID             = ["
      D             H-GYOKU-ID             OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日           = ["
      D             H-KJN-YMD              OF  H-TKMZBW11-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT15 = ["SQLSTMT15"]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW11-CR-OPEN = ["              @3212SEINO@@
      D                          FLG-TKMZBW11-CR-OPEN"]"                @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZBW11-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  残高履歴計算データCURSOR PREPARE
             EXEC  SQL
               PREPARE  S15  FROM  :SQLSTMT15                           @3212SEINO@@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":残高履歴計算データ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-046
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-15         DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴計算データCURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW11-PRE-EXT.
           EXIT.
      ******************************************************************
      *    残高履歴計算データCURSOR OPEN
      ******************************************************************
       TKMZBW11-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴計算データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZBW11-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZBW11_CUR  CURSOR  FOR  S15
             END-EXEC
             CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZBW11_CUR
               USING :H-TKMZBW11-S.H-RIYO-CMP-CD,
                     :H-TKMZBW11-S.H-SYORI-YMD,
                     :H-TKMZBW11-S.H-KIDOU-ID,
                     :H-TKMZBW11-S.H-FUND-CD,
                     :H-TKMZBW11-S.H-PTF-CD,
                     :H-TKMZBW11-S.H-SEC-SBT-CD,
                     :H-TKMZBW11-S.H-MEG-CD,
                     :H-TKMZBW11-S.H-TATE-FLG,
                     :H-TKMZBW11-S.H-GYOKU-ID,
                     :H-TKMZBW11-S.H-KJN-YMD
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMZBW11-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":TKMZBW11 CURSOR OPEN FLAG=["
      D             FLG-TKMZBW11-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-047
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-15         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴計算データCURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW11-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    残高履歴計算データCURSOR FETCH
      ******************************************************************
       TKMZBW11-FETCH-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-KJN-YMD-COUNT,
                       WK-KJN-YMD-COUNT
           EXEC SQL
             FETCH TKMZBW11_CUR
             INTO  :H-KJN-YMD-COUNT
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
             WHEN  CNS-SQL-NOTFOUND
               MOVE  H-KJN-YMD-COUNT    TO  WK-KJN-YMD-COUNT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":H-KJN-YMD-COUNT  =["H-KJN-YMD-COUNT"]"
      D    DISPLAY  CNS-PGM-ID":WK-KJN-YMD-COUNT =["WK-KJN-YMD-COUNT"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-048
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-15       DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴計算データCURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW11-FETCH-EXT.
           EXIT.
      ******************************************************************
      *   残高履歴計算データCURSOR CLOSE
      ******************************************************************
      * TKMZBW11-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 残高履歴計算データCURSOR CLOSE START ***"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZBW11_CUR
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             "残高履歴計算データCUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高履歴計算データCURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF              TO  FLG-TKMZBW11-CR-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW11-CR-OPEN =["
      *D             FLG-TKMZBW11-CR-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高履歴計算データCURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *         TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      **----------  ポジション
      *       MOVE  CNS-POS-049
      *         TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      **----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      **---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-15         DELIMITED  BY  SIZE
      *         INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      **-----------------------------------------------------------------
      **----------  エラー処理
      *       PERFORM  ERR-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":***残高履歴計算データCURSOR CLOSE END ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW11-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    3.2.3 対象銘柄は元本の場合の処理
      ******************************************************************
       TASYOU-MEG-GNPN-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***対象銘柄は元本の場合の処理  START **"
      *-----------------------------------------------------------------
      *---------- 3.2.3.1 対応基準日の元本残高を作成する
           PERFORM  TASYOU-YMD-GPNZN-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***対象銘柄は元本の場合の処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TASYOU-MEG-GNPN-EXT.
           EXIT.
      ******************************************************************
      *    3.2.3.1 対応基準日の元本残高を作成する
      ******************************************************************
       TASYOU-YMD-GPNZN-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 対応基準日の元本残高を作成する"
      D             " の処理  START "
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN "]"
      *-----------------------------------------------------------------
           PERFORM  TKMZBW06-GET2-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分 =["WK-TBL-KBN"]"
      *-----------------------------------------------------------------
           IF  WK-TBL-KBN         =  2
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分＝2（残高異動TBL）の場合"
      *-----------------------------------------------------------------
             PERFORM  TKMZGZ00-GET-RTN
           ELSE
             CONTINUE
           END-IF
      *---------- 2)ワーク断面作成情報編集
           PERFORM  DMN-JH-EDIT3-RTN
      *---------- 3)ワーク元本残高更新編集
           PERFORM  GNPZN-UD-EDIT-RTN
      *---------- 4)元本残高計算データ更新
           PERFORM  GNPZN-CALC-UD-RTN
      *---------- 5)取引差分更新管理更新
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":欠落断面有無フラグ=["LACK-DMN-FLG"]"
      *-----------------------------------------------------------------
           IF  LACK-DMN-FLG        NOT   = 1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":欠落断面有無フラグ≠1（あり）の場合"
      *-----------------------------------------------------------------
             PERFORM  TRHK-SABON-UD3-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***対応基準日の資金残履歴を作成する処理 END ***"
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象銘柄は資金の場合の処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TASYOU-YMD-GPNZN-EXT.
           EXIT.
      ******************************************************************
      *        1)ARG1.銘柄別断面情報.再計算区分 <> 2：コピーの場合
      ******************************************************************
       TKMZBW06-GET2-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ取得  START"
      *-----------------------------------------------------------------
      *----------  残高異動計算データCURSOR PREPARE
           PERFORM  TKMZBW06-PRE2-RTN
      *----------  残高異動計算データCURSOR OPEN
           PERFORM  TKMZBW06-OPEN2-RTN
      *----------  残高異動計算データCURSOR FETCH
           PERFORM  TKMZBW06-FETCH2-RTN
      *----------  残高異動計算データCURSOR CLOSE
      *    PERFORM  TKMZBW06-CLOSE2-RTN                                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ取得  END"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-GET2-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データCURSOR PREPARE
      ******************************************************************
       TKMZBW06-PRE2-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 残高異動計算データ"
      D                       "CURSOR PREPARE2 START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZBW06-S
                       SQLSTMT04-2                                      @3212SEINO@@
                       SQLSTMT04-4                                      @3212SEINO@@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD           OF  H-TKMZBW06-S,
                 WK-SQL-RIYO-CMP-CD      OF  WK-MSG-1-4
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD               OF  H-TKMZBW06-S,
                 WK-SQL-FUND-CD          OF  WK-MSG-1-4
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD                OF  H-TKMZBW06-S,
                 WK-SQL-PTF-CD           OF  WK-MSG-1-4
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD
             TO  H-SEC-SBT-CD            OF  H-TKMZBW06-S,
                 WK-SQL-SEC-SBT-CD       OF  WK-MSG-1-4
      *----------  銘柄コード
           MOVE  WK-MEG-CD
             TO  H-MEG-CD                OF  H-TKMZBW06-S,
                 WK-SQL-MEG-CD           OF  WK-MSG-1-4
      *----------  資産/負債・買建/売建フラグ
           MOVE  WK-TATE-FLG
             TO  H-TATE-FLG              OF  H-TKMZBW06-S,
                 WK-SQL-TATE-FLG         OF  WK-MSG-1-4
      *---------- 玉ID
           MOVE  WK-GYOKU-ID
             TO  H-GYOKU-ID              OF  H-TKMZBW06-S,
                 WK-SQL-GYOKU-ID         OF  WK-MSG-1-4
      *---------- 計上基準日1
           MOVE  WK-KAISI-KJN-YMD
             TO  H-KEIJOU-KIJUNBI-1      OF  H-TKMZBW06-S,
                 WK-SQL-KEIJOU-KIJUNBI-1 OF  WK-MSG-1-4
      *---------- 計上基準日2
           MOVE  WK-KJN-YMD
             TO  H-KEIJOU-KIJUNBI-2      OF  H-TKMZBW06-S,
                 WK-SQL-KEIJOU-KIJUNBI-2 OF  WK-MSG-1-4
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD
             TO  H-SYORI-YMD             OF  H-TKMZBW06-S,
                 WK-SQL-SYORI-YMD        OF  WK-MSG-1-4
      *---------- 起動ID
           MOVE  WK-KIDOU-ID
             TO  H-KIDOU-ID              OF  H-TKMZBW06-S,
                 WK-SQL-KIDOU-ID         OF  WK-MSG-1-4
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD            OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード=["
      D             H-SEC-SBT-CD         OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産/負債・買建/売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ID=["
      D             H-GYOKU-ID           OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":計上基準日1=["
      D             H-KEIJOU-KIJUNBI-1   OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":計上基準日2=["
      D             H-KEIJOU-KIJUNBI-2   OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日=["
      D             H-SYORI-YMD          OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID=["
      D             H-KIDOU-ID           OF  H-TKMZBW06-S"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.異動計算パターン.処理順序=["
      D             WK-SYRI-JUN"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.基準日断面情報.基本会計"
      D             "ベースフラグ=["WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
      *---------- 受渡日
           IF (WK-SYRI-JUN               =  "5"
           OR  WK-SYRI-JUN               =  "6"
           OR  WK-SYRI-JUN               =  "7"
           OR  WK-SYRI-JUN               =  "8")
           AND WK-KH-KAIKEI-BASE-FLG     =  "1"
           THEN
      *---------- 受渡日
             MOVE  "UKE_YMD"
               TO  WK-UKK-YMD            OF  SQL-SELECT-1-4
             MOVE  SQL-SELECT-1-4        TO  SQLSTMT04-2                @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ORDER-BY =["
      D             WK-UKK-YMD           OF  SQL-SELECT-1-4"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT04-2=[" SQLSTMT04-2 "]"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@@
      D        ":FLG-TKMZBW06-CR2-OPEN=["FLG-TKMZBW06-CR2-OPEN"]"       @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR2-OPEN = CNS-OFF                        @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  残高異動計算データCURSOR PREPARE
               EXEC  SQL
                 PREPARE  S5_2  FROM  :SQLSTMT04-2                      @3212SEINO@@
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-050
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-4         DELIMITED  BY  SIZE
                   INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           ELSE
             MOVE  "KEIJOU_KIJUNBI"
               TO  WK-UKK-YMD            OF  SQL-SELECT-1-4
             MOVE  SQL-SELECT-1-4        TO  SQLSTMT04-4                @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":ORDER-BY =["
      D             WK-UKK-YMD           OF  SQL-SELECT-1-4"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT04-4=[" SQLSTMT04-4 "]"         @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@@
      D        ":FLG-TKMZBW06-CR4-OPEN=["FLG-TKMZBW06-CR4-OPEN"]"       @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR4-OPEN = CNS-OFF                        @3212SEINO@@
             THEN                                                       @3212SEINO@@
      *----------  残高異動計算データCURSOR PREPARE
               EXEC  SQL
                 PREPARE  S5_4  FROM  :SQLSTMT04-4                      @3212SEINO@@
               END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":残高異動計算データ"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
               IF  SQLCODE = CNS-SQL-NORMAL
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
                 MOVE  CNS-PGM-ID
                   TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
                 MOVE  CNS-POS-050
                   TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
                 MOVE  CNS-RTN-900
                   TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
                 MOVE  SQLCODE
                   TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-1
                   TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-4         DELIMITED  BY  SIZE
                   INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
                 PERFORM  ERR-RTN
               END-IF
             ELSE                                                       @3212SEINO@@
               CONTINUE                                                 @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高異動計算データ"
      D                        "CURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-PRE2-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データCURSOR OPEN
      ******************************************************************
       TKMZBW06-OPEN2-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN START ***"
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@@
      D        ":FLG-TKMZBW06-CR2-OPEN=["FLG-TKMZBW06-CR2-OPEN"]"       @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":ARG1.異動計算パターン.処理順序=["
      D             WK-SYRI-JUN"]"
      D    DISPLAY  CNS-PGM-ID ":ARG1.基準日断面情報.基本会計"
      D             "ベースフラグ=["WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
      *---------- 受渡日
           IF (WK-SYRI-JUN               =  "5"
           OR  WK-SYRI-JUN               =  "6"
           OR  WK-SYRI-JUN               =  "7"
           OR  WK-SYRI-JUN               =  "8")
           AND WK-KH-KAIKEI-BASE-FLG     =  "1"
           THEN
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR2-OPEN = CNS-OFF                          @3212SEINO@@
             THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZBW06_CUR2_2  CURSOR  FOR  S5_2
               END-EXEC
               CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                         @3212SEINO@@
               CONTINUE                                                   @3212SEINO@@
             END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZBW06_CUR2_2
                 USING :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-SYORI-YMD,
                       :H-TKMZBW06-S.H-KIDOU-ID,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2
             END-EXEC
           ELSE
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
             IF  FLG-TKMZBW06-CR4-OPEN = CNS-OFF                          @3212SEINO@@
             THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
               EXEC  SQL
                 DECLARE  TKMZBW06_CUR2_4  CURSOR  FOR  S5_4
               END-EXEC
               CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
             ELSE                                                         @3212SEINO@@
               CONTINUE                                                   @3212SEINO@@
             END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
             EXEC  SQL
               OPEN  TKMZBW06_CUR2_4
                 USING :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-SYORI-YMD,
                       :H-TKMZBW06-S.H-KIDOU-ID,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2,
                       :H-TKMZBW06-S.H-RIYO-CMP-CD,
                       :H-TKMZBW06-S.H-FUND-CD,
                       :H-TKMZBW06-S.H-PTF-CD,
                       :H-TKMZBW06-S.H-SEC-SBT-CD,
                       :H-TKMZBW06-S.H-MEG-CD,
                       :H-TKMZBW06-S.H-TATE-FLG,
                       :H-TKMZBW06-S.H-GYOKU-ID,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-1,
                       :H-TKMZBW06-S.H-KEIJOU-KIJUNBI-2
             END-EXEC
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":残高異動計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
      *---------- 受渡日
             IF (WK-SYRI-JUN               =  "5"
             OR  WK-SYRI-JUN               =  "6"
             OR  WK-SYRI-JUN               =  "7"
             OR  WK-SYRI-JUN               =  "8")
             AND WK-KH-KAIKEI-BASE-FLG     =  "1"
             THEN
               MOVE  CNS-ON               TO  FLG-TKMZBW06-CR2-OPEN
             ELSE
               MOVE  CNS-ON               TO  FLG-TKMZBW06-CR4-OPEN
             END-IF
      *----------  ワーク普通フラグ
             MOVE  CNS-X-0              TO  WK-NORMAL-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":TKMZBW06 CURSOR OPEN FLAG=["
      D             FLG-TKMZBW06-CR2-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR4-OPEN=["
      D                         FLG-TKMZBW06-CR4-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-051
               TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-4         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-OPEN2-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データCURSOR FETCH
      ******************************************************************
       TKMZBW06-FETCH2-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-TKMZBW06,
                       H-TKMZBW06-TBL-KBN
      *---------- 受渡日
           IF (WK-SYRI-JUN               =  "5"
           OR  WK-SYRI-JUN               =  "6"
           OR  WK-SYRI-JUN               =  "7"
           OR  WK-SYRI-JUN               =  "8")
           AND WK-KH-KAIKEI-BASE-FLG     =  "1"
           THEN
             EXEC SQL
               FETCH TKMZBW06_CUR2_2
               INTO  :H-TKMZBW06,
                     :H-TKMZBW06-TBL-KBN
             END-EXEC
           ELSE
             EXEC SQL
               FETCH TKMZBW06_CUR2_4
               INTO  :H-TKMZBW06,
                     :H-TKMZBW06-TBL-KBN
             END-EXEC
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":残高異動計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  正常"
      *-----------------------------------------------------------------
      *----------  ワーク残高異動計算データ(普通)
               MOVE  H-TKMZBW06         TO  WK-TKMZBW06-NORMAL
      *----------  ワークTBL区分
               MOVE  H-TKMZBW06-TBL-KBN TO  WK-TBL-KBN
      *----------  ワーク普通フラグ
               MOVE  CNS-X-1            TO  WK-NORMAL-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(普通)     =["
      D             WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID":ワークTBL区分     =["WK-TBL-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ  =["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-052
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-4        DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW06-FETCH2-EXT.
           EXIT.
      ******************************************************************
      *   残高異動計算データCURSOR CLOSE
      ******************************************************************
      * TKMZBW06-CLOSE2-RTN    SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 残高異動計算データCURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR1-OPEN= ["
      *D             FLG-TKMZBW06-CR1-OPEN "]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZBW06_CUR2
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID
      *D           "残高異動計算データCUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF               TO  FLG-TKMZBW06-CR2-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":CUR OPEN FLAG =["
      *D             FLG-TKMZBW06-CR2-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *         TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      **----------  ポジション
      *       MOVE  CNS-POS-053
      *         TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      **----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      **---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-4          DELIMITED  BY  SIZE
      *         INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      **-----------------------------------------------------------------
      **----------  エラー処理
      *       PERFORM  ERR-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***残高異動計算データ"
      *D             "CURSOR CLOSE END ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW06-CLOSE2-EXT.
      *     EXIT.
      ******************************************************************
      *        開始時元本残高再設定処理
      ******************************************************************
       TKMZGZ00-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":開始時元本残高再設定処理  START"
      *-----------------------------------------------------------------
      *----------  元本残高CURSOR PREPARE
           PERFORM  TKMZGZ00-PRE-RTN
      *----------  元本残高CURSOR OPEN
           PERFORM  TKMZGZ00-OPEN-RTN
      *----------  元本残高CURSOR FETCH
           PERFORM  TKMZGZ00-FETCH-RTN
      *----------  元本残高CURSOR CLOSE
      **** PERFORM  TKMZGZ00-CLOSE-RTN                                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":開始時元本残高再設定処理  END"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZGZ00-GET-EXT.
           EXIT.
      ******************************************************************
      *    元本残高CURSOR PREPARE
      ******************************************************************
       TKMZGZ00-PRE-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 元本残高CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZGZ00-S
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD
             TO  H-RIYO-CMP-CD           OF  H-TKMZGZ00-S,
                 WK-SQL-RIYO-CMP-CD      OF  WK-MSG-1-12
      *----------  ファンドコード
           MOVE  WK-FUND-CD
             TO  H-FUND-CD               OF  H-TKMZGZ00-S,
                 WK-SQL-FUND-CD          OF  WK-MSG-1-12
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD
             TO  H-PTF-CD                OF  H-TKMZGZ00-S,
                 WK-SQL-PTF-CD           OF  WK-MSG-1-12
      *---------- 基準日
           MOVE  WK-KAISI-KJN-YMD
             TO  H-KJN-YMD               OF  H-TKMZGZ00-S,
                 WK-SQL-KJN-YMD          OF  WK-MSG-1-12
           INITIALIZE  SQLSTMT12                                        @3212SEINO@@
           MOVE  SQL-SELECT-1-12          TO  SQLSTMT12                 @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
      D             H-RIYO-CMP-CD        OF  H-TKMZGZ00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
      D             H-FUND-CD            OF  H-TKMZGZ00-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZGZ00-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日=["
      D             H-KJN-YMD            OF  H-TKMZGZ00-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT12=[" SQLSTMT12 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":FLG-TKMZGZ00-CR-OPEN=["                @3212SEINO@@
      D                          FLG-TKMZGZ00-CR-OPEN"]"                @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZGZ00-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  元本残高CURSOR PREPARE
             EXEC  SQL
               PREPARE  S8  FROM  :SQLSTMT12                            @3212SEINO@@
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":元本残高"
      D             "CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-054
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-12         DELIMITED  BY  SIZE
                 INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 元本残高CURSOR PREPARE END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZGZ00-PRE-EXT.
           EXIT.
      ******************************************************************
      *    元本残高CURSOR OPEN
      ******************************************************************
       TKMZGZ00-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 元本残高CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *--- PREPARE、DECLARE実行済の場合、PREPARE、DECLAREをスキップする @3212SEINO@@
           IF  FLG-TKMZGZ00-CR-OPEN = CNS-OFF                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZGZ00_CUR  CURSOR  FOR  S8
             END-EXEC
             CONTINUE                                                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZGZ00_CUR
               USING :H-TKMZGZ00-S.H-RIYO-CMP-CD,
                     :H-TKMZGZ00-S.H-FUND-CD,
                     :H-TKMZGZ00-S.H-PTF-CD,
                     :H-TKMZGZ00-S.H-KJN-YMD
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON                TO  FLG-TKMZGZ00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":TKMZGZ00 CURSOR OPEN FLAG=["
      D             FLG-TKMZGZ00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
             MOVE  CNS-PGM-ID
               TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
      *----------  ポジション
             MOVE  CNS-POS-055
               TO  ERR-POS               OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
             MOVE  CNS-RTN-900
               TO  RTN-CD                OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
             MOVE  SQLCODE
               TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1
               TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-12         DELIMITED  BY  SIZE
               INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 元本残高CURSOR OPEN END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZGZ00-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    元本残高CURSOR FETCH
      ******************************************************************
       TKMZGZ00-FETCH-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 元本残高CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           INITIALIZE  H-TKMZGZ00
           EXEC SQL
             FETCH TKMZGZ00_CUR
             INTO  :H-TKMZGZ00
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CURSOR FETCH  正常"
      *-----------------------------------------------------------------
      *----------  決算日断面区分
               MOVE  KSN-YMD-DMN-KBN     OF  H-TKMZGZ00
                 TO  KSN-YMD-DMN-KBN     OF  TKMZGZ00-PARM
      *----------  元本数量残高
               MOVE  GNP-SRYZN           OF  H-TKMZGZ00
                 TO  GNP-SRYZN           OF  TKMZGZ00-PARM
      *----------  元本簿価残高
               MOVE  GNP-BOKAZN          OF  H-TKMZGZ00
                 TO  GNP-BOKAZN          OF  TKMZGZ00-PARM
      *----------  総投入金額
               MOVE  SO-TN-KGK           OF  H-TKMZGZ00
                 TO  SO-TN-KGK           OF  TKMZGZ00-PARM
      *----------  初期設定金額
               MOVE  SHOKI-SET-KGK       OF  H-TKMZGZ00
                 TO  SHOKI-SET-KGK       OF  TKMZGZ00-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.開始時元本残高情報"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分 =["
      D             KSN-YMD-DMN-KBN     OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":元本数量残高   =["
      D             GNP-SRYZN           OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":元本簿価残高   =["
      D             GNP-BOKAZN          OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":総投入金額     =["
      D             SO-TN-KGK           OF  TKMZGZ00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":初期設定金額   =["
      D             SHOKI-SET-KGK       OF  TKMZGZ00-PARM"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
               INITIALIZE  TKMZGZ00-PARM OF  PARM-SMZJ2210-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.開始時元本残高情報=["
      D             TKMZGZ00-PARM        OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-056
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-900
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-12       DELIMITED  BY  SIZE
                 INTO  FREE-MSG         OF  PARM-SCZY1170-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":*** 元本残高CURSOR FETCH END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZGZ00-FETCH-EXT.
           EXIT.
      ******************************************************************
      *   元本残高CURSOR CLOSE
      ******************************************************************
      * TKMZGZ00-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":*** 元本残高CURSOR CLOSE START ***"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZGZ00_CUR
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"元本残高CUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":元本残高CURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF              TO  FLG-TKMZGZ00-CR-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZGZ00-CR-OPEN =["
      *D             FLG-TKMZGZ00-CR-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":元本残高CURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **----------  エラー検知プログラム名
      *       MOVE  CNS-PGM-ID
      *         TO  ERR-PGM-ID           OF  PARM-SCZY1170-ARG1
      **----------  ポジション
      *       MOVE  CNS-POS-057
      *         TO  ERR-POS              OF  PARM-SCZY1170-ARG1
      **----------  リターンコード
      *       MOVE  CNS-RTN-900
      *         TO  RTN-CD               OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコード
      *       MOVE  SQLCODE
      *         TO  DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1
      **----------  詳細リターンコードデコードフラグ
      *       MOVE  CNS-DETAIL-1
      *         TO  DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1
      **---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-12         DELIMITED  BY  SIZE
      *         INTO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ERR-PGM-ID                  =["
      *D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":ERR-POS                     =["
      *D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":RTN-CD                      =["
      *D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD               =["
      *D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":DETAIL-RTN-CD-FLG           =["
      *D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      *D    DISPLAY  CNS-PGM-ID":FREE-MSG                    =["
      *D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      **-----------------------------------------------------------------
      **----------  エラー処理
      *       PERFORM  ERR-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***元本残高CURSOR CLOSE END ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZGZ00-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    2)ワーク断面作成情報編集
      ******************************************************************
       DMN-JH-EDIT3-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク断面作成情報編集  START "
      D    DISPLAY  CNS-PGM-ID":ARG1.銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ARG1.基準日断面情報.基準日種類=["
      D             KJN-YMD-SHRU         OF  TKMZBW02-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク計上フラグ=["WK-KEIJYO-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク普通フラグ=["WK-NORMAL-FLG"]"
      *-----------------------------------------------------------------
             IF  KJN-YMD-SHRU  OF  TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-0
               OR  KJN-YMD-SHRU  OF TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-4
               OR  KJN-YMD-SHRU  OF TKMZBW02-PARM  =  CNS-KJN-YMD-SHRU-5
             THEN
               IF  WK-NORMAL-FLG                 =  CNS-X-1
               THEN
      *--------  計上_決算後
                 MOVE  CNS-X-0
                   TO  WK-KEIJYO-KSG   OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                 MOVE  CNS-X-1
                   TO  WK-NORMAL-NASI  OF  WK-DMN-SK-JH
      *--------  普通_決算前
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-MAE   OF  WK-DMN-SK-JH
      *--------  普通_決算後
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-ATO   OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                 MOVE  CNS-X-0
                   TO  WK-START-NASI   OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                 MOVE  CNS-X-0
                   TO  WK-START-MAE    OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                 MOVE  CNS-X-0
                   TO  WK-START-ATO    OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                 MOVE  CNS-X-0
                   TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
               ELSE
      *--------  計上_決算後
                 MOVE  CNS-X-0
                   TO  WK-KEIJYO-KSG   OF  WK-DMN-SK-JH
      *--------  普通_決算断面なし
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-NASI  OF  WK-DMN-SK-JH
      *--------  普通_決算前
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-MAE   OF  WK-DMN-SK-JH
      *--------  普通_決算後
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-ATO   OF  WK-DMN-SK-JH
      *--------  開始時_決算断面なし
                 MOVE  CNS-X-1
                   TO  WK-START-NASI   OF  WK-DMN-SK-JH
      *--------  開始時_決算前
                 MOVE  CNS-X-0
                   TO  WK-START-MAE    OF  WK-DMN-SK-JH
      *--------  開始時_決算後
                 MOVE  CNS-X-0
                   TO  WK-START-ATO    OF  WK-DMN-SK-JH
      *--------  基準日別更新区分
                 MOVE  CNS-X-0
                   TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
               END-IF
             ELSE
               IF  WK-NORMAL-FLG                 =  CNS-X-1
               THEN
      *----------  計上_決算後
                 MOVE  CNS-X-0
                   TO  WK-KEIJYO-KSG   OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-NASI  OF  WK-DMN-SK-JH
      *----------  普通_決算前
                 MOVE  CNS-X-1
                   TO  WK-NORMAL-MAE   OF  WK-DMN-SK-JH
      *----------  普通_決算後
                 MOVE  CNS-X-1
                   TO  WK-NORMAL-ATO   OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                 MOVE  CNS-X-0
                   TO  WK-START-NASI   OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                 MOVE  CNS-X-0
                   TO  WK-START-MAE    OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                 MOVE  CNS-X-0
                   TO  WK-START-ATO    OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                 MOVE  CNS-X-0
                   TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
               ELSE
      *----------  計上_決算後
                 MOVE  CNS-X-0
                   TO  WK-KEIJYO-KSG   OF  WK-DMN-SK-JH
      *----------  普通_決算断面なし
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-NASI  OF  WK-DMN-SK-JH
      *----------  普通_決算前
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-MAE   OF  WK-DMN-SK-JH
      *----------  普通_決算後
                 MOVE  CNS-X-0
                   TO  WK-NORMAL-ATO   OF  WK-DMN-SK-JH
      *----------  開始時_決算断面なし
                 MOVE  CNS-X-0
                   TO  WK-START-NASI   OF  WK-DMN-SK-JH
      *----------  開始時_決算前
                 MOVE  CNS-X-1
                   TO  WK-START-MAE    OF  WK-DMN-SK-JH
      *----------  開始時_決算後
                 MOVE  CNS-X-1
                   TO  WK-START-ATO    OF  WK-DMN-SK-JH
      *----------  基準日別更新区分
                 MOVE  CNS-X-0
                   TO  WK-KJB-KOUSIN-KBN OF  WK-DMN-SK-JH
               END-IF
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.計上_決算後=["
      D             WK-KEIJYO-KSG       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算断面なし=["
      D             WK-NORMAL-NASI      OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算前=["
      D             WK-NORMAL-MAE       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.普通_決算後=["
      D             WK-NORMAL-ATO       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク断面作成情報.開始時_決算断面なし=["
      D             WK-START-NASI       OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.開始時_決算前=["
      D             WK-START-MAE        OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.開始時_決算後=["
      D             WK-START-ATO        OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID":ワーク断面作成情報.基準日別更新区分=["
      D             WK-KJB-KOUSIN-KBN   OF  WK-DMN-SK-JH"]"
      D    DISPLAY  CNS-PGM-ID ":ワーク断面作成情報編集 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DMN-JH-EDIT3-EXT.
           EXIT.
      ******************************************************************
      *    3)ワーク元本残高更新編集
      ******************************************************************
       GNPZN-UD-EDIT-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク元本残高更新編集  START "
      D    DISPLAY  CNS-PGM-ID":①ワーク断面作成情報."
      D    "普通_決算断面なし=["
      D             WK-NORMAL-NASI      OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-NASI  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク残高異動計算データ(対象)
             MOVE  WK-TKMZBW06-NORMAL   TO  WK-TKMZBW06-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(対象)=["
      D             WK-TKMZBW06-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-10 編集要領
             PERFORM  EDIT-1-10-RTN
      *----------  ワーク元本残高計算データ(対象).決算日断面区分
             MOVE  CNS-X-0
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-3-RTN
      *----------  ワーク元本残高更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１
             MOVE  WK-TKMZBW13-TASYOU
               TO  WK-DATA-1            OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-GNPZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１=["
      D             WK-DATA-1           OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":②ワーク断面作成情報.普通_決算前=["
      D             WK-NORMAL-MAE       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-MAE  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク残高異動計算データ(対象)
             MOVE  WK-TKMZBW06-NORMAL   TO  WK-TKMZBW06-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(対象)=["
      D             WK-TKMZBW06-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-10 編集要領
             PERFORM  EDIT-1-10-RTN
      *----------  ワーク元本残高計算データ(対象).決算日断面区分
             MOVE  CNS-X-1
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-3-RTN
      *----------  ワーク元本残高更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１
             MOVE  WK-TKMZBW13-TASYOU
               TO  WK-DATA-1            OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-GNPZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１=["
      D             WK-DATA-1           OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":③ワーク断面作成情報.普通_決算後=["
      D             WK-NORMAL-ATO       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-NORMAL-ATO  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  ワーク残高異動計算データ(対象)
             MOVE  WK-TKMZBW06-NORMAL   TO  WK-TKMZBW06-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高異動計算データ(対象)=["
      D             WK-TKMZBW06-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  別紙1-10 編集要領
             PERFORM  EDIT-1-10-RTN
      *----------  ワーク元本残高計算データ(対象).決算日断面区分
             MOVE  CNS-X-2
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-3-RTN
      *----------  ワーク元本残高更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ２
             MOVE  WK-TKMZBW13-TASYOU
               TO  WK-DATA-2            OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-GNPZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ２=["
      D             WK-DATA-2           OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":④ワーク断面作成情報."
      D    "開始時_決算断面なし=["
      D             WK-START-NASI       OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-NASI  OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-9 編集要領
             PERFORM  EDIT-1-9-RTN
      *----------  ワーク元本残高計算データ(対象).決算日断面区分
             MOVE  CNS-X-0
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-3-RTN
      *----------  ワーク元本残高更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１
             MOVE  WK-TKMZBW13-TASYOU
               TO  WK-DATA-1            OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-GNPZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１=["
      D             WK-DATA-1           OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑤ワーク断面作成情報.開始時_決算前=["
      D             WK-START-MAE        OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-MAE   OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-9 編集要領
             PERFORM  EDIT-1-9-RTN
      *----------  ワーク元本残高計算データ(対象).決算日断面区分
             MOVE  CNS-X-1
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-3-RTN
      *----------  ワーク元本残高更新.データ１フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-1-FLG        OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１
             MOVE  WK-TKMZBW13-TASYOU
               TO  WK-DATA-1            OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ１有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-1-YUKOU-ZN-KBN
                                        OF  WK-GNPZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１=["
      D             WK-DATA-1           OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高更新.データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":⑥ワーク断面作成情報.開始時_決算後=["
      D             WK-START-ATO        OF  WK-DMN-SK-JH"]"
      *-----------------------------------------------------------------
           IF  WK-START-ATO   OF  WK-DMN-SK-JH  =  CNS-X-1
           THEN
      *----------  別紙1-9 編集要領
             PERFORM  EDIT-1-9-RTN
      *----------  ワーク元本残高計算データ(対象).決算日断面区分
             MOVE  CNS-X-2
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高計算データ(対象).決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
      *----------  ワーク有効残高フラグ編集
             PERFORM  EDIT-4-3-RTN
      *----------  ワーク元本残高更新.データ２フラグ
             MOVE  CNS-X-1
               TO  WK-DATA-2-FLG        OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ２
             MOVE  WK-TKMZBW13-TASYOU
               TO  WK-DATA-2            OF  WK-GNPZN-KOUSIN
      *----------  ワーク元本残高更新.データ２有効残高区分
             MOVE  WK-YUKOU-ZN-FLG
               TO  WK-DATA-2-YUKOU-ZN-KBN
                                        OF  WK-GNPZN-KOUSIN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ２=["
      D             WK-DATA-2           OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":ワーク元本残高更新.データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": ワーク元本残高更新編集  END "
      *-----------------------------------------------------------------
           CONTINUE.
       GNPZN-UD-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    4)元本残高計算データ更新
      ******************************************************************
       GNPZN-CALC-UD-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 元本残高計算データ更新  START "
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新."
      D    "データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-1-FLG  OF  WK-GNPZN-KOUSIN  =  CNS-X-1  AND
               WK-DATA-1-YUKOU-ZN-KBN   OF  WK-GNPZN-KOUSIN = CNS-X-1
           THEN
             MOVE  WK-DATA-1            OF  WK-GNPZN-KOUSIN
               TO  H-TKMZBW13-I
             MOVE  SK-LOGIN-CMP-CD
               OF  WK-DATA-1            OF  WK-GNPZN-KOUSIN
               TO  H-SK-LOGIN-CMP-CD    OF  H-TKMZBW13-I
             MOVE  UPD-LOGIN-CMP-CD
               OF  WK-DATA-1            OF  WK-GNPZN-KOUSIN
               TO  H-UPD-LOGIN-CMP-CD   OF  H-TKMZBW13-I
             MOVE  SYORI-YMD       OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SYORI-YMD     OF  WK-MSG-TKMZBW13
             MOVE  KIDOU-ID        OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-KIDOU-ID      OF  WK-MSG-TKMZBW13
             MOVE  RIYO-CMP-CD     OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-RIYO-CMP-CD   OF  WK-MSG-TKMZBW13
             MOVE  FUND-CD         OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-FUND-CD       OF  WK-MSG-TKMZBW13
             MOVE  PTF-CD          OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-PTF-CD        OF  WK-MSG-TKMZBW13
             MOVE  KJN-YMD         OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-KJN-YMD       OF  WK-MSG-TKMZBW13
             MOVE  KSN-YMD-DMN-KBN OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-KSN-YMD-DMN-KBN
                                        OF  WK-MSG-TKMZBW13
             MOVE  GNP-SRYZN       OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-GNP-SRYZN     OF  WK-MSG-TKMZBW13
             MOVE  GNP-BOKAZN      OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-GNP-BOKAZN    OF  WK-MSG-TKMZBW13
             MOVE  SO-TN-KGK       OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SO-TN-KGK     OF  WK-MSG-TKMZBW13
             MOVE  SHOKI-SET-KGK   OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SHOKI-SET-KGK OF  WK-MSG-TKMZBW13
             MOVE  SK-LOGIN-CMP-CD OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SK-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW13
             MOVE  UPD-LOGIN-CMP-CD  OF  WK-DATA-1  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-UPD-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW13
             MOVE  CNS-POS-058          TO  WK-ERR-POS
             MOVE  CNS-POS-059          TO  WK-ERR-POS1
             MOVE  CNS-POS-060          TO  WK-ERR-POS2
             PERFORM  TKMZBW13-INSERT-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新."
      D    "データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-2-FLG  OF  WK-GNPZN-KOUSIN  =  CNS-X-1  AND
               WK-DATA-2-YUKOU-ZN-KBN   OF  WK-GNPZN-KOUSIN = CNS-X-1
           THEN
             MOVE  WK-DATA-2            OF  WK-GNPZN-KOUSIN
               TO  H-TKMZBW13-I
             MOVE  SK-LOGIN-CMP-CD
               OF  WK-DATA-2            OF  WK-GNPZN-KOUSIN
               TO  H-SK-LOGIN-CMP-CD    OF  H-TKMZBW13-I
             MOVE  UPD-LOGIN-CMP-CD
               OF  WK-DATA-2            OF  WK-GNPZN-KOUSIN
               TO  H-UPD-LOGIN-CMP-CD   OF  H-TKMZBW13-I
             MOVE  SYORI-YMD       OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SYORI-YMD     OF  WK-MSG-TKMZBW13
             MOVE  KIDOU-ID        OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-KIDOU-ID      OF  WK-MSG-TKMZBW13
             MOVE  RIYO-CMP-CD     OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-RIYO-CMP-CD   OF  WK-MSG-TKMZBW13
             MOVE  FUND-CD         OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-FUND-CD       OF  WK-MSG-TKMZBW13
             MOVE  PTF-CD          OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-PTF-CD        OF  WK-MSG-TKMZBW13
             MOVE  KJN-YMD         OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-KJN-YMD       OF  WK-MSG-TKMZBW13
             MOVE  KSN-YMD-DMN-KBN OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-KSN-YMD-DMN-KBN
                                        OF  WK-MSG-TKMZBW13
             MOVE  GNP-SRYZN       OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-GNP-SRYZN     OF  WK-MSG-TKMZBW13
             MOVE  GNP-BOKAZN      OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-GNP-BOKAZN    OF  WK-MSG-TKMZBW13
             MOVE  SO-TN-KGK       OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SO-TN-KGK     OF  WK-MSG-TKMZBW13
             MOVE  SHOKI-SET-KGK   OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SHOKI-SET-KGK OF  WK-MSG-TKMZBW13
             MOVE  SK-LOGIN-CMP-CD OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-SK-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW13
             MOVE  UPD-LOGIN-CMP-CD  OF  WK-DATA-2  OF  WK-GNPZN-KOUSIN
               TO  WK-SQL-UPD-LOGIN-CMP-CD
                                        OF  WK-MSG-TKMZBW13
             MOVE  CNS-POS-061          TO  WK-ERR-POS
             MOVE  CNS-POS-062          TO  WK-ERR-POS1
             MOVE  CNS-POS-063          TO  WK-ERR-POS2
             PERFORM  TKMZBW13-INSERT-RTN
           ELSE
             CONTINUE
           END-IF
      *----------  ③ワーク元本残高更新.データ１有効残高区分＝'1'(有効)
      *----------  または ワーク元本残高更新.データ２有効残高区分＝'1'(有効)の場合、
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高履歴更新"
      D             ".データ１有効残高区分=["WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高履歴更新"
      D             ".データ２有効残高区分=["WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  WK-DATA-1-YUKOU-ZN-KBN   OF  WK-GNPZN-KOUSIN = CNS-X-1 OR
               WK-DATA-2-YUKOU-ZN-KBN   OF  WK-GNPZN-KOUSIN = CNS-X-1
           THEN
      *----------  ARG2.履歴作成フラグ
             MOVE  CNS-RIREKI-SAKUSEI-FLG-1
               TO  RIREKI-SAKUSEI-FLG   OF  PARM-SMZJ2210-ARG2
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.履歴作成フラグ=["
      D             RIREKI-SAKUSEI-FLG  OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID": 元本残高計算データ更新  END "
      *-----------------------------------------------------------------
           CONTINUE.
       GNPZN-CALC-UD-EXT.
           EXIT.
      ******************************************************************
      *    元本残高計算データにINSERTする
      ******************************************************************
       TKMZBW13-INSERT-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 元本残高計算データにINSERTする START ***"
      *-----------------------------------------------------------------
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日  =["
      D             H-SYORI-YMD          OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":起動ID  =["
      D             H-KIDOU-ID           OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             H-KJN-YMD            OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分  =["
      D             H-KSN-YMD-DMN-KBN    OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":元本数量残高=["
      D             H-GNP-SRYZN          OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":元本簿価残高=["
      D             H-GNP-BOKAZN         OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":総投入金額=["
      D             H-SO-TN-KGK          OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":初期設定金額=["
      D             H-SHOKI-SET-KGK      OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード=["
      D             H-SK-LOGIN-CMP-CD    OF  H-TKMZBW13-I"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード=["
      D             H-UPD-LOGIN-CMP-CD   OF  H-TKMZBW13-I"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMTIN03                                      @3212SEINO@@
      *----ＳＱＬ文
           MOVE  SQL-INSERT-TKMZBW13     TO  SQLSTMTIN03                @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMTIN03=["SQLSTMTIN03"]"            @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID": FLG-TKMZBW13-S12-INSERT=["             @3212SEINO@@
      D                           FLG-TKMZBW13-S12-INSERT"]"            @3212SEINO@@
      *-----------------------------------------------------------------
      *--- PREPARE実行済の場合、PREPAREをスキップする                   @3212SEINO@@
           IF  FLG-TKMZBW13-S12-INSERT = CNS-OFF                        @3212SEINO@@
           THEN                                                         @3212SEINO@@
      **** EXEC SQL                                                     @3212SEINO@@
      ****     PREPARE S8 FROM :SQLSTMT                                 @3212SEINO@@
      **** END-EXEC                                                     @3212SEINO@@
             EXEC SQL                                                   @3212SEINO@@
                 PREPARE S12 FROM :SQLSTMTIN03                          @3212SEINO@@
             END-EXEC                                                   @3212SEINO@@
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高計算データ"
      D             "PREPARE SQLCODE =["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高計算データ PREPARE  正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高計算データ PREPARE  異常"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID            OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS
                 TO  ERR-POS               OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-900
                 TO  RTN-CD                OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD         OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG     OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW13     DELIMITED  BY  SIZE
                 INTO  FREE-MSG            OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID           OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD               OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD        OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG    OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG             OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
             END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      **** EXEC SQL                                                     @3212SEINO@@
      ****     EXECUTE S8                                               @3212SEINO@@
      ****       USING :H-TKMZBW13-I                                    @3212SEINO@@
      **** END-EXEC                                                     @3212SEINO@@
           EXEC SQL                                                     @3212SEINO@@
               EXECUTE S12                                              @3212SEINO@@
                 USING :H-TKMZBW13-I                                    @3212SEINO@@
           END-EXEC                                                     @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高計算データ"
      D             " INSERT SQLCODE =["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               MOVE  CNS-ON             TO  FLG-TKMZBW13-S12-INSERT     @3212SEINO@@
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高計算データ INSERT  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW13-S12-INSERT =["
      D                         FLG-TKMZBW13-S12-INSERT"]"
      *-----------------------------------------------------------------
      *        CONTINUE                                                 @3212SEINO@@
             WHEN  CNS-SQL-UNIQUE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高計算データ INSERT 一意制約違反"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS1
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-300
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW13   DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
             WHEN OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":元本残高計算データ INSERT  異常"
      *-----------------------------------------------------------------
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID          OF  PARM-SCZY1170-ARG1
               MOVE  WK-ERR-POS2
                 TO  ERR-POS             OF  PARM-SCZY1170-ARG1
               MOVE  CNS-RTN-900
                 TO  RTN-CD              OF  PARM-SCZY1170-ARG1
               MOVE  SQLCODE
                 TO  DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1
               MOVE  CNS-DETAIL-1
                 TO  DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1
               STRING  CNS-SQL-MSG-INSERT,
                       WK-MSG-TKMZBW13   DELIMITED  BY  SIZE
                 INTO  FREE-MSG          OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** 元本残高計算データにINSERTする END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW13-INSERT-EXT.
           EXIT.
      ******************************************************************
      *    5）取引差分更新管理更新
      ******************************************************************
       TRHK-SABON-UD3-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 取引差分更新管理更新  START "
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ１フラグ=["
      D             WK-DATA-1-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新."
      D    "データ１有効残高区分=["
      D             WK-DATA-1-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新.データ２フラグ=["
      D             WK-DATA-2-FLG       OF  WK-GNPZN-KOUSIN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク元本残高更新."
      D    "データ２有効残高区分=["
      D             WK-DATA-2-YUKOU-ZN-KBN
      D                                 OF  WK-GNPZN-KOUSIN"]"
      *-----------------------------------------------------------------
           IF  (WK-DATA-1-FLG  OF  WK-GNPZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-1-YUKOU-ZN-KBN OF  WK-GNPZN-KOUSIN = CNS-X-1) OR
               (WK-DATA-2-FLG  OF  WK-GNPZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-2-YUKOU-ZN-KBN OF  WK-GNPZN-KOUSIN = CNS-X-1)
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  START "
      *-----------------------------------------------------------------
      *----------  機能区分
             MOVE  CNS-X-2
               TO  MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT
      *----------  更新データ区分
             MOVE  CNS-X-1
               TO  UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT
      *----------  OL/BT区分
             MOVE  CNS-BT
               TO  OL-BT-KBN            OF  PARM-SMZC9201-INOUT
      *----------  有効残高区分
             MOVE  CNS-YUKO-ZN-KBN-1
               TO  YUKO-ZN-KBN          OF  PARM-SMZC9201-ARG1
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  PARM-SMZC9201-ARG2
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  PARM-SMZC9201-ARG2
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  PARM-SMZC9201-ARG2
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  PARM-SMZC9201-ARG2
      *----------  銘柄コード
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  MEG-CD               OF  PARM-SMZC9201-ARG2
      *----------  資産負債・買建売建フラグ
             MOVE  TATE-FLG             OF  TKMZBW03-PARM
               TO  TATE-FLG             OF  PARM-SMZC9201-ARG2
      *----------  玉ID
             MOVE  GYOKU-ID             OF  TKMZBW03-PARM
               TO  GYOKU-ID             OF  PARM-SMZC9201-ARG2
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  PARM-SMZC9201-ARG2
      *----------  最終有効日
             MOVE  ZERO
               TO  LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG2
      *----------  基本会計ベースフラグ
             MOVE  KH-KAIKEI-BASE-FLG   OF  TKMZBW02-PARM
               TO  KIHON-KAIKEI-BASE-FLG
                                        OF  PARM-SMZC9201-ARG2
      *----------  取引属性データエリア
             MOVE  TORI-ZOKUSEI-AREA    OF  PARM-SMZJ2210-ARG1
               TO  TORI-ZOKUSEI-AREA    OF  PARM-SMZC9201-ARG1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             MENU-KINOU-KBN      OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":更新データ区分  =["
      D             UPD-DATA-KBN        OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分  =["
      D             OL-BT-KBN           OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":有効残高区分  =["
      D             YUKO-ZN-KBN         OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             RIYO-CMP-CD         OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             FUND-CD             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード  =["
      D             MEG-CD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ  =["
      D             TATE-FLG            OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":玉ID  =["
      D             GYOKU-ID            OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日  =["
      D             KJN-YMD             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終有効日  =["
      D             LAST-YUKO-YMD       OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ  =["
      D             KIHON-KAIKEI-BASE-FLG
      D                                 OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID ":取引属性データエリア         =["
      D             TORI-ZOKUSEI-AREA   OF  PARM-SMZC9201-ARG1"]"
      *-----------------------------------------------------------------
             CALL  "SMZC9201"           USING  PARM-SMZC9201-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC9201)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
               =  CNS-RTN-000
             THEN
               CONTINUE
             ELSE
      *----------  エラー
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-064
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-901
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  END "
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           IF  (WK-DATA-1-FLG  OF  WK-GNPZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-1-YUKOU-ZN-KBN OF  WK-GNPZN-KOUSIN = CNS-X-0) OR
               (WK-DATA-2-FLG  OF  WK-GNPZN-KOUSIN  =  CNS-X-1  AND
                WK-DATA-2-YUKOU-ZN-KBN OF  WK-GNPZN-KOUSIN = CNS-X-0)
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  START "
      *-----------------------------------------------------------------
      *----------  機能区分
             MOVE  CNS-X-2
               TO  MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT
      *----------  更新データ区分
             MOVE  CNS-X-1
               TO  UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT
      *----------  OL/BT区分
             MOVE  CNS-BT
               TO  OL-BT-KBN            OF  PARM-SMZC9201-INOUT
      *----------  有効残高区分
             MOVE  CNS-YUKO-ZN-KBN-0
               TO  YUKO-ZN-KBN          OF  PARM-SMZC9201-ARG1
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  PARM-SMZC9201-ARG2
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  PARM-SMZC9201-ARG2
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  PARM-SMZC9201-ARG2
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  PARM-SMZC9201-ARG2
      *----------  銘柄コード
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  MEG-CD               OF  PARM-SMZC9201-ARG2
      *----------  資産負債・買建売建フラグ
             MOVE  TATE-FLG             OF  TKMZBW03-PARM
               TO  TATE-FLG             OF  PARM-SMZC9201-ARG2
      *----------  玉ID
             MOVE  GYOKU-ID             OF  TKMZBW03-PARM
               TO  GYOKU-ID             OF  PARM-SMZC9201-ARG2
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  PARM-SMZC9201-ARG2
      *----------  最終有効日
             MOVE  KEIJOU-KIJUNBI       OF  WK-TKMZBW06-NORMAL
               TO  LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG2
      *----------  基本会計ベースフラグ
             MOVE  KH-KAIKEI-BASE-FLG   OF  TKMZBW02-PARM
               TO  KIHON-KAIKEI-BASE-FLG
                                        OF  PARM-SMZC9201-ARG2
      *----------  取引属性データエリア
             MOVE  TORI-ZOKUSEI-AREA    OF  PARM-SMZJ2210-ARG1
               TO  TORI-ZOKUSEI-AREA    OF  PARM-SMZC9201-ARG1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             MENU-KINOU-KBN       OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":更新データ区分  =["
      D             UPD-DATA-KBN         OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分  =["
      D             OL-BT-KBN            OF  PARM-SMZC9201-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":有効残高区分  =["
      D             YUKO-ZN-KBN          OF  PARM-SMZC9201-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード    =["
      D             RIYO-CMP-CD          OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード    =["
      D             FUND-CD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD               OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD           OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード  =["
      D             MEG-CD               OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ  =["
      D             TATE-FLG             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":玉ID  =["
      D             GYOKU-ID             OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日  =["
      D             KJN-YMD              OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終有効日  =["
      D             LAST-YUKO-YMD        OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ  =["
      D             KIHON-KAIKEI-BASE-FLG
      D                                  OF  PARM-SMZC9201-ARG2"]"
      D    DISPLAY  CNS-PGM-ID ":取引属性データエリア         =["
      D             TORI-ZOKUSEI-AREA   OF  PARM-SMZC9201-ARG1"]"
      *-----------------------------------------------------------------
             CALL  "SMZC9201"           USING  PARM-SMZC9201-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER             OF  PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZC9201)=["
      D             RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
               =  CNS-RTN-000
             THEN
               CONTINUE
             ELSE
      *----------  エラー
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *----------  エラー検知プログラム名
               MOVE  CNS-PGM-ID
                 TO  ERR-PGM-ID         OF  PARM-SCZY1170-ARG1
      *----------  ポジション
               MOVE  CNS-POS-065
                 TO  ERR-POS            OF  PARM-SCZY1170-ARG1
      *----------  リターンコード
               MOVE  CNS-RTN-901
                 TO  RTN-CD             OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコード
               MOVE  RTN-CD OF PARM-RTNPKG (COUNTER OF PARM-RTNPKG)
                 TO  DETAIL-RTN-CD      OF  PARM-SCZY1170-ARG1
      *----------  詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0
                 TO  DETAIL-RTN-CD-FLG  OF  PARM-SCZY1170-ARG1
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  FREE-MSG           OF  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション             =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード         =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード     =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ       =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      *-----------------------------------------------------------------
      *----------  エラー処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ": ・【SMZC9201】取引差分更新管理更新用ルーチン  END "
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID": 取引差分更新管理更新  END "
      *-----------------------------------------------------------------
           CONTINUE.
       TRHK-SABON-UD3-EXT.
           EXIT.
      ******************************************************************
      *    別紙1-3 編集
      ******************************************************************
       EDIT-1-3-RTN           SECTION.
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  別紙1-3 編集  ****"
      *-----------------------------------------------------------------
      *----------  処理実行日
             MOVE  SYORI-YMD            OF  TKMZBW02-PARM
               TO  SYORI-YMD            OF  WK-TKMZBW11-TASYOU
      *----------  起動ID
             MOVE  KIDOU-ID             OF  TKMZBW02-PARM
               TO  KIDOU-ID             OF  WK-TKMZBW11-TASYOU
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  WK-TKMZBW11-TASYOU
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  WK-TKMZBW11-TASYOU
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  WK-TKMZBW11-TASYOU
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  WK-TKMZBW11-TASYOU
      *----------  銘柄コード
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  MEG-CD               OF  WK-TKMZBW11-TASYOU
      *----------  資産負債・買建売建フラグ
             MOVE  TATE-FLG             OF  TKMZBW03-PARM
               TO  TATE-FLG             OF  WK-TKMZBW11-TASYOU
      *----------  玉ＩＤ
             MOVE  GYOKU-ID             OF  TKMZBW03-PARM
               TO  GYOKU-ID             OF  WK-TKMZBW11-TASYOU
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  WK-TKMZBW11-TASYOU
      *----------  決算日断面区分
             MOVE  KSN-YMD-DMN-KBN      OF  TKMZZR00-PARM
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨コード
             MOVE  SIJO-TUKA-CD         OF  TKMZBW03-PARM
               TO  SIJO-TUKA-CD         OF  WK-TKMZBW11-TASYOU
      *----------  数量残高
             MOVE  SRYZN                OF  TKMZZR00-PARM
               TO  SRYZN                OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨簿価残高
             MOVE  SJTK-BOKAZN          OF  TKMZZR00-PARM
               TO  SJTK-BOKAZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨簿価残高
             MOVE  UYTK-BOKAZN          OF  TKMZZR00-PARM
               TO  UYTK-BOKAZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨簿価単価
             MOVE  SJTK-BOKA-TNK        OF  TKMZZR00-PARM
               TO  SJTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨簿価単価
             MOVE  UYTK-BOKA-TNK        OF  TKMZZR00-PARM
               TO  UYTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU
      *----------  簿価為替レート
             MOVE  BOKA-KWS             OF  TKMZZR00-PARM
               TO  BOKA-KWS             OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨前払金残高
             MOVE  SJTK-PPAYZN          OF  TKMZZR00-PARM
               TO  SJTK-PPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨前払金残高
             MOVE  UYTK-PPAYZN          OF  TKMZZR00-PARM
               TO  UYTK-PPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨前受金残高
             MOVE  SJTK-ARECZN          OF  TKMZZR00-PARM
               TO  SJTK-ARECZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨前受金残高
             MOVE  UYTK-ARECZN          OF  TKMZZR00-PARM
               TO  UYTK-ARECZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨仮払金残高
             MOVE  SJTK-SPAYZN          OF  TKMZZR00-PARM
               TO  SJTK-SPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨仮払金残高
             MOVE  UYTK-SPAYZN          OF  TKMZZR00-PARM
               TO  UYTK-SPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨払出単価
             MOVE  SJTK-H-TNK           OF  TKMZZR00-PARM
               TO  SJTK-H-TNK           OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨払出単価
             MOVE  UYTK-H-TNK           OF  TKMZZR00-PARM
               TO  UYTK-H-TNK           OF  WK-TKMZBW11-TASYOU
      *----------  同一コスト継続フラグ
             MOVE  SAME-COST-KZK-FLG    OF  TKMZZR00-PARM
               TO  SAME-COST-KZK-FLG    OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨経過利息
             IF  MEG-CD-SHRU2  OF  TKMZBW03-PARM  =  CNS-MEG-CD-SHRU2-2
                 AND  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 AND  SJTK-KEKA-RSK  OF  KJN-YMD-KEKA-RSK-DATA
                      NOT =  CNS-999999999999-999999
             THEN
               MOVE  SJTK-KEKA-RSK      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  SJTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  CNS-999999999999-999999
                 TO  SJTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  運用通貨経過利息
             IF  MEG-CD-SHRU2  OF  TKMZBW03-PARM  =  CNS-MEG-CD-SHRU2-2
                 AND  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 AND  UYTK-KEKA-RSK  OF  KJN-YMD-KEKA-RSK-DATA
                      NOT =  CNS-999999999999-999999
             THEN
               MOVE  UYTK-KEKA-RSK      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  UYTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  CNS-999999999999-999999
                 TO  UYTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  市場通貨未収収益
             EVALUATE  MEG-CD-SHRU2     OF  TKMZBW03-PARM
               WHEN  CNS-MEG-CD-SHRU2-1
                 MOVE  WK-SJTK-MS-SHEKI
                   TO  SJTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
               WHEN  CNS-MEG-CD-SHRU2-3
                 IF  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 THEN
                   MOVE  SJTK-MS-SHEKI  OF  KJN-YMD-KEKA-RSK-DATA
                     TO  SJTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 ELSE
                   MOVE  CNS-999999999999999-999
                     TO  SJTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 END-IF
               WHEN  CNS-MEG-CD-SHRU2-2
                 IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                     AND  SJTK-KEKA-RSK OF  KJN-YMD-KEKA-RSK-DATA
                          NOT =  CNS-999999999999-999999
                 THEN
                   COMPUTE  SJTK-MS-SHEKI OF  WK-TKMZBW11-TASYOU
                     =  SJTK-KEKA-RSK   OF  KJN-YMD-KEKA-RSK-DATA
                        - SJTK-PPAYZN   OF  WK-TKMZBW11-TASYOU
                 ELSE
                   MOVE  CNS-999999999999999-999
                     TO  SJTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 END-IF
               WHEN  OTHER
                 MOVE  CNS-999999999999999-999
                   TO  SJTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
             END-EVALUATE
      *----------  運用通貨未収収益
             EVALUATE  MEG-CD-SHRU2     OF  TKMZBW03-PARM
               WHEN  CNS-MEG-CD-SHRU2-1
                 MOVE  WK-UYTK-MS-SHEKI
                   TO  UYTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
               WHEN  CNS-MEG-CD-SHRU2-3
                 IF  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 THEN
                   MOVE  UYTK-MS-SHEKI  OF  KJN-YMD-KEKA-RSK-DATA
                     TO  UYTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 ELSE
                   MOVE  CNS-999999999999999-999
                     TO  UYTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 END-IF
               WHEN  OTHER
                 MOVE  CNS-999999999999999-999
                   TO  UYTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
             END-EVALUATE
      *----------  市場通貨源泉税
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-SJTK-GENSEN-TAX
                 TO  SJTK-GENSEN-TAX    OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  SJTK-GENSEN-TAX  OF  KJN-YMD-KEKA-RSK-DATA
                   TO  SJTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-999999999999999-999
                   TO  SJTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  運用通貨源泉税
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-UYTK-GENSEN-TAX
                 TO  UYTK-GENSEN-TAX    OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  UYTK-GENSEN-TAX  OF  KJN-YMD-KEKA-RSK-DATA
                   TO  UYTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-999999999999999-999
                   TO  UYTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  評価為替レート
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-HYK-KWS
                 TO  HYK-KWS            OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  HYK-KWS          OF  KJN-YMD-KEKA-RSK-DATA
                   TO  HYK-KWS          OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-99999999-9999999999
                   TO  HYK-KWS          OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  源泉税評価為替レート
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-GENS-TAX-HYK-KWS
                 TO  GENS-TAX-HYK-KWS   OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  GENS-TAX-HYK-KWS OF  KJN-YMD-KEKA-RSK-DATA
                   TO  GENS-TAX-HYK-KWS OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-99999999-9999999999
                   TO  GENS-TAX-HYK-KWS OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  ファクター・連動係数
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-2
             THEN
               MOVE  FACTOR-RENDOU-KESU OF  KJN-YMD-KEKA-RSK-DATA
                 TO  FACTOR-RENDOU-KESU OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  ZERO
                 TO  FACTOR-RENDOU-KESU OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  市場通貨未収収益計上・戻入額
             MOVE  SJTK-MSSE-KJMIG      OF  TKMZZR00-PARM
               TO  SJTK-MSSE-KJMIG      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨未収収益計上・戻入額
             MOVE  UYTK-MSSE-KJMIG      OF  TKMZZR00-PARM
               TO  UYTK-MSSE-KJMIG      OF  WK-TKMZBW11-TASYOU
      *----------  数量残高（利付）
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-RIT-SRY
                 TO  SRYZN-RIT          OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  SRYZN-RIT          OF  TKMZZR00-PARM
                 TO  SRYZN-RIT          OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  建玉単価
             MOVE  TGYOKU-TNK           OF  TKMZZR00-PARM
               TO  TGYOKU-TNK           OF  WK-TKMZBW11-TASYOU
      *----------  建玉為替レート
             MOVE  TGYOKU-KWS-RATE      OF  TKMZZR00-PARM
               TO  TGYOKU-KWS-RATE      OF  WK-TKMZBW11-TASYOU
      *----------  建玉ブローカー
             MOVE  TGYOKU-BRK           OF  TKMZZR00-PARM
               TO  TGYOKU-BRK           OF  WK-TKMZBW11-TASYOU
      *----------  建玉約定日
             MOVE  TGYOKU-YKJ-YMD       OF  TKMZZR00-PARM
               TO  TGYOKU-YKJ-YMD       OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉約定金額残
             MOVE  SJTK-TG-YJKNZN       OF  TKMZZR00-PARM
               TO  SJTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉約定金額残
             MOVE  UYTK-TG-YJKNZN       OF  TKMZZR00-PARM
               TO  UYTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉手数料残
             MOVE  SJTK-TG-TSRZN        OF  TKMZZR00-PARM
               TO  SJTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉手数料残
             MOVE  UYTK-TG-TSRZN        OF  TKMZZR00-PARM
               TO  UYTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉消費税残
             MOVE  SJTK-TG-S-TAXZN      OF  TKMZZR00-PARM
               TO  SJTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉消費税残
             MOVE  UYTK-TG-S-TAXZN      OF  TKMZZR00-PARM
               TO  UYTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉その他費用残
             MOVE  SJTK-TG-ELS-HIYOZN   OF  TKMZZR00-PARM
               TO  SJTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉その他費用残
             MOVE  UYTK-TG-ELS-HIYOZN   OF  TKMZZR00-PARM
               TO  UYTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉精算金額残
             MOVE  SJTK-TG-SSKGZN       OF  TKMZZR00-PARM
               TO  SJTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉精算金額残
             MOVE  UYTK-TG-SSKGZN       OF  TKMZZR00-PARM
               TO  UYTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU
      *----------  ＯＰ資産負債・買建売建フラグ
             MOVE  OP-TATE-FLG          OF  TKMZZR00-PARM
               TO  OP-TATE-FLG          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨源泉税還付予定額残高
             MOVE  SJTK-GSZKP-YTZN      OF  TKMZZR00-PARM
               TO  SJTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨源泉税還付予定額残高
             MOVE  UYTK-GSZKP-YTZN      OF  TKMZZR00-PARM
               TO  UYTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU
      *----------  決済通貨源泉税還付予定額残高
             MOVE  KSTK-GSZKP-YTZN      OF  TKMZZR00-PARM
               TO  KSTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨ノンカバー未収金残高
             MOVE  SJTK-NOCV-MSKZN      OF  TKMZZR00-PARM
               TO  SJTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨ノンカバー未収金残高
             MOVE  UYTK-NOCV-MSKZN      OF  TKMZZR00-PARM
               TO  UYTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨ノンカバー未払金残高
             MOVE  SJTK-NOCV-MBKZN      OF  TKMZZR00-PARM
               TO  SJTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨ノンカバー未払金残高
             MOVE  UYTK-NOCV-MBKZN      OF  TKMZZR00-PARM
               TO  UYTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU
      *----------  短期スタート・エンド経過利息
             MOVE  SHORT-STEN-KEKA-RSK  OF  TKMZZR00-PARM
               TO  SHORT-STEN-KEKA-RSK  OF  WK-TKMZBW11-TASYOU
      *----------  短期スタート日
             MOVE  SHORT-START-YMD      OF  TKMZZR00-PARM
               TO  SHORT-START-YMD      OF  WK-TKMZBW11-TASYOU
      *----------  短期エンド日
             MOVE  SHORT-END-YMD        OF  TKMZZR00-PARM
               TO  SHORT-END-YMD        OF  WK-TKMZBW11-TASYOU
      *----------  基本会計ベースフラグ
             MOVE  KH-KAIKEI-BASE-FLG   OF  TKMZBW02-PARM
               TO  KH-KAIKEI-BASE-FLG   OF  WK-TKMZBW11-TASYOU
      *----------  投資対象国コード
             MOVE  TSTSK-CD             OF  TKMZZR00-PARM
               TO  TSTSK-CD             OF  WK-TKMZBW11-TASYOU
      *----------  発行国コード
             MOVE  HAKO-CD              OF  TKMZZR00-PARM
               TO  HAKO-CD              OF  WK-TKMZBW11-TASYOU
      *----------  数量単位
             MOVE  SAIKS-SURYO-TANI     OF  PARM-SMZJ2210-ARG1
               TO  SURYO-TANI           OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨未払費用残
             MOVE  SJTK-MBHYZN          OF  TKMZZR00-PARM
               TO  SJTK-MBHYZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨未払費用残
             MOVE  UYTK-MBHYZN          OF  TKMZZR00-PARM
               TO  UYTK-MBHYZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨未払消費税残
             MOVE  SJTK-MB-S-TAXZN      OF  TKMZZR00-PARM
               TO  SJTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨未払消費税残
             MOVE  UYTK-MB-S-TAXZN      OF  TKMZZR00-PARM
               TO  UYTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨移管評価損益残
             MOVE  SJTK-IK-HKSEZN       OF  TKMZZR00-PARM
               TO  SJTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨移管評価損益残
             MOVE  UYTK-IK-HKSEZN       OF  TKMZZR00-PARM
               TO  UYTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨移管未収収益
             MOVE  SJTK-IK-MSSHEKI      OF  TKMZZR00-PARM
               TO  SJTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨移管未収収益
             MOVE  UYTK-IK-MSSHEKI      OF  TKMZZR00-PARM
               TO  UYTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨移管前払金評価損益残
             MOVE  UYTK-IK-PPHKZN       OF  TKMZZR00-PARM
               TO  UYTK-IK-PPHKZN       OF  WK-TKMZBW11-TASYOU
      *----------  削除区分
             MOVE  SPACE
               TO  SAKUJO-KBN           OF  WK-TKMZBW11-TASYOU
      *----------  作成ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  SK-LOGIN-CMP-CD      OF  WK-TKMZBW11-TASYOU
      *----------  作成プログラムＩＤ
             MOVE  SPACE
               TO  SK-PGMID             OF  WK-TKMZBW11-TASYOU
      *----------  更新ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  UPD-LOGIN-CMP-CD     OF  WK-TKMZBW11-TASYOU
      *----------  更新プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  UPD-PGMID            OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).処理実行日=["
      D            SYORI-YMD            OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).起動ID=["
      D            KIDOU-ID             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).利用会社コード=["
      D            RIYO-CMP-CD          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).ファンドコード=["
      D            FUND-CD              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).ポートフォリオコード=["
      D            PTF-CD               OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).証券種別コード=["
      D            SEC-SBT-CD           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).銘柄コード=["
      D            MEG-CD               OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).資産負債・買建売建フラグ=["
      D            TATE-FLG             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).玉ＩＤ=["
      D            GYOKU-ID             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).基準日=["
      D            KJN-YMD              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).決算日断面区分=["
      D            KSN-YMD-DMN-KBN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨コード=["
      D            SIJO-TUKA-CD         OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量残高=["
      D            SRYZN                OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨簿価残高=["
      D            SJTK-BOKAZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨簿価残高=["
      D            UYTK-BOKAZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨簿価単価=["
      D            SJTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨簿価単価=["
      D            UYTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).簿価為替レート=["
      D            BOKA-KWS             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨前払金残高=["
      D            SJTK-PPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨前払金残高=["
      D            UYTK-PPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨前受金残高=["
      D            SJTK-ARECZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨前受金残高=["
      D            UYTK-ARECZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨仮払金残高=["
      D            SJTK-SPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨仮払金残高=["
      D            UYTK-SPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨払出単価=["
      D            SJTK-H-TNK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨払出単価=["
      D            UYTK-H-TNK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).同一コスト継続フラグ=["
      D            SAME-COST-KZK-FLG    OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨経過利息=["
      D            SJTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨経過利息=["
      D            UYTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未収収益=["
      D            SJTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未収収益=["
      D            UYTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨源泉税=["
      D            SJTK-GENSEN-TAX      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨源泉税=["
      D            UYTK-GENSEN-TAX      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).評価為替レート=["
      D            HYK-KWS              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).源泉税評価為替レート=["
      D            GENS-TAX-HYK-KWS     OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).ファクター・連動係数=["
      D            FACTOR-RENDOU-KESU   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未収収益計上・"
      D    "戻入額=["SJTK-MSSE-KJMIG    OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未収収益計上・"
      D    "戻入額=["UYTK-MSSE-KJMIG    OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量残高（利付）=["
      D            SRYZN-RIT            OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉単価=["
      D            TGYOKU-TNK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉為替レート=["
      D            TGYOKU-KWS-RATE      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉ブローカー=["
      D            TGYOKU-BRK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉約定日=["
      D            TGYOKU-YKJ-YMD       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉約定金額残=["
      D            SJTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉約定金額残=["
      D            UYTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉手数料残=["
      D            SJTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉手数料残=["
      D            UYTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉消費税残=["
      D            SJTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉消費税残=["
      D            UYTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉その他費用残=["
      D            SJTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉その他費用残=["
      D            UYTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉精算金額残=["
      D            SJTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉精算金額残=["
      D            UYTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "ＯＰ資産負債・買建売建フラグ=["
      D            OP-TATE-FLG          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨源泉税還付予定額残高=["
      D            SJTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨源泉税還付予定額残高=["
      D            UYTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "決済通貨源泉税還付予定額残高=["
      D            KSTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨ノンカバー未収金残高=["
      D            SJTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨ノンカバー未収金残高=["
      D            UYTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨ノンカバー未払金残高=["
      D            SJTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨ノンカバー未払金残高=["
      D            UYTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "短期スタート・エンド経過利息=["
      D            SHORT-STEN-KEKA-RSK  OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).短期スタート日=["
      D            SHORT-START-YMD      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).短期エンド日=["
      D            SHORT-END-YMD        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).基本会計ベースフラグ=["
      D            KH-KAIKEI-BASE-FLG   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).投資対象国コード=["
      D            TSTSK-CD             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).発行国コード=["
      D            HAKO-CD              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量単位=["
      D            SURYO-TANI           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未払費用残=["
      D            SJTK-MBHYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未払費用残=["
      D            UYTK-MBHYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未払消費税残=["
      D            SJTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未払消費税残=["
      D            UYTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨移管評価損益残=["
      D            SJTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨移管評価損益残=["
      D            UYTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨移管未収収益=["
      D            SJTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨移管未収収益=["
      D            UYTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨移管前払金評価損益残=["
      D            UYTK-IK-PPHKZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).削除区分=["
      D            SAKUJO-KBN           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).作成日時=["
      D            SK-DATE              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "作成ログインユーザ会社コード=["
      D            SK-LOGIN-CMP-CD      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).作成ユーザＩＤ=["
      D            SK-SID               OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).作成プログラムＩＤ=["
      D            SK-PGMID             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).更新日時=["
      D            UPD-DATE             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "更新ログインユーザ会社コード=["
      D            UPD-LOGIN-CMP-CD     OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).更新ユーザＩＤ=["
      D            UPD-SID              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).更新プログラムＩＤ=["
      D            UPD-PGMID            OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-1-3-EXT.
           EXIT.
      ******************************************************************
      *    別紙1-5 編集
      ******************************************************************
       EDIT-1-5-RTN           SECTION.
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  別紙1-5 編集  ****"
      *-----------------------------------------------------------------
      *----------  処理実行日
             MOVE  SYORI-YMD            OF  TKMZBW02-PARM
               TO  SYORI-YMD            OF  WK-TKMZBW11-TASYOU
      *----------  起動ID
             MOVE  KIDOU-ID             OF  TKMZBW02-PARM
               TO  KIDOU-ID             OF  WK-TKMZBW11-TASYOU
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  WK-TKMZBW11-TASYOU
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  WK-TKMZBW11-TASYOU
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  WK-TKMZBW11-TASYOU
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  WK-TKMZBW11-TASYOU
      *----------  銘柄コード
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  MEG-CD               OF  WK-TKMZBW11-TASYOU
      *----------  資産負債・買建売建フラグ
             MOVE  TATE-FLG             OF  TKMZBW03-PARM
               TO  TATE-FLG             OF  WK-TKMZBW11-TASYOU
      *----------  玉ＩＤ
             MOVE  GYOKU-ID             OF  TKMZBW03-PARM
               TO  GYOKU-ID             OF  WK-TKMZBW11-TASYOU
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  WK-TKMZBW11-TASYOU
      *----------  決算日断面区分 編集しない
      *----------  市場通貨コード
             MOVE  SIJO-TUKA-CD         OF  TKMZBW03-PARM
               TO  SIJO-TUKA-CD         OF  WK-TKMZBW11-TASYOU
      *----------  数量残高
             MOVE  IDOG-SRYZN           OF  WK-TKMZBW06-TASYOU
               TO  SRYZN                OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨簿価残高
             MOVE  SJTK-IDOG-BOKAZN     OF  WK-TKMZBW06-TASYOU
               TO  SJTK-BOKAZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨簿価残高
             MOVE  UYTK-IDOG-BOKAZN     OF  WK-TKMZBW06-TASYOU
               TO  UYTK-BOKAZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨簿価単価
             MOVE  SJTK-BOKA-TNK        OF  WK-TKMZBW06-TASYOU
               TO  SJTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨簿価単価
             MOVE  UYTK-BOKA-TNK        OF  WK-TKMZBW06-TASYOU
               TO  UYTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU
      *----------  簿価為替レート
             MOVE  BOKA-KWS             OF  WK-TKMZBW06-TASYOU
               TO  BOKA-KWS             OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨前払金残高
             MOVE  SJTK-IDOG-PPAYZN     OF  WK-TKMZBW06-TASYOU
               TO  SJTK-PPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨前払金残高
             MOVE  UYTK-IDOG-PPAYZN     OF  WK-TKMZBW06-TASYOU
               TO  UYTK-PPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨前受金残高
             MOVE  SJTK-IDOG-ARECZN     OF  WK-TKMZBW06-TASYOU
               TO  SJTK-ARECZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨前受金残高
             MOVE  UYTK-IDOG-ARECZN     OF  WK-TKMZBW06-TASYOU
               TO  UYTK-ARECZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨仮払金残高
             MOVE  SJTK-IDOG-SPAYZN     OF  WK-TKMZBW06-TASYOU
               TO  SJTK-SPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨仮払金残高
             MOVE  UYTK-IDOG-SPAYZN     OF  WK-TKMZBW06-TASYOU
               TO  UYTK-SPAYZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨払出単価
             MOVE  SJTK-H-TNK           OF  WK-TKMZBW06-TASYOU
               TO  SJTK-H-TNK           OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨払出単価
             MOVE  UYTK-H-TNK           OF  WK-TKMZBW06-TASYOU
               TO  UYTK-H-TNK           OF  WK-TKMZBW11-TASYOU
      *----------  同一コスト継続フラグ
             MOVE  WK-SAME-COST-KZK-FLG
               TO  SAME-COST-KZK-FLG    OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨経過利息
             IF  MEG-CD-SHRU2  OF  TKMZBW03-PARM  =  CNS-MEG-CD-SHRU2-2
                 AND  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 AND  SJTK-KEKA-RSK  OF  KJN-YMD-KEKA-RSK-DATA
                      NOT =  CNS-999999999999-999999
             THEN
               MOVE  SJTK-KEKA-RSK      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  SJTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  CNS-999999999999-999999
                 TO  SJTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  運用通貨経過利息
             IF  MEG-CD-SHRU2  OF  TKMZBW03-PARM  =  CNS-MEG-CD-SHRU2-2
                 AND  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 AND  UYTK-KEKA-RSK  OF  KJN-YMD-KEKA-RSK-DATA
                      NOT =  CNS-999999999999-999999
             THEN
               MOVE  UYTK-KEKA-RSK      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  UYTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  CNS-999999999999-999999
                 TO  UYTK-KEKA-RSK      OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  市場通貨未収収益
             EVALUATE  MEG-CD-SHRU2     OF  TKMZBW03-PARM
               WHEN  CNS-MEG-CD-SHRU2-1
                 MOVE  WK-SJTK-MS-SHEKI
                   TO  SJTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
               WHEN  CNS-MEG-CD-SHRU2-3
                 IF  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 THEN
                   MOVE  SJTK-MS-SHEKI  OF  KJN-YMD-KEKA-RSK-DATA
                     TO  SJTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 ELSE
                   MOVE  CNS-999999999999999-999
                     TO  SJTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 END-IF
               WHEN  CNS-MEG-CD-SHRU2-2
                 IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                     AND  SJTK-KEKA-RSK OF  KJN-YMD-KEKA-RSK-DATA
                          NOT =  CNS-999999999999-999999
                 THEN
                   COMPUTE  SJTK-MS-SHEKI OF  WK-TKMZBW11-TASYOU
                     =  SJTK-KEKA-RSK   OF  KJN-YMD-KEKA-RSK-DATA
                        - SJTK-PPAYZN   OF  WK-TKMZBW11-TASYOU
                 ELSE
                   MOVE  CNS-999999999999999-999
                     TO  SJTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 END-IF
               WHEN  OTHER
                 MOVE  CNS-999999999999999-999
                   TO  SJTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
             END-EVALUATE
      *----------  運用通貨未収収益
             EVALUATE  MEG-CD-SHRU2     OF  TKMZBW03-PARM
               WHEN  CNS-MEG-CD-SHRU2-1
                 MOVE  WK-UYTK-MS-SHEKI
                   TO  UYTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
               WHEN  CNS-MEG-CD-SHRU2-3
                 IF  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                 THEN
                   MOVE  UYTK-MS-SHEKI  OF  KJN-YMD-KEKA-RSK-DATA
                     TO  UYTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 ELSE
                   MOVE  CNS-999999999999999-999
                     TO  UYTK-MS-SHEKI  OF  WK-TKMZBW11-TASYOU
                 END-IF
               WHEN  OTHER
                 MOVE  CNS-999999999999999-999
                   TO  UYTK-MS-SHEKI    OF  WK-TKMZBW11-TASYOU
             END-EVALUATE
      *----------  市場通貨源泉税
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-SJTK-GENSEN-TAX
                 TO  SJTK-GENSEN-TAX    OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  SJTK-GENSEN-TAX  OF  KJN-YMD-KEKA-RSK-DATA
                   TO  SJTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-999999999999999-999
                   TO  SJTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  運用通貨源泉税
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-UYTK-GENSEN-TAX
                 TO  UYTK-GENSEN-TAX    OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  UYTK-GENSEN-TAX  OF  KJN-YMD-KEKA-RSK-DATA
                   TO  UYTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-999999999999999-999
                   TO  UYTK-GENSEN-TAX  OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  評価為替レート
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-HYK-KWS
                 TO  HYK-KWS            OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  HYK-KWS          OF  KJN-YMD-KEKA-RSK-DATA
                   TO  HYK-KWS          OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-99999999-9999999999
                   TO  HYK-KWS          OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  源泉税評価為替レート
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-GENS-TAX-HYK-KWS
                 TO  GENS-TAX-HYK-KWS   OF  WK-TKMZBW11-TASYOU
             ELSE
               IF  KEISAN-FLG2  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
                   OR  KEISAN-FLG3  OF  PARM-SMZJ2210-ARG1  =  CNS-X-1
               THEN
                 MOVE  GENS-TAX-HYK-KWS OF  KJN-YMD-KEKA-RSK-DATA
                   TO  GENS-TAX-HYK-KWS OF  WK-TKMZBW11-TASYOU
               ELSE
                 MOVE  CNS-99999999-9999999999
                   TO  GENS-TAX-HYK-KWS OF  WK-TKMZBW11-TASYOU
               END-IF
             END-IF
      *----------  ファクター・連動係数
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-2
             THEN
               MOVE  FACTOR-RENDOU-KESU OF  KJN-YMD-KEKA-RSK-DATA
                 TO  FACTOR-RENDOU-KESU OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  ZERO
                 TO  FACTOR-RENDOU-KESU OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  市場通貨未収収益計上・戻入額
             MOVE  SJTK-MSSE-KJMIG      OF  TKMZZR00-PARM
               TO  SJTK-MSSE-KJMIG      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨未収収益計上・戻入額
             MOVE  UYTK-MSSE-KJMIG      OF  TKMZZR00-PARM
               TO  UYTK-MSSE-KJMIG      OF  WK-TKMZBW11-TASYOU
      *----------  数量残高（利付）
             IF  MEG-CD-SHRU2           OF  TKMZBW03-PARM
               = CNS-MEG-CD-SHRU2-1
             THEN
               MOVE  WK-RIT-SRY
                 TO  SRYZN-RIT          OF  WK-TKMZBW11-TASYOU
             ELSE
               MOVE  IDOG-SRYZN-RIT     OF  WK-TKMZBW06-TASYOU
                 TO  SRYZN-RIT          OF  WK-TKMZBW11-TASYOU
             END-IF
      *----------  建玉単価
             MOVE  TGYOKU-TNK           OF  WK-TKMZBW06-TASYOU
               TO  TGYOKU-TNK           OF  WK-TKMZBW11-TASYOU
      *----------  建玉為替レート
             MOVE  TGYOKU-KWS-RATE      OF  WK-TKMZBW06-TASYOU
               TO  TGYOKU-KWS-RATE      OF  WK-TKMZBW11-TASYOU
      *----------  建玉ブローカー
             MOVE  TGYOKU-BRK           OF  WK-TKMZBW06-TASYOU
               TO  TGYOKU-BRK           OF  WK-TKMZBW11-TASYOU
      *----------  建玉約定日
             MOVE  TGYOKU-YKJ-YMD       OF  WK-TKMZBW06-TASYOU
               TO  TGYOKU-YKJ-YMD       OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉約定金額残
             MOVE  SJTK-IDOG-TG-YJKNZN  OF  WK-TKMZBW06-TASYOU
               TO  SJTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉約定金額残
             MOVE  UYTK-IDOG-TG-YJKNZN  OF  WK-TKMZBW06-TASYOU
               TO  UYTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉手数料残
             MOVE  SJTK-IDOG-TG-TSRZN   OF  WK-TKMZBW06-TASYOU
               TO  SJTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉手数料残
             MOVE  UYTK-IDOG-TG-TSRZN   OF  WK-TKMZBW06-TASYOU
               TO  UYTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉消費税残
             MOVE  SJTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-TASYOU
               TO  SJTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉消費税残
             MOVE  UYTK-IDOG-TG-S-TAXZN OF  WK-TKMZBW06-TASYOU
               TO  UYTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉その他費用残
             MOVE  SJTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-TASYOU
               TO  SJTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉その他費用残
             MOVE  UYTK-IDOG-TG-ELS-HZN OF  WK-TKMZBW06-TASYOU
               TO  UYTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨建玉精算金額残
             MOVE  SJTK-IDOG-TG-SSKGZN  OF  WK-TKMZBW06-TASYOU
               TO  SJTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨建玉精算金額残
             MOVE  UYTK-IDOG-TG-SSKGZN  OF  WK-TKMZBW06-TASYOU
               TO  UYTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU
      *----------  ＯＰ資産負債・買建売建フラグ
             MOVE  OP-TATE-FLG          OF  WK-TKMZBW06-TASYOU
               TO  OP-TATE-FLG          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨源泉税還付予定額残高
             MOVE  SJTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-TASYOU
               TO  SJTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨源泉税還付予定額残高
             MOVE  UYTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-TASYOU
               TO  UYTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU
      *----------  決済通貨源泉税還付予定額残高
             MOVE  KSTK-IDOG-GSZKP-YTZN OF  WK-TKMZBW06-TASYOU
               TO  KSTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨ノンカバー未収金残高
             MOVE  SJTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-TASYOU
               TO  SJTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨ノンカバー未収金残高
             MOVE  UYTK-IDOG-NOCV-MSKZN OF  WK-TKMZBW06-TASYOU
               TO  UYTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨ノンカバー未払金残高
             MOVE  SJTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-TASYOU
               TO  SJTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨ノンカバー未払金残高
             MOVE  UYTK-IDOG-NOCV-MBKZN OF  WK-TKMZBW06-TASYOU
               TO  UYTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU
      *----------  短期スタート・エンド経過利息
             MOVE  SHORT-STEN-KEKA-RSK  OF  WK-TKMZBW06-TASYOU
               TO  SHORT-STEN-KEKA-RSK  OF  WK-TKMZBW11-TASYOU
      *----------  短期スタート日
             MOVE  SHORT-START-YMD      OF  WK-TKMZBW06-TASYOU
               TO  SHORT-START-YMD      OF  WK-TKMZBW11-TASYOU
      *----------  短期エンド日
             MOVE  SHORT-END-YMD        OF  WK-TKMZBW06-TASYOU
               TO  SHORT-END-YMD        OF  WK-TKMZBW11-TASYOU
      *----------  基本会計ベースフラグ
             MOVE  KH-KAIKEI-BASE-FLG   OF  TKMZBW02-PARM
               TO  KH-KAIKEI-BASE-FLG   OF  WK-TKMZBW11-TASYOU
      *----------  投資対象国コード
             MOVE  TSTSK-CD             OF  WK-TKMZBW06-TASYOU
               TO  TSTSK-CD             OF  WK-TKMZBW11-TASYOU
      *----------  発行国コード
             MOVE  HAKO-CD              OF  WK-TKMZBW06-TASYOU
               TO  HAKO-CD              OF  WK-TKMZBW11-TASYOU
      *----------  数量単位
             MOVE  SAIKS-SURYO-TANI     OF  PARM-SMZJ2210-ARG1
               TO  SURYO-TANI           OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨未払費用残
             MOVE  SJTK-IDOG-MBHYZN     OF  WK-TKMZBW06-TASYOU
               TO  SJTK-MBHYZN          OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨未払費用残
             MOVE  UYTK-IDOG-MBHYZN     OF  WK-TKMZBW06-TASYOU
               TO  UYTK-MBHYZN          OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨未払消費税残
             MOVE  SJTK-IDOG-MB-S-TAXZN OF  WK-TKMZBW06-TASYOU
               TO  SJTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨未払消費税残
             MOVE  UYTK-IDOG-MB-S-TAXZN OF  WK-TKMZBW06-TASYOU
               TO  UYTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨移管評価損益残
             MOVE  SJTK-IDOG-IK-HKSEZN  OF  WK-TKMZBW06-TASYOU
               TO  SJTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨移管評価損益残
             MOVE  UYTK-IDOG-IK-HKSEZN  OF  WK-TKMZBW06-TASYOU
               TO  UYTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU
      *----------  市場通貨移管未収収益
             MOVE  SJTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-TASYOU
               TO  SJTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨移管未収収益
             MOVE  UYTK-IDOG-IK-MSSHEKI OF  WK-TKMZBW06-TASYOU
               TO  UYTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU
      *----------  運用通貨移管前払金評価損益残
             MOVE  UYTK-IDOG-IK-PPHKZN  OF  WK-TKMZBW06-TASYOU
               TO  UYTK-IK-PPHKZN       OF  WK-TKMZBW11-TASYOU
      *----------  削除区分
             MOVE  SPACE
               TO  SAKUJO-KBN           OF  WK-TKMZBW11-TASYOU
      *----------  作成ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  SK-LOGIN-CMP-CD      OF  WK-TKMZBW11-TASYOU
      *----------  作成プログラムＩＤ
             MOVE  SPACE
               TO  SK-PGMID             OF  WK-TKMZBW11-TASYOU
      *----------  更新ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  UPD-LOGIN-CMP-CD     OF  WK-TKMZBW11-TASYOU
      *----------  更新プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  UPD-PGMID            OF  WK-TKMZBW11-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).処理実行日=["
      D            SYORI-YMD            OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).起動ID=["
      D            KIDOU-ID             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).利用会社コード=["
      D            RIYO-CMP-CD          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).ファンドコード=["
      D            FUND-CD              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).ポートフォリオコード=["
      D            PTF-CD               OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).証券種別コード=["
      D            SEC-SBT-CD           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).銘柄コード=["
      D            MEG-CD               OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).資産負債・買建売建フラグ=["
      D            TATE-FLG             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).玉ＩＤ=["
      D            GYOKU-ID             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).基準日=["
      D            KJN-YMD              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨コード=["
      D            SIJO-TUKA-CD         OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量残高=["
      D            SRYZN                OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨簿価残高=["
      D            SJTK-BOKAZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨簿価残高=["
      D            UYTK-BOKAZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨簿価単価=["
      D            SJTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨簿価単価=["
      D            UYTK-BOKA-TNK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).簿価為替レート=["
      D            BOKA-KWS             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨前払金残高=["
      D            SJTK-PPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨前払金残高=["
      D            UYTK-PPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨前受金残高=["
      D            SJTK-ARECZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨前受金残高=["
      D            UYTK-ARECZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨仮払金残高=["
      D            SJTK-SPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨仮払金残高=["
      D            UYTK-SPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨払出単価=["
      D            SJTK-H-TNK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨払出単価=["
      D            UYTK-H-TNK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).同一コスト継続フラグ=["
      D            SAME-COST-KZK-FLG    OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨経過利息=["
      D            SJTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨経過利息=["
      D            UYTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未収収益=["
      D            SJTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未収収益=["
      D            UYTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨源泉税=["
      D            SJTK-GENSEN-TAX      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨源泉税=["
      D            UYTK-GENSEN-TAX      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).評価為替レート=["
      D            HYK-KWS              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).源泉税評価為替レート=["
      D            GENS-TAX-HYK-KWS     OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).ファクター・連動係数=["
      D            FACTOR-RENDOU-KESU   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未収収益計上・"
      D    "戻入額=["SJTK-MSSE-KJMIG    OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未収収益計上・"
      D    "戻入額=["UYTK-MSSE-KJMIG    OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量残高（利付）=["
      D            SRYZN-RIT            OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉単価=["
      D            TGYOKU-TNK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉為替レート=["
      D            TGYOKU-KWS-RATE      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉ブローカー=["
      D            TGYOKU-BRK           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).建玉約定日=["
      D            TGYOKU-YKJ-YMD       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉約定金額残=["
      D            SJTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉約定金額残=["
      D            UYTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉手数料残=["
      D            SJTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉手数料残=["
      D            UYTK-TG-TSRZN        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉消費税残=["
      D            SJTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉消費税残=["
      D            UYTK-TG-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉その他費用残=["
      D            SJTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉その他費用残=["
      D            UYTK-TG-ELS-HIYOZN   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉精算金額残=["
      D            SJTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉精算金額残=["
      D            UYTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "ＯＰ資産負債・買建売建フラグ=["
      D            OP-TATE-FLG          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨源泉税還付予定額残高=["
      D            SJTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨源泉税還付予定額残高=["
      D            UYTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "決済通貨源泉税還付予定額残高=["
      D            KSTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨ノンカバー未収金残高=["
      D            SJTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨ノンカバー未収金残高=["
      D            UYTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨ノンカバー未払金残高=["
      D            SJTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨ノンカバー未払金残高=["
      D            UYTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "短期スタート・エンド経過利息=["
      D            SHORT-STEN-KEKA-RSK  OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).短期スタート日=["
      D            SHORT-START-YMD      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).短期エンド日=["
      D            SHORT-END-YMD        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).基本会計ベースフラグ=["
      D            KH-KAIKEI-BASE-FLG   OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).投資対象国コード=["
      D            TSTSK-CD             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).発行国コード=["
      D            HAKO-CD              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量単位=["
      D            SURYO-TANI           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未払費用残=["
      D            SJTK-MBHYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未払費用残=["
      D            UYTK-MBHYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未払消費税残=["
      D            SJTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未払消費税残=["
      D            UYTK-MB-S-TAXZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨移管評価損益残=["
      D            SJTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨移管評価損益残=["
      D            UYTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨移管未収収益=["
      D            SJTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨移管未収収益=["
      D            UYTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨移管前払金評価損益残=["
      D            UYTK-IK-PPHKZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).削除区分=["
      D            SAKUJO-KBN           OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).作成日時=["
      D            SK-DATE              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "作成ログインユーザ会社コード=["
      D            SK-LOGIN-CMP-CD      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).作成ユーザＩＤ=["
      D            SK-SID               OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).作成プログラムＩＤ=["
      D            SK-PGMID             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).更新日時=["
      D            UPD-DATE             OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "更新ログインユーザ会社コード=["
      D            UPD-LOGIN-CMP-CD     OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).更新ユーザＩＤ=["
      D            UPD-SID              OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).更新プログラムＩＤ=["
      D            UPD-PGMID            OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-1-5-EXT.
           EXIT.
      ******************************************************************
      *    別紙1-6 編集
      ******************************************************************
       EDIT-1-6-RTN           SECTION.
      *----------  処理実行日
             MOVE  SYORI-YMD            OF  TKMZBW02-PARM
               TO  SYORI-YMD            OF  WK-TKMZBW12-TASYOU
      *----------  起動ID
             MOVE  KIDOU-ID             OF  TKMZBW02-PARM
               TO  KIDOU-ID             OF  WK-TKMZBW12-TASYOU
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  WK-TKMZBW12-TASYOU
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  WK-TKMZBW12-TASYOU
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  WK-TKMZBW12-TASYOU
      *----------  決済口座番号
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  KS-KOZA-NO           OF  WK-TKMZBW12-TASYOU
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  WK-TKMZBW12-TASYOU
      *----------  決算日断面区分
             MOVE  KSN-YMD-DMN-KBN      OF  TKMZSR00-PARM
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  WK-TKMZBW12-TASYOU
      *----------  決済口座通貨コード
             MOVE  SIJO-TUKA-CD         OF  TKMZBW03-PARM
               TO  KOZA-TUKA-CD         OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日ＣＡＳＨ残高
             MOVE  SJTK-TJT-CASHZN      OF  TKMZSR00-PARM
               TO  SJTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日ＣＡＳＨ残高
             MOVE  UYTK-TJT-CASHZN      OF  TKMZSR00-PARM
               TO  UYTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).処理実行日=["
      D            SYORI-YMD            OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).起動ID=["
      D            KIDOU-ID             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).利用会社コード=["
      D            RIYO-CMP-CD          OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).ファンドコード=["
      D            FUND-CD              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).ポートフォリオコード=["
      D            PTF-CD               OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).決済口座番号=["
      D            KS-KOZA-NO           OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).基準日=["
      D            KJN-YMD              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).決算日断面区分=["
      D            KSN-YMD-DMN-KBN      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).証券種別コード=["
      D            SEC-SBT-CD           OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).決済口座通貨コード=["
      D            KOZA-TUKA-CD         OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日ＣＡＳＨ残高=["
      D            SJTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日ＣＡＳＨ残高=["
      D            UYTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
             IF  WK-KH-KAIKEI-BASE-FLG  =  CNS-X-2
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.基準日断面情報.基本会計ベースフラグ=["
      D             WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（内物）=["
      D            SJTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（内物）=["
      D            UYTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（外物）=["
      D            SJTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（外物）=["
      D            UYTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（内物）=["
      D            SJTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（内物）=["
      D            UYTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（外物）=["
      D            SJTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（外物）=["
      D            UYTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.基準日断面情報.基本会計ベースフラグ=["
      D             WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
      *----------  市場通貨当日未収入金残高（内物）
               MOVE  SJTK-TJT-MSNKZN-UM
                 OF  TKMZSR00-PARM
                 TO  SJTK-TJT-MSNKZN-UM
                 OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未収入金残高（内物）
               MOVE  UYTK-TJT-MSNKZN-UM
                 OF  TKMZSR00-PARM
                 TO  UYTK-TJT-MSNKZN-UM
                 OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日未収入金残高（外物）
               MOVE  SJTK-TJT-MSNKZN-SM
                 OF  TKMZSR00-PARM
                 TO  SJTK-TJT-MSNKZN-SM
                 OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未収入金残高（外物）
               MOVE  UYTK-TJT-MSNKZN-SM
                 OF  TKMZSR00-PARM
                 TO  UYTK-TJT-MSNKZN-SM
                 OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日未払金残高（内物）
               MOVE  SJTK-TJT-MBKZN-UM  OF  TKMZSR00-PARM
                 TO  SJTK-TJT-MBKZN-UM  OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未払金残高（内物）
               MOVE  UYTK-TJT-MBKZN-UM  OF  TKMZSR00-PARM
                 TO  UYTK-TJT-MBKZN-UM  OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日未払金残高（外物）
               MOVE  SJTK-TJT-MBKZN-SM  OF  TKMZSR00-PARM
                 TO  SJTK-TJT-MBKZN-SM  OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未払金残高（外物）
               MOVE  UYTK-TJT-MBKZN-SM  OF  TKMZSR00-PARM
                 TO  UYTK-TJT-MBKZN-SM  OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（内物）=["
      D            SJTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（内物）=["
      D            UYTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（外物）=["
      D            SJTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（外物）=["
      D            UYTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（内物）=["
      D            SJTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（内物）=["
      D            UYTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（外物）=["
      D            SJTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（外物）=["
      D            UYTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  簿価為替レート
             MOVE  BOKA-KWS             OF  TKMZSR00-PARM
               TO  BOKA-KWS             OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.その他未収配当計算コールフラグ=["
      D             KEISAN-FLG3         OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
             IF  KEISAN-FLG3            OF  PARM-SMZJ2210-ARG1 = CNS-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.その他未収配当計算コールフラグ=1  の場合"
      *-----------------------------------------------------------------
      *----------  市場通貨未収収益
               MOVE  SJTK-MS-SHEKI      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  SJTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨未収収益
               MOVE  UYTK-MS-SHEKI      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  UYTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨源泉税
               MOVE  SJTK-GENSEN-TAX    OF  KJN-YMD-KEKA-RSK-DATA
                 TO  SJTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨源泉税
               MOVE  UYTK-GENSEN-TAX    OF  KJN-YMD-KEKA-RSK-DATA
                 TO  UYTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
             ELSE
      *----------  市場通貨未収収益
               MOVE  CNS-999999999999999-999
                 TO  SJTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨未収収益
               MOVE  CNS-999999999999999-999
                 TO  UYTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨源泉税
               MOVE  CNS-999999999999999-999
                 TO  SJTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨源泉税
               MOVE  CNS-999999999999999-999
                 TO  UYTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
             END-IF
      *----------  市場通貨未収収益計上・戻入額
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益計上・戻入額   =["
      D             SJTK-MSSE-KJMIG     OF  TKMZSR00-PARM"]"
      *-----------------------------------------------------------------
             MOVE  SJTK-MSSE-KJMIG      OF  TKMZSR00-PARM
               TO  SJTK-MSSE-KJMIG      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴計算データ(対象)."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG     OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益計上・戻入額  =["
      D             UYTK-MSSE-KJMIG     OF  TKMZSR00-PARM"]"
      *-----------------------------------------------------------------
      *----------  運用通貨未収収益計上・戻入額
             MOVE  UYTK-MSSE-KJMIG      OF  TKMZSR00-PARM
               TO  UYTK-MSSE-KJMIG      OF  WK-TKMZBW12-TASYOU
      *----------  削除区分
             MOVE  SPACE
               TO  SAKUJO-KBN           OF  WK-TKMZBW12-TASYOU
      *----------  作成ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  SK-LOGIN-CMP-CD      OF  WK-TKMZBW12-TASYOU
      *----------  作成プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  SK-PGMID             OF  WK-TKMZBW12-TASYOU
      *----------  更新ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  UPD-LOGIN-CMP-CD     OF  WK-TKMZBW12-TASYOU
      *----------  更新プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  UPD-PGMID            OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴計算データ(対象)."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG     OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).簿価為替レート=["
      D            BOKA-KWS             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).市場通貨未収収益=["
      D            SJTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).運用通貨未収収益=["
      D            UYTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).市場通貨源泉税=["
      D            SJTK-GENSEN-TAX      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).運用通貨源泉税=["
      D            UYTK-GENSEN-TAX      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).削除区分=["
      D            SAKUJO-KBN           OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).作成日時=["
      D            SK-DATE              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "作成ログインユーザ会社コード=["
      D            SK-LOGIN-CMP-CD      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).作成ユーザＩＤ=["
      D            SK-SID               OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).作成プログラムＩＤ=["
      D            SK-PGMID             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).更新日時=["
      D            UPD-DATE             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "更新ログインユーザ会社コード=["
      D            UPD-LOGIN-CMP-CD     OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).更新ユーザＩＤ=["
      D            UPD-SID              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).更新プログラムＩＤ=["
      D            UPD-PGMID            OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-1-6-EXT.
           EXIT.
      ******************************************************************
      *    別紙1-8 編集
      ******************************************************************
       EDIT-1-8-RTN           SECTION.
      *----------  処理実行日
             MOVE  SYORI-YMD            OF  TKMZBW02-PARM
               TO  SYORI-YMD            OF  WK-TKMZBW12-TASYOU
      *----------  起動ID
             MOVE  KIDOU-ID             OF  TKMZBW02-PARM
               TO  KIDOU-ID             OF  WK-TKMZBW12-TASYOU
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  WK-TKMZBW12-TASYOU
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  WK-TKMZBW12-TASYOU
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  WK-TKMZBW12-TASYOU
      *----------  決済口座番号
             MOVE  MEG-CD               OF  TKMZBW03-PARM
               TO  KS-KOZA-NO           OF  WK-TKMZBW12-TASYOU
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  WK-TKMZBW12-TASYOU
      *----------  証券種別コード
             MOVE  SEC-SBT-CD           OF  TKMZBW03-PARM
               TO  SEC-SBT-CD           OF  WK-TKMZBW12-TASYOU
      *----------  決済口座通貨コード
             MOVE  SIJO-TUKA-CD         OF  TKMZBW03-PARM
               TO  KOZA-TUKA-CD         OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日ＣＡＳＨ残高
             MOVE  SJTK-IDOG-SK-BOKAZN  OF  WK-TKMZBW07-TASYOU
               TO  SJTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日ＣＡＳＨ残高
             MOVE  UYTK-IDOG-SK-BOKAZN  OF  WK-TKMZBW07-TASYOU
               TO  UYTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).処理実行日=["
      D            SYORI-YMD            OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).起動ID=["
      D            KIDOU-ID             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).利用会社コード=["
      D            RIYO-CMP-CD          OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).ファンドコード=["
      D            FUND-CD              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).ポートフォリオコード=["
      D            PTF-CD               OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).決済口座番号=["
      D            KS-KOZA-NO           OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).基準日=["
      D            KJN-YMD              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).証券種別コード=["
      D            SEC-SBT-CD           OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).決済口座通貨コード=["
      D            KOZA-TUKA-CD         OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日ＣＡＳＨ残高=["
      D            SJTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日ＣＡＳＨ残高=["
      D            UYTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
             IF  WK-KH-KAIKEI-BASE-FLG  =  CNS-X-2
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.基準日断面情報.基本会計ベースフラグ=["
      D             WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
               CONTINUE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（内物）=["
      D            SJTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（内物）=["
      D            UYTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（外物）=["
      D            SJTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（外物）=["
      D            UYTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（内物）=["
      D            SJTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（内物）=["
      D            UYTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（外物）=["
      D            SJTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（外物）=["
      D            UYTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.基準日断面情報.基本会計ベースフラグ=["
      D             WK-KH-KAIKEI-BASE-FLG"]"
      *-----------------------------------------------------------------
      *----------  市場通貨当日未収入金残高（内物）
               MOVE  SJTK-IDOG-MSNKZN-UM
                 OF  WK-TKMZBW07-TASYOU
                 TO  SJTK-TJT-MSNKZN-UM
                 OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未収入金残高（内物）
               MOVE  UYTK-IDOG-MSNKZN-UM
                 OF  WK-TKMZBW07-TASYOU
                 TO  UYTK-TJT-MSNKZN-UM
                 OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日未収入金残高（外物）
               MOVE  SJTK-IDOG-MSNKZN-SM
                 OF  WK-TKMZBW07-TASYOU
                 TO  SJTK-TJT-MSNKZN-SM
                 OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未収入金残高（外物）
               MOVE  UYTK-IDOG-MSNKZN-SM
                 OF  WK-TKMZBW07-TASYOU
                 TO  UYTK-TJT-MSNKZN-SM
                 OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日未払金残高（内物）
               MOVE  SJTK-IDOG-MBKZN-UM
                 OF  WK-TKMZBW07-TASYOU
                 TO  SJTK-TJT-MBKZN-UM
                 OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未払金残高（内物）
               MOVE  UYTK-IDOG-MBKZN-UM
                 OF  WK-TKMZBW07-TASYOU
                 TO  UYTK-TJT-MBKZN-UM
                 OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨当日未払金残高（外物）
               MOVE  SJTK-IDOG-MBKZN-SM
                 OF  WK-TKMZBW07-TASYOU
                 TO  SJTK-TJT-MBKZN-SM
                 OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨当日未払金残高（外物）
               MOVE  UYTK-IDOG-MBKZN-SM
                 OF  WK-TKMZBW07-TASYOU
                 TO  UYTK-TJT-MBKZN-SM
                 OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（内物）=["
      D            SJTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（内物）=["
      D            UYTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（外物）=["
      D            SJTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（外物）=["
      D            UYTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（内物）=["
      D            SJTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（内物）=["
      D            UYTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（外物）=["
      D            SJTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（外物）=["
      D            UYTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
             END-IF
      *----------  簿価為替レート
             MOVE  BOKA-KWS             OF  WK-TKMZBW07-TASYOU
               TO  BOKA-KWS             OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG1.その他未収配当計算コールフラグ=["
      D             KEISAN-FLG3         OF  PARM-SMZJ2210-ARG1"]"
      *-----------------------------------------------------------------
             IF  KEISAN-FLG3            OF  PARM-SMZJ2210-ARG1 = CNS-1
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":ARG1.その他未収配当計算コールフラグ=1  の場合"
      *-----------------------------------------------------------------
      *----------  市場通貨未収収益
               MOVE  SJTK-MS-SHEKI      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  SJTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨未収収益
               MOVE  UYTK-MS-SHEKI      OF  KJN-YMD-KEKA-RSK-DATA
                 TO  UYTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨源泉税
               MOVE  SJTK-GENSEN-TAX    OF  KJN-YMD-KEKA-RSK-DATA
                 TO  SJTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨源泉税
               MOVE  UYTK-GENSEN-TAX    OF  KJN-YMD-KEKA-RSK-DATA
                 TO  UYTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
             ELSE
      *----------  市場通貨未収収益
               MOVE  CNS-999999999999999-999
                 TO  SJTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨未収収益
               MOVE  CNS-999999999999999-999
                 TO  UYTK-MS-SHEKI      OF  WK-TKMZBW12-TASYOU
      *----------  市場通貨源泉税
               MOVE  CNS-999999999999999-999
                 TO  SJTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
      *----------  運用通貨源泉税
               MOVE  CNS-999999999999999-999
                 TO  UYTK-GENSEN-TAX    OF  WK-TKMZBW12-TASYOU
             END-IF
      *----------  市場通貨未収収益計上・戻入額
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益計上・戻入額   =["
      D             SJTK-MSSE-KJMIG     OF  TKMZSR00-PARM"]"
      *-----------------------------------------------------------------
             MOVE  SJTK-MSSE-KJMIG      OF  TKMZSR00-PARM
               TO  SJTK-MSSE-KJMIG      OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴計算データ(対象)."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG     OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益計上・戻入額  =["
      D             UYTK-MSSE-KJMIG     OF  TKMZSR00-PARM"]"
      *-----------------------------------------------------------------
      *----------  運用通貨未収収益計上・戻入額
             MOVE  UYTK-MSSE-KJMIG      OF  TKMZSR00-PARM
               TO  UYTK-MSSE-KJMIG      OF  WK-TKMZBW12-TASYOU
      *----------  削除区分
             MOVE  SPACE
               TO  SAKUJO-KBN           OF  WK-TKMZBW12-TASYOU
      *----------  作成ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  SK-LOGIN-CMP-CD      OF  WK-TKMZBW12-TASYOU
      *----------  作成プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  SK-PGMID             OF  WK-TKMZBW12-TASYOU
      *----------  更新ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  UPD-LOGIN-CMP-CD     OF  WK-TKMZBW12-TASYOU
      *----------  更新プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  UPD-PGMID            OF  WK-TKMZBW12-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク資金残履歴計算データ(対象)."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG     OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).簿価為替レート=["
      D            BOKA-KWS             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).市場通貨未収収益=["
      D            SJTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).運用通貨未収収益=["
      D            UYTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).市場通貨源泉税=["
      D            SJTK-GENSEN-TAX      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).運用通貨源泉税=["
      D            UYTK-GENSEN-TAX      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).削除区分=["
      D            SAKUJO-KBN           OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).作成日時=["
      D            SK-DATE              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "作成ログインユーザ会社コード=["
      D            SK-LOGIN-CMP-CD      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).作成ユーザＩＤ=["
      D            SK-SID               OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).作成プログラムＩＤ=["
      D            SK-PGMID             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).更新日時=["
      D            UPD-DATE             OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "更新ログインユーザ会社コード=["
      D            UPD-LOGIN-CMP-CD     OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).更新ユーザＩＤ=["
      D            UPD-SID              OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象).更新プログラムＩＤ=["
      D            UPD-PGMID            OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-1-8-EXT.
           EXIT.
      ******************************************************************
      *    別紙1-9 編集
      ******************************************************************
       EDIT-1-9-RTN           SECTION.
      *----------  処理実行日
             MOVE  SYORI-YMD            OF  TKMZBW02-PARM
               TO  SYORI-YMD            OF  WK-TKMZBW13-TASYOU
      *----------  起動ID
             MOVE  KIDOU-ID             OF  TKMZBW02-PARM
               TO  KIDOU-ID             OF  WK-TKMZBW13-TASYOU
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  WK-TKMZBW13-TASYOU
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  WK-TKMZBW13-TASYOU
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  WK-TKMZBW13-TASYOU
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  WK-TKMZBW13-TASYOU
      *----------  決算日断面区分
             MOVE  KSN-YMD-DMN-KBN      OF  TKMZGZ00-PARM
               TO  KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU
      *----------  元本数量残高
             MOVE  GNP-SRYZN            OF  TKMZGZ00-PARM
               TO  GNP-SRYZN            OF  WK-TKMZBW13-TASYOU
      *----------  元本簿価残高
             MOVE  GNP-BOKAZN           OF  TKMZGZ00-PARM
               TO  GNP-BOKAZN           OF  WK-TKMZBW13-TASYOU
      *----------  総投入金額
             MOVE  SO-TN-KGK            OF  TKMZGZ00-PARM
               TO  SO-TN-KGK            OF  WK-TKMZBW13-TASYOU
      *----------  初期設定金額
             MOVE  SHOKI-SET-KGK        OF  TKMZGZ00-PARM
               TO  SHOKI-SET-KGK        OF  WK-TKMZBW13-TASYOU
      *----------  削除区分
             MOVE  SPACE
               TO  SAKUJO-KBN           OF  WK-TKMZBW13-TASYOU
      *----------  作成ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  SK-LOGIN-CMP-CD      OF  WK-TKMZBW13-TASYOU
      *----------  作成プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  SK-PGMID             OF  WK-TKMZBW13-TASYOU
      *----------  更新ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  UPD-LOGIN-CMP-CD     OF  WK-TKMZBW13-TASYOU
      *----------  更新プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  UPD-PGMID            OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).処理実行日=["
      D            SYORI-YMD            OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).起動ID=["
      D            KIDOU-ID             OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).利用会社コード=["
      D            RIYO-CMP-CD          OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).ファンドコード=["
      D            FUND-CD              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).ポートフォリオコード=["
      D            PTF-CD               OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).基準日=["
      D            KJN-YMD              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).決算日断面区分=["
      D            KSN-YMD-DMN-KBN      OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).元本数量残高=["
      D            GNP-SRYZN            OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).元本簿価残高=["
      D            GNP-BOKAZN           OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).総投入金額=["
      D            SO-TN-KGK            OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).初期設定金額=["
      D            SHOKI-SET-KGK        OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).削除区分=["
      D            SAKUJO-KBN           OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).作成日時=["
      D            SK-DATE              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象)."
      D    "作成ログインユーザ会社コード=["
      D            SK-LOGIN-CMP-CD      OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).作成ユーザＩＤ=["
      D            SK-SID               OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).作成プログラムＩＤ=["
      D            SK-PGMID             OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).更新日時=["
      D            UPD-DATE             OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象)."
      D    "更新ログインユーザ会社コード=["
      D            UPD-LOGIN-CMP-CD     OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).更新ユーザＩＤ=["
      D            UPD-SID              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).更新プログラムＩＤ=["
      D            UPD-PGMID            OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-1-9-EXT.
           EXIT.
      ******************************************************************
      *    別紙1-10 編集
      ******************************************************************
       EDIT-1-10-RTN          SECTION.
      *----------  処理実行日
             MOVE  SYORI-YMD            OF  TKMZBW02-PARM
               TO  SYORI-YMD            OF  WK-TKMZBW13-TASYOU
      *----------  起動ID
             MOVE  KIDOU-ID             OF  TKMZBW02-PARM
               TO  KIDOU-ID             OF  WK-TKMZBW13-TASYOU
      *----------  利用会社コード
             MOVE  RIYO-CMP-CD          OF  TKMZBW03-PARM
               TO  RIYO-CMP-CD          OF  WK-TKMZBW13-TASYOU
      *----------  ファンドコード
             MOVE  FUND-CD              OF  TKMZBW03-PARM
               TO  FUND-CD              OF  WK-TKMZBW13-TASYOU
      *----------  ポートフォリオコード
             MOVE  PTF-CD               OF  TKMZBW03-PARM
               TO  PTF-CD               OF  WK-TKMZBW13-TASYOU
      *----------  基準日
             MOVE  KJN-YMD              OF  TKMZBW03-PARM
               TO  KJN-YMD              OF  WK-TKMZBW13-TASYOU
      *----------  元本数量残高
             MOVE  IDOG-SRYZN           OF  WK-TKMZBW06-NORMAL
               TO  GNP-SRYZN            OF  WK-TKMZBW13-TASYOU
      *----------  元本簿価残高
             MOVE  UYTK-IDOG-BOKAZN     OF  WK-TKMZBW06-NORMAL
               TO  GNP-BOKAZN           OF  WK-TKMZBW13-TASYOU
      *----------  総投入金額
             MOVE  UYTK-IDOG-TG-SSKGZN  OF  WK-TKMZBW06-NORMAL
               TO  SO-TN-KGK            OF  WK-TKMZBW13-TASYOU
      *----------  初期設定金額
             MOVE  UYTK-IDOG-TG-YJKNZN  OF  WK-TKMZBW06-NORMAL
               TO  SHOKI-SET-KGK        OF  WK-TKMZBW13-TASYOU
      *----------  削除区分
             MOVE  SPACE
               TO  SAKUJO-KBN           OF  WK-TKMZBW13-TASYOU
      *----------  作成ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  SK-LOGIN-CMP-CD      OF  WK-TKMZBW13-TASYOU
      *----------  作成プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  SK-PGMID             OF  WK-TKMZBW13-TASYOU
      *----------  更新ログインユーザ会社コード
             MOVE  WK-RIYO-CMP-CD
               TO  UPD-LOGIN-CMP-CD     OF  WK-TKMZBW13-TASYOU
      *----------  更新プログラムＩＤ
             MOVE  CNS-PGM-ID
               TO  UPD-PGMID            OF  WK-TKMZBW13-TASYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高異動計算データ(最大順).異動後数量残高=["
      D            IDOG-SRYZN           OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高異動計算データ(最大順).運用通貨異動後簿価残高=["
      D            UYTK-IDOG-BOKAZN     OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高異動計算データ(最大順).運用通貨異動後建玉精"
      D      "算金額残=["UYTK-IDOG-TG-SSKGZN  OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高異動計算データ(最大順).運用通貨異動後建玉約"
      D    "定金額残=["UYTK-IDOG-TG-YJKNZN    OF  WK-TKMZBW06-NORMAL"]"
      D    DISPLAY  CNS-PGM-ID"----------------------------------------"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).処理実行日=["
      D            SYORI-YMD            OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).起動ID=["
      D            KIDOU-ID             OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).利用会社コード=["
      D            RIYO-CMP-CD          OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).ファンドコード=["
      D            FUND-CD              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).ポートフォリオコード=["
      D            PTF-CD               OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).基準日=["
      D            KJN-YMD              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).元本数量残高1=["
      D            GNP-SRYZN            OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).元本簿価残高1=["
      D            GNP-BOKAZN           OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).総投入金額1=["
      D            SO-TN-KGK            OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).初期設定金額1=["
      D            SHOKI-SET-KGK        OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).削除区分=["
      D            SAKUJO-KBN           OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).作成日時=["
      D            SK-DATE              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象)."
      D    "作成ログインユーザ会社コード=["
      D            SK-LOGIN-CMP-CD      OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).作成ユーザＩＤ=["
      D            SK-SID               OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).作成プログラムＩＤ=["
      D            SK-PGMID             OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).更新日時=["
      D            UPD-DATE             OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象)."
      D    "更新ログインユーザ会社コード=["
      D            UPD-LOGIN-CMP-CD     OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).更新ユーザＩＤ=["
      D            UPD-SID              OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).更新プログラムＩＤ=["
      D            UPD-PGMID            OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-1-10-EXT.
           EXIT.
      ******************************************************************
      *    別紙4-1 編集
      ******************************************************************
       EDIT-4-1-RTN           SECTION.
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID ":別紙4-1 編集"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量残高=["
      D            SRYZN                OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨簿価残高=["
      D            SJTK-BOKAZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨簿価残高=["
      D            UYTK-BOKAZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨前払金残高=["
      D            SJTK-PPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨前払金残高=["
      D            UYTK-PPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨前受金残高=["
      D            SJTK-ARECZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨前受金残高=["
      D            UYTK-ARECZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨仮払金残高=["
      D            SJTK-SPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨仮払金残高=["
      D            UYTK-SPAYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨経過利息=["
      D            SJTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨経過利息=["
      D            UYTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未収収益=["
      D            SJTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未収収益=["
      D            UYTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).数量残高（利付）=["
      D            SRYZN-RIT            OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉約定金額残=["
      D            SJTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉約定金額残=["
      D            UYTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨建玉精算金額残=["
      D            SJTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨建玉精算金額残=["
      D            UYTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨源泉税還付予定額残高=["
      D            SJTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨源泉税還付予定額残高=["
      D            UYTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨ノンカバー未収金残高=["
      D            SJTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨ノンカバー未収金残高=["
      D            UYTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "市場通貨ノンカバー未払金残高=["
      D            SJTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨ノンカバー未払金残高=["
      D            UYTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨未払費用残=["
      D            SJTK-MBHYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨未払費用残=["
      D            UYTK-MBHYZN          OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨移管評価損益残=["
      D            SJTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨移管評価損益残=["
      D            UYTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).市場通貨移管未収収益=["
      D            SJTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象).運用通貨移管未収収益=["
      D            UYTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク残高履歴計算データ(対象)."
      D    "運用通貨移管前払金評価損益残=["
      D            UYTK-IK-PPHKZN       OF  WK-TKMZBW11-TASYOU"]"
      *-----------------------------------------------------------------
           IF      SRYZN                OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-BOKAZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-BOKAZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-PPAYZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-PPAYZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-ARECZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-ARECZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-SPAYZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-SPAYZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND  (SJTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU  =  ZERO
                  OR  SJTK-KEKA-RSK     OF  WK-TKMZBW11-TASYOU
                   =  CNS-999999999999-999999)
             AND  (UYTK-KEKA-RSK        OF  WK-TKMZBW11-TASYOU  =  ZERO
                  OR  UYTK-KEKA-RSK     OF  WK-TKMZBW11-TASYOU
                   =  CNS-999999999999-999999)
             AND  (SJTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU  =  ZERO
                  OR  SJTK-MS-SHEKI     OF  WK-TKMZBW11-TASYOU
                   =  CNS-999999999999999-999)
             AND  (UYTK-MS-SHEKI        OF  WK-TKMZBW11-TASYOU  =  ZERO
                  OR  UYTK-MS-SHEKI     OF  WK-TKMZBW11-TASYOU
                   =  CNS-999999999999999-999)
             AND   SRYZN-RIT            OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-TG-YJKNZN       OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-TG-SSKGZN       OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-GSZKP-YTZN      OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-NOCV-MSKZN      OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-NOCV-MBKZN      OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   SJTK-MBHYZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
             AND   UYTK-MBHYZN          OF  WK-TKMZBW11-TASYOU  =  ZERO
      *      AND   SJTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU  =  ZERO
      *      AND   UYTK-IK-HKSEZN       OF  WK-TKMZBW11-TASYOU  =  ZERO
      *      AND   SJTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU  =  ZERO
      *      AND   UYTK-IK-MSSHEKI      OF  WK-TKMZBW11-TASYOU  =  ZERO
      *      AND   UYTK-IK-PPHKZN       OF  WK-TKMZBW11-TASYOU  =  ZERO
           THEN
             MOVE  CNS-X-0              TO  WK-YUKOU-ZN-FLG
           ELSE
             MOVE  CNS-X-1              TO  WK-YUKOU-ZN-FLG
           END-IF
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク有効残高フラグ=["
      D            WK-YUKOU-ZN-FLG"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-4-1-EXT.
           EXIT.
      ******************************************************************
      *    別紙4-2 編集
      ******************************************************************
       EDIT-4-2-RTN           SECTION.
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日ＣＡＳＨ残高=["
      D            SJTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日ＣＡＳＨ残高=["
      D            UYTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（内物）=["
      D            SJTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（内物）=["
      D            UYTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未収入金残高（外物）=["
      D            SJTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未収入金残高（外物）=["
      D            UYTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（内物）=["
      D            SJTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（内物）=["
      D            UYTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨当日未払金残高（外物）=["
      D            SJTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨当日未払金残高（外物）=["
      D            UYTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "市場通貨未収収益=["
      D            SJTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク資金残履歴計算データ(対象)."
      D    "運用通貨未収収益=["
      D            UYTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU"]"
      *-----------------------------------------------------------------
           IF      SJTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   UYTK-TJT-CASHZN      OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   SJTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   UYTK-TJT-MSNKZN-UM   OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   SJTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   UYTK-TJT-MSNKZN-SM   OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   SJTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   UYTK-TJT-MBKZN-UM    OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   SJTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND   UYTK-TJT-MBKZN-SM    OF  WK-TKMZBW12-TASYOU  =  ZERO
             AND  (SJTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU  =  ZERO
              OR   SJTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU
                =  CNS-999999999999999-999)
             AND  (UYTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU  =  ZERO
              OR   UYTK-MS-SHEKI        OF  WK-TKMZBW12-TASYOU
                =  CNS-999999999999999-999)
           THEN
             MOVE  CNS-X-0              TO  WK-YUKOU-ZN-FLG
           ELSE
             MOVE  CNS-X-1              TO  WK-YUKOU-ZN-FLG
           END-IF
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク有効残高フラグ=["
      D            WK-YUKOU-ZN-FLG"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-4-2-EXT.
           EXIT.
      ******************************************************************
      *    別紙4-3 編集
      ******************************************************************
       EDIT-4-3-RTN           SECTION.
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).元本数量残高=["
      D            GNP-SRYZN            OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).元本簿価残高=["
      D            GNP-BOKAZN           OF  WK-TKMZBW13-TASYOU"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク元本残高計算データ(対象).総投入金額=["
      D            SO-TN-KGK            OF  WK-TKMZBW13-TASYOU"]"
      *-----------------------------------------------------------------
           IF      GNP-SRYZN            OF  WK-TKMZBW13-TASYOU  =  ZERO
             AND   GNP-BOKAZN           OF  WK-TKMZBW13-TASYOU  =  ZERO
             AND   SO-TN-KGK            OF  WK-TKMZBW13-TASYOU  =  ZERO
           THEN
             MOVE  CNS-X-0              TO  WK-YUKOU-ZN-FLG
           ELSE
             MOVE  CNS-X-1              TO  WK-YUKOU-ZN-FLG
           END-IF
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク有効残高フラグ=["
      D            WK-YUKOU-ZN-FLG"]"
      *-----------------------------------------------------------------
           CONTINUE.
       EDIT-4-3-EXT.
           EXIT.
      ******************************************************************
      *     3.3.1 後処理
      ******************************************************************
       END-RTN                SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  後処理  START  ***"
      *-----------------------------------------------------------------
      *----------  リターンパッケージの設定
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***リターンパッケージの処理1 START ***"
      *-----------------------------------------------------------------
           CALL   "SCZY1170"             USING  PARM-SCZY1170-IN
                                                PARM-SCZY1170-RTNPKG
           MOVE  PARM-SCZY1170-RTNPKG    TO     PARM-SMZJ2210-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY CNS-PGM-ID":PARM-SCZY1170-RTNPKG=["
      D            PARM-SCZY1170-RTNPKG"]"
      D    DISPLAY CNS-PGM-ID":PARM-SMZJ2210-ARG3=["
      D            PARM-SMZJ2210-ARG3"]"
      D    DISPLAY CNS-PGM-ID":  COUNTER = ["
      D            COUNTER               OF PARM-SMZJ2210-ARG3"]"
      D    DISPLAY CNS-PGM-ID":  エラー検知プログラム名 = ["
      D            ERR-PGM-ID            OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  ポジション = ["
      D            ERR-POS               OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  リターンコード = ["
      D            RTN-CD                OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  詳細リターンコード = ["
      D            DETAIL-RTN-CD         OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  詳細リターンコードデコードフラグ = ["
      D            DETAIL-RTN-CD-FLG     OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  フリーメッセージ = ["
      D            FREE-MSG              OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY CNS-PGM-ID":***リターンパッケージの処理1  END  ***"
      D    DISPLAY  CNS-PGM-ID":***   後処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       END-EXT.
           EXIT.
      ******************************************************************
      *     3.4.1 エラー処理
      ******************************************************************
       ERR-RTN                SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  エラー処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2210-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ARG2.基準日別更新区分=["
      D             KJB-KOUSIN-KBN      OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.履歴作成フラグ=["
      D             RIREKI-SAKUSEI-FLG  OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":残高履歴計算データカーソルオープン"
      D             "フラグ= ["FLG-TKMZBW11-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":未収収益計算データカーソルオープン"
      D             "フラグ= ["FLG-TKMZBW08-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データカーソルオープン"
      D             "フラグ1= ["FLG-TKMZBW06-CR1-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR1-OPEN-PR"
      D                    "= ["FLG-TKMZBW06-CR1-OPEN-PR"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR3-OPEN-PR"
      D                    "= ["FLG-TKMZBW06-CR3-OPEN-PR"]"
      D    DISPLAY  CNS-PGM-ID":資金簿価異動計算データカーソルオープン"
      D             "フラグ= ["FLG-TKMZBW07-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データカーソルオープン"
      D             "フラグ2= ["FLG-TKMZBW06-CR2-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR4-OPEN"
      D                    "= ["FLG-TKMZBW06-CR4-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":残高履歴カーソルオープン"
      D             "フラグ=["FLG-TKMZZR00-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":資金残履歴カーソルオープン"
      D             "フラグ=["FLG-TKMZSR00-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":元本残高カーソルオープン"
      D             "フラグ=["FLG-TKMZGZ00-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":未収収益と債券過去経過利息カーソル"
      D             "オープンフラグ=["FLG-TKMZMS-KR-CR-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データカーソルオープン"
      D             "フラグ16= ["FLG-TKMZBW06-CR16-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":残高異動カーソルオープン"
      D             "フラグ17= ["FLG-TKMZZI00-CR17-OPEN"]"
      D    DISPLAY  CNS-PGM-ID":残高異動カーソルオープン"
      D             "フラグ17-2= ["FLG-TKMZZI00-CR17-OPEN2"]"
      *-----------------------------------------------------------------
           MOVE  CNS-OFF                TO  FLG-TKMZBW11-S10-INSERT     @3212SEINO@@
           MOVE  CNS-OFF                TO  FLG-TKMZBW12-S11-INSERT     @3212SEINO@@
           MOVE  CNS-OFF                TO  FLG-TKMZBW13-S12-INSERT     @3212SEINO@@
      *----------  残高履歴計算データカーソルをクローズする
           IF  FLG-TKMZBW11-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW11_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW11_CUR
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW11-CR-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW11_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  未収収益計算データカーソルをクローズする
           IF  FLG-TKMZBW08-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW08_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW08_CUR
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW08-CR-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW08_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高異動計算データカーソル1をクローズする
      *    IF  FLG-TKMZBW06-CR1-OPEN = CNS-ON                           @3212SEINO@@
           IF  FLG-TKMZBW06-CR1-OPEN-PR = CNS-ON                        @3212SEINO@@
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR1_1 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW06_CUR1_1
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR1-OPEN
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR1-OPEN-PR    @3212SEINO@@
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR1_1 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
           IF  FLG-TKMZBW06-CR3-OPEN-PR = CNS-ON                        @3212SEINO@@
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR1_3 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW06_CUR1_3
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR1-OPEN
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR3-OPEN-PR    @3212SEINO@@
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR1_3 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  資金簿価異動計算データカーソルをクローズする
      **** IF  FLG-TKMZBW07-CR-OPEN = CNS-ON                            @3212SEINO@@
           IF  FLG-TKMZBW07-CR-OPEN-PR = CNS-ON                         @3212SEINO@@
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW07_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW07_CUR
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW07-CR-OPEN
             MOVE  CNS-OFF              TO  FLG-TKMZBW07-CR-OPEN-PR     @3212SEINO@@
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW07_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高異動計算データカーソル2をクローズする
           IF  FLG-TKMZBW06-CR2-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR2_2 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW06_CUR2_2
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR2-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR2_2 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
           IF  FLG-TKMZBW06-CR4-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR2_4 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW06_CUR2_4
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR4-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR2_4 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高履歴カーソルオープンフラグ
           IF  FLG-TKMZZR00-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZR00_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZZR00_CUR
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZZR00-CR-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZR00_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  資金残履歴カーソルオープンフラグ
           IF  FLG-TKMZSR00-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZSR00_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZSR00_CUR
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZSR00-CR-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZSR00_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  元本残高カーソルオープンフラグ
           IF  FLG-TKMZGZ00-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZGZ00_CUR CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZGZ00_CUR
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZGZ00-CR-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZGZ00_CUR CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  未収収益と債券過去経過利息カーソルフラグ
           IF  FLG-TKMZMS-KR-CR-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID"TKMZMSKR_CUR_1 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZMSKR_CUR_1
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZMS-KR-CR-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID"TKMZMSKR_CUR_1 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
           IF  FLG-TKMZMS-KR-CR-OPEN2 = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID"TKMZMSKR_CUR_2 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZMSKR_CUR_2
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZMS-KR-CR-OPEN2
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID"TKMZMSKR_CUR_2 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高異動計算データカーソル16をクローズする
           IF  FLG-TKMZBW06-CR16-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR3 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZBW06_CUR3
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZBW06-CR16-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZBW06_CUR3 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  残高異動カーソル17をクローズする
           IF  FLG-TKMZZI00-CR17-OPEN = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZI00_CUR3_1 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZZI00_CUR3_1
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZZI00-CR17-OPEN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZI00_CUR3_1 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
           IF  FLG-TKMZZI00-CR17-OPEN2 = CNS-ON
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZI00_CUR3_2 CLOSE処理を行く"
      *-----------------------------------------------------------------
             EXEC  SQL
                 CLOSE TKMZZI00_CUR3_2
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKMZZI00-CR17-OPEN2
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":TKMZZI00_CUR3_2 CLOSE処理を行かない"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *----------  リターンパッケージの設定
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***リターンパッケージの処理2 START ***"
      *-----------------------------------------------------------------
           CALL   "SCZY1170"             USING  PARM-SCZY1170-IN
                                                PARM-SCZY1170-RTNPKG
           MOVE  PARM-SCZY1170-RTNPKG    TO     PARM-SMZJ2210-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY CNS-PGM-ID":PARM-SCZY1170-RTNPKG=["
      D            PARM-SCZY1170-RTNPKG    "]"
      D    DISPLAY CNS-PGM-ID":PARM-SMZJ2210-ARG3=["
      D            PARM-SMZJ2210-ARG3"]"
      D    DISPLAY CNS-PGM-ID":  COUNTER  = ["
      D            COUNTER               OF PARM-SMZJ2210-ARG3"]"
      D    DISPLAY CNS-PGM-ID":  エラー検知プログラム名= ["
      D            ERR-PGM-ID            OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  ポジション = ["
      D            ERR-POS               OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  リターンコード = ["
      D            RTN-CD                OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  詳細リターンコード = ["
      D            DETAIL-RTN-CD         OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  詳細リターンコードデコードフラグ = ["
      D            DETAIL-RTN-CD-FLG     OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      D    DISPLAY CNS-PGM-ID":  フリーメッセージ = ["
      D            FREE-MSG              OF PARM-SMZJ2210-ARG3(COUNTER
      D                                  OF PARM-SMZJ2210-ARG3)"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***リターンパッケージの処理2  END  ***"
      D    DISPLAY  CNS-PGM-ID":***  エラー処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-EXT.
           GOBACK.
