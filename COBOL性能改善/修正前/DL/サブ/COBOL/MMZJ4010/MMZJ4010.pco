      ******************************************************************
      * $Header$
      ******************************************************************
      *
      * システムＩＤ   : T-STAR
      * システム名称   : 次期TSTARシステム
      * プログラムＩＤ : MMZJ4010
      * プログラム名称 : 残高・損益更新メイン
      * 処理概要       : 残高・損益更新メイン
      * 参照ＤＢ       : 取引差分更新管理（TKMZSK00）
      *                : 基準日断面情報  （TKMZBW02）
      *                : 銘柄別断面情報  （TKMZBW03）
      *                : 対象取引情報    （TKMZBW04）
      *                : 対象資金取引情報（TKMZBW05）
      *                : 実行状況管理明細（TKDYAA35）
      *                : 取引            （TKMXTR00）
      *                : 相対取引        （TKMXTR01）
      *                : 処理資金取引    （TKMZBW18）
      * 更新ＤＢ       : 実行状況管理明細（TKDYAA35）
      * 引数           : 利用会社コード
      *                : 処理実行日
      *                : 起動ID
      *                : 業務タスクID
      * 改訂履歴
      * 年月日        区分     所属    担当      内容
      * ------------  ----    ------  -------  -------------
      * 20080514      新規     SCS     楊超     新規作成
      * 20080528      修正     SCS     楊超     残タスク22
      * 20080528      修正     SCS     楊超     残タスク9
      * 20080730      修正     SCS     楊超     残タスク20
      * 20080804      修正     SCS     楊超     残タスク23
      * 20080804      修正     SCS     楊超     残タスク24
      * 20080804      修正     SCS     楊超     残タスク49
      * 20080812      修正     SCS     楊超     残タスク71
      * 20080812      修正     SCS     楊超     残タスク48
      * 20080812      修正     SCS     楊超     残タスク70
      * 20081008      修正     SCS     李菁
      * 20081013      修正     SCS     楊超
      * 20081020      修正     SCS     李菁     残タスク82-92-93
      * 20081020      修正     SCS     李菁     残タスク81
      * 20081028      修正     SCS     李菁
      * 20081110      修正     SCS     王粒
      * 20090107      修正     SCS     王粒
      * 20090120      修正     SCS     徐曉俊   残タスク094，140，142，176，161対応
      * 20090120      修正     SCS     徐曉俊   残タスク163対応
      * 20090206      修正     SCS     王粒
      * 20090210      修正     SCS     楊超     残タスク103
      * 20090212      修正     SCS     徐曉俊   残タスク147
      * 20090212      修正     SCS     徐曉俊   残タスク183
      * 20090216      修正     SCS     徐曉俊   残タスク144対応
      * 20090225      修正     SCS     徐曉俊   連結障害0001355対応
      * 20090302      修正     SCS     徐曉俊   残タスク179対応
      * 20090318      修正     SCS     徐曉俊   残タスク196,199,202対応
      * 20090318      修正     SCS     徐曉俊   残タスク180対応
      * 20090324      修正     SCS     徐曉俊   連結引継ぎ残47対応
      * 20090327      修正     SCS     徐曉俊   連結引継ぎ残13対応
      * 20090408      修正     SCS     徐曉俊   総合障害212
      * 20090409      修正     SCS     徐曉俊   総合障害233
      * 20090410      修正     SCS     徐曉俊   総合障害対応
      * 20090415      修正     SCS     王  粒   総合障害259
      * 20090420      修正     SCS     徐曉俊   テーマ18
      * 20090420      修正     SCS     王  粒   総合障害289
      * 20090422      修正     SCS     王  粒   テーマ24対応,テーマ14
      * 20090430      修正     SCS     徐曉俊   テーマ18-02
      * 20090506      修正     SCS     何傑文   連結障害1724
      * 20090511      修正     SCS     徐曉俊   テーマ294,連結障害1729
      * 20090512      修正     SCS     徐曉俊
      * 20090518      修正     SCS     徐曉俊   総合障害433
      * 20090522      修正     SCS     徐曉俊   テーマ302
      * 20090525      修正     SCS     徐曉俊   総合障害681
      * 20090526      修正     SCS     徐曉俊   テーマ293
      * 20090527      修正     SCS     王飛     総合障害583
      * 20090602      修正     SCS     徐曉俊   総合障害475
      * 20090603      修正     SCS     徐曉俊   総合障害653 テーマ252
      * 20090608      修正     SCS     徐曉俊   総合障害357
      * 20090610      修正     SCS     徐曉俊   総合障害885,テーマ543,総合障害944
      * 20090616      修正     SCS     徐曉俊   総合障害725
      * 20090616      修正     SCS     徐曉俊   総合障害999
      * 20090622      修正     SCS     徐曉俊   総合障害739 テーマ544 総合障害941
      * 20090623      修正     SCS     徐曉俊   総合障害1107
      * 20090624      修正     SCS     徐曉俊   連結障害1901
      * 20090629      修正     SCS     徐曉俊   総合障害768,総合障害1162
      * 20090701      修正     SCS     徐曉俊   総合障害1287
      * 20090702      修正     SCS     徐曉俊   総合障害690,総合障害351
      * 20090708      修正     SCS     徐曉俊   総合障害1266,テーマ95,853,857対応
      * 20090715      修正     SCS     王飛     総障1543
      * 20090717      修正     SCS     王飛     総障1412
      * 20090721      修正     SCS     王飛     総障1412-02
      * 20090723      修正     SCS     王飛     総合1698
      * 20090728      修正     SCS     王飛     テーマ1771
      * 20090803      修正     SCS     王飛     総合障害1511
      * 20090804      修正     SCS     王飛     総合障害1749
      * 20090814      修正     SCS     顧建鋒   総合障害1595
      * 20090827      修正     SCS     王飛     テーマ4
      * 20090901      修正     SCS     徐曉俊   総合障害2260,テーマ981対応,総合障害757
      * 20090903      修正     SCS     王飛     総障1624,テ4-02
      * 20090907      修正     SCS     王飛     テーマ1433,テーマ1188
      * 20090910      修正     SCS     王飛     総合障害1870,テーマ4-03
      * 20090918      修正     SCS     王飛     総合障害2179
      * 20090922      修正     SCS     王飛     総合障害2533
      * 20091012      修正     SCS     顧建鋒   総障2882
      * 20091012      修正     SCS     王飛     総合障害2217,総合障害1998
      * 20091019      修正     SCS     徐曉俊   総合障害2833,総合障害2864
      * 20091026      修正     SCS     王飛     テーマ1893
      * 20091027      修正     SCS     王飛     テーマ1770
      * 20091028      修正     SCS     楊超     テーマ1557
      * 20091028      修正     SCS     楊超     テーマ1903
      * 20091029      修正     SCS     楊超     テーマ1915
      * 20091111      修正     SCS     王飛     テーマ1903
      * 20091113      修正     SCS     楊超     テーマ1841
      * 20091117      修正     SCS     楊超     テーマ1938
      * 20091117      修正     SCS     楊超     テーマ1857
      * 20091117      修正     SCS     楊超     テーマ1760
      * 20091117      修正     SCS     楊超     テーマ2072
      * 20091117      修正     SCS     楊超     テーマ1878
      * 20091120      修正     SCS     徐曉俊   テーマ2114
      * 20091201      修正     SCS     王飛     テーマ1841
      * 20091203      修正     SCS     王飛     テーマ2153
      * 20091223      修正     SCS     王飛     テーマ1075
      * 20091223      修正     SCS     王飛     テーマ2107
      * 20091224      修正     SCS     王飛     テーマ2280
      * 20100115      修正     SCS     楊超     総合障害3916
      * 20100125      修正     SCS     楊歓     GIPS2.0性能
      * 20100210      修正     SCS     楊歓     GIPS2.0差分,GIPS2.0性能
      * 20100318      修正     SCS     HECHENG  業務支援連結障害
      *                                SCZY1130の引数「メニューID」の設定値を初期値にする。
      * 20100318      修正     SCS     常       連結障害2183
      * 20100329      修正     SCS     兪ル     業務支援連結障害0002229
      * 20100401      修正     SCS     兪ル     業務支援連結障害0002236
      * 20100407      修正     SCS     韓       業務支援連結障害0002241
      * 20100414      修正     SCS     張喬     仕様変更00305
      * 20100506      修正     SCS     陳曄     テーマ2085,テーマ2471,テーマ2473,テーマ2515,テーマ2556,テーマ2623,テーマ1511
      * 20100521      修正     SCS     陳幸縁   テーマ2797
      * 20100526      修正     SCS     陳曄     テーマ2679
      * 20100621      修正     SCS     楊超     テーマ2812
      * 20100624      修正     SCS     楊超     テーマ2871
      * 20100704      修正     SCS     楊超     テーマ2818
      * 20100712      修正     SCS     楊超     テーマ2931
      * 20100722      修正     SCS     陳幸縁   テーマ2945
      * 20100902      修正     SCS     陳幸縁   テーマ3004
      * 20100906      修正     SCS     陳幸縁   テーマ3032
      * 20100925      修正     SCS     陳幸縁   テーマ3005
      * 20101227      修正     SCS     楊 超    テーマ3129
      * 20101228      修正     SCS     楊 超    テーマ3132
      * 20110118      修正     SCS     楊 超    テーマ3169
      * 20110121      修正     SCS     陳幸縁   テーマ3177
      * 20110321      修正     SCS     兪巧芳   テーマ3105
      * @SEINO@@      修正     BTH     山崎     性能改善対応
      * 20110415      修正     SCS     朱  軍   テーマ3212-1性能改善対応
      * 20110920      修正     SCS     楊暁波   テーマ3318
      * 20111008      修正     SCS     兪巧芳   テーマ3281
      * 20120405      修正     SCS     シャ建   テーマ3382対応
      * 20120803      修正     SCS     王美娟   テーマ3415-1
      * 20130122      修正     SCS     兪巧芳   テーマ3467
      * 20130716      修正     SCS     兪巧芳   テーマ3530
      ******************************************************************
       IDENTIFICATION         DIVISION.
       PROGRAM-ID.    MMZJ4010.
       AUTHOR.        Nomura.
       DATE-WRITTEN.  08-05-14.
       DATE-COMPILED.
      ******************************************************************
      *
      *                 環  境  部
      *
      ******************************************************************
       ENVIRONMENT            DIVISION.
       CONFIGURATION          SECTION.
       SOURCE-COMPUTER.       L1000V.
      *SOURCE-COMPUTER.       L1000V   WITH DEBUGGING MODE.
       OBJECT-COMPUTER.       RP5470.
       INPUT-OUTPUT           SECTION.
       FILE-CONTROL.
      ******************************************************************
      *
      *                 デ  ー  タ  部
      *
      ******************************************************************
       DATA                   DIVISION.
      ******************************************************************
      *                 作業場所節
      ******************************************************************
       WORKING-STORAGE        SECTION.
       01  IDNAME                  PIC  X(80)  VALUE
       "$Id$".
      ******************************************************************
      *                 コンスタント  エリア
      ******************************************************************
      *---------- 共通コンスタント定義の宣言
       01  CONSTANT-AREA.
         05  CNS-SCZY-PFCM.
             COPY "SCZY_PFCM.cpy".
         05  CNS-MZCNS.
             COPY "MZCNS.cpy".
      *---------- プログラム名
         05  CNS-PGM-ID            PIC  X(08)  VALUE  "MMZJ4010".
      *---------- システムエラー
         05  CNS-RTN-0             PIC  X(01)  VALUE  "0".
         05  CNS-RTN-9             PIC  X(01)  VALUE  "9".
      *---------- 取引差分更新管理（TKMZSK00）
         05  CNS-TBL-TKMZSK00      PIC  X(08)  VALUE  "TKMZSK00".
      *---------- 基準日断面情報（TKMZBW02）
         05  CNS-TBL-TKMZBW02      PIC  X(08)  VALUE  "TKMZBW02".
      *---------- 銘柄別断面情報（TKMZBW03）
         05  CNS-TBL-TKMZBW03      PIC  X(08)  VALUE  "TKMZBW03".
      *---------- 対象取引情報（TKMZBW04）
         05  CNS-TBL-TKMZBW04      PIC  X(08)  VALUE  "TKMZBW04".
      *---------- 対象資金取引情報（TKMZBW05）
         05  CNS-TBL-TKMZBW05      PIC  X(08)  VALUE  "TKMZBW05".
      *---------- 残高異動計算データ（TKMZBW06）
         05  CNS-TBL-TKMZBW06      PIC  X(08)  VALUE  "TKMZBW06".
      *---------- 実行状況管理明細（TKDYAA35）
         05  CNS-TBL-TKDYAA35      PIC  X(08)  VALUE  "TKDYAA35".
      *---------- 取引（TKMXTR00）
         05  CNS-TBL-TKMXTR00      PIC  X(08)  VALUE  "TKMXTR00".
      *---------- 相対取引（TKMXTR01）
         05  CNS-TBL-TKMXTR01      PIC  X(08)  VALUE  "TKMXTR01".
      *---------- 処理資金取引（TKMZBW18）
         05  CNS-TBL-TKMZBW18      PIC  X(08)  VALUE  "TKMZBW18".
      *---------- 残高異動（TKMZZI00）
         05  CNS-TBL-TKMZZI00      PIC  X(08)  VALUE  "TKMZZI00".
      *---------- 残高履歴（TKMZZR00）
         05  CNS-TBL-TKMZZR00      PIC  X(08)  VALUE  "TKMZZR00".
      *---------- 商品属性（TKCMSZ00）
         05  CNS-TBL-TKCMSZ00      PIC  X(08)  VALUE  "TKCMSZ00".
      *---------- 資金残履歴（TKMZSR00）
         05  CNS-TBL-TKMZSR00      PIC  X(08)  VALUE  "TKMZSR00".
      *---------- 再処理要ポートフォリオ一覧（取引）
         05  CNS-TBL-TKDYGP12      PIC  X(08)  VALUE  "TKDYGP12".
      *---------- 再処理要ポートフォリオ一覧（銘柄属性）
         05  CNS-TBL-TKDYGP16      PIC  X(08)  VALUE  "TKDYGP16".
      *---------- 再処理要制御テーブル
         05  CNS-TBL-TKDYGP17      PIC  X(08)  VALUE  "TKDYGP17".
      *---------- 資金取引
         05  CNS-TBL-TKMXST00      PIC  X(08)  VALUE  "TKMXST00".
      *---------- 未収収益
         05  CNS-TBL-TKMZMS00      PIC  X(08)  VALUE  "TKMZMS00".
      *---------- 識別子
         05  CNS-TKMXTR00          PIC  X(08)  VALUE  "TKMXTR00".
         05  CNS-TKMZMS00          PIC  X(08)  VALUE  "TKMZMS00".
         05  CNS-TKMZKR00          PIC  X(08)  VALUE  "TKMZKR00".
         05  CNS-TKMZMB00          PIC  X(08)  VALUE  "TKMZMB00".
         05  CNS-TKMZZI00          PIC  X(08)  VALUE  "TKMZZI00".
         05  CNS-TKMZZR00          PIC  X(08)  VALUE  "TKMZZR00".
         05  CNS-TKMZGZ00          PIC  X(08)  VALUE  "TKMZGZ00".
         05  CNS-TKMZSI00          PIC  X(08)  VALUE  "TKMZSI00".
         05  CNS-TKMZSR00          PIC  X(08)  VALUE  "TKMZSR00".
         05  CNS-TKMZKI00          PIC  X(08)  VALUE  "TKMZKI00".
         05  CNS-TKMZKZ00          PIC  X(08)  VALUE  "TKMZKZ00".
         05  CNS-TKMZKK00          PIC  X(08)  VALUE  "TKMZKK00".
         05  CNS-TKMXST00          PIC  X(08)  VALUE  "TKMXST00".
         05  CNS-TKDYGP12          PIC  X(08)  VALUE  "TKDYGP12".
         05  CNS-TKDYGP16          PIC  X(08)  VALUE  "TKDYGP16".
         05  CNS-TKDYGP17          PIC  X(08)  VALUE  "TKDYGP17".
      *---------- 対象処理
         05  CNS-SELECT            PIC  X(06)  VALUE  "SELECT".
         05  CNS-INSERT            PIC  X(06)  VALUE  "INSERT".
         05  CNS-UPDATE            PIC  X(06)  VALUE  "UPDATE".
      *---------- 約定日
         05  CNS-YKJ-YMD           PIC  X(07)  VALUE  "YKJ_YMD".
      *---------- 受渡日
         05  CNS-UKE-YMD           PIC  X(07)  VALUE  "UKE_YMD".
      *---------- ワークDB接続フラグ 0:接続して無い
         05  CNS-DB-CONNECT-FLG-0  PIC  X(01)  VALUE  "0".
      *---------- ワークDB接続フラグ 1:接続してる
         05  CNS-DB-CONNECT-FLG-1  PIC  X(01)  VALUE  "1".
      *---------- '2'(基準日断面削除)
         05  CNS-KJN-DMN-2         PIC  X(01)  VALUE  "2".
         05  CNS-0                 PIC  9(01)  VALUE  0.
         05  CNS-1                 PIC  9(01)  VALUE  1.
         05  CNS-X-1               PIC  X(01)  VALUE  "1".
         05  CNS-2                 PIC  9(01)  VALUE  2.
         05  CNS-X-0               PIC  X(01)  VALUE  "0".
         05  CNS-X-2               PIC  X(01)  VALUE  "2".
         05  CNS-X-7               PIC  X(01)  VALUE  "7".
         05  CNS-X-8               PIC  X(01)  VALUE  "8".
         05  CNS-X-9               PIC  X(01)  VALUE  "9".
         05  CNS-X-07              PIC  X(02)  VALUE  "07".
         05  CNS-3                 PIC  9(01)  VALUE  3.
         05  CNS-4                 PIC  9(01)  VALUE  4.
         05  CNS-99                PIC  X(02)  VALUE  "99".
         05  CNS-200               PIC  9(03)  VALUE  200.
         05  CNS-250               PIC  9(03)  VALUE  250.
         05  CNS-50000             PIC  9(05)  VALUE  50000.
         05  CNS-X-4999            PIC  X(04)  VALUE  "4999".
         05  CNS-RTN-100           PIC  X(03)  VALUE  "100".
      *---------- 処理順序
         05  CNS-SYRI-JUN-5        PIC  X(01)  VALUE  "5".
         05  CNS-SYRI-JUN-6        PIC  X(01)  VALUE  "6".
         05  CNS-SYRI-JUN-7        PIC  X(01)  VALUE  "7".
         05  CNS-SYRI-JUN-8        PIC  X(01)  VALUE  "8".
      *---------- 引数個数
         05  CNS-5                 PIC  9(01)  VALUE  5.
      *---------- 画面アクション区分
         05  CNS-GAMEN-ACT-KBN-9   PIC  X(01)  VALUE  "9".
      *----------  約定ベース受渡順フラグ
         05  CNS-YKJ-0             PIC  X(01)  VALUE  "0".
         05  CNS-YKJ-1             PIC  X(01)  VALUE  "1".
      *----------  赤黒区分
         05  CNS-AKA-KBN-1         PIC  X(01)  VALUE  "1".
         05  CNS-AKA-KBN-9         PIC  X(01)  VALUE  "9".
      *---------- 基準日
         05  CNS-KJN-YMD-100       PIC  X(03)  VALUE  "100".
         05  CNS-KJN-YMD-200       PIC  X(03)  VALUE  "200".
         05  CNS-KJN-YMD-270       PIC  X(03)  VALUE  "270".
         05  CNS-KJN-YMD-275       PIC  X(03)  VALUE  "275".
         05  CNS-KJN-YMD-400       PIC  X(03)  VALUE  "400".
         05  CNS-KJN-YMD-500       PIC  X(03)  VALUE  "500".
         05  CNS-KJN-YMD-000       PIC  X(03)  VALUE  "000".
      *---------- ワーク明細単位実行ステータス
         05  CNS-MT-JS-100         PIC  X(03)  VALUE  "100".
         05  CNS-MT-JS-150         PIC  X(03)  VALUE  "150".
         05  CNS-MT-JS-200         PIC  X(03)  VALUE  "200".
         05  CNS-MT-JS-270         PIC  X(03)  VALUE  "270".
         05  CNS-MT-JS-275         PIC  X(03)  VALUE  "275".
         05  CNS-MT-JS-400         PIC  X(03)  VALUE  "400".
      *---------- 進捗ステータス
         05  CNS-JIKOU-STS-600     PIC  X(03)  VALUE  "600".
      *---------- ワークエラー区分
         05  CNS-ERR-KBN-01        PIC  X(02)  VALUE  "01".
         05  CNS-ERR-KBN-02        PIC  X(02)  VALUE  "02".
         05  CNS-ERR-KBN-03        PIC  X(02)  VALUE  "03".
         05  CNS-ERR-KBN-04        PIC  X(02)  VALUE  "04".
      *---------- 続行可能区分
         05  CNS-CONTINUE-KBN-1    PIC  X(01)  VALUE  "1".
         05  CNS-CONTINUE-KBN-2    PIC  X(01)  VALUE  "2".
         05  CNS-CONTINUE-KBN-3    PIC  X(01)  VALUE  "3".
      *---------- ワーク更新区分
         05  CNS-UPDATE-KBN-0      PIC  X(01)  VALUE  "0".
      *---------- 残高履歴作成区分: '1'(作成する)
         05  CNS-ZN-RIRK-SK-KBN-1  PIC  X(01)  VALUE  "1".
      *---------- 権限チェック有無
         05  CNS-KGN-CHK-UMU-1     PIC  X(01)  VALUE  "1".
      *---------- 日中夜間区分
         05  CNS-NCHU-YAKN-KBN-0   PIC  X(01)  VALUE  "0".
      *---------- ワーク残高計算フラグ
         05  CNS-ZN-CALC-FLG-1     PIC  X(01)  VALUE  "1".
      *---------- 基準日別更新区分
         05  CNS-KJB-KOUSIN-KBN-0  PIC  X(01)  VALUE  "0".
      *----------  決算日断面区分
         05  CNS-KSN-YMD-DMN-KBN-1 PIC  X(01)  VALUE  "1".
         05  CNS-KSN-YMD-DMN-KBN-2 PIC  X(01)  VALUE  "2".
      *---------- 順番
         05  CNS-JUNBAN-1          PIC  9(01)  VALUE  1.
      *---------- 開始基準日断面存在フラグ
         05  CNS-KJ-DMN-0          PIC  X(01)  VALUE  "0".
         05  CNS-KJ-DMN-1          PIC  X(01)  VALUE  "1".
      *---------- オール指定
         05  CNS-ALL-1             PIC  X(01)  VALUE  "1".
         05  CNS-ALL-2             PIC  X(01)  VALUE  "2".
      *---------- ポートフォリオ個別指定
         05  CNS-PF-FLG-2          PIC  X(01)  VALUE  "2".
      *---------- 基本会計ベースフラグ
         05  CNS-KH-KK-BASE-FLG-1  PIC  X(01)  VALUE  "1".
         05  CNS-KH-KK-BASE-FLG-2  PIC  X(01)  VALUE  "2".
      *---------- セッション区分 '0':先頭セッション
         05  CNS-SESSION-KBN-0     PIC  X(01)  VALUE  "0".
      *---------- セッション区分 '1':最終セッション
         05  CNS-SESSION-KBN-1     PIC  X(01)  VALUE  "1".
      *---------- 国内外国区分  '0'( 国内)
         05  CNS-NAI-GAI-KBN-0     PIC  X(01)  VALUE  "0".
      *---------- 国内外国区分  '1' (海外)
         05  CNS-NAI-GAI-KBN-1     PIC  X(01)  VALUE  "1".
      *---------- ワーク乗算/除算区分
         05  CNS-JZ-JS-KBN-1       PIC  X(01)  VALUE  "1".
      *---------- 続行可能区分
         05  CNS-CONTINUE-KBN-0    PIC  X(01)  VALUE  "0".
      *---------- 日次評価法フラグ
         05  CNS-NITIJI-HYK-FLG-0  PIC  X(01)  VALUE  "0".
         05  CNS-NITIJI-HYK-FLG-1  PIC  X(01)  VALUE  "1".
      *---------- 再計算区分
         05  CNS-SAI-CALC-KBN-1    PIC  X(01)  VALUE  "1".
         05  CNS-SAI-CALC-KBN-2    PIC  X(01)  VALUE  "2".
      *---------- 処理順
         05  CNS-SRJUN-1           PIC  9(01)  VALUE  1.
         05  CNS-DATA-FLG-1        PIC  9(01)  VALUE  1.
      *---------- 銘柄種類
         05  CNS-MEG-CD-SHRU-1     PIC  X(01)  VALUE  "1".
         05  CNS-MEG-CD-SHRU-2     PIC  X(01)  VALUE  "2".
         05  CNS-MEG-CD-SHRU-3     PIC  X(01)  VALUE  "3".
      *---------- キャッシュフロー2回有効フラグ
         05  CNS-CASH-FLOW-2-FLG-1 PIC  X(01)  VALUE  "1".
         05  CNS-CASH-FLOW-2-FLG-2 PIC  X(01)  VALUE  "2".
      *---------- SPP/バッチ起動区分
         05  CNS-KIDOU-KBN-B       PIC  X(01)  VALUE  "B".
      *---------- 仕訳基準パターンコード
         05  CNS-SWK-KJN-PTN-CD-0  PIC  X(01)  VALUE  "0".
      *---------- ワーク銘柄属性取得フラグ
         05  CNS-MEG-ZOK-0         PIC  X(01)  VALUE  "0".
         05  CNS-MEG-ZOK-1         PIC  X(01)  VALUE  "1".
      *---------- 増減区分
         05  CNS-ZG-KBN-2          PIC  X(01)  VALUE  "2".
      *---------- ワーク銘柄属性取得区分
         05  CNS-MEG-ZKSE-SYUTK-0  PIC  X(01)  VALUE  "0".
         05  CNS-MEG-ZKSE-SYUTK-1  PIC  X(01)  VALUE  "1".
      *---------- ユーロ円債区分
         05  CNS-EURO-BOND-KBN-0   PIC  X(01)  VALUE  "0".
      *---------- ワーク売り続く証券種別区分
         05  CNS-BUY-SEC-SBT-KBN   PIC  X(01)  VALUE  "1".
      *---------- 証券種別コード
         05  CNS-X-NCD             PIC  X(04)  VALUE  "NCD ".
         05  CNS-X-XMOC            PIC  X(04)  VALUE  "XMOC".
      *  05  CNS-X-FDAL            PIC  X(04)  VALUE  "FDAL".
         05  CNS-X-GEN             PIC  X(04)  VALUE  "GEN ".
         05  CNS-X-GNS             PIC  X(04)  VALUE  "GNS ".
         05  CNS-X-CALL            PIC  X(04)  VALUE  "CALL".
         05  CNS-X-DA              PIC  X(04)  VALUE  "DA  ".
         05  CNS-X-CASH            PIC  X(04)  VALUE  "CASH".
         05  CNS-X-MAR             PIC  X(04)  VALUE  "MAR ".
         05  CNS-X-MABF            PIC  X(04)  VALUE  "MABF".
         05  CNS-X-MABO            PIC  X(04)  VALUE  "MABO".
         05  CNS-X-MAB             PIC  X(04)  VALUE  "MAB ".
         05  CNS-X-MAFB            PIC  X(04)  VALUE  "MAFB".
         05  CNS-X-MASF            PIC  X(04)  VALUE  "MASF".
         05  CNS-X-MASO            PIC  X(04)  VALUE  "MASO".
         05  CNS-X-MAS             PIC  X(04)  VALUE  "MAS ".
         05  CNS-X-MAFS            PIC  X(04)  VALUE  "MAFS".
         05  CNS-X-DSMS            PIC  X(04)  VALUE  "DSMS".
         05  CNS-X-DBMS            PIC  X(04)  VALUE  "DBMS".
         05  CNS-X-ETDB            PIC  X(04)  VALUE  "ETDB".
         05  CNS-X-ETDS            PIC  X(04)  VALUE  "ETDS".
         05  CNS-X-ETDC            PIC  X(04)  VALUE  "ETDC".
         05  CNS-X-ITDB            PIC  X(04)  VALUE  "ITDB".
         05  CNS-X-ITDS            PIC  X(04)  VALUE  "ITDS".
         05  CNS-X-ITDC            PIC  X(04)  VALUE  "ITDC".
         05  CNS-X-FSMS            PIC  X(04)  VALUE  "FSMS".
         05  CNS-X-FBMS            PIC  X(04)  VALUE  "FBMS".
         05  CNS-X-ETFS            PIC  X(04)  VALUE  "ETFS".
         05  CNS-X-ETFB            PIC  X(04)  VALUE  "ETFB".
         05  CNS-X-ETF             PIC  X(04)  VALUE  "ETF ".
         05  CNS-X-ITFS            PIC  X(04)  VALUE  "ITFS".
         05  CNS-X-ITFB            PIC  X(04)  VALUE  "ITFB".
         05  CNS-X-ITF             PIC  X(04)  VALUE  "ITF ".
         05  CNS-X-B               PIC  X(04)  VALUE  "B   ".
         05  CNS-X-CB              PIC  X(04)  VALUE  "CB  ".
         05  CNS-X-WB              PIC  X(04)  VALUE  "WB  ".
         05  CNS-X-CBMS            PIC  X(04)  VALUE  "CBMS".
      *---------- 仮払金増加の取引存在フラグ
         05  CNS-SPLU-TORI-FLG     PIC  9(01)  VALUE  1.
      *---------- M01:項目名$のチェックが不正です
         05  CNS-MSG-E000369       PIC  X(07)  VALUE  "E000369".
      *---------- M02:$項目$が残っています
         05  CNS-MSG-W000551       PIC  X(07)  VALUE  "W000551".
      *---------- M03:指定From日が不正のため、残高未反映の取引があります。
         05  CNS-MSG-W000554       PIC  X(07)  VALUE  "W000554".
      *---------- M04:指定した$程度$計算期間は確定済です
         05  CNS-MSG-W000412       PIC  X(07)  VALUE  "W000412".
      *---------- M05:項目名A$は$項目名B$を越えています
         05  CNS-MSG-W000454       PIC  X(07)  VALUE  "W000454".
      *---------- M06:項目名A$と$項目名A$の不一致が発生しました
         05  CNS-MSG-W000455       PIC  X(07)  VALUE  "W000455".
      *---------- M08:[$項目名$]データがなし
         05  CNS-MSG-E000429       PIC  X(07)  VALUE  "E000429".
      *---------- M09:指定したデータが既に存在しています
         05  CNS-MSG-E000091       PIC  X(07)  VALUE  "E000091".
      *---------- M10:$項目名$の取得可能の件数は$件数$件超過した
         05  CNS-MSG-E000445       PIC  X(07)  VALUE  "E000445".
      *---------- M11:データA$と$データB$の整合性は取っていません
         05  CNS-MSG-E000524       PIC  X(07)  VALUE  "E000524".
      *---------- M12:勘定科目が存在しないため、集計勘定科目で出力しました
         05  CNS-MSG-W000563       PIC  X(07)  VALUE  "W000563".
      *---------- M13:$項目名$は処理対象外です
         05  CNS-MSG-E000612       PIC  X(07)  VALUE  "E000612".
      *---------- M14:$項目$がバランスしていません
         05  CNS-MSG-W000562       PIC  X(07)  VALUE  "W000562".
      *---------- M16:利金入金の数量が債券の利付数量より多いです
         05  CNS-MSG-W000486       PIC  X(07)  VALUE  "W000486".
      *---------- M17:利金入金の時、債券の利付数量が赤残です
         05  CNS-MSG-W000487       PIC  X(07)  VALUE  "W000487".
      *---------- M18:ジョブが一時停止になりました
         05  CNS-MSG-E000451       PIC  X(07)  VALUE  "E000451".
      *---------- M19:ジョブが強制終了になりました
         05  CNS-MSG-E000431       PIC  X(07)  VALUE  "E000431".
      *---------- M20:$項目$が取得できません
         05  CNS-MSG-E000217       PIC  X(07)  VALUE  "E000217".
      *---------- M21:ポートフォリオ別データ抽出件数超過50000件
         05  CNS-MSG-W000309       PIC  X(07)  VALUE  "W000309".
      *---------- M23:同時に稼動した処理があるため処理が行えませんでした
         05  CNS-MSG-W000522       PIC  X(07)  VALUE  "W000522".
      *---------- M24:銘柄$銘柄コード$の属性情報が一部取得できません
         05  CNS-MSG-E000526       PIC  X(07)  VALUE  "E000526".
      *---------- M25:銘柄$銘柄コード$の属性情報が存在しません
         05  CNS-MSG-E000525       PIC  X(07)  VALUE  "E000525".
      *---------- M26:銘柄情報不足のため、銘柄は特定できません
         05  CNS-MSG-E000352       PIC  X(07)  VALUE  "E000352".
      *---------- M29:数量0で$項目名$が残っており、不整合が発生しています。
         05  CNS-MSG-E000593       PIC  X(07)  VALUE  "E000593".
      *---------- M30:数量と$項目名A$の符号が逆になるため、処理できません
         05  CNS-MSG-E000574       PIC  X(07)  VALUE  "E000574".
      *---------- M31:$項目名A$が赤になるため、処理できません
         05  CNS-MSG-E000575       PIC  X(07)  VALUE  "E000575".
      *---------- M32:前払金の片方がゼロになるため、処理できません
         05  CNS-MSG-E000576       PIC  X(07)  VALUE  "E000576".
      *---------- M33:不正な取引。既に利落ち取引が計上されています。（$項目$）
         05  CNS-MSG-E000582       PIC  X(07)  VALUE  "E000582".
      *---------- M34:「$項目名$は未登録のため、処理できません。
         05  CNS-MSG-E000580       PIC  X(07)  VALUE  "E000580".
      *---------- M35:[$項目名$]データがありません。
         05  CNS-MSG-W000510       PIC  X(07)  VALUE  "W000510".
      *---------- M36:利用権限のないポートフォリオは処理しませんでした
         05  CNS-MSG-E000534       PIC  X(07)  VALUE  "E000534".
      *---------- M37:戻入の金額が評価損益計上額を超えていて全額戻入しきれません
         05  CNS-MSG-W900142       PIC  X(07)  VALUE  "W900142".
      *---------- M38:戻入しようとしたら、戻入の対象となるデータがいません
         05  CNS-MSG-E900143       PIC  X(07)  VALUE  "E900143".
      *---------- M39:指定From日より前の取引も処理対象になっています
         05  CNS-MSG-E000611       PIC  X(07)  VALUE  "E000611".
      *---------- M40:指示処理が一時/強制終了になりました
         05  CNS-MSG-E000604       PIC  X(07)  VALUE  "E000604".
      *---------- M41:$項目名$がマイナスです
         05  CNS-MSG-W000655       PIC  X(07)  VALUE  "W000655".
      *---------- 'E000130'（$項目名$の入力値が不正です。）
         05  CNS-MSG-E000130       PIC  X(07)  VALUE  "E000130".
      *---------- 'W000669'（$日付$から指定FROM日間未処理です。）
         05  CNS-MSG-W000669       PIC  X(07)  VALUE  "W000669".
      *---------- 'E000430'（$項目名$は$項目$以内で入力して下さい。）
         05  CNS-MSG-E000430       PIC  X(07)  VALUE  "E000430".
      *---------- 置換文字
         05  CNS-TK-MOJI-1         PIC  X(18)  VALUE
                                                   "取引集約の異動数量".
         05  CNS-TK-MOJI-2         PIC  X(14)  VALUE  "異動後数量残高".
         05  CNS-TK-MOJI-4         PIC  X(04)  VALUE  "全部".
         05  CNS-TK-MOJI-5         PIC  X(04)  VALUE  "一部".
         05  CNS-TK-MOJI-8         PIC  X(22)  VALUE
                                               "指定From日より前の取引".
         05  CNS-TK-MOJI-9         PIC  X(30)  VALUE
                                  "約定レートあり決済未入力データ".
         05  CNS-TK-MOJI-10        PIC  X(22)  VALUE
                                               "約定レート未入力データ".
         05  CNS-TK-MOJI-11        PIC  X(26)  VALUE
                                           "経過利息レート未入力データ".
         05  CNS-TK-MOJI-42        PIC  X(24)  VALUE
                                   "マイナス経過利息の仮払金".
         05  CNS-TK-MOJI-43        PIC  X(18)  VALUE
                                                   "源泉税還付金入金額".
         05  CNS-TK-MOJI-44        PIC  X(06)  VALUE  "予定額".
         05  CNS-TK-MOJI-45        PIC  X(08)  VALUE  "数量残高".
         05  CNS-TK-MOJI-46        PIC  X(08)  VALUE  "簿価残高".
         05  CNS-TK-MOJI-47        PIC  X(22)  VALUE
                                               "市場通貨異動後CASH残高".
         05  CNS-TK-MOJI-48        PIC  X(22)  VALUE
                                               "運用通貨異動後CASH残高".
         05  CNS-TK-MOJI-49        PIC  X(20)  VALUE
                                                 "変更日の対象未収収益".
         05  CNS-TK-MOJI-50        PIC  X(08)  VALUE  "対応取引".
         05  CNS-TK-MOJI-51        PIC  X(16)  VALUE
                                                     "入金日の対象引落".
         05  CNS-TK-MOJI-52        PIC  X(22)  VALUE
                                               "権利落日の対象配当情報".
         05  CNS-TK-MOJI-53        PIC  X(08)  VALUE  "配当情報".
         05  CNS-TK-MOJI-54        PIC  X(03)  VALUE  "500".
         05  CNS-TK-MOJI-58        PIC  X(18)  VALUE
                                               "残高・損益更新画面".
         05  CNS-TK-MOJI-59        PIC  X(18)  VALUE
                                               "対象ポートフォリオ".
         05  CNS-TK-MOJI-60        PIC  X(30)  VALUE
                                       "処理対象実行状況管理明細データ".
         05  CNS-TK-MOJI-61        PIC  X(10)  VALUE
                                       "対象前払金".
         05  CNS-TK-MOJI-76        PIC  X(26)  VALUE
                                       "CB転換・ワラント行使の関連".
         05  CNS-TK-MOJI-64        PIC  X(08)  VALUE  "勘定残高".
         05  CNS-TK-MOJI-65        PIC  X(14)  VALUE  "処理対象前払金".
         05  CNS-TK-MOJI-69        PIC  X(14)  VALUE
                                             "市場通貨前払金".
         05  CNS-TK-MOJI-70        PIC  X(14)  VALUE
                                             "運用通貨前払金".
         05  CNS-TK-MOJI-71        PIC  X(24)  VALUE
                                             "ポートフォリオの対象履歴".
         05  CNS-TK-MOJI-72        PIC  X(10)  VALUE   "前払金数量".
         05  CNS-TK-MOJI-73        PIC  X(22)  VALUE
                                               "証拠金の銘柄ｺｰﾄﾞﾘﾌｧﾚﾝｽ".
         05  CNS-TK-MOJI-74        PIC  X(16)  VALUE "異動計算パターン".
         05  CNS-TK-MOJI-75        PIC  X(10)  VALUE   "前払金残高".
         05  CNS-TK-MOJI-77        PIC  X(12)  VALUE   "為替換算情報".
         05  CNS-TK-MOJI-78        PIC  X(18)  VALUE
                                               "取引の経過利息区分".
         05  CNS-TK-MOJI-79        PIC  X(08)  VALUE   "銘柄属性".
         05  CNS-TK-MOJI-80        PIC  X(18)  VALUE
                                               "勘定異動／残高作成".
         05  CNS-TK-MOJI-81        PIC  X(18)  VALUE
                                               "簿価金額(市場通貨)".
         05  CNS-TK-MOJI-82        PIC  X(18)  VALUE
                                               "簿価金額(運用通貨)".
         05  CNS-TK-MOJI-83        PIC  X(16)  VALUE
                                               "処理対象断面期間".
         05  CNS-TK-MOJI-84        PIC  X(06)  VALUE   "13ヶ月".
         05  CNS-MSG-1             PIC  X(09)  VALUE   "証券種別:".
         05  CNS-MSG-2             PIC  X(09)  VALUE   "銘柄通貨:".
         05  CNS-MSG-3             PIC  X(09)  VALUE   "発行体国:".
         05  CNS-MSG-4             PIC  X(11)  VALUE   "投資対象国:".
         05  CNS-MSG-5             PIC  X(09)  VALUE   "株式種別:".
         05  CNS-MSG-6             PIC  X(03)  VALUE   "回:".
         05  CNS-MSG-7             PIC  X(03)  VALUE   "号:".
         05  CNS-MSG-8             PIC  X(05)  VALUE   "限月:".
         05  CNS-MSG-9             PIC  X(19)  VALUE
                                                 "ストライクプライス:".
         05  CNS-MSG-10            PIC  X(07)  VALUE   "満期日:".
         05  CNS-MSG-11            PIC  X(34)  VALUE
                                   "取得不可項目：ファクター・連動係数".
         05  CNS-MSG-12            PIC  X(09)  VALUE
                                                       "原取引ID:".
         05  CNS-MSG-13            PIC  X(07)  VALUE   "基準日:".
         05  CNS-MSG-14            PIC  X(05)  VALUE   "銘柄:".
         05  CNS-MSG-15            PIC  X(09)  VALUE   "証券種別:".
         05  CNS-MSG-16            PIC  X(09)  VALUE   "銘柄通貨:".
         05  CNS-MSG-17            PIC  X(09)  VALUE   "発行体国:".
         05  CNS-MSG-18            PIC  X(11)  VALUE   "投資対象国:".
         05  CNS-MSG-19            PIC  X(09)  VALUE   "銘柄特定:".
         05  CNS-MSG-20            PIC  X(15)  VALUE
                                                      "決算日断面区分:".
         05  CNS-MSG-21            PIC  X(06)  VALUE   "決算前".
         05  CNS-MSG-22            PIC  X(06)  VALUE   "決算後".
         05  CNS-MSG-25            PIC  X(25)  VALUE
                                         "資産負債・買建売建フラグ:".
         05  CNS-MSG-26            PIC  X(05)  VALUE   "玉ID:".
         05  CNS-MSG-27            PIC  X(11)  VALUE   "開始基準日:".
         05  CNS-MSG-28            PIC  X(07)  VALUE   "基準日:".
         05  CNS-MSG-29            PIC  X(15)  VALUE "ファンドコード:".
         05  CNS-MSG-30            PIC  X(21)
                                         VALUE "ポートフォリオコード:".
         05  CNS-MSG-37            PIC  X(18)  VALUE
                                                 "取得不可項目：利率".
         05  CNS-MSG-38            PIC  X(09)  VALUE   "保有目的:".
         05  CNS-MSG-40            PIC  X(09)  VALUE   "原取引ID:".
         05  CNS-MSG-41            PIC  X(07)  VALUE   "計上日:".
         05  CNS-MSG-42            PIC  X(05)  VALUE   "赤黒:".
         05  CNS-MSG-43            PIC  X(07)  VALUE   "基準日:".
         05  CNS-MSG-44            PIC  X(05)  VALUE   "証種:".
         05  CNS-MSG-45            PIC  X(05)  VALUE   "銘柄:".
         05  CNS-MSG-46            PIC  X(05)  VALUE   "銘通:".
         05  CNS-MSG-47            PIC  X(05)  VALUE   "発国:".
         05  CNS-MSG-48            PIC  X(05)  VALUE   "投国:".
         05  CNS-MSG-49            PIC  X(09)  VALUE   "銘柄特定:".
         05  CNS-MSG-50            PIC  X(01)  VALUE   "/".
         05  CNS-MSG-51            PIC  X(07)  VALUE   "Ｌ／Ｓ:".
         05  CNS-MSG-52            PIC  X(05)  VALUE   "玉ID:".
         05  CNS-MSG-53            PIC  X(09)  VALUE   "資金種別:".
         05  CNS-MSG-54            PIC  X(07)  VALUE   "異動日:".
         05  CNS-MSG-55            PIC  X(09)  VALUE   "増減区分:".
         05  CNS-MSG-56            PIC  X(26)  VALUE
                                           "利払日の銘柄属性は取得不可".
         05  CNS-MSG-57            PIC  X(09)  VALUE
                                   "証券種別:".
         05  CNS-MSG-58            PIC  X(05)  VALUE
                                   "銘柄:".
         05  CNS-MSG-59            PIC  X(15)  VALUE
                                  "資産負債フラグ:".
         05  CNS-MSG-60            PIC  X(07)  VALUE
                                   "玉ＩＤ:".
         05  CNS-MSG-61            PIC  X(09)  VALUE
                                   "市場通貨:".
         05  CNS-MSG-62            PIC  X(07)  VALUE
                                   "計上日:".
         05  CNS-MEG-NAME-J        PIC  X(60)  VALUE
         "仮登録銘柄                                                  ".
         05  CNS-SQL-MSG-SELECT    PIC  X(17)  VALUE
                                               " SQL-MSG(SELECT):".
         05  CNS-SQL-MSG-UPDATE    PIC  X(17)  VALUE
                                               " SQL-MSG(UPDATE):".
      *---------- 警告フラグ : 1
         05  CNS-WARN-FLG-1        PIC  X(01)  VALUE  "1".
      *---------- 警告フラグ : G1
         05  CNS-G1                PIC  X(02)  VALUE  "G1".
      *---------- 警告フラグ : G2
         05  CNS-G2                PIC  X(02)  VALUE  "G2".
      *---------- 警告フラグ : F1
         05  CNS-F1                PIC  X(02)  VALUE  "F1".
      *---------- 警告フラグ : F2
         05  CNS-F2                PIC  X(02)  VALUE  "F2".
      *---------- 警告フラグ : F3
         05  CNS-F3                PIC  X(02)  VALUE  "F3".
      *---------- 警告フラグ : D3
         05  CNS-D3                PIC  X(02)  VALUE  "D3".
      *---------- 警告フラグ : D2
         05  CNS-D2                PIC  X(02)  VALUE  "D2".
      *---------- 警告フラグ : D1
         05  CNS-D1                PIC  X(02)  VALUE  "D1".
      *---------- 警告フラグ : M1
         05  CNS-M1                PIC  X(02)  VALUE  "M1".
      *---------- 警告フラグ : M2
         05  CNS-M2                PIC  X(02)  VALUE  "M2".
      *---------- 警告フラグ : M3
         05  CNS-M3                PIC  X(02)  VALUE  "M3".
      *---------- 警告フラグ : M4
         05  CNS-M4                PIC  X(02)  VALUE  "M4".
      *---------- 警告フラグ : M5
         05  CNS-M5                PIC  X(02)  VALUE  "M5".
      *---------- 警告フラグ : M6
         05  CNS-M6                PIC  X(02)  VALUE  "M6".
      *---------- 警告フラグ : M7
         05  CNS-M7                PIC  X(02)  VALUE  "M7".
      *---------- 警告フラグ : N1
         05  CNS-N1                PIC  X(02)  VALUE  "N1".
      *---------- 警告フラグ : M8
         05  CNS-M8                PIC  X(02)  VALUE  "M8".
      *---------- 警告フラグ : M9
         05  CNS-M9                PIC  X(02)  VALUE  "M9".
      *---------- 警告フラグ : MA
         05  CNS-MA                PIC  X(02)  VALUE  "MA".
      *---------- 警告フラグ : MB
         05  CNS-MB                PIC  X(02)  VALUE  "MB".
      *---------- 警告フラグ : MC
         05  CNS-MC                PIC  X(02)  VALUE  "MC".
      *---------- 警告フラグ : MD
         05  CNS-MD                PIC  X(02)  VALUE  "MD".
      *---------- 警告フラグ : L1
         05  CNS-L1                PIC  X(02)  VALUE  "L1".
      *---------- 警告フラグ : CNS-N2
         05  CNS-N2                PIC  X(02)  VALUE  "N2".
         05  CNS-WANR-FLG-0        PIC  X(01)  VALUE  "0".
      *---------- 売り続く限り同一コスト
         05  CNS-UTK-SAME-COST-1   PIC  X(01)  VALUE  "1".
      *---------- 売買フラグ
         05  CNS-FLG-URIKAI-1      PIC  X(01)  VALUE  "1".
         05  CNS-FLG-URIKAI-2      PIC  X(01)  VALUE  "2".
      *----------  ワーク売り続く限りフラグ
         05  CNS-UTK-KAGI-FLG-0    PIC  X(01)  VALUE  "0".
         05  CNS-UTK-KAGI-FLG-1    PIC  X(01)  VALUE  "1".
      *----------  同一コスト継続フラグ
         05  CNS-SCK-FLG-0         PIC  X(01)  VALUE  "0".
         05  CNS-SCK-FLG-1         PIC  X(01)  VALUE  "1".
      *----------  ユーザ入力データあるフラグ
         05  CNS-USER-IN-FLG       PIC  9(01)  VALUE  1.
      *----------  判定対象区分
         05  CNS-HTEI-TGT-KBN-6    PIC  X(01)  VALUE  "6".
         05  CNS-HTEI-TGT-KBN-A    PIC  X(01)  VALUE  "a".
      *---------- 基準日種類
         05  CNS-KJN-YMD-SHRU-4    PIC  X(01)  VALUE  "4".
         05  CNS-KJN-YMD-SHRU-5    PIC  X(01)  VALUE  "5".
      *---------- BT戻り値
         05  CNS-RTN-BT6           PIC  9(02)  VALUE  6.
         05  CNS-RTN-BT10          PIC  9(02)  VALUE  10.
         05  CNS-RTN-113           PIC  X(03)  VALUE  "113".
         05  CNS-500               PIC  9(03)  VALUE  500.
         05  CNS-10                PIC  9(02)  VALUE  10.
         05  CNS-RTN-111           PIC  X(03)  VALUE  "111".
      *---------- テーブル・ファイル数
         05  CNS-16                PIC  9(02)  VALUE  16.
         05  CNS-C2                PIC  X(01)  VALUE  "2".
         05  CNS-IXCAL-FUNCTION-3  PIC  X(01)  VALUE  "3".
         05  CNS-IXCAL-FUNCTION-5  PIC  X(01)  VALUE  "5".
         05  CNS-IXCAL-ZENGO-KBN-1-0
                                   PIC  X(01)  VALUE  "0".
         05  CNS-IXCAL-ZENGO-KBN-1-1
                                   PIC  X(01)  VALUE  "1".
         05  CNS-IXCAL-ZENGO-KBN-1-2
                                   PIC  X(01)  VALUE  "2".
         05  CNS-IXCAL-TANI-KBN-1  PIC  X(01)  VALUE  "1".
         05  CNS-IXCAL-TANI-KBN-2  PIC  X(01)  VALUE  "2".
         05  CNS-SBN-CALC-FROM-YKJ PIC  X(47)  VALUE
                      " AND SBN_CALC_FROM_YKJ <= :P_SBN_CALC_FROM_YKJ ".
         05  CNS-SBN-CALC-FROM-YKJ-Y
                                   PIC  X(27)  VALUE
                                     " AND SBN_CALC_FROM_YKJ <> 0".
         05  CNS-SBN-CALC-FROM-UKE PIC  X(47)  VALUE
                      " AND SBN_CALC_FROM_UKE <= :P_SBN_CALC_FROM_UKE ".
         05  CNS-SBN-CALC-FROM-UKE-Y
                                   PIC  X(27)  VALUE
                                     " AND SBN_CALC_FROM_UKE <> 0".
         05  CNS-SBN-CALC-FROM-YKJ-X
                                   PIC  X(26)  VALUE
                                           " AND SBN_CALC_FROM_YKJ <= ".
         05  CNS-SBN-CALC-FROM-UKE-X
                                   PIC  X(26)  VALUE
                                           " AND SBN_CALC_FROM_UKE <= ".
         05  CNS-SBN-CALC-FROM-ZERO
                                   PIC  X(31)  VALUE
                      " AND 0 <= :P_SBN_CALC_FROM_YKJ ".
         05  CNS-SBN-CALC-FROM-ZERO-X
                                   PIC  X(10)  VALUE  " AND 0 <= ".
      *---------- ORDER BY (別紙1-6 SQL)
         05  CNS-ODBY-SBN-CALC-FROM-YKJ
                                   PIC  X(27)  VALUE
                                   " ORDER BY SBN_CALC_FROM_YKJ".
         05  CNS-ODBY-SBN-CALC-FROM-UKE
                                   PIC  X(27)  VALUE
                                   " ORDER BY SBN_CALC_FROM_UKE".
      *---------- 計算ベース区分
         05  CNS-IXCAL-COMP-BASE   PIC  X(01)  VALUE  "1".
         05  CNS-RTN-112           PIC  X(03)  VALUE  "112".
         05  CNS-RTN-114           PIC  X(03)  VALUE  "114".
         05  CNS-MA99              PIC  X(04)  VALUE  "MA99".
         05  CNS-JPY               PIC  X(03)  VALUE  "JPY".
         05  CNS-JPN               PIC  X(03)  VALUE  "JPN".
         05  CNS-ALL9              PIC  S9(08)V9(10)
                                             VALUE  99999999.9999999999.
      ******************************************************************
      *                   フラグ  エリア
      ******************************************************************
       01  FLG-AREA.
      *---------- 基準日断面情報データFETCH終了フラグ
         05  FLG-FETCH-SYUURYOU    PIC  9(01).
      *---------- 銘柄別断面情報データFETCH終了フラグ
         05  FLG-FETCH-SYUURYOU2   PIC  9(01).
      *---------- 対象取引情報データFETCH終了フラグ
         05  FLG-FETCH-SYUURYOU3   PIC  9(01).
      *---------- 対象資金取引情報データFETCH終了フラグ
         05  FLG-FETCH-SYUURYOU4   PIC  9(01).
      *---------- 商品属性FETCH終了フラグ
         05  FLG-FETCH-TKCMSZ00    PIC  9(01).
      *---------- 取引差分更新管理データカーソルオープンフラグ
         05  FLG-TKMZSK00-CR-OPEN  PIC  9(01).
      *---------- 基準日断面情報データカーソルオープンフラグ
         05  FLG-TKMZBW02-CR-OPEN  PIC  9(01).
      *---------- 銘柄別断面情報カーソルオープンフラグ
         05  FLG-TKMZBW03-CR-OPEN  PIC  9(01).
      *---------- 対象取引情報カーソルオープンフラグ
         05  FLG-TKMZBW04-CR-OPEN  PIC  9(01).
      *---------- 対象資金取引情報カーソルオープンフラグ
         05  FLG-TKMZBW05-CR-OPEN  PIC  9(01).
      *---------- ポートフォリオコードカーソルオープンフラグ
         05  FLG-PTF-CR-OPEN       PIC  9(01).
      *---------- 取引（TKMXTR00）
         05  FLG-TKMXTR00-CR-OPEN  PIC  9(01).
      *---------- 処理資金取引（TKMZBW18）
         05  FLG-TKMZBW18-CR-OPEN  PIC  9(01).
      *---------- 残高履歴（TKMZZR00）
         05  FLG-TKMZZR00-CR-1-OPEN
                                   PIC  9(01).
      *---------- 商品属性（TKCMSZ00）
         05  FLG-TKCMSZ00-CR-OPEN  PIC  9(01).
      *---------- 資金残履歴（TKMZSR00）
         05  FLG-TKMZSR00-CR-OPEN  PIC  9(01).
      *---------- 再処理要制御（TKDYGP17）
         05  FLG-TKDYGP17-CR-OPEN  PIC  9(01).
      *---------- システムエラーフラグ
         05  FLG-SYSTEM-ERR        PIC  9(01).
      *---------- ポートフォリオ終了フラグ
         05  FLG-PTF               PIC  9(01).
      *---------- 検索終了フラグ
         05  FLG-SEARCH-END        PIC  9(01).
      *---------- ワーク銘柄属性取得フラグ
         05  FLG-MEG-ZOK           PIC  X(01).
      *---------- ワーク銘柄属性コールフラグ
         05  FLG-MEG-CALL          PIC  9(01).
      *---------- 売買フラグ
         05  FLG-URIKAI            PIC  X(01).
      *----------  残高異動カーソルオープンフラグ
         05  FLG-TKMZZI00-CR-1-OPEN
                                   PIC  9(01).
      *----------  残高異動計算データカーソルオープンフラグ
         05  FLG-TKMZBW06-CR-1-OPEN
                                   PIC  9(01).
      *----------  取引差分更新管理カーソルオープンフラグ
         05  FLG-TKMZSK00-CR-1-OPEN
                                   PIC  9(01).
      *----------  取引差分更新管理カーソルオープンフラグ               @3212SEINO@@
         05  FLG-TKMZSK00-CR-1-OPEN-1                                   @3212SEINO@@
                                   PIC  9(01).                          @3212SEINO@@
         05  FLG-TORI-UPD          PIC  9(01).
         05  FLG-SMZJ1910-160      PIC  9(01).
      *----------  FETCHオープンフラグ1                                 @3212SEINO@@
         05  FLG-OPEN-FLG-1        PIC  9(01).                          @3212SEINO@@
      *----------  FETCHオープンフラグ2                                 @3212SEINO@@
         05  FLG-OPEN-FLG-2        PIC  9(01).                          @3212SEINO@@
      *----------  FETCHオープンフラグ3                                 @3212SEINO@@
         05  FLG-OPEN-FLG-3        PIC  9(01).                          @3212SEINO@@
      *---------- 銘柄別断面情報カーソルオープンフラグ                  @3212SEINO@@
         05  FLG-TKMZBW03-CR1-OPEN PIC  9(01).                          @3212SEINO@@
         05  FLG-CHECK             PIC  9(01).
         05  FLG-OPEN-TKMZSR00     PIC  9(01).
         05  FLG-OPEN-TKMXST00     PIC  9(01).
         05  FLG-OPEN-TKMZMS00     PIC  9(01).
      ******************************************************************
      *                 ワ−ク  エリア
      ******************************************************************
       01  WORK-AREA.
      *---------- ワークテーブル取引差分更新管理
         05  WK-TBL-TKMZSK00       PIC  X(13).
      *---------- ワークテーブル基準日断面情報
         05  WK-TBL-TKMZBW02       PIC  X(13).
      *---------- ワークテーブル銘柄別断面情報
         05  WK-TBL-TKMZBW03       PIC  X(13).
      *---------- ワークテーブル対象取引情報
         05  WK-TBL-TKMZBW04       PIC  X(13).
      *---------- ワークテーブル対象資金取引情報
         05  WK-TBL-TKMZBW05       PIC  X(13).
      *---------- ワーク残高異動計算データ情報
         05  WK-TBL-TKMZBW06       PIC  X(13).
      *---------- ワークテーブル実行状況管理明細
         05  WK-TBL-TKDYAA35       PIC  X(13).
      *---------- ワークテーブル取引
         05  WK-TBL-TKMXTR00       PIC  X(13).
      *---------- ワークテーブル相対取引
         05  WK-TBL-TKMXTR01       PIC  X(13).
      *---------- ワークテーブル処理資金取引
         05  WK-TBL-TKMZBW18       PIC  X(13).
      *---------- ワークテーブル残高異動
         05  WK-TBL-TKMZZI00       PIC  X(13).
      *---------- ワークテーブル残高履歴
         05  WK-TBL-TKMZZR00       PIC  X(13).
      *---------- ワークテーブル資金残履歴
         05  WK-TBL-TKMZSR00       PIC  X(13).
      *---------- ワークテーブル商品属性
         05  WK-TBL-TKCMSZ00       PIC  X(13).
      *---------- ワーク再処理要ポートフォリオ一覧（取引）テーブルID
         05  WK-TBL-TKDYGP12       PIC  X(13).
      *---------- ワーク再処理要ポートフォリオ一覧（銘柄属性）テーブルID
         05  WK-TBL-TKDYGP16       PIC  X(13).
      *---------- ワーク再処理要制御テーブルID
         05  WK-TBL-TKDYGP17       PIC  X(13).
      *---------- ワーク資金取引
         05  WK-TBL-TKMXST00       PIC  X(13).
      *---------- ワーク未収収益
         05  WK-TBL-TKMZMS00       PIC  X(13).
      *---------- ワーク再処理要対象件数
         05  WK-SASYORIYO-KENSU    PIC  9(05).
      *---------- ワーク差分更新モード取得ルート区分                    @3212SEINO@@
         05  WK-SABON-UPDATE-KBN   PIC  9(01).                          @3212SEINO@@
      *---------- ワーク再処理要対象
         05  WK-SSYORIYOU-TASYO    OCCURS  50000.
      *---------- ファンドコード
           10  WK-FUND-CD          PIC  X(12).
      *---------- ポートフォリオコード
           10  WK-PTF-CD           PIC  X(04).
      *---------- 計算期間FROM
           10  WK-CALC-KKN-FROM    PIC  S9(08).
      *---------- 計算期間TO
           10  WK-CALC-KKN-TO      PIC  S9(08).
      *---------- ワーク引数情報
         05  WK-ARG-INFO.
      *---------- 利用会社コード
           10  WK-RIYO-CMP-CD      PIC  X(04).
      *---------- 起動ID
           10  WK-KIDOU-ID         PIC  X(04).
      *---------- 処理実行日
           10  WK-SYORI-YMD        PIC  X(08).
      *---------- 業務タスクID
           10  WK-GYOMU-TASK-ID    PIC  X(07).
      *---------- ＧＩＰＳモード
           10  WK-GIPS-MODE        PIC  X(01).
      *---------- ワークDB接続情報
         05  WK-DB-SETUZOKU-JYOUHOU.
      *---------- DB接続情報
           10  WK-DB-SETUZOKU-INFO PIC  X(80).
      *---------- DB接続フラグ
           10  WK-DB-SETUZOKU-FLG  PIC  X(01).
      *---------- ワーク電文解析情報
         05  WK-DENBUN-KAISEKI-INFO.
      *---------- 指定From日
           10  WK-SITEI-FROM       PIC  S9(08).
      *---------- 指定To日
           10  WK-SITEI-TO         PIC  S9(08).
      *---------- 強制計算区分
           10  WK-KYOSE-CALC-KBN   PIC  X(01).
      *---------- オール指定
           10  WK-ALL              PIC  X(01).
      *----------  ポートフォリオ選択リスト
           10  WK-PTF-FUND-LIST.
             15  FUND-PTF-GRP      OCCURS  10.
      *----------  ポートフォリオ区分
               20  WK-PTF-KBN      PIC  X(01).
      *----------  グループ又はファンドコード
               20  WK-GRP-FUND-CD  PIC  X(12).
      *----------  ポートフォリオコード
               20  WK-PTF-CD       PIC  X(04).
      *---------- ワークポートフォリオ情報
         05  WK-PTF-INFO.
      *---------- 処理実行日
           10  WK-SYORI-YMD        PIC  S9(08).
      *---------- 起動ID
           10  WK-KIDOU-ID         PIC  X(04).
      *---------- 利用会社コード
           10  WK-RIYO-CMP-CD      PIC  X(04).
      *---------- ファンドコード
           10  WK-FUND-CD          PIC  X(12).
      *---------- ポートフォリオコード
           10  WK-PTF-CD           PIC  X(04).
      *---------- 締め日
           10  WK-SHIME-YMD        PIC  S9(08).
      *---------- 計算From日
           10  WK-CALC-FROM        PIC  S9(08).
      *----------  差分計算Start日
           10  WK-SABON-CALC-FROM  PIC  S9(08).
      *----------  差分計算End日
           10  WK-SABON-CALC-TO    PIC  S9(08).
      *----------  強制計算Start日
           10  WK-KYOSE-CALC-FROM  PIC  S9(08).
      *----------  強制計算End日
           10  WK-KYOSE-CALC-TO    PIC  S9(08).
      *----------  更新ログインユーザ会社コード
           10  WK-UPD-LOGIN-CMP-CD PIC  X(04).
      *----------  ワーク処理フラグ
         05  WK-SYORI-FLG          PIC  X(01).
      *----------  削除用元1210情報パッケージ
         05  WK-DEL-1210-PACKAGE.
      *----------  基準日数
           10  WK-KJN-NISU         PIC  S9(04).
      *----------  基準日詳細
           10  WK-KJN-YMD-SYOSAI OCCURS  1000.
      *----------  基準日
             15  WK-KJN-YMD        PIC  S9(08).
      *----------  開始基準日
             15  WK-KAISI-KJN-YMD  PIC  S9(08).
      *---------- ワーク残高基準日FROM
         05  WK-ZN-KJN-YMD-FROM    PIC  S9(08).
      *---------- ワーク残高基準日TO
         05  WK-ZN-KJN-YMD-TO      PIC  S9(08).
      *---------- ワーク明細管理用基準日FROM
         05  WK-MKY-KJN-YMD-FROM   PIC  S9(08).
      *---------- ワーク明細単位実行ステータス
         05  WK-MT-JIKKOU-STATUS   PIC  X(03).
      *---------- ワークシステムエラー情報
         05  WK-SYS-ERR-INFO.
      *---------- エラー検知プログラム名
           10  WK-ERR-PGM-ID       PIC  X(16).
      *---------- ポジション
           10  WK-ERR-POS          PIC  X(04).
      *---------- リターンコード
           10  WK-RTN-CD           PIC  X(03).
      *---------- 詳細リターンコード
           10  WK-DETAIL-RTN-CD    PIC  S9(09).
      *---------- 詳細リターンコードデコードフラグ
           10  WK-DETAIL-RTN-CD-FLG
                                   PIC  X(01).
      *---------- フリーメッセージ
           10  WK-FREE-MSG         PIC  X(2000).
      *---------- ワークリターンコード
         05  WK-RETURN-CD          PIC  9(02).
      *---------- ワーク基準日断面情報
         05  WK-TKMZBW02.
      *---------- 処理実行日
           10  WK-SYORI-YMD        PIC  S9(08).
      *---------- 起動ID
           10  WK-KIDOU-ID         PIC  X(04).
      *---------- 利用会社コード
           10  WK-RIYO-CMP-CD      PIC  X(04).
      *---------- ファンドコード
           10  WK-FUND-CD          PIC  X(12).
      *---------- ポートフォリオコード
           10  WK-PTF-CD           PIC  X(04).
      *---------- 基準日
           10  WK-KJN-YMD          PIC  S9(08).
      *---------- 順番
           10  WK-JUNBAN           PIC  S9(07).
      *---------- 開始基準日
           10  WK-KAISI-KJN-YMD    PIC  S9(08).
      *---------- 開始基準日の翌日
           10  WK-KAISI-KJN-YMD-NEXT
                                   PIC  S9(08).
      *---------- 基準日種類
           10  WK-KJN-YMD-SHRU     PIC  X(01).
      *---------- 基準日断面作成区分
           10  WK-KJN-YMD-DMN-SK-KBN
                                   PIC  X(01).
      *---------- 計算パターン
           10  WK-CALC-PTN         PIC  X(01).
      *---------- 仕訳基準パターンコード
           10  WK-SWK-KJN-PTN-CD   PIC  X(08).
      *---------- 基本会計ベースフラグ
           10  WK-KH-KK-BASE-FLG   PIC  X(01).
      *---------- 測定基準区分
           10  WK-ST-KJN-KBN       PIC  X(01).
      *---------- 進捗ステータス（開始基準日）
           10  WK-STK-STS-KS-KJN-YMD
                                   PIC  X(03).
      *---------- 進捗ステータス（基準日）
           10  WK-STK-STS-KJN-YMD  PIC  X(03).
      *---------- 異動計算パターンコード
           10  WK-IDO-CALC-PATTERN-CD
                                   PIC  X(04).
      *---------- 証券種別コード
           10  WK-SEC-SBT-CD       PIC  X(04).
      *---------- 保有目的
           10  WK-POSSESSION-OBJ   PIC  X(01).
      *---------- 運用通貨コード
           10  WK-CAPITAL-TUKA-CD  PIC  X(04).
      *---------- 日次評価法フラグ
           10  WK-NITIJI-HYK-FLG   PIC  X(01).
      *---------- 料率パターンコード
           10  WK-COMMISSION-PATTERN
                                   PIC  X(04).
      *---------- 約定主義会計フラグ
           10  WK-YKJ-SYUGI-KAIKEI PIC  X(01).
      *---------- キャッシュフロー２回発生区分
           10  WK-CASH-FLOW-KBN    PIC  X(01).
      *---------- 約定レートコード
           10  WK-YKJ-RATE-CD      PIC  X(04).
      *---------- 未収配当計上割合
           10  WK-MISYU-HAITOU-WARIAI
                                   PIC  S9(08)V9(10).
      *---------- ワーク進捗更新用基準日
         05  WK-STK-KY-KJN-YMD     PIC  S9(08).
      *---------- ワーク進捗更新用基準日(99用)
         05  WK-STK-KY-KJN-YMD-99  PIC  S9(08).
      *---------- ワークメッセージエリア
         05  WK-MSG-AREA.
           10  WK-MESSAGE-AREA     OCCURS  999.
      *---------- ファンドコード
             15  WK-FUND-CD        PIC  X(12).
      *---------- ポートフォリオコード
             15  WK-PTF-CD         PIC  X(04).
      *---------- 評価系列コード
             15  WK-HYK-KRTU-CD    PIC  X(04).
      *---------- 帳票ID
             15  WK-REP-ID         PIC  X(08).
      *---------- 帳票任意コード
             15  WK-REP-ANY-CD     PIC  X(50).
      *---------- 基準日From
             15  WK-KJN-YMD-FROM   PIC  X(08).
      *---------- 基準日To
             15  WK-KJN-YMD-TO     PIC  X(08).
      *---------- メッセージID
             15  WK-MSG-ID         PIC  X(07).
      *---------- 置換文字
             15  WK-TIKAN-MOJI.
               20  WK-TK-MOJI      OCCURS  5
                                   PIC  X(30).
      *---------- フリーメッセージ
             15  WK-FREE-MSG       PIC  X(200).
      *---------- ワークCounterA
         05  WK-CounterA           PIC  9(03).
      *---------- ワーク銘柄別断面情報
         05  WK-TKMZBW03.
      *---------- 処理実行日
           10  WK-SYORI-YMD        PIC  S9(08).
      *---------- 起動ID
           10  WK-KIDOU-ID         PIC  X(04).
      *---------- 利用会社コード
           10  WK-RIYO-CMP-CD      PIC  X(04).
      *---------- ファンドコード
           10  WK-FUND-CD          PIC  X(12).
      *---------- ポートフォリオコード
           10  WK-PTF-CD           PIC  X(04).
      *---------- 開始基準日
           10  WK-KAISI-KJN-YMD    PIC  S9(08).
      *---------- 基準日
           10  WK-KJN-YMD          PIC  S9(08).
      *---------- 銘柄コード
           10  WK-MEG-CD           PIC  X(15).
      *---------- 証券種別コード
           10  WK-SEC-SBT-CD       PIC  X(04).
      *---------- 資産負債・買建売建フラグ
           10  WK-TATE-FLG         PIC  X(01).
      *---------- 玉ID
           10  WK-GYOKU-ID         PIC  X(10).
      *---------- 市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *---------- 差分更新From日
           10  WK-SABON-UPDATE-FROM
                                   PIC  S9(08).
      *---------- 銘柄種類
           10  WK-MEG-CD-SHRU      PIC  X(01).
      *---------- 再計算区分
           10  WK-SAI-CALC-KBN     PIC  X(01).
      *---------- 銘柄種類２
           10  WK-MEG-CD-SHRU2     PIC  X(01).
      *---------- ワーク開始時残高履歴情報
         05  WK-TKMZZR00.
             COPY  "TKMZZR00.cpy".
      *---------- ワーク開始時資金残履歴情報
         05  WK-TKMZSR00.
             COPY  "TKMZSR00.cpy".
      *---------- ワーク開始時元本残高情報
         05  WK-TKMZGZ00.
             COPY  "TKMZGZ00.cpy".
      *---------- ワーク通貨デフォールト端数
         05  WK-TUKA-DEF-HASU-SYRI-PARM.
      *---------- 運用通貨端数処理方法
           10  WK-LC-HS            PIC  X(01).
      *---------- 運用通貨小数点以下桁数
           10  WK-LC-ST-KETASU     PIC  9(02).
      *---------- 市場通貨端数処理方法
           10  WK-BC-HS            PIC  X(01).
      *---------- 市場通貨小数点以下桁数
           10  WK-BC-ST-KETASU     PIC  9(02).
      *---------- ワーク通貨情報
         05  WK-TUKA-INFO.
           10  WK-TUKA-INFO        OCCURS  500.
      *---------- 通貨コード
             15  WK-TUKA-CD        PIC  X(04).
      *---------- 小数点以下桁数
             15  WK-ST-KETASU      PIC  9(01).
      *---------- 端数処理
             15  WK-HASU           PIC  X(01).
      *---------- ワーク通貨情報件数
         05  WK-TUKA-INFO-KENSUU   PIC  9(03).
      *---------- ワーク費用計上諸区分
         05  WK-HIYO-KJY-M-KBN.
      *---------- 為替差損益計上区分
           10  WK-UKS-KJY-KBN      PIC  X(01).
      *---------- 手数料用売買損益に含むフラグ
           10  WK-TESRY-BN-FLG     PIC  X(01).
      *---------- 消費税用売買損益に含むフラグ
           10  WK-SHOHI-TAX-BN-FLG PIC  X(01).
      *---------- その他費用用売買損益に含むフラグ
           10  WK-ELS-HIYO-BN-FLG  PIC  X(01).
      *---------- 日歩用売買損益に含むフラグ
           10  WK-HIBU-BBSNEKI-FLG PIC  X(01).
      *---------- 逆日歩用売買損益に含むフラグ
           10  WK-GHIBU-BBSNEKI-FLG
                                   PIC  X(01).
      *---------- 管理費用売買損益に含むフラグ
           10  WK-KRH-BBSNEKI-FLG  PIC  X(01).
      *---------- 管理費消費税用売買損益に含むフラグ
           10  WK-KRH-SHZ-BBSNEKI-FLG
                                   PIC  X(01).
      *---------- 手数料を市場取得金額に含めるフラグ
           10  WK-TESRY-SJST-KN-FLG
                                   PIC  X(01).
      *---------- 消費税を市場取得金額に含めるフラグ
           10  WK-SHOHI-TAX-SJST-KN-FLG
                                   PIC  X(01).
      *---------- その他費用を市場取得金額に含めるフラグ
           10  WK-ELS-HIYO-SJST-KN-FLG
                                   PIC  X(01).
      *---------- 日歩を市場取得金額に含めるフラグ
           10  WK-KSG-HIBU-SJST-KN-FLG
                                   PIC  X(01).
      *---------- 逆日歩を市場取得金額に含めるフラグ
           10  WK-KSG-GHIBU-SJST-KN-FLG
                                   PIC  X(01).
      *---------- 管理費を市場取得金額に含めるフラグ
           10  WK-KSG-SJST-KN-FLG  PIC  X(01).
      *---------- 管理費消費税を市場取得金額に含めるフラグ
           10  WK-KSG-KRH-SJST-KN-FLG
                                   PIC  X(01).
      *---------- ワーク異動計算パターン情報
         05  WK-IDO-CALC-PATTERN-INFO.
      *---------- 利用会社コード
           10  WK-RIYO-CMP-CD      PIC  X(04).
      *---------- 異動計算パターンコード
           10  WK-IDO-CALC-PATTERN-CD
                                   PIC  X(04).
      *---------- 市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *---------- 証券種別コード
           10  WK-SEC-SBT-CD       PIC  X(04).
      *---------- 保有目的
           10  WK-POSSESSION-OBJECT
                                   PIC  X(01).
      *---------- 払出簿価計算方法
           10  WK-DEBET-BOKA-CALC-HOU
                                   PIC  X(01).
      *---------- 払出簿価端数（市場通貨）
           10  WK-DEBET-BOKA-HASU-BC
                                   PIC  X(01).
      *---------- 払出単価桁数（市場通貨）
           10  WK-DEBET-TNK-KETASU-BC
                                   PIC  S9(02).
      *---------- 払出単価端数（市場通貨）
           10  WK-DEBET-TNK-HASU-BC
                                   PIC  X(01).
      *---------- 払出簿価端数（運用通貨）
           10  WK-DEBET-BOKA-HASU-LC
                                   PIC  X(01).
      *---------- 払出単価桁数（運用通貨）
           10  WK-DEBET-TNK-KETASU-LC
                                   PIC  S9(02).
      *---------- 払出単価端数（運用通貨）
           10  WK-DEBET-TNK-HASU-LC
                                   PIC  X(01).
      *---------- 売り続く限り同一コスト
           10  WK-URI-TUDUKU-SAME-COST
                                   PIC  X(01).
      *---------- 同一日は同一コスト
           10  WK-SAME-YMD-SAME-COST
                                   PIC  X(01).
      *---------- 適用（先処理）１
           10  WK-TEKIYO-SAKI-SYRI1
                                   PIC  X(04).
      *---------- 適用（先処理）２
           10  WK-TEKIYO-SAKI-SYRI2
                                   PIC  X(04).
      *---------- 適用（先処理）３
           10  WK-TEKIYO-SAKI-SYRI3
                                   PIC  X(04).
      *---------- 適用（先処理）４
           10  WK-TEKIYO-SAKI-SYRI4
                                   PIC  X(04).
      *---------- 適用（先処理）５
           10  WK-TEKIYO-SAKI-SYRI5
                                   PIC  X(04).
      *---------- 適用（先処理）６
           10  WK-TEKIYO-SAKI-SYRI6
                                   PIC  X(04).
      *---------- 適用（先処理）７
           10  WK-TEKIYO-SAKI-SYRI7
                                   PIC  X(04).
      *---------- 適用（先処理）８
           10  WK-TEKIYO-SAKI-SYRI8
                                   PIC  X(04).
      *---------- 適用（先処理）９
           10  WK-TEKIYO-SAKI-SYRI9
                                   PIC  X(04).
      *---------- 適用（後処理）１
           10  WK-TEKIYO-ATO-SYRI1 PIC  X(04).
      *---------- 適用（後処理）２
           10  WK-TEKIYO-ATO-SYRI2 PIC  X(04).
      *---------- 適用（後処理）３
           10  WK-TEKIYO-ATO-SYRI3 PIC  X(04).
      *---------- 適用（後処理）４
           10  WK-TEKIYO-ATO-SYRI4 PIC  X(04).
      *---------- 適用（後処理）５
           10  WK-TEKIYO-ATO-SYRI5 PIC  X(04).
      *---------- 適用（後処理）６
           10  WK-TEKIYO-ATO-SYRI6 PIC  X(04).
      *---------- 適用（後処理）７
           10  WK-TEKIYO-ATO-SYRI7 PIC  X(04).
      *---------- 適用（後処理）８
           10  WK-TEKIYO-ATO-SYRI8 PIC  X(04).
      *---------- 適用（後処理）９
           10  WK-TEKIYO-ATO-SYRI9 PIC  X(04).
      *---------- 簿価為替レート適用フラグ
           10  WK-BOKA-KWS-TEKIYO-FLG
                                   PIC  X(01).
      *---------- 簿価為替レート端数
           10  WK-BOKA-KWS-HASU    PIC  X(01).
      *---------- 簿価為替レート桁数
           10  WK-BOKA-KWS-KETASU  PIC  S9(02).
      *---------- 新／旧株の区別
           10  WK-NEW-KYU-KABU-KBN PIC  X(01).
      *---------- 新／旧簿価計算方法
           10  WK-NEW-KYU-BOKA-CALC
                                   PIC  X(01).
      *---------- 按分簿価端数
           10  WK-ANB-BOKA-HASU    PIC  X(01).
      *---------- 按分単価端数
           10  WK-ANB-TNK-HASU     PIC  X(01).
      *---------- 按分単価桁数
           10  WK-ANB-TNK-KETASU   PIC  S9(02).
      *---------- 前払金償却方法
           10  WK-MAEKIN-SHOUKYK-HOU
                                   PIC  X(01).
      *---------- 前払金償却分端数
           10  WK-MAEKIN-SHOUKYK-HASU
                                   PIC  X(01).
      *---------- 増減取引順
           10  WK-ZOUGEN-TORI-JUN  PIC  X(01).
      *---------- 増加取引処理順序
           10  WK-GKYK-PLUS-SYRI-JUN
                                   PIC  X(01).
      *---------- 減少取引処理順序
           10  WK-GKYK-MINUS-SYRI-JUN
                                   PIC  X(01).
      *---------- 処理順序
           10  WK-SYRI-JUN         PIC  X(01).
      *---------- 更新日時
           10  WK-UPD-DATE         PIC  X(14).
      *---------- 更新ログインユーザ会社コード
           10  WK-UPD-LOGIN-CMP-CD PIC  X(04).
      *---------- 更新ユーザＩＤ
           10  WK-UPD-SID          PIC  X(20).
      *---------- 更新プログラムＩＤ
           10  WK-UPD-PGMID        PIC  X(16).
      *---------- ワーク銘柄属性情報
         05  WK-MEG-ZOK-INFO.
      *---------- 現地源泉税非課税区分
           10  WK-G-GSZ-NOTAX-KBN  PIC  X(01).
      *---------- 初期利払起算日
           10  WK-SHOKI-RB-KS-YMD  PIC  9(08).
      *---------- 初期利払日
           10  WK-SHOKI-RIBAR-YMD  PIC  9(08).
      *---------- 最終利払起算日
           10  WK-LAST-RB-KS-YMD   PIC  9(08).
      *---------- 終期利払日
           10  WK-SHUKI-RIBAR-YMD  PIC  9(08).
      *---------- 利払回数
           10  WK-RIBAR-KAISU      PIC  X(02).
      *---------- 利払日１
           10  WK-RIBAR-YMD-1      PIC  9(04).
      *---------- 利払日２
           10  WK-RIBAR-YMD-2      PIC  9(04).
      *---------- 利払日３
           10  WK-RIBAR-YMD-3      PIC  9(04).
      *---------- 利払日４
           10  WK-RIBAR-YMD-4      PIC  9(04).
      *---------- ファクター・連動係数
           10  WK-FT-RENDOU-KESU   PIC  S9(08)V9(10).
      *---------- 単位１日あたり利息額
           10  WK-TANI-1-YMD-RG    PIC  S9(08)V9(10).
      *---------- 経過日数計算方法
           10  WK-KN-CALC-HOU      PIC  X(01).
      *---------- 経過日数計算方法１ヶ月３０日設定区分
           10  WK-KKKS-1M30D-KBN   PIC  X(01).
      *---------- 経過日数計算方法片端／両端区分
           10  WK-KKK-KTT-RT-KBN   PIC  X(01).
      *---------- 勘定科目出力商品名
           10  WK-KNJ-KAMK-OUT-SYOHIN
                                   PIC  X(04).
      *---------- 利付／割引区分
           10  WK-RITUKI-WARI-KBN  PIC  X(01).
      *---------- 利払日休日処理区分
           10  WK-RIBAR-YMD-QJT-SR-KBN
                                   PIC  X(01).
      *---------- 初期利払日休日処理区分
           10  WK-SHOKI-RB-YMD-QJT-KBN
                                   PIC  X(01).
      *---------- 終期利払日休日処理区分
           10  WK-SHUKI-RB-YMD-QJT-KBN
                                   PIC  X(01).
      *---------- 設定日
           10  WK-SET-YMD          PIC  S9(08).
      *---------- 乗数（分子）
           10  WK-JYOUSUU-BUNSI    PIC  S9(08)V9(10).
      *---------- 乗数（分母）
           10  WK-JYOUSUU-BUNBO    PIC  S9(08)V9(10).
      *---------- コールプット区分
           10  WK-CALL-PUT-KBN     PIC  X(01).
      *---------- 固定変動区分
           10  WK-FIX-VRBL-KBN     PIC  X(01).
      *---------- 連動係数参照区分
           10  WK-RENKSU-REF-KBN   PIC  X(01).
      *---------- 利率／割引率
           10  WK-RRT-WARI-RT      PIC  S9(08)V9(10).
      *---------- ユーロ円債区分
           10  WK-EURO-BOND-KBN    PIC  X(01).
      *---------- 償還日
           10  WK-SHOKAN-YMD       PIC  S9(08).
      *---------- 償還日休日処理区分
           10  WK-SHOKAN-QJT-SYRI-KBN
                                   PIC  X(01).
      *---------- 利払日数
           10  WK-RIBAR-NISU       PIC  S9(03).
      *---------- ワーク税率情報
         05  WK-TAX-RT-INFO.
      *---------- 市場国源泉税率
           10  WK-SIJO-KG-TAX-RT   PIC  S9(08)V9(10).
      *---------- ワーク銘柄コードリファレンス
         05  WK-MEG-CD-REF.
      *---------- 銘柄通貨コード
           10  WK-MEG-TUKA-CD      PIC  X(04).
      *---------- 発行体国コード
           10  WK-HAKKO-TAI-KUNI-CD
                                   PIC  X(04).
      *---------- 投資対象国コード
           10  WK-TSTSK-CD         PIC  X(04).
      *---------- 外部銘柄コード
           10  WK-GAIBU-MEG-CD     PIC  X(20).
      *---------- 株式種別
           10  WK-KABU-SBT         PIC  X(02).
      *---------- 回
           10  WK-KAYI             PIC  X(04).
      *---------- 号
           10  WK-GOU              PIC  X(04).
      *---------- 限月
           10  WK-GENGETSU         PIC  S9(06).
      *---------- ストライクプライス
           10  WK-STRIKEPRICE      PIC  S9(12)V9(06).
      *---------- 満期日
           10  WK-MNK-YMD          PIC  S9(08).
      *---------- 証券種別コード
           10  WK-SEC-SBT-CD       PIC  X(04).
      *---------- ワーク基準日の経過利息データ
         05  WK-KJN-YMD-KEKA-RSK-DATA.
      *---------- 市場通貨経過利息
           10  WK-SJTK-KEKA-RSK    PIC  S9(12)V9(06).
      *---------- 運用通貨経過利息
           10  WK-UYTK-KEKA-RSK    PIC  S9(12)V9(06).
      *---------- 市場通貨源泉税
           10  WK-SJTK-GENSEN-TAX  PIC  S9(15)V9(03).
      *---------- 運用通貨源泉税
           10  WK-UYTK-GENSEN-TAX  PIC  S9(15)V9(03).
      *---------- 評価為替レート
           10  WK-HYK-KWS          PIC  S9(08)V9(10).
      *---------- 源泉税評価為替レート
           10  WK-GENS-TAX-HYK-KWS PIC  S9(08)V9(10).
      *---------- ファクター・連動係数
           10  WK-FT-RENDOU-KESU   PIC  S9(08)V9(10).
      *---------- 市場通貨未収収益
           10  WK-SJTK-MS-SHEKI    PIC  S9(15)V9(03).
      *---------- 運用通貨未収収益
           10  WK-UYTK-MS-SHEKI    PIC  S9(15)V9(03).
      *---------- ワーク対象取引情報
         05  WK-TARGET-TORI-INFO.
      *---------- 原取引ID
           10  WK-TORI-ID          PIC  S9(10).
      *---------- 受渡日
           10  WK-UKE-YMD          PIC  S9(08).
      *---------- 計上基準日
           10  WK-KEIJOU-KIJUNBI   PIC  S9(08).
      *---------- 増幅赤黒区分
           10  WK-ZOFKU-AKA-KBN    PIC  X(01).
      *---------- 増幅区分
           10  WK-ZOFKU-KBN        PIC  X(01).
      *---------- 増幅元異動計上基準日
           10  WK-ZOFKUMT-KJ-KJN   PIC  S9(08).
      *---------- 処理順
           10  WK-SRJUN            PIC  S9(08).
      *---------- 換算後為替レート(市場／運用)
           10  WK-K-S-U-KWS        PIC  S9(18)V9(18).
      *---------- 換算後経過利息為替レート
           10  WK-KKRS-KWS         PIC  S9(18)V9(18).
      *---------- ワーク対象資金取引情報
         05  WK-TS-TORI-INFO.
      *---------- 原取引ID
           10  WK-TORI-ID          PIC  S9(10).
      *---------- 資金種別
           10  WK-SIKIN-SBT        PIC  X(01).
      *---------- 異動日
           10  WK-IDO-YMD          PIC  S9(08).
      *---------- 増減区分
           10  WK-ZG-KBN           PIC  X(01).
      *---------- 処理順
           10  WK-SRJUN            PIC  S9(08).
      *---------- 受渡計上切替対象フラグ
           10  WK-UKE-KIRIKAE-FLG  PIC  X(01).
      *---------- 切替仕訳基準パターンコード
           10  WK-KK-SWK-KJN-PTN-CD
                                   PIC  X(08).
      *---------- 切替キャッシュフロー2回有効フラグ
           10  WK-KK-CF-NK-YK-FLG  PIC  X(01).
      *---------- 切替基本会計ベースフラグ
           10  WK-KK-KH-KK-BASE-FLG
                                   PIC  X(01).
      *---------- 受渡未払未収増幅フラグ
           10  WK-UKE-MBMS-ZF-FLG  PIC  X(01).
      *---------- ワーク更新用進捗ステータス
         05  WK-KY-STK-STS         PIC  X(03).
      *---------- ワーク取引データ
         05  WK-TRHK-DATA.
      *---------- 利用会社コード
           10  WK-RIYO-CMP-CD      PIC  X(04).
      *---------- 原取引ID
           10  WK-TORI-ID          PIC  S9(10).
      *---------- ファンドコード
           10  WK-FUND-CD          PIC  X(12).
      *---------- ポートフォリオコード
           10  WK-PTF-CD           PIC  X(04).
      *---------- 銘柄コード
           10  WK-MEG-CD           PIC  X(15).
      *---------- 証券種別コード
           10  WK-SEC-SBT-CD       PIC  X(04).
      *----------  玉ID
           10  WK-GYOKU-ID         PIC  X(10).
      *----------  保有目的
           10  WK-POSSESSION-OBJECT
                                   PIC  X(01).
      *---------- 取引連関ＩＤ
           10  WK-THRK-ID          PIC  S9(10).
      *---------- ダミー区分
           10  WK-DUMMY-KBN        PIC  X(01).
      *---------- 約定日
           10  WK-YKJ-YMD          PIC  S9(08).
      *---------- 受渡日
           10  WK-UKE-YMD          PIC  S9(08).
      *---------- 取引内容
           10  WK-TORI-NAIY        PIC  X(04).
      *---------- 取引事由
           10  WK-TORI-JIYU        PIC  X(04).
      *---------- 資金決済方法
           10  WK-KESAI-HOHO       PIC  X(01).
      *---------- 異動数量
           10  WK-IDO-SURYO        PIC  S9(12)V9(06).
      *---------- 権利数量
           10  WK-KENRI-SURYO      PIC  S9(12)V9(06).
      *---------- 数量単位
           10  WK-SURYO-TANI       PIC  S9(12)V9(06).
      *---------- 市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *---------- 現地通貨コード
           10  WK-G-TUKA-CD        PIC  X(04).
      *---------- 為替レート（現地／運用）１
           10  WK-G-U-KWS1         PIC  S9(08)V9(10).
      *---------- 為替レート（現地／運用）２
           10  WK-G-U-KWS2         PIC  S9(08)V9(10).
      *---------- 為替レート（現地／市場）
           10  WK-G-S-KWS          PIC  S9(08)V9(10).
      *---------- 為替レート（市場／運用）
           10  WK-S-U-KWS          PIC  S9(08)V9(10).
      *---------- 円レート（現地／円）
           10  WK-G-YEN-KWS        PIC  S9(08)V9(10).
      *---------- 経過利息為替レート
           10  WK-KEKA-RSK-KWS     PIC  S9(08)V9(10).
      *---------- 約定金額（運用通貨換算額）
           10  WK-U-KSG-G-YJKG     PIC  S9(15)V9(03).
      *---------- 現地手数料（運用通貨換算額）
           10  WK-U-KSG-G-TSR      PIC  S9(15)V9(03).
      *---------- 現地消費税（運用通貨換算額）
           10  WK-U-KSG-G-SHZ      PIC  S9(15)V9(03).
      *---------- 現地その他費用（運用通貨換算額）
           10  WK-U-KSG-G-THY      PIC  S9(15)V9(03).
      *---------- 現地源泉税（運用通貨換算額）
           10  WK-U-KSG-G-GSZ      PIC  S9(15)V9(03).
      *---------- 既経過利息（運用通貨換算額）
           10  WK-U-KSG-G-KKKRS    PIC  S9(15)V9(03).
      *---------- 日歩（運用通貨換算額）
           10  WK-U-KSG-HIBU       PIC  S9(15)V9(03).
      *---------- 逆日歩（運用通貨換算額）
           10  WK-U-KSG-GHIBU      PIC  S9(15)V9(03).
      *---------- 管理費（運用通貨換算額）
           10  WK-U-KSG-KRH        PIC  S9(15)V9(03).
      *---------- 管理費消費税（運用通貨換算額）
           10  WK-U-KSG-KRH-SHZ    PIC  S9(15)V9(03).
      *---------- 運用国手数料（運用通貨換算額）
           10  WK-U-KSG-U-TSR      PIC  S9(15)V9(03).
      *---------- 運用国消費税（運用通貨換算額）
           10  WK-U-KSG-U-SHZ      PIC  S9(15)V9(03).
      *---------- 運用国その他費用（運用通貨換算額）
           10  WK-U-KSG-U-THY      PIC  S9(15)V9(03).
      *---------- 国内源泉税（運用通貨換算額）
           10  WK-NAI-TAX-U-KSG    PIC  S9(15)V9(03).
      *---------- 精算金額（運用通貨換算額）
           10  WK-U-KSG-G-SSKG     PIC  S9(15)V9(03).
      *---------- 入出金額（約定レート・運用通貨換算額）
           10  WK-NSKG-Y-UY        PIC  S9(15)V9(03).
      *---------- 入出金額（決済レート・運用通貨換算額）
           10  WK-NSKG-K-UY        PIC  S9(15)V9(03).
      *---------- 為替差損益
           10  WK-UYTK-KWS-SNEKI   PIC  S9(15)V9(03).
      *---------- 約定金額（市場通貨換算額）
           10  WK-S-KSG-G-YJKG     PIC  S9(15)V9(03).
      *---------- 現地手数料（市場通貨換算額）
           10  WK-S-KSG-G-TSR      PIC  S9(15)V9(03).
      *---------- 現地消費税（市場通貨換算額）
           10  WK-S-KSG-G-SHZ      PIC  S9(15)V9(03).
      *---------- 現地その他費用（市場通貨換算額）
           10  WK-S-KSG-G-THY      PIC  S9(15)V9(03).
      *---------- 現地源泉税（市場通貨換算額）
           10  WK-S-KSG-G-GSZ      PIC  S9(15)V9(03).
      *---------- 既経過利息（市場通貨換算額）
           10  WK-S-KSG-G-KKKRS    PIC  S9(15)V9(03).
      *---------- 日歩（市場通貨換算額）
           10  WK-S-KSG-HIBU       PIC  S9(15)V9(03).
      *---------- 逆日歩（市場通貨換算額）
           10  WK-S-KSG-GHIBU      PIC  S9(15)V9(03).
      *---------- 管理費（市場通貨換算額）
           10  WK-S-KSG-KRH        PIC  S9(15)V9(03).
      *---------- 管理費消費税（市場通貨換算額）
           10  WK-S-KSG-KRH-SHZ    PIC  S9(15)V9(03).
      *---------- 運用国手数料（市場通貨換算額）
           10  WK-S-KSG-U-TSR      PIC  S9(15)V9(03).
      *---------- 運用国消費税（市場通貨換算額）
           10  WK-S-KSG-U-SHZ      PIC  S9(15)V9(03).
      *---------- 運用国その他費用（市場通貨換算額）
           10  WK-S-KSG-U-THY      PIC  S9(15)V9(03).
      *---------- 国内源泉税（市場通貨換算額）
           10  WK-S-KSG-U-GSZ      PIC  S9(15)V9(03).
      *---------- 精算金額（市場通貨換算額）
           10  WK-S-KSG-SSKG       PIC  S9(15)V9(03).
      *---------- 決済口座１
           10  WK-KOZA1-NO         PIC  X(15).
      *---------- 決済口座１通貨コード
           10  WK-KOZA1-TUKA-CD    PIC  X(04).
      *---------- 決済口座１入出金額
           10  WK-KOZA1-NSKG       PIC  S9(15)V9(03).
      *---------- 決済口座１入出金額（運用通貨換算額）
           10  WK-KOZA1-U-KSG-NSKG PIC  S9(15)V9(03).
      *---------- 決済口座２
           10  WK-KOZA2-NO         PIC  X(15).
      *---------- 決済口座２通貨コード
           10  WK-KOZA2-TUKA-CD    PIC  X(04).
      *---------- 決済口座２入出金額
           10  WK-KOZA2-NSKG       PIC  S9(15)V9(03).
      *---------- 決済口座２入出金額（運用通貨換算額）
           10  WK-KOZA2-U-KSG-NSKG PIC  S9(15)V9(03).
      *---------- 還付予定額
           10  WK-KANP-YOTEGK      PIC  S9(15)V9(03).
      *---------- 調整損益
           10  WK-CHOSEI-SNEKI     PIC  S9(15)V9(03).
      *---------- 経過利息区分
           10  WK-KKRS-KBN         PIC  X(01).
      *---------- 効力発生日
           10  WK-KOURYOKU-YMD     PIC  S9(08).
      *---------- スタート日（放出日）
           10  WK-ST-YMD           PIC  S9(08).
      *---------- 約定ベースエンド日
           10  WK-YKJ-END-YMD      PIC  S9(08).
      *---------- 受渡ベースエンド日
           10  WK-UKE-END-YMD      PIC  S9(08).
      *---------- 運用日数
           10  WK-UNYO-NISU        PIC  S9(03).
      *---------- 受取利息金額
           10  WK-UKETR-RSK-KG     PIC  S9(15)V9(03).
      *---------- 商品別取引区分
           10  WK-SHB-TORI-KBN     PIC  X(01).
      *---------- 異動確定区分
           10  WK-IDO-KBN          PIC  X(01).
      *---------- １口注文ＩＤ
           10  WK-ORDR-1K-ID       PIC  S9(10).
      *---------- 対象取引ＩＤ
           10  WK-TARGET-TORI-ID   PIC  S9(10).
      *---------- 現地ブローカー
           10  WK-G-BRK            PIC  X(04).
      *---------- 資産負債・買建売建フラグ
           10  WK-TATE-FLG         PIC  X(01).
      *---------- 投資対象国コード
           10  WK-TSTSK-CD         PIC  X(04).
      *---------- 発行国コード
           10  WK-HAKO-CD          PIC  X(04).
      *---------- 約定金額
           10  WK-G-YJKG           PIC  S9(15)V9(03).
      *---------- 約定単価
           10  WK-YKJ-TANKA        PIC  S9(08)V9(10).
      *---------- 現地入出金額
           10  WK-G-NSKG           PIC  S9(15)V9(03).
      *---------- ワーク相対取引データ
         05  WK-AITAI-TRHK-DATA.
      *---------- 取引連関ＩＤ
           10  WK-THRK-ID          PIC  S9(10).
      *---------- 建時単価
           10  WK-TATE-TANKA       PIC  S9(08)V9(10).
      *---------- 決済単価
           10  WK-KS-TANKA         PIC  S9(08)V9(10).
      *---------- 権利行使価格
           10  WK-KRKS-KKK         PIC  S9(08)V9(10).
      *---------- 権利行使金額（運用通貨）
           10  WK-U-KSG-KRKS-KG    PIC  S9(15)V9(03).
      *---------- 決済約定金額（運用通貨）
           10  WK-U-KSG-KS-YJKG    PIC  S9(15)V9(03).
      *---------- 決済現地手数料（運用通貨）
           10  WK-U-KSG-KS-G-TSR   PIC  S9(15)V9(03).
      *---------- 決済現地消費税（運用通貨）
           10  WK-U-KSG-KS-G-SHZ   PIC  S9(15)V9(03).
      *---------- 決済現地その他費用（運用通貨）
           10  WK-U-KSG-KS-G-THY   PIC  S9(15)V9(03).
      *---------- 決済運用国手数料（運用通貨）
           10  WK-U-KSG-KS-U-TSR   PIC  S9(15)V9(03).
      *---------- 決済運用国消費税（運用通貨）
           10  WK-U-KSG-KS-U-SHZ   PIC  S9(15)V9(03).
      *---------- 決済運用国その他費用（運用通貨）
           10  WK-U-KSG-KS-U-THY   PIC  S9(15)V9(03).
      *---------- 日歩（運用通貨）
           10  WK-U-KSG-HIBU       PIC  S9(15)V9(03).
      *---------- 逆日歩（運用通貨）
           10  WK-U-KSG-GHIBU      PIC  S9(15)V9(03).
      *---------- 管理費（運用通貨）
           10  WK-U-KSG-KRH        PIC  S9(15)V9(03).
      *---------- 管理費消費税（運用通貨）
           10  WK-U-KSG-KRH-SHZ    PIC  S9(15)V9(03).
      *---------- 建時約定金額（運用通貨）
           10  WK-U-KSG-TH-YJKG    PIC  S9(15)V9(03).
      *---------- 建時現地手数料（運用通貨）
           10  WK-U-KSG-TH-G-TSR   PIC  S9(15)V9(03).
      *---------- 建時現地消費税（運用通貨）
           10  WK-U-KSG-TH-G-SHZ   PIC  S9(15)V9(03).
      *---------- 建時現地その他費用（運用通貨）
           10  WK-U-KSG-TH-G-THY   PIC  S9(15)V9(03).
      *---------- 建時運用国手数料（運用通貨）
           10  WK-U-KSG-TH-U-TSR   PIC  S9(15)V9(03).
      *---------- 建時運用国消費税（運用通貨）
           10  WK-U-KSG-TH-U-SHZ   PIC  S9(15)V9(03).
      *---------- 建時運用国その他費用（運用通貨）
           10  WK-U-KSG-TH-U-THY   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ約定金額（運用通貨）
           10  WK-U-KSG-TH-OP-YJKG PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地手数料（運用通貨）
           10  WK-U-KSG-TH-OP-G-TSR
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地消費税（運用通貨）
           10  WK-U-KSG-TH-OP-G-SHZ
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地その他費用（運用通貨）
           10  WK-U-KSG-TH-OP-G-THY
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国手数料（運用通貨）
           10  WK-U-KSG-TH-OP-U-TSR
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国消費税（運用通貨）
           10  WK-U-KSG-TH-OP-U-SHZ
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国その他費用（運用通貨）
           10  WK-U-KSG-TH-OP-U-THY
                                   PIC  S9(15)V9(03).
      *---------- 引継ＯＰ約定金額（運用通貨）
           10  WK-U-KSG-HTOP-YJKG  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地手数料（運用通貨）
           10  WK-U-KSG-HTOP-G-TSR PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地消費税（運用通貨）
           10  WK-U-KSG-HTOP-G-SHZ PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地その他費用（運用通貨）
           10  WK-U-KSG-HTOP-G-THY PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国手数料（運用通貨）
           10  WK-U-KSG-HTOP-U-TSR PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国消費税（運用通貨）
           10  WK-U-KSG-HTOP-U-SHZ PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国その他費用（運用通貨）
           10  WK-U-KSG-HTOP-U-THY PIC  S9(15)V9(03).
      *---------- 権利行使金額（市場通貨）
           10  WK-S-KSG-KRKS-KG    PIC  S9(15)V9(03).
      *---------- 決済約定金額（市場通貨）
           10  WK-S-KSG-KS-YJKG    PIC  S9(15)V9(03).
      *---------- 決済現地手数料（市場通貨）
           10  WK-S-KSG-KS-G-TSR   PIC  S9(15)V9(03).
      *---------- 決済現地消費税（市場通貨）
           10  WK-S-KSG-KS-G-SHZ   PIC  S9(15)V9(03).
      *---------- 決済現地その他費用（市場通貨）
           10  WK-S-KSG-KS-G-THY   PIC  S9(15)V9(03).
      *---------- 決済運用国手数料（市場通貨）
           10  WK-S-KSG-KS-U-TSR   PIC  S9(15)V9(03).
      *---------- 決済運用国消費税（市場通貨）
           10  WK-S-KSG-KS-U-SHZ   PIC  S9(15)V9(03).
      *---------- 決済運用国その他費用（市場通貨）
           10  WK-S-KSG-KS-U-THY   PIC  S9(15)V9(03).
      *---------- 日歩（市場通貨）
           10  WK-S-KSG-HIBU       PIC  S9(15)V9(03).
      *---------- 逆日歩（市場通貨）
           10  WK-S-KSG-GHIBU      PIC  S9(15)V9(03).
      *---------- 管理費（市場通貨）
           10  WK-S-KSG-KRH        PIC  S9(15)V9(03).
      *---------- 管理費消費税（市場通貨）
           10  WK-S-KSG-KRH-SHZ    PIC  S9(15)V9(03).
      *---------- 建時約定金額（市場通貨）
           10  WK-S-KSG-TH-YJKG    PIC  S9(15)V9(03).
      *---------- 建時現地手数料（市場通貨）
           10  WK-S-KSG-TH-G-TSR   PIC  S9(15)V9(03).
      *---------- 建時現地消費税（市場通貨）
           10  WK-S-KSG-TH-G-SHZ   PIC  S9(15)V9(03).
      *---------- 建時現地その他費用（市場通貨）
           10  WK-S-KSG-TH-G-THY   PIC  S9(15)V9(03).
      *---------- 建時運用国手数料（市場通貨）
           10  WK-S-KSG-TH-U-TSR   PIC  S9(15)V9(03).
      *---------- 建時運用国消費税（市場通貨）
           10  WK-S-KSG-TH-U-SHZ   PIC  S9(15)V9(03).
      *---------- 建時運用国その他費用（市場通貨）
           10  WK-S-KSG-TH-U-THY   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ約定金額（市場通貨）
           10  WK-S-KSG-TH-OP-YJKG PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地手数料（市場通貨）
           10  WK-S-KSG-TH-OP-G-TSR
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地消費税（市場通貨）
           10  WK-S-KSG-TH-OP-G-SHZ
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地その他費用（市場通貨）
           10  WK-S-KSG-TH-OP-G-THY
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国手数料（市場通貨）
           10  WK-S-KSG-TH-OP-U-TSR
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国消費税（市場通貨）
           10  WK-S-KSG-TH-OP-U-SHZ
                                   PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国その他費用（市場通貨）
           10  WK-S-KSG-TH-OP-U-THY
                                   PIC  S9(15)V9(03).
      *---------- 引継ＯＰ約定金額（市場通貨）
           10  WK-S-KSG-HTOP-YJKG  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地手数料（市場通貨）
           10  WK-S-KSG-HTOP-G-TSR PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地消費税（市場通貨）
           10  WK-S-KSG-HTOP-G-SHZ PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地その他費用（市場通貨）
           10  WK-S-KSG-HTOP-G-THY PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国手数料（市場通貨）
           10  WK-S-KSG-HTOP-U-TSR PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国消費税（市場通貨）
           10  WK-S-KSG-HTOP-U-SHZ PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国その他費用（市場通貨）
           10  WK-S-KSG-HTOP-U-THY PIC  S9(15)V9(03).
      *---------- 建時現地約定日
           10  WK-TATE-G-YKJ-YMD   PIC  S9(08).
      *---------- 資産負債・買建売建フラグ
           10  WK-TATE-FLG         PIC  X(01).
      *---------- ワーク直前残高異動
         05  WK-TZ-ZN-IDO.
             COPY  "TKMZZI00.cpy".
      *---------- ワーク資金取引データ
         05  WK-SIKIN-TRHK-DATA.
      *---------- 決済口座通貨コード
           10  WK-KOZA-TUKA-CD     PIC  X(04).
      *---------- 市場通貨コード
           10  WK-SIJO-TUKA-CD     PIC  X(04).
      *---------- 取引連関ＩＤ
           10  WK-THRK-ID          PIC  S9(10).
      *---------- 決済通貨異動額
           10  WK-KSTK-IDOG        PIC  S9(15)V9(03).
      *---------- 運用通貨異動額
           10  WK-UYTK-IDOG        PIC  S9(15)V9(03).
      *---------- 異動確定区分
           10  WK-IDO-KBN          PIC  X(01).
      *---------- 取引事由
           10  WK-TORI-JIYU        PIC  X(04).
      *---------- 証券種別コード
           10  WK-SEC-SBT-CD       PIC  X(04).
      *---------- 取引内容
           10  WK-TORI-NAIY        PIC  X(04).
      *---------- ワーク直前資金簿価異動
         05  WK-TYOKUZEN-SK-BOKA-IDOG.
             COPY  "TKMZSI00.cpy".
      *---------- ワーク開始基準日断面存在フラグ
         05  WK-KKY-DMN-SONZAI-FLG PIC  X(01).
      *---------- ワーク取引存在フラグ
         05  WK-TRHK-SONZAI-FLG    PIC  X(01).
      *---------- ワーク取引件数
         05  WK-TRHK-KENSU         PIC  9(08).
      *---------- ワーク警告情報数
         05  WK-WARN-INFO-KN       PIC  S9(02).
      *---------- ワーク警告情報
         05  WK-WARN-INFO.
      *---------- 警告フラグ
           10  WARN-FLG            OCCURS  30
                                   PIC  X(02).
      *---------- ワーク残高計算フラグ
         05  WK-ZN-CALC-FLG        PIC  X(01).
      *---------- ワーク実行状況管理情報
         05  WK-JIKOU-HOZON-INFO.
      *---------- 起動ログインユーザ会社コード
           10  WK-LOGIN-CMP-CD     PIC  X(04).
      *---------- 起動ユーザーID
           10  WK-KIDOU-SID        PIC  X(20).
      *---------- 起動業務グループコード
           10  WK-GYOMU-GRP-CD     PIC  X(10).
      *---------- ワーク更新区分
         05  WK-UPDATE-KBN         PIC  X(01).
      *---------- ワークOLD証券種別コード
         05  WK-OLD-SEC-SBT-CD     PIC  X(04).
      *---------- SCZY4023.ヒット件数
         05  WK-HIT-KENSU          PIC  9(05).
      *---------- SCZY7200.取得件数
         05  WK-GET-KENSU          PIC  9(05).
      *---------- SCZY4502.乗算/除算区分
         05  WK-JZ-JS-KBN          PIC  X(01).
      *---------- ワーク国内外国区分
         05  WK-NAI-GAI-KBN        PIC  X(01).
      *---------- ワークOLD国内外国区分
         05  WK-OLD-NAI-GAI-KBN    PIC  X(01).
      *---------- ワークキャッシュフロー2回有効フラグ
         05  WK-CASH-FLOW-2-FLG    PIC  X(01).
      *---------- ワークOLD証券種別コード2
         05  WK-OLD-SEC-SBT-CD-2   PIC  X(04).
      *---------- ワーク管理数量単位
         05  WK-KANRI-SURYO-TANI   PIC  S9(12)V9(06).
      *---------- LOOP
         05  WK-LOOP.
           10  WK-IDX0             PIC  9(02).
           10  WK-IDX1             PIC  9(05).
           10  WK-IDX2             PIC  9(05).
           10  WK-IDX3             PIC  9(05).
           10  WK-IDX4             PIC  9(03).
           10  WK-IDX5             PIC  9(03).
           10  WK-IDX6             PIC  9(03).
           10  WK-IDX7             PIC  9(03).
           10  WK-IDX8             PIC  9(04).
      *---------- 数目
         05  WK-INDEX              PIC  9(03).
         05  WK-IDX                PIC  9(03).
      *---------- エラー種別
         05  WK-ERR-SYUBETU        PIC  X(01).
      *---------- SCZY7040
         05  WK-SCZY7040-ARG2.
      *---------- テーブル・ファイル情報
           10  WK-TABLE-FILE-MSG   OCCURS  999.
      *---------- 識別子
             15  WK-IDENT-ID       PIC  X(256).
      *---------- 対象処理
             15  WK-OBJECT-DISPOSAL
                                   PIC  X(06).
      *---------- 処理件数
             15  WK-DISPOSAL-NUM   PIC  9(09).
      *---------- ストライクプライス
         05  WK-STRIKEPRICE-M      PIC  -9(12).9(06).
         05  WK-STRIKEPRICE-X      PIC  X(20).
      *----------  ワーク売り続く限りフラグ
         05  WK-URI-TUDUKU-KAGI-FLG
                                   PIC  X(01).
      *----------  ワーク約定ベース受渡順フラグ
         05  WK-YKJ-UKE-JUN-FLG    PIC  X(01).
      *---------- 取引事由
         05  WK-TORI-JIYU-BAK      PIC  X(04).
      *----------  ワークデータなしフラグ
         05  WK-DATA-NASI-FLG      PIC  9(01).
      *----------  ワークメッセージ種類
         05  WK-MSG-SYO            PIC  9(01).
      *----------  ワークその他処理パターン
         05  WK-ELS0-PTN           PIC  9(01).
      *----------  ワーク取引事由
         05  WK-TRI-JIYU-K         PIC  X(04).
      *---------- ワーク市場通貨払出単価
         05  WK-SJTK-H-TNK         PIC  S9(08)V9(10).
      *---------- ワーク運用通貨払出単価
         05  WK-UYTK-H-TNK         PIC  S9(08)V9(10).
      *----------  未収配当計算コールフラグ
         05  WK-KEISAN-FLG1        PIC  9(01).
      *----------  債券過去経過利息計算コールフラグ
         05  WK-KEISAN-FLG2        PIC  9(01).
      *----------  その他未収配当計算コールフラグ
         05  WK-KEISAN-FLG3        PIC  9(01).
      *----------  ワーク仮払金増加の取引存在フラグ
         05  WK-SPAY-PLUS-TORI-FLG PIC  9(01).
      *----------  ワーク仮払金増加の取引計上基準日
         05  WK-SPAY-PLUS-TRKJ-KJB PIC  S9(08).
      *----------  ワーク市場通貨異動後仮払金残
         05  WK-SJTK-IDOG-SPAYZN   PIC  S9(15)V9(03).
      *----------  ワーク運用通貨異動後仮払金残
         05  WK-UYTK-IDOG-SPAYZN   PIC  S9(15)V9(03).
      *----------  ワーク開始基準日の残高履歴項目
         05  WK-TKMZZR00-PARM.
      *----------  市場通貨未収収益計上・戻入額
           10  WK-SJTK-MSSE-KJMIG  PIC  S9(15)V9(03).
      *----------  運用通貨未収収益計上・戻入額
           10  WK-UYTK-MSSE-KJMIG  PIC  S9(15)V9(03).
      *----------  市場通貨払出単価
           10  WK-SJTK-HARAID-TNK  PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  WK-UYTK-HARAID-TNK  PIC  S9(08)V9(10).
      *----------  同一コスト継続フラグ
           10  WK-SAME-COST-KZK-FLG
                                   PIC  X(01).
      *---------- 基準年月日/基準年月共通
         05  WK-STK-KY-KJN-YMD-COM PIC  S9(08).
      *---------- ワーク再処理基準日FROM
         05  WK-REDO-KJN-YMD-FROM  PIC  S9(08).
         05  WK-ERR-CNT            PIC  9(04).
      *---------- SMZJ1910のリターンパッケージ.直前の市場通貨前払金サマリ
         05  WK-SJTK-M             PIC  -9(15).9(03).
         05  WK-SJTK-X             PIC  X(20).
      *---------- SMZJ1910のリターンパッケージ.直前の運用通貨前払金サマリ
         05  WK-UYTK-M             PIC  -9(15).9(03).
         05  WK-UYTK-X             PIC  X(20).
      *---------- ワーク銘柄属性取得区分
         05  WK-MEG-ZKSE-SYUTK-KBN PIC  X(01).
      *---------- ワーク売り続く証券種別区分
         05  WK-BUY-SEC-SBT-KBN    PIC  X(01).
      *---------- ワーク外部銘柄コード変換用証券種別コード
         05  WK-GAIBU-MEG-CD-SSC   PIC  X(04).
      *---------- ワーク外部銘柄コード変換用市場通貨コード
         05  WK-GAIBU-MEG-CD-STC   PIC  X(04).
      *---------- ワーク取引差分更新フラグ
         05  WK-TORI-UPD-FLG       PIC  9(01).
      *---------- ワークポートフォリオ実行スキップフラグ
         05  WK-PTF-SKIP-FLG       PIC  9(01).
      *---------- ワークポートフォリオ実行一時停止区分
         05  WK-PTF-STOP-FLG       PIC  9(01).
      *---------- ワーク再計算数量単位
         05  WK-SAIKS-SURYO-TANI   PIC  S9(12)V9(06).
      *---------- 増減順相対物区分
         05  WK-ZOUGENJYUN-SOTAIBT-KBN
                                   PIC  X(01).
      *---------- ワーク開始時残高変換フラグ
         05  WK-KAISI-ZN-FLG       PIC  9(01).
      *---------- ワークSCZY3002コールデータなしフラグ
         05  WK-MSG-FLG-1          PIC  9(01).
      *---------- ワークSCZY3031コール一部該当データなしフラグ
         05  WK-MSG-FLG-2          PIC  9(01).
      *---------- ワークSCZY3031コール利率取得失敗フラグ
         05  WK-MSG-FLG-3          PIC  9(01).
      *---------- ワークSCZY3031コールデータなしフラグ
         05  WK-MSG-FLG-4          PIC  9(01).
      *---------- ワーク商品属性
         05  WK-TKCMSZ00           OCCURS  200.
      *---------- 証券種別コード
           10  SEC-SBT-CD          PIC  X(04).
      *---------- 管理数量単位
           10  KANRI-SURYO-TANI    PIC  9(12)V9(06).
      *---------- ワーク取引属性
         05  WK-TKCMTZ00           OCCURS  401.
      *---------- 取引事由コー
           10  TRHK-JIYU-CD        PIC  X(04).
      *---------- ワーク件数
         05  WK-KENSU              PIC  9(03).
      *---------- ワーク0クーポン債フラグ
         05  WK-0-CUPON-FLG        PIC  9(01).
      *---------- ワーク実行状況管理明細更新フラグ(先頭セッション)
         05  WK-JH-UPD-FLG         PIC  9(01).
      *---------- ワーク取引属性データエリア
         05  WK-TBL-TKCMTZ00-AREA.
      *----------  取引属性データ配列
           10  TBL-TKCMTZ00.
             15  PARM-SCZY4405-TKCMTZ00   OCCURS  401.
      *----------  取引内容コード
               20  TRHK-NAIYO-CD   PIC  X(04).
      *----------  取引事由コード
               20  TRHK-JIYU-CD    PIC  X(04).
      *----------  取引名称（日）
               20  TORIHIK-NAME-J  PIC  X(60).
      *----------  取引名称（英）
               20  TORIHIK-NAME-E  PIC  X(60).
      *----------  取引名称_略称（日）
               20  TORIHIK-AB-NAME-J
                                   PIC  X(30).
      *----------  取引名称_略称（英）
               20  TORIHIK-AB-NAME-E
                                   PIC  X(30).
      *----------  数量異動区分
               20  SURYO-IDO-KBN   PIC  X(01).
      *----------  簿価異動区分
               20  BOKA-IDO-KBN    PIC  X(01).
      *----------  コメント
               20  COMENT          PIC  X(20).
      *----------  出力順
               20  OUT-JUN         PIC  9(04).
      *----------  有効件数
           10  YUUKOU-KENSUU       PIC  9(04).
      *----------  ワーク異動計算パターンデータエリア
         05  WK-TBL-TKPFPT01-AREA.
      *----------  異動計算パターンデータ配列
           10  TBL-TKPFPT01.
             15  PARM-SCZY4303-TKPFPT01   OCCURS  10001.
               COPY  "TKPFPT01.cpy".
      *----------  有効件数
           10  YUUKOU-KENSUU       PIC  9(05).
      *----------  ワーク為替換算情報データエリア
         05  WK-TBL-TKJCKK00-AREA.
      *----------  為替換算情報データ配列
           10  TBL-TKJCKK00-1.
             15  TBL-TKJCKK00             OCCURS  10001.
      *----------  為替系列コード
               20  KWS-KRTU-CD     PIC  X(04).
      *----------  ベース通貨コード
               20  BASE-TUKA-CD    PIC  X(04).
      *----------  目的通貨コード
               20  MOKUTEKI-TUKA-CD
                                   PIC  X(04).
      *----------  媒介通貨
               20  BAYIKAYI-TUKA   PIC  X(04).
      *----------  乗算/除算区分
               20  JZ-JS-KBN       PIC  X(01).
      *----------  有効件数
           10  YUUKOU-KENSUU       PIC  9(05).
      *----------  ワークポートフォリオ属性データエリア
         05  WK-TBL-TKPFZK01-AREA.
      *----------  ポートフォリオ属性データ配列
           10  TBL-TKPFZK01-1.
             15  TBL-TKPFZK01             OCCURS  101.
               COPY  'TKPFZK01.cpy'.
      *----------  有効件数
           10  YUUKOU-KENSUU       PIC  9(04).
      *----------  CNT-IDX
         05  WK-CNT-IDX            PIC  9(04).
      *----------  ワーク合計件数
         05  WK-GOUKEI-KENSUU      PIC  9(04).
      *----------  ワーク区間件数
         05  WK-KUKAN-KENSUU       PIC  9(04).
      *----------  基準日断面情報情報ホスト表
         05  WK-TBL-TKMZBW02-AREA.
           10  WK-TBL-TKMZBW02-H         OCCURS  100.
      *---------- 基準日
             15  WK-KJN-YMD        PIC  S9(08).
      *---------- 順番
             15  WK-JUNBAN         PIC  S9(07).
      *---------- 開始基準日
             15  WK-KAISI-KJN-YMD  PIC  S9(08).
      *---------- 開始基準日の翌日
             15  WK-KAISI-KJN-YMD-NEXT
                                   PIC  S9(08).
      *---------- 基準日種類
             15  WK-KJN-YMD-SHRU   PIC  X(01).
      *---------- 基準日断面作成区分
             15  WK-KJN-YMD-DMN-SK-KBN
                                   PIC  X(01).
      *---------- 計算パターン
             15  WK-CALC-PTN       PIC  X(01).
      *---------- 仕訳基準パターンコード
             15  WK-SWK-KJN-PTN-CD PIC  X(08).
      *---------- 基本会計ベースフラグ
             15  WK-KH-KAIKEI-BASE-FLG
                                   PIC  X(01).
      *---------- 測定基準区分
             15  WK-ST-KJN-KBN     PIC  X(01).
      *---------- 進捗ステータス（開始基準日）
             15  WK-STK-STS-KS-KJN-YMD
                                   PIC  X(03).
      *---------- 進捗ステータス（基準日）
             15  WK-STK-STS-KJN-YMD
                                   PIC  X(03).
      *---------- 異動計算パターンコード
             15  WK-IDO-CALC-PATTERN-CD
                                   PIC  X(04).
      *---------- 保有目的
             15  WK-POSSESSION-OBJECT
                                   PIC  X(01).
      *---------- 運用通貨コード
             15  WK-CAPITAL-TUKA-CD
                                   PIC  X(04).
      *---------- 日次評価法フラグ
             15  WK-NITIJI-HYK-FLG PIC  X(01).
      *---------- 料率パターンコード
             15  WK-COMMISSION-PATTERN
                                   PIC  X(04).
      *---------- 約定主義会計フラグ
             15  WK-YKJ-SYUGI-KAIKEI
                                   PIC  X(01).
      *---------- キャッシュフロー２回発生区分
             15  WK-CASH-FLOW-KBN  PIC  X(01).
      *---------- 約定レートコード
             15  WK-YKJ-RATE-CD    PIC  X(04).
      *---------- 未収配当計上割合
             15  WK-MISYU-HAITOU-WARIAI
                                   PIC  S9(08)V9(10).
      *----------  ワーク料率データエリア
         05  WK-TBL-TKCMRY00-AREA.
      *----------  料率データ配列
           10  TBL-TKCMRY00-1.
             15  TBL-TKCMRY00      OCCURS  1001.
      *----------  料率パターンコード
               20  COMMISSION-PATTERN
                                   PIC  X(04).
      *----------  料率区分
               20  RYORITU-KBN     PIC  X(01).
      *----------  国コード
               20  KUNI-CD         PIC  X(04).
      *----------  適用開始日
               20  TEKIYO-FROM     PIC  S9(08).
      *----------  適用終了日
               20  TEKIYO-TO       PIC  S9(08).
      *----------  証券種別コード
               20  SEC-SBT-CD      PIC  X(04).
      *----------  基準値
               20  KJN-TI          PIC  S9(15)V9(03).
      *----------  基準値TO
               20  KJN-TI-TO       PIC  S9(15)V9(03).
      *----------  料率
               20  RYORITU         PIC  S9(08)V9(10).
      *----------  有効件数
           10  YUUKOU-KENSUU       PIC  9(04).
      *---------- ワーク欠落断面有無フラグ
         05  WK-LACK-DMN-FLG       PIC  9(01).
         05  WK-MIDDLE-FREE-MSG    PIC  X(36).
         05  WK-MIDDLE-FREE-COUNT  PIC  9(02).
      *---------- ワーク欠落断面証券種別
         05  WK-LACK-DMN-SEC-SBT   PIC  X(04).
      *---------- ワーク欠落断面銘柄
         05  WK-LACK-DMN-MEG       PIC  X(20).
      *---------- 開始基準日の翌日
         05  WK-DMN-KJN-YMD-NEXT   PIC  S9(08).
      *----------  共通ルーチン、ヘッダ項目
       01  PARM-AIFA-HEADER.
      *----------  共通初期ルーチン
         05  PARM-WOMCMAIFA-ARG.
           COPY  "WOMCMAIFA.CPY".
      *----------  共通ヘッダ項目
         05  PARM-CZCOMMONHEADER-ARG.
           COPY  "CZCOMMONHEADER.cpy".
      *---------- 進捗管理なし断面の削除実行フラグ
         05  WK-SMZJ4019-FLG       PIC  9(01).
      ******************************************************************
      *                   電文  エリア
      ******************************************************************
       01  WK-DENBUN-INFO.
      *---------- AIFA情報
         05  WK-AIFA-IN.
           COPY  "WOMCMAIFA.CPY".
      *---------- 共通ヘッダ
         05  WK-HEADER-IN.
           COPY  "CZCOMMONHEADER.cpy".
      *---------- ワーク電文情報
         05  WK-DENBUN-IN.
           COPY  "INMMZJ0110_COBOL.cpy".
      ******************************************************************
      *                ORACLE ホスト変数定義
      ******************************************************************
      *---------- ＳＱＬコミュニケーション領域
           EXEC  SQL  INCLUDE  SQLCA             END-EXEC.
           EXEC  SQL  INCLUDE  ORACA             END-EXEC.
           EXEC  SQL  BEGIN   DECLARE   SECTION  END-EXEC.
       01  HOST-AREA.
      *---------- 取引差分更新管理 条件(別紙1-1)
         05  H-TKMZSK00-S.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 取引差分更新管理 (別紙1-1)
         05  H-TKMZSK00-1.
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 基準日断面情報 条件(別紙1-2)
         05  H-TKMZBW02-S.
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 基準日断面情報 (別紙1-2)
         05  H-TKMZBW02-2.
           10  H-TKMZBW02-2-VALUE         OCCURS  100.
      *---------- 基準日
             15  H-KJN-YMD         PIC  S9(08).
      *---------- 順番
             15  H-JUNBAN          PIC  S9(07).
      *---------- 開始基準日
             15  H-KAISI-KJN-YMD   PIC  S9(08).
      *---------- 開始基準日の翌日
             15  H-KAISI-KJN-YMD-NEXT
                                   PIC  S9(08).
      *---------- 基準日種類
             15  H-KJN-YMD-SHRU    PIC  X(01).
      *---------- 基準日断面作成区分
             15  H-KJN-YMD-DMN-SK-KBN
                                   PIC  X(01).
      *---------- 計算パターン
             15  H-CALC-PTN        PIC  X(01).
      *---------- 仕訳基準パターンコード
             15  H-SWK-KJN-PTN-CD  PIC  X(08).
      *---------- 基本会計ベースフラグ
             15  H-KH-KAIKEI-BASE-FLG
                                   PIC  X(01).
      *---------- 測定基準区分
             15  H-ST-KJN-KBN      PIC  X(01).
      *---------- 進捗ステータス（開始基準日）
             15  H-STK-STS-KS-KJN-YMD
                                   PIC  X(03).
      *---------- 進捗ステータス（基準日）
             15  H-STK-STS-KJN-YMD PIC  X(03).
      *---------- 異動計算パターンコード
             15  H-IDO-CALC-PATTERN-CD
                                   PIC  X(04).
      *---------- 保有目的
             15  H-POSSESSION-OBJECT
                                   PIC  X(01).
      *---------- 運用通貨コード
             15  H-CAPITAL-TUKA-CD PIC  X(04).
      *---------- 日次評価法フラグ
             15  H-NITIJI-HYK-FLG  PIC  X(01).
      *---------- 料率パターンコード
             15  H-COMMISSION-PATTERN
                                   PIC  X(04).
      *---------- 約定主義会計フラグ
             15  H-YKJ-SYUGI-KAIKEI
                                   PIC  X(01).
      *---------- キャッシュフロー２回発生区分
             15  H-CASH-FLOW-KBN   PIC  X(01).
      *---------- 約定レートコード
             15  H-YKJ-RATE-CD     PIC  X(04).
      *---------- 未収配当計上割合
             15  H-MISYU-HAITOU-WARIAI
                                   PIC  S9(08)V9(10).
      *---------- 銘柄別断面情報 条件(別紙1-3)
         05  H-TKMZBW03-S.
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 基準日断面情報
           10  H-DMKJN-YMD-S1      PIC  S9(08).
           10  H-DMKJN-YMD-S2      PIC  S9(08).
      *---------- 銘柄別断面情報 (別紙1-3)
         05  H-TKMZBW03-3.
      *---------- 銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 玉ID
           10  H-GYOKU-ID          PIC  X(10).
      *---------- 市場通貨コード
           10  H-SIJO-TUKA-CD      PIC  X(04).
      *---------- 差分更新From日
           10  H-SABON-UPDATE-FROM PIC  S9(08).
      *---------- 銘柄種類
           10  H-MEG-CD-SHRU       PIC  X(01).
      *---------- 再計算区分
           10  H-SAI-CALC-KBN      PIC  X(01).
      *---------- 銘柄種類２
           10  H-MEG-CD-SHRU2      PIC  X(01).
      *---------- 取引事由順
           10  H-TORI-JIYU-JUN     PIC  S9(04).
      *---------- 対象取引情報 条件(別紙1-4)
         05  H-TKMZBW04-S.
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 玉ID
           10  H-GYOKU-ID          PIC  X(10).
      *---------- 対象取引情報 (別紙1-4)
         05  H-TKMZBW04-4.
      *---------- 原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *---------- 受渡日
           10  H-UKE-YMD           PIC  S9(08).
      *---------- 計上基準日
           10  H-KEIJOU-KIJUNBI    PIC  S9(08).
      *---------- 増幅赤黒区分
           10  H-ZOFKU-AKA-KBN     PIC  X(01).
      *---------- 増幅区分
           10  H-ZOFKU-KBN         PIC  X(01).
      *---------- 増幅元異動計上基準日
           10  H-ZOFKUMT-KJ-KIJUNBI
                                   PIC  S9(08).
      *---------- 処理順
           10  H-SRJUN             PIC  S9(08).
      *---------- 対象資金取引情報 条件(別紙1-5)
         05  H-TKMZBW05-S.
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 玉ID
           10  H-GYOKU-ID          PIC  X(10).
      *---------- 対象資金取引情報  (別紙1-5)
         05  H-TKMZBW05-5.
      *---------- 原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *---------- 資金種別
           10  H-SIKIN-SBT         PIC  X(01).
      *---------- 異動日
           10  H-IDO-YMD           PIC  S9(08).
      *---------- 増減区分
           10  H-ZG-KBN            PIC  X(01).
      *---------- 処理順
           10  H-SRJUN             PIC  S9(08).
      *---------- 受渡計上切替対象フラグ
           10  H-UKE-KIRIKAE-FLG   PIC  X(01).
      *---------- 切替仕訳基準パターンコード
           10  H-KK-SWK-KJN-PTN-CD PIC  X(08).
      *---------- 切替キャッシュフロー2回有効フラグ
           10  H-KK-CF-NK-YK-FLG   PIC  X(01).
      *---------- 切替基本会計ベースフラグ
           10  H-KK-KH-KK-BASE-FLG PIC  X(01).
      *---------- 受渡未払未収増幅フラグ
           10  H-UKE-MBMS-ZF-FLG   PIC  X(01).
      *---------- 実行状況管理明細 条件(別紙1-7)
         05  H-TKDYAA35-UPDATE.
      *---------- 計算From日
           10  H-CALC-FROM         PIC  S9(08).
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 評価系列コード
           10  H-HYK-KRTU-CD       PIC  X(04).
      *---------- 帳票ID
           10  H-REP-ID            PIC  X(08).
      *---------- 帳票任意コード
           10  H-REP-ANY-CD        PIC  X(50).
      *---------- 基準日FROM
           10  H-KJN-YMD-FROM      PIC  S9(08).
      *---------- 取引 条件(別紙1-8)
         05  H-TKMXTR00-S.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 原取引ＩＤ
           10  H-TORI-ID           PIC  S9(10).
      *---------- ワーク取引データ (別紙1-8)
         05  H-TKMXTR00-8.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 原取引ID
           10  H-TORI-ID           PIC  S9(10).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *---------- 玉ID
           10  H-GYOKU-ID          PIC  X(10).
      *---------- 保有目的
           10  H-POSSESSION-OBJECT
                                   PIC  X(01).
      *---------- 取引連関ＩＤ
           10  H-THRK-ID           PIC  S9(10).
      *---------- ダミー区分
           10  H-DUMMY-KBN         PIC  X(01).
      *---------- 約定日
           10  H-YKJ-YMD           PIC  S9(08).
      *---------- 受渡日
           10  H-UKE-YMD           PIC  S9(08).
      *---------- 取引内容
           10  H-TORI-NAIY         PIC  X(04).
      *---------- 取引事由
           10  H-TORI-JIYU         PIC  X(04).
      *---------- 資金決済方法
           10  H-KESAI-HOHO        PIC  X(01).
      *---------- 異動数量
           10  H-IDO-SURYO         PIC  S9(12)V9(06).
      *---------- 権利数量
           10  H-KENRI-SURYO       PIC  S9(12)V9(06).
      *---------- 数量単位
           10  H-SURYO-TANI        PIC  S9(12)V9(06).
      *---------- 市場通貨コード
           10  H-SIJO-TUKA-CD      PIC  X(04).
      *---------- 現地通貨コード
           10  H-G-TUKA-CD         PIC  X(04).
      *---------- 為替レート（現地／運用）１
           10  H-G-U-KWS1          PIC  S9(08)V9(10).
      *---------- 為替レート（現地／運用）２
           10  H-G-U-KWS2          PIC  S9(08)V9(10).
      *---------- 為替レート（現地／市場）
           10  H-G-S-KWS           PIC  S9(08)V9(10).
      *---------- 為替レート（市場／運用）
           10  H-S-U-KWS           PIC  S9(08)V9(10).
      *---------- 円レート（現地／円）
           10  H-G-YEN-KWS         PIC  S9(08)V9(10).
      *---------- 経過利息為替レート
           10  H-KEKA-RSK-KWS      PIC  S9(08)V9(10).
      *---------- 約定金額（運用通貨換算額）
           10  H-U-KSG-G-YJKG      PIC  S9(15)V9(03).
      *---------- 現地手数料（運用通貨換算額）
           10  H-U-KSG-G-TSR       PIC  S9(15)V9(03).
      *---------- 現地消費税（運用通貨換算額）
           10  H-U-KSG-G-SHZ       PIC  S9(15)V9(03).
      *---------- 現地その他費用（運用通貨換算額）
           10  H-U-KSG-G-THY       PIC  S9(15)V9(03).
      *---------- 現地源泉税（運用通貨換算額）
           10  H-U-KSG-G-GSZ       PIC  S9(15)V9(03).
      *---------- 既経過利息（運用通貨換算額）
           10  H-U-KSG-G-KKKRS     PIC  S9(15)V9(03).
      *---------- 日歩（運用通貨換算額）
           10  H-U-KSG-HIBU        PIC  S9(15)V9(03).
      *---------- 逆日歩（運用通貨換算額）
           10  H-U-KSG-GHIBU       PIC  S9(15)V9(03).
      *---------- 管理費（運用通貨換算額）
           10  H-U-KSG-KRH         PIC  S9(15)V9(03).
      *---------- 管理費消費税（運用通貨換算額）
           10  H-U-KSG-KRH-SHZ     PIC  S9(15)V9(03).
      *---------- 運用国手数料（運用通貨換算額）
           10  H-U-KSG-U-TSR       PIC  S9(15)V9(03).
      *---------- 運用国消費税（運用通貨換算額）
           10  H-U-KSG-U-SHZ       PIC  S9(15)V9(03).
      *---------- 運用国その他費用（運用通貨換算額）
           10  H-U-KSG-U-THY       PIC  S9(15)V9(03).
      *---------- 国内源泉税（運用通貨換算額）
           10  H-NAI-TAX-U-KSG     PIC  S9(15)V9(03).
      *---------- 精算金額（運用通貨換算額）
           10  H-U-KSG-G-SSKG      PIC  S9(15)V9(03).
      *---------- 入出金額（約定レート・運用通貨換算額）
           10  H-NSKG-Y-UY         PIC  S9(15)V9(03).
      *---------- 入出金額（決済レート・運用通貨換算額）
           10  H-NSKG-K-UY         PIC  S9(15)V9(03).
      *---------- 為替差損益
           10  H-UYTK-KWS-SNEKI    PIC  S9(15)V9(03).
      *---------- 約定金額（市場通貨換算額）
           10  H-S-KSG-G-YJKG      PIC  S9(15)V9(03).
      *---------- 現地手数料（市場通貨換算額）
           10  H-S-KSG-G-TSR       PIC  S9(15)V9(03).
      *---------- 現地消費税（市場通貨換算額）
           10  H-S-KSG-G-SHZ       PIC  S9(15)V9(03).
      *---------- 現地その他費用（市場通貨換算額）
           10  H-S-KSG-G-THY       PIC  S9(15)V9(03).
      *---------- 現地源泉税（市場通貨換算額）
           10  H-S-KSG-G-GSZ       PIC  S9(15)V9(03).
      *---------- 既経過利息（市場通貨換算額）
           10  H-S-KSG-G-KKKRS     PIC  S9(15)V9(03).
      *---------- 日歩（市場通貨換算額）
           10  H-S-KSG-HIBU        PIC  S9(15)V9(03).
      *---------- 逆日歩（市場通貨換算額）
           10  H-S-KSG-GHIBU       PIC  S9(15)V9(03).
      *---------- 管理費（市場通貨換算額）
           10  H-S-KSG-KRH         PIC  S9(15)V9(03).
      *---------- 管理費消費税（市場通貨換算額）
           10  H-S-KSG-KRH-SHZ     PIC  S9(15)V9(03).
      *---------- 運用国手数料（市場通貨換算額）
           10  H-S-KSG-U-TSR       PIC  S9(15)V9(03).
      *---------- 運用国消費税（市場通貨換算額）
           10  H-S-KSG-U-SHZ       PIC  S9(15)V9(03).
      *---------- 運用国その他費用（市場通貨換算額）
           10  H-S-KSG-U-THY       PIC  S9(15)V9(03).
      *---------- 国内源泉税（市場通貨換算額）
           10  H-S-KSG-U-GSZ       PIC  S9(15)V9(03).
      *---------- 精算金額（市場通貨換算額）
           10  H-S-KSG-SSKG        PIC  S9(15)V9(03).
      *---------- 決済口座１
           10  H-KOZA1-NO          PIC  X(15).
      *---------- 決済口座１通貨コード
           10  H-KOZA1-TUKA-CD     PIC  X(04).
      *---------- 決済口座１入出金額
           10  H-KOZA1-NSKG        PIC  S9(15)V9(03).
      *---------- 決済口座１入出金額（運用通貨換算額）
           10  H-KOZA1-U-KSG-NSKG  PIC  S9(15)V9(03).
      *---------- 決済口座２
           10  H-KOZA2-NO          PIC  X(15).
      *---------- 決済口座２通貨コード
           10  H-KOZA2-TUKA-CD     PIC  X(04).
      *---------- 決済口座２入出金額
           10  H-KOZA2-NSKG        PIC  S9(15)V9(03).
      *---------- 決済口座２入出金額（運用通貨換算額）
           10  H-KOZA2-U-KSG-NSKG  PIC  S9(15)V9(03).
      *---------- 還付予定額
           10  H-KANP-YOTEGK       PIC  S9(15)V9(03).
      *---------- 調整損益
           10  H-CHOSEI-SNEKI      PIC  S9(15)V9(03).
      *---------- 経過利息区分
           10  H-KKRS-KBN          PIC  X(01).
      *---------- 効力発生日
           10  H-KOURYOKU-YMD      PIC  S9(08).
      *---------- スタート日（放出日）
           10  H-ST-YMD            PIC  S9(08).
      *---------- 約定ベースエンド日
           10  H-YKJ-END-YMD       PIC  S9(08).
      *---------- 受渡ベースエンド日
           10  H-UKE-END-YMD       PIC  S9(08).
      *---------- 運用日数
           10  H-UNYO-NISU         PIC  S9(03).
      *---------- 受取利息金額
           10  H-UKETR-RSK-KG      PIC  S9(15)V9(03).
      *---------- 商品別取引区分
           10  H-SHB-TORI-KBN      PIC  X(01).
      *---------- 異動確定区分
           10  H-IDO-KBN           PIC  X(01).
      *---------- １口注文ＩＤ
           10  H-ORDR-1K-ID        PIC  S9(10).
      *---------- 対象取引ＩＤ
           10  H-TARGET-TORI-ID    PIC  S9(10).
      *---------- 現地ブローカー
           10  H-G-BRK             PIC  X(04).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 投資対象国コード
           10  H-TSTSK-CD          PIC  X(04).
      *---------- 発行国コード
           10  H-HAKO-CD           PIC  X(04).
      *---------- 約定金額
           10  H-G-YJKG            PIC  S9(15)V9(03).
      *---------- 約定単価
           10  H-YKJ-TANKA         PIC  S9(08)V9(10).
      *---------- 現地入出金額
           10  H-G-NSKG            PIC  S9(15)V9(03).
      *---------- ワーク相対取引データ (別紙1-8)
         05  H-TKMXTR01-8.
      *---------- 取引連関ＩＤ
           10  H-THRK-ID           PIC  S9(10).
      *---------- 建時単価
           10  H-TATE-TANKA        PIC  S9(08)V9(10).
      *---------- 決済単価
           10  H-KS-TANKA          PIC  S9(08)V9(10).
      *---------- 権利行使価格
           10  H-KRKS-KKK          PIC  S9(08)V9(10).
      *---------- 権利行使金額（運用通貨）
           10  H-U-KSG-KRKS-KG     PIC  S9(15)V9(03).
      *---------- 決済約定金額（運用通貨）
           10  H-U-KSG-KS-YJKG     PIC  S9(15)V9(03).
      *---------- 決済現地手数料（運用通貨）
           10  H-U-KSG-KS-G-TSR    PIC  S9(15)V9(03).
      *---------- 決済現地消費税（運用通貨）
           10  H-U-KSG-KS-G-SHZ    PIC  S9(15)V9(03).
      *---------- 決済現地その他費用（運用通貨）
           10  H-U-KSG-KS-G-THY    PIC  S9(15)V9(03).
      *---------- 決済運用国手数料（運用通貨）
           10  H-U-KSG-KS-U-TSR    PIC  S9(15)V9(03).
      *---------- 決済運用国消費税（運用通貨）
           10  H-U-KSG-KS-U-SHZ    PIC  S9(15)V9(03).
      *---------- 決済運用国その他費用（運用通貨）
           10  H-U-KSG-KS-U-THY    PIC  S9(15)V9(03).
      *---------- 日歩（運用通貨）
           10  H-U-KSG-HIBU        PIC  S9(15)V9(03).
      *---------- 逆日歩（運用通貨）
           10  H-U-KSG-GHIBU       PIC  S9(15)V9(03).
      *---------- 管理費（運用通貨）
           10  H-U-KSG-KRH         PIC  S9(15)V9(03).
      *---------- 管理費消費税（運用通貨）
           10  H-U-KSG-KRH-SHZ     PIC  S9(15)V9(03).
      *---------- 建時約定金額（運用通貨）
           10  H-U-KSG-TH-YJKG     PIC  S9(15)V9(03).
      *---------- 建時現地手数料（運用通貨）
           10  H-U-KSG-TH-G-TSR    PIC  S9(15)V9(03).
      *---------- 建時現地消費税（運用通貨）
           10  H-U-KSG-TH-G-SHZ    PIC  S9(15)V9(03).
      *---------- 建時現地その他費用（運用通貨）
           10  H-U-KSG-TH-G-THY    PIC  S9(15)V9(03).
      *---------- 建時運用国手数料（運用通貨）
           10  H-U-KSG-TH-U-TSR    PIC  S9(15)V9(03).
      *---------- 建時運用国消費税（運用通貨）
           10  H-U-KSG-TH-U-SHZ    PIC  S9(15)V9(03).
      *---------- 建時運用国その他費用（運用通貨）
           10  H-U-KSG-TH-U-THY    PIC  S9(15)V9(03).
      *---------- 建時ＯＰ約定金額（運用通貨）
           10  H-U-KSG-TH-OP-YJKG  PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地手数料（運用通貨）
           10  H-U-KSG-TH-OP-G-TSR PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地消費税（運用通貨）
           10  H-U-KSG-TH-OP-G-SHZ PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地その他費用（運用通貨）
           10  H-U-KSG-TH-OP-G-THY PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国手数料（運用通貨）
           10  H-U-KSG-TH-OP-U-TSR PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国消費税（運用通貨）
           10  H-U-KSG-TH-OP-U-SHZ PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国その他費用（運用通貨）
           10  H-U-KSG-TH-OP-U-THY PIC  S9(15)V9(03).
      *---------- 引継ＯＰ約定金額（運用通貨）
           10  H-U-KSG-HTOP-YJKG   PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地手数料（運用通貨）
           10  H-U-KSG-HTOP-G-TSR  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地消費税（運用通貨）
           10  H-U-KSG-HTOP-G-SHZ  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地その他費用（運用通貨）
           10  H-U-KSG-HTOP-G-THY  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国手数料（運用通貨）
           10  H-U-KSG-HTOP-U-TSR  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国消費税（運用通貨）
           10  H-U-KSG-HTOP-U-SHZ  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国その他費用（運用通貨）
           10  H-U-KSG-HTOP-U-THY  PIC  S9(15)V9(03).
      *---------- 権利行使金額（市場通貨）
           10  H-S-KSG-KRKS-KG     PIC  S9(15)V9(03).
      *---------- 決済約定金額（市場通貨）
           10  H-S-KSG-KS-YJKG     PIC  S9(15)V9(03).
      *---------- 決済現地手数料（市場通貨）
           10  H-S-KSG-KS-G-TSR    PIC  S9(15)V9(03).
      *---------- 決済現地消費税（市場通貨）
           10  H-S-KSG-KS-G-SHZ    PIC  S9(15)V9(03).
      *---------- 決済現地その他費用（市場通貨）
           10  H-S-KSG-KS-G-THY    PIC  S9(15)V9(03).
      *---------- 決済運用国手数料（市場通貨）
           10  H-S-KSG-KS-U-TSR    PIC  S9(15)V9(03).
      *---------- 決済運用国消費税（市場通貨）
           10  H-S-KSG-KS-U-SHZ    PIC  S9(15)V9(03).
      *---------- 決済運用国その他費用（市場通貨）
           10  H-S-KSG-KS-U-THY    PIC  S9(15)V9(03).
      *---------- 日歩（市場通貨）
           10  H-S-KSG-HIBU        PIC  S9(15)V9(03).
      *---------- 逆日歩（市場通貨）
           10  H-S-KSG-GHIBU       PIC  S9(15)V9(03).
      *---------- 管理費（市場通貨）
           10  H-S-KSG-KRH         PIC  S9(15)V9(03).
      *---------- 管理費消費税（市場通貨）
           10  H-S-KSG-KRH-SHZ     PIC  S9(15)V9(03).
      *---------- 建時約定金額（市場通貨）
           10  H-S-KSG-TH-YJKG     PIC  S9(15)V9(03).
      *---------- 建時現地手数料（市場通貨）
           10  H-S-KSG-TH-G-TSR    PIC  S9(15)V9(03).
      *---------- 建時現地消費税（市場通貨）
           10  H-S-KSG-TH-G-SHZ    PIC  S9(15)V9(03).
      *---------- 建時現地その他費用（市場通貨）
           10  H-S-KSG-TH-G-THY    PIC  S9(15)V9(03).
      *---------- 建時運用国手数料（市場通貨）
           10  H-S-KSG-TH-U-TSR    PIC  S9(15)V9(03).
      *---------- 建時運用国消費税（市場通貨）
           10  H-S-KSG-TH-U-SHZ    PIC  S9(15)V9(03).
      *---------- 建時運用国その他費用（市場通貨）
           10  H-S-KSG-TH-U-THY    PIC  S9(15)V9(03).
      *---------- 建時ＯＰ約定金額（市場通貨）
           10  H-S-KSG-TH-OP-YJKG  PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地手数料（市場通貨）
           10  H-S-KSG-TH-OP-G-TSR PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地消費税（市場通貨）
           10  H-S-KSG-TH-OP-G-SHZ PIC  S9(15)V9(03).
      *---------- 建時ＯＰ現地その他費用（市場通貨）
           10  H-S-KSG-TH-OP-G-THY PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国手数料（市場通貨）
           10  H-S-KSG-TH-OP-U-TSR PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国消費税（市場通貨）
           10  H-S-KSG-TH-OP-U-SHZ PIC  S9(15)V9(03).
      *---------- 建時ＯＰ運用国その他費用（市場通貨）
           10  H-S-KSG-TH-OP-U-THY PIC  S9(15)V9(03).
      *---------- 引継ＯＰ約定金額（市場通貨）
           10  H-S-KSG-HTOP-YJKG   PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地手数料（市場通貨）
           10  H-S-KSG-HTOP-G-TSR  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地消費税（市場通貨）
           10  H-S-KSG-HTOP-G-SHZ  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ現地その他費用（市場通貨）
           10  H-S-KSG-HTOP-G-THY  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国手数料（市場通貨）
           10  H-S-KSG-HTOP-U-TSR  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国消費税（市場通貨）
           10  H-S-KSG-HTOP-U-SHZ  PIC  S9(15)V9(03).
      *---------- 引継ＯＰ運用国その他費用（市場通貨）
           10  H-S-KSG-HTOP-U-THY  PIC  S9(15)V9(03).
      *---------- 建時現地約定日
           10  H-TATE-G-YKJ-YMD    PIC  S9(08).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 処理資金取引 条件(別紙1-10)
         05  H-TKMZBW18-S.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 原取引ＩＤ
           10  H-TORI-ID           PIC  S9(10).
      *---------- 決済口座番号
           10  H-KS-KOZA-NO        PIC  X(15).
      *---------- 資金種別
           10  H-SIKIN-SBT         PIC  X(01).
      *---------- 異動日
           10  H-IDO-YMD           PIC  S9(08).
      *---------- 増減区分
           10  H-ZG-KBN            PIC  X(01).
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- 処理資金取引 (別紙1-10)
         05  H-TKMZBW18-10.
      *---------- 決済口座通貨コード
           10  H-KOZA-TUKA-CD      PIC  X(04).
      *---------- 取引連関ＩＤ
           10  H-THRK-ID           PIC  S9(10).
      *---------- 決済通貨異動額
           10  H-KSTK-IDOG         PIC  S9(15)V9(03).
      *---------- 運用通貨異動額
           10  H-UYTK-IDOG         PIC  S9(15)V9(03).
      *---------- 異動確定区分
           10  H-IDO-KBN           PIC  X(01).
      *---------- 市場通貨コード
           10  H-SIJO-TUKA-CD      PIC  X(04).
      *---------- 取引事由
           10  H-TORI-JIYU         PIC  X(04).
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *---------- 取引内容
           10  H-TORI-NAIY         PIC  X(04).
      *----------  残高異動計算データTBL(別紙1-11)
         05  H-TKMZBW06-1-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *----------  起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *----------  資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *----------  玉ＩＤ
           10  H-GYOKU-ID          PIC  X(10).
      *----------  異動計上順序
           10  H-IDO-KJY-JUN       PIC  S9(08).
      *----------  残高異動計算データTBL(別紙1-11)
         05  H-TKMZBW06-1.
      *----------  取引事由
           10  H-TORI-JIYU         PIC  X(04).
      *----------  市場通貨払出単価
           10  H-SJTK-H-TNK        PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  H-UYTK-H-TNK        PIC  S9(08)V9(10).
      *----------  残高異動TBL(別紙1-12)
         05  H-TKMZZI00-1-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *----------  資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *----------  玉ＩＤ
           10  H-GYOKU-ID          PIC  X(10).
      *----------  計上基準日
           10  H-KEIJOU-KIJUNBI    PIC  S9(08).
      *----------  残高異動TBL(別紙1-12)
         05  H-TKMZZI00-1.
      *----------  取引事由
           10  H-TORI-JIYU         PIC  X(04).
      *----------  市場通貨払出単価
           10  H-SJTK-H-TNK        PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  H-UYTK-H-TNK        PIC  S9(08)V9(10).
      *----------  残高履歴TBL(別紙1-13)
         05  H-TKMZZR00-1-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *----------  資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *----------  玉ＩＤ
           10  H-GYOKU-ID          PIC  X(10).
      *----------  基準日
           10  H-KJN-YMD           PIC  S9(08).
      *----------  残高履歴TBL(別紙1-13)
         05  H-TKMZZR00-1.
      *----------  市場通貨未収収益計上・戻入額
           10  H-SJTK-MSSE-KJMIG   PIC  S9(15)V9(03).
      *----------  運用通貨未収収益計上・戻入額
           10  H-UYTK-MSSE-KJMIG   PIC  S9(15)V9(03).
      *----------  市場通貨払出単価
           10  H-SJTK-HARAID-TNK   PIC  S9(08)V9(10).
      *----------  運用通貨払出単価
           10  H-UYTK-HARAID-TNK   PIC  S9(08)V9(10).
      *----------  同一コスト継続フラグ
           10  H-SAME-COST-KZK-FLG PIC  X(01).
      *----------  取引差分更新管理TBL(別紙1-6)
         05  H-TKMZSK00-1-S.
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  差分計算開始日 （約定）/（受渡）
           10  H-KAISI-KJN-YMD     PIC  S9(08).
      *----------  取引差分更新管理TBL(別紙1-6)
         05  H-TKMZSK00-2.
      *----------  証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 玉ID
           10  H-GYOKU-ID          PIC  X(10).
      *---------- 市場通貨コード
           10  H-SIJO-TUKA-CD      PIC  X(04).
      *----------  差分計算開始日 （約定）/（受渡）
           10  H-KAISI-KJN-YMD     PIC  S9(08).
         05  H-TKMZSK00-UPDATE.
      *----------  証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *----------  利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *----------  ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *----------  ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *----------  銘柄コード
           10  H-MEG-CD            PIC  X(15).
         05  H-TKMZBW03-UPDATE.
      *----------  証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 玉ID
           10  H-GYOKU-ID          PIC  X(10).
      *---------- 銘柄種類
           10  H-MEG-CD-SHRU       PIC  X(01).
      *---------- 商品属性  別紙1-16
         05  H-TKCMSZ00.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
         05  H-TKCMSZ00-S.
      *---------- 証券種別コード
           10  H-SEC-SBT-CD        PIC  X(04).
      *---------- 管理数量単位
           10  H-KANRI-SURYO-TANI  PIC  S9(12)V9(06).
      *---------- 取引属性  別紙1-17
         05  H-TKCMTZ00.
      *---------- 取引事由コード
           10  H-TRHK-JIYU-CD      PIC  X(04).
      *---------- 実行状況管理明細 条件(別紙1-18)
         05  H-TKDYAA35-UPDATE-2.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 評価系列コード
           10  H-HYK-KRTU-CD       PIC  X(04).
      *---------- 帳票ID
           10  H-REP-ID            PIC  X(08).
      *---------- 帳票任意コード
           10  H-REP-ANY-CD        PIC  X(50).
      *---------- 別紙1-20
         05  H-PTF.
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 計算期間FROM
           10  H-CALC-KKN-FROM     PIC  S9(08).
      *---------- 計算期間TO
           10  H-CALC-KKN-TO       PIC  S9(08).
      *---------- 別紙1-21 条件
         05  H-TKDYGP17.
      *---------- 業務タスクＩＤ
           10  H-GYOMU-TASK-ID     PIC  X(07).
      *---------- 更新ログインユーザ会社コード
           10  H-UPD-LOGIN-CMP-CD  PIC  X(04).
      *---------- 更新ユーザＩＤ
           10  H-UPD-SID           PIC  X(20).
      *---------- 更新プログラムＩＤ
           10  H-UPD-PGMID         PIC  X(16).
         05  H-TKDYGP17-W.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 別紙1-21
         05  H-TKDYGP17-1.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 残高基準日FROM
           10  H-ZN-KJN-YMD-FROM   PIC  S9(08).
      *---------- 残高基準日TO
           10  H-ZN-KJN-YMD-TO     PIC  S9(08).
      *---------- 資金残履歴 条件(別紙1-19)
         05  H-TKMZSR00-1-S.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 決済口座番号
           10  H-KS-KOZA-NO        PIC  X(15).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 資金残履歴 (別紙1-19)
         05  H-TKMZSR00-1.
      *----------  市場通貨未収収益計上・戻入額
           10  H-SJTK-MSSE-KJMIG   PIC  S9(15)V9(03).
      *----------  運用通貨未収収益計上・戻入額
           10  H-UYTK-MSSE-KJMIG   PIC  S9(15)V9(03).
      *---------- 取引差分更新 (別紙1-22)
         05  H-TKMZSK00-22.
      *---------- 差分計算開始日
           10  H-SBN-CALC-FROM     PIC  S9(08).
      *---------- 最終有効日
           10  H-LAST-YUKO-YMD     PIC  S9(08).
      *---------- 更新ログインユーザ会社コード
           10  H-UPD-LOGIN-CMP-CD  PIC  X(04).
      *---------- 更新ユーザＩＤ
           10  H-UPD-SID           PIC  X(20).
      *---------- 更新プログラムＩＤ
           10  H-UPD-PGMID         PIC  X(16).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 処理実行日
           10  H-SYORI-YMD         PIC  S9(08).
      *---------- 起動ID
           10  H-KIDOU-ID          PIC  X(04).
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 資金残履歴 (別紙1-23)
         05  H-TKMZSR00-23-S.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
         05  H-TKMZSR00-23-W.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 決済口座番号
           10  H-KS-KOZA-NO        PIC  X(15).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 資金取引 (別紙1-24)
         05  H-TKMXST00-24-S.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
         05  H-TKMXST00-24-W.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 決済口座番号
           10  H-KS-KOZA-NO        PIC  X(15).
      *---------- 開始基準日
           10  H-KAISI-KJN-YMD     PIC  S9(08).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
      *---------- 未収収益 (別紙1-25)
         05  H-TKMZMS00-25-S.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
         05  H-TKMZMS00-25-W.
      *---------- 利用会社コード
           10  H-RIYO-CMP-CD       PIC  X(04).
      *---------- ファンドコード
           10  H-FUND-CD           PIC  X(12).
      *---------- ポートフォリオコード
           10  H-PTF-CD            PIC  X(04).
      *---------- 銘柄コード
           10  H-MEG-CD            PIC  X(15).
      *---------- 資産負債・買建売建フラグ
           10  H-TATE-FLG          PIC  X(01).
      *---------- 玉ID
           10  H-GYOKU-ID          PIC  X(10).
      *---------- 開始基準日
           10  H-KAISI-KJN-YMD     PIC  S9(08).
      *---------- 基準日
           10  H-KJN-YMD           PIC  S9(08).
         05  SQLSTMT               PIC  X(5000).
         05  SQLSTMT1              PIC  X(150).                         @3212SEINO@@
         05  SQLSTMT2              PIC  X(600).                         @3212SEINO@@
         05  SQLSTMT3              PIC  X(1600).                        @3212SEINO@@
         05  SQLSTMT3-1            PIC  X(1600).                        @3212SEINO@@
         05  SQLSTMT4              PIC  X(450).                         @3212SEINO@@
         05  SQLSTMT5              PIC  X(500).                         @3212SEINO@@
         05  SQLSTMT6              PIC  X(350).                         @3212SEINO@@
         05  SQLSTMT6-1            PIC  X(350).                         @3212SEINO@@
         05  SQLSTMT7              PIC  X(400).                         @3212SEINO@@
         05  SQLSTMT8              PIC  X(3100).                        @3212SEINO@@
         05  SQLSTMT10             PIC  X(400).                         @3212SEINO@@
         05  SQLSTMT11             PIC  X(650).                         @3212SEINO@@
         05  SQLSTMT12             PIC  X(600).                         @3212SEINO@@
         05  SQLSTMT13             PIC  X(450).                         @3212SEINO@@
         05  SQLSTMT15             PIC  X(400).                         @3212SEINO@@
         05  SQLSTMT18             PIC  X(350).                         @3212SEINO@@
         05  SQLSTMT19             PIC  X(300).                         @3212SEINO@@
         05  SQLSTMT22             PIC  X(1000).
         05  SQLSTMT23             PIC  X(500).
         05  SQLSTMT24             PIC  X(500).
         05  SQLSTMT25             PIC  X(500).
         05  WK-MEG-22             PIC  X(1000).
         05  H-CNS-KENSUU          PIC  S9(03) COMP VALUE 100.
           EXEC  SQL  END DECLARE       SECTION  END-EXEC.
      ******************************************************************
      *                SQL  エリア
      ******************************************************************
       01  SQL-AREA.
      *---------- SELECT SQL文(別紙1-1)
         05  SQL-SELECT-1-1.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(06)  VALUE "PTF_CD".
           10  SQL-FROM.
             15  FILLER            PIC  X(06)  VALUE " FROM ".
             15  SQL-TKMZSK00      PIC  X(13).
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(29)  VALUE
                 " RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- FOR UPDATE
             15  FILLER            PIC  X(18)  VALUE
                 " FOR UPDATE NOWAIT".
      *---------- SELECT SQL文(別紙1-2)
         05  SQL-SELECT-1-2.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 基準日
             15  FILLER            PIC  X(08)  VALUE "KJN_YMD,".
      *---------- 順番
             15  FILLER            PIC  X(08)  VALUE " JUNBAN,".
      *---------- 開始基準日
             15  FILLER            PIC  X(15)  VALUE " KAISI_KJN_YMD,".
      *---------- 開始基準日の翌日
             15  FILLER            PIC  X(20)  VALUE
                 " KAISI_KJN_YMD_NEXT,".
      *---------- 基準日種類
             15  FILLER            PIC  X(14)  VALUE " KJN_YMD_SHRU,".
      *---------- 基準日断面作成区分
             15  FILLER            PIC  X(20)  VALUE
                 " KJN_YMD_DMN_SK_KBN,".
      *---------- 計算パターン
             15  FILLER            PIC  X(10)  VALUE " CALC_PTN,".
      *---------- 仕訳基準パターンコード
             15  FILLER            PIC  X(16)  VALUE " SWK_KJN_PTN_CD,".
      *---------- 基本会計ベースフラグ
             15  FILLER            PIC  X(20)  VALUE
                 " KH_KAIKEI_BASE_FLG,".
      *---------- 測定基準区分
             15  FILLER            PIC  X(12)  VALUE " ST_KJN_KBN,".
      *---------- 進捗ステータス（開始基準日）
             15  FILLER            PIC  X(20)  VALUE
                 " STK_STS_KS_KJN_YMD,".
      *---------- 進捗ステータス（基準日）
             15  FILLER            PIC  X(17)  VALUE
                 " STK_STS_KJN_YMD,".
      *---------- 異動計算パターンコード
             15  FILLER            PIC  X(21)  VALUE
                 " IDO_CALC_PATTERN_CD,".
      *---------- 保有目的
             15  FILLER            PIC  X(19)  VALUE
                 " POSSESSION_OBJECT,".
      *---------- 運用通貨コード
             15  FILLER            PIC  X(17)  VALUE
                 " CAPITAL_TUKA_CD,".
      *---------- 日次評価法フラグ
             15  FILLER            PIC  X(16)  VALUE " NITIJI_HYK_FLG,".
      *---------- 料率パターンコード
             15  FILLER            PIC  X(20)  VALUE
                 " COMMISSION_PATTERN,".
      *---------- 約定主義会計フラグ
             15  FILLER            PIC  X(18)  VALUE
                 " YKJ_SYUGI_KAIKEI,".
      *---------- キャッシュフロー２回発生区分
             15  FILLER            PIC  X(15)  VALUE " CASH_FLOW_KBN,".
      *---------- 約定レートコード
             15  FILLER            PIC  X(13)  VALUE " YKJ_RATE_CD,".
      *---------- 未収配当計上割合
             15  FILLER            PIC  X(20)  VALUE
                 " MISYU_HAITOU_WARIAI".
           10  SQL-FROM.
             15  FILLER            PIC  X(06)  VALUE " FROM ".
             15  SQL-TKMZBW02      PIC  X(13).
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 処理実行日
             15  FILLER            PIC  X(25)  VALUE
                 " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- ORDER BY
           10  SQL-ORDERBY.
             15  FILLER            PIC  X(10)  VALUE "  ORDER BY".
      *---------- 順番
             15  FILLER            PIC  X(07)  VALUE " JUNBAN".
      *---------- SELECT SQL文(別紙1-3)
         05  SQL-SELECT-1-3.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 銘柄コード
             15  FILLER            PIC  X(10)  VALUE " A.MEG_CD,".
      *---------- 証券種別コード
             15  FILLER            PIC  X(14)  VALUE " A.SEC_SBT_CD,".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(12)  VALUE " A.TATE_FLG,".
      *---------- 玉ID
             15  FILLER            PIC  X(12)  VALUE " A.GYOKU_ID,".
      *---------- 市場通貨コード
             15  FILLER            PIC  X(16)  VALUE " A.SIJO_TUKA_CD,".
      *---------- 差分更新From日
             15  FILLER            PIC  X(21)  VALUE
                 " A.SABON_UPDATE_FROM,".
      *---------- 銘柄種類
             15  FILLER            PIC  X(15)  VALUE " A.MEG_CD_SHRU,".
      *---------- 再計算区分
             15  FILLER            PIC  X(16)  VALUE " A.SAI_CALC_KBN,".
      *---------- 銘柄種類２
             15  FILLER            PIC  X(15)  VALUE " A.MEG_CD_SHRU2".
      *---------- DECODE(NVL(B.取引事由順,1),0,0,1) AS 取引事由順
      *      15  FILLER            PIC  X(52)  VALUE
      *          " DECODE(NVL(B.TORI_JIYU_P,1),0,0,1) AS TORI_JIYU_JUN".
           10  SQL-FROM.
             15  FILLER            PIC  X(08)  VALUE " FROM ( ".
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 銘柄コード
             15  FILLER            PIC  X(08)  VALUE " MEG_CD,".
      *---------- 証券種別コード
             15  FILLER            PIC  X(12)  VALUE " SEC_SBT_CD,".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(10)  VALUE " TATE_FLG,".
      *---------- 玉ID
             15  FILLER            PIC  X(10)  VALUE " GYOKU_ID,".
      *---------- 市場通貨コード
             15  FILLER            PIC  X(14)  VALUE " SIJO_TUKA_CD,".
      *---------- 差分更新From日
             15  FILLER            PIC  X(19)  VALUE
                 " SABON_UPDATE_FROM,".
      *---------- 銘柄種類
             15  FILLER            PIC  X(13)  VALUE " MEG_CD_SHRU,".
      *---------- 再計算区分
             15  FILLER            PIC  X(14)  VALUE " SAI_CALC_KBN,".
      *---------- 銘柄種類２
             15  FILLER            PIC  X(14)  VALUE " MEG_CD_SHRU2,".
      *---------- DECODE(証券種別コード,'WAR',0,'CB',0,'CBMS',0,1) AS 処理順
             15  FILLER            PIC  X(48)  VALUE
                 " DECODE(SEC_SBT_CD,'WAR ',0,'CB  ',0,'CBMS',0,1)".
             15  FILLER            PIC  X(08)  VALUE  "AS SRJUN".
             15  SQL1-FROM.
               20  FILLER          PIC  X(06)  VALUE " FROM ".
               20  SQL1-TKMZBW03   PIC  X(13).
             15  SQL1-WHERE.
               20  FILLER          PIC  X(06)  VALUE " WHERE".
      *---------- 処理実行日
               20  FILLER          PIC  X(25)  VALUE
                   " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
               20  FILLER          PIC  X(27)  VALUE
                   " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
               20  FILLER          PIC  X(33)  VALUE
                   " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
               20  FILLER          PIC  X(25)  VALUE
                   " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
               20  FILLER          PIC  X(23)  VALUE
                   " AND PTF_CD = :P_PTF_CD".
      *---------- 基準日
               20  FILLER          PIC  X(26)  VALUE
                   " AND KJN_YMD = :P_KJN_YMD ".
      *---------- 有効銘柄フラグ
               20  FILLER          PIC  X(28)  VALUE
                   " AND YUKO_MEG_FLG = '1' ) A ".
             15  FILLER            PIC  X(13)  VALUE " LEFT JOIN ( ".
             15  FILLER            PIC  X(37)  VALUE
                 " SELECT /*+ LEADING(C D) */ DISTINCT ".
      *---------- 銘柄コード
             15  FILLER            PIC  X(08)  VALUE " MEG_CD,".
      *---------- 証券種別コード
             15  FILLER            PIC  X(12)  VALUE " SEC_SBT_CD,".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(10)  VALUE " TATE_FLG,".
      *---------- 玉ID
             15  FILLER            PIC  X(10)  VALUE " GYOKU_ID,".
      *---------- 市場通貨コード
             15  FILLER            PIC  X(14)  VALUE " SIJO_TUKA_CD,".
      *---------- 0 AS 取引事由順
             15  FILLER            PIC  X(18)  VALUE
                 " 0 AS TORI_JIYU_P ".
             15  SQL2-FROM.
               20  FILLER          PIC  X(06)  VALUE " FROM ".
               20  SQL2-TKMXTR00   PIC  X(13).
             15  SQL2-WHERE.
               20  FILLER          PIC  X(37)  VALUE
                   " C WHERE ( MEG_CD,SEC_SBT_CD,TATE_FLG".
               20  FILLER          PIC  X(28)  VALUE
                   ",GYOKU_ID,SIJO_TUKA_CD ) IN ".
               20  FILLER          PIC  X(09)  VALUE  "( SELECT ".
      *---------- 銘柄コード
               20  FILLER          PIC  X(08)  VALUE " MEG_CD,".
      *---------- 証券種別コード
               20  FILLER          PIC  X(12)  VALUE " SEC_SBT_CD,".
      *---------- 資産負債・買建売建フラグ
               20  FILLER          PIC  X(10)  VALUE " TATE_FLG,".
      *---------- 玉ID
               20  FILLER          PIC  X(10)  VALUE " GYOKU_ID,".
      *---------- 市場通貨コード
               20  FILLER          PIC  X(14)  VALUE " SIJO_TUKA_CD ".
             15  SQL3-FROM.
               20  FILLER          PIC  X(06)  VALUE " FROM ".
               20  SQL3-TKMZBW03   PIC  X(13).
             15  SQL1-WHERE.
               20  FILLER          PIC  X(08)  VALUE " D WHERE".
      *---------- 処理実行日
               20  FILLER          PIC  X(25)  VALUE
                   " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
               20  FILLER          PIC  X(27)  VALUE
                   " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
               20  FILLER          PIC  X(33)  VALUE
                   " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
               20  FILLER          PIC  X(25)  VALUE
                   " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
               20  FILLER          PIC  X(23)  VALUE
                   " AND PTF_CD = :P_PTF_CD".
      *---------- 基準日
               20  FILLER          PIC  X(30)  VALUE
                   " AND KJN_YMD = :P_KJN_YMD ) ".
      *---------- 利用会社コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(46)  VALUE
                 " AND ( PTF_CD = :P_PTF_CD OR PTF_CD = '    ' )".
      *---------- 取引事由 IN('SDID','CIQD','CISD','OCID','MRGD',
      *---------- 'CONS','CID△' ,'ISD△')
             15  FILLER            PIC  X(46)  VALUE
                 " AND TORI_JIYU IN ('SDID','CIQD','CISD','OCID'".
             15  FILLER            PIC  X(30)  VALUE
                 ",'MRGD','CONS','CID ','ISD ') ".
             15  FILLER            PIC  X(05)  VALUE " AND ".
             15  WK-DATE           PIC  X(07).
             15  FILLER            PIC  X(31)  VALUE
                 " BETWEEN :P_DATE1 AND :P_DATE2 ".
             15  FILLER            PIC  X(05)  VALUE " ) B ".
             15  FILLER            PIC  X(04)  VALUE " ON ".
      *---------- 銘柄コード
             15  FILLER            PIC  X(21)  VALUE
                 " A.MEG_CD = B.MEG_CD ".
      *---------- 証券種別コード
             15  FILLER            PIC  X(32)  VALUE
                 "AND A.SEC_SBT_CD = B.SEC_SBT_CD ".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(28)  VALUE
                 "AND A.TATE_FLG = B.TATE_FLG ".
      *---------- 玉ID
             15  FILLER            PIC  X(28)  VALUE
                 "AND A.GYOKU_ID = B.GYOKU_ID ".
      *---------- 市場通貨コード
             15  FILLER            PIC  X(36)  VALUE
                 "AND A.SIJO_TUKA_CD = B.SIJO_TUKA_CD ".
           10  SQL-ORDER-BY.
      *---------- ORDER BY
             15  FILLER            PIC  X(10)  VALUE " ORDER BY ".
             15  FILLER            PIC  X(14)  VALUE "A.MEG_CD_SHRU,".
             15  FILLER            PIC  X(08)  VALUE "A.SRJUN,".
      *      15  FILLER            PIC  X(14)  VALUE "TORI_JIYU_JUN,".
             15  FILLER            PIC  X(14)  VALUE "B.TORI_JIYU_P ".
             15  FILLER            PIC  X(12)  VALUE " NULLS LAST,".
             15  FILLER            PIC  X(13)  VALUE "A.SEC_SBT_CD,".
             15  FILLER            PIC  X(09)  VALUE "A.MEG_CD,".
             15  FILLER            PIC  X(11)  VALUE "A.TATE_FLG,".
             15  FILLER            PIC  X(11)  VALUE "A.GYOKU_ID ".
      *---------- SELECT SQL文(別紙1-4)
         05  SQL-SELECT-1-4.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 原取引ID
             15  FILLER            PIC  X(08)  VALUE "TORI_ID,".
      *---------- 受渡日
             15  FILLER            PIC  X(08)  VALUE "UKE_YMD,".
      *---------- 計上基準日
             15  FILLER            PIC  X(16)  VALUE " KEIJOU_KIJUNBI,".
      *---------- 増幅赤黒区分
             15  FILLER            PIC  X(15)  VALUE " ZOFKU_AKA_KBN,".
      *---------- 増幅区分
             15  FILLER            PIC  X(11)  VALUE " ZOFKU_KBN,".
      *---------- 増幅元異動計上基準日
             15  FILLER            PIC  X(20)  VALUE
                 " ZOFKUMT_KJ_KIJUNBI,".
      *---------- 処理順
             15  FILLER            PIC  X(06)  VALUE " SRJUN".
           10  SQL-FROM.
             15  FILLER            PIC  X(06)  VALUE " FROM ".
             15  SQL-TKMZBW04      PIC  X(13).
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 処理実行日
             15  FILLER            PIC  X(25)  VALUE
                 " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- ORDER BY
           10  SQL-ORDERBY.
             15  FILLER            PIC  X(10)  VALUE "  ORDER BY".
      *---------- 処理順
             15  FILLER            PIC  X(06)  VALUE " SRJUN".
      *---------- SELECT SQL文(別紙1-5)
         05  SQL-SELECT-1-5.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 原取引ID
             15  FILLER            PIC  X(08)  VALUE "TORI_ID,".
      *---------- 資金種別
             15  FILLER            PIC  X(11)  VALUE " SIKIN_SBT,".
      *---------- 異動日
             15  FILLER            PIC  X(09)  VALUE " IDO_YMD,".
      *---------- 増減区分
             15  FILLER            PIC  X(08)  VALUE " ZG_KBN,".
      *---------- 処理順
             15  FILLER            PIC  X(07)  VALUE " SRJUN,".
      *---------- 受渡計上切替対象フラグ
             15  FILLER            PIC  X(18)  VALUE
                                                   " UKE_KJ_KK_TS_FLG,".
      *---------- 切替仕訳基準パターンコード
             15  FILLER            PIC  X(19)  VALUE
                                                  " KK_SWK_KJN_PTN_CD,".
      *---------- 切替キャッシュフロー2回有効フラグ
             15  FILLER            PIC  X(17)  VALUE
                                                    " KK_CF_NK_YK_FLG,".
      *---------- 切替基本会計ベースフラグ
             15  FILLER            PIC  X(19)  VALUE
                                                  " KK_KH_KK_BASE_FLG,".
      *---------- 受渡未払未収増幅フラグ
             15  FILLER            PIC  X(16)  VALUE
                                                   " UKE_MBMS_ZF_FLG".
           10  SQL-FROM.
             15  FILLER            PIC  X(06)  VALUE " FROM ".
             15  SQL-TKMZBW05      PIC  X(13).
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 処理実行日
             15  FILLER            PIC  X(25)  VALUE
                 " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND SEC_SBT_CD = :P_SEC_SBT_CD".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- ORDER BY
           10  SQL-ORDERBY.
             15  FILLER            PIC  X(10)  VALUE "  ORDER BY".
      *---------- 処理順
             15  FILLER            PIC  X(06)  VALUE " SRJUN".
      *---------- UPDATE SQL文(別紙1-7)
         05  SQL-UPDATE-1-7.
           10  SQL-UPDATE.
             15  FILLER            PIC  X(07)  VALUE "UPDATE ".
             15  SQL-TKDYAA35      PIC  X(13).
             15  FILLER            PIC  X(05)  VALUE " SET ".
             15  FILLER            PIC  X(30)
                 VALUE "KJN_YMD_FROM = :P_KJN_YMD_FROM".
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(29)  VALUE
                 " RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- 処理実行日
             15  FILLER            PIC  X(29)  VALUE
                 " AND SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 評価系列コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND HYK_KRTU_CD = :P_HYK_KRTU_CD".
      *---------- 帳票ID
             15  FILLER            PIC  X(23)  VALUE
                 " AND REP_ID = :P_REP_ID".
      *---------- 帳票任意コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND REP_ANY_CD = :P_REP_ANY_CD".
      *---------- 基準日FROM
             15  FILLER            PIC  X(35)  VALUE
                 " AND KJN_YMD_FROM = :P_KJN_YMD_FROM".
      *---------- SELECT SQL文(別紙1-8)
         05  SQL-SELECT-1-8.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 利用会社コード
             15  FILLER            PIC  X(14)  VALUE "A.RIYO_CMP_CD,".
      *---------- 原取引ID
             15  FILLER            PIC  X(10)  VALUE "A.TORI_ID,".
      *---------- ファンドコード
             15  FILLER            PIC  X(10)  VALUE "A.FUND_CD,".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(09)  VALUE "A.PTF_CD,".
      *---------- 銘柄コード
             15  FILLER            PIC  X(09)  VALUE "A.MEG_CD,".
      *---------- 証券種別コード
             15  FILLER            PIC  X(13)  VALUE "A.SEC_SBT_CD,".
      *---------- 玉ID
             15  FILLER            PIC  X(11)  VALUE "A.GYOKU_ID,".
      *---------- 保有目的
             15  FILLER            PIC  X(20)  VALUE
                 "A.POSSESSION_OBJECT,".
      *---------- 取引連関ＩＤ
             15  FILLER            PIC  X(10)  VALUE "A.THRK_ID,".
      *---------- ダミー区分
             15  FILLER            PIC  X(12)  VALUE "A.DUMMY_KBN,".
      *---------- 約定日
             15  FILLER            PIC  X(10)  VALUE "A.YKJ_YMD,".
      *---------- 受渡日
             15  FILLER            PIC  X(10)  VALUE "A.UKE_YMD,".
      *---------- 取引内容
             15  FILLER            PIC  X(12)  VALUE "A.TORI_NAIY,".
      *---------- 取引事由
             15  FILLER            PIC  X(12)  VALUE "A.TORI_JIYU,".
      *---------- 資金決済方法
             15  FILLER            PIC  X(13)  VALUE "A.KESAI_HOHO,".
      *---------- 異動数量
             15  FILLER            PIC  X(12)  VALUE "A.IDO_SURYO,".
      *---------- 権利数量
             15  FILLER            PIC  X(14)  VALUE "A.KENRI_SURYO,".
      *---------- 数量単位
             15  FILLER            PIC  X(13)  VALUE "A.SURYO_TANI,".
      *---------- 市場通貨コード
             15  FILLER            PIC  X(15)  VALUE "A.SIJO_TUKA_CD,".
      *---------- 現地通貨コード
             15  FILLER            PIC  X(12)  VALUE "A.G_TUKA_CD,".
      *---------- 為替レート（現地／運用）１
             15  FILLER            PIC  X(11)  VALUE "A.G_U_KWS1,".
      *---------- 為替レート（現地／運用）２
             15  FILLER            PIC  X(11)  VALUE "A.G_U_KWS2,".
      *---------- 為替レート（現地／市場）
             15  FILLER            PIC  X(10)  VALUE "A.G_S_KWS,".
      *---------- 為替レート（市場／運用）
             15  FILLER            PIC  X(10)  VALUE "A.S_U_KWS,".
      *---------- 円レート（現地／円）
             15  FILLER            PIC  X(12)  VALUE "A.G_YEN_KWS,".
      *---------- 経過利息為替レート
             15  FILLER            PIC  X(11)  VALUE "A.KKRS_KWS,".
      *---------- 約定金額（運用通貨換算額）
             15  FILLER            PIC  X(15)  VALUE "A.U_KSG_G_YJKG,".
      *---------- 現地手数料（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_G_TSR,".
      *---------- 現地消費税（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_G_SHZ,".
      *---------- 現地その他費用（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_G_THY,".
      *---------- 現地源泉税（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_G_GSZ,".
      *---------- 既経過利息（運用通貨換算額）
             15  FILLER            PIC  X(16)  VALUE "A.U_KSG_G_KKKRS,".
      *---------- 日歩（運用通貨換算額）
             15  FILLER            PIC  X(13)  VALUE "A.U_KSG_HIBU,".
      *---------- 逆日歩（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_GHIBU,".
      *---------- 管理費（運用通貨換算額）
             15  FILLER            PIC  X(12)  VALUE "A.U_KSG_KRH,".
      *---------- 管理費消費税（運用通貨換算額）
             15  FILLER            PIC  X(16)  VALUE "A.U_KSG_KRH_SHZ,".
      *---------- 運用国手数料（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_U_TSR,".
      *---------- 運用国消費税（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_U_SHZ,".
      *---------- 運用国その他費用（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_U_THY,".
      *---------- 国内源泉税（運用通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.U_KSG_U_GSZ,".
      *---------- 精算金額（運用通貨換算額）
             15  FILLER            PIC  X(15)  VALUE "A.U_KSG_G_SSKG,".
      *---------- 入出金額（約定レート・運用通貨換算額）
             15  FILLER            PIC  X(12)  VALUE "A.NSKG_Y_UY,".
      *---------- 入出金額（決済レート・運用通貨換算額）
             15  FILLER            PIC  X(12)  VALUE "A.NSKG_K_UY,".
      *---------- 為替差損益
             15  FILLER            PIC  X(17)  VALUE
                 "A.UYTK_KWS_SNEKI,".
      *---------- 約定金額（市場通貨換算額）
             15  FILLER            PIC  X(15)  VALUE "A.S_KSG_G_YJKG,".
      *---------- 現地手数料（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_G_TSR,".
      *---------- 現地消費税（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_G_SHZ,".
      *---------- 現地その他費用（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_G_THY,".
      *---------- 現地源泉税（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_G_GSZ,".
      *---------- 既経過利息（市場通貨換算額）
             15  FILLER            PIC  X(16)  VALUE "A.S_KSG_G_KKKRS,".
      *---------- 日歩（市場通貨換算額）
             15  FILLER            PIC  X(13)  VALUE "A.S_KSG_HIBU,".
      *---------- 逆日歩（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_GHIBU,".
      *---------- 管理費（市場通貨換算額）
             15  FILLER            PIC  X(12)  VALUE "A.S_KSG_KRH,".
      *---------- 管理費消費税（市場通貨換算額）
             15  FILLER            PIC  X(16)  VALUE "A.S_KSG_KRH_SHZ,".
      *---------- 運用国手数料（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_U_TSR,".
      *---------- 運用国消費税（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_U_SHZ,".
      *---------- 運用国その他費用（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_U_THY,".
      *---------- 国内源泉税（市場通貨換算額）
             15  FILLER            PIC  X(14)  VALUE "A.S_KSG_U_GSZ,".
      *---------- 精算金額（市場通貨換算額）
             15  FILLER            PIC  X(13)  VALUE "A.S_KSG_SSKG,".
      *---------- 決済口座１
             15  FILLER            PIC  X(11)  VALUE "A.KOZA1_NO,".
      *---------- 決済口座１通貨コード
             15  FILLER            PIC  X(16)  VALUE "A.KOZA1_TUKA_CD,".
      *---------- 決済口座１入出金額
             15  FILLER            PIC  X(13)  VALUE "A.KOZA1_NSKG,".
      *---------- 決済口座１入出金額（運用通貨換算額）
             15  FILLER            PIC  X(19)  VALUE
                 "A.KOZA1_U_KSG_NSKG,".
      *---------- 決済口座２
             15  FILLER            PIC  X(11)  VALUE "A.KOZA2_NO,".
      *---------- 決済口座２通貨コード
             15  FILLER            PIC  X(16)  VALUE "A.KOZA2_TUKA_CD,".
      *---------- 決済口座２入出金額
             15  FILLER            PIC  X(13)  VALUE "A.KOZA2_NSKG,".
      *---------- 決済口座２入出金額（運用通貨換算額）
             15  FILLER            PIC  X(19)  VALUE
                 "A.KOZA2_U_KSG_NSKG,".
      *---------- 還付予定額
             15  FILLER            PIC  X(14)  VALUE "A.KANP_YOTEGK,".
      *---------- 調整損益
             15  FILLER            PIC  X(15)  VALUE "A.CHOSEI_SNEKI,".
      *---------- 経過利息区分
             15  FILLER            PIC  X(11)  VALUE "A.KKRS_KBN,".
      *---------- 効力発生日
             15  FILLER            PIC  X(15)  VALUE "A.KOURYOKU_YMD,".
      *---------- スタート日（放出日）
             15  FILLER            PIC  X(09)  VALUE "A.ST_YMD,".
      *---------- 約定ベースエンド日
             15  FILLER            PIC  X(14)  VALUE "A.YKJ_END_YMD,".
      *---------- 受渡ベースエンド日
             15  FILLER            PIC  X(14)  VALUE "A.UKE_END_YMD,".
      *---------- 運用日数
             15  FILLER            PIC  X(12)  VALUE "A.UNYO_NISU,".
      *---------- 受取利息金額
             15  FILLER            PIC  X(15)  VALUE "A.UKETR_RSK_KG,".
      *---------- 商品別取引区分
             15  FILLER            PIC  X(15)  VALUE "A.SHB_TORI_KBN,".
      *---------- 異動確定区分
             15  FILLER            PIC  X(10)  VALUE "A.IDO_KBN,".
      *---------- １口注文ＩＤ
             15  FILLER            PIC  X(13)  VALUE "A.ORDR_1K_ID,".
      *---------- 対象取引ＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "A.TARGET_TORI_ID,".
      *---------- 現地ブローカー
             15  FILLER            PIC  X(08)  VALUE "A.G_BRK,".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(11)  VALUE "A.TATE_FLG,".
      *---------- 投資対象国コード
             15  FILLER            PIC  X(11)  VALUE "A.TSTSK_CD,".
      *---------- 発行国コード
             15  FILLER            PIC  X(10)  VALUE "A.HAKO_CD,".
      *---------- 約定金額
             15  FILLER            PIC  X(09)  VALUE "A.G_YJKG,".
      *---------- 約定単価
             15  FILLER            PIC  X(12)  VALUE "A.YKJ_TANKA,".
      *---------- 現地入出金額
             15  FILLER            PIC  X(09)  VALUE "A.G_NSKG,".
      *---------- 取引連関ＩＤ
             15  FILLER            PIC  X(17)  VALUE
                 "NVL(B.THRK_ID,0),".
      *---------- 建時単価
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(B.TATE_TANKA,0),".
      *---------- 決済単価
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(B.KS_TANKA,0),".
      *---------- 権利行使価格
             15  FILLER            PIC  X(18)  VALUE
                 "NVL(B.KRKS_KKK,0),".
      *---------- 権利行使金額（運用通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.U_KSG_KRKS_KG,0),".
      *---------- 決済約定金額（運用通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.U_KSG_KS_YJKG,0),".
      *---------- 決済現地手数料（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_KS_G_TSR,0),".
      *---------- 決済現地消費税（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_KS_G_SHZ,0),".
      *---------- 決済現地その他費用（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_KS_G_THY,0),".
      *---------- 決済運用国手数料（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_KS_U_TSR,0),".
      *---------- 決済運用国消費税（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_KS_U_SHZ,0),".
      *---------- 決済運用国その他費用（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_KS_U_THY,0),".
      *---------- 日歩（運用通貨）
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(B.U_KSG_HIBU,0),".
      *---------- 逆日歩（運用通貨）
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(B.U_KSG_GHIBU,0),".
      *---------- 管理費（運用通貨）
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(B.U_KSG_KRH,0),".
      *---------- 管理費消費税（運用通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.U_KSG_KRH_SHZ,0),".
      *---------- 建時約定金額（運用通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.U_KSG_TH_YJKG,0),".
      *---------- 建時現地手数料（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_TH_G_TSR,0),".
      *---------- 建時現地消費税（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_TH_G_SHZ,0),".
      *---------- 建時現地その他費用（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_TH_G_THY,0),".
      *---------- 建時運用国手数料（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_TH_U_TSR,0),".
      *---------- 建時運用国消費税（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_TH_U_SHZ,0),".
      *---------- 建時運用国その他費用（運用通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.U_KSG_TH_U_THY,0),".
      *---------- 建時ＯＰ約定金額（運用通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.U_KSG_TH_OP_YJKG,0),".
      *---------- 建時ＯＰ現地手数料（運用通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.U_KSG_TH_OP_G_TSR,0),".
      *---------- 建時ＯＰ現地消費税（運用通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.U_KSG_TH_OP_G_SHZ,0),".
      *---------- 建時ＯＰ現地その他費用（運用通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.U_KSG_TH_OP_G_THY,0),".
      *---------- 建時ＯＰ運用国手数料（運用通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.U_KSG_TH_OP_U_TSR,0),".
      *---------- 建時ＯＰ運用国消費税（運用通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.U_KSG_TH_OP_U_SHZ,0),".
      *---------- 建時ＯＰ運用国その他費用（運用通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.U_KSG_TH_OP_U_THY,0),".
      *---------- 引継ＯＰ約定金額（運用通貨）
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(B.U_KSG_HTOP_YJKG,0),".
      *---------- 引継ＯＰ現地手数料（運用通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.U_KSG_HTOP_G_TSR,0),".
      *---------- 引継ＯＰ現地消費税（運用通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.U_KSG_HTOP_G_SHZ,0),".
      *---------- 引継ＯＰ現地その他費用（運用通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.U_KSG_HTOP_G_THY,0),".
      *---------- 引継ＯＰ運用国手数料（運用通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.U_KSG_HTOP_U_TSR,0),".
      *---------- 引継ＯＰ運用国消費税（運用通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.U_KSG_HTOP_U_SHZ,0),".
      *---------- 引継ＯＰ運用国その他費用（運用通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.U_KSG_HTOP_U_THY,0),".
      *---------- 権利行使金額（市場通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.S_KSG_KRKS_KG,0),".
      *---------- 決済約定金額（市場通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.S_KSG_KS_YJKG,0),".
      *---------- 決済現地手数料（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_KS_G_TSR,0),".
      *---------- 決済現地消費税（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_KS_G_SHZ,0),".
      *---------- 決済現地その他費用（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_KS_G_THY,0),".
      *---------- 決済運用国手数料（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_KS_U_TSR,0),".
      *---------- 決済運用国消費税（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_KS_U_SHZ,0),".
      *---------- 決済運用国その他費用（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_KS_U_THY,0),".
      *---------- 日歩（市場通貨）
             15  FILLER            PIC  X(20)  VALUE
                 "NVL(B.S_KSG_HIBU,0),".
      *---------- 逆日歩（市場通貨）
             15  FILLER            PIC  X(21)  VALUE
                 "NVL(B.S_KSG_GHIBU,0),".
      *---------- 管理費（市場通貨）
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(B.S_KSG_KRH,0),".
      *---------- 管理費消費税（市場通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.S_KSG_KRH_SHZ,0),".
      *---------- 建時約定金額（市場通貨）
             15  FILLER            PIC  X(23)  VALUE
                 "NVL(B.S_KSG_TH_YJKG,0),".
      *---------- 建時現地手数料（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_TH_G_TSR,0),".
      *---------- 建時現地消費税（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_TH_G_SHZ,0),".
      *---------- 建時現地その他費用（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_TH_G_THY,0),".
      *---------- 建時運用国手数料（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_TH_U_TSR,0),".
      *---------- 建時運用国消費税（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_TH_U_SHZ,0),".
      *---------- 建時運用国その他費用（市場通貨）
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.S_KSG_TH_U_THY,0),".
      *---------- 建時ＯＰ約定金額（市場通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.S_KSG_TH_OP_YJKG,0),".
      *---------- 建時ＯＰ現地手数料（市場通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.S_KSG_TH_OP_G_TSR,0),".
      *---------- 建時ＯＰ現地消費税（市場通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.S_KSG_TH_OP_G_SHZ,0),".
      *---------- 建時ＯＰ現地その他費用（市場通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.S_KSG_TH_OP_G_THY,0),".
      *---------- 建時ＯＰ運用国手数料（市場通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.S_KSG_TH_OP_U_TSR,0),".
      *---------- 建時ＯＰ運用国消費税（市場通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.S_KSG_TH_OP_U_SHZ,0),".
      *---------- 建時ＯＰ運用国その他費用（市場通貨）
             15  FILLER            PIC  X(27)  VALUE
                 "NVL(B.S_KSG_TH_OP_U_THY,0),".
      *---------- 引継ＯＰ約定金額（市場通貨）
             15  FILLER            PIC  X(25)  VALUE
                 "NVL(B.S_KSG_HTOP_YJKG,0),".
      *---------- 引継ＯＰ現地手数料（市場通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.S_KSG_HTOP_G_TSR,0),".
      *---------- 引継ＯＰ現地消費税（市場通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.S_KSG_HTOP_G_SHZ,0),".
      *---------- 引継ＯＰ現地その他費用（市場通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.S_KSG_HTOP_G_THY,0),".
      *---------- 引継ＯＰ運用国手数料（市場通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.S_KSG_HTOP_U_TSR,0),".
      *---------- 引継ＯＰ運用国消費税（市場通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.S_KSG_HTOP_U_SHZ,0),".
      *---------- 引継ＯＰ運用国その他費用（市場通貨）
             15  FILLER            PIC  X(26)  VALUE
                 "NVL(B.S_KSG_HTOP_U_THY,0),".
      *---------- 建時現地約定日
             15  FILLER            PIC  X(24)  VALUE
                 "NVL(B.TATE_G_YKJ_YMD,0),".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(19)  VALUE
                 "NVL(B.TATE_FLG,' ')".
           10  SQL-FROM.
             15  FILLER            PIC  X(06)  VALUE " FROM ".
             15  SQL-TKMXTR00      PIC  X(13).
             15  FILLER            PIC  X(13)  VALUE " A LEFT JOIN ".
             15  SQL-TKMXTR01      PIC  X(13).
             15  FILLER            PIC  X(06)  VALUE " B ON ".
             15  FILLER            PIC  X(30)  VALUE
                 " A.RIYO_CMP_CD = B.RIYO_CMP_CD".
             15  FILLER            PIC  X(26)  VALUE
                 " AND A.TORI_ID = B.TORI_ID".
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(31)  VALUE
                 " A.RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- 原取引ＩＤ
             15  FILLER            PIC  X(27)  VALUE
                 " AND A.TORI_ID = :P_TORI_ID".
      *---------- SELECT SQL文(別紙1-10)
         05  SQL-SELECT-1-10.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- 決済口座通貨コード
             15  FILLER            PIC  X(13)  VALUE "KOZA_TUKA_CD,".
      *---------- 取引連関ＩＤ
             15  FILLER            PIC  X(09)  VALUE " THRK_ID,".
      *---------- 決済通貨異動額
             15  FILLER            PIC  X(11)  VALUE " KSTK_IDOG,".
      *---------- 運用通貨異動額
             15  FILLER            PIC  X(11)  VALUE " UYTK_IDOG,".
      *---------- 異動確定区分
             15  FILLER            PIC  X(09)  VALUE " IDO_KBN,".
      *---------- 市場通貨コード
             15  FILLER            PIC  X(14)  VALUE " SIJO_TUKA_CD,".
      *---------- 取引事由
             15  FILLER            PIC  X(11)  VALUE " TORI_JIYU,".
      *---------- 証券種別コード
             15  FILLER            PIC  X(12)  VALUE " SEC_SBT_CD,".
      *---------- 取引内容
             15  FILLER            PIC  X(10)  VALUE " TORI_NAIY".
           10  SQL-FROM.
             15  FILLER            PIC  X(06)  VALUE " FROM ".
             15  SQL-TKMZBW18      PIC  X(13).
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(29)  VALUE
                 " RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- 原取引ＩＤ
             15  FILLER            PIC  X(25)  VALUE
                 " AND TORI_ID = :P_TORI_ID".
      *---------- 決済口座番号
             15  FILLER            PIC  X(31)  VALUE
                 " AND KS_KOZA_NO = :P_KS_KOZA_NO".
      *---------- 資金種別
             15  FILLER            PIC  X(29)  VALUE
                 " AND SIKIN_SBT = :P_SIKIN_SBT".
      *---------- 異動日
             15  FILLER            PIC  X(25)  VALUE
                 " AND IDO_YMD = :P_IDO_YMD".
      *---------- 増減区分
             15  FILLER            PIC  X(23)  VALUE
                 " AND ZG_KBN = :P_ZG_KBN".
      *---------- 処理実行日
             15  FILLER            PIC  X(29)  VALUE
                 " AND SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *----------  残高異動計算データSQL文(別紙1-11)
         05  SQL-SELECT-1-11.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  取引事由
           10  FILLER              PIC  X(11)  VALUE  "TORI_JIYU, ".
      *----------  市場通貨払出単価
           10  FILLER              PIC  X(12)  VALUE  "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
           10  FILLER              PIC  X(11)  VALUE  "UYTK_H_TNK ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-11       PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  処理実行日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(12)  VALUE  "SYORI_YMD = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_SYORI_YMD".
      *----------  起動ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "KIDOU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_KIDOU_ID".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  証券種別コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "SEC_SBT_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_SEC_SBT_CD ".
      *----------  銘柄コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "MEG_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_MEG_CD".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "TATE_FLG = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_TATE_FLG".
      *----------  玉ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "GYOKU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_GYOKU_ID".
      *----------  異動計上順序
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(14)  VALUE  "IDO_KJY_JUN < ".
           10  FILLER              PIC  X(14)  VALUE  ":P_IDO_KJY_JUN".
      *----------  赤黒区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "AKA_KBN <> ".
           10  FILLER              PIC  X(03)  VALUE  "'1'".
      *----------  赤黒区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "AKA_KBN <> ".
           10  FILLER              PIC  X(03)  VALUE  "'9'".
      *----------  取引事由
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(17)  VALUE
                                                    "TORI_JIYU NOT IN(".
           10  FILLER              PIC  X(49)  VALUE
               "'DMY1','DMY2','DMY3','DMY4','DMY5','DMY6','DMY7',".
           10  FILLER              PIC  X(56)  VALUE
             "'DMY8','DMY9','TAX ','EXLC','EXLI','EXPC','EXPI','CPN ',".
           10  FILLER              PIC  X(42)  VALUE
               "'DIVS','DVAI','INTA','INTF','RCPB','RCPS')".
      *----------  ORDER BY
           10  FILLER              PIC  X(10)  VALUE  " ORDER BY ".
      *----------  異動計上順序  降順
           10  FILLER              PIC  X(16)  VALUE
               "IDO_KJY_JUN DESC".
      *----------  残高異動SQL文(別紙1-12)
         05  SQL-SELECT-1-12.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  取引事由
           10  FILLER              PIC  X(11)  VALUE  "TORI_JIYU, ".
      *----------  市場通貨払出単価
           10  FILLER              PIC  X(12)  VALUE  "SJTK_H_TNK, ".
      *----------  運用通貨払出単価
           10  FILLER              PIC  X(11)  VALUE  "UYTK_H_TNK ".
           10  FILLER              PIC  X(06)  VALUE  " FROM ".
           10  WK-SQL-TKMZZI00-01  PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(15)  VALUE  ":P_RIYO_CMP_CD ".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  ファンドコード
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_FUND_CD ".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_PTF_CD ".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  証券種別コード
           10  FILLER              PIC  X(13)  VALUE  "SEC_SBT_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_SEC_SBT_CD ".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  銘柄コード
           10  FILLER              PIC  X(09)  VALUE  "MEG_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_MEG_CD ".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(11)  VALUE  "TATE_FLG = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_TATE_FLG ".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  玉ＩＤ
           10  FILLER              PIC  X(11)  VALUE  "GYOKU_ID = ".
           10  FILLER              PIC  X(12)  VALUE  ":P_GYOKU_ID ".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  計上基準日
           10  FILLER              PIC  X(16)  VALUE
                                                     "KEIJOU_KIJUNBI<=".
           10  FILLER              PIC  X(17)  VALUE
                                                    ":P_KEIJOU_KIJUNBI".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  赤黒区分
           10  FILLER              PIC  X(13)  VALUE  "AKA_KBN = ' '".
           10  FILLER              PIC  X(05)  VALUE  " AND ".
      *----------  取引事由
           10  FILLER              PIC  X(17)  VALUE
                                                    "TORI_JIYU NOT IN(".
           10  FILLER              PIC  X(49)  VALUE
               "'DMY1','DMY2','DMY3','DMY4','DMY5','DMY6','DMY7',".
           10  FILLER              PIC  X(56)  VALUE
             "'DMY8','DMY9','TAX ','EXLC','EXLI','EXPC','EXPI','CPN ',".
           10  FILLER              PIC  X(42)  VALUE
               "'DIVS','DVAI','INTA','INTF','RCPB','RCPS')".
      *----------  ORDER BY
           10  FILLER              PIC  X(10)  VALUE  " ORDER BY ".
      *----------  受渡日  降順
           10  FILLER              PIC  X(15)  VALUE  " UKE_YMD DESC, ".
      *----------  更新日時 降順
           10  FILLER              PIC  X(15)  VALUE  "UPD_DATE DESC, ".
      *----------  異動計上順序  降順
           10  FILLER              PIC  X(16)  VALUE
                                                     "IDO_KJY_JUN DESC".
      *----------  残高履歴SQL文(別紙1-13)
         05  SQL-SELECT-1-13.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨未収収益計上・戻入額
           10  FILLER              PIC  X(16)  VALUE "SJTK_MSSE_KJMIG,".
      *----------  運用通貨未収収益計上・戻入額
           10  FILLER              PIC  X(16)  VALUE "UYTK_MSSE_KJMIG,".
      *----------  市場通貨払出単価
           10  FILLER              PIC  X(11)  VALUE "SJTK_H_TNK,".
      *----------  運用通貨払出単価
           10  FILLER              PIC  X(11)  VALUE "UYTK_H_TNK,".
      *----------  同一コスト継続フラグ
           10  FILLER              PIC  X(18)  VALUE
                                               "SAME_COST_KZK_FLG ".
           10  FILLER              PIC  X(05)  VALUE  "FROM ".
           10  SQL-TBL-ID-13       PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  証券種別コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(13)  VALUE  "SEC_SBT_CD = ".
           10  FILLER              PIC  X(13)  VALUE  ":P_SEC_SBT_CD".
      *----------  銘柄コード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "MEG_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_MEG_CD".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "TATE_FLG = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_TATE_FLG".
      *----------  玉ID
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(11)  VALUE  "GYOKU_ID = ".
           10  FILLER              PIC  X(11)  VALUE  ":P_GYOKU_ID".
      *----------  基準日
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "KJN_YMD= ".
           10  FILLER              PIC  X(10)  VALUE  ":P_KJN_YMD".
      *----------  決算日断面区分
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(15)  VALUE  "KSN_YMD_DMN_KBN".
           10  FILLER              PIC  X(13)  VALUE  " IN ('0','2')".
      *----------  取引差分更新管理SQL文(別紙1-6)
         05  SQL-SELECT-1-6.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  証券種別コード
           10  FILLER              PIC  X(11)  VALUE  "SEC_SBT_CD,".
      *----------  銘柄コード
           10  FILLER              PIC  X(08)  VALUE  " MEG_CD,".
      *----------  資産負債・買建売建フラグ
           10  FILLER              PIC  X(10)  VALUE  " TATE_FLG,".
      *----------  玉ID
           10  FILLER              PIC  X(10)  VALUE  " GYOKU_ID,".
      *---------- 市場通貨コード
           10  FILLER              PIC  X(14)  VALUE  " SIJO_TUKA_CD ".
      *----------  差分計算開始日 （約定）/（受渡）
           10  WK-KAISI-KJN-YMD    PIC  X(18).
           10  FILLER              PIC  X(06)  VALUE  " FROM ".
           10  SQL-TBL-ID-6        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE  " WHERE ".
      *----------  利用会社コード
           10  FILLER              PIC  X(14)  VALUE  "RIYO_CMP_CD = ".
           10  FILLER              PIC  X(14)  VALUE  ":P_RIYO_CMP_CD".
      *----------  ファンドコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(10)  VALUE  "FUND_CD = ".
           10  FILLER              PIC  X(10)  VALUE  ":P_FUND_CD".
      *----------  ポートフォリオコード
           10  FILLER              PIC  X(05)  VALUE  " AND ".
           10  FILLER              PIC  X(09)  VALUE  "PTF_CD = ".
           10  FILLER              PIC  X(09)  VALUE  ":P_PTF_CD".
      *----------  差分計算開始日 （約定）/（受渡）
           10  WK-SBN-CALC-FROM    PIC  X(74).
      *---------- SELECT SQL文(別紙1-15)
         05  SQL-UPDATE-1-15.
           10  SQL-UPDATE.
             15  FILLER            PIC  X(07)  VALUE "UPDATE ".
             15  SQL-TKMZBW03      PIC  X(13).
             15  FILLER            PIC  X(05)  VALUE " SET ".
             15  FILLER            PIC  X(26)
                 VALUE "SEC_SBT_CD = :P_SEC_SBT_CD".
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 処理実行日
             15  FILLER            PIC  X(25)  VALUE
                 " SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *---------- 銘柄コード
             15  FILLER            PIC  X(23)  VALUE
                 " AND MEG_CD = :P_MEG_CD".
      *---------- 証券種別コード
             15  FILLER            PIC  X(24)  VALUE
                 " AND SEC_SBT_CD = 'MA99'".
      *---------- 資産負債・買建売建フラグ
             15  FILLER            PIC  X(27)  VALUE
                 " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- 銘柄種類
             15  FILLER            PIC  X(33)  VALUE
                 " AND MEG_CD_SHRU = :P_MEG_CD_SHRU".
      *----------  商品属性抽出SQL文(別紙1-16)
         05  SQL-SELECT-1-16.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  証券種別コード
           10  FILLER              PIC  X(12)  VALUE  "SEC_SBT_CD, ".
      *----------  管理数量単位
           10  FILLER              PIC  X(16)  VALUE
               "KANRI_SURYO_TANI".
           10  FILLER              PIC  X(06)  VALUE  " FROM ".
           10  SQL-TKCMSZ00        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE " WHERE ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(29)  VALUE
               "RIYO_CMP_CD = :P_RIYO_CMP_CD ".
      *---------- 削除区分
           10  FILLER              PIC  X(20)  VALUE
               "AND SAKUJO_KBN = ' '".
      *---------- UPDATE SQL文(別紙1-18)
         05  SQL-UPDATE-1-18.
           10  SQL-UPDATE.
             15  FILLER            PIC  X(07)  VALUE "UPDATE ".
             15  SQL-TKDYAA35      PIC  X(13).
             15  FILLER            PIC  X(05)  VALUE " SET ".
             15  FILLER            PIC  X(16)
                 VALUE "KJN_YMD_FROM = 0".
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(29)  VALUE
                 " RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- 処理実行日
             15  FILLER            PIC  X(29)  VALUE
                 " AND SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
             15  FILLER            PIC  X(27)  VALUE
                 " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 評価系列コード
             15  FILLER            PIC  X(33)  VALUE
                 " AND HYK_KRTU_CD = :P_HYK_KRTU_CD".
      *---------- 帳票ID
             15  FILLER            PIC  X(23)  VALUE
                 " AND REP_ID = :P_REP_ID".
      *---------- 帳票任意コード
             15  FILLER            PIC  X(31)  VALUE
                 " AND REP_ANY_CD = :P_REP_ANY_CD".
      *---------- SELECT SQL文(別紙1-20)
         05  SQL-SELECT-1-20.
           10  SQL-SELECT.
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- ファンドコード
             15  FILLER            PIC  X(08)  VALUE "FUND_CD,".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(07)  VALUE "PTF_CD,".
      *---------- 計算期間FROM
             15  FILLER            PIC  X(19)  VALUE
                                                  "MIN(CALC_KKN_FROM),".
      *---------- 計算期間TO
             15  FILLER            PIC  X(16)  VALUE "MAX(CALC_KKN_TO)".
           10  SQL-FROM.
             15  FILLER            PIC  X(08)  VALUE " FROM ((".
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- ファンドコード
             15  FILLER            PIC  X(08)  VALUE "FUND_CD,".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(07)  VALUE "PTF_CD,".
      *---------- 計算期間FROM
             15  FILLER            PIC  X(14)  VALUE "CALC_KKN_FROM,".
      *---------- 計算期間TO
             15  FILLER            PIC  X(11)  VALUE "CALC_KKN_TO".
             15  SQL2-FROM.
               20  FILLER          PIC  X(06)  VALUE " FROM ".
               20  SQL2-TKDYGP12   PIC  X(13).
             15  FILLER            PIC  X(13)  VALUE ") UNION ALL (".
             15  FILLER            PIC  X(07)  VALUE "SELECT ".
      *---------- ファンドコード
             15  FILLER            PIC  X(08)  VALUE "FUND_CD,".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(07)  VALUE "PTF_CD,".
      *---------- 計算期間FROM
             15  FILLER            PIC  X(14)  VALUE "CALC_KKN_FROM,".
      *---------- 計算期間TO
             15  FILLER            PIC  X(11)  VALUE "CALC_KKN_TO".
             15  SQL4-FROM.
               20  FILLER          PIC  X(06)  VALUE " FROM ".
               20  SQL4-TKDYGP16   PIC  X(13).
           10  SQL-GROUP-BY.
             15  FILLER            PIC  X(12)  VALUE ")) GROUP BY ".
      *---------- ファンドコード
             15  FILLER            PIC  X(08)  VALUE "FUND_CD,".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(06)  VALUE "PTF_CD".
           10  SQL-ORDER-BY.
             15  FILLER            PIC  X(10)  VALUE " ORDER BY ".
      *---------- ファンドコード
             15  FILLER            PIC  X(08)  VALUE "FUND_CD,".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(06)  VALUE "PTF_CD".
      *---------- SELECT SQL文(別紙1-21)
         05  SQL-SELECT-1-21.
           10  FILLER              PIC  X(07)  VALUE "SELECT ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(12)  VALUE "RIYO_CMP_CD,".
      *---------- 残高基準日FROM
           10  FILLER              PIC  X(16)  VALUE "ZN_KJN_YMD_FROM,".
      *---------- 残高基準日TO
           10  FILLER              PIC  X(13)  VALUE "ZN_KJN_YMD_TO".
           10  FILLER              PIC  X(06)  VALUE " FROM ".
           10  SQL-TKDYGP17        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE " WHERE ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(39)  VALUE
               "RIYO_CMP_CD = :P_RIYO_CMP_CD FOR UPDATE".
      *---------- UPDATE SQL文(別紙1-21)
         05  SQL-UPDATE-1-21.
           10  FILLER              PIC  X(07)  VALUE "UPDATE ".
           10  SQL-TKDYGP17        PIC  X(13).
           10  FILLER              PIC  X(05)  VALUE " SET ".
      *---------- 業務タスクＩＤ
           10  FILLER              PIC  X(33)  VALUE
               "GYOMU_TASK_ID = :P_GYOMU_TASK_ID,".
      *---------- 更新日時
           10  FILLER              PIC  X(19)  VALUE
               "UPD_DATE = SYSDATE,".
      *---------- 更新ログインユーザ会社コード
           10  FILLER              PIC  X(39)  VALUE
               "UPD_LOGIN_CMP_CD = :P_UPD_LOGIN_CMP_CD,".
      *---------- 更新ユーザＩＤ
           10  FILLER              PIC  X(21)  VALUE
               "UPD_SID = :P_UPD_SID,".
      *---------- 更新プログラムＩＤ
           10  FILLER              PIC  X(24)  VALUE
               "UPD_PGMID = :P_UPD_PGMID".
           10  FILLER              PIC  X(07)  VALUE " WHERE ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(28)  VALUE
               "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- SELECT SQL文(別紙1-19)
         05  SQL-SELECT-1-19.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *----------  市場通貨未収収益計上・戻入額
           10  FILLER              PIC  X(17)
               VALUE  "SJTK_MSSE_KJMIG, ".
      *----------  運用通貨未収収益計上・戻入額
           10  FILLER              PIC  X(15)  VALUE  "UYTK_MSSE_KJMIG".
           10  SQL-FROM.
             15  FILLER            PIC  X(06)  VALUE " FROM ".
             15  SQL-TKMZSR00      PIC  X(13).
           10  SQL-WHERE.
             15  FILLER            PIC  X(06)  VALUE " WHERE".
      *---------- 利用会社コード
             15  FILLER            PIC  X(29)  VALUE
                 " RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
             15  FILLER            PIC  X(25)  VALUE
                 " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
             15  FILLER            PIC  X(23)  VALUE
                 " AND PTF_CD = :P_PTF_CD".
      *---------- 決済口座番号
             15  FILLER            PIC  X(31)  VALUE
                 " AND KS_KOZA_NO = :P_KS_KOZA_NO".
      *---------- 基準日
             15  FILLER            PIC  X(25)  VALUE
                 " AND KJN_YMD = :P_KJN_YMD".
      *----------  決算日断面区分
             15  FILLER            PIC  X(33)  VALUE
                 " AND KSN_YMD_DMN_KBN IN ('0','2')".
      *---------- UPDATE SQL文(別紙1-22)
         05  SQL-UPDATE-1-22.
           10  FILLER              PIC  X(07)  VALUE  "UPDATE ".
           10  SQL-TKMZSK00        PIC  X(13).
           10  FILLER              PIC  X(05)  VALUE  " SET ".
      *---------- 差分計算開始日
           10  SQL-SBN-CALC-FROM   PIC  X(41).
      *---------- 最終有効日
           10  FILLER              PIC  X(33)  VALUE
               "LAST_YUKO_YMD = :P_LAST_YUKO_YMD,".
      *---------- 更新日時
           10  FILLER              PIC  X(19)  VALUE
               "UPD_DATE = SYSDATE,".
      *---------- 更新ログインユーザ会社コード
           10  FILLER              PIC  X(39)  VALUE
               "UPD_LOGIN_CMP_CD = :P_UPD_LOGIN_CMP_CD,".
      *---------- 更新ユーザＩＤ
           10  FILLER              PIC  X(21)  VALUE
               "UPD_SID = :P_UPD_SID,".
      *---------- 更新プログラムＩＤ
           10  FILLER              PIC  X(25)  VALUE
               "UPD_PGMID = :P_UPD_PGMID ".
           10  FILLER              PIC  X(06)  VALUE "WHERE ".
      *---------- ファンドコード
           10  FILLER              PIC  X(20)  VALUE
               "FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
           10  FILLER              PIC  X(23)  VALUE
               " AND PTF_CD = :P_PTF_CD".
      *---------- 証券種別、銘柄コード、資産/負債・買建/売建フラグ、玉ID
           10  FILLER              PIC  X(42)  VALUE
               " AND (SEC_SBT_CD,MEG_CD,TATE_FLG,GYOKU_ID)".
           10  FILLER              PIC  X(47)  VALUE
               " IN (SELECT SEC_SBT_CD,MEG_CD,TATE_FLG,GYOKU_ID".
           10  FILLER              PIC  X(06)  VALUE " FROM ".
           10  SQL-TKMZBW03        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE " WHERE ".
      *---------- 処理実行日
           10  FILLER              PIC  X(24)  VALUE
               "SYORI_YMD = :P_SYORI_YMD".
      *---------- 起動ID
           10  FILLER              PIC  X(27)  VALUE
               " AND KIDOU_ID = :P_KIDOU_ID".
      *---------- 利用会社コード
           10  FILLER              PIC  X(33)  VALUE
               " AND RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
           10  FILLER              PIC  X(25)  VALUE
               " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
           10  FILLER              PIC  X(23)  VALUE
               " AND PTF_CD = :P_PTF_CD".
      *---------- 基準日
           10  FILLER              PIC  X(25)  VALUE
               " AND KJN_YMD = :P_KJN_YMD".
      *---------- 有効銘柄フラグ
           10  FILLER              PIC  X(23)  VALUE
               " AND YUKO_MEG_FLG = '0'".
      *---------- 銘柄種類
           10  FILLER              PIC  X(22)  VALUE
               " AND MEG_CD_SHRU = '1'".
      *---------- 証券種別
           10  FILLER              PIC  X(51)  VALUE
               " AND SEC_SBT_CD NOT IN ('CASH','MA99','MAR','MABF',".
           10  FILLER              PIC  X(47)  VALUE
               "'MABO','MAB','MAFB','MASF','MASO','MAS','MAFS')".
      *---------- GROUP BY
      *---------- 証券種別、銘柄コード、資産/負債・買建/売建フラグ、玉ID
           10  FILLER              PIC  X(46)  VALUE
               " GROUP BY SEC_SBT_CD,MEG_CD,TATE_FLG,GYOKU_ID)".
      *---------- 差分計算開始日（約定）
         05  SQL-UPDATE-1-22-YKJ.
           10  FILLER              PIC  X(41)  VALUE
               "SBN_CALC_FROM_YKJ = :P_SBN_CALC_FROM_YKJ,".
      *---------- 差分計算開始日（受渡）
         05  SQL-UPDATE-1-22-UKE.
           10  FILLER              PIC  X(41)  VALUE
               "SBN_CALC_FROM_UKE = :P_SBN_CALC_FROM_UKE,".
      *---------- 約定ベースの場合
         05  SQL-UPDATE-22-YKJ.
           10  FILLER              PIC  X(46)  VALUE
               " AND SBN_CALC_FROM_YKJ < :P_SBN_CALC_FROM_YKJ ".
         05  SQL-UPDATE-22-UKE.
      *---------- 受渡ベースの場合
           10  FILLER              PIC  X(46)  VALUE
               " AND SBN_CALC_FROM_UKE < :P_SBN_CALC_FROM_UKE ".
      *---------- SELECT SQL文(別紙1-23)
         05  SQL-SELECT-1-23.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(11)  VALUE  "RIYO_CMP_CD".
           10  FILLER              PIC  X(06)  VALUE " FROM ".
           10  SQL-TKMZSR00        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE " WHERE ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(28)  VALUE
               "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
           10  FILLER              PIC  X(25)  VALUE
               " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
           10  FILLER              PIC  X(23)  VALUE
               " AND PTF_CD = :P_PTF_CD".
      *---------- 決済口座番号
           10  FILLER              PIC  X(31)  VALUE
               " AND KS_KOZA_NO = :P_KS_KOZA_NO".
      *---------- 証券種別コード like 'MA%'
           10  FILLER              PIC  X(26)  VALUE
               " AND SEC_SBT_CD LIKE 'MA%'".
      *---------- 基準日
           10  FILLER              PIC  X(25)  VALUE
               " AND KJN_YMD = :P_KJN_YMD".
      *---------- SELECT SQL文(別紙1-24)
         05  SQL-SELECT-1-24.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(11)  VALUE  "RIYO_CMP_CD".
           10  FILLER              PIC  X(06)  VALUE " FROM ".
           10  SQL-TKMXST00        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE " WHERE ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(28)  VALUE
               "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
           10  FILLER              PIC  X(25)  VALUE
               " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
           10  FILLER              PIC  X(44)  VALUE
               " AND (PTF_CD = :P_PTF_CD OR PTF_CD = '    ')".
      *---------- 決済口座番号
           10  FILLER              PIC  X(31)  VALUE
               " AND KS_KOZA_NO = :P_KS_KOZA_NO".
      *---------- 異動日
           10  FILLER              PIC  X(31)  VALUE
               " AND IDO_YMD > :P_KAISI_KJN_YMD".
      *---------- 基準日
           10  FILLER              PIC  X(26)  VALUE
               " AND IDO_YMD <= :P_KJN_YMD".
      *---------- SELECT SQL文(別紙1-25)
         05  SQL-SELECT-1-25.
           10  FILLER              PIC  X(07)  VALUE  "SELECT ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(11)  VALUE  "RIYO_CMP_CD".
           10  FILLER              PIC  X(06)  VALUE " FROM ".
           10  SQL-TKMZMS00        PIC  X(13).
           10  FILLER              PIC  X(07)  VALUE " WHERE ".
      *---------- 利用会社コード
           10  FILLER              PIC  X(28)  VALUE
               "RIYO_CMP_CD = :P_RIYO_CMP_CD".
      *---------- ファンドコード
           10  FILLER              PIC  X(25)  VALUE
               " AND FUND_CD = :P_FUND_CD".
      *---------- ポートフォリオコード
           10  FILLER              PIC  X(23)  VALUE
               " AND PTF_CD = :P_PTF_CD".
      *---------- 銘柄コード
           10  FILLER              PIC  X(23)  VALUE
               " AND MEG_CD = :P_MEG_CD".
      *---------- 証券種別コード
           10  FILLER              PIC  X(26)  VALUE
               " AND SEC_SBT_CD LIKE 'MA%'".
      *---------- 資産負債・買建売建フラグ
           10  FILLER              PIC  X(27)  VALUE
               " AND TATE_FLG = :P_TATE_FLG".
      *---------- 玉ID
           10  FILLER              PIC  X(27)  VALUE
               " AND GYOKU_ID = :P_GYOKU_ID".
      *---------- 適用開始日
           10  FILLER              PIC  X(35)  VALUE
               " AND TEKIYO_FROM > :P_KAISI_KJN_YMD".
      *---------- 適用開始日
           10  FILLER              PIC  X(30)  VALUE
               " AND TEKIYO_FROM <= :P_KJN_YMD".
      ******************************************************************
      *                エラーメッセージ
      ******************************************************************
       01  E-MSG-TBL.
      *---------- SELECT SQL文(別紙1-1)
         05  WK-MSG-1-1.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKMZSK00         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-S        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-S         PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE
               "'".
           10  FILLER              PIC  X(11)  VALUE
               " FOR UPDATE".
      *---------- SELECT SQL文(別紙1-2)
         05  WK-MSG-1-2.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TAB-TKMZBW02     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(12)  VALUE
               " SYORI_YMD =".
           10  WK-SYORI-YMD-S      PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-S       PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-S        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-S         PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE
               "'".
           10  FILLER              PIC  X(09)  VALUE " ORDER BY".
           10  FILLER              PIC  X(07)  VALUE " JUNBAN".
      *---------- SELECT SQL文(別紙1-3)
         05  WK-MSG-1-3.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TAB1-TKMZBW03    PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(12)  VALUE
               " SYORI_YMD =".
           10  WK-SYORI-YMD-1S     PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-1S      PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-1S   PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-1S       PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-1S        PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD-1S       PIC  S9(08).
           10  FILLER              PIC  X(10)  VALUE
               " , TBL-ID(".
           10  WK-TAB2-TKMXTR00    PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(35)  VALUE
               " WHERE ( MEG_CD,SEC_SBT_CD,TATE_FLG".
           10  FILLER              PIC  X(28)  VALUE
               ",GYOKU_ID,SIJO_TUKA_CD ) IN ".
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TAB3-TKMZBW03    PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(13)  VALUE
               "( SYORI_YMD =".
           10  WK-SYORI-YMD-2S     PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-2S      PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-2S   PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-2S       PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-2S        PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD-2S       PIC  S9(08).
           10  FILLER              PIC  X(20)  VALUE
               ") AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-3S   PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-3S       PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-3S        PIC  X(04).
           10  FILLER              PIC  X(02)  VALUE
               "' ".
           10  FILLER              PIC  X(46)  VALUE
               " AND TORI_JIYU IN ('SDID','CIQD','CISD','OCID'".
           10  FILLER              PIC  X(30)  VALUE
                 ",'MRGD','CONS','CID ','ISD ') ".
           10  FILLER              PIC  X(05)  VALUE " AND ".
           10  WK-DATE             PIC  X(07).
           10  FILLER              PIC  X(09)  VALUE
               " BETWEEN ".
           10  WK-DMKJN-YMD-S1     PIC  S9(08).
           10  FILLER              PIC  X(05)  VALUE
               " AND ".
           10  WK-DMKJN-YMD-S2     PIC  S9(08).
      *---------- SELECT SQL文(別紙1-4)
         05  WK-MSG-1-4.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKMZBW04         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(12)  VALUE
               " SYORI_YMD =".
           10  WK-SYORI-YMD-S      PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-S       PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-S        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-S         PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD-S        PIC  S9(08).
           10  FILLER              PIC  X(14)  VALUE
               " AND MEG_CD ='".
           10  WK-MEG-CD-S         PIC  X(15).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC_SBT_CD ='".
           10  WK-SEC-SBT-CD-S     PIC  X(04).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG-S       PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID-S       PIC  X(10).
           10  FILLER              PIC  X(01)  VALUE
               "'".
           10  FILLER              PIC  X(09)  VALUE " ORDER BY".
           10  FILLER              PIC  X(06)  VALUE " SRJUN".
      *---------- SELECT SQL文(別紙1-5)
         05  WK-MSG-1-5.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKMZBW05         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(12)  VALUE
               " SYORI_YMD =".
           10  WK-SYORI-YMD-S      PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-S       PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-S        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-S         PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD-S        PIC  S9(08).
           10  FILLER              PIC  X(14)  VALUE
               " AND MEG_CD ='".
           10  WK-MEG-CD-S         PIC  X(15).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC_SBT_CD ='".
           10  WK-SEC-SBT-CD-S     PIC  X(04).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG-S       PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID-S       PIC  X(10).
           10  FILLER              PIC  X(01)  VALUE
               "'".
           10  FILLER              PIC  X(09)  VALUE " ORDER BY".
           10  FILLER              PIC  X(06)  VALUE " SRJUN".
      *---------- UPDATE SQL文(別紙1-7)
         05  WK-MSG-1-7.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKDYAA35         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(19)  VALUE
               " SET KJN_YMD_FROM =".
           10  WK-KJN-YMD-FROM     PIC  S9(08).
           10  FILLER              PIC  X(21)  VALUE
               " WHERE RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(17)  VALUE
               "' AND SYORI_YMD =".
           10  WK-SYORI-YMD-S      PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-S       PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-S        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-S         PIC  X(04).
           10  FILLER              PIC  X(23)  VALUE
               "' AND HYK_KRTU_CD = ' '".
           10  FILLER              PIC  X(17)  VALUE
               " AND REP_ID = ' '".
           10  FILLER              PIC  X(21)  VALUE
               " AND REP_ANY_CD = ' '".
           10  FILLER              PIC  X(19)  VALUE
               " AND KJN_YMD_FROM =".
           10  WK-KJN-YMD-FROM-S   PIC  S9(08).
      *---------- SELECT SQL文(別紙1-8)
         05  WK-MSG-1-8.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKMXTR00         PIC  X(13).
           10  WK-TKMXTR01         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND TORI_ID =".
           10  WK-TORI-ID-S        PIC  S9(10).
      *---------- SELECT SQL文(別紙1-10)
         05  WK-MSG-1-10.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKMZBW18         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND TORI_ID =".
           10  WK-TORI-ID-S        PIC  S9(10).
           10  FILLER              PIC  X(18)  VALUE
               " AND KS_KOZA_NO ='".
           10  WK-KS-KOZA-NO-S     PIC  X(15).
           10  FILLER              PIC  X(18)  VALUE
               "' AND SIKIN_SBT ='".
           10  WK-SIKIN-SBT-S      PIC  X(01).
           10  FILLER              PIC  X(15)  VALUE
               "' AND IDO_YMD =".
           10  WK-IDO-YMD-S        PIC  S9(08).
           10  FILLER              PIC  X(14)  VALUE
               " AND ZG_KBN ='".
           10  WK-ZG-KBN-S         PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE
               "'".
           10  FILLER              PIC  X(17)  VALUE
                 " AND SYORI_YMD = ".
           10  WK-SYORI-YMD-S      PIC  S9(08).
           10  FILLER              PIC  X(17)  VALUE
                 " AND KIDOU_ID = '".
           10  WK-KIDOU-ID-S       PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE
               "'".
      *---------- SELECT SQL文(別紙1-11)
         05  WK-MSG-1-11.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZBW06     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(18)  VALUE
               "' AND SYORI_YMD = ".
           10  WK-SYORI-YMD        PIC  9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID         PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC_SBT_CD ='".
           10  WK-SEC-SBT-CD       PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND MEG_CD ='".
           10  WK-MEG-CD           PIC  X(15).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG         PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID         PIC  X(10).
           10  FILLER              PIC  X(19)  VALUE
               " AND IDO-KJY-JUN < ".
           10  WK-IDO-KJY-JUN      PIC  S9(08).
      *---------- SELECT SQL文(別紙1-12)
         05  WK-MSG-1-12.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZZI00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC-SBT-CD ='".
           10  WK-SEC-SBT-CD       PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND MEG_CD ='".
           10  WK-MEG-CD           PIC  X(15).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG         PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID         PIC  X(10).
           10  FILLER              PIC  X(24)  VALUE
               "' AND KEIJOU_KIJUNBI <= ".
           10  WK-KEIJOU-KIJUNBI   PIC  9(08).
      *---------- SELECT SQL文(別紙1-13)
         05  WK-MSG-1-13.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZZR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND SEC_SBT_CD ='".
           10  WK-SEC-SBT-CD       PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND MEG_CD ='".
           10  WK-MEG-CD           PIC  X(15).
           10  FILLER              PIC  X(17)  VALUE
               "' AND TATE_FLG ='".
           10  WK-TATE-FLG         PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID         PIC  X(10).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD          PIC  S9(08).
           10  FILLER              PIC  X(33)  VALUE
               " AND KSN_YMD_DMN_KBN IN ('0','2')".
      *---------- SELECT SQL文(別紙1-6)
         05  WK-MSG-1-6.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZSK00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(06)  VALUE
               "' ".
           10  WK-SBN-CALC-FROM-1  PIC  X(26).
           10  WK-SBN-CALC-FROM-2  PIC  S9(08).
      *---------- SELECT SQL文(別紙1-15)
         05  WK-MSG-1-15.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKMZBW03-S       PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(19)  VALUE
               " SET SEC_SBT_CD =".
           10  WK-SEC-SBT-CD       PIC  X(04).
           10  FILLER              PIC  X(18)  VALUE
               " WHERE SYORI_YMD =".
           10  WK-SYORI-YMD-S      PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-S       PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-S        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-S         PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD-S        PIC  S9(08).
           10  FILLER              PIC  X(15)  VALUE
               " AND  MEG_CD ='".
           10  WK-MEG-CD-S         PIC  X(15).
           10  FILLER              PIC  X(24)  VALUE
               "' AND SEC_SBT_CD ='MA99'".
           10  WK-SEC-SBT-CD-S     PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               " AND TATE_FLG ='".
           10  WK-TATE-FLG-S       PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID-S       PIC  X(10).
           10  FILLER              PIC  X(20)  VALUE
               "' AND MEG_CD_SHRU ='".
           10  WK-MEG-CD-SHRU-S    PIC  X(01).
           10  FILLER              PIC  X(01)  VALUE
               "'".
      *---------- SELECT SQL文(別紙1-16)
         05  WK-MSG-1-16.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKCMSZ00-S       PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(14)  VALUE
               "RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(21)  VALUE
               "' AND SAKUJO_KBN =' '".
      *---------- UPDATE SQL文(別紙1-18)
         05  WK-MSG-1-18.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKDYAA35         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(25)  VALUE
               " SET KJN_YMD_FROM = ZERO ".
           10  FILLER              PIC  X(21)  VALUE
               " WHERE RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(17)  VALUE
               "' AND SYORI_YMD =".
           10  WK-SYORI-YMD-S      PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID-S       PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-S        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-S         PIC  X(04).
           10  FILLER              PIC  X(23)  VALUE
               "' AND HYK_KRTU_CD = ' '".
           10  FILLER              PIC  X(17)  VALUE
               " AND REP_ID = ' '".
           10  FILLER              PIC  X(21)  VALUE
               " AND REP_ANY_CD = ' '".
      *---------- SELECT SQL文(別紙1-20)
         05  WK-MSG-1-20.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKDYGP12         PIC  X(13).
           10  FILLER              PIC  X(01)  VALUE
               ",".
           10  WK-TKDYGP16         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
      *---------- SELECT SQL文(別紙1-21)
         05  WK-MSG-1-21-1.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKDYGP17         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(14)  VALUE
               "RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD-S    PIC  X(04).
           10  FILLER              PIC  X(12)  VALUE
               "' FOR UPDATE".
      *---------- UPDATE SQL文(別紙1-21)
         05  WK-MSG-1-21-2.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKDYGP17         PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(22)  VALUE
               " SET GYOMU_TASK_ID = '".
           10  WK-GYOMU-TASK-ID    PIC  X(07).
           10  FILLER              PIC  X(20)  VALUE
               "',UPD_DATE = SYSDATE".
           10  FILLER              PIC  X(21)  VALUE
               ",UPD_LOGIN_CMP_CD = '".
           10  WK-UPD-LOGIN-CMP-CD PIC  X(04).
           10  FILLER              PIC  X(13)  VALUE
               "',UPD_SID = '".
           10  WK-UPD-SID          PIC  X(20).
           10  FILLER              PIC  X(15)  VALUE
               "',UPD_PGMID = '".
           10  WK-UPD-PGMID        PIC  X(16).
           10  FILLER              PIC  X(23)  VALUE
               "' WHERE RIYO_CMP_CD = '".
           10  WK-RIYO-CMP-CD-U    PIC  X(04).
           10  FILLER              PIC  X(01)  VALUE
               "'".
      *---------- SELECT SQL文(別紙1-19)
         05  WK-MSG-1-19.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-TKMZSR00-S       PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND KS_KOZA_NO ='".
           10  WK-KS-KOZA-NO       PIC  X(15).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD          PIC  S9(08).
           10  FILLER              PIC  X(34)  VALUE
               "' AND KSN_YMD_DMN_KBN IN ('0','2')".
      *---------- UPDATE SQL文(別紙1-22)
         05  WK-MSG-1-22.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZSK00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(05)  VALUE
               " SET ".
           10  WK-SBN-CALC-FROM-1  PIC  X(20).
           10  WK-SBN-CALC-FROM    PIC  S9(08).
           10  FILLER              PIC  X(17)  VALUE
               ",LAST_YUKO_YMD = ".
           10  WK-LAST-YUKO-YMD    PIC  S9(08).
           10  FILLER              PIC  X(21)  VALUE
               ", UPD_DATE = SYSDATE,".
           10  FILLER              PIC  X(21)  VALUE
               " UPD_LOGIN_CMP_CD = '".
           10  WK-UPD-LOGIN-CMP-CD PIC  X(04).
           10  FILLER              PIC  X(13)  VALUE
               "',UPD_SID = '".
           10  WK-UPD-SID          PIC  X(20).
           10  FILLER              PIC  X(15)  VALUE
               "',UPD_PGMID = '".
           10  WK-UPD-PGMID        PIC  X(16).
           10  FILLER              PIC  X(19)  VALUE
               "' WHERE FUND_CD = '".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(16)  VALUE
               "' AND PTF_CD = '".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(43)  VALUE
               "' AND (SEC_SBT_CD,MEG_CD,TATE_FLG,GYOKU_ID)".
           10  FILLER              PIC  X(11)  VALUE
               " IN TBL-ID(".
           10  WK-MSG-TKMZBW03     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(13)  VALUE
               "( SYORI_YMD =".
           10  WK-SYORI-YMD        PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND KIDOU_ID ='".
           10  WK-KIDOU-ID         PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' AND RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD-2        PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD-2         PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND KJN_YMD =".
           10  WK-KJN-YMD          PIC  S9(08).
           10  FILLER              PIC  X(23)  VALUE
               " AND YUKO_MEG_FLG = '0'".
           10  FILLER              PIC  X(22)  VALUE
               " AND MEG_CD_SHRU = '1'".
      *---------- 証券種別
           10  FILLER              PIC  X(51)  VALUE
               " AND SEC_SBT_CD NOT IN ('CASH','MA99','MAR','MABF',".
           10  FILLER              PIC  X(47)  VALUE
               "'MABO','MAB','MAFB','MASF','MASO','MAS','MAFS')".
           10  FILLER              PIC  X(46)  VALUE
               " GROUP BY SEC_SBT_CD,MEG_CD,TATE_FLG,GYOKU_ID)".
         05  WK-MSG-1-22-YKJ.
           10  FILLER              PIC  X(20)  VALUE
               "SBN_CALC_FROM_YKJ = ".
      *---------- 差分計算開始日（受渡）
         05  WK-MSG-1-22-UKE.
           10  FILLER              PIC  X(20)  VALUE
               "SBN_CALC_FROM_UKE = ".
      *---------- 約定ベースの場合
         05  WK-MSG-22-YKJ.
           10  FILLER              PIC  X(25)  VALUE
               " AND SBN_CALC_FROM_YKJ < ".
           10  WK-DMN-KJN-YMD-NEXT-1
                                   PIC  S9(08).
         05  WK-MSG-22-UKE.
      *---------- 受渡ベースの場合
           10  FILLER              PIC  X(25)  VALUE
               " AND SBN_CALC_FROM_UKE < ".
           10  WK-DMN-KJN-YMD-NEXT-2
                                   PIC  S9(08).
      *---------- SELECT SQL文(別紙1-23)
         05  WK-MSG-1-23.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZSR00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(19)  VALUE
               "' AND KS_KOZA_NO ='".
           10  WK-KS-KOZA-NO       PIC  X(15).
           10  FILLER              PIC  X(27)  VALUE
               "' AND SEC_SBT_CD LIKE 'MA%'".
           10  FILLER              PIC  X(14)  VALUE
               " AND KJN_YMD =".
           10  WK-KJN-YMD          PIC  S9(08).
      *---------- SELECT SQL文(別紙1-24)
         05  WK-MSG-1-24.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMXST00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(16)  VALUE
               "' AND (PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(20)  VALUE
               "' OR PTF_CD ='    ')".
           10  FILLER              PIC  X(18)  VALUE
               " AND KS_KOZA_NO ='".
           10  WK-KS-KOZA-NO       PIC  X(15).
           10  FILLER              PIC  X(16)  VALUE
               "' AND IDO_YMD > ".
           10  WK-KAISI-KJN-YMD    PIC  S9(08).
           10  FILLER              PIC  X(16)  VALUE
               " AND IDO_YMD <= ".
           10  WK-KJN-YMD          PIC  S9(08).
      *---------- SELECT SQL文(別紙1-25)
         05  WK-MSG-1-25.
           10  FILLER              PIC  X(08)  VALUE
               " TBL-ID(".
           10  WK-MSG-TKMZMS00     PIC  X(13).
           10  FILLER              PIC  X(02)  VALUE
               "),".
           10  FILLER              PIC  X(15)  VALUE
               " RIYO_CMP_CD ='".
           10  WK-RIYO-CMP-CD      PIC  X(04).
           10  FILLER              PIC  X(16)  VALUE
               "' AND FUND_CD ='".
           10  WK-FUND-CD          PIC  X(12).
           10  FILLER              PIC  X(15)  VALUE
               "' AND PTF_CD ='".
           10  WK-PTF-CD           PIC  X(04).
           10  FILLER              PIC  X(15)  VALUE
               "' AND MEG_CD ='".
           10  WK-MEG-CD           PIC  X(15).
           10  FILLER              PIC  X(27)  VALUE
               "' AND SEC_SBT_CD LIKE 'MA%'".
           10  FILLER              PIC  X(16)  VALUE
               " AND TATE_FLG ='".
           10  WK-TATE-FLG         PIC  X(01).
           10  FILLER              PIC  X(17)  VALUE
               "' AND GYOKU_ID ='".
           10  WK-GYOKU-ID         PIC  X(10).
           10  FILLER              PIC  X(20)  VALUE
               "' AND TEKIYO_FROM > ".
           10  WK-KAISI-KJN-YMD    PIC  S9(08).
           10  FILLER              PIC  X(20)  VALUE
               " AND TEKIYO_FROM <= ".
           10  WK-KJN-YMD          PIC  S9(08).
      ******************************************************************
      *                 サブプログラム  パラメ−タ  エリア
      ******************************************************************
      *---------- 【SCZY7090】引数ＧＥＴルーチン
       01  PARM-SCZY7090-INOUT.
           COPY  "SCZY7090.cpy".
      *---------- 【SCZY7010】バッチ開始メッセージ出力ルーチン
       01  PARM-SCZY7010-INOUT.
           COPY  "SCZY7010.cpy".
      *---------- 【SCZY7100】バッチDB接続情報取得ルーチン
       01  PARM-SCZY7100-INOUT.
           COPY  "SCZY7100.cpy".
      *---------- 【SCZY7050】実行状況管理明細ＩＮＳルーチン
       01  PARM-SCZY7050-INOUT.
           COPY  "SCZY7050.cpy".
      *---------- 【SCZY7060】実行状況管理SELルーチン
       01  PARM-SCZY7060-INOUT.
           COPY  "SCZY7060.cpy".
      *----------  SCZY1020 カレンダールーチン
       01  PARM-SCZY1020-INOUT.
           COPY  "SCZY1020.cpy".
      *---------- 【SMZJ4091】Ｏ３Ｗ定義自動チェックルーチン
      *-----  サブルーチンＩＦ項目
       01  AIFA-HDR.
           COPY  "WOMCMAIFA.CPY".
       01  USER-ATTR-HDR.
           COPY  "CZCOMMONHEADER.cpy".
      *----- 入出力パラメータ
       01  SMZJ4091-ARG-IN.
           COPY  "INMMZJ0110_COBOL.cpy".
       01  SMZJ4091-ARG-OUT.
           COPY  "SMZJ4091.cpy".
      *---------- 【SMZJ0101】残高・損益更新処理起動単体チェックルーチン
       01  PARM-SMZJ0101-INOUT.
           COPY  "SMZJ0101.cpy".
      *---------- 【SCZY7210】実行状況管理明細ＵＰＤルーチン
       01  PARM-SCZY7210-INOUT.
           COPY  "SCZY7210.cpy".
      *---------- 【SMZJ1210】処理対象断面決定ルーチン
       01  PARM-SMZJ1210-INOUT.
           COPY  "SMZJ1210.cpy".
      *---------- 【SCZY7080】ポートフォリオ別メッセージＩＮＳルーチン
       01  PARM-SCZY7080-INOUT.
           COPY  "SCZY7080.cpy".
      *---------- 【SCZY7020】バッチ終了メッセージ出力ルーチン
       01  PARM-SCZY7020-INOUT.
           COPY  "SCZY7020.cpy".
      *---------- 【SCZY1160】テーブルID取得
       01  PARM-SCZY1160-INOUT.
           COPY  "SCZY1160.cpy".
      *---------- 【SCZY1190】進捗管理ＩＮＳＵＰＤルーチン
       01  PARM-SCZY1190-INOUT.
           COPY  "SCZY1190.cpy".
      *---------- 【SCZY1210】進捗管理ＩＮＳＵＰＤルーチン(残高向け)
       01  PARM-SCZY1210-INOUT.
           COPY  "SCZY1210.cpy".
      *---------- 【SMZJ1910】異動簿価・損益計算(物)
       01  PARM-SMZJ1910-INOUT.
           COPY  "SMZJ1910.cpy".
      *---------- 【SMZJ1922】資金切替判定
       01  PARM-SMZJ1922-INOUT.
           COPY  "SMZJ1922.cpy".
      *---------- 【SMZJ1920】異動簿価・損益計算(資金)
       01  PARM-SMZJ1920-INOUT.
           COPY  "SMZJ1920.cpy".
      *---------- 【SMZJ1510】対象銘柄（玉）決定ルーチン
       01  PARM-SMZJ1510-INOUT.
           COPY  "SMZJ1510.cpy".
      *---------- 【SMZJ1711】再計算履歴データ削除ルーチン
       01  PARM-SMZJ1711-INOUT.
           COPY  "SMZJ1711.cpy".
      *---------- 【SMZJ1712】約定ベース受渡順特殊差分処理
       01  PARM-SMZJ1712-INOUT.
           COPY  "SMZJ1712.cpy".
      *---------- 【SMZJ1610】開始時残高計算ルーチン
       01  PARM-SMZJ1610-INOUT.
           COPY  "SMZJ1610.cpy".
      *---------- 【SMZJ1710】再計算データ削除ルーチン
       01  PARM-SMZJ1710-INOUT.
           COPY  "SMZJ1710.cpy".
      *---------- 【SMZJ1810】対象取引決定と処理順決定（物）ルーチン
       01  PARM-SMZJ1810-INOUT.
           COPY  "SMZJ1810.cpy".
      *---------- 【SMZJ1820】対象取引決定と処理順決定（資金）ルーチン
       01  PARM-SMZJ1820-INOUT.
           COPY  "SMZJ1820.cpy".
      *---------- 【SMZJ2110】未収配当計算処理処理ルーチン
       01  PARM-SMZJ2110-INOUT.
           COPY  "SMZJ2110.cpy".
      *---------- 【SMZJ4021】勘定残高バランスチェックルーチン
       01  PARM-SMZJ4021-INOUT.
           COPY  "SMZJ4021.cpy".
      *---------- 【SMZJ2120】債券過去経過利息計算ルーチン
       01  PARM-SMZJ2120-INOUT.
           COPY  "SMZJ2120.cpy".
      *---------- 【SMZJ2130】その他未収収益計算ルーチン
       01  PARM-SMZJ2130-INOUT.
           COPY  "SMZJ2130.cpy".
      *---------- 【SMZJ2140】資金未収収益計算.xls
       01  PARM-SMZJ2140-INOUT.
           COPY  "SMZJ2140.cpy".
      *---------- 【SMZJ2150】未収収益計上計算.xls
       01  PARM-SMZJ2150-INOUT.
           COPY  "SMZJ2150.cpy".
      *---------- 【SMZJ2210】銘柄別残高計算ルーチン
       01  PARM-SMZJ2210-INOUT.
           COPY  "SMZJ2210.cpy".
      *---------- 【SMZJ2211】跨ぎ前払金異動額集計ルーチン
       01  PARM-SMZJ2211-INOUT.
           COPY  "SMZJ2211.cpy".
      *---------- 【SCZY4023】ポートフォリオと有効期間取得-III
       01  PARM-SCZY4023-INOUT.
           COPY  "SCZY4023.cpy".
      *---------- 【SCZY4103】通貨コード名称取得(復数)
       01  PARM-SCZY4103-INOUT.
           COPY  "SCZY4103.cpy".
      *---------- 【SCZY7200】処理対象実行状況管理明細ＧＥＴルーチン
       01  PARM-SCZY7200-INOUT.
           COPY  "SCZY7200.cpy".
      *---------- 【SCZY7040】バッチ処理件数出力ルーチン
       01  PARM-SCZY7040-INOUT.
           COPY  "SCZY7040.cpy".
      *---------- 【SMZJ2610】基準日断面情報
       01  PARM-SMZJ2610-INOUT.
           COPY  "SMZJ2610.cpy".
      *---------- 【SMZJ2310】DB更新
       01  PARM-SMZJ2310-INOUT.
           COPY  "SMZJ2310.cpy".
      *---------- 【SCZY3002】内部⇒外部銘柄コード変換ルーチン
       01  PARM-SCZY3002-INOUT.
           COPY  "SCZY3002.cpy".
      *---------- 【SCZY3031】銘柄属性取得ルーチン
       01  PARM-SCZY3031-INOUT.
           COPY  "SCZY3031.cpy".
      *---------- 【SMZJ4014】証券種別判定
       01  PARM-SMZJ4014-INOUT.
           COPY  "SMZJ4014.cpy".
      *---------- 【SMZJ4011】仕訳基準データ分析ルーチン
       01  PARM-SMZJ4011-INOUT.
           COPY  "SMZJ4011.cpy".
      *---------- 【SMZJ4012】取引事由判定ルーチン
       01  PARM-SMZJ4012-INOUT.
           COPY  "SMZJ4012.cpy".
      *---------- 【SMZJ4016】中間データ削除
       01  PARM-SMZJ4016-INOUT.
           COPY  "SMZJ4016.cpy".
      *---------- 【SMZJ4019】進捗管理なし断面の削除ルーチン
       01  PARM-SMZJ4019-INOUT.
           COPY  "SMZJ4019.cpy".
      *---------- 【SMZJ4020】仮払金未引落チェック
       01  PARM-SMZJ4020-INOUT.
           COPY  "SMZJ4020.cpy".
      *---------- 【SMZJ4022】数量単位再取得処理
       01  PARM-SMZJ4022-INOUT.
           COPY  "SMZJ4022.cpy".
      *---------- 【SMZJ4023】勘定異動バランスチェック
       01  PARM-SMZJ4023-INOUT.
           COPY  "SMZJ4023.cpy".
      *---------- 【SCZY1170】リターンパッケージセットルーチン
       01  PARM-SCZY1170-IN.
           COPY  "SCZY1170.cpy".
       01  PARM-SCZY1170-RTNPKG.
         05  PARM-SCZY1170-ARG2.
           COPY  "CZRTNPACKAGE.cpy".
      *---------- 【SCZY4313】ポートフォリオ属性情報メモリ格納処理
       01  PARM-SCZY4313-INOUT.
           COPY  "SCZY4313.cpy".
      *---------- 【SCZY4303】異動計算パターン情報メモリ格納処理
       01  PARM-SCZY4303-INOUT.
           COPY  "SCZY4303.cpy".
      *---------- 【SCZY4304】異動計算パターン情報取得処理
       01  PARM-SCZY4304-INOUT.
           COPY  "SCZY4304.cpy".
      *---------- 【SCZY4405】取引属性情報メモリ格納処理
       01  PARM-SCZY4405-INOUT.
           COPY  "SCZY4405.cpy".
      *---------- 【SCZY4501】為替換算情報メモリ格納処理
       01  PARM-SCZY4501-INOUT.
           COPY  "SCZY4501.cpy".
      *---------- 【SCZY4502】為替換算情報取得処理
       01  PARM-SCZY4502-INOUT.
           COPY  "SCZY4502.cpy".
      *---------- 【SCZY4407】料率情報メモリ格納処理
       01  PARM-SCZY4407-INOUT.
           COPY  "SCZY4407.cpy".
      *---------- 【SCZY1130】利用権限チェックルーチン
       01  PARM-SCZY1130-INOUT.
           COPY  "SCZY1130.cpy".
      *---------- 【SCZY7110】バッチ用監査ログＩＮＳルーチン
       01  PARM-SCZY7110-INOUT.
           COPY  "SCZY7110.cpy".
      *---------- 【SMZCGP01】取引差分更新処理再読込処理
       01  PARM-SMZCGP01-INOUT.
           COPY  "SMZCGP01.cpy".
       01  PARM-RTNPKG.
         05  PARM-RTNPKG-ARG.
           COPY  "CZRTNPACKAGE.cpy".
      ******************************************************************
      *        連絡節
      ******************************************************************
       LINKAGE                SECTION.
      ******************************************************************
      *
      *        手 続 き 部
      *
      ******************************************************************
       PROCEDURE              DIVISION.
      ******************************************************************
      *    残高・損益更新メイン
      ******************************************************************
       BASE-RTN               SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":****  MMZJ4010  START  ****"
      *-----------------------------------------------------------------
      *---------- 3.1 前処理
           PERFORM  INIT-RTN
      *---------- 3.2 主処理
           PERFORM  MAIN-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD  NOT = CNS-RTN-BT16
           THEN
      *---------- 3.3 後処理
             PERFORM  END-RTN
           ELSE
      *---------- 3.4 エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":****  MMZJ4010  END  ****"
      *-----------------------------------------------------------------
           CONTINUE.
       BASE-EXT.
           EXIT.
      ******************************************************************
      *    3.1.前処理
      ******************************************************************
       INIT-RTN               SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  前処理  START  ***"
      *-----------------------------------------------------------------
      *---------- 3.1.1.ワークエリアの初期化
           PERFORM  INITIALIZE-RTN
      *---------- 3.1.2.開始メッセージ出力
           PERFORM  PUT-BIGN-MSG-RTN
      *---------- 3.1.3.引数取得処理
           PERFORM  ARG-GET-RTN
      *---------- 3.1.4.DB接続情報取得
           PERFORM  GET-DB-VAR-RTN
      *---------- 3.1.5.DB接続
           PERFORM  CONNECT-DB-RTN
      *---------- 3.1.6.入力電文取得処理
           PERFORM  IN-DENBUN-GET-RTN
      *---------- 3.1.7.入力電文分析
           PERFORM  IN-DENBUN-KAISK-RTN
      *---------- 3.1.8.通貨情報取得
           PERFORM  TUKA-GET-RTN
      *---------- 3.1.9.テーブルID取得
           PERFORM  TBLID-GET-RTN
      *---------- 3.1.9 商品属性テーブルから
           PERFORM  TKCMSZ00-GET-RTN
      *---------- 3.1.10 ワーク取引属性取得
           PERFORM  WK-TKCMTZ00-GET-RTN
      *---------- 3.1.11 ワーク異動計算パターンデータエリア取得
           PERFORM  WK-TKPFPT01-GET-RTN
      *---------- 3.1.12 ワーク為替換算情報データエリア取得
           PERFORM  WK-TKJCKK00-GET-RTN
      *---------- 3.1.12 ワーク料率データエリア取得
           PERFORM  WK-TKCMRY00-GET-RTN
      *---------- 3.1.13.テーブルID取得処理
           PERFORM  TBLID2-GET-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  前処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       INIT-EXT.
           EXIT.
      ******************************************************************
      *    3.1.1.ワークエリアの初期化
      ******************************************************************
       INITIALIZE-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ワークエリアの初期化  START  ***"
      *-----------------------------------------------------------------
      *---------- ワークエリアの初期化
           INITIALIZE     FLG-AREA
                          WORK-AREA
                          WK-DENBUN-INFO
                          HOST-AREA
                          SQL-AREA
                          E-MSG-TBL
                          PARM-SCZY7090-INOUT
                          PARM-SCZY7010-INOUT
                          PARM-SCZY7100-INOUT
                          PARM-SCZY7050-INOUT
                          PARM-SCZY7060-INOUT
                          AIFA-HDR
                          USER-ATTR-HDR
                          SMZJ4091-ARG-IN
                          SMZJ4091-ARG-OUT
                          PARM-SMZJ0101-INOUT
                          PARM-SCZY7210-INOUT
                          PARM-SMZJ1210-INOUT
                          PARM-SCZY7020-INOUT
                          PARM-SCZY1160-INOUT
                          PARM-SCZY1170-IN
                          PARM-SCZY1170-RTNPKG
                          PARM-SCZY1190-INOUT
                          PARM-SCZY1210-INOUT
                          PARM-SMZJ1510-INOUT
                          PARM-SMZJ1711-INOUT
                          PARM-SMZJ1712-INOUT
                          PARM-SMZJ1610-INOUT
                          PARM-SMZJ1710-INOUT
                          PARM-SMZJ1810-INOUT
                          PARM-SMZJ1820-INOUT
                          PARM-SMZJ1910-INOUT
                          PARM-SMZJ1922-INOUT
                          PARM-SMZJ1920-INOUT
                          PARM-SMZJ2110-INOUT
                          PARM-SMZJ4021-INOUT
                          PARM-SMZJ2120-INOUT
                          PARM-SMZJ2130-INOUT
                          PARM-SMZJ2140-INOUT
                          PARM-SMZJ2150-INOUT
                          PARM-SMZJ2210-INOUT
                          PARM-SMZJ2211-INOUT
                          PARM-SCZY4023-INOUT
                          PARM-SCZY4103-INOUT
                          PARM-SCZY7200-INOUT
                          PARM-SCZY7040-INOUT
                          PARM-SMZJ2610-INOUT
                          PARM-SMZJ2310-INOUT
                          PARM-SCZY3002-INOUT
                          PARM-SCZY3031-INOUT
                          PARM-SMZJ4022-INOUT
                          PARM-SMZJ4023-INOUT
                          PARM-SMZJ4011-INOUT
                          PARM-SMZJ4012-INOUT
                          PARM-SMZJ4019-INOUT
                          PARM-SMZJ4014-INOUT
                          PARM-SMZJ4016-INOUT
                          PARM-SCZY7080-INOUT
                          PARM-SCZY1020-INOUT
                          PARM-SCZY4313-INOUT
                          PARM-SCZY4303-INOUT
                          PARM-SCZY4304-INOUT
                          PARM-SCZY4405-INOUT
                          PARM-SCZY4501-INOUT
                          PARM-SCZY4502-INOUT
                          PARM-SCZY4407-INOUT
                          PARM-SCZY1160-INOUT
                          PARM-SCZY1130-INOUT
                          PARM-SCZY7110-INOUT
                          PARM-RTNPKG
      *---------- ワークDB接続フラグ ← '0'(接続して無い)
           MOVE  CNS-DB-CONNECT-FLG-0   TO  WK-DB-SETUZOKU-FLG
      *---------- ワークリターンコード ← 0 正常
           MOVE  CNS-RTN-BT0            TO  WK-RETURN-CD
      *---------- ワークCounterA ← 1
           MOVE  CNS-1                  TO  WK-CounterA
      *--------------------<DEBUG>--------------------------------------
      *    DISPLAY  CNS-PGM-ID":WORK-AREA =["WORK-AREA"]"
      D    DISPLAY  CNS-PGM-ID":ワークDB接続フラグ =["
      D             WK-DB-SETUZOKU-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      D    DISPLAY  CNS-PGM-ID":***  ワークエリアの初期化  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       INITIALIZE-EXT.
           EXIT.
      ******************************************************************
      *    3.1.2.開始メッセージ出力処理
      ******************************************************************
       PUT-BIGN-MSG-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  開始メッセージ出力処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7010-INOUT
      *---------- プログラムID
           MOVE  CNS-PGM-ID
             TO  PGM-ID                 OF  PARM-SCZY7010-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":プログラムID =["
      D             PGM-ID              OF  PARM-SCZY7010-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7010"             USING  PARM-SCZY7010-INOUT
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  開始メッセージ出力処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PUT-BIGN-MSG-EXT.
           EXIT.
      ******************************************************************
      *    3.1.3.引数取得処理
      ******************************************************************
       ARG-GET-RTN            SECTION.
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":*****   引数取得処理  START   *****"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7090-INOUT
                       PARM-RTNPKG
      *---------- 引数個数
           MOVE  CNS-5
             TO  ARG-NUM                OF  PARM-SCZY7090-ARG1
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":引数個数=["
      D             ARG-NUM             OF  PARM-SCZY7090-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7090"             USING  PARM-SCZY7090-INOUT
                                               PARM-RTNPKG
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7090)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク引数情報.利用会社コード
             MOVE  ARG-STRING           OF  PARM-SCZY7090-ARG2(CNS-1)
               TO  WK-RIYO-CMP-CD       OF  WK-ARG-INFO
      *---------- ワーク引数情報.処理実行日
             MOVE  ARG-STRING           OF  PARM-SCZY7090-ARG2(CNS-2)
               TO  WK-SYORI-YMD         OF  WK-ARG-INFO
      *---------- ワーク引数情報.起動ID
             MOVE  ARG-STRING           OF  PARM-SCZY7090-ARG2(CNS-3)
               TO  WK-KIDOU-ID          OF  WK-ARG-INFO
      *---------- ワーク引数情報.業務タスクID
             MOVE  ARG-STRING           OF  PARM-SCZY7090-ARG2(CNS-4)
               TO  WK-GYOMU-TASK-ID     OF  WK-ARG-INFO
      *---------- ワーク引数情報.ＧＩＰＳモード
             MOVE  ARG-STRING           OF  PARM-SCZY7090-ARG2(CNS-5)
               TO  WK-GIPS-MODE         OF  WK-ARG-INFO
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.利用会社コード =["
      D             WK-RIYO-CMP-CD      OF  WK-ARG-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.処理実行日 =["
      D             WK-SYORI-YMD        OF  WK-ARG-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.起動ID =["
      D             WK-KIDOU-ID         OF  WK-ARG-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.業務タスクID =["
      D             WK-GYOMU-TASK-ID    OF  WK-ARG-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.ＧＩＰＳモード =["
      D             WK-GIPS-MODE        OF  WK-ARG-INFO"]"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":引数取得 処理 エラー"
      *-----------------------------------------------------------------
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-001          TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*****  引数取得 処理  END  *****"
      *-----------------------------------------------------------------
           CONTINUE.
       ARG-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.1.4.DB接続情報取得
      ******************************************************************
       GET-DB-VAR-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  DB接続情報取得 処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7100-INOUT
                       PARM-RTNPKG
      *---------- ワーク引数情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7100-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY7100-ARG1 "]"
      *-----------------------------------------------------------------
           CALL  "SCZY7100"             USING  PARM-SCZY7100-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7100)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- DB接続情報
             MOVE  DB-SETUZOKU-JYOUHOU  OF  PARM-SCZY7100-ARG2
               TO  WK-DB-SETUZOKU-INFO  OF  WK-DB-SETUZOKU-JYOUHOU
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":DB接続情報取得 正常"
      D    DISPLAY  CNS-PGM-ID":DB接続情報 =["
      D             WK-DB-SETUZOKU-INFO OF  WK-DB-SETUZOKU-JYOUHOU"]"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":DB接続情報取得 エラー"
      *-----------------------------------------------------------------
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-002          TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  DB接続情報取得 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       GET-DB-VAR-EXT.
           EXIT.
      ******************************************************************
      *    3.1.5.DB接続
      ******************************************************************
       CONNECT-DB-RTN         SECTION.
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":*****   DB接続 処理  START   *****"
      *-----------------------------------------------------------------
      *---------- DB接続
           EXEC SQL
             CONNECT :WK-DB-SETUZOKU-JYOUHOU.WK-DB-SETUZOKU-INFO
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(DB接続)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODE＝0(正常)の場合
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-DB-CONNECT-FLG-1
               TO  WK-DB-SETUZOKU-FLG   OF  WK-DB-SETUZOKU-JYOUHOU
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークDB接続情報.DB接続フラグ =["
      D             WK-DB-SETUZOKU-FLG  OF  WK-DB-SETUZOKU-JYOUHOU"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":DB接続エラー"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
             MOVE  CNS-POS-003          TO  WK-ERR-POS
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
             MOVE  CNS-CONNECT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":*****   DB接続 処理 END   *****"
      *-----------------------------------------------------------------
           CONTINUE.
       CONNECT-DB-EXT.
           EXIT.
      ******************************************************************
      *    3.1.6.入力電文取得処理
      ******************************************************************
       IN-DENBUN-GET-RTN      SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  入力電文取得処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7060-INOUT
                       PARM-RTNPKG
      *---------- ワーク引数情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7060-ARG1
      *---------- ワーク引数情報.処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7060-ARG1
      *---------- ワーク引数情報.起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7060-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  PARM-SCZY7060-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  PARM-SCZY7060-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  PARM-SCZY7060-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7060"             USING  PARM-SCZY7060-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7060)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- 起動ログインユーザ会社コード
             MOVE  KIDOU-LOGIN-CMP-CD   OF  PARM-SCZY7060-ARG2
               TO  WK-LOGIN-CMP-CD
      *---------- 起動ユーザーID
             MOVE  KIDOU-SID            OF  PARM-SCZY7060-ARG2
               TO  WK-KIDOU-SID
      *---------- 起動業務グループコード
             MOVE  KIDOU-GYOMU-GRP-CD   OF  PARM-SCZY7060-ARG2
               TO  WK-GYOMU-GRP-CD
      *---------- ワーク電文情報 ←  ARG3.電文情報
             MOVE  DENBUN-INFO          OF  PARM-SCZY7060-ARG3
               TO  WK-DENBUN-INFO
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":電文情報取得処理  正常"
      D    DISPLAY  CNS-PGM-ID":WK-AIFA-IN  =["WK-AIFA-IN"]"
      D    DISPLAY  CNS-PGM-ID":WK-HEADER-IN=["WK-HEADER-IN"]"
      D    DISPLAY  CNS-PGM-ID":WK-DENBUN-IN=["WK-DENBUN-IN"]"
      D    DISPLAY  CNS-PGM-ID":起動ログインユーザ会社コード =["
      D             WK-LOGIN-CMP-CD"]"
      D    DISPLAY  CNS-PGM-ID":起動ユーザーID =["WK-KIDOU-SID"]"
      D    DISPLAY  CNS-PGM-ID":起動業務グループコード =["
      D             WK-GYOMU-GRP-CD"]"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":入力電文取得処理  エラー"
      *-----------------------------------------------------------------
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-004          TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.ＧＩＰＳモード=["
      D             WK-GIPS-MODE        OF  WK-ARG-INFO"]"
      *-----------------------------------------------------------------
           IF  WK-GIPS-MODE             OF  WK-ARG-INFO  NOT = CNS-X-1
           THEN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":GIPSモード以外場合:"
      *-----------------------------------------------------------------
      *---------- 【SMZJ4091】Ｏ３Ｗ定義自動チェックルーチンをコールして
             PERFORM  SMZJ4091-RTN
      *---------- 【SMZJ0101】残高・損益更新処理起動単体チェックルーチンをコールして
             PERFORM  SMZJ0101-RTN
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":GIPSモードの場合:"
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.強制区分=["
      D             I-KYOSE-CALC-KBN    OF  WK-DENBUN-INFO"]"
      *-----------------------------------------------------------------
      *---------- ワーク電文情報.強制区分 ← '1'：強制計算する
             MOVE  CNS-X-1
               TO  I-KYOSE-CALC-KBN     OF  WK-DENBUN-INFO
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.強制区分=["
      D             I-KYOSE-CALC-KBN    OF  WK-DENBUN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.勘定異動／残高作成=["
      D             I-KJIDO-ZANSK       OF  WK-DENBUN-INFO"]"
      *-----------------------------------------------------------------
      *---------- 勘定異動／残高作成チェック
             IF  I-KJIDO-ZANSK          OF  WK-DENBUN-INFO = CNS-X-2
               OR  I-KJIDO-ZANSK        OF  WK-DENBUN-INFO = CNS-X-1
             THEN
               CONTINUE
             ELSE
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← 'E000130'（$項目名$の入力値が不正です。）
               MOVE  CNS-MSG-E000130
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '勘定異動／残高作成'
               MOVE  CNS-TK-MOJI-80
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ← ' '
               MOVE  SPACE
                 TO  WK-FUND-CD         OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ← ' '
               MOVE  SPACE
                 TO  WK-PTF-CD          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク引数情報.処理実行日
               MOVE  WK-SYORI-YMD       OF  WK-ARG-INFO
                 TO  WK-KJN-YMD-FROM    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク引数情報.処理実行日
               MOVE  WK-SYORI-YMD       OF  WK-ARG-INFO
                 TO  WK-KJN-YMD-TO      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
               MOVE  SPACE
                 TO  WK-FREE-MSG        OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
               COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-CounterA + 1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード←'8'(業務エラー（処理中メイン続行不可）)
               MOVE  CNS-RTN-BT8      TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               PERFORM  END-RTN
             END-IF
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  入力電文取得処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       IN-DENBUN-GET-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ4091】Ｏ３Ｗ定義自動チェックルーチンをコールして
      ******************************************************************
       SMZJ4091-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4091】Ｏ３Ｗ定義自動"
      D                       "チェックルーチンをコールして  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  AIFA-HDR
                       USER-ATTR-HDR
                       SMZJ4091-ARG-IN
                       SMZJ4091-ARG-OUT
                       PARM-RTNPKG
      *---------- 電文情報
           MOVE  WK-DENBUN-IN           OF  WK-DENBUN-INFO
             TO  SMZJ4091-ARG-IN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":電文情報  =["SMZJ4091-ARG-IN"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4091"             USING  AIFA-HDR
                                               USER-ATTR-HDR
                                               SMZJ4091-ARG-IN
                                               SMZJ4091-ARG-OUT
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4091) OF SMZJ4091-ARG1-OUT=["
      D                                 RTN-CD  OF  SMZJ4091-ARG1-OUT"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD  OF  SMZJ4091-ARG1-OUT
             WHEN  CNS-RTN-0
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":Ｏ３Ｗ定義自動チェックルーチン  正常"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  CNS-RTN-9
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":入力電文取得処理  エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-005        TO  WK-ERR-POS
               PERFORM  ERR4091-MSG-RTN
             WHEN  OTHER
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M01のメッセージID
               MOVE  CNS-MSG-E000369
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '残高・損益更新画面'
               MOVE  CNS-TK-MOJI-58
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M01-FREE-AREA-RTN
      *---------- ワークリターンコード←'8'(業務エラー（処理中メイン続行不可）)
               MOVE  CNS-RTN-BT8        TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 「3.3  後処理」へ
               PERFORM  END-RTN
           END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4091】Ｏ３Ｗ定義自動"
      D                       "チェックルーチンをコールして  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4091-EXT.
           EXIT.
      ******************************************************************
      *    @ ワークメッセージエリアへインサート
      ******************************************************************
       M01-FREE-AREA-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ← ' '
           MOVE  SPACE
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ← ' '
           MOVE  SPACE
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク電文情報.基準日FRM
           MOVE  I-KYJ-YMD-FROM         OF  WK-DENBUN-INFO
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文情報.基準日TO
           MOVE  I-KYJ-YMD-TO           OF  WK-DENBUN-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-CounterA + 1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
           CONTINUE.
       M01-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ0101】残高・損益更新処理起動単体チェックルーチンをコールして
      ******************************************************************
       SMZJ0101-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ0101】残高・損益更新処理"
      D               "起動単体チェックルーチンをコールして  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ0101-INOUT
                       PARM-RTNPKG
      *---------- SPP/バッチ起動区分
           MOVE  CNS-KIDOU-KBN-B
             TO  KIDOU-KBN              OF  PARM-SMZJ0101-ARG1
      *---------- 上り電文
           MOVE  WK-DENBUN-IN           OF  WK-DENBUN-INFO
             TO  PARM-SMZJ0101-ARG2
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SPP/バッチ起動区分  =["
      D                             KIDOU-KBN  OF  PARM-SMZJ0101-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":上り電文  =["PARM-SMZJ0101-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ0101"             USING  PARM-SMZJ0101-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ0101)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  残高・損益更新処理起動単体"
      D                                     "チェックルーチン  正常 ***"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  CNS-RTN-800
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":【SMZJ0101】.ARG6.メッセージエリア（"
      D                                  WK-CounterA"）.メッセージID =["
      D                   MSG-ID  OF  PARM-SMZJ0101-ARG6(WK-CounterA)"]"
      *-----------------------------------------------------------------
               PERFORM
               UNTIL MSG-ID  OF  PARM-SMZJ0101-ARG6(WK-CounterA) = SPACE
      *---------- ワークメッセージエリア（ワークCounterA)←
      *---------- 【SMZJ0101】.ARG6.メッセージエリア（ワークCounterA)
                 MOVE  MESSAGE-AREA  OF  PARM-SMZJ0101-ARG6(WK-CounterA)
                   TO  WK-MESSAGE-AREA  OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークメッセージエリア（"WK-CounterA")"
      D           " =["WK-MESSAGE-AREA  OF  WK-MSG-AREA(WK-CounterA)"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
                 COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-CounterA + 1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
               END-PERFORM
      *---------- ワークリターンコード← '8'(業務エラー（処理中メイン続行不可）)
               MOVE  CNS-RTN-BT8      TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 「3.3  後処理」へ
               PERFORM  END-RTN
             WHEN  OTHER
               CONTINUE
           END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ0101】残高・損益更新処理"
      D               "起動単体チェックルーチンをコールして  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ0101-EXT.
           EXIT.
      ******************************************************************
      *    3.1.7.入力電文分析
      ******************************************************************
       IN-DENBUN-KAISK-RTN    SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  入力電文分析 処理  START  ***"
      *-----------------------------------------------------------------
      *---------- 指定From日
           MOVE  I-KYJ-YMD-FROM         OF  WK-DENBUN-INFO
             TO  WK-SITEI-FROM          OF  WK-DENBUN-KAISEKI-INFO
      *---------- 指定To日
           MOVE  I-KYJ-YMD-TO           OF  WK-DENBUN-INFO
             TO  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
      *---------- 強制計算区分
           MOVE  I-KYOSE-CALC-KBN       OF  WK-DENBUN-INFO
             TO  WK-KYOSE-CALC-KBN      OF  WK-DENBUN-KAISEKI-INFO
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":指定From日=["
      D             WK-SITEI-FROM       OF  WK-DENBUN-KAISEKI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":指定To日  =["
      D             WK-SITEI-TO         OF  WK-DENBUN-KAISEKI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":強制計算区分 =["
      D             WK-KYOSE-CALC-KBN   OF  WK-DENBUN-KAISEKI-INFO"]"
      *-----------------------------------------------------------------
      *---------- オール指定
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.ポートフォリオ個別指定=["
      D             I-PTF-SYORI-KBN     OF  WK-DENBUN-INFO"]"
      *-----------------------------------------------------------------
           IF  I-PTF-SYORI-KBN          OF  WK-DENBUN-INFO
            =  CNS-PF-FLG-2
           THEN
             MOVE  CNS-ALL-1
               TO  WK-ALL               OF  WK-DENBUN-KAISEKI-INFO
           ELSE
             MOVE  CNS-ALL-2
               TO  WK-ALL               OF  WK-DENBUN-KAISEKI-INFO
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":オール指定   =["
      D             WK-ALL              OF  WK-DENBUN-KAISEKI-INFO"]"
      *-----------------------------------------------------------------
      *---------- ポートフォリオ選択リスト
           INITIALIZE  WK-IDX0
           PERFORM  UNTIL  WK-IDX0 = CNS-10
             COMPUTE  WK-IDX0 = WK-IDX0 + CNS-1
      *---------- ポートフォリオ区分
             MOVE  I-FUND-PTF-KBN    OF  WK-DENBUN-INFO(WK-IDX0)
               TO  WK-PTF-KBN        OF  WK-DENBUN-KAISEKI-INFO(WK-IDX0)
      *---------- グループ又はファンドコード
             MOVE  I-FUND-CD         OF  WK-DENBUN-INFO(WK-IDX0)
               TO  WK-GRP-FUND-CD    OF  WK-DENBUN-KAISEKI-INFO(WK-IDX0)
      *----------  ポートフォリオコード
             MOVE  I-PTF-CD          OF  WK-DENBUN-INFO(WK-IDX0)
               TO  WK-PTF-CD         OF  WK-DENBUN-KAISEKI-INFO(WK-IDX0)
           END-PERFORM
      *--------------------<DEBUG>--------------------------------------
      D    INITIALIZE  WK-IDX0
      D    PERFORM  UNTIL  WK-IDX0 = CNS-10
      D      COMPUTE  WK-IDX0 = WK-IDX0 + CNS-1
      D    DISPLAY  CNS-PGM-ID":ポートフォリオ区分("WK-IDX0")  =["
      D             WK-PTF-KBN     OF WK-DENBUN-KAISEKI-INFO(WK-IDX0)"]"
      D    DISPLAY  CNS-PGM-ID":グループ又はファンドコード("WK-IDX0")=["
      D             WK-GRP-FUND-CD OF WK-DENBUN-KAISEKI-INFO(WK-IDX0)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード("WK-IDX0")=["
      D             WK-PTF-CD      OF WK-DENBUN-KAISEKI-INFO(WK-IDX0)"]"
      D    END-PERFORM
      D    DISPLAY  CNS-PGM-ID":***  入力電文分析 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       IN-DENBUN-KAISK-EXT.
           EXIT.
      ******************************************************************
      *    3.1.8.通貨情報取得
      ******************************************************************
       TUKA-GET-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  通貨情報取得 処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4103-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY4103-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  PARM-SCZY4103-ARG1 "]"
      *-----------------------------------------------------------------
           CALL  "SCZY4103"             USING  PARM-SCZY4103-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4103)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク通貨情報件数 ← リターンパッケージ.取得件数
             MOVE  SYTK-KENSU           OF  PARM-SCZY4103-ARG2
               TO  WK-TUKA-INFO-KENSUU
      *---------- ワーク通貨情報 ← リターンパッケージ.通貨エリア
             INITIALIZE  WK-INDEX
             PERFORM  UNTIL  WK-INDEX = CNS-500
               COMPUTE  WK-INDEX = WK-INDEX + CNS-1
      *---------- 通貨コード
               MOVE  TUKA-CD            OF  PARM-SCZY4103-ARG2(WK-INDEX)
                 TO  WK-TUKA-CD         OF  WK-TUKA-INFO(WK-INDEX)
      *---------- 小数点以下桁数
               MOVE  SYOSU-TENYIKA-KETASU
                                        OF  PARM-SCZY4103-ARG2(WK-INDEX)
                 TO  WK-ST-KETASU       OF  WK-TUKA-INFO(WK-INDEX)
      *---------- 端数処理
               MOVE  HASU-KBN           OF  PARM-SCZY4103-ARG2(WK-INDEX)
                 TO  WK-HASU            OF  WK-TUKA-INFO(WK-INDEX)
             END-PERFORM
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":通貨情報取得  エラー"
      *-----------------------------------------------------------------
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-006          TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク通貨情報件数 =["
      D             WK-TUKA-INFO-KENSUU"]"
      D    INITIALIZE  WK-INDEX
      D    PERFORM  UNTIL  WK-INDEX = CNS-500
      D      COMPUTE  WK-INDEX = WK-INDEX + CNS-1
      D    DISPLAY  CNS-PGM-ID":通貨コード("WK-INDEX")  =["
      D             WK-TUKA-CD          OF  WK-TUKA-INFO(WK-INDEX)"]"
      D    DISPLAY  CNS-PGM-ID":小数点以下桁数("WK-INDEX")  =["
      D             WK-ST-KETASU        OF  WK-TUKA-INFO(WK-INDEX)"]"
      D    DISPLAY  CNS-PGM-ID":端数処理("WK-INDEX") =["
      D             WK-HASU             OF  WK-TUKA-INFO(WK-INDEX)"]"
      D    END-PERFORM
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  通貨情報取得 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TUKA-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.1.9 テーブルID取得
      ******************************************************************
       TBLID-GET-RTN          SECTION.
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  テーブルID取得処理  START  ****"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1160-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY1160-ARG1
      *---------- 取引差分更新管理（TKMZSK00）
           MOVE  CNS-TBL-TKMZSK00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(1)
      *---------- 基準日断面情報（TKMZBW02）
           MOVE  CNS-TBL-TKMZBW02
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(2)
      *---------- 銘柄別断面情報（TKMZBW03）
           MOVE  CNS-TBL-TKMZBW03
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(3)
      *---------- 対象取引情報（TKMZBW04）
           MOVE  CNS-TBL-TKMZBW04
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(4)
      *---------- 対象資金取引情報（TKMZBW05）
           MOVE  CNS-TBL-TKMZBW05
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(5)
      *---------- 実行状況管理明細（TKDYAA35）
           MOVE  CNS-TBL-TKDYAA35
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(6)
      *---------- 取引（TKMXTR00）
           MOVE  CNS-TBL-TKMXTR00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(7)
      *---------- 相対取引（TKMXTR01）
           MOVE  CNS-TBL-TKMXTR01
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(8)
      *---------- 処理資金取引（TKMZBW18）
           MOVE  CNS-TBL-TKMZBW18
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(9)
      *---------- 残高異動計算データ（TKMZBW06）
           MOVE  CNS-TBL-TKMZBW06
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(10)
      *---------- 残高異動（TKMZZI00）
           MOVE  CNS-TBL-TKMZZI00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(11)
      *---------- 残高履歴（TKMZZR00）
           MOVE  CNS-TBL-TKMZZR00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(12)
      *---------- 商品属性（TKCMSZ00）
           MOVE  CNS-TBL-TKCMSZ00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(13)
      *---------- 資金残履歴（TKMZSR00）
           MOVE  CNS-TBL-TKMZSR00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(14)
      *---------- 資金取引（TKMXST00）
           MOVE  CNS-TBL-TKMXST00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(15)
      *---------- 未収収益（TKMZMS00）
           MOVE  CNS-TBL-TKMZMS00
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(16)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY1160-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(1)"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(2)"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(3)"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(4)"]"
      D    DISPLAY  CNS-PGM-ID":対象資金取引情報テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(5)"]"
      D    DISPLAY  CNS-PGM-ID":実行状況管理明細テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(6)"]"
      D    DISPLAY  CNS-PGM-ID":取引テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(7)"]"
      D    DISPLAY  CNS-PGM-ID":相対取引テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(8)"]"
      D    DISPLAY  CNS-PGM-ID":処理資金取引テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(9)"]"
      D    DISPLAY  CNS-PGM-ID":残高異動計算データ=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(10)"]"
      D    DISPLAY  CNS-PGM-ID":残高異動テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(11)"]"
      D    DISPLAY  CNS-PGM-ID":残高履歴テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(12)"]"
      D    DISPLAY  CNS-PGM-ID":商品属性 =["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(13)"]"
      D    DISPLAY  CNS-PGM-ID":資金残履歴 =["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(14)"]"
      D    DISPLAY  CNS-PGM-ID":資金取引 =["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(15)"]"
      D    DISPLAY  CNS-PGM-ID":未収収益 =["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(16)"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1160"             USING  PARM-SCZY1160-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1160)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワークテーブル取引差分更新管理
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(1)
               TO  WK-TBL-TKMZSK00
      *---------- ワークテーブル基準日断面情報
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(2)
               TO  WK-TBL-TKMZBW02
      *---------- ワークテーブル銘柄別断面情報
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(3)
               TO  WK-TBL-TKMZBW03
      *---------- ワークテーブル対象取引情報
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(4)
               TO  WK-TBL-TKMZBW04
      *---------- ワークテーブル対象資金取引情報
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(5)
               TO  WK-TBL-TKMZBW05
      *---------- ワークテーブル実行状況管理明細
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(6)
               TO  WK-TBL-TKDYAA35
      *---------- ワークテーブル取引
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(7)
               TO  WK-TBL-TKMXTR00
      *---------- ワークテーブル相対取引
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(8)
               TO  WK-TBL-TKMXTR01
      *---------- ワークテーブル処理資金取引
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(9)
               TO  WK-TBL-TKMZBW18
      *---------- ワークテーブル残高異動計算データ（TKMZBW06）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(10)
               TO  WK-TBL-TKMZBW06
      *---------- ワーク残高異動（TKMZZI00）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(11)
               TO  WK-TBL-TKMZZI00
      *---------- ワーク残高履歴（TKMZZR00）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(12)
               TO  WK-TBL-TKMZZR00
      *---------- ワーク商品属性（TKCMSZ00）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(13)
               TO  WK-TBL-TKCMSZ00
      *---------- ワーク資金残履歴（TKMZSR00）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(14)
               TO  WK-TBL-TKMZSR00
      *---------- ワーク資金取引（TKMXST00）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(15)
               TO  WK-TBL-TKMXST00
      *---------- ワーク未収収益（TKMZMS00）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(16)
               TO  WK-TBL-TKMZMS00
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークテーブル取引差分更新管理 =["
      D             WK-TBL-TKMZSK00"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル基準日断面情報 =["
      D             WK-TBL-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル銘柄別断面情報 =["
      D             WK-TBL-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル対象取引情報 =["
      D             WK-TBL-TKMZBW04"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル対象資金取引情報 =["
      D             WK-TBL-TKMZBW05"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル実行状況管理明細 =["
      D             WK-TBL-TKDYAA35"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル取引 =["
      D             WK-TBL-TKMXTR00"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル相対取引 =["
      D             WK-TBL-TKMXTR01"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル処理資金取引 =["
      D             WK-TBL-TKMZBW18"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル残高異動計算データ =["
      D             WK-TBL-TKMZBW06"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル残高異動 =["
      D             WK-TBL-TKMZZI00"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル残高履歴 =["
      D             WK-TBL-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル商品属性 =["
      D             WK-TBL-TKCMSZ00"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル資金残履歴 =["
      D             WK-TBL-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル資金取引 =["
      D             WK-TBL-TKMXST00"]"
      D    DISPLAY  CNS-PGM-ID":ワークテーブル未収収益 =["
      D             WK-TBL-TKMZMS00"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":テーブルID取得エラー"
      *-----------------------------------------------------------------
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-007          TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  テーブルID取得処理  END  ****"
      *-----------------------------------------------------------------
           CONTINUE.
       TBLID-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.1.9 商品属性テーブルから
      ******************************************************************
       TKCMSZ00-GET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 管理数量単位を取得 処理 START  ***"
      *-----------------------------------------------------------------
      *----------  カーソル定義処理
           PERFORM  TKCMSZ00-DEC-RTN
      *----------  カーソルオープン処理
           PERFORM  TKCMSZ00-OPEN-RTN
      *----------  カーソルFETCH 処理
           MOVE  CNS-OFF                TO  FLG-FETCH-TKCMSZ00
           MOVE  ZERO                   TO  WK-KENSU
           PERFORM  TKCMSZ00-FET-RTN
             UNTIL  WK-KENSU = CNS-200  OR  FLG-FETCH-TKCMSZ00 = CNS-ON
      *----------  カーソルCLOSE 処理
           PERFORM  TKCMSZ00-CLOSE-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 管理数量単位を取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       TKCMSZ00-GET-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKCMSZ00-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 利用会社コード
           MOVE  CNS-X-4999
             TO  H-RIYO-CMP-CD          OF  H-TKCMSZ00,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-16
      *---------- テーブルID
           MOVE  WK-TBL-TKCMSZ00
             TO  SQL-TKCMSZ00           OF  SQL-SELECT-1-16,
                 WK-TKCMSZ00-S          OF  WK-MSG-1-16
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKCMSZ00"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-16        TO  SQLSTMT
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT=["SQLSTMT"]"
      *-----------------------------------------------------------------
           EXEC  SQL
               PREPARE  S16  FROM :SQLSTMT
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-008          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-16        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
           EXEC  SQL  DECLARE  TKCMSZ00_CURSOR  CURSOR  FOR S16 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKCMSZ00-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKCMSZ00-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKCMSZ00_CURSOR
                 USING :H-TKCMSZ00.H-RIYO-CMP-CD
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKCMSZ00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKCMSZ00-CR-OPEN=["
      D             FLG-TKCMSZ00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-009          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-16        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKCMSZ00-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    商品属性 FETCH 処理
      ******************************************************************
       TKCMSZ00-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 商品属性 FETCH 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKCMSZ00-S
           EXEC  SQL
               FETCH
                    TKCMSZ00_CURSOR
               INTO :H-TKCMSZ00-S.H-SEC-SBT-CD,
                    :H-TKCMSZ00-S.H-KANRI-SURYO-TANI
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
      *---------- ワーク商品属性抽出件数
               COMPUTE  WK-KENSU
                     =  WK-KENSU + CNS-1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク商品属性抽出件数=["WK-KENSU"]"
      *-----------------------------------------------------------------
               IF  WK-KENSU  <=  CNS-200
               THEN
      *---------- ワーク商品属性.証券種別コード
                 MOVE  H-SEC-SBT-CD       OF  H-TKCMSZ00-S
                   TO  SEC-SBT-CD         OF  WK-TKCMSZ00(WK-KENSU)
      *---------- ワーク商品属性.管理数量単位
                 MOVE  H-KANRI-SURYO-TANI OF H-TKCMSZ00-S
                   TO  KANRI-SURYO-TANI   OF  WK-TKCMSZ00(WK-KENSU)
               ELSE
      *---------- ワークリターンコード
                 MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポジション
                 MOVE  CNS-POS-010        TO  WK-ERR-POS
      *---------- エラー検知プログラムID
                 MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- リターンコード
                 MOVE  CNS-RTN-002        TO  WK-RTN-CD
      *---------- 詳細リターンコード
                 MOVE  ZERO               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
                 MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
                 STRING  CNS-SQL-MSG-SELECT,
                         WK-MSG-1-16        DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
                 PERFORM  ERR-RTN
               END-IF
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク商品属性.証券種別コード=["
      D             SEC-SBT-CD            OF  WK-TKCMSZ00(WK-KENSU)"]"
      D    DISPLAY  CNS-PGM-ID":ワーク商品属性.管理数量単位  =["
      D             KANRI-SURYO-TANI      OF  WK-TKCMSZ00(WK-KENSU)"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
               MOVE  CNS-ON               TO  FLG-FETCH-TKCMSZ00
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-011          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-16        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  商品属性 FETCH 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKCMSZ00-FET-EXT.
           EXIT.
      ******************************************************************
      *    商品属性 CURSOR CLOSE 処理
      ******************************************************************
       TKCMSZ00-CLOSE-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 商品属性 CURSOR CLOSE 処理 "
      D             "START ***"
      D    DISPLAY  CNS-PGM-ID":FLG-TKCMSZ00-CR-OPEN=["
      D             FLG-TKCMSZ00-CR-OPEN"]"
      *-----------------------------------------------------------------
           EXEC  SQL
               CLOSE TKCMSZ00_CURSOR
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(CLOSE) =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-OFF              TO  FLG-TKCMSZ00-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKCMSZ00-CR-OPEN=["
      D             FLG-TKCMSZ00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-012          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-16        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 商品属性 CURSOR CLOSE 処理 "
      D             "END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKCMSZ00-CLOSE-EXT.
           EXIT.
      ******************************************************************
      *    3.1.10 ワーク取引属性取得
      ******************************************************************
       WK-TKCMTZ00-GET-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** ワーク取引属性取得 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4405-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  CNS-COMP-NRI
             TO  RIYO-CMP-CD            OF  PARM-SCZY4405-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY4405-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4405"             USING  PARM-SCZY4405-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4405)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               MOVE  PARM-SCZY4405-ARG2 TO  WK-TBL-TKCMTZ00-AREA
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引属性取得  正常"
      *    DISPLAY  CNS-PGM-ID":ワーク取引属性データエリア=["
      *                         WK-TBL-TKCMTZ00-AREA"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-110
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引属性取得  データなし"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  CNS-RTN-002
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引属性取得  抽出件数超過警告"
      *-----------------------------------------------------------------
      *---------- ポジション
               MOVE  CNS-POS-013        TO  WK-ERR-POS
               PERFORM  KENSU-WAR-RTN
             WHEN  OTHER
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引属性取得  エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-014        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":有効件数 =["
      D             YUUKOU-KENSUU       OF  WK-TBL-TKCMTZ00-AREA"]"
      *-----------------------------------------------------------------
           MOVE  ZERO                   TO  WK-KENSU
           PERFORM  VARYING  WK-IDX8    FROM  CNS-1  BY  CNS-1
             UNTIL  WK-IDX8 > YUUKOU-KENSUU  OF  WK-TBL-TKCMTZ00-AREA
               COMPUTE  WK-KENSU = WK-KENSU + CNS-1
             MOVE  TRHK-JIYU-CD  OF  WK-TBL-TKCMTZ00-AREA(WK-KENSU)
               TO  TRHK-JIYU-CD  OF  WK-TKCMTZ00(WK-KENSU)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引属性("WK-KENSU") =["
      D                         WK-TKCMTZ00(WK-KENSU)"]"
      *-----------------------------------------------------------------
           END-PERFORM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** ワーク取引属性取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       WK-TKCMTZ00-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.1.11 ワーク異動計算パターンデータエリア取得
      ******************************************************************
       WK-TKPFPT01-GET-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** ワーク異動計算パターンデータエリア取得 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4303-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY4303-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY4303-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4303"             USING  PARM-SCZY4303-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4303)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               MOVE  PARM-SCZY4303-ARG2 TO  WK-TBL-TKPFPT01-AREA
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク異動計算パターンデータエリア取得  正常"
      *    DISPLAY  CNS-PGM-ID":ワーク異動計算パターンデータエリア=["
      *                         WK-TBL-TKPFPT01-AREA"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-110
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク異動計算パターンデータエリア取得  データなし"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  CNS-RTN-002
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク異動計算パターンデータエリア取得  抽出件数超過警告"
      *-----------------------------------------------------------------
      *---------- ポジション
               MOVE  CNS-POS-015        TO  WK-ERR-POS
               PERFORM  KENSU-WAR-RTN
             WHEN  OTHER
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク異動計算パターンデータエリア取得  エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-016        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** ワーク異動計算パターンデータエリア取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       WK-TKPFPT01-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.1.12 ワーク為替換算情報データエリア取得
      ******************************************************************
       WK-TKJCKK00-GET-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":*** ワーク為替換算情報データエリア取得 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4501-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY4501-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY4501-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4501"             USING  PARM-SCZY4501-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4501)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               MOVE  PARM-SCZY4501-ARG2 TO  WK-TBL-TKJCKK00-AREA
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク為替換算情報データエリア取得  正常"
      *    DISPLAY  CNS-PGM-ID":ワーク為替換算情報データエリア=["
      *                         WK-TBL-TKJCKK00-AREA"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-110
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク為替換算情報データエリア取得  データなし"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  CNS-RTN-002
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク為替換算情報データエリア取得  抽出件数超過警告"
      *-----------------------------------------------------------------
      *---------- ポジション
               MOVE  CNS-POS-135        TO  WK-ERR-POS
               PERFORM  KENSU-WAR-RTN
             WHEN  OTHER
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク為替換算情報データエリア取得  エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-136        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":*** ワーク為替換算情報データエリア取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       WK-TKJCKK00-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.1.12 ワーク料率データエリア取得
      ******************************************************************
       WK-TKCMRY00-GET-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":*** ワーク料率データエリア取得 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4407-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY4407-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY4407-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4407"             USING  PARM-SCZY4407-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4407)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               MOVE  PARM-SCZY4407-ARG2 TO  WK-TBL-TKCMRY00-AREA
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク料率データエリア取得  正常"
      *    DISPLAY  CNS-PGM-ID":ワーク料率データエリア=["
      *                         WK-TBL-TKCMRY00-AREA"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-110
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク料率データエリア取得  データなし"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  CNS-RTN-002
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワーク料率データエリア取得  抽出件数超過警告"
      *-----------------------------------------------------------------
      *---------- ポジション
               MOVE  CNS-POS-137        TO  WK-ERR-POS
               PERFORM  KENSU-WAR-RTN
             WHEN  OTHER
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク料率データエリア取得  エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-138        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":*** ワーク料率データエリア取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       WK-TKCMRY00-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.1.13.テーブルID取得処理
      ******************************************************************
       TBLID2-GET-RTN         SECTION.
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  テーブルID取得処理  START  ****"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1160-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY1160-ARG1
      *---------- 再処理要ポートフォリオ一覧（取引）
           MOVE  CNS-TBL-TKDYGP12
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(1)
      *---------- 再処理要ポートフォリオ一覧（銘柄属性）
           MOVE  CNS-TBL-TKDYGP16
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(2)
      *---------- 再処理要制御テーブル
           MOVE  CNS-TBL-TKDYGP17
             TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(3)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY1160-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":再処理要ポートフォリオ一覧（取引）=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(1)"]"
      D    DISPLAY  CNS-PGM-ID":再処理要ポートフォリオ一覧（銘柄属性)=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(2)"]"
      D    DISPLAY  CNS-PGM-ID":再処理要制御テーブル=["
      D             TBL-ID              OF  PARM-SCZY1160-ARG1(3)"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1160"             USING  PARM-SCZY1160-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1160)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワークテーブル再処理要ポートフォリオ一覧（取引）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(1)
               TO  WK-TBL-TKDYGP12
      *---------- ワークテーブル再処理要ポートフォリオ一覧（銘柄属性）
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(2)
               TO  WK-TBL-TKDYGP16
      *---------- ワークテーブル再処理要制御テーブル
             MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(3)
               TO  WK-TBL-TKDYGP17
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク再処理要ポートフォリオ一覧（取引）テーブルID =["
      D             WK-TBL-TKDYGP12"]"
      D    DISPLAY  CNS-PGM-ID
      D    ":ワーク再処理要ポートフォリオ一覧（銘柄属性）テーブルID =["
      D             WK-TBL-TKDYGP16"]"
      D    DISPLAY  CNS-PGM-ID":ワーク再処理要制御テーブルID =["
      D             WK-TBL-TKDYGP17"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":テーブルID取得エラー"
      *-----------------------------------------------------------------
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-139          TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  テーブルID取得処理  END  ****"
      *-----------------------------------------------------------------
           CONTINUE.
       TBLID2-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.2.主処理
      ******************************************************************
       MAIN-RTN               SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  主処理  START  ***"
      *-----------------------------------------------------------------
      *---------- 3.2.1.ポートフォリオ取得
           PERFORM  PTF-GET-RTN
      *---------- 3.2.2.対象ポートフォリオ別処理、ループ処理
           PERFORM  TARGET-PTF-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  主処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       MAIN-EXT.
           EXIT.
      ******************************************************************
      *    3.2.1.ポートフォリオ取得
      ******************************************************************
       PTF-GET-RTN            SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ取得処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.ＧＩＰＳモード =["
      D                         WK-GIPS-MODE  OF  WK-ARG-INFO"]"
      *-----------------------------------------------------------------
           IF  WK-GIPS-MODE  OF  WK-ARG-INFO = CNS-X-1
           THEN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":引数情報.ＧＩＰＳモード='1'の場合（ＧＩＰＳモード起動）"
      *-----------------------------------------------------------------
      *---------- 0) 排他ロック処理
             PERFORM  HAITA-LOCK-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高基準日TO=["WK-ZN-KJN-YMD-TO"]"
      *-----------------------------------------------------------------
             IF  WK-ZN-KJN-YMD-TO NOT= ZERO
             THEN
      *---------- 0-1) 取引差分更新処理再読込処理
               PERFORM  SMZCGP01-CALL-RTN
             ELSE
               CONTINUE
             END-IF
      *---------- 1) 処理対象となれるファンド-ポートフォリオを取得する。（「別紙1-20 SQL説明」を参照）
             PERFORM  PTF-DEC-RTN
             PERFORM  PTF-OPEN-RTN
      *---------- 2) ポートフォリオコードカーソルフェッチする
             PERFORM  PTF-FETCH-RTN UNTIL FLG-PTF-CR-OPEN = CNS-OFF
      *---------- 3) ポートフォリオカーソルクローズ処理
             PERFORM  PTF-CLOSE-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク再処理要対象件数 =["
      D                         WK-SASYORIYO-KENSU"]"
      *-----------------------------------------------------------------
             IF  WK-SASYORIYO-KENSU = ZERO
             THEN
      *-------- ワークメッセージエリア(ワークCounterA).メッセージID ← M20のメッセージID
               MOVE  CNS-MSG-E000217
                 TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *-------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '対象ポートフォリオ'
               MOVE  CNS-TK-MOJI-59
                 TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *-------- ワークメッセージエリア(ワークCounterA).ファンドコード ← ' '
               MOVE  SPACE
                 TO  WK-FUND-CD       OF  WK-MSG-AREA(WK-CounterA)
      *-------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ← ' '
               MOVE  SPACE
                 TO  WK-PTF-CD        OF  WK-MSG-AREA(WK-CounterA)
      *-------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク引数情報.処理実行日
               MOVE  WK-SYORI-YMD     OF  WK-ARG-INFO
                 TO  WK-KJN-YMD-FROM  OF  WK-MSG-AREA(WK-CounterA)
      *-------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク引数情報.処理実行日
               MOVE  WK-SYORI-YMD     OF  WK-ARG-INFO
                 TO  WK-KJN-YMD-TO    OF  WK-MSG-AREA(WK-CounterA)
      *-------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
               MOVE  SPACE
                 TO  WK-FREE-MSG      OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
               COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-CounterA + 1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
               MOVE  CNS-RTN-BT0      TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               PERFORM  SCZY7050-3-RTN
               PERFORM  SCZY7210-UPDATE1-RTN
               PERFORM  SCZY7210-UPDATE2-RTN
               PERFORM  END-RTN
             ELSE
               CONTINUE
             END-IF
      *---------- 3)実行状況管理明細へインサート処理(ＧＩＰＳモード起動)
             PERFORM  SCZY7050-1-RTN
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":引数情報.ＧＩＰＳモード<>'1'の場合（非ＧＩＰＳモード起動）"
      *-----------------------------------------------------------------
      *---------- 【SCZY4023】ポートフォリオと有効期間取得-IIIに接続
             PERFORM  CALL-SCZY4023-RTN
      *---------- 3)実行状況管理明細へインサート処理(非ＧＩＰＳモード起動)
             PERFORM  SCZY7050-2-RTN
           END-IF
      *---------- 4)コミット
           PERFORM  COMMIT-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ取得処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-GET-EXT.
           EXIT.
      ******************************************************************
      *    １．【SCZY7050】実行状況管理明細ＩＮＳルーチンをコール
      ******************************************************************
       SCZY7050-3-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 【SCZY7050】実行状況管理明細"
      D             "ＩＮＳルーチンをコール処理 START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク再処理要対象件数 =["
      D                         WK-SASYORIYO-KENSU"]"
      *-----------------------------------------------------------------
             INITIALIZE  PARM-SCZY7050-INOUT
                         PARM-RTNPKG
      *---------- 利用会社コード
             MOVE  WK-RIYO-CMP-CD       OF  WK-ARG-INFO
               TO  RIYO-CMP-CD          OF  PARM-SCZY7050-ARG1
      *---------- 処理実行日
             MOVE  WK-SYORI-YMD         OF  WK-ARG-INFO
               TO  SYORI-YMD            OF  PARM-SCZY7050-ARG1
      *---------- 起動ID
             MOVE  WK-KIDOU-ID          OF  WK-ARG-INFO
               TO  KIDOU-ID             OF  PARM-SCZY7050-ARG1
      *---------- 業務タスクID
             MOVE  WK-GYOMU-TASK-ID     OF  WK-ARG-INFO
               TO  GYOMU-TASK-ID        OF  PARM-SCZY7050-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             HYK-KRTU-CD         OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
      D             REP-ANY-CD          OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM=["
      D             KJN-YMD-FROM        OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日TO=["
      D             KJN-YMD-TO          OF  PARM-SCZY7050-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7050"             USING  PARM-SCZY7050-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7050)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-000
             THEN
      *---------- Bコミットする
               PERFORM  DB-COMMIT4-RTN
             ELSE
               PERFORM  SUB-ERR-MSG-RTN
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
               MOVE  CNS-POS-140          TO  WK-ERR-POS
      *---------- リターンコード
               MOVE  CNS-RTN-901          TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  RTN-CD               OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
                 TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT16
               THEN
                 MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
               PERFORM  ERR-RTN
             END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SCZY7050】実行状況管理明細"
      D             "ＩＮＳルーチンをコール処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7050-3-EXT.
           EXIT.
      ******************************************************************
      *    Bコミットする
      ******************************************************************
       DB-COMMIT4-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-141          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-COMMIT4-EXT.
           EXIT.
      ******************************************************************
      *    ２．実行状況管理明細更新(先頭セッション)
      ******************************************************************
       SCZY7210-UPDATE1-RTN   SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新処理"
      D             "(先頭セッション)処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7210-INOUT
                       PARM-RTNPKG
      *---------- セッション区分
           MOVE  CNS-SESSION-KBN-0
             TO  SESSION-KBN            OF  PARM-SCZY7210-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7210-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7210-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7210-ARG2
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分  =["
      D             SESSION-KBN         OF  PARM-SCZY7210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日   =["
      D             SYORI-YMD           OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID   =["
      D             KIDOU-ID            OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード   =["
      D             FUND-CD             OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード  =["
      D             HYK-KRTU-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID  =["
      D             REP-ID              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード =["
      D             REP-ANY-CD          OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM =["
      D             KJN-YMD-FROM        OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":実行ステータス =["
      D             JIKOU-STS           OF  PARM-SCZY7210-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7210"             USING  PARM-SCZY7210-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- Bコミットする
             PERFORM  DB-COMMIT5-RTN
           ELSE
             PERFORM  SUB-ERR-MSG-RTN
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-142          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-901          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD               OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新処理"
      D             "(先頭セッション)処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7210-UPDATE1-EXT.
           EXIT.
      ******************************************************************
      *    Bコミットする
      ******************************************************************
       DB-COMMIT5-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-143          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-COMMIT5-EXT.
           EXIT.
      ******************************************************************
      *    ３．実行状況管理明細更新処理（最終セッション）
      ******************************************************************
       SCZY7210-UPDATE2-RTN   SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新処理"
      D             "（最終セッション）処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7210-INOUT
                       PARM-RTNPKG
      *---------- セッション区分
           MOVE  CNS-SESSION-KBN-1
             TO  SESSION-KBN            OF  PARM-SCZY7210-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7210-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7210-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7210-ARG2
      *---------- 実行ステータス
           MOVE  CNS-MT-JS-100
             TO  JIKOU-STS              OF  PARM-SCZY7210-ARG2
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分  =["
      D             SESSION-KBN         OF  PARM-SCZY7210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日   =["
      D             SYORI-YMD           OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID   =["
      D             KIDOU-ID            OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード   =["
      D             FUND-CD             OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード  =["
      D             HYK-KRTU-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID  =["
      D             REP-ID              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード =["
      D             REP-ANY-CD          OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM =["
      D             KJN-YMD-FROM        OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":実行ステータス =["
      D             JIKOU-STS           OF  PARM-SCZY7210-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7210"             USING  PARM-SCZY7210-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- Bコミットする
             PERFORM  DB-COMMIT6-RTN
           ELSE
             PERFORM  SUB-ERR-MSG-RTN
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-144          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-901          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD               OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新処理"
      D             "（最終セッション）処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7210-UPDATE2-EXT.
           EXIT.
      ******************************************************************
      *    Bコミットする
      ******************************************************************
       DB-COMMIT6-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-145          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-COMMIT6-EXT.
           EXIT.
      ******************************************************************
      *    排他ロック処理
      ******************************************************************
       HAITA-LOCK-RTN         SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  排他ロック処理 START  ***"
      *-----------------------------------------------------------------
      *---------- @再処理要制御テーブルをロックする
           PERFORM  LOCK-TKDYGP17-RTN
      *---------- A再処理要制御テーブルを更新する
           PERFORM  UPDATE-TKDYGP17-RTN
      *---------- @再処理要制御テーブルをロックする
           PERFORM  TKDYGP17-CLOSE-RTN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  排他ロック処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       HAITA-LOCK-EXT.
           EXIT.
      ******************************************************************
      *    0-1) 取引差分更新処理再読込処理
      ******************************************************************
       SMZCGP01-CALL-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  取引差分更新処理再読込処理"
      D             " START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZCGP01-INOUT
                       PARM-RTNPKG
      *---------- 起動ログインユーザ会社コード
           MOVE  COMPANY-CODE           OF  WK-AIFA-IN
             TO  KIDOU-RIYO-CMP-CD      OF  PARM-SMZCGP01-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SMZCGP01-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  SYORI-YMD              OF  PARM-SMZCGP01-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SMZCGP01-ARG1
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SMZCGP01-ARG1
      *---------- 起動ユーザID
           MOVE  JOB-USER-ID            OF  WK-AIFA-IN
             TO  KIDOU-USER-ID          OF  PARM-SMZCGP01-ARG1
      *---------- 残高基準日FROM
           MOVE  WK-ZN-KJN-YMD-FROM
             TO  ZN-KJN-YMD-FROM        OF  PARM-SMZCGP01-ARG1
      *---------- 残高基準日TO
           MOVE  WK-ZN-KJN-YMD-TO
             TO  ZN-KJN-YMD-TO          OF  PARM-SMZCGP01-ARG1
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":起動ログインユーザ会社コード=["
      D             KIDOU-RIYO-CMP-CD   OF  PARM-SMZCGP01-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SMZCGP01-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SMZCGP01-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SMZCGP01-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SMZCGP01-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ユーザID=["
      D             KIDOU-USER-ID       OF  PARM-SMZCGP01-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":残高基準日FROM=["
      D             ZN-KJN-YMD-FROM     OF  PARM-SMZCGP01-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":残高基準日TO=["
      D             ZN-KJN-YMD-TO       OF  PARM-SMZCGP01-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZCGP01"             USING  PARM-SMZCGP01-INOUT
                                               PARM-RTNPKG
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZCGP01)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD  OF  PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-163          TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  取引差分更新処理再読込処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZCGP01-CALL-EXT.
           EXIT.
      ******************************************************************
      *    @再処理要制御テーブルをロックする
      ******************************************************************
       LOCK-TKDYGP17-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  再処理要制御テーブルをロック処理"
      D             " START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKDYGP17-W
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  H-RIYO-CMP-CD          OF  H-TKDYGP17-W,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-21-1
      *---------- テーブルID
           MOVE  WK-TBL-TKDYGP17
             TO  SQL-TKDYGP17           OF  SQL-SELECT-1-21,
                 WK-TKDYGP17            OF  WK-MSG-1-21-1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             H-RIYO-CMP-CD       OF  H-TKDYGP17-W"]"
      D    DISPLAY  CNS-PGM-ID":WK-MSG-1-21-1=["WK-MSG-1-21-1"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT
      *----ＳＱＬ文
           MOVE  SQL-SELECT-1-21        TO  SQLSTMT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT=["SQLSTMT"]"
      *-----------------------------------------------------------------
           EXEC SQL
               PREPARE  S21S FROM :SQLSTMT
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-146          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-21-1      DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
           EXEC  SQL DECLARE  TKDYGP17_CURSOR  CURSOR  FOR S21S END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKDYGP17_CURSOR
                 USING :H-TKDYGP17-W
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKDYGP17-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKDYGP17-CR-OPEN=["
      D             FLG-TKDYGP17-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-164          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-21-1      DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
           INITIALIZE  H-TKDYGP17-1
           EXEC  SQL
               FETCH
                    TKDYGP17_CURSOR
               INTO :H-TKDYGP17-1
           END-EXEC
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
      *---------- ワーク残高基準日FROM ← HST-残高基準日FROM
             MOVE  H-ZN-KJN-YMD-FROM    OF  H-TKDYGP17-1
               TO  WK-ZN-KJN-YMD-FROM
      *---------- ワーク残高基準日TO ← HST-残高基準日TO
             MOVE  H-ZN-KJN-YMD-TO      OF  H-TKDYGP17-1
               TO  WK-ZN-KJN-YMD-TO
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高基準日FROM=["
      D             WK-ZN-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高基準日TO=["
      D             WK-ZN-KJN-YMD-TO"]"
      *-----------------------------------------------------------------
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-147          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-21-1      DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":***  再処理要制御テーブルをロック処理"
      D             " END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       LOCK-TKDYGP17-EXT.
           EXIT.
      ******************************************************************
      *    再処理要制御 CURSOR CLOSE 処理
      ******************************************************************
       TKDYGP17-CLOSE-RTN     SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 再処理要制御 CURSOR CLOSE 処理 "
      D             "START ***"
      D    DISPLAY  CNS-PGM-ID":FLG-TKDYGP17-CR-OPEN=["
      D             FLG-TKDYGP17-CR-OPEN"]"
      *-----------------------------------------------------------------
           EXEC  SQL
               CLOSE TKDYGP17_CURSOR
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(CLOSE) =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-OFF              TO  FLG-TKDYGP17-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKDYGP17-CR-OPEN=["
      D             FLG-TKDYGP17-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-165          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-21-1      DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 再処理要制御 CURSOR CLOSE 処理 "
      D             "END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKDYGP17-CLOSE-EXT.
           EXIT.
      ******************************************************************
      *    A再処理要制御テーブルを更新する
      ******************************************************************
       UPDATE-TKDYGP17-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  再処理要制御テーブルを更新処理"
      D             " START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKDYGP17
                                        H-TKDYGP17-W
      *---------- 業務タスクＩＤ
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  H-GYOMU-TASK-ID        OF  H-TKDYGP17,
                 WK-GYOMU-TASK-ID       OF  WK-MSG-1-21-2
      *---------- 更新ログインユーザ会社コード
           MOVE  COMPANY-CODE           OF  WK-AIFA-IN
             TO  H-UPD-LOGIN-CMP-CD     OF  H-TKDYGP17,
                 WK-UPD-LOGIN-CMP-CD    OF  WK-MSG-1-21-2
      *---------- 更新ユーザＩＤ
           MOVE  JOB-USER-ID            OF  WK-AIFA-IN
             TO  H-UPD-SID              OF  H-TKDYGP17,
                 WK-UPD-SID             OF  WK-MSG-1-21-2
      *---------- 更新プログラムＩＤ
           MOVE  CNS-PGM-ID
             TO  H-UPD-PGMID            OF  H-TKDYGP17,
                 WK-UPD-PGMID           OF  WK-MSG-1-21-2
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  H-RIYO-CMP-CD          OF  H-TKDYGP17-W,
                 WK-RIYO-CMP-CD-U       OF  WK-MSG-1-21-2
      *---------- テーブルID
           MOVE  WK-TBL-TKDYGP17
             TO  SQL-TKDYGP17           OF  SQL-UPDATE-1-21,
                 WK-TKDYGP17            OF  WK-MSG-1-21-2
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":業務タスクＩＤ=["
      D             H-GYOMU-TASK-ID     OF  H-TKDYGP17"]"
      D    DISPLAY  CNS-PGM-ID":更新日時=[ Oracle関数「SYSDATE」]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード=["
      D             H-UPD-LOGIN-CMP-CD  OF  H-TKDYGP17"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ=["
      D             H-UPD-SID           OF  H-TKDYGP17"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ=["
      D             H-UPD-PGMID         OF  H-TKDYGP17"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             H-RIYO-CMP-CD       OF  H-TKDYGP17-W"]"
      D    DISPLAY  CNS-PGM-ID":WK-MSG-1-21-2=["WK-MSG-1-21-2"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT
      *----ＳＱＬ文
           MOVE  SQL-UPDATE-1-21        TO  SQLSTMT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT=["SQLSTMT"]"
      *-----------------------------------------------------------------
           EXEC SQL
               PREPARE  S21U FROM :SQLSTMT
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-148          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MSG-1-21-2      DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
           EXEC SQL
               EXECUTE S21U
                 USING :H-TKDYGP17,
                       :H-TKDYGP17-W
           END-EXEC
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-UPDATE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               CONTINUE
             WHEN  CNS-SQL-NOTFOUND
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":再処理要制御テーブルを更新データなし"
      *-----------------------------------------------------------------
               PERFORM  END-RTN
             WHEN  OTHER
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（UPDATE)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
               MOVE  CNS-POS-149          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
               MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-UPDATE,
                       WK-MSG-1-21-2      DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":***  再処理要制御テーブルを更新処理"
      D             " END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       UPDATE-TKDYGP17-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       PTF-DEC-RTN            SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- テーブルID
           MOVE  WK-TBL-TKDYGP12
             TO  SQL2-TKDYGP12          OF  SQL-SELECT-1-20,
                 WK-TKDYGP12            OF  WK-MSG-1-20
           MOVE  WK-TBL-TKDYGP16
             TO  SQL4-TKDYGP16          OF  SQL-SELECT-1-20,
                 WK-TKDYGP16            OF  WK-MSG-1-20
           INITIALIZE  SQLSTMT
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-20        TO  SQLSTMT
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT=["SQLSTMT"]"
      *-----------------------------------------------------------------
           EXEC  SQL
               PREPARE  S20  FROM :SQLSTMT
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-150          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-20        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
           EXEC  SQL  DECLARE  PTF_CURSOR  CURSOR  FOR  S20 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       PTF-OPEN-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN PTF_CURSOR
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-PTF-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-PTF-CR-OPEN=["FLG-PTF-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-151          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-20        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    ポートフォリオコードカーソルフェッチする
      ******************************************************************
       PTF-FETCH-RTN          SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** ポートフォリオコードカーソルフェッチ 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-PTF
           EXEC  SQL
               FETCH
                    PTF_CURSOR
               INTO :H-PTF
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
      *---------- ポートフォリオの利用権限をチェックする
               PERFORM  SCZY1130-RTN
             WHEN  CNS-SQL-NOTFOUND
               MOVE  CNS-OFF            TO  FLG-PTF-CR-OPEN
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-152          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-20        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** ポートフォリオコードカーソルフェッチ 処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-FETCH-EXT.
           EXIT.
      ******************************************************************
      *    ポートフォリオの利用権限をチェックする
      ******************************************************************
       SCZY1130-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオの利用権限をチェック"
      D             "処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1130-INOUT
                       PARM-RTNPKG
      *----------  業務グループコード
           MOVE  GYOUMU-GROUP-CODE      OF  WK-DENBUN-INFO
             TO  GYOMU-GRP-CD           OF  PARM-SCZY1130-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY1130-ARG1
      *----------  ログインユーザー会社コード
           MOVE  COMPANY-CODE           OF  WK-AIFA-IN
             TO  LOGIN-CMP-CD           OF  PARM-SCZY1130-ARG1
      *----------  メニューID
           MOVE  SPACE
             TO  MENU-ID                OF  PARM-SCZY1130-ARG1
      *----------  実行処理ID
           MOVE  SPACE
             TO  JIKOU-SYORI-ID         OF  PARM-SCZY1130-ARG1
      *----------  ファンドコード
           MOVE  H-FUND-CD              OF  H-PTF
             TO  FUND-CD                OF  PARM-SCZY1130-ARG1
      *----------  ポートフォリオコード
           MOVE  H-PTF-CD               OF  H-PTF
             TO  PTF-CD                 OF  PARM-SCZY1130-ARG1
      *----------  予備
           MOVE  SPACE
             TO  YOBI                   OF  PARM-SCZY1130-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":業務グループコード=["
      D             GYOMU-GRP-CD        OF  PARM-SCZY1130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY1130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ログインユーザー会社コード=["
      D             LOGIN-CMP-CD        OF  PARM-SCZY1130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":メニューID=["
      D             MENU-ID             OF  PARM-SCZY1130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":実行処理ID=["
      D             JIKOU-SYORI-ID      OF  PARM-SCZY1130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY1130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY1130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":予備=["
      D             YOBI                OF  PARM-SCZY1130-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1130"             USING  PARM-SCZY1130-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1130)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオの利用権限をチェック"
      D             "処理 正常  ***"
      *-----------------------------------------------------------------
      *---------- ワーク再処理要対象件数 + 1
               COMPUTE  WK-SASYORIYO-KENSU = WK-SASYORIYO-KENSU + CNS-1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク再処理要対象件数=["
      D             WK-SASYORIYO-KENSU"]"
      *-----------------------------------------------------------------
               IF  WK-SASYORIYO-KENSU > CNS-50000
               THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M21のメッセージID
                 MOVE  CNS-MSG-W000309
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ← 別紙1-20.ファンドコード
                 MOVE  H-FUND-CD        OF  H-PTF
                   TO  WK-FUND-CD       OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ← 別紙1-20.ポートフォリオコード
                 MOVE  H-PTF-CD         OF  H-PTF
                   TO  WK-PTF-CD        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← 別紙1-20.MIN(計算期間FROM)
                 MOVE  H-CALC-KKN-FROM  OF  H-PTF
                   TO  WK-KJN-YMD-FROM  OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← 別紙1-20.MAX(計算期間TO)
                 MOVE  H-CALC-KKN-TO    OF  H-PTF
                   TO  WK-KJN-YMD-TO    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
                 MOVE  SPACE
                   TO  WK-FREE-MSG      OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
                 COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-CounterA + 1 =["WK-CounterA"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
                 IF  WK-RETURN-CD < CNS-RTN-BT2
                 THEN
                   MOVE  CNS-RTN-BT2    TO  WK-RETURN-CD
                 ELSE
                   CONTINUE
                 END-IF
                 MOVE  CNS-OFF          TO  FLG-PTF-CR-OPEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               ELSE
      *---------- ファンドコード
                 MOVE  H-FUND-CD        OF  H-PTF
                   TO  WK-FUND-CD
                   OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)
      *---------- ポートフォリオコード
                 MOVE  H-PTF-CD         OF  H-PTF
                   TO  WK-PTF-CD
                   OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)
      *---------- 計算期間FROM
                 MOVE  H-CALC-KKN-FROM  OF  H-PTF
                   TO  WK-CALC-KKN-FROM
                   OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)
      *---------- 計算期間TO
                 MOVE  H-CALC-KKN-TO    OF  H-PTF
                   TO  WK-CALC-KKN-TO
                   OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク再処理要対象件数=["
      D             WK-SASYORIYO-KENSU"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["WK-PTF-CD
      D             OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["WK-PTF-CD
      D             OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)"]"
      D    DISPLAY  CNS-PGM-ID":計算期間FROM=["WK-CALC-KKN-FROM
      D             OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)"]"
      D    DISPLAY  CNS-PGM-ID":計算期間TO=["WK-CALC-KKN-TO
      D             OF  WK-SSYORIYOU-TASYO(WK-SASYORIYO-KENSU)"]"
      *-----------------------------------------------------------------
               END-IF
             WHEN  CNS-RTN-130
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M36のメッセージID
               MOVE  CNS-MSG-E000534
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
               MOVE  SPACE
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ← 別紙1-20.ファンドコード
               MOVE  H-FUND-CD          OF  H-PTF
                 TO  WK-FUND-CD         OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ← 別紙1-20.ポートフォリオコード
               MOVE  H-PTF-CD           OF  H-PTF
                 TO  WK-PTF-CD          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← 別紙1-20.MIN(計算期間FROM)
               MOVE  H-CALC-KKN-FROM    OF  H-PTF
                 TO  WK-KJN-YMD-FROM    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← 別紙1-20.MAX(計算期間TO)
               MOVE  H-CALC-KKN-TO      OF  H-PTF
                 TO  WK-KJN-YMD-TO      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
               MOVE  SPACE
                 TO  WK-FREE-MSG        OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
               COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-CounterA + 1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
               MOVE  CNS-RTN-BT4        TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               PERFORM  SCZY7110-RTN
             WHEN  OTHER
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-153        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオの利用権限をチェック"
      D             "処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY1130-EXT.
           EXIT.
      ******************************************************************
      *    監査情報を監査ログDBにINSERTする
      ******************************************************************
       SCZY7110-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  監査情報を監査ログDBにINSERT"
      D             "処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-AIFA-HEADER
                       PARM-SCZY7110-INOUT
                       PARM-RTNPKG
      *---------- AIFA・共通ヘッダ項目
      *---------- AIFA情報
           MOVE  WK-AIFA-IN             OF  WK-DENBUN-INFO
             TO  PARM-WOMCMAIFA-ARG     OF  PARM-AIFA-HEADER
      *---------- 共通ヘッダ
           MOVE  WK-HEADER-IN           OF  WK-DENBUN-INFO
             TO  PARM-CZCOMMONHEADER-ARG
                                        OF  PARM-AIFA-HEADER
      *---------- システム処理ID
           MOVE  MENU-ID                OF  WK-DENBUN-INFO
             TO  SYS-SYORI-ID           OF  PARM-SCZY7110-INOUT
      *---------- 起動ID
           MOVE  SPACE
             TO  KIDOU-ID               OF  PARM-SCZY7110-INOUT
      *---------- 画面アクション区分
           MOVE  CNS-X-9
             TO  GAMEN-ACT-KBN          OF  PARM-SCZY7110-INOUT
      *---------- 正常エラー区分
           MOVE  CNS-X-07
             TO  NML-ERR-KBN            OF  PARM-SCZY7110-INOUT
      *---------- 課金用検索区分
           MOVE  CNS-X-0
             TO  EE-SEARCH-KBN          OF  PARM-SCZY7110-INOUT
      *---------- 基準年月日1
           MOVE  H-CALC-KKN-FROM        OF  H-PTF
             TO  KIJUN-YMD1             OF  PARM-SCZY7110-INOUT
      *---------- 基準年月日2
           MOVE  H-CALC-KKN-TO          OF  H-PTF
             TO  KIJUN-YMD2             OF  PARM-SCZY7110-INOUT
      *---------- 委託会社コード
      *---------- ファンドコード
      *---------- 銘柄コード
           MOVE  SPACE
             TO  ITK-CMP-CD             OF  PARM-SCZY7110-INOUT
                 FND-CD                 OF  PARM-SCZY7110-INOUT
                 MEG-CD                 OF  PARM-SCZY7110-INOUT
      *---------- データ特定用ID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  DATA-ID                OF  PARM-SCZY7110-INOUT
      *---------- TXRX利用区分
           MOVE  WK-HEADER-IN(267:1)
             TO  TXRX-KBN               OF  PARM-SCZY7110-INOUT
      *---------- RXファンドコード
           MOVE  H-FUND-CD              OF  H-PTF
             TO  FUND-CD                OF  PARM-SCZY7110-INOUT
      *---------- RXポートフォリオコード
           MOVE  H-PTF-CD               OF  H-PTF
             TO  PTF-CD                 OF  PARM-SCZY7110-INOUT
      *---------- 電文ID
      *---------- 入力電文
           MOVE  SPACE
             TO  DENBUN-ID              OF  PARM-SCZY7110-INOUT
                 IN-DENBUN              OF  PARM-SCZY7110-INOUT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":AIFA・共通ヘッダ項目=["
      D             PARM-AIFA-HEADER"]"
      D    DISPLAY  CNS-PGM-ID":システム処理ID=["
      D             SYS-SYORI-ID        OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":画面アクション区分=["
      D             GAMEN-ACT-KBN       OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":正常エラー区分=["
      D             NML-ERR-KBN         OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":課金用検索区分=["
      D             EE-SEARCH-KBN       OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日1=["
      D             KIJUN-YMD1          OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日2=["
      D             KIJUN-YMD2          OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":委託会社コード=["
      D             ITK-CMP-CD          OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FND-CD              OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             MEG-CD              OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":データ特定用ID=["
      D             DATA-ID             OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":TXRX利用区分=["
      D             TXRX-KBN            OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":RXファンドコード=["
      D             FUND-CD             OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":RXポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":電文ID=["
      D             DENBUN-ID           OF  PARM-SCZY7110-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":入力電文=["
      D             IN-DENBUN           OF  PARM-SCZY7110-INOUT"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7110"             USING  PARM-AIFA-HEADER
                                               PARM-SCZY7110-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7110)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
               = CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  監査情報を監査ログDBにINSERT"
      D             "処理 正常  ***"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-154        TO  WK-ERR-POS
             PERFORM  ERR-MSG-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  監査情報を監査ログDBにINSERT"
      D             "処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7110-EXT.
           EXIT.
      ******************************************************************
      *    ポートフォリオカーソルクローズ処理
      ******************************************************************
       PTF-CLOSE-RTN          SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** ポートフォリオカーソルクローズ "
      D             "処理 START ***"
      D    DISPLAY  CNS-PGM-ID":FLG-PTF-CR-OPEN=["FLG-PTF-CR-OPEN"]"
      *-----------------------------------------------------------------
           EXEC  SQL
               CLOSE PTF_CURSOR
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(CLOSE)   =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-OFF              TO  FLG-PTF-CR-OPEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-PTF-CR-OPEN=["FLG-PTF-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（CLOSE)"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-155          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-20        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** ポートフォリオカーソルクローズ "
      D             "処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-CLOSE-EXT.
           EXIT.
      ******************************************************************
      *    【SCZY4023】ポートフォリオと有効期間取得-IIIに接続
      ******************************************************************
       CALL-SCZY4023-RTN      SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SCZY4023】ポートフォリオと"
      D                       "有効期間取得-IIIに接続  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-AIFA-HEADER
                       PARM-SCZY4023-INOUT
                       PARM-RTNPKG
      *---------- AIFA情報
           MOVE  WK-AIFA-IN             OF  WK-DENBUN-INFO
             TO  PARM-WOMCMAIFA-ARG     OF  PARM-AIFA-HEADER
      *---------- 共通ヘッダ
           MOVE  WK-HEADER-IN           OF  WK-DENBUN-INFO
             TO  PARM-CZCOMMONHEADER-ARG
                                        OF  PARM-AIFA-HEADER
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY4023-ARG1
      *---------- オール指定
           MOVE  WK-ALL                 OF  WK-DENBUN-KAISEKI-INFO
             TO  ALL-SITEI              OF  PARM-SCZY4023-ARG1
      *---------- ポートフォリオ選択リスト
           MOVE  WK-PTF-FUND-LIST       OF  WK-DENBUN-KAISEKI-INFO
             TO  PTF-FUND-LIST          OF  PARM-SCZY4023-ARG1
      *---------- 権限チェック有無
           MOVE  CNS-KGN-CHK-UMU-1
             TO  KGN-CHK-UMU            OF  PARM-SCZY4023-ARG1
      *---------- メニューID
           MOVE  MENU-ID                OF  WK-DENBUN-INFO
             TO  MENU-ID                OF  PARM-SCZY4023-ARG1
      *---------- 画面アクション区分
           MOVE  CNS-GAMEN-ACT-KBN-9
             TO  GAMEN-ACT-KBN          OF  PARM-SCZY4023-ARG1
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY4023-ARG1
      *---------- 日中夜間区分
           MOVE  CNS-NCHU-YAKN-KBN-0
             TO  NCHU-YAKN-KBN          OF  PARM-SCZY4023-ARG1
      *---------- APL指定出力件数
           MOVE  ZERO
             TO  APL-OUT-CNT            OF  PARM-SCZY4023-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":AIFA情報  =["WK-AIFA-IN"]"
      D    DISPLAY  CNS-PGM-ID":共通ヘッダ=["WK-HEADER-IN"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":オール指定 =["
      D             ALL-SITEI           OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオ選択リスト =["
      D             PTF-FUND-LIST       OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":権限チェック有無 =["
      D             KGN-CHK-UMU         OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":メニューID =["
      D             MENU-ID             OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":画面アクション区分 =["
      D             GAMEN-ACT-KBN       OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID =["
      D             GYOMU-TASK-ID       OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":日中夜間区分 =["
      D             NCHU-YAKN-KBN       OF  PARM-SCZY4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":APL指定出力件数 =["
      D             APL-OUT-CNT         OF  PARM-SCZY4023-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4023"             USING  PARM-AIFA-HEADER
                                               PARM-SCZY4023-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4023)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
      *---------- ヒット件数
               MOVE  HIT-KENSU          OF  PARM-SCZY4023-ARG2
                 TO  WK-HIT-KENSU
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ヒット件数 =["WK-HIT-KENSU"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               IF  HIT-KENSU  OF  PARM-SCZY4023-ARG2  >  ZERO
               THEN
                 CONTINUE
               ELSE
                 IF  HIT-KENSU  OF  PARM-SCZY4023-ARG2  =  ZERO
                 THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M20のメッセージID
                   MOVE  CNS-MSG-E000217
                     TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '対象ポートフォリオ'
                   MOVE  CNS-TK-MOJI-59
                     TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                   PERFORM  M01-FREE-AREA-RTN
      *---------- ワークリターンコード←'8'(業務エラー（処理中メイン続行不可）)
                   MOVE  CNS-RTN-BT8      TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.3後処理へ
                   PERFORM  END-RTN
                 ELSE
                   INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
                   MOVE  CNS-POS-017      TO  WK-ERR-POS
                   PERFORM  ERR-MSG-RTN
                 END-IF
               END-IF
             WHEN  CNS-RTN-002
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M21のメッセージID
                 MOVE  CNS-MSG-W000309
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                 PERFORM  M01-FREE-AREA-RTN
      *---------- ワークリターンコード
                 IF  WK-RETURN-CD < CNS-RTN-BT2
                 THEN
                   MOVE  CNS-RTN-BT2    TO  WK-RETURN-CD
                 ELSE
                   CONTINUE
                 END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-130
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M36のメッセージID
               MOVE  CNS-MSG-E000534
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
               MOVE  SPACE
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M01-FREE-AREA-RTN
               IF  HIT-KENSU            OF  PARM-SCZY4023-ARG2  >  ZERO
               THEN
                 MOVE  CNS-RTN-BT4      TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               ELSE
                 MOVE  CNS-RTN-BT8      TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 「3.3  後処理」へ
                 PERFORM  END-RTN
               END-IF
             WHEN  OTHER
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-018        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SCZY4023】ポートフォリオと"
      D                       "有効期間取得-IIIに接続 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       CALL-SCZY4023-EXT.
           EXIT.
      ******************************************************************
      *    3.2.1 3) 実行状況管理明細へインサート処理(ＧＩＰＳモード起動)
      ******************************************************************
       SCZY7050-1-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 実行状況管理明細へインサート処理"
      D             "(ＧＩＰＳモード起動) START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク再処理要対象件数 =["
      D                         WK-SASYORIYO-KENSU"]"
      *-----------------------------------------------------------------
           PERFORM                  VARYING  WK-IDX1
             FROM  CNS-1 BY CNS-1 UNTIL  WK-IDX1 > WK-SASYORIYO-KENSU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-IDX1=["WK-IDX1"]"
      *-----------------------------------------------------------------
             INITIALIZE  PARM-SCZY7050-INOUT
                         PARM-RTNPKG
      *---------- 利用会社コード
             MOVE  WK-RIYO-CMP-CD       OF  WK-ARG-INFO
               TO  RIYO-CMP-CD          OF  PARM-SCZY7050-ARG1
      *---------- 処理実行日
             MOVE  WK-SYORI-YMD         OF  WK-ARG-INFO
               TO  SYORI-YMD            OF  PARM-SCZY7050-ARG1
      *---------- 起動ID
             MOVE  WK-KIDOU-ID          OF  WK-ARG-INFO
               TO  KIDOU-ID             OF  PARM-SCZY7050-ARG1
      *---------- 業務タスクID
             MOVE  WK-GYOMU-TASK-ID     OF  WK-ARG-INFO
               TO  GYOMU-TASK-ID        OF  PARM-SCZY7050-ARG1
      *---------- ファンドコード
             MOVE  WK-FUND-CD           OF  WK-SSYORIYOU-TASYO(WK-IDX1)
               TO  FUND-CD              OF  PARM-SCZY7050-ARG1
      *---------- ポートフォリオコード
             MOVE  WK-PTF-CD            OF  WK-SSYORIYOU-TASYO(WK-IDX1)
               TO  PTF-CD               OF  PARM-SCZY7050-ARG1
      *---------- 評価系列コード
             MOVE  SPACE
               TO  HYK-KRTU-CD          OF  PARM-SCZY7050-ARG1
      *---------- 帳票ID
             MOVE  SPACE
               TO  REP-ID               OF  PARM-SCZY7050-ARG1
      *---------- 帳票任意コード
             MOVE  SPACE
               TO  REP-ANY-CD           OF  PARM-SCZY7050-ARG1
      *---------- 基準日FROM
             MOVE  WK-CALC-KKN-FROM     OF  WK-SSYORIYOU-TASYO(WK-IDX1)
               TO  KJN-YMD-FROM         OF  PARM-SCZY7050-ARG1
      *---------- 基準日TO
             MOVE  WK-CALC-KKN-TO       OF  WK-SSYORIYOU-TASYO(WK-IDX1)
               TO  KJN-YMD-TO           OF  PARM-SCZY7050-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             HYK-KRTU-CD         OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
      D             REP-ANY-CD          OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM=["
      D             KJN-YMD-FROM        OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日TO=["
      D             KJN-YMD-TO          OF  PARM-SCZY7050-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7050"             USING  PARM-SCZY7050-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7050)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-000
             THEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":実行状況管理明細へインサート処理"
      D                       "(ＧＩＰＳモード起動)  正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":実行状況管理明細へインサート処理"
      D                       "(ＧＩＰＳモード起動) エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-156        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
             END-IF
           END-PERFORM
      *---------- Bワーク明細管理用基準日FROM ← ワーク再処理要対象(IDX).計算期間FROM
           MOVE  WK-CALC-KKN-FROM    OF  WK-SSYORIYOU-TASYO(WK-IDX1 - 1)
             TO  WK-MKY-KJN-YMD-FROM
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細管理用基準日FROM =["
      D             WK-MKY-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":*** 実行状況管理明細へインサート処理"
      D             "(ＧＩＰＳモード起動) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7050-1-EXT.
           EXIT.
      ******************************************************************
      *    3.2.1 3) 実行状況管理明細へインサート処理(非ＧＩＰＳモード起動)
      ******************************************************************
       SCZY7050-2-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 実行状況管理明細へインサート処理"
      D             "(非ＧＩＰＳモード起動) START ***"
      D    DISPLAY  CNS-PGM-ID":ヒット件数 =["WK-HIT-KENSU"]"
      *-----------------------------------------------------------------
           PERFORM                  VARYING  WK-IDX1
             FROM  CNS-1 BY CNS-1 UNTIL  WK-IDX1 > WK-HIT-KENSU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-IDX1=["WK-IDX1"]"
      *-----------------------------------------------------------------
             INITIALIZE  PARM-SCZY7050-INOUT
                         PARM-RTNPKG
      *---------- 利用会社コード
             MOVE  WK-RIYO-CMP-CD       OF  WK-ARG-INFO
               TO  RIYO-CMP-CD          OF  PARM-SCZY7050-ARG1
      *---------- 処理実行日
             MOVE  WK-SYORI-YMD         OF  WK-ARG-INFO
               TO  SYORI-YMD            OF  PARM-SCZY7050-ARG1
      *---------- 起動ID
             MOVE  WK-KIDOU-ID          OF  WK-ARG-INFO
               TO  KIDOU-ID             OF  PARM-SCZY7050-ARG1
      *---------- 業務タスクID
             MOVE  WK-GYOMU-TASK-ID     OF  WK-ARG-INFO
               TO  GYOMU-TASK-ID        OF  PARM-SCZY7050-ARG1
      *---------- ファンドコード
             MOVE  O-FUND-CD            OF  PARM-SCZY4023-ARG2(WK-IDX1)
               TO  FUND-CD              OF  PARM-SCZY7050-ARG1
      *---------- ポートフォリオコード
             MOVE  O-PTF-CD             OF  PARM-SCZY4023-ARG2(WK-IDX1)
               TO  PTF-CD               OF  PARM-SCZY7050-ARG1
      *---------- 評価系列コード
             MOVE  SPACE
               TO  HYK-KRTU-CD          OF  PARM-SCZY7050-ARG1
      *---------- 帳票ID
             MOVE  SPACE
               TO  REP-ID               OF  PARM-SCZY7050-ARG1
      *---------- 帳票任意コード
             MOVE  SPACE
               TO  REP-ANY-CD           OF  PARM-SCZY7050-ARG1
      *---------- 基準日FROM
             MOVE  WK-SITEI-FROM        OF  WK-DENBUN-KAISEKI-INFO
               TO  KJN-YMD-FROM         OF  PARM-SCZY7050-ARG1
      *---------- 基準日TO
             MOVE  WK-SITEI-TO          OF  WK-DENBUN-KAISEKI-INFO
               TO  KJN-YMD-TO           OF  PARM-SCZY7050-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             HYK-KRTU-CD         OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
      D             REP-ANY-CD          OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM=["
      D             KJN-YMD-FROM        OF  PARM-SCZY7050-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日TO=["
      D             KJN-YMD-TO          OF  PARM-SCZY7050-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7050"             USING  PARM-SCZY7050-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7050)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-000
             THEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":実行状況管理明細へインサート処理"
      D                       "(非ＧＩＰＳモード起動)  正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":実行状況管理明細へインサート処理"
      D                       "(非ＧＩＰＳモード起動) エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-019        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
             END-IF
           END-PERFORM
      *---------- Bワーク明細管理用基準日FROM ← ワーク電文解析情報.指定From日
           MOVE  WK-SITEI-FROM          OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-MKY-KJN-YMD-FROM
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細管理用基準日FROM =["
      D             WK-MKY-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":*** 実行状況管理明細へインサート処理"
      D             "(非ＧＩＰＳモード起動) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7050-2-EXT.
           EXIT.
      ******************************************************************
      *    3.2.1. 4) コミット
      ******************************************************************
       COMMIT-RTN             SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
             MOVE  CNS-POS-020          TO  WK-ERR-POS
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       COMMIT-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.対象ポートフォリオ別処理、ループ処理
      ******************************************************************
       TARGET-PTF-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象ポートフォリオ別処理、ループ"
      D             "処理  START ***"
      *-----------------------------------------------------------------
      *---------- 3.2.2.0.対象ポートフォリオのデータを取得
           PERFORM  SCZY7200-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SCZY7200.リターンパッケージ.取得件数=["
      D             WK-GET-KENSU"]"
      *-----------------------------------------------------------------
           PERFORM                  VARYING  WK-IDX2
             FROM  CNS-1 BY CNS-1 UNTIL  WK-IDX2 > WK-GET-KENSU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-IDX2=["WK-IDX2"]"
      *-----------------------------------------------------------------
             MOVE  CNS-OFF              TO  FLG-PTF
      *---------- 3.2.2.1.ワークポートフォリオ情報へデータセット
             PERFORM  WK-PTF-INFO-DATA-RTN
      *---------- 3.2.2.2.取引差分更新管理ロック
             PERFORM  TKMZSK00-RTN
             IF  FLG-PTF = CNS-ON
             THEN
               CONTINUE
             ELSE
      *---------- 3.2.2.3.実行状況管理明細更新(先頭セッション)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文解析情報.指定From日 =["
      D             WK-SITEI-FROM       OF  WK-DENBUN-KAISEKI-INFO"]"
      *-----------------------------------------------------------------
               IF  WK-SITEI-FROM        OF  WK-DENBUN-KAISEKI-INFO
                =  ZERO
               THEN
      *---------- 1)実行状況管理明細に更新処理
                 PERFORM  UPDATE-TKDYAA35-RTN
               ELSE
                 CONTINUE
               END-IF
               PERFORM  SCZY7210-RTN
             END-IF
             IF  FLG-PTF = CNS-ON
             THEN
               CONTINUE
             ELSE
      *---------- 3.2.2.4.処理対象断面決定処理
               PERFORM  SMZJ1210-RTN
             END-IF
             IF  FLG-PTF = CNS-ON
             THEN
               CONTINUE
             ELSE
      *---------- 3.2.2.5.実行状況管理明細再セット
               PERFORM  TKDYAA35-RTN
      *---------- 3.2.2.5-1.ワークポートフォリオ属性データエリア取得
               PERFORM  WK-TKPFZK01-GET-RTN
      *---------- 3.2.2.6.処理対象基準日断面別処理 ループ処理 ※「4.1処理」
               PERFORM  SR-KJN-YMD-DMN-RTN
             END-IF
             IF  FLG-PTF = CNS-ON
             THEN
               CONTINUE
             ELSE
      *---------- 3.2.2.7 ポートフォリオ終了処理へ
               PERFORM  PTF-END-RTN
             END-IF
           END-PERFORM
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象ポートフォリオ別処理、ループ"
      D             "処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TARGET-PTF-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.0.対象ポートフォリオのデータを取得
      ******************************************************************
       SCZY7200-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象ポートフォリオのデータを取得"
      D             "処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7200-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7200-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7200-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7200-ARG1
      *---------- 帳票ID
           MOVE  SPACE
             TO  REP-ID                 OF  PARM-SCZY7200-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7200-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7200-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7200-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY7200-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7200"             USING  PARM-SCZY7200-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7200)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象ポートフォリオのデータを取得"
      D             "処理 正常  ***"
      *-----------------------------------------------------------------
               MOVE  GET-KENSU          OF  PARM-SCZY7200-ARG2
                 TO  WK-GET-KENSU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SCZY7200.取得件数 =["WK-GET-KENSU"]"
      *-----------------------------------------------------------------
               IF  WK-GET-KENSU  >  ZERO
               THEN
                 CONTINUE
               ELSE
                 IF  WK-GET-KENSU  =  ZERO
                 THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M20のメッセージID
                   MOVE  CNS-MSG-E000217
                     TO  WK-MSG-ID      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '処理対象実行状況管理明細データ'
                   MOVE  CNS-TK-MOJI-60
                     TO  WK-TK-MOJI     OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ← ' '
                   MOVE  SPACE
                     TO  WK-FUND-CD     OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ← ' '
                   MOVE  SPACE
                     TO  WK-PTF-CD      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク引数情報.処理実行日
                   MOVE  WK-SYORI-YMD     OF  WK-ARG-INFO
                     TO  WK-KJN-YMD-FROM  OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク引数情報.処理実行日
                   MOVE  WK-SYORI-YMD   OF  WK-ARG-INFO
                     TO  WK-KJN-YMD-TO  OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
                   MOVE  SPACE
                     TO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
                   COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-CounterA + 1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード←'8'(業務エラー（処理中メイン続行不可）)
                   MOVE  CNS-RTN-BT8    TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 「3.3  後処理」へ
                   PERFORM  END-RTN
                 ELSE
                   INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
                   MOVE  CNS-POS-021    TO  WK-ERR-POS
                   PERFORM  ERR-MSG-RTN
                 END-IF
               END-IF
             WHEN  OTHER
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-022        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象ポートフォリオのデータを取得"
      D             "処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7200-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ
      ******************************************************************
       ERR4091-MSG-RTN        SECTION.
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
           MOVE  CNS-RTN-BT16           TO  WK-RETURN-CD
      *---------- エラー検知プログラム名
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  RTN-CD                 OF  SMZJ4091-ARG1-OUT
             TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー処理
           PERFORM  ERR-RTN
      *-----------------------------------------------------------------
           CONTINUE.
       ERR4091-MSG-EXT.
           EXIT.
      ******************************************************************
      *    抽出件数超過警告
      ******************************************************************
       KENSU-WAR-RTN          SECTION.
      *---------- ワークエラーパッケージを編集
           MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラム名
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-002            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
             TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  DETAIL-RTN-CD-FLG      OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
             TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
           MOVE  FREE-MSG               OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
             TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー処理
           PERFORM  ERR-RTN
           CONTINUE.
       KENSU-WAR-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ
      ******************************************************************
       ERR-MSG-RTN            SECTION.
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
           MOVE  CNS-RTN-BT16           TO  WK-RETURN-CD
      *---------- ワークエラーパッケージを編集
           MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラム名
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
             TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー処理
           PERFORM  ERR-RTN
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.1.ワークポートフォリオ情報へデータセット
      ******************************************************************
       WK-PTF-INFO-DATA-RTN   SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** ワークポートフォリオ情報へデータ"
      D             "セット処理  START ***"
      *-----------------------------------------------------------------
      *---------- ワーク欠落断面有無フラグを初期化する
           INITIALIZE  WK-PTF-INFO
                       WK-LACK-DMN-FLG
                       WK-PTF-SKIP-FLG                                  20110920
                       WK-SMZJ4019-FLG
      *---------- ワーク明細単位実行ステータス ← '100'(正常終了)
           MOVE  CNS-MT-JS-100          TO  WK-MT-JIKKOU-STATUS
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク引数情報.ＧＩＰＳモード=["
      D             WK-GIPS-MODE        OF  WK-ARG-INFO"]"
      D    DISPLAY  CNS-PGM-ID":実行状況管理明細データ.基準日From =["
      D             KJN-YMD-FROM      OF  PARM-SCZY7200-ARG2(WK-IDX2)"]"
      D    DISPLAY  CNS-PGM-ID":実行状況管理明細データ.基準日To =["
      D             KJN-YMD-TO        OF  PARM-SCZY7200-ARG2(WK-IDX2)"]"
      D    DISPLAY  CNS-PGM-ID":ワーク電文解析情報.指定From日 =["
      D             WK-SITEI-FROM       OF  WK-DENBUN-KAISEKI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク電文解析情報.指定To日 =["
      D             WK-SITEI-TO         OF  WK-DENBUN-KAISEKI-INFO"]"
      *-----------------------------------------------------------------
           IF  WK-GIPS-MODE             OF  WK-ARG-INFO   = CNS-X-1
           THEN
      *---------- ワーク電文解析情報.指定From日 ← 【SCZY7200】.リターンパッケージ.実行状況管理明細データ.基準日From
             MOVE  KJN-YMD-FROM         OF  PARM-SCZY7200-ARG2(WK-IDX2)
               TO  WK-SITEI-FROM        OF  WK-DENBUN-KAISEKI-INFO
      *---------- ワーク電文解析情報.指定To日 ← 【SCZY7200】.リターンパッケージ.実行状況管理明細データ.基準日To
             MOVE  KJN-YMD-TO           OF  PARM-SCZY7200-ARG2(WK-IDX2)
               TO  WK-SITEI-TO          OF  WK-DENBUN-KAISEKI-INFO
           ELSE
             CONTINUE
           END-IF
      *---------- ワーク実行状況管理明細更新フラグ(先頭セッション)
           MOVE  ZERO                   TO  WK-JH-UPD-FLG
      *---------- ワーク明細管理用基準日FROM ← ワーク電文解析情報.指定From日
           MOVE  WK-SITEI-FROM          OF  WK-DENBUN-KAISEKI-INFO
            TO   WK-MKY-KJN-YMD-FROM
      *---------- ワーク実行状況管理明細更新フラグ(先頭セッション)
           MOVE  ZERO                   TO  WK-JH-UPD-FLG
      *---------- ワークポートフォリオ情報.処理実行日 ← ワーク引数情報.処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  WK-SYORI-YMD           OF  WK-PTF-INFO
      *---------- ワークポートフォリオ情報.起動ID ← ワーク引数情報.起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  WK-KIDOU-ID            OF  WK-PTF-INFO
      *---------- ワークポートフォリオ情報.利用会社コード ← ワーク引数情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
      *---------- ワークポートフォリオ情報.ファンドコード ← 実行状況管理明細データ.ファンドコード
           MOVE  FUND-CD                OF  PARM-SCZY7200-ARG2(WK-IDX2)
             TO  WK-FUND-CD             OF  WK-PTF-INFO
      *---------- ワークポートフォリオ情報.ポートフォリオコード ← 実行状況管理明細データ.ポートフォリオコード
           MOVE  PTF-CD                 OF  PARM-SCZY7200-ARG2(WK-IDX2)
             TO  WK-PTF-CD              OF  WK-PTF-INFO
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":進捗管理なし断面の削除実行フラグ =["
      D             WK-SMZJ4019-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク電文解析情報.指定From日 =["
      D             WK-SITEI-FROM       OF  WK-DENBUN-KAISEKI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク電文解析情報.指定To日 =["
      D             WK-SITEI-TO         OF  WK-DENBUN-KAISEKI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      D             "(先頭セッション)=["WK-JH-UPD-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細管理用基準日FROM =["
      D             WK-MKY-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      D             "(先頭セッション)=["WK-JH-UPD-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報.処理実行日 =["
      D             WK-SYORI-YMD        OF  WK-PTF-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報.起動ID =["
      D             WK-KIDOU-ID         OF  WK-PTF-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報.利用会社コード"
      D             "=["WK-RIYO-CMP-CD  OF  WK-PTF-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報.ファンドコード"
      D             "=["WK-FUND-CD      OF  WK-PTF-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報."
      D             "ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-PTF-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD証券種別コード =["
      D             WK-OLD-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD国内外国区分 =["
      D             WK-OLD-NAI-GAI-KBN"]"
      D    DISPLAY  CNS-PGM-ID":*** ワークポートフォリオ情報へデータ"
      D             "セット処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       WK-PTF-INFO-DATA-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.2.取引差分更新管理ロック
      ******************************************************************
       TKMZSK00-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引差分更新管理ロック処理"
      D             " START ***"
      *-----------------------------------------------------------------
      *----------  カーソル定義処理
           PERFORM  TKMZSK00-DEC-RTN
      *----------  カーソルオープン処理
           PERFORM  TKMZSK00-OPEN-RTN
           IF  WK-JH-UPD-FLG = CNS-1
           THEN
             CONTINUE
           ELSE
      *----------  取引差分更新管理 FETCH 処理
             PERFORM  TKMZSK00-FET-RTN
      *----------  取引差分更新管理 CURSOR CLOSE 処理
      *      PERFORM  TKMZSK00-CLOSE-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引差分更新管理ロック処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSK00-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKMZSK00-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  H-RIYO-CMP-CD          OF  H-TKMZSK00-S,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  H-FUND-CD              OF  H-TKMZSK00-S,
                 WK-FUND-CD-S           OF  WK-MSG-1-1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  H-PTF-CD               OF  H-TKMZSK00-S,
                 WK-PTF-CD-S            OF  WK-MSG-1-1
      *---------- テーブルID
           MOVE  WK-TBL-TKMZSK00
             TO  SQL-TKMZSK00           OF  SQL-SELECT-1-1,
                 WK-TKMZSK00            OF  WK-MSG-1-1
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZSK00-S"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZSK00-S"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             H-PTF-CD            OF  H-TKMZSK00-S"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT1                                         @3212SEINO@@
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-1         TO  SQLSTMT1                    @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT1=["SQLSTMT1"]"                  @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMZSK00-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZSK00-CR-OPEN  NOT = CNS-ON                       @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
               PREPARE  S1  FROM :SQLSTMT1                              @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-023          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-1         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-6-RTN
      *---------- Cポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
           EXEC  SQL  DECLARE  TKMZSK00_CURSOR  CURSOR  FOR  S1 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSK00-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKMZSK00-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKMZSK00_CURSOR
                 USING :H-TKMZSK00-S.H-RIYO-CMP-CD,
                       :H-TKMZSK00-S.H-FUND-CD,
                       :H-TKMZSK00-S.H-PTF-CD
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               MOVE  CNS-ON             TO  FLG-TKMZSK00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-OPEN=["
      D             FLG-TKMZSK00-CR-OPEN"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-LOCK
               MOVE  CNS-ON             TO  FLG-TKMZSK00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-OPEN=["
      D             FLG-TKMZSK00-CR-OPEN"]"
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M12のメッセージID
               MOVE  CNS-MSG-W000522
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
               MOVE  SPACE
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M03-FREE-AREA-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT2
               THEN
                 MOVE  CNS-RTN-BT2      TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
               IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
               THEN
                 MOVE  CNS-MT-JS-200        TO  WK-MT-JIKKOU-STATUS
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               MOVE  CNS-1  TO  WK-JH-UPD-FLG
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      D                       "(先頭セッション) =["WK-JH-UPD-FLG"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-024        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-6-RTN
               MOVE  CNS-1  TO  WK-JH-UPD-FLG
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      D                       "(先頭セッション) =["WK-JH-UPD-FLG"]"
      *-----------------------------------------------------------------
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSK00-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    取引差分更新管理 FETCH 処理
      ******************************************************************
       TKMZSK00-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引差分更新管理 FETCH 処理 "
      D             "START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMZSK00-1
           EXEC  SQL
               FETCH
                    TKMZSK00_CURSOR
               INTO :H-TKMZSK00-1
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               CONTINUE
             WHEN  CNS-SQL-LOCK
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M12のメッセージID
               MOVE  CNS-MSG-W000522
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
               MOVE  SPACE
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M03-FREE-AREA-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT2
               THEN
                 MOVE  CNS-RTN-BT2      TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
               IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
               THEN
                 MOVE  CNS-MT-JS-200        TO  WK-MT-JIKKOU-STATUS
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               MOVE  CNS-1  TO  WK-JH-UPD-FLG
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      D                       "(先頭セッション) =["WK-JH-UPD-FLG"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
               CONTINUE
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
               MOVE  CNS-POS-025        TO  WK-ERR-POS
               MOVE  CNS-RTN-900        TO  WK-RTN-CD
               MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
               MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-INFO-ADD-RTN
      *---------- ワーク明細単位実行ステータス
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               MOVE  CNS-1  TO  WK-JH-UPD-FLG
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      D                       "(先頭セッション) =["WK-JH-UPD-FLG"]"
      *-----------------------------------------------------------------
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引差分更新管理 FETCH 処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSK00-FET-EXT.
           EXIT.
      ******************************************************************
      *    取引差分更新管理 CURSOR CLOSE 処理
      ******************************************************************
      * TKMZSK00-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***取引差分更新管理 CURSOR CLOSE "
      *D             "処理 START ***"
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-OPEN=["
      *D             FLG-TKMZSK00-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *         CLOSE TKMZSK00_CURSOR
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQLCODE(CLOSE)   =[" SQLCODE "]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *       MOVE  CNS-OFF              TO  FLG-TKMZSK00-CR-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-OPEN=["
      *D             FLG-TKMZSK00-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     ELSE
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *       MOVE  CNS-POS-026          TO  WK-ERR-POS
      *       MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-1         DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      **---------- エラー情報追加処理
      *       PERFORM  ERR-INFO-ADD-RTN
      **---------- ワーク明細単位実行ステータス
      *       MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      **---------- ワークリターンコード
      *       MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      **--------------------<DEBUG>-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      *D             WK-MT-JIKKOU-STATUS"]"
      *D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      **-----------------------------------------------------------------
      *       MOVE  CNS-1  TO  WK-JH-UPD-FLG
      **--------------------<DEBUG>-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      *D                       "(先頭セッション) =["WK-JH-UPD-FLG"]"
      **-----------------------------------------------------------------
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":*** 取引差分更新管理 CURSOR CLOSE "
      *D             "処理 END  ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZSK00-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    1)実行状況管理明細に更新処理（「別紙1-18 SQL説明）
      ******************************************************************
       UPDATE-TKDYAA35-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細に更新処理"
      D             "(別紙1-18)START ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKDYAA35-UPDATE-2
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  H-RIYO-CMP-CD          OF  H-TKDYAA35-UPDATE-2,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-18
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  H-SYORI-YMD            OF  H-TKDYAA35-UPDATE-2,
                 WK-SYORI-YMD-S         OF  WK-MSG-1-18
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  H-KIDOU-ID             OF  H-TKDYAA35-UPDATE-2,
                 WK-KIDOU-ID-S          OF  WK-MSG-1-18
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  H-FUND-CD              OF  H-TKDYAA35-UPDATE-2,
                 WK-FUND-CD-S           OF  WK-MSG-1-18
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  H-PTF-CD               OF  H-TKDYAA35-UPDATE-2,
                 WK-PTF-CD-S            OF  WK-MSG-1-18
      *---------- 評価系列コード
           MOVE  SPACE
             TO  H-HYK-KRTU-CD          OF  H-TKDYAA35-UPDATE-2
      *---------- 帳票ID
           MOVE  SPACE
             TO  H-REP-ID               OF  H-TKDYAA35-UPDATE-2
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  H-REP-ANY-CD           OF  H-TKDYAA35-UPDATE-2
      *---------- テーブルID
           MOVE  WK-TBL-TKDYAA35
             TO  SQL-TKDYAA35           OF  SQL-UPDATE-1-18,
                 WK-TKDYAA35            OF  WK-MSG-1-18
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             H-RIYO-CMP-CD       OF  H-TKDYAA35-UPDATE-2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日    =["
      D             H-SYORI-YMD         OF  H-TKDYAA35-UPDATE-2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID        =["
      D             H-KIDOU-ID          OF  H-TKDYAA35-UPDATE-2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             H-FUND-CD           OF  H-TKDYAA35-UPDATE-2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             H-PTF-CD            OF  H-TKDYAA35-UPDATE-2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             H-HYK-KRTU-CD       OF  H-TKDYAA35-UPDATE-2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID  =["
      D             H-REP-ID            OF  H-TKDYAA35-UPDATE-2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード  =["
      D             H-REP-ANY-CD        OF  H-TKDYAA35-UPDATE-2"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT18                                        @3212SEINO@@
      *----ＳＱＬ文
           MOVE  SQL-UPDATE-1-18         TO  SQLSTMT18                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT18=["SQLSTMT18"]"                @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-1=["FLG-OPEN-FLG-1"]"      @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-OPEN-FLG-1  NOT = CNS-ON                             @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC SQL
               PREPARE  S18 FROM :SQLSTMT18                             @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-027          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MSG-1-18        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *-----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Cポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
           EXEC SQL
               EXECUTE S18
                 USING :H-TKDYAA35-UPDATE-2
           END-EXEC
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-UPDATE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
      *---------- ワーク明細管理用基準日FROM ← 0
             MOVE  ZERO                 TO  WK-MKY-KJN-YMD-FROM
             MOVE  CNS-ON               TO  FLG-OPEN-FLG-1              @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細管理用基準日FROM =["
      D             WK-MKY-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-1=["FLG-OPEN-FLG-1"]"      @3212SEINO@@
      *-----------------------------------------------------------------
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（UPDATE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-028          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MSG-1-18        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *-----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Cポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  実行状況管理明細に更新処理"
      D             "(別紙1-18)END  ****"
      *-----------------------------------------------------------------
           CONTINUE.
       UPDATE-TKDYAA35-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.3.実行状況管理明細更新(先頭セッション)
      ******************************************************************
       SCZY7210-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新"
      D             "(先頭セッション) START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7210-INOUT
                       PARM-RTNPKG
      *---------- セッション区分
           MOVE  CNS-SESSION-KBN-0
             TO  SESSION-KBN            OF  PARM-SCZY7210-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7210-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7210-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7210-ARG2
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  FUND-CD                OF  PARM-SCZY7210-ARG2
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  PTF-CD                 OF  PARM-SCZY7210-ARG2
      *---------- 評価系列コード
           MOVE  SPACE
             TO  HYK-KRTU-CD            OF  PARM-SCZY7210-ARG2
      *---------- 帳票ID
           MOVE  SPACE
             TO  REP-ID                 OF  PARM-SCZY7210-ARG2
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  REP-ANY-CD             OF  PARM-SCZY7210-ARG2
      *---------- 基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  KJN-YMD-FROM           OF  PARM-SCZY7210-ARG2
      *---------- 実行ステータス
           MOVE  SPACE
             TO  JIKOU-STS              OF  PARM-SCZY7210-ARG2
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分  =["
      D             SESSION-KBN         OF  PARM-SCZY7210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日   =["
      D             SYORI-YMD           OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID   =["
      D             KIDOU-ID            OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード   =["
      D             FUND-CD             OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード  =["
      D             HYK-KRTU-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID  =["
      D             REP-ID              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード =["
      D             REP-ANY-CD          OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM =["
      D             KJN-YMD-FROM        OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":実行ステータス =["
      D             JIKOU-STS           OF  PARM-SCZY7210-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7210"             USING  PARM-SCZY7210-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":続行可能区分 =["
      D             CONTINUE-KBN        OF  PARM-SCZY7210-ARG3"]"
      *-----------------------------------------------------------------
             EVALUATE  CONTINUE-KBN     OF  PARM-SCZY7210-ARG3
               WHEN  CNS-CONTINUE-KBN-0
      *---------- コミット処理
                 PERFORM  DB-COMMIT-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク実行状況管理明細更新フラグ"
      D                       "(先頭セッション) =["WK-JH-UPD-FLG"]"
      *-----------------------------------------------------------------
                 IF  WK-JH-UPD-FLG  =  CNS-1
                 THEN
      *---------- ポートフォリオ終了処理へ
                   PERFORM  PTF-END-RTN
                 ELSE
                   CONTINUE
                 END-IF
               WHEN  CNS-CONTINUE-KBN-3
      *---------- ワーク更新区分 ← '0'
                 MOVE  CNS-UPDATE-KBN-0 TO  WK-UPDATE-KBN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新区分=["WK-UPDATE-KBN"]"
      *-----------------------------------------------------------------
      *---------- ポートフォリオ終了処理へ
                 PERFORM  PTF-END-RTN
               WHEN  OTHER
                 EVALUATE  CONTINUE-KBN     OF  PARM-SCZY7210-ARG3
                   WHEN  CNS-CONTINUE-KBN-1
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M18のメッセージID
                     MOVE  CNS-MSG-E000451
                       TO  WK-MSG-ID    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
                     MOVE  SPACE
                       TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,1)
                     PERFORM  M03-FREE-AREA-RTN
      *---------- ワークリターンコード
                     MOVE  CNS-RTN-BT10 TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
                   WHEN  CNS-CONTINUE-KBN-2
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M19のメッセージID
                     MOVE  CNS-MSG-E000431
                       TO  WK-MSG-ID    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
                     MOVE  SPACE
                       TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,1)
                     PERFORM  M03-FREE-AREA-RTN
      *---------- ワークリターンコード
                     MOVE  CNS-RTN-BT10  TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
                   WHEN  OTHER
                     CONTINUE
                 END-EVALUATE
      *---------- B3.3  後処理へ
                 PERFORM  END-RTN
             END-EVALUATE
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-029          TO  WK-ERR-POS
             PERFORM  ERR-MSG-5-RTN
      *---------- Dポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新"
      D             "(先頭セッション)  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7210-EXT.
           EXIT.
      ******************************************************************
      *    ＤＢコミット処理
      ******************************************************************
       DB-COMMIT-RTN          SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ＤＢコミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢコミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢコミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-030          TO  WK-ERR-POS
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-3-RTN
      *---------- Dポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ＤＢコミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-COMMIT-EXT.
           EXIT.
      ******************************************************************
      *    @ ワークメッセージエリアへインサート
      ******************************************************************
       M03-FREE-AREA-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *-----------------------------------------------------------------
           CONTINUE.
       M03-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *    エラー1情報追加処理
      ******************************************************************
       ERR-INFO-ADD-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  エラー1情報追加処理  START  ***"
      *-----------------------------------------------------------------
           MOVE  CNS-ON                 TO  FLG-SYSTEM-ERR
      *---------- エラーリターンパッケージ
           INITIALIZE  PARM-SCZY1170-IN
           MOVE  WK-SYS-ERR-INFO        TO  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名 =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SCZY1170-ARG1 =["
      D             PARM-SCZY1170-ARG1                        "]"
      *-----------------------------------------------------------------
           CALL  "SCZY1170"             USING  PARM-SCZY1170-IN
                                               PARM-SCZY1170-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  エラー1情報追加処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-INFO-ADD-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.4.処理対象断面決定処理
      ******************************************************************
       SMZJ1210-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  処理対象断面決定処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1210-INOUT
                       PARM-RTNPKG
      *---------- ワーク処理フラグ
           MOVE  ZERO                   TO  WK-SYORI-FLG
      *---------- 指定From日
           MOVE  WK-SITEI-FROM          OF  WK-DENBUN-KAISEKI-INFO
             TO  SITEI-FROM             OF  PARM-SMZJ1210-ARG1
      *---------- 指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  SITEI-TO               OF  PARM-SMZJ1210-ARG1
      *---------- 強制計算区分
           MOVE  WK-KYOSE-CALC-KBN      OF  WK-DENBUN-KAISEKI-INFO
             TO  KYOSE-CALC-KBN         OF  PARM-SMZJ1210-ARG1
      *---------- 対象ポートフォリオ
           MOVE  WK-PTF-INFO
             TO  OBJ-PTF-PARM           OF  PARM-SMZJ1210-ARG1
      *----------  勘定異動／残高作成
           MOVE  I-KJIDO-ZANSK          OF  WK-DENBUN-IN
             TO  KJIDO-ZANSK            OF  PARM-SMZJ1210-ARG1
      *---------- ＧＩＰＳモード
           MOVE  WK-GIPS-MODE           OF  WK-ARG-INFO
             TO  GIPS-MODE              OF  PARM-SMZJ1210-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク処理フラグ =["WK-SYORI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":指定From日 =["
      D             SITEI-FROM          OF  PARM-SMZJ1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":指定To日=["
      D             SITEI-TO            OF  PARM-SMZJ1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":強制計算区分 =["
      D             KYOSE-CALC-KBN      OF  PARM-SMZJ1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象ポートフォリオ =["
      D             OBJ-PTF-PARM        OF  PARM-SMZJ1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":勘定異動／残高作成  =["
      D             KJIDO-ZANSK         OF  PARM-SMZJ1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ＧＩＰＳモード  =["
      D             GIPS-MODE           OF  PARM-SMZJ1210-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1210"             USING  PARM-SMZJ1210-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
      *---------- ワークポートフォリオ情報.締め日 ← リターンパッケージ.締め日
               MOVE  SHIME-YMD          OF  PARM-SMZJ1210-ARG3
                 TO  WK-SHIME-YMD       OF  WK-PTF-INFO
      *---------- ワークポートフォリオ情報.計算From日 ← リターンパッケージ.計算From日
               MOVE  CALC-FROM          OF  PARM-SMZJ1210-ARG3
                 TO  WK-CALC-FROM       OF  WK-PTF-INFO
      *---------- ワーク処理フラグ ← リターンパッケージ.処理フラグ
               MOVE  SYORI-FLG          OF  PARM-SMZJ1210-ARG3
                 TO  WK-SYORI-FLG
      *---------- ワーク削除用元1210情報パッケージ ← リターンパッケージ.削除用元1210情報パッケージ
               MOVE  DEL-1210-PACKAGE   OF  PARM-SMZJ1210-ARG3
                 TO  WK-DEL-1210-PACKAGE
      *---------- 進捗管理なし断面の削除実行フラグ ← '1'
               MOVE  CNS-ON             TO  WK-SMZJ4019-FLG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報.締め日 =["
      D             WK-SHIME-YMD        OF  WK-PTF-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報.計算From日 =["
      D             WK-CALC-FROM        OF  WK-PTF-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク処理フラグ =["WK-SYORI-FLG"]"
      *    DISPLAY  CNS-PGM-ID":ワーク削除用元1210情報パッケージ =["
      D             WK-DEL-1210-PACKAGE"]"
      D    DISPLAY  CNS-PGM-ID":進捗管理なし断面の削除実行フラグ =["
      D             WK-SMZJ4019-FLG"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-113
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M08のメッセージID
               MOVE  CNS-MSG-E000429
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- 'ポートフォリオの対象履歴'
               MOVE  CNS-TK-MOJI-71
                 TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M03-FREE-AREA-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
               IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-275
               THEN
                 MOVE  CNS-MT-JS-275    TO  WK-MT-JIKKOU-STATUS
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT6
               THEN
                 MOVE  CNS-RTN-BT6      TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Dポートフォリオ終了処理へ
               PERFORM  PTF-END-RTN
             WHEN  CNS-RTN-100
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M43のメッセージID
               MOVE  CNS-MSG-E000430
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '処理対象断面期間'
               MOVE  CNS-TK-MOJI-83
                 TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←
      *---------- '13ヶ月'
               MOVE  CNS-TK-MOJI-84
                 TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,2)
               PERFORM  M03-FREE-AREA-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
               IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-275
               THEN
                 MOVE  CNS-MT-JS-275    TO  WK-MT-JIKKOU-STATUS
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT6
               THEN
                 MOVE  CNS-RTN-BT6      TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Dポートフォリオ終了処理へ
               PERFORM  PTF-END-RTN
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ワークエラーパッケージを編集
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- ポジション
               MOVE  CNS-POS-031        TO  WK-ERR-POS
      *---------- リターンコード
               MOVE  CNS-RTN-901        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  RTN-CD             OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
                 TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-INFO-ADD-RTN
      *---------- ワーク明細単位実行ステータス
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Dポートフォリオ終了処理へ
               PERFORM  PTF-END-RTN
           END-EVALUATE
           IF  FLG-PTF = CNS-ON
           THEN
             CONTINUE
           ELSE
      *---------- 3)締めチェック Aワーク電文解析情報.指定From日≠0 AND
      *---------- ワークポートフォリオ情報.計算From日＞ワーク電文解析情報.指定From日
             PERFORM  SITEI-FROM-RTN
      *---------- 4)警告処理 @リターンパッケージ.警告フラグ＝'D2'の場合
             PERFORM  WARN-1-RTN
           END-IF
           IF  FLG-PTF = CNS-ON
           THEN
             CONTINUE
           ELSE
      *---------- 4)警告処理 Aリターンパッケージ.警告フラグ＝'D3'の場合
             PERFORM  WARN-2-RTN
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  処理対象断面決定処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1210-EXT.
           EXIT.
      ******************************************************************
      *    3) A 締めチェック
      ******************************************************************
       SITEI-FROM-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文解析情報.指定From日 =["
      D             WK-SITEI-FROM       OF  WK-DENBUN-KAISEKI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ情報.計算From日 =["
      D             WK-CALC-FROM        OF  WK-PTF-INFO"]"
      *-----------------------------------------------------------------
      *---------- Aワーク電文解析情報.指定From日≠0 AND
      *---------- ワークポートフォリオ情報.計算From日＞ワーク電文解析情報.指定From日
           IF  (WK-SITEI-FROM  OF  WK-DENBUN-KAISEKI-INFO  NOT = ZERO)
           AND (WK-CALC-FROM   OF  WK-PTF-INFO >
                WK-SITEI-FROM  OF  WK-DENBUN-KAISEKI-INFO)
           THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '一部'
             MOVE  CNS-TK-MOJI-5
               TO  WK-TK-MOJI           OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M04のメッセージID
             MOVE  CNS-MSG-W000412
               TO  WK-MSG-ID            OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
             MOVE  WK-FUND-CD           OF  WK-PTF-INFO
               TO  WK-FUND-CD           OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
             MOVE  WK-PTF-CD            OF  WK-PTF-INFO
               TO  WK-PTF-CD            OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
             MOVE  WK-MKY-KJN-YMD-FROM
               TO  WK-KJN-YMD-FROM      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
             MOVE  WK-SITEI-TO          OF  WK-DENBUN-KAISEKI-INFO
               TO  WK-KJN-YMD-TO        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
             MOVE  SPACE
               TO  WK-FREE-MSG          OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
             COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
             THEN
               MOVE  CNS-MT-JS-200    TO  WK-MT-JIKKOU-STATUS
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT2
             THEN
               MOVE  CNS-RTN-BT2      TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       SITEI-FROM-EXT.
           EXIT.
      ******************************************************************
      *    4)警告処理 @リターンパッケージ.警告フラグ＝'D2'の場合
      ******************************************************************
       WARN-1-RTN             SECTION.
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ =["
      D             WARN-FLG            OF  PARM-SMZJ1210-ARG3"]"
      *-----------------------------------------------------------------
      *---------- @リターンパッケージ.警告フラグ＝'D2'の場合
           IF  WARN-FLG  OF  PARM-SMZJ1210-ARG3 = CNS-D2
           THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ''
             MOVE  SPACE
               TO  WK-TK-MOJI           OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M04のメッセージID
             MOVE  CNS-MSG-W000412
               TO  WK-MSG-ID            OF  WK-MSG-AREA(WK-CounterA)
             PERFORM  M04-FREE-AREA-RTN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       WARN-1-EXT.
           EXIT.
      ******************************************************************
      *    4)警告処理 Aリターンパッケージ.警告フラグ＝'D1'の場合
      ******************************************************************
       WARN-2-RTN             SECTION.
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ =["
      D             WARN-FLG            OF  PARM-SMZJ1210-ARG3"]"
      *-----------------------------------------------------------------
      *---------- @リターンパッケージ.警告フラグ＝'D3'の場合
           IF  WARN-FLG  OF  PARM-SMZJ1210-ARG3 = CNS-D3
           THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '開始基準日翌日'
             MOVE  KAISI-KJN-YMD-NEXT  OF  PARM-SMZJ1210-ARG3
               TO  WK-TK-MOJI           OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M07のメッセージID
             MOVE  CNS-MSG-W000669
               TO  WK-MSG-ID            OF  WK-MSG-AREA(WK-CounterA)
             PERFORM  M04-FREE-AREA-RTN
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       WARN-2-EXT.
           EXIT.
      ******************************************************************
      *    @ ワークメッセージエリアへインサート
      ******************************************************************
       M04-FREE-AREA-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ''
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
           THEN
             MOVE  CNS-MT-JS-200        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT2
           THEN
             MOVE  CNS-RTN-BT2          TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           CONTINUE.
       M04-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.5.実行状況管理明細再セット
      ******************************************************************
       TKDYAA35-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細再セット処理 "
      D             " START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク電文解析情報.指定From日 =["
      D             WK-SITEI-FROM       OF  WK-DENBUN-KAISEKI-INFO"]"
      *-----------------------------------------------------------------
           IF  WK-SITEI-FROM       OF  WK-DENBUN-KAISEKI-INFO  =  ZERO
           THEN
      *---------- 1)実行状況管理明細に更新処理
             PERFORM  TKDYAA35-UPDATE-RTN
      *---------- 2)コミットする
             PERFORM  DB-COMMIT-RTN
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細再セット処理  "
      D             "END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKDYAA35-EXT.
           EXIT.
      ******************************************************************
      *    1)実行状況管理明細に更新処理
      ******************************************************************
       TKDYAA35-UPDATE-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細に更新処理"
      D             "  START ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKDYAA35-UPDATE
      *---------- ワークポートフォリオ情報.計算From日
           MOVE  WK-CALC-FROM           OF  WK-PTF-INFO
             TO  H-CALC-FROM            OF  H-TKDYAA35-UPDATE,
                 WK-KJN-YMD-FROM        OF  WK-MSG-1-7
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  H-RIYO-CMP-CD          OF  H-TKDYAA35-UPDATE,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-7
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  H-SYORI-YMD            OF  H-TKDYAA35-UPDATE,
                 WK-SYORI-YMD-S         OF  WK-MSG-1-7
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  H-KIDOU-ID             OF  H-TKDYAA35-UPDATE,
                 WK-KIDOU-ID-S          OF  WK-MSG-1-7
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  H-FUND-CD              OF  H-TKDYAA35-UPDATE,
                 WK-FUND-CD-S           OF  WK-MSG-1-7
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  H-PTF-CD               OF  H-TKDYAA35-UPDATE,
                 WK-PTF-CD-S            OF  WK-MSG-1-7
      *---------- 評価系列コード
           MOVE  SPACE
             TO  H-HYK-KRTU-CD          OF  H-TKDYAA35-UPDATE
      *---------- 帳票ID
           MOVE  SPACE
             TO  H-REP-ID               OF  H-TKDYAA35-UPDATE
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  H-REP-ANY-CD           OF  H-TKDYAA35-UPDATE
      *---------- 基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  H-KJN-YMD-FROM         OF  H-TKDYAA35-UPDATE,
                 WK-KJN-YMD-FROM-S      OF  WK-MSG-1-7
      *---------- テーブルID
           MOVE  WK-TBL-TKDYAA35
             TO  SQL-TKDYAA35           OF  SQL-UPDATE-1-7,
                 WK-TKDYAA35            OF  WK-MSG-1-7
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":計算From日 =["
      D             H-CALC-FROM         OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             H-RIYO-CMP-CD       OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日    =["
      D             H-SYORI-YMD         OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":起動ID        =["
      D             H-KIDOU-ID          OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             H-FUND-CD           OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             H-PTF-CD            OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             H-HYK-KRTU-CD       OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID  =["
      D             H-REP-ID            OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード  =["
      D             H-REP-ANY-CD        OF  H-TKDYAA35-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM  =["
      D             H-KJN-YMD-FROM      OF  H-TKDYAA35-UPDATE"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT7                                         @3212SEINO@@
      *----ＳＱＬ文
           MOVE  SQL-UPDATE-1-7         TO  SQLSTMT7                    @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT7=["SQLSTMT7"]"                  @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-3=["FLG-OPEN-FLG-3"]"      @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-OPEN-FLG-3  NOT = CNS-ON                             @3212SEINO@@
           THEN
           EXEC SQL
               PREPARE  S7  FROM :SQLSTMT7                              @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-032          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MSG-1-7         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *-----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Cポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
           EXEC SQL
               EXECUTE S7
                 USING :H-TKDYAA35-UPDATE
           END-EXEC
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-UPDATE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
      *---------- ワーク明細管理用基準日FROM ← ワークポートフォリオ情報.計算From日
             MOVE  WK-CALC-FROM         OF  WK-PTF-INFO
               TO  WK-MKY-KJN-YMD-FROM
             MOVE  CNS-ON               TO  FLG-OPEN-FLG-3              @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細管理用基準日FROM =["
      D             WK-MKY-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-3=["FLG-OPEN-FLG-3"]"      @3212SEINO@@
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-033          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MSG-1-7         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Cポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":****  実行状況管理明細に更新処理"
      D             "  END  ****"
      *-----------------------------------------------------------------
           CONTINUE.
       TKDYAA35-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.5-1.ワークポートフォリオ属性データエリア取得
      ******************************************************************
       WK-TKPFZK01-GET-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":***ワークポートフォリオ属性データエリア取得 処理 START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4313-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY4313-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  FUND-CD                OF  PARM-SCZY4313-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  PTF-CD                 OF  PARM-SCZY4313-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード        =["
      D             RIYO-CMP-CD         OF  PARM-SCZY4313-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード        =["
      D             FUND-CD             OF  PARM-SCZY4313-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード  =["
      D             PTF-CD              OF  PARM-SCZY4313-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4313"             USING  PARM-SCZY4313-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4313)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               MOVE  PARM-SCZY4313-ARG2 TO  WK-TBL-TKPFZK01-AREA
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワークポートフォリオ属性データエリア取得  正常"
      *    DISPLAY  CNS-PGM-ID":ワークポートフォリオ属性データエリア=["
      *                         WK-TBL-TKPFZK01-AREA"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-110
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワークポートフォリオ属性データエリア取得  データなし"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  CNS-RTN-002
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":ワークポートフォリオ属性データエリア取得  抽出件数超過警告"
      *-----------------------------------------------------------------
      *---------- ポジション
               MOVE  CNS-POS-157        TO  WK-ERR-POS
               PERFORM  KENSU-WAR-RTN
             WHEN  OTHER
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D      ":ワークポートフォリオ属性データエリア取得  エラー"
      *-----------------------------------------------------------------
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-158        TO  WK-ERR-POS
               PERFORM  ERR-MSG-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D    ":*** ワークポートフォリオ属性データエリア取得 処理 END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       WK-TKPFZK01-GET-EXT.
           EXIT.
      ******************************************************************
      *    3.2.2.6.処理対象基準日断面別処理 ループ処理
      ******************************************************************
       SR-KJN-YMD-DMN-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  処理対象基準日断面別処理 ループ"
      D             "処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":4.1.0.初期化"
      *-----------------------------------------------------------------
      *---------- 4.1.0.初期化
      *---------- CNT-IDX
      *---------- ワーク区間件数
      *---------- ワーク合計件数
      *---------- 基準日断面情報情報ホスト表
           INITIALIZE  WK-CNT-IDX
                       WK-GOUKEI-KENSUU
                       WK-KUKAN-KENSUU
                       WK-TBL-TKMZBW02-AREA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク区間件数=["WK-KUKAN-KENSUU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク合計件数=["WK-GOUKEI-KENSUU"]"
      D    DISPLAY  CNS-PGM-ID":CNT-IDX=["WK-CNT-IDX"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報情報ホスト表=["
      D                         WK-TBL-TKMZBW02-AREA"]"
      *-----------------------------------------------------------------
      *---------- 4.1.1.基準日断面情報データを取得
           PERFORM  TKMZBW02-GET-RTN
           MOVE  CNS-OFF                TO  FLG-FETCH-SYUURYOU
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU=["
      D             FLG-FETCH-SYUURYOU"]"
      *-----------------------------------------------------------------
      *---------- 4.1.2.基準日断面情報データカーソルフェッチして
           PERFORM  UNTIL  FLG-FETCH-SYUURYOU = CNS-ON
                       OR  FLG-PTF = CNS-ON
             PERFORM  TKMZBW02-FET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク区間件数=["  WK-KUKAN-KENSUU"]"
      *-----------------------------------------------------------------
             PERFORM  VARYING  WK-CNT-IDX  FROM CNS-1 BY CNS-1
               UNTIL  WK-CNT-IDX  > WK-KUKAN-KENSUU
                  OR  FLG-PTF = CNS-ON
      *---------- 1) ワーク基準日断面情報を初期化する
               INITIALIZE  WK-TKMZBW02
                           WK-REDO-KJN-YMD-FROM
      *---------- ワーク基準日断面情報.進捗ステータス(基準日) ← '100'(正常終了)
               MOVE  CNS-KJN-YMD-100
                 TO  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *---------- ワークOLD証券種別コード ← オールスペース
               MOVE  SPACE              TO  WK-OLD-SEC-SBT-CD
      *---------- ワークOLD国内外国区分 ← オールスペース
               MOVE  SPACE              TO  WK-OLD-NAI-GAI-KBN
      *---------- ワーク通貨デフォールト端数.運用通貨小数点以下桁数を初期化す
      *---------- ワーク通貨デフォールト端数.運用通貨端数処理方法を初期化する
      *---------- ワークポートフォリオ実行スキップフラグを初期化
               INITIALIZE  WK-LC-ST-KETASU OF WK-TUKA-DEF-HASU-SYRI-PARM
                           WK-LC-HS        OF WK-TUKA-DEF-HASU-SYRI-PARM
      *                    WK-PTF-SKIP-FLG                              20110920
                           WK-PTF-STOP-FLG
      *---------- 2)  ワーク基準日断面情報.処理実行日 ← ワークポートフォリオ情報.処理実行日
               MOVE  WK-SYORI-YMD       OF  WK-PTF-INFO
                 TO  WK-SYORI-YMD       OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.起動ID ← ワークポートフォリオ情報.起動ID
               MOVE  WK-KIDOU-ID        OF  WK-PTF-INFO
                 TO  WK-KIDOU-ID        OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.利用会社コード ← ワークポートフォリオ情報.利用会社コード
               MOVE  WK-RIYO-CMP-CD     OF  WK-PTF-INFO
                 TO  WK-RIYO-CMP-CD     OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.ファンドコード ← ワークポートフォリオ情報.ファンドコード
               MOVE  WK-FUND-CD         OF  WK-PTF-INFO
                 TO  WK-FUND-CD         OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.ポートフォリオコード ← ワークポートフォリオ情報.ポートフォリオコード
               MOVE  WK-PTF-CD          OF  WK-PTF-INFO
                 TO  WK-PTF-CD          OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.基準日 ← 基準日断面情報情報ホスト表[CNT-IDX].基準日
               MOVE  WK-KJN-YMD
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-KJN-YMD         OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.順番 ← 基準日断面情報情報ホスト表[CNT-IDX].順番
               MOVE  WK-JUNBAN
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-JUNBAN          OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.開始基準日 ← 基準日断面情報情報ホスト表[CNT-IDX].開始基準日
               MOVE  WK-KAISI-KJN-YMD
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-KAISI-KJN-YMD   OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.開始基準日の翌日 ← 基準日断面情報情報ホスト表[CNT-IDX].開始基準日の翌日
               MOVE  WK-KAISI-KJN-YMD-NEXT
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-KAISI-KJN-YMD-NEXT
                                        OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.基準日種類 ← 基準日断面情報情報ホスト表[CNT-IDX].基準日種類
               MOVE  WK-KJN-YMD-SHRU
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-KJN-YMD-SHRU    OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.基準日断面作成区分 ← 基準日断面情報情報ホスト表[CNT-IDX].基準日断面作成区分
               MOVE  WK-KJN-YMD-DMN-SK-KBN
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-KJN-YMD-DMN-SK-KBN
                                        OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.計算パターン ← 基準日断面情報情報ホスト表[CNT-IDX].計算パターン
               MOVE  WK-CALC-PTN
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-CALC-PTN        OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.仕訳基準パターンコード ← 基準日断面情報情報ホスト表[CNT-IDX].仕訳基準パターンコード
               MOVE  WK-SWK-KJN-PTN-CD
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-SWK-KJN-PTN-CD  OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.基本会計ベースフラグ ← 基準日断面情報情報ホスト表[CNT-IDX].基本会計ベースフラグ
               MOVE  WK-KH-KAIKEI-BASE-FLG
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.測定基準区分 ← 基準日断面情報情報ホスト表[CNT-IDX].測定基準区分
               MOVE  WK-ST-KJN-KBN
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-ST-KJN-KBN      OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.異動計算パターンコード ← 基準日断面情報情報ホスト表[CNT-IDX].異動計算パターンコード
               MOVE  WK-IDO-CALC-PATTERN-CD
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-IDO-CALC-PATTERN-CD
                                        OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.保有目的 ← 基準日断面情報情報ホスト表[CNT-IDX].保有目的
               MOVE  WK-POSSESSION-OBJECT
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-POSSESSION-OBJ  OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.運用通貨コード ← 基準日断面情報情報ホスト表[CNT-IDX].運用通貨コード
               MOVE  WK-CAPITAL-TUKA-CD
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-CAPITAL-TUKA-CD OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.日次評価法フラグ ← 基準日断面情報情報ホスト表[CNT-IDX].日次評価法フラグ
               MOVE  WK-NITIJI-HYK-FLG
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-NITIJI-HYK-FLG  OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.料率パターンコード ← 基準日断面情報情報ホスト表[CNT-IDX].料率パターンコード
               MOVE  WK-COMMISSION-PATTERN
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-COMMISSION-PATTERN
                                        OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.約定主義会計フラグ ← 基準日断面情報情報ホスト表[CNT-IDX].約定主義会計フラグ
               MOVE  WK-YKJ-SYUGI-KAIKEI
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-YKJ-SYUGI-KAIKEI
                                        OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.キャッシュフロー２回発生区分 ← 基準日断面情報情報ホスト表[CNT-IDX].キャッシュフロー２回発生区分
               MOVE  WK-CASH-FLOW-KBN
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-CASH-FLOW-KBN   OF  WK-TKMZBW02
      *---------- ワーク基準日断面情報.約定レートコード← 基準日断面情報情報ホスト表[CNT-IDX].約定レートコード
               MOVE  WK-YKJ-RATE-CD
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-YKJ-RATE-CD     OF  WK-TKMZBW02
      *---------- ワーク再処理基準日FROM← 基準日断面情報情報ホスト表[CNT-IDX].基準日
               MOVE  WK-KJN-YMD
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-REDO-KJN-YMD-FROM
      *---------- ワーク基準日断面情報.未収配当計上割合← 基準日断面情報情報ホスト表[CNT-IDX].未収配当計上割合
               MOVE  WK-MISYU-HAITOU-WARIAI
                 OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                 TO  WK-MISYU-HAITOU-WARIAI     OF  WK-TKMZBW02
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "(基準日)=["WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD証券種別コード =["
      D             WK-OLD-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD国内外国区分 =["
      D             WK-OLD-NAI-GAI-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "運用通貨小数点以下桁数 =["
      D             WK-LC-ST-KETASU    OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "運用通貨端数処理方法 =["
      D             WK-LC-HS           OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行スキップフラグ=["
      D             WK-PTF-SKIP-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行一時停止区分=["
      D             WK-PTF-STOP-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク欠落断面有無フラグ=["
      D             WK-LACK-DMN-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.処理実行日=["
      D             WK-SYORI-YMD        OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.起動ID=["
      D             WK-KIDOU-ID         OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.利用会社コード=["
      D             WK-RIYO-CMP-CD      OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.ファンドコード=["
      D             WK-FUND-CD          OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.ポートフォリオコー"
      D     "ド=["  WK-PTF-CD           OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.基準日=["
      D             WK-KJN-YMD          OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.順番=["
      D             WK-JUNBAN           OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.開始基準日=["
      D             WK-KAISI-KJN-YMD    OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.開始基準日の翌日=["
      D             WK-KAISI-KJN-YMD-NEXT
      D                                 OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.基準日種類=["
      D             WK-KJN-YMD-SHRU     OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.基準日断面作成区分"
      D       "=["  WK-KJN-YMD-DMN-SK-KBN
      D                                 OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.計算パターン=["
      D             WK-CALC-PTN         OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.仕訳基準パターン"
      D    "コード=["WK-SWK-KJN-PTN-CD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.基本会計ベースフラ"
      D    "グ=["   WK-KH-KK-BASE-FLG   OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.測定基準区分=["
      D             WK-ST-KJN-KBN       OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.異動計算パターン"
      D     "コード=["WK-IDO-CALC-PATTERN-CD
      D                                 OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.保有目的=["
      D             WK-POSSESSION-OBJ   OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.運用通貨コード=["
      D             WK-CAPITAL-TUKA-CD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.日次評価法フラグ=["
      D             WK-NITIJI-HYK-FLG   OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.料率パターンコード"
      D        "=[" WK-COMMISSION-PATTERN
      D                                 OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":約定主義会計フラグ =["
      D             WK-YKJ-SYUGI-KAIKEI OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー２回発生区分  =["
      D             WK-CASH-FLOW-KBN    OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":約定レートコード    =["
      D             WK-YKJ-RATE-CD      OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク再処理基準日FROM    =["
      D             WK-REDO-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.未収配当計上割合=["
      D             WK-MISYU-HAITOU-WARIAI     OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 3)ワーク進捗更新用基準日編集
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.日次評価法フラグ=["
      D             WK-NITIJI-HYK-FLG   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- @ワーク基準日断面情報.日次評価法フラグ＝'0'(対象外)
               IF  WK-NITIJI-HYK-FLG    OF  WK-TKMZBW02
                =  CNS-NITIJI-HYK-FLG-0
               THEN
      *---------- A)ワーク進捗更新用基準日(99用)← ワーク基準日断面情報.基準日の年月＋'99'
                 STRING  WK-KJN-YMD     OF  WK-TKMZBW02(1:6) , CNS-99
                                        DELIMITED  BY  SIZE
                   INTO  WK-STK-KY-KJN-YMD-99
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日(99用)=["
      D             WK-STK-KY-KJN-YMD-99"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.基準日種類=["
      D             WK-KJN-YMD-SHRU     OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- B)ワーク基準日断面情報.基準日種類＝'4'  or  '5'の場合
                 IF  WK-KJN-YMD-SHRU    OF  WK-TKMZBW02
                  =  CNS-KJN-YMD-SHRU-4
                 OR  WK-KJN-YMD-SHRU    OF  WK-TKMZBW02
                  =  CNS-KJN-YMD-SHRU-5
                 THEN
      *----------  ワーク進捗更新用基準日 ← 0
                   MOVE  ZERO           TO  WK-STK-KY-KJN-YMD
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日 =["
      D             WK-STK-KY-KJN-YMD"]"
      *-----------------------------------------------------------------
                 ELSE
      *---------- a)ワーク進捗更新用基準日 ← ワーク基準日断面情報.基準日
                   MOVE  WK-KJN-YMD     OF  WK-TKMZBW02
                     TO  WK-STK-KY-KJN-YMD
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日 =["
      D             WK-STK-KY-KJN-YMD"]"
      *-----------------------------------------------------------------
      *---------- b)ワーク進捗更新用基準日の月末日取得処理
                   PERFORM  CALL-SCZY1020-RTN
      *---------- c)【SCZY1020】のリターンパッケージ.基準年月日２＝ワーク基準日断面情報.基準日の場合、
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SCZY1020.基準年月日２=["
      D             IXCAL-KJN-YMD2      OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.基準日=["
      D             WK-KJN-YMD          OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
                   IF  IXCAL-KJN-YMD2   OF  PARM-SCZY1020-ARG1
                    =  WK-KJN-YMD       OF  WK-TKMZBW02
                   THEN
      *----------  ワーク進捗更新用基準日 ← 0
                     MOVE  ZERO           TO  WK-STK-KY-KJN-YMD
                   ELSE
                     CONTINUE
                   END-IF
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日 =["
      D             WK-STK-KY-KJN-YMD"]"
      *-----------------------------------------------------------------
                 END-IF
               ELSE
      *---------- Aワーク基準日断面情報.日次評価法フラグ＝'1'(対象)の場合
                 IF  WK-NITIJI-HYK-FLG  OF  WK-TKMZBW02
                  =  CNS-NITIJI-HYK-FLG-1
                 THEN
                   MOVE  WK-KJN-YMD     OF  WK-TKMZBW02
                     TO  WK-STK-KY-KJN-YMD
      *----------  ワーク進捗更新用基準日(99用)  ← ワーク基準日断面情報.基準日
                   MOVE  ZERO
                     TO  WK-STK-KY-KJN-YMD-99
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日 =["
      D             WK-STK-KY-KJN-YMD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日(99用)=["
      D             WK-STK-KY-KJN-YMD-99"]"
      *-----------------------------------------------------------------
                 ELSE
                   CONTINUE
                 END-IF
               END-IF
      *---------- 4)進捗ステータス（開始基準日）編集
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.順番=["
      D             WK-JUNBAN           OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス =["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- @ワーク基準日断面情報.順番＝1の場合
               IF  WK-JUNBAN            OF  WK-TKMZBW02 = CNS-JUNBAN-1
               THEN
      *---------- ワーク基準日断面情報.進捗ステータス（開始基準日) ← 基準日断面情報情報ホスト表[CNT-IDX].進捗ステータス（開始基準日）
                 MOVE  WK-STK-STS-KS-KJN-YMD
                   OF  WK-TBL-TKMZBW02-AREA(WK-CNT-IDX)
                   TO  WK-STK-STS-KS-KJN-YMD
                                        OF  WK-TKMZBW02
               ELSE
                 MOVE  WK-KY-STK-STS
                   TO  WK-STK-STS-KS-KJN-YMD
                                        OF  WK-TKMZBW02
                 MOVE  SPACE            TO  WK-KY-STK-STS
               END-IF
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "(開始基準日)=["WK-STK-STS-KS-KJN-YMD
      D                                 OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス =["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- 5)キャッシュフロー2回有効フラグ編集
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "基本会計ベースフラグ=["
      D              WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "仕訳基準パターンコード=["
      D             WK-SWK-KJN-PTN-CD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- @ワークキャッシュフロー2回有効フラグ←'2'(有効でない)
               MOVE  CNS-CASH-FLOW-2-FLG-2
                                        TO  WK-CASH-FLOW-2-FLG
      *---------- Aワーク基準日断面情報.基本会計ベースフラグ＝'1'(約定ベース)の場合
               IF  WK-KH-KK-BASE-FLG    OF  WK-TKMZBW02
                =  CNS-KH-KK-BASE-FLG-1
               THEN
      *---------- ◇ワーク基準日断面情報.仕訳基準パターンコードの2桁目＝'0'の場合
                 IF  WK-SWK-KJN-PTN-CD  OF  WK-TKMZBW02 (2:1)
                  =  CNS-SWK-KJN-PTN-CD-0
                 THEN
      *---------- ワークキャッシュフロー2回有効フラグ←'1'(有効)
                   MOVE  CNS-CASH-FLOW-2-FLG-1
                                        TO  WK-CASH-FLOW-2-FLG
                 ELSE
      *---------- ワークキャッシュフロー2回有効フラグ←'2'(有効でない)
                   MOVE  CNS-CASH-FLOW-2-FLG-2
                                        TO  WK-CASH-FLOW-2-FLG
                 END-IF
               ELSE
                 CONTINUE
               END-IF
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークキャッシュフロー2回有効フラグ=["
      D             WK-CASH-FLOW-2-FLG"]"
      *-----------------------------------------------------------------
      *---------- 4.1.3.進捗管理更新（先頭）
               IF  WK-STK-KY-KJN-YMD-99 NOT = ZERO
               THEN
                 PERFORM  STK-KANRI-UPDATE-RTN
                 PERFORM  COMMIT-2-RTN
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行一時停止区分=["
      D             WK-PTF-STOP-FLG"]"
      *-----------------------------------------------------------------
               IF  WK-STK-KY-KJN-YMD NOT = ZERO
               AND WK-PTF-SKIP-FLG NOT = CNS-1
               AND WK-PTF-STOP-FLG NOT = CNS-1
               THEN
                 PERFORM  STK-KR-UPDATE-2-RTN
                 PERFORM  COMMIT-1-RTN
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行スキップフラグ=["
      D             WK-PTF-SKIP-FLG"]"
      *-----------------------------------------------------------------
               IF  WK-PTF-SKIP-FLG = CNS-1
               THEN
                 PERFORM  PTF-END-RTN
               ELSE
                 CONTINUE
               END-IF
               IF  FLG-PTF = CNS-ON
               THEN
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行一時停止区分=["
      D             WK-PTF-STOP-FLG"]"
      *-----------------------------------------------------------------
                 IF  WK-PTF-STOP-FLG = CNS-1
                 THEN
                   PERFORM  PTF-END-RTN
                 ELSE
                   CONTINUE
                 END-IF
               END-IF
               IF  FLG-PTF = CNS-ON
               THEN
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.順番=["
      D             WK-JUNBAN  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
                 IF  WK-JUNBAN  OF  WK-TKMZBW02  =  CNS-JUNBAN-1
                 THEN
      *---------- 4.1.4.欠落断面判定処理
      *-------------------<DEBUG>---------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@@
      D            ":ワーク基準日断面情報.基本会計ベースフラグ      =[" @3212SEINO@@
      D             WK-KH-KK-BASE-FLG   OF  WK-TKMZBW02"]"              @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
                   IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02               @3212SEINO@@
                    =  CNS-KH-KK-BASE-FLG-1                             @3212SEINO@@
                   THEN                                                 @3212SEINO@@
                     PERFORM  SELECT-TKMZSK00-RTN                       @3212SEINO@@
                   ELSE                                                 @3212SEINO@@
                     PERFORM  SELECT-TKMZSK00-1-RTN                     @3212SEINO@@
                   END-IF                                               @3212SEINO@@
                 ELSE
                   CONTINUE
                 END-IF
      *---------- 4.1.5.基準日ループ属性データセット
                 PERFORM  KJN-YMD-GRP-RTN
      *---------- 再計算履歴データ削除
                 PERFORM  CALL-SMZJ1711-RTN
      *---------- 4.1.6.対象銘柄（玉）決定処理
                 PERFORM  TGT-MEG-KT-RTN
      *---------- 4.1.7.対象銘柄（玉）別処理 ループ処理 ※「4.2処理」
                 PERFORM  TGT-MEG-KT-GRP-RTN
               END-IF
               IF  FLG-PTF = CNS-ON
               THEN
                 CONTINUE
               ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-LACK-DMN-FLG= ["WK-LACK-DMN-FLG"]"
      *-----------------------------------------------------------------
                 IF  WK-LACK-DMN-FLG NOT = CNS-1
                 THEN
      *---------- 4.1.8.無用銘柄の取引差分更新処理
                   PERFORM  MUYO-MEG-UPDATE-RTN
                 ELSE
                   CONTINUE
                 END-IF
               END-IF
               IF  FLG-PTF = CNS-ON
               THEN
                 CONTINUE
               ELSE
      *---------- 4.1.9.断面別残高計算
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.上り電文.勘定異動／残高"
      D             "作成 = ["I-KJIDO-ZANSK    OF  WK-DENBUN-IN"]"
      *-----------------------------------------------------------------
                 IF  I-KJIDO-ZANSK    OF  WK-DENBUN-IN  NOT = CNS-2
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.上り電文.勘定異動／残高"
      D             "作成≠2（作成しない）の場合"
      *-----------------------------------------------------------------
                   PERFORM  DMN-ZN-CALC-RTN
                 ELSE
                   CONTINUE
                 END-IF
      *---------- 4.1.10.DB更新処理
                 PERFORM  DB-UPDATE-RTN
      *---------- 4.1.11.勘定異動バランスチェック
                 IF  I-KJIDO-ZANSK    OF  WK-DENBUN-IN  NOT = CNS-2
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.上り電文.勘定異動／残高"
      D             "作成≠2（作成しない）の場合"
      *-----------------------------------------------------------------
                   PERFORM  SMZJ4023-RTN
                 ELSE
                   CONTINUE
                 END-IF
      *---------- 4.1.12.勘定残高バランスチェック
                 IF  I-KJIDO-ZANSK    OF  WK-DENBUN-IN  NOT = CNS-2
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク電文情報.上り電文.勘定異動／残高"
      D             "作成≠2（作成しない）の場合"
      *-----------------------------------------------------------------
                   PERFORM  SMZJ4021-RTN
                 ELSE
                   CONTINUE
                 END-IF
      *---------- 4.1.13.基準日別終了処理
                 PERFORM  KJN-YMD-END-RTN
               END-IF
             END-PERFORM
           END-PERFORM
      *    IF  FLG-PTF = CNS-ON
      *    THEN
      *      CONTINUE
      *    ELSE
      *---------- 4.1.11.基準日断面情報データカーソルクローズ処理
      *      PERFORM  TKMZBW02-CLOSE-RTN
      *    END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 処理対象基準日断面別処理 ループ"
      D             "処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SR-KJN-YMD-DMN-EXT.
           EXIT.
      ******************************************************************
      *    欠落断面判定処理
      ******************************************************************
       SELECT-TKMZSK00-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引差分更新管理を取得(別紙1-6) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引差分更新管理CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT6                                         @3212SEINO@@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  H-RIYO-CMP-CD          OF  H-TKMZSK00-1-S,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-6
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  H-FUND-CD              OF  H-TKMZSK00-1-S,
                 WK-FUND-CD             OF  WK-MSG-1-6
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  H-PTF-CD               OF  H-TKMZSK00-1-S,
                 WK-PTF-CD              OF  WK-MSG-1-6
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D            ":ワーク基準日断面情報.基本会計ベースフラグ      =["
      D             WK-KH-KK-BASE-FLG   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02 = CNS-KH-KK-BASE-FLG-1
           THEN
             MOVE  ",SBN_CALC_FROM_YKJ"
               TO  WK-KAISI-KJN-YMD     OF  SQL-SELECT-1-6
             STRING  CNS-SBN-CALC-FROM-YKJ,
                     CNS-SBN-CALC-FROM-YKJ-Y
                                        DELIMITED  BY  SIZE
               INTO  WK-SBN-CALC-FROM   OF  SQL-SELECT-1-6
             MOVE  CNS-SBN-CALC-FROM-YKJ-X
               TO  WK-SBN-CALC-FROM-1   OF  WK-MSG-1-6
           ELSE
             IF  WK-KH-KK-BASE-FLG OF WK-TKMZBW02 = CNS-KH-KK-BASE-FLG-2
             THEN
               MOVE  ",SBN_CALC_FROM_UKE"
                 TO  WK-KAISI-KJN-YMD   OF  SQL-SELECT-1-6
               STRING  CNS-SBN-CALC-FROM-UKE,
                       CNS-SBN-CALC-FROM-UKE-Y
                                        DELIMITED  BY  SIZE
                 INTO  WK-SBN-CALC-FROM OF  SQL-SELECT-1-6
               MOVE  CNS-SBN-CALC-FROM-UKE-X
                 TO  WK-SBN-CALC-FROM-1 OF  WK-MSG-1-6
             ELSE
               MOVE  ",SBN_CALC_FROM_UKE"
                 TO  WK-KAISI-KJN-YMD   OF  SQL-SELECT-1-6
               MOVE  CNS-SBN-CALC-FROM-ZERO
                 TO  WK-SBN-CALC-FROM   OF  SQL-SELECT-1-6
               MOVE  CNS-SBN-CALC-FROM-ZERO-X
                 TO  WK-SBN-CALC-FROM-1 OF  WK-MSG-1-6
             END-IF
           END-IF
      *----------  差分計算開始日 （約定）/（受渡）
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW02
             TO  H-KAISI-KJN-YMD        OF  H-TKMZSK00-1-S,
                 WK-SBN-CALC-FROM-2     OF  WK-MSG-1-6
      *----------  TBL
           MOVE  WK-TBL-TKMZSK00
             TO  SQL-TBL-ID-6           OF  SQL-SELECT-1-6,
                 WK-MSG-TKMZSK00        OF  WK-MSG-1-6
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02 = CNS-KH-KK-BASE-FLG-1
           THEN
             STRING  SQL-SELECT-1-6,
                     CNS-ODBY-SBN-CALC-FROM-YKJ
                                        DELIMITED  BY  SIZE
               INTO  SQLSTMT6                                           @3212SEINO@@
           ELSE
             STRING  SQL-SELECT-1-6,
                     CNS-ODBY-SBN-CALC-FROM-UKE
                                        DELIMITED  BY  SIZE
               INTO  SQLSTMT6                                           @3212SEINO@@
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZSK00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZSK00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZSK00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":差分計算開始日（約定）/（受渡）=["
      D             H-KAISI-KJN-YMD      OF  H-TKMZSK00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT6=[" SQLSTMT6 "]"               @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":WK-MSG-1-6=[" WK-MSG-1-6 "]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-1-OPEN=["               @3212SEINO@@
      D             FLG-TKMZSK00-CR-1-OPEN"]"                           @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZSK00-CR-1-OPEN  NOT =  CNS-ON                    @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *----------  取引差分更新管理CURSOR PREPARE
           EXEC  SQL
             PREPARE  S6  FROM  :SQLSTMT6                               @3212SEINO@@
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D        ":取引差分更新管理CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CUR PREPARE 正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-034          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-6         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引差分更新管理CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
           EXEC  SQL
             DECLARE  TKMZSK00_CUR_1  CURSOR  FOR  S6                   @3212SEINO@@
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引差分更新管理CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZSK00_CUR_1
               USING :H-TKMZSK00-1-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引差分更新管理CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZSK00-CR-1-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-1-OPEN=["
      D             FLG-TKMZSK00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-035          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-6         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引差分更新管理CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引差分更新管理CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZSK00_CUR_1
             INTO  :H-TKMZSK00-2
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":取引差分更新管理CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             H-SEC-SBT-CD        OF  H-TKMZSK00-2"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             H-MEG-CD            OF  H-TKMZSK00-2"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             H-TATE-FLG          OF  H-TKMZSK00-2"]"
      D    DISPLAY  CNS-PGM-ID":玉ID=["
      D             H-GYOKU-ID          OF  H-TKMZSK00-2"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             H-SIJO-TUKA-CD      OF  H-TKMZSK00-2"]"
      D    DISPLAY  CNS-PGM-ID":差分計算開始日 （約定）/（受渡）=["
      D             H-KAISI-KJN-YMD     OF  H-TKMZSK00-2"]"
      *-----------------------------------------------------------------
      *---------- ワーク欠落断面有無フラグ ← 1 （欠落あり）
               MOVE  CNS-1              TO  WK-LACK-DMN-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク欠落断面有無フラグ=["
      D             WK-LACK-DMN-FLG"]"
      *-----------------------------------------------------------------
      *---------- 【SCZY3002】外部銘柄コード変換ルーチン
               PERFORM  SCZY3002-1-RTN
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
               CONTINUE
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-036          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-6         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引差分更新管理CURSOR FETCH END ***"
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 取引差分更新管理CURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZSK00-CR-1-OPEN= ["
      *D             FLG-TKMZSK00-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZSK00_CUR_1
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"取引差分更新管理"
      *D             "CUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF              TO  FLG-TKMZSK00-CR-1-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZSK00-CR-1-OPEN =["
      *D             FLG-TKMZSK00-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-037          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-6         DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-7-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***取引差分更新管理CUR CLOSE END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 取引差分更新管理を取得(別紙1-6) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SELECT-TKMZSK00-EXT.
           EXIT.
      ******************************************************************@3212SEINO@
      *    欠落断面判定処理                                             @3212SEINO@
      ******************************************************************@3212SEINO@
       SELECT-TKMZSK00-1-RTN  SECTION.                                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 取引差分更新管理を取得(別紙1-6) START ***"    @3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 取引差分更新管理CURSOR PREPARE  START ***"    @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           INITIALIZE  SQLSTMT6-1                                       @3212SEINO@
      *----------  利用会社コード                                       @3212SEINO@
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO                 @3212SEINO@
             TO  H-RIYO-CMP-CD          OF  H-TKMZSK00-1-S,             @3212SEINO@
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-6                  @3212SEINO@
      *----------  ファンドコード                                       @3212SEINO@
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO                 @3212SEINO@
             TO  H-FUND-CD              OF  H-TKMZSK00-1-S,             @3212SEINO@
                 WK-FUND-CD             OF  WK-MSG-1-6                  @3212SEINO@
      *----------  ポートフォリオコード                                 @3212SEINO@
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO                 @3212SEINO@
             TO  H-PTF-CD               OF  H-TKMZSK00-1-S,             @3212SEINO@
                 WK-PTF-CD              OF  WK-MSG-1-6                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D            ":ワーク基準日断面情報.基本会計ベースフラグ      =[" @3212SEINO@
      D             WK-KH-KK-BASE-FLG   OF  WK-TKMZBW02"]"              @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02 = CNS-KH-KK-BASE-FLG-1@3212SEINO@
           THEN                                                         @3212SEINO@
             MOVE  ",SBN_CALC_FROM_YKJ"                                 @3212SEINO@
               TO  WK-KAISI-KJN-YMD     OF  SQL-SELECT-1-6              @3212SEINO@
             STRING  CNS-SBN-CALC-FROM-YKJ,                             @3212SEINO@
                     CNS-SBN-CALC-FROM-YKJ-Y                            @3212SEINO@
                                        DELIMITED  BY  SIZE             @3212SEINO@
               INTO  WK-SBN-CALC-FROM   OF  SQL-SELECT-1-6              @3212SEINO@
             MOVE  CNS-SBN-CALC-FROM-YKJ-X                              @3212SEINO@
               TO  WK-SBN-CALC-FROM-1   OF  WK-MSG-1-6                  @3212SEINO@
           ELSE                                                         @3212SEINO@
             IF  WK-KH-KK-BASE-FLG OF WK-TKMZBW02 = CNS-KH-KK-BASE-FLG-2@3212SEINO@
             THEN                                                       @3212SEINO@
               MOVE  ",SBN_CALC_FROM_UKE"                               @3212SEINO@
                 TO  WK-KAISI-KJN-YMD   OF  SQL-SELECT-1-6              @3212SEINO@
               STRING  CNS-SBN-CALC-FROM-UKE,                           @3212SEINO@
                       CNS-SBN-CALC-FROM-UKE-Y                          @3212SEINO@
                                        DELIMITED  BY  SIZE             @3212SEINO@
                 INTO  WK-SBN-CALC-FROM OF  SQL-SELECT-1-6              @3212SEINO@
               MOVE  CNS-SBN-CALC-FROM-UKE-X                            @3212SEINO@
                 TO  WK-SBN-CALC-FROM-1 OF  WK-MSG-1-6                  @3212SEINO@
             ELSE                                                       @3212SEINO@
               MOVE  ",SBN_CALC_FROM_UKE"                               @3212SEINO@
                 TO  WK-KAISI-KJN-YMD   OF  SQL-SELECT-1-6              @3212SEINO@
               MOVE  CNS-SBN-CALC-FROM-ZERO                             @3212SEINO@
                 TO  WK-SBN-CALC-FROM   OF  SQL-SELECT-1-6              @3212SEINO@
               MOVE  CNS-SBN-CALC-FROM-ZERO-X                           @3212SEINO@
                 TO  WK-SBN-CALC-FROM-1 OF  WK-MSG-1-6                  @3212SEINO@
             END-IF                                                     @3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  差分計算開始日 （約定）/（受渡）                     @3212SEINO@
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-KAISI-KJN-YMD        OF  H-TKMZSK00-1-S,             @3212SEINO@
                 WK-SBN-CALC-FROM-2     OF  WK-MSG-1-6                  @3212SEINO@
      *----------  TBL                                                  @3212SEINO@
           MOVE  WK-TBL-TKMZSK00                                        @3212SEINO@
             TO  SQL-TBL-ID-6           OF  SQL-SELECT-1-6,             @3212SEINO@
                 WK-MSG-TKMZSK00        OF  WK-MSG-1-6                  @3212SEINO@
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02 = CNS-KH-KK-BASE-FLG-1@3212SEINO@
           THEN                                                         @3212SEINO@
             STRING  SQL-SELECT-1-6,                                    @3212SEINO@
                     CNS-ODBY-SBN-CALC-FROM-YKJ                         @3212SEINO@
                                        DELIMITED  BY  SIZE             @3212SEINO@
               INTO  SQLSTMT6-1                                         @3212SEINO@
           ELSE                                                         @3212SEINO@
             STRING  SQL-SELECT-1-6,                                    @3212SEINO@
                     CNS-ODBY-SBN-CALC-FROM-UKE                         @3212SEINO@
                                        DELIMITED  BY  SIZE             @3212SEINO@
               INTO  SQLSTMT6-1                                         @3212SEINO@
           END-IF                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["                @3212SEINO@
      D             H-RIYO-CMP-CD        OF  H-TKMZSK00-1-S"]"          @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["                @3212SEINO@
      D             H-FUND-CD            OF  H-TKMZSK00-1-S"]"          @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["                @3212SEINO@
      D             H-PTF-CD             OF  H-TKMZSK00-1-S"]"          @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":差分計算開始日（約定）/（受渡）=["     @3212SEINO@
      D             H-KAISI-KJN-YMD      OF  H-TKMZSK00-1-S"]"          @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT6-1=[" SQLSTMT6-1"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID ":WK-MSG-1-6=[" WK-MSG-1-6 "]"           @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-1-OPEN-1=["             @3212SEINO@
      D             FLG-TKMZSK00-CR-1-OPEN-1"]"                         @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF  FLG-TKMZSK00-CR-1-OPEN-1  NOT =  CNS-ON                  @3212SEINO@
           THEN                                                         @3212SEINO@
      *----------  取引差分更新管理CURSOR PREPARE                       @3212SEINO@
           EXEC  SQL                                                    @3212SEINO@
             PREPARE  A1  FROM  :SQLSTMT6-1                             @3212SEINO@
           END-EXEC                                                     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D        ":取引差分更新管理CURSOR PREPARE SQLCODE =[" SQLCODE "]" @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF  SQLCODE = CNS-SQL-NORMAL                                 @3212SEINO@
           THEN                                                         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CUR PREPARE 正常"       @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
             CONTINUE                                                   @3212SEINO@
           ELSE                                                         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CUR PREPARE 異常"       @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- ワークエラーパッケージを編集                          @3212SEINO@
             INITIALIZE  WK-SYS-ERR-INFO                                @3212SEINO@
             MOVE  CNS-POS-034          TO  WK-ERR-POS                  @3212SEINO@
             STRING  CNS-SQL-MSG-SELECT,                                @3212SEINO@
                     WK-MSG-1-6         DELIMITED  BY  SIZE             @3212SEINO@
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO             @3212SEINO@
             PERFORM  ERR-MSG-7-RTN                                     @3212SEINO@
           END-IF                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 取引差分更新管理CURSOR OPEN START ***"        @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  DECLARE CURSOR                                       @3212SEINO@
           EXEC  SQL                                                    @3212SEINO@
             DECLARE  TKMZSK00_CUR_2  CURSOR  FOR  A1                   @3212SEINO@
           END-EXEC                                                     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":取引差分更新管理CUR DECLARE SQLCODE=["SQLCODE"]"  @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
           END-IF                                                       @3212SEINO@
      *----------  OPEN CURSOR                                          @3212SEINO@
           EXEC  SQL                                                    @3212SEINO@
             OPEN  TKMZSK00_CUR_2                                       @3212SEINO@
               USING :H-TKMZSK00-1-S                                    @3212SEINO@
           END-EXEC                                                     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":取引差分更新管理CUR OPEN SQLCODE=["SQLCODE"]"     @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF  SQLCODE  =  CNS-SQL-NORMAL                               @3212SEINO@
           THEN                                                         @3212SEINO@
             MOVE  CNS-ON               TO  FLG-TKMZSK00-CR-1-OPEN-1    @3212SEINO@
      *-----------------<DEBUG>---------------------------------------  @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR OPEN  正常"      @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-1-OPEN-1=["             @3212SEINO@
      D             FLG-TKMZSK00-CR-1-OPEN-1"]"                         @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           ELSE                                                         @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR OPEN  異常"      @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- ワークエラーパッケージを編集                          @3212SEINO@
             INITIALIZE  WK-SYS-ERR-INFO                                @3212SEINO@
             MOVE  CNS-POS-035          TO  WK-ERR-POS                  @3212SEINO@
             STRING  CNS-SQL-MSG-SELECT,                                @3212SEINO@
                     WK-MSG-1-6         DELIMITED  BY  SIZE             @3212SEINO@
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO             @3212SEINO@
             PERFORM  ERR-MSG-7-RTN                                     @3212SEINO@
           END-IF                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 取引差分更新管理CURSOR OPEN END ***"          @3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 取引差分更新管理CURSOR FETCH START ***"       @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *----------  CURSOR FETCH                                         @3212SEINO@
           EXEC SQL                                                     @3212SEINO@
             FETCH TKMZSK00_CUR_2                                       @3212SEINO@
             INTO  :H-TKMZSK00-2                                        @3212SEINO@
           END-EXEC                                                     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":取引差分更新管理CUR FETCH SQLCODE=["SQLCODE"]"    @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           EVALUATE  SQLCODE                                            @3212SEINO@
      *----------  正常                                                 @3212SEINO@
             WHEN  CNS-SQL-NORMAL                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR FETCH  正常"     @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["                       @3212SEINO@
      D             H-SEC-SBT-CD        OF  H-TKMZSK00-2"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["                           @3212SEINO@
      D             H-MEG-CD            OF  H-TKMZSK00-2"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["             @3212SEINO@
      D             H-TATE-FLG          OF  H-TKMZSK00-2"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":玉ID=["                                 @3212SEINO@
      D             H-GYOKU-ID          OF  H-TKMZSK00-2"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["                       @3212SEINO@
      D             H-SIJO-TUKA-CD      OF  H-TKMZSK00-2"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":差分計算開始日 （約定）/（受渡）=["     @3212SEINO@
      D             H-KAISI-KJN-YMD     OF  H-TKMZSK00-2"]"             @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- ワーク欠落断面有無フラグ ← 1 （欠落あり）            @3212SEINO@
               MOVE  CNS-1              TO  WK-LACK-DMN-FLG             @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ワーク欠落断面有無フラグ=["             @3212SEINO@
      D             WK-LACK-DMN-FLG"]"                                  @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- 【SCZY3002】外部銘柄コード変換ルーチン                @3212SEINO@
               PERFORM  SCZY3002-1-RTN                                  @3212SEINO@
             WHEN  CNS-SQL-NOTFOUND                                     @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR FETCH NOTFOUND"  @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
               CONTINUE                                                 @3212SEINO@
             WHEN  OTHER                                                @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":取引差分更新管理CURSOR FETCH  異常"     @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- ワークエラーパッケージを編集                          @3212SEINO@
             INITIALIZE  WK-SYS-ERR-INFO                                @3212SEINO@
             MOVE  CNS-POS-036          TO  WK-ERR-POS                  @3212SEINO@
             STRING  CNS-SQL-MSG-SELECT,                                @3212SEINO@
                     WK-MSG-1-6         DELIMITED  BY  SIZE             @3212SEINO@
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO             @3212SEINO@
             PERFORM  ERR-MSG-7-RTN                                     @3212SEINO@
           END-EVALUATE                                                 @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 取引差分更新管理CURSOR FETCH END ***"         @3212SEINO@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@
      D             ":*** 取引差分更新管理を取得(別紙1-6) END ***"      @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           CONTINUE.                                                    @3212SEINO@
       SELECT-TKMZSK00-1-EXT.                                           @3212SEINO@
           EXIT.                                                        @3212SEINO@
      ******************************************************************
      *    【SCZY3002】外部銘柄コード変換ルーチン
      ******************************************************************
       SCZY3002-1-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  外部銘柄コード変換ルーチン 処理"
      D             "  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY3002-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY3002-ARG1
      *---------- 内部銘柄コード
           MOVE  H-MEG-CD               OF  H-TKMZSK00-2
             TO  NAIBU-MEG-CD           OF  PARM-SCZY3002-ARG1
      *---------- 商品分類コード
           MOVE  SPACE
             TO  SYOHIN-BUNRUI-CD       OF  PARM-SCZY3002-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":別紙1-6SQL.証券種別コード=["
      D             H-SEC-SBT-CD        OF  H-TKMZSK00-2"]"
      *-----------------------------------------------------------------
           IF  H-SEC-SBT-CD             OF  H-TKMZSK00-2
            =  CNS-MA99
           THEN
      *---------- 証券種別コード
             MOVE  SPACE
               TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
           ELSE
             MOVE  H-SEC-SBT-CD         OF  H-TKMZSK00-2
               TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
           END-IF
      *---------- 元証券種別コード
           MOVE  SPACE
             TO  MOTO-SEC-SBT-CD        OF  PARM-SCZY3002-ARG1
      *---------- 銘柄通貨コード
           MOVE  SPACE
             TO  MEG-TUKA-CD            OF  PARM-SCZY3002-ARG1
      *---------- コードリファレンス系列コード
           MOVE  SPACE
             TO  CD-REF-KRTU-CD         OF  PARM-SCZY3002-ARG1
      *---------- 業務タスクID
           MOVE  SPACE
             TO  GYOMU-TASK-ID          OF  PARM-SCZY3002-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  PARM-SCZY3002-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":内部銘柄コード=["
      D             NAIBU-MEG-CD        OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":商品分類コード=["
      D             SYOHIN-BUNRUI-CD    OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":元証券種別コード=["
      D             MOTO-SEC-SBT-CD     OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄通貨コード=["
      D             MEG-TUKA-CD         OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":コードリファレンス系列コード=["
      D             CD-REF-KRTU-CD      OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             KJN-YMD             OF  PARM-SCZY3002-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY3002"             USING  PARM-SCZY3002-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3002)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク欠落断面証券種別 ← リターンパッケージ.証券種別コード
             MOVE  SEC-SBT-CD           OF  PARM-SCZY3002-ARG2
               TO  WK-LACK-DMN-SEC-SBT
      *---------- ワーク欠落断面銘柄 ← リターンパッケージ.外部銘柄コード
             MOVE  GAIBU-MEG-CD         OF  PARM-SCZY3002-ARG2
               TO  WK-LACK-DMN-MEG
           ELSE
      *---------- ワーク欠落断面証券種別 ← 別紙1-6SQL.証券種別コード
             MOVE  H-SEC-SBT-CD         OF  H-TKMZSK00-2
               TO  WK-LACK-DMN-SEC-SBT
      *---------- ワーク欠落断面銘柄 ← 別紙1-6SQL.銘柄コード
             MOVE  H-MEG-CD             OF  H-TKMZSK00-2
               TO  WK-LACK-DMN-MEG
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク欠落断面証券種別=["
      D             WK-LACK-DMN-SEC-SBT"]"
      D    DISPLAY  CNS-PGM-ID":ワーク欠落断面銘柄=["WK-LACK-DMN-MEG"]"
      *-----------------------------------------------------------------
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M03のメッセージID
           MOVE  CNS-MSG-W000554
             TO  WK-MSG-ID              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
           MOVE  SPACE
             TO  WK-TK-MOJI             OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ←
      *  '開始基準日：'ワーク基準日断面情報.開始基準日＋'基準日：'ワーク基準日断面情報.基準日
      *＋'証券種別:'ワーク欠落断面証券種別
      *＋'銘柄:'ワーク欠落断面銘柄
      *＋'資産負債フラグ:'別紙1-6SQL.資産負債・買建売建フラグ
      *＋'玉ＩＤ:'別紙1-6SQL.玉ＩＤ
      *＋'市場通貨:'別紙1-6SQL.市場通貨コード
      *＋'計上日:'別紙1-6SQL.差分計算開始日（約定） 或いは.差分計算開始日（受渡）
           STRING  CNS-MSG-27,WK-KAISI-KJN-YMD  OF  WK-TKMZBW02,
                   CNS-MSG-28,WK-KJN-YMD        OF  WK-TKMZBW02,
                   CNS-MSG-57,WK-LACK-DMN-SEC-SBT,
                   CNS-MSG-58,WK-LACK-DMN-MEG,
                   CNS-MSG-59,H-TATE-FLG        OF  H-TKMZSK00-2,
                   CNS-MSG-60,H-GYOKU-ID        OF  H-TKMZSK00-2,
                   CNS-MSG-61,H-SIJO-TUKA-CD    OF  H-TKMZSK00-2,
                   CNS-MSG-62,H-KAISI-KJN-YMD   OF  H-TKMZSK00-2
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA＋1 =["WK-CounterA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
           THEN
             MOVE  CNS-MT-JS-200        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT2
           THEN
             MOVE  CNS-RTN-BT2          TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           IF  WK-STK-STS-KJN-YMD       OF  WK-TKMZBW02 < CNS-MT-JS-200
           THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '200'(警告終了)
             MOVE  CNS-MT-JS-200
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":*** 外部銘柄コード変換ルーチン 処理"
      D             " END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY3002-1-EXT.
           EXIT.
      ******************************************************************
      *    4.1.1.基準日断面情報データを取得
      ******************************************************************
       TKMZBW02-GET-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日断面情報データを取得 処理"
      D            "  START  ***"
      *-----------------------------------------------------------------
      *-----------  カーソル定義処理
           PERFORM  TKMZBW02-DEC-RTN
      *-----------  カーソルオープン処理
           PERFORM  TKMZBW02-OPEN-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 基準日断面情報データを取得 処理"
      D             " END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW02-GET-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKMZBW02-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  H-SYORI-YMD            OF  H-TKMZBW02-S,
                 WK-SYORI-YMD-S         OF  WK-MSG-1-2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  H-KIDOU-ID             OF  H-TKMZBW02-S,
                 WK-KIDOU-ID-S          OF  WK-MSG-1-2
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW02-S,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-2
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  H-FUND-CD              OF  H-TKMZBW02-S,
                 WK-FUND-CD-S           OF  WK-MSG-1-2
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  H-PTF-CD               OF  H-TKMZBW02-S,
                 WK-PTF-CD-S            OF  WK-MSG-1-2
      *---------- テーブルID
           MOVE  WK-TBL-TKMZBW02
             TO  SQL-TKMZBW02           OF  SQL-SELECT-1-2,
                 WK-TAB-TKMZBW02        OF  WK-MSG-1-2
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             H-SYORI-YMD         OF  H-TKMZBW02-S"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             H-KIDOU-ID          OF  H-TKMZBW02-S"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZBW02-S"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZBW02-S"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             H-PTF-CD            OF  H-TKMZBW02-S"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT2                                         @3212SEINO@@
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-2         TO  SQLSTMT2                    @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT2=["SQLSTMT2"]"                  @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW02-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMZBW02-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
           IF  FLG-TKMZBW02-CR-OPEN  NOT = CNS-ON                       @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
               PREPARE  S2  FROM :SQLSTMT2                              @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-038          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-2         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-6-RTN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
           EXEC  SQL  DECLARE  TKMZBW02_CURSOR  CURSOR  FOR  S2 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW02-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKMZBW02-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKMZBW02_CURSOR
                 USING :H-TKMZBW02-S.H-SYORI-YMD,
                       :H-TKMZBW02-S.H-KIDOU-ID,
                       :H-TKMZBW02-S.H-RIYO-CMP-CD,
                       :H-TKMZBW02-S.H-FUND-CD,
                       :H-TKMZBW02-S.H-PTF-CD
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZBW02-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW02-CR-OPEN=["
      D             FLG-TKMZBW02-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-039          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-2         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-6-RTN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW02-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    4.1.2.基準日断面情報データカーソルフェッチして
      ******************************************************************
       TKMZBW02-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 基準日断面情報データカーソル"
      D             "フェッチ処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMZBW02-2
                                        WK-TBL-TKMZBW02-AREA
           EXEC  SQL
               FETCH
                    TKMZBW02_CURSOR
               INTO :H-TKMZBW02-2-VALUE
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               COMPUTE  WK-KUKAN-KENSUU = SQLERRD(3) - WK-GOUKEI-KENSUU
               MOVE  SQLERRD(3)         TO  WK-GOUKEI-KENSUU
               MOVE  H-TKMZBW02-2       TO  WK-TBL-TKMZBW02-AREA
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLERRD(3)=["SQLERRD(3)"]"
      D    DISPLAY  CNS-PGM-ID":ワーク区間件数=["WK-KUKAN-KENSUU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク合計件数=["WK-GOUKEI-KENSUU"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報情報ホスト表=["
      D                         WK-TBL-TKMZBW02-AREA"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
               COMPUTE  WK-KUKAN-KENSUU = SQLERRD(3) - WK-GOUKEI-KENSUU
               MOVE  SQLERRD(3)         TO  WK-GOUKEI-KENSUU
               MOVE  CNS-ON             TO  FLG-FETCH-SYUURYOU
               MOVE  H-TKMZBW02-2       TO  WK-TBL-TKMZBW02-AREA
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLERRD(3)=["SQLERRD(3)"]"
      D    DISPLAY  CNS-PGM-ID":ワーク区間件数=["WK-KUKAN-KENSUU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク合計件数=["WK-GOUKEI-KENSUU"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報情報ホスト表=["
      D                         WK-TBL-TKMZBW02-AREA"]"
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU=["
      D             FLG-FETCH-SYUURYOU"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-040        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-2       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-6-RTN
      *---------- ポートフォリオ終了処理へ
               PERFORM  PTF-END-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日断面情報データカーソル"
      D             "フェッチ処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW02-FET-EXT.
           EXIT.
      ******************************************************************
      *    ワーク進捗更新用基準日の月末日取得処理
      ******************************************************************
       CALL-SCZY1020-RTN      SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日の月末日取得処理"
      D             " START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1020-INOUT
                       PARM-RTNPKG
      *---------- 機能区分
           MOVE  CNS-IXCAL-FUNCTION-5
             TO  IXCAL-FUNCTION         OF  PARM-SCZY1020-ARG1
      *---------- 基準年月日１
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  IXCAL-KJN-YMD1         OF  PARM-SCZY1020-ARG1
      *---------- 前後区分１
           MOVE  CNS-IXCAL-ZENGO-KBN-1-2
             TO  IXCAL-ZENGO-KBN-1      OF  PARM-SCZY1020-ARG1
      *---------- 単位区分
           MOVE  CNS-IXCAL-TANI-KBN-2
             TO  IXCAL-TANI-KBN         OF  PARM-SCZY1020-ARG1
      *---------- 計算ベース区分
           MOVE  CNS-IXCAL-COMP-BASE
             TO  IXCAL-COMP-BASE        OF  PARM-SCZY1020-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             IXCAL-FUNCTION      OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日１  =["
      D             IXCAL-KJN-YMD1      OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前後区分１   =["
      D             IXCAL-ZENGO-KBN-1   OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":単位区分   =["
      D             IXCAL-TANI-KBN      OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計算ベース区分   =["
      D             IXCAL-COMP-BASE     OF  PARM-SCZY1020-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1020"             USING  PARM-SCZY1020-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1020)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
               CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ワークエラーパッケージを編集
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- ポジション
               MOVE  CNS-POS-041        TO  WK-ERR-POS
      *---------- リターンコード
               MOVE  CNS-RTN-901        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  RTN-CD             OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
                 TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-INFO-ADD-RTN
      *---------- ワーク明細単位実行ステータス
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- Dポートフォリオ終了処理へ
               PERFORM  PTF-END-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク進捗更新用基準日の月末日取得処理"
      D             "  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       CALL-SCZY1020-EXT.
           EXIT.
      ******************************************************************
      *    4.1.3.進捗管理更新（先頭）
      ******************************************************************
       STK-KANRI-UPDATE-RTN   SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 進捗管理更新（先頭）処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1190-INOUT
                       PARM-RTNPKG
      *---------- セッション区分 ←'0'（先頭セッション)
           MOVE  CNS-SESSION-KBN-0
             TO  SESION-KBN             OF  PARM-SCZY1190-ARG1
      *---------- OL/BT区分 ← "BT":バッチ用
           MOVE  CNS-BT
             TO  OLBT-KBN               OF  PARM-SCZY1190-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SCZY1190-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  PARM-SCZY1190-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  PARM-SCZY1190-ARG2
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY1190-ARG2
      *---------- 基準年月日/基準年月
           MOVE  WK-STK-KY-KJN-YMD-99
             TO  KJN-YMD                OF  PARM-SCZY1190-ARG2
      *---------- 最終処理基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  SS-SYORI-YMD           OF  PARM-SCZY1190-ARG2
      *---------- ベビー未処理フラグ
           MOVE  SPACE
             TO  BABY-MISYORI-FLG       OF  PARM-SCZY1190-ARG2
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SCZY1190-ARG2
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SCZY1190-ARG2
      *---------- 評価系列コード
           MOVE  SPACE
             TO  HYK-KRTU-CD            OF  PARM-SCZY1190-ARG2
      *---------- 帳票ID
           MOVE  SPACE
             TO  REP-ID                 OF  PARM-SCZY1190-ARG2
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  REP-ANY-CD             OF  PARM-SCZY1190-ARG2
      *---------- 基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  KJN-YMD-FROM           OF  PARM-SCZY1190-ARG2
      *---------- 進捗ステータス
           MOVE  CNS-JIKOU-STS-600
             TO  JIKOU-STS              OF  PARM-SCZY1190-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分=["
      D             SESION-KBN          OF  PARM-SCZY1190-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分=["
      D             OLBT-KBN            OF  PARM-SCZY1190-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日/基準年月=["
      D             KJN-YMD             OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終処理基準日=["
      D             SS-SYORI-YMD        OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ベビー未処理フラグ=["
      D             BABY-MISYORI-FLG    OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             HYK-KRTU-CD         OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
      D             REP-ANY-CD          OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM=["
      D             KJN-YMD-FROM        OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":進捗ステータス=["
      D             JIKOU-STS           OF  PARM-SCZY1190-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1190"             USING  PARM-SCZY1190-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1190)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ポートフォリオ実行可能区分 =["
      D             PTF-JIKOU-KBN       OF  PARM-SCZY1190-ARG3"]"
      *-----------------------------------------------------------------
             EVALUATE  PTF-JIKOU-KBN    OF  PARM-SCZY1190-ARG3
               WHEN  CNS-CONTINUE-KBN-1
                 MOVE  CNS-1  TO  WK-PTF-SKIP-FLG
               WHEN  CNS-CONTINUE-KBN-2
      *---------- ワークポートフォリオ実行一時停止区分
                 MOVE  CNS-1  TO  WK-PTF-STOP-FLG
      *---------- ワークポートフォリオ情報.ファンドコード
                 MOVE  WK-FUND-CD       OF  WK-PTF-INFO
                   TO  WK-FUND-CD       OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
                 MOVE  WK-PTF-CD        OF  WK-PTF-INFO
                   TO  WK-PTF-CD        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
                 MOVE  WK-MKY-KJN-YMD-FROM
                   TO  WK-KJN-YMD-FROM  OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
                 MOVE  WK-SITEI-TO      OF  WK-DENBUN-KAISEKI-INFO
                   TO  WK-KJN-YMD-TO    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M40のメッセージID
                 MOVE  CNS-MSG-E000604
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ' '
                 MOVE  SPACE
                   TO  WK-FREE-MSG      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークリターンコード
                 MOVE  CNS-RTN-BT10     TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード       =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From           =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To             =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID         =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ     =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA         =["WK-CounterA"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード  =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
                 COMPUTE  WK-CounterA   =  WK-CounterA + CNS-1
               WHEN  OTHER
                 CONTINUE
             END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行スキップフラグ=["
      D             WK-PTF-SKIP-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行一時停止区分=["
      D             WK-PTF-STOP-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-042          TO  WK-ERR-POS
             PERFORM  ERR-MSG-5-RTN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  進捗管理更新（先頭）処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       STK-KANRI-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    4.1.3.進捗管理更新（先頭） 2)
      ******************************************************************
       STK-KR-UPDATE-2-RTN    SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 進捗管理更新（先頭）2) START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1190-INOUT
                       PARM-RTNPKG
      *---------- セッション区分 ←'0'（先頭セッション)
           MOVE  CNS-SESSION-KBN-0
             TO  SESION-KBN             OF  PARM-SCZY1190-ARG1
      *---------- OL/BT区分 ← "BT":バッチ用
           MOVE  CNS-BT
             TO  OLBT-KBN               OF  PARM-SCZY1190-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SCZY1190-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  PARM-SCZY1190-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  PARM-SCZY1190-ARG2
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY1190-ARG2
      *---------- 基準年月日/基準年月
           MOVE  WK-STK-KY-KJN-YMD
             TO  KJN-YMD                OF  PARM-SCZY1190-ARG2
      *---------- 最終処理基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  SS-SYORI-YMD           OF  PARM-SCZY1190-ARG2
      *---------- ベビー未処理フラグ
           MOVE  SPACE
             TO  BABY-MISYORI-FLG       OF  PARM-SCZY1190-ARG2
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SCZY1190-ARG2
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SCZY1190-ARG2
      *---------- 評価系列コード
           MOVE  SPACE
             TO  HYK-KRTU-CD            OF  PARM-SCZY1190-ARG2
      *---------- 帳票ID
           MOVE  SPACE
             TO  REP-ID                 OF  PARM-SCZY1190-ARG2
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  REP-ANY-CD             OF  PARM-SCZY1190-ARG2
      *---------- 基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  KJN-YMD-FROM           OF  PARM-SCZY1190-ARG2
      *---------- 進捗ステータス
           MOVE  CNS-JIKOU-STS-600
             TO  JIKOU-STS              OF  PARM-SCZY1190-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分=["
      D             SESION-KBN          OF  PARM-SCZY1190-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分=["
      D             OLBT-KBN            OF  PARM-SCZY1190-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日/基準年月=["
      D             KJN-YMD             OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終処理基準日=["
      D             SS-SYORI-YMD        OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ベビー未処理フラグ=["
      D             BABY-MISYORI-FLG    OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             HYK-KRTU-CD         OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
      D             REP-ANY-CD          OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM=["
      D             KJN-YMD-FROM        OF  PARM-SCZY1190-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":進捗ステータス=["
      D             JIKOU-STS           OF  PARM-SCZY1190-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1190"             USING  PARM-SCZY1190-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1190)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ポートフォリオ実行可能区分 =["
      D             PTF-JIKOU-KBN       OF  PARM-SCZY1190-ARG3"]"
      *-----------------------------------------------------------------
             EVALUATE  PTF-JIKOU-KBN    OF  PARM-SCZY1190-ARG3
               WHEN  CNS-CONTINUE-KBN-1
                 MOVE  CNS-1  TO  WK-PTF-SKIP-FLG
               WHEN  CNS-CONTINUE-KBN-2
                 MOVE  CNS-1  TO  WK-PTF-STOP-FLG
               WHEN  OTHER
                 CONTINUE
             END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行スキップフラグ=["
      D             WK-PTF-SKIP-FLG"]"
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行一時停止区分=["
      D             WK-PTF-STOP-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ワークエラーパッケージを編集
               MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- ポジション
               MOVE  CNS-POS-043        TO  WK-ERR-POS
      *---------- リターンコード
               MOVE  CNS-RTN-901        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  RTN-CD             OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
                 TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-INFO-ADD-RTN
      *---------- ワーク明細単位実行ステータス
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポートフォリオ終了処理へ
               PERFORM  PTF-END-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  進捗管理更新（先頭）処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       STK-KR-UPDATE-2-EXT.
           EXIT.
      ******************************************************************
      *    3)コミットする
      ******************************************************************
       COMMIT-1-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** コミット 処理  START ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-044          TO  WK-ERR-POS
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-3-RTN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** コミット 処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       COMMIT-1-EXT.
           EXIT.
      ******************************************************************
      *    コミットする
      ******************************************************************
       COMMIT-2-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** コミット 処理  START ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-045          TO  WK-ERR-POS
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-3-RTN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** コミット 処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       COMMIT-2-EXT.
           EXIT.
      ******************************************************************
      *    ポートフォリオエラーメッセージへインサート
      ******************************************************************
       M-FREE-AREA-RTN        SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ← ワーク基準日断面情報の全部
           MOVE  WK-TKMZBW02
             TO  WK-FREE-MSG            OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *-----------------------------------------------------------------
           CONTINUE.
       M-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *    4.1.4.基準日ループ属性データセット
      ******************************************************************
       KJN-YMD-GRP-RTN        SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日ループ属性データセット"
      D             " 処理  START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.運用通貨コード =["
      D             WK-CAPITAL-TUKA-CD  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           MOVE  CNS-OFF                TO  FLG-SEARCH-END
           INITIALIZE  WK-IDX4
           PERFORM  UNTIL  WK-IDX4 = CNS-500  OR FLG-SEARCH-END = CNS-ON
             COMPUTE  WK-IDX4 = WK-IDX4 + CNS-1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク通貨情報.通貨コード("WK-IDX4") =["
      D             WK-TUKA-CD          OF  WK-TUKA-INFO(WK-IDX4)"]"
      *-----------------------------------------------------------------
             IF  WK-CAPITAL-TUKA-CD     OF  WK-TKMZBW02
              =  WK-TUKA-CD             OF  WK-TUKA-INFO(WK-IDX4)
             THEN
      *---------- ワーク通貨デフォールト端数.運用通貨小数点以下桁数 ← 検索したワーク通貨情報.小数点以下桁数
               MOVE  WK-ST-KETASU       OF  WK-TUKA-INFO(WK-IDX4)
                 TO  WK-LC-ST-KETASU    OF  WK-TUKA-DEF-HASU-SYRI-PARM
      *---------- ワーク通貨デフォールト端数.運用通貨端数処理方法 ← 検索したワーク通貨情報.端数処理
               MOVE  WK-HASU            OF  WK-TUKA-INFO(WK-IDX4)
                 TO  WK-LC-HS           OF  WK-TUKA-DEF-HASU-SYRI-PARM
               MOVE  CNS-ON             TO  FLG-SEARCH-END
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "運用通貨小数点以下桁数 =["
      D             WK-LC-ST-KETASU    OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "運用通貨端数処理方法 =["
      D             WK-LC-HS           OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           END-PERFORM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日ループ属性データセット"
      D             " 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       KJN-YMD-GRP-EXT.
           EXIT.
      ******************************************************************
      *    4.1.6.1）再計算履歴データ削除
      ******************************************************************
       CALL-SMZJ1711-RTN      SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 再計算履歴データ削除 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1711-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SMZJ1711-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SMZJ1711-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SMZJ1711-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD          OF  PARM-SMZJ1711-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  PARM-SMZJ1711-ARG1
      *----------  開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  PARM-SMZJ1711-ARG1
      *----------  計算パターン
           MOVE  WK-CALC-PTN            OF  WK-TKMZBW02
             TO  CALC-PTN               OF  PARM-SMZJ1711-ARG1
      *----------  基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG      OF  WK-TKMZBW02
             TO  KH-KAIKEI-BASE-FLG     OF  PARM-SMZJ1711-ARG1
      *---------- 起動ログインユーザ会社コード
           MOVE  WK-LOGIN-CMP-CD        OF  WK-JIKOU-HOZON-INFO
             TO  KIDOU-LOGIN-CMP-CD     OF  PARM-SMZJ1711-ARG1
      *---------- 起動ユーザーID
           MOVE  WK-KIDOU-SID           OF  WK-JIKOU-HOZON-INFO
             TO  KIDOU-SID              OF  PARM-SMZJ1711-ARG1
      *---------- ＧＩＰＳモード
           MOVE  WK-GIPS-MODE           OF  WK-ARG-INFO
             TO  GIPS-MODE              OF  PARM-SMZJ1711-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日=["
      D             KAISI-KJN-YMD       OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             KJN-YMD             OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日の翌日=["
      D             KAISI-KJN-YMD-NEXT  OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計算パターン=["
      D             CALC-PTN            OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ=["
      D             KH-KAIKEI-BASE-FLG  OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ログインユーザ会社コード=["
      D             KIDOU-LOGIN-CMP-CD  OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ユーザーID              =["
      D             KIDOU-SID           OF  PARM-SMZJ1711-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ＧＩＰＳモード              =["
      D             GIPS-MODE           OF  PARM-SMZJ1711-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1711"             USING  PARM-SMZJ1711-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1711)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-046          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 再計算履歴データ削除 処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       CALL-SMZJ1711-EXT.
           EXIT.
      ******************************************************************
      *    4.1.5.対象銘柄（玉）決定処理
      ******************************************************************
       TGT-MEG-KT-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象銘柄（玉）決定 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1510-INOUT
                       PARM-RTNPKG
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  PARM-SMZJ1510-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  PARM-SMZJ1510-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SMZJ1510-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SMZJ1510-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SMZJ1510-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  PARM-SMZJ1510-ARG1
      *---------- 順番
           MOVE  WK-JUNBAN              OF  WK-TKMZBW02
             TO  JUNBAN                 OF  PARM-SMZJ1510-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD          OF  PARM-SMZJ1510-ARG1
      *---------- 開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  PARM-SMZJ1510-ARG1
      *---------- 計算パターン
           MOVE  WK-CALC-PTN            OF  WK-TKMZBW02
             TO  CALC-PTN               OF  PARM-SMZJ1510-ARG1
      *---------- 基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG      OF  WK-TKMZBW02
             TO  KH-KAIKEI-BASE-FLG     OF  PARM-SMZJ1510-ARG1
      *---------- ＧＩＰＳモード
           MOVE  WK-GIPS-MODE           OF  WK-ARG-INFO
             TO  GIPS-MODE              OF  PARM-SMZJ1510-ARG1
      *---------- 処理フラグ
           MOVE  WK-SYORI-FLG
             TO  SYURI-FLG              OF  PARM-SMZJ1510-ARG1
      *---------- 削除用元1210情報パッケージ
           MOVE  WK-DEL-1210-PACKAGE
             TO  DEL-1210-PACKAGE       OF  PARM-SMZJ1510-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             KJN-YMD             OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":順番=["
      D             JUNBAN              OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日=["
      D             KAISI-KJN-YMD       OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計算パターン=["
      D             CALC-PTN            OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ=["
      D             KH-KAIKEI-BASE-FLG  OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ＧＩＰＳモード=["
      D             GIPS-MODE           OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理フラグ=["
      D             SYURI-FLG           OF  PARM-SMZJ1510-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":削除用元1210情報パッケージ=["
      D             DEL-1210-PACKAGE    OF  PARM-SMZJ1510-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1510"             USING  PARM-SMZJ1510-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1510)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             MOVE  SYURI-FLG            OF  PARM-SMZJ1510-ARG2
               TO  WK-SYORI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク処理フラグ=["WK-SYORI-FLG"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-047          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象銘柄（玉）決定 処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TGT-MEG-KT-EXT.
           EXIT.
      ******************************************************************
      *    4.1.8.無用銘柄の取引差分更新処理
      ******************************************************************
       MUYO-MEG-UPDATE-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  無用銘柄の取引差分更新処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  WK-DMN-KJN-YMD-NEXT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク断面別基準日の翌日 =["
      D             WK-DMN-KJN-YMD-NEXT"]"
      *-----------------------------------------------------------------
      *---------- @【SCZY1020】カレンダールーチン
           PERFORM  SCZY1020-RTN
      *---------- A 取引差分更新TBL
           PERFORM  TKMZSK00-UPDATE-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  無用銘柄の取引差分更新処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       MUYO-MEG-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    4.1.8.@【SCZY1020】カレンダールーチン
      ******************************************************************
       SCZY1020-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  【SCZY1020】カレンダールーチン  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1020-INOUT
                       PARM-RTNPKG
      *---------- 機能区分
           MOVE  CNS-IXCAL-FUNCTION-3
             TO  IXCAL-FUNCTION         OF  PARM-SCZY1020-ARG1
      *---------- 基準年月日１
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  IXCAL-KJN-YMD1         OF  PARM-SCZY1020-ARG1
      *---------- 前後区分１
           MOVE  CNS-IXCAL-ZENGO-KBN-1-1
             TO  IXCAL-ZENGO-KBN-1      OF  PARM-SCZY1020-ARG1
      *---------- 前後区分２
           MOVE  CNS-IXCAL-ZENGO-KBN-1-0
             TO  IXCAL-ZENGO-KBN-2      OF  PARM-SCZY1020-ARG1
      *---------- 単位区分
           MOVE  CNS-IXCAL-TANI-KBN-1
             TO  IXCAL-TANI-KBN         OF  PARM-SCZY1020-ARG1
      *---------- 計算ベース区分
           MOVE  CNS-IXCAL-COMP-BASE
             TO  IXCAL-COMP-BASE        OF  PARM-SCZY1020-ARG1
      *---------- 日数
           MOVE  CNS-1
             TO  IXCAL-DAYS             OF  PARM-SCZY1020-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":機能区分  =["
      D             IXCAL-FUNCTION      OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日１  =["
      D             IXCAL-KJN-YMD1      OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前後区分１   =["
      D             IXCAL-ZENGO-KBN-1   OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前後区分２   =["
      D             IXCAL-ZENGO-KBN-2   OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":単位区分   =["
      D             IXCAL-TANI-KBN      OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計算ベース区分   =["
      D             IXCAL-COMP-BASE     OF  PARM-SCZY1020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":日数   =["
      D             IXCAL-DAYS          OF  PARM-SCZY1020-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1020"             USING  PARM-SCZY1020-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1020)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク断面別基準日の翌日←リターンパッケージ.基準年月日2
             MOVE  IXCAL-KJN-YMD2       OF  PARM-SCZY1020-ARG1
               TO  WK-DMN-KJN-YMD-NEXT
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク断面別基準日の翌日 =["
      D             WK-DMN-KJN-YMD-NEXT"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-167          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  【SCZY1020】カレンダールーチン  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY1020-EXT.
           EXIT.
      ******************************************************************
      *    4.1.8.A 取引差分更新TBL
      ******************************************************************
       TKMZSK00-UPDATE-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  取引差分更新TBL  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  H-TKMZSK00-22
                       SQL-UPDATE-1-22
                       SQLSTMT22
                       WK-MSG-1-22
                       WK-MEG-22
                       WK-MSG-22-YKJ
                       WK-MSG-22-UKE
      *---------- Aワーク基準日断面情報.基本会計ベースフラグ＝'1'(約定ベース)の場合
           IF  WK-KH-KK-BASE-FLG        OF  WK-TKMZBW02
            =  CNS-KH-KK-BASE-FLG-1
           THEN
             MOVE  SQL-UPDATE-1-22-YKJ
               TO  SQL-SBN-CALC-FROM    OF  SQL-UPDATE-1-22
             MOVE  WK-MSG-1-22-YKJ
               TO  WK-SBN-CALC-FROM-1   OF  WK-MSG-1-22
           ELSE
             MOVE  SQL-UPDATE-1-22-UKE
               TO  SQL-SBN-CALC-FROM    OF  SQL-UPDATE-1-22
             MOVE  WK-MSG-1-22-UKE
               TO  WK-SBN-CALC-FROM-1   OF  WK-MSG-1-22
           END-IF
      *---------- 差分計算開始日
           MOVE  WK-DMN-KJN-YMD-NEXT
             TO  H-SBN-CALC-FROM        OF  H-TKMZSK00-22,
                 WK-SBN-CALC-FROM       OF  WK-MSG-1-22
      *---------- 最終有効日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  H-LAST-YUKO-YMD        OF  H-TKMZSK00-22,
                 WK-LAST-YUKO-YMD       OF  WK-MSG-1-22
      *---------- 更新ログインユーザ会社コード
           MOVE  COMPANY-CODE           OF  WK-AIFA-IN
             TO  H-UPD-LOGIN-CMP-CD     OF  H-TKMZSK00-22,
                 WK-UPD-LOGIN-CMP-CD    OF  WK-MSG-1-22
      *---------- 更新ユーザＩＤ
           MOVE  SPACE
             TO  H-UPD-SID              OF  H-TKMZSK00-22,
                 WK-UPD-SID             OF  WK-MSG-1-22
      *---------- 更新プログラムＩＤ
           MOVE  CNS-PGM-ID
             TO  H-UPD-PGMID            OF  H-TKMZSK00-22,
                 WK-UPD-PGMID           OF  WK-MSG-1-22
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  H-FUND-CD              OF  H-TKMZSK00-22,
                 WK-FUND-CD             OF  WK-MSG-1-22,
                 WK-FUND-CD-2           OF  WK-MSG-1-22
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  H-PTF-CD               OF  H-TKMZSK00-22,
                 WK-PTF-CD              OF  WK-MSG-1-22,
                 WK-PTF-CD-2            OF  WK-MSG-1-22
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  H-SYORI-YMD            OF  H-TKMZSK00-22,
                 WK-SYORI-YMD           OF  WK-MSG-1-22
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  H-KIDOU-ID             OF  H-TKMZSK00-22,
                 WK-KIDOU-ID            OF  WK-MSG-1-22
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  H-RIYO-CMP-CD          OF  H-TKMZSK00-22,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-22
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  H-KJN-YMD              OF  H-TKMZSK00-22,
                 WK-KJN-YMD             OF  WK-MSG-1-22
      *---------- テーブルID
           MOVE  WK-TBL-TKMZSK00
             TO  SQL-TKMZSK00           OF  SQL-UPDATE-1-22,
                 WK-MSG-TKMZSK00        OF  WK-MSG-1-22
           MOVE  WK-TBL-TKMZBW03
             TO  SQL-TKMZBW03           OF  SQL-UPDATE-1-22,
                 WK-MSG-TKMZBW03        OF  WK-MSG-1-22
           MOVE  WK-DMN-KJN-YMD-NEXT
             TO  WK-DMN-KJN-YMD-NEXT-1  OF  WK-MSG-22-YKJ
           MOVE  WK-DMN-KJN-YMD-NEXT
             TO  WK-DMN-KJN-YMD-NEXT-2  OF  WK-MSG-22-UKE
      *----ＳＱＬ文
      *---------- Aワーク基準日断面情報.基本会計ベースフラグ＝'1'(約定ベース)の場合
           IF  WK-KH-KK-BASE-FLG        OF  WK-TKMZBW02
            =  CNS-KH-KK-BASE-FLG-1
           THEN
             STRING  SQL-UPDATE-1-22,
                     SQL-UPDATE-22-YKJ    DELIMITED  BY  SIZE
               INTO  SQLSTMT22
           ELSE
             STRING  SQL-UPDATE-1-22,
                     SQL-UPDATE-22-UKE    DELIMITED  BY  SIZE
               INTO  SQLSTMT22
           END-IF
           IF  WK-KH-KK-BASE-FLG        OF  WK-TKMZBW02
            =  CNS-KH-KK-BASE-FLG-1
           THEN
             STRING  WK-MSG-1-22,
                     WK-MSG-22-YKJ    DELIMITED  BY  SIZE
               INTO  WK-MEG-22
           ELSE
             STRING  WK-MSG-1-22,
                     WK-MSG-22-UKE    DELIMITED  BY  SIZE
               INTO  WK-MEG-22
           END-IF
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D    "基本会計ベースフラグ=["WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":SQL-SBN-CALC-FROM =["
      D             SQL-SBN-CALC-FROM   OF  SQL-UPDATE-1-22   "]"
      D    DISPLAY  CNS-PGM-ID":差分計算開始日 =["
      D             H-SBN-CALC-FROM     OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":最終有効日 =["
      D             H-LAST-YUKO-YMD     OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード =["
      D             H-UPD-LOGIN-CMP-CD  OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ =["
      D             H-UPD-SID           OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ =["
      D             H-UPD-PGMID         OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             H-PTF-CD            OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             H-SYORI-YMD         OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             H-KIDOU-ID          OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             H-KJN-YMD           OF  H-TKMZSK00-22   "]"
      D    DISPLAY  CNS-PGM-ID":WK-MEG-22=["WK-MEG-22"]"
      D    DISPLAY  CNS-PGM-ID":SQLSTMT22=["SQLSTMT22"]"
      *-----------------------------------------------------------------
           EXEC SQL
               PREPARE  S22  FROM :SQLSTMT22
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-168        TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900        TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MEG-22,
               DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *-----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D              "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           END-IF
           EXEC SQL
               EXECUTE S22
                 USING :H-TKMZSK00-22.H-SBN-CALC-FROM,
                       :H-TKMZSK00-22.H-LAST-YUKO-YMD,
                       :H-TKMZSK00-22.H-UPD-LOGIN-CMP-CD,
                       :H-TKMZSK00-22.H-UPD-SID,
                       :H-TKMZSK00-22.H-UPD-PGMID,
                       :H-TKMZSK00-22.H-FUND-CD,
                       :H-TKMZSK00-22.H-PTF-CD,
                       :H-TKMZSK00-22.H-SYORI-YMD,
                       :H-TKMZSK00-22.H-KIDOU-ID,
                       :H-TKMZSK00-22.H-RIYO-CMP-CD,
                       :H-TKMZSK00-22.H-FUND-CD,
                       :H-TKMZSK00-22.H-PTF-CD,
                       :H-TKMZSK00-22.H-KJN-YMD,
                       :H-TKMZSK00-22.H-SBN-CALC-FROM
           END-EXEC
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-UPDATE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
            OR SQLCODE  =  CNS-SQL-NOTFOUND
           THEN
             CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-169          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MEG-22
               DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D              "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  取引差分更新TBL  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSK00-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    4.1.8.断面別残高計算
      ******************************************************************
       DMN-ZN-CALC-RTN        SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  断面別残高計算  処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2610-INOUT
                       PARM-RTNPKG
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  PARM-SMZJ2610-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  PARM-SMZJ2610-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SMZJ2610-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SMZJ2610-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SMZJ2610-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  PARM-SMZJ2610-ARG1
      *---------- 運用通貨コード
           MOVE  WK-CAPITAL-TUKA-CD     OF  WK-TKMZBW02
             TO  CAPITAL-TUKA-CD        OF  PARM-SMZJ2610-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD          OF  PARM-SMZJ2610-ARG1
      *---------- 開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  PARM-SMZJ2610-ARG1
      *---------- 基準日種類
           MOVE  WK-KJN-YMD-SHRU        OF  WK-TKMZBW02
             TO  KJN-YMD-SHRU           OF  PARM-SMZJ2610-ARG1
      *---------- 基準日断面作成区分
           MOVE  WK-KJN-YMD-DMN-SK-KBN  OF  WK-TKMZBW02
             TO  KJN-YMD-DMN-SK-KBN     OF  PARM-SMZJ2610-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             KJN-YMD             OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨コード=["
      D             CAPITAL-TUKA-CD     OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日=["
      D             KAISI-KJN-YMD       OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日の翌日=["
      D             KAISI-KJN-YMD-NEXT  OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日種類=["
      D             KJN-YMD-SHRU        OF  PARM-SMZJ2610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面作成区分=["
      D             KJN-YMD-DMN-SK-KBN  OF  PARM-SMZJ2610-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2610"             USING  PARM-SMZJ2610-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2610)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID": ***  断面別残高計算 処理 エラー  ***"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-048          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  断面別残高計算  処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DMN-ZN-CALC-EXT.
           EXIT.
      ******************************************************************
      *    4.1.9.DB更新処理
      ******************************************************************
       DB-UPDATE-RTN          SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  DB更新処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2310-INOUT
                       PARM-RTNPKG
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  PARM-SMZJ2310-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  PARM-SMZJ2310-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SMZJ2310-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SMZJ2310-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SMZJ2310-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  PARM-SMZJ2310-ARG1
      *---------- 仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD      OF  WK-TKMZBW02
             TO  SWK-KJN-PTN-CD         OF  PARM-SMZJ2310-ARG1
      *---------- 異動計算パターンコード
           MOVE  WK-IDO-CALC-PATTERN-CD OF  WK-TKMZBW02
             TO  IDO-CALC-PATTERN-CD    OF  PARM-SMZJ2310-ARG1
      *----------  開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  PARM-SMZJ2310-ARG1
      *---------- 起動ログインユーザ会社コード
           MOVE  WK-LOGIN-CMP-CD        OF  WK-JIKOU-HOZON-INFO
             TO  KIDOU-LOGIN-CMP-CD     OF  PARM-SMZJ2310-ARG1
      *---------- 起動ユーザーID
           MOVE  WK-KIDOU-SID           OF  WK-JIKOU-HOZON-INFO
             TO  KIDOU-SID              OF  PARM-SMZJ2310-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準パターンコード=["
      D             SWK-KJN-PTN-CD      OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターンコード=["
      D             IDO-CALC-PATTERN-CD OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日の翌日=["
      D             KAISI-KJN-YMD-NEXT  OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ログインユーザ会社コード=["
      D             KIDOU-LOGIN-CMP-CD  OF  PARM-SMZJ2310-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ユーザーID=["
      D             KIDOU-SID           OF  PARM-SMZJ2310-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2310"             USING  PARM-SMZJ2310-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2310)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- 識別子
             MOVE  CNS-TKMZMS00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(3)
      *---------- 対象処理
             MOVE  CNS-UPDATE
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(3)
      *---------- 処理件数
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(3)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(3)
                   +  MS-SHEKI-COUNT    OF  KOUSIN-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZKR00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(4)
             MOVE  CNS-UPDATE
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(4)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(4)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(4)
                   +  PAST-BOND-KEKA-RSK-COUNT
                                        OF  KOUSIN-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZMS00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(5)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(5)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(5)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(5)
                   +  MS-SHEKI-COUNT    OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZKR00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(6)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(6)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(6)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(6)
                   +  PAST-BOND-KEKA-RSK-COUNT
                                        OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZMB00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(7)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(7)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(7)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(7)
                   +  MAEBR-KIN-KANRI-COUNT
                                        OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZZI00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(8)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(8)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(8)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(8)
                   +  ZANDAKA-IDO-COUNT OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZZR00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(9)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(9)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(9)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(9)
                   +  ZN-RIRK-COUNT     OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZGZ00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(10)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(10)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(10)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(10)
                   +  GNP-ZN-COUNT      OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZSI00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(11)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(11)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(11)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(11)
                   +  SIKIN-BOKA-IDO-COUNT
                                        OF  SINKI-COUNT
             MOVE  CNS-TKMZSR00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(12)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(12)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(12)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(12)
                   +  SIKI-ZN-COUNT     OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZKI00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(13)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(13)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(13)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(13)
                   +  KNJ-IDOK-COUNT    OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZKZ00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(14)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(14)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(14)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(14)
                   +  KNJZN-COUNT       OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZKK00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(15)
             MOVE  CNS-INSERT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(15)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(15)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(15)
                   +  KYJ-YMD-CALC-INFO-COUNT
                                        OF  SINKI-COUNT
                                        OF  PARM-SMZJ2310-ARG2
             MOVE  CNS-TKMZKK00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(16)
             MOVE  CNS-UPDATE
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(16)
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(16)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(16)
                   +  KYJ-YMD-CALC-INFO-COUNT
                                        OF  KOUSIN-COUNT
                                        OF  PARM-SMZJ2310-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(3)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(3)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(3)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(3)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(3)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(3)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(4)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(4)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(4)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(4)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(4)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(4)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(5)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(5)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(5)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(5)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(5)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(5)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(6)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(6)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(6)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(6)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(6)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(6)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(7)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(7)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(7)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(7)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(7)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(7)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(8)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(8)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(8)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(8)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(8)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(8)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(9)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(9)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(9)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(9)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(9)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(9)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(10)"
      D     ".識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(10)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(10)"
      D    ".対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(10)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(10)"
      D    ".処理件数=["WK-DISPOSAL-NUM OF  WK-SCZY7040-ARG2(10)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(11)"
      D      ".識別子=["WK-IDENT-ID     OF  WK-SCZY7040-ARG2(11)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(11)"
      D    ".対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(11)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(11)"
      D    ".処理件数=["WK-DISPOSAL-NUM OF  WK-SCZY7040-ARG2(11)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(12)"
      D      ".識別子=["WK-IDENT-ID     OF  WK-SCZY7040-ARG2(12)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(12)"
      D    ".対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(12)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(12)"
      D    ".処理件数=["WK-DISPOSAL-NUM OF  WK-SCZY7040-ARG2(12)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(13)"
      D      ".識別子=["WK-IDENT-ID     OF  WK-SCZY7040-ARG2(13)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(13)"
      D    ".対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(13)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(13)"
      D    ".処理件数=["WK-DISPOSAL-NUM OF  WK-SCZY7040-ARG2(13)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(14)"
      D      ".識別子=["WK-IDENT-ID     OF  WK-SCZY7040-ARG2(14)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(14)"
      D    ".対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(14)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(14)"
      D    ".処理件数=["WK-DISPOSAL-NUM OF  WK-SCZY7040-ARG2(14)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(15)"
      D      ".識別子=["WK-IDENT-ID     OF  WK-SCZY7040-ARG2(15)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(15)"
      D    ".対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(15)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(15)"
      D    ".処理件数=["WK-DISPOSAL-NUM OF  WK-SCZY7040-ARG2(15)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(16)"
      D      ".識別子=["WK-IDENT-ID     OF  WK-SCZY7040-ARG2(16)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(16)"
      D    ".対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(16)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(16)"
      D    ".処理件数=["WK-DISPOSAL-NUM OF  WK-SCZY7040-ARG2(16)"]"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID": ***  DB更新処理 エラー  ***"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-049          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  DB更新処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    勘定異動バランスチェック
      ******************************************************************
       SMZJ4023-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 勘定異動バランスチェック START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4023-INOUT
                       PARM-RTNPKG
      *----------  処理実行日
           MOVE  WK-SYORI-YMD         OF  WK-TKMZBW02
             TO  SYORI-YMD            OF  PARM-SMZJ4023-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID          OF  WK-TKMZBW02
             TO  KIDOU-ID             OF  PARM-SMZJ4023-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD       OF  WK-TKMZBW02
             TO  RIYO-CMP-CD          OF  PARM-SMZJ4023-ARG1
      *----------  ファンドコード
           MOVE  WK-FUND-CD           OF  WK-TKMZBW02
             TO  FUND-CD              OF  PARM-SMZJ4023-ARG1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD            OF  WK-TKMZBW02
             TO  PTF-CD               OF  PARM-SMZJ4023-ARG1
      *----------  開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  PARM-SMZJ4023-ARG1
      *----------  基準日
           MOVE  WK-KJN-YMD           OF  WK-TKMZBW02
             TO  KJN-YMD              OF  PARM-SMZJ4023-ARG1
      *----------  業務タスクID
           MOVE  WK-GYOMU-TASK-ID     OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID        OF  PARM-SMZJ4023-ARG1
      *----------  基準日From
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  KJN-YMD-FROM         OF  PARM-SMZJ4023-ARG1
      *----------  基準日To
           MOVE  WK-SITEI-TO          OF  WK-DENBUN-KAISEKI-INFO
             TO  KJN-YMD-TO           OF  PARM-SMZJ4023-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報"
      D    DISPLAY  CNS-PGM-ID": 処理実行日           = ["
      D             SYORI-YMD           OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID": 起動ID               = ["
      D             KIDOU-ID            OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID": 利用会社コード       = ["
      D             RIYO-CMP-CD         OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID": ファンドコード       = ["
      D             FUND-CD             OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID": ポートフォリオコード = ["
      D             PTF-CD              OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID": 開始基準日の翌日     = ["
      D             KAISI-KJN-YMD-NEXT  OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID": 基準日               = ["
      D             KJN-YMD             OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID          = ["
      D             GYOMU-TASK-ID       OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日From            = ["
      D             KJN-YMD-FROM        OF  PARM-SMZJ4023-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日To              = ["
      D             KJN-YMD-TO          OF  PARM-SMZJ4023-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4023"             USING  PARM-SMZJ4023-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4023)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-050            TO  WK-ERR-POS
      *---------- ワークエラーパッケージを編集
             MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD                 OF  PARM-RTNPKG
                                              (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D              "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  勘定異動バランスチェック  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4023-EXT.
           EXIT.
      ******************************************************************
      *    4.1.11.勘定残高バランスチェック
      ******************************************************************
       SMZJ4021-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  勘定残高バランスチェック 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4021-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SMZJ4021-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SMZJ4021-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SMZJ4021-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  PARM-SMZJ4021-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  PARM-SMZJ4021-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  PARM-SMZJ4021-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  PARM-SMZJ4021-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  PARM-SMZJ4021-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4021"             USING  PARM-SMZJ4021-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4021)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG            OF  PARM-SMZJ4021-ARG2"]"
      *-----------------------------------------------------------------
             IF  WARN-FLG               OF  PARM-SMZJ4021-ARG2
              =  CNS-WARN-FLG-1
             THEN
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
               MOVE  WK-FUND-CD             OF  WK-PTF-INFO
                 TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
               MOVE  WK-PTF-CD              OF  WK-PTF-INFO
                 TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
               MOVE  WK-MKY-KJN-YMD-FROM
                 TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
               MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
                 TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M14のメッセージID
               MOVE  CNS-MSG-W000562
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- 'マイナス経過利息の仮払金'
               MOVE  CNS-TK-MOJI-64
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
      *← 'ファンドコード：'ワークポートフォリオ情報.ファンドコード
      * ＋'ポートフォリオコード：'ワーク基準日断面情報.ポートフォリオコード
      * ＋'基準日：'ワーク基準日断面情報.基準日
               STRING  CNS-MSG-29,WK-FUND-CD        OF  WK-PTF-INFO,
                       CNS-MSG-30,WK-PTF-CD         OF  WK-TKMZBW02,
                       CNS-MSG-28,WK-KJN-YMD        OF  WK-TKMZBW02
                       DELIMITED  BY  SIZE
                       INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
               COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
               IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
               THEN
                 MOVE  CNS-MT-JS-200        TO  WK-MT-JIKKOU-STATUS
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT2
               THEN
                 MOVE  CNS-RTN-BT2          TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 < CNS-MT-JS-200
               THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '200'(警告終了)
                MOVE  CNS-MT-JS-200
                  TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-051        TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  仮払金未引落チェック処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4021-EXT.
           EXIT.
      ******************************************************************
      *    4.1.10.基準日別終了処理
      ******************************************************************
       KJN-YMD-END-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日別終了処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "（基準日）=["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           IF  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 = CNS-MT-JS-400  OR
               WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 = CNS-MT-JS-275
           THEN
      *---------- 4.1.10.1.ロールバック
             PERFORM  ROLLBACK-ORA-RTN
           ELSE
             CONTINUE
           END-IF
      *---------- 4.1.10.2.基準日別処理の進捗管理のステータス更新処理
           PERFORM  KJN-YMD-UPDATE-RTN
      *---------- 4.1.10.3.次の行方
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "（基準日）=["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           IF  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 = CNS-MT-JS-400  OR
               WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 = CNS-MT-JS-275
           THEN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日別終了処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       KJN-YMD-END-EXT.
           EXIT.
      ******************************************************************
      *    4.1.10.1.ロールバック
      ******************************************************************
       ROLLBACK-ORA-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ＤＢロールバック処理  START  ***"
      *-----------------------------------------------------------------
      *---------- ROLLBACK
           EXEC SQL
               ROLLBACK
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(ROLLBACK)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢロールバック処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢロールバック 処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-052          TO  WK-ERR-POS
      *---------- フリーメッセージ
             MOVE  CNS-ROLLBACK-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-6-RTN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ＤＢロールバック処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ROLLBACK-ORA-EXT.
           EXIT.
      ******************************************************************
      *    4.1.10.2.基準日別処理の進捗管理のステータス更新処理
      ******************************************************************
       KJN-YMD-UPDATE-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日別処理の進捗管理のステータス"
      D             "更新処理  START  ***"
      *-----------------------------------------------------------------
      *---------- 1)更新用進捗ステータス編集
           PERFORM  UPDATE-EDIT-RTN
      *---------- 3)【SCZY1210】進捗管理ＩＮＳＵＰＤルーチン(残高向け)（最終セッション）
           IF  WK-STK-KY-KJN-YMD NOT = ZERO
           THEN
             PERFORM  SCZY1210-2-RTN
           ELSE
             CONTINUE
           END-IF
      *---------- 2)【SCZY1210】進捗管理ＩＮＳＵＰＤルーチン(残高向け)（最終セッション）
           IF  WK-STK-KY-KJN-YMD-99 NOT = ZERO
           THEN
             PERFORM  SCZY1210-RTN
           ELSE
             CONTINUE
           END-IF
      *---------- 4)コミットする
           PERFORM  DB-COMMIT-4-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  基準日別処理の進捗管理のステータス"
      D             "更新処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       KJN-YMD-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    1)更新用進捗ステータス編集
      ******************************************************************
       UPDATE-EDIT-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  更新用進捗ステータス編集 処理 "
      D             " START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"（開始基準日）=[" WK-STK-STS-KS-KJN-YMD OF WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D    "(基準日)=[" WK-STK-STS-KJN-YMD  OF WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 進捗ステータス（開始基準日）
           EVALUATE  WK-STK-STS-KS-KJN-YMD  OF  WK-TKMZBW02
      *---------- '100'(正常終了)
             WHEN  CNS-KJN-YMD-100
      *---------- 進捗ステータス（基準日）
               EVALUATE  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *---------- '100'(正常終了)
                 WHEN  CNS-KJN-YMD-100
                   MOVE  CNS-KJN-YMD-100
                     TO  WK-KY-STK-STS
      *---------- '200'(警告終了)
                 WHEN  CNS-KJN-YMD-200
                   MOVE  CNS-KJN-YMD-200
                     TO  WK-KY-STK-STS
      *---------- '270'(業務エラー(続行可能))
                 WHEN  CNS-KJN-YMD-270
                   MOVE  CNS-KJN-YMD-270
                     TO  WK-KY-STK-STS
      *---------- '275'(業務エラー(明細続行不可))
                 WHEN  CNS-KJN-YMD-275
                   MOVE  CNS-KJN-YMD-275
                     TO  WK-KY-STK-STS
      *---------- '400'(システムエラー)
                 WHEN  CNS-KJN-YMD-400
                   MOVE  CNS-KJN-YMD-400
                     TO  WK-KY-STK-STS
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス=["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- '200'(警告終了)
             WHEN  CNS-KJN-YMD-200
      *---------- 進捗ステータス（基準日）
               EVALUATE  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *---------- '100'(正常終了)
                 WHEN  CNS-KJN-YMD-100
                   MOVE  CNS-KJN-YMD-200
                     TO  WK-KY-STK-STS
      *---------- '200'(警告終了)
                 WHEN  CNS-KJN-YMD-200
                   MOVE  CNS-KJN-YMD-200
                     TO  WK-KY-STK-STS
      *---------- '270'(業務エラー(続行可能))
                 WHEN  CNS-KJN-YMD-270
                   MOVE  CNS-KJN-YMD-270
                     TO  WK-KY-STK-STS
      *---------- '275'(業務エラー(明細続行不可))
                 WHEN  CNS-KJN-YMD-275
                   MOVE  CNS-KJN-YMD-275
                     TO  WK-KY-STK-STS
      *---------- '400'(システムエラー)
                 WHEN  CNS-KJN-YMD-400
                   MOVE  CNS-KJN-YMD-400
                     TO  WK-KY-STK-STS
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス=["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- '270'(業務エラー(続行可能))
             WHEN  CNS-KJN-YMD-270
      *---------- 進捗ステータス（基準日）
               EVALUATE  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *---------- '100'(正常終了)
                 WHEN  CNS-KJN-YMD-100
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '200'(警告終了)
                 WHEN  CNS-KJN-YMD-200
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '270'(業務エラー(続行可能))
                 WHEN  CNS-KJN-YMD-270
                   MOVE  CNS-KJN-YMD-270
                     TO  WK-KY-STK-STS
      *---------- '275'(業務エラー(明細続行不可))
                 WHEN  CNS-KJN-YMD-275
                   MOVE  CNS-KJN-YMD-275
                     TO  WK-KY-STK-STS
      *---------- '400'(システムエラー)
                 WHEN  CNS-KJN-YMD-400
                   MOVE  CNS-KJN-YMD-400
                     TO  WK-KY-STK-STS
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス=["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- '275'(業務エラー(明細続行不可))
             WHEN  CNS-KJN-YMD-275
      *---------- 進捗ステータス（基準日）
               EVALUATE  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *---------- '100'(正常終了)
                 WHEN  CNS-KJN-YMD-100
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '200'(警告終了)
                 WHEN  CNS-KJN-YMD-200
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '270'(業務エラー(続行可能))
                 WHEN  CNS-KJN-YMD-270
                   MOVE  CNS-KJN-YMD-275
                     TO  WK-KY-STK-STS
      *---------- '275'(業務エラー(明細続行不可))
                 WHEN  CNS-KJN-YMD-275
                   MOVE  CNS-KJN-YMD-275
                     TO  WK-KY-STK-STS
      *---------- '400'(システムエラー)
                 WHEN  CNS-KJN-YMD-400
                   MOVE  CNS-KJN-YMD-400
                     TO  WK-KY-STK-STS
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス=["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- '400'(システムエラー)
             WHEN  CNS-KJN-YMD-400
      *---------- 進捗ステータス（基準日）
               EVALUATE  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *---------- '100'(正常終了)
                 WHEN  CNS-KJN-YMD-100
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '200'(警告終了)
                 WHEN  CNS-KJN-YMD-200
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '270'(業務エラー(続行可能))
                 WHEN  CNS-KJN-YMD-270
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '275'(業務エラー(明細続行不可))
                 WHEN  CNS-KJN-YMD-275
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '400'(システムエラー)
                 WHEN  CNS-KJN-YMD-400
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス=["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- '500'(再処理要)
             WHEN  CNS-KJN-YMD-500
      *---------- 進捗ステータス（基準日）
               EVALUATE  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
      *---------- '100'(正常終了)
                 WHEN  CNS-KJN-YMD-100
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '200'(警告終了)
                 WHEN  CNS-KJN-YMD-200
                   MOVE  CNS-KJN-YMD-500
                     TO  WK-KY-STK-STS
      *---------- '270'(業務エラー(続行可能))
                 WHEN  CNS-KJN-YMD-270
                   MOVE  CNS-KJN-YMD-270
                     TO  WK-KY-STK-STS
      *---------- '275'(業務エラー(明細続行不可))
                 WHEN  CNS-KJN-YMD-275
                   MOVE  CNS-KJN-YMD-275
                     TO  WK-KY-STK-STS
      *---------- '400'(システムエラー)
                 WHEN  CNS-KJN-YMD-400
                   MOVE  CNS-KJN-YMD-400
                     TO  WK-KY-STK-STS
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス=["
      D             WK-KY-STK-STS"]"
      *-----------------------------------------------------------------
      *---------- '000'(確定済)
             WHEN  CNS-KJN-YMD-000
      *---------- 進捗ステータス（基準日）
               EVALUATE  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02
      *---------- '100'(正常終了)
                 WHEN  CNS-KJN-YMD-100
                   MOVE  CNS-KJN-YMD-100
                     TO  WK-KY-STK-STS
      *---------- '200'(警告終了)
                 WHEN  CNS-KJN-YMD-200
                   MOVE  CNS-KJN-YMD-200
                     TO  WK-KY-STK-STS
      *---------- '270'(業務エラー(続行可能))
                 WHEN  CNS-KJN-YMD-270
                   MOVE  CNS-KJN-YMD-270
                     TO  WK-KY-STK-STS
      *---------- '275'(業務エラー(明細続行不可))
                 WHEN  CNS-KJN-YMD-275
                   MOVE  CNS-KJN-YMD-275
                     TO  WK-KY-STK-STS
      *---------- '400'(システムエラー)
                 WHEN  CNS-KJN-YMD-400
                   MOVE  CNS-KJN-YMD-400
                     TO  WK-KY-STK-STS
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
             WHEN  OTHER
               CONTINUE
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新用進捗ステータス =["
      D             WK-KY-STK-STS"]"
      D    DISPLAY  CNS-PGM-ID":***  更新用進捗ステータス編集 処理"
      D             " END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       UPDATE-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    2）【SCZY1210】進捗管理ＩＮＳＵＰＤルーチン(残高向け)（最終セッション）
      ******************************************************************
       SCZY1210-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤルーチン"
      D             "処理(残高向け)（最終セッション）  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1210-INOUT
                       PARM-RTNPKG
      *---------- セッション区分←"1":最終セッション
           MOVE  CNS-SESSION-KBN-1
             TO  SESION-KBN             OF  PARM-SCZY1210-ARG1
      *---------- OL/BT区分←"BT":バッチ用
           MOVE  CNS-BT
             TO  OLBT-KBN               OF  PARM-SCZY1210-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SCZY1210-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  PARM-SCZY1210-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  PARM-SCZY1210-ARG2
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY1210-ARG2
      *---------- 基準年月日/基準年月
           MOVE  WK-STK-KY-KJN-YMD-99
             TO  KJN-YMD                OF  PARM-SCZY1210-ARG2
      *---------- 最終処理基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  SS-SYORI-YMD           OF  PARM-SCZY1210-ARG2
      *---------- 再処理基準日FROM
           MOVE  WK-REDO-KJN-YMD-FROM
             TO  REDO-KJN-YMD-FROM      OF  PARM-SCZY1210-ARG2
      *---------- ベビー未処理フラグ
           MOVE  SPACE
             TO  BABY-MISYORI-FLG       OF  PARM-SCZY1210-ARG2
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SCZY1210-ARG2
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SCZY1210-ARG2
      *---------- 評価系列コード
           MOVE  SPACE
             TO  HYK-KRTU-CD            OF  PARM-SCZY1210-ARG2
      *---------- 帳票ID
           MOVE  SPACE
             TO  REP-ID                 OF  PARM-SCZY1210-ARG2
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  REP-ANY-CD             OF  PARM-SCZY1210-ARG2
      *---------- 基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  KJN-YMD-FROM           OF  PARM-SCZY1210-ARG2
      *---------- 進捗ステータス
           MOVE  WK-KY-STK-STS
             TO  JIKOU-STS              OF  PARM-SCZY1210-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分=["
      D             SESION-KBN          OF  PARM-SCZY1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分=["
      D             OLBT-KBN            OF  PARM-SCZY1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日/基準年月=["
      D             KJN-YMD             OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終処理基準日=["
      D             SS-SYORI-YMD        OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":再処理基準日FROM=["
      D             REDO-KJN-YMD-FROM   OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ベビー未処理フラグ=["
      D             BABY-MISYORI-FLG    OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             HYK-KRTU-CD         OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
      D             REP-ANY-CD          OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM=["
      D             KJN-YMD-FROM        OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":進捗ステータス=["
      D             JIKOU-STS           OF  PARM-SCZY1210-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1210"             USING  PARM-SCZY1210-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
             PERFORM  SUB-ERR-MSG-RTN
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-053          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD                 OF  PARM-RTNPKG
                                              (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
             THEN
               MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  進捗管理ＩＮＳＵＰＤルーチン"
      D             "処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY1210-EXT.
           EXIT.
      ******************************************************************
      *    2）【SCZY1210】進捗管理ＩＮＳＵＰＤルーチン
      ******************************************************************
       SCZY1210-2-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤルーチン"
      D             "処理2  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY1210-INOUT
                       PARM-RTNPKG
      *---------- セッション区分←"1":最終セッション
           MOVE  CNS-SESSION-KBN-1
             TO  SESION-KBN             OF  PARM-SCZY1210-ARG1
      *---------- OL/BT区分←"BT":バッチ用
           MOVE  CNS-BT
             TO  OLBT-KBN               OF  PARM-SCZY1210-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SCZY1210-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  PARM-SCZY1210-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  PARM-SCZY1210-ARG2
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY1210-ARG2
      *---------- 基準年月日/基準年月
           MOVE  WK-STK-KY-KJN-YMD
             TO  KJN-YMD                OF  PARM-SCZY1210-ARG2
      *---------- 最終処理基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  SS-SYORI-YMD           OF  PARM-SCZY1210-ARG2
      *---------- 再処理基準日FROM
           MOVE  WK-REDO-KJN-YMD-FROM
             TO  REDO-KJN-YMD-FROM      OF  PARM-SCZY1210-ARG2
      *---------- ベビー未処理フラグ
           MOVE  SPACE
             TO  BABY-MISYORI-FLG       OF  PARM-SCZY1210-ARG2
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  PARM-SCZY1210-ARG2
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  PARM-SCZY1210-ARG2
      *---------- 評価系列コード
           MOVE  SPACE
             TO  HYK-KRTU-CD            OF  PARM-SCZY1210-ARG2
      *---------- 帳票ID
           MOVE  SPACE
             TO  REP-ID                 OF  PARM-SCZY1210-ARG2
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  REP-ANY-CD             OF  PARM-SCZY1210-ARG2
      *---------- 基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  KJN-YMD-FROM           OF  PARM-SCZY1210-ARG2
      *---------- 進捗ステータス
           MOVE  WK-KY-STK-STS
             TO  JIKOU-STS              OF  PARM-SCZY1210-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分=["
      D             SESION-KBN          OF  PARM-SCZY1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":OL/BT区分=["
      D             OLBT-KBN            OF  PARM-SCZY1210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準年月日/基準年月=["
      D             KJN-YMD             OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":最終処理基準日=["
      D             SS-SYORI-YMD        OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":再処理基準日FROM=["
      D             REDO-KJN-YMD-FROM   OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ベビー未処理フラグ=["
      D             BABY-MISYORI-FLG    OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード=["
      D             HYK-KRTU-CD         OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID=["
      D             REP-ID              OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
      D             REP-ANY-CD          OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM=["
      D             KJN-YMD-FROM        OF  PARM-SCZY1210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":進捗ステータス=["
      D             JIKOU-STS           OF  PARM-SCZY1210-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY1210"             USING  PARM-SCZY1210-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
               PERFORM  SUB-ERR-MSG-RTN
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- ポジション
               MOVE  CNS-POS-054        TO  WK-ERR-POS
      *---------- リターンコード
               MOVE  CNS-RTN-901        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  RTN-CD             OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
                 TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               MOVE  SPACE
                 TO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-INFO-ADD-RTN
      *---------- ワーク明細単位実行ステータス
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
               MOVE  CNS-MT-JS-400
                 TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  進捗管理ＩＮＳＵＰＤルーチン"
      D             "処理2  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY1210-2-EXT.
           EXIT.
      ******************************************************************
      *   4)コミットする
      ******************************************************************
       DB-COMMIT-4-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-055          TO  WK-ERR-POS
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-3-RTN
      *---------- ポートフォリオ終了処理へ
             PERFORM  PTF-END-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-COMMIT-4-EXT.
           EXIT.
      ******************************************************************
      *   4.1.11.基準日断面情報データカーソルクローズ処理
      ******************************************************************
      * TKMZBW02-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  基準日断面情報データカーソル"
      *D             "クローズ 処理  START  ***"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *         CLOSE TKMZBW02_CURSOR
      *     END-EXEC
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *       MOVE  CNS-OFF              TO  FLG-TKMZBW02-CR-OPEN
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW02-CR-OPEN=["
      *D             FLG-TKMZBW02-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     ELSE
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQL処理エラー（CLOSE)"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      **---------- ポジション
      *       MOVE  CNS-POS-056          TO  WK-ERR-POS
      **---------- フリーメッセージ
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-2         DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-6-RTN
      **---------- ポートフォリオ終了処理へ
      *       PERFORM  PTF-END-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  基準日断面情報データカーソル"
      *D             "クローズ 処理 END  ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW02-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    4.1.6.対象銘柄（玉）別処理 ループ処理 ※「4.2処理」
      ******************************************************************
       TGT-MEG-KT-GRP-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象銘柄（玉）別処理 ループ処理"
      D            "  START  ***"
      *-----------------------------------------------------------------
      *---------- 4.2.5.再計算データ削除処理
           PERFORM  SMZJ1710-RTN
      *---------- 4.2.1.銘柄別断面情報データを取得
           PERFORM  TKMZBW03-GET-RTN
           MOVE  CNS-OFF                TO  FLG-FETCH-SYUURYOU2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU2=["
      D             FLG-FETCH-SYUURYOU2"]"
      *-----------------------------------------------------------------
           PERFORM  UNTIL  FLG-FETCH-SYUURYOU2 = CNS-ON
                       OR  FLG-PTF = CNS-ON
      *---------- 4.2.2.銘柄別断面情報データカーソルフェッチして
             PERFORM  TKMZBW03-FET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU2=["
      D             FLG-FETCH-SYUURYOU2"]"
      *-----------------------------------------------------------------
             IF  FLG-FETCH-SYUURYOU2 = CNS-ON
             THEN
               CONTINUE
             ELSE
      *---------- 4.2.3.銘柄断面ループ属性データセット
               PERFORM  MEG-DMN-GRP-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
               IF  FLG-TORI-UPD = CNS-1
               THEN
                 CONTINUE
               ELSE
      *---------- 4.2.4.約定ベース受渡順差分更新特殊削除処理
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク約定ベース受渡順フラグ        =["
      D             WK-YKJ-UKE-JUN-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日 =["
      D             WK-SABON-UPDATE-FROM OF WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類       =["
      D             WK-MEG-CD-SHRU       OF WK-TKMZBW03"]"
      *-----------------------------------------------------------------
                 IF  WK-YKJ-UKE-JUN-FLG  =  CNS-X-1
                  AND ( WK-MEG-CD-SHRU     OF WK-TKMZBW03 = CNS-X-1
                   OR   WK-MEG-CD-SHRU     OF WK-TKMZBW03 = CNS-X-2 )
                 THEN
                   PERFORM  SMZJ1712-RTN
                 ELSE
                   CONTINUE
                 END-IF
      *---------- 4.2.4.開始時残高計算処理
                 PERFORM  KAISI-ZN-CALC-RTN
      *---------- 4.2.5.銘柄別断面情報データチェック処理
                 PERFORM  MEG-DMN-CHECK-RTN
                 IF  FLG-PTF = CNS-ON  OR  FLG-TORI-UPD = CNS-1
                 THEN
                   CONTINUE
                 ELSE
      *---------- 4.2.6.LC未収収益計算処理
                   PERFORM  LC-MS-CALC-RTN
                   IF  FLG-PTF = CNS-ON
                   THEN
                     CONTINUE
                   ELSE
      *----------- 4.2.7.銘柄別残高計算
                     PERFORM  MEG-ZN-CALC-RTN
                   END-IF
                   IF  FLG-PTF = CNS-ON
                   THEN
                     CONTINUE
                   ELSE
      *----------- 4.2.8.仮払金未引落チェック
                     PERFORM  SPAY-HIKI-CHECK-RTN
                   END-IF
                   IF  FLG-PTF = CNS-ON
                   THEN
                     CONTINUE
                   ELSE
      *----------- 4.2.10.銘柄別メッセージ登録処理
                     PERFORM  MEG-LOGIN-RTN
                   END-IF
                 END-IF
               END-IF
             END-IF
           END-PERFORM
      *    IF  FLG-PTF = CNS-ON
      *    THEN
      *      CONTINUE
      *    ELSE
      *---------- 4.2.9.銘柄別断面情報データカーソルクローズ処理
      *      PERFORM  TKMZBW03-CLOSE-RTN
      *    END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象銘柄（玉）別処理 ループ処理"
      D            "  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TGT-MEG-KT-GRP-EXT.
           EXIT.
      ******************************************************************
      *    4.2.1.銘柄別断面情報データを取得
      ******************************************************************
       TKMZBW03-GET-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別断面情報データを取得 処理"
      D            "  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報. "                 @3212SEINO@@
      D             "基本会計ベースフラグ=["                            @3212SEINO@@
      D              WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02"]"              @3212SEINO@@
      *-----------------------------------------------------------------
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02                       @3212SEINO@@
            =  CNS-KH-KK-BASE-FLG-1                                     @3212SEINO@@
           THEN                                                         @3212SEINO@@
      *-----------  カーソル定義処理
             PERFORM  TKMZBW03-DEC-RTN
      *-----------  カーソルオープン処理
             PERFORM  TKMZBW03-OPEN-RTN
           ELSE                                                         @3212SEINO@@
      *-----------  カーソル定義処理                                    @3212SEINO@@
             PERFORM  TKMZBW03-DEC-1-RTN                                @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 銘柄別断面情報データを取得 処理"
      D             " END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW03-GET-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKMZBW03-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  H-SYORI-YMD            OF  H-TKMZBW03-S,
                 WK-SYORI-YMD-1S        OF  WK-MSG-1-3,
                 WK-SYORI-YMD-2S        OF  WK-MSG-1-3
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  H-KIDOU-ID             OF  H-TKMZBW03-S,
                 WK-KIDOU-ID-1S         OF  WK-MSG-1-3,
                 WK-KIDOU-ID-2S         OF  WK-MSG-1-3
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW03-S,
                 WK-RIYO-CMP-CD-1S      OF  WK-MSG-1-3,
                 WK-RIYO-CMP-CD-2S      OF  WK-MSG-1-3,
                 WK-RIYO-CMP-CD-3S      OF  WK-MSG-1-3
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  H-FUND-CD              OF  H-TKMZBW03-S,
                 WK-FUND-CD-1S          OF  WK-MSG-1-3,
                 WK-FUND-CD-2S          OF  WK-MSG-1-3,
                 WK-FUND-CD-3S          OF  WK-MSG-1-3
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  H-PTF-CD               OF  H-TKMZBW03-S,
                 WK-PTF-CD-1S           OF  WK-MSG-1-3,
                 WK-PTF-CD-2S           OF  WK-MSG-1-3,
                 WK-PTF-CD-3S           OF  WK-MSG-1-3
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  H-KJN-YMD              OF  H-TKMZBW03-S,
                 WK-KJN-YMD-1S          OF  WK-MSG-1-3,
                 WK-KJN-YMD-2S          OF  WK-MSG-1-3
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02
            =  CNS-KH-KK-BASE-FLG-1
           THEN
             MOVE  CNS-YKJ-YMD
               TO  WK-DATE              OF  SQL-SELECT-1-3,
                   WK-DATE              OF  WK-MSG-1-3
           ELSE
             MOVE  CNS-UKE-YMD
               TO  WK-DATE              OF  SQL-SELECT-1-3,
                   WK-DATE              OF  WK-MSG-1-3
           END-IF
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  H-DMKJN-YMD-S1         OF  H-TKMZBW03-S,
                 WK-DMKJN-YMD-S1        OF  WK-MSG-1-3
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  H-DMKJN-YMD-S2         OF  H-TKMZBW03-S,
                 WK-DMKJN-YMD-S2        OF  WK-MSG-1-3
      *---------- テーブルID
           MOVE  WK-TBL-TKMZBW03
             TO  SQL1-TKMZBW03          OF  SQL-SELECT-1-3,
                 SQL3-TKMZBW03          OF  SQL-SELECT-1-3,
                 WK-TAB1-TKMZBW03       OF  WK-MSG-1-3,
                 WK-TAB3-TKMZBW03       OF  WK-MSG-1-3
           MOVE  WK-TBL-TKMXTR00
             TO  SQL2-TKMXTR00          OF  SQL-SELECT-1-3,
                 WK-TAB2-TKMXTR00       OF  WK-MSG-1-3
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             H-SYORI-YMD         OF  H-TKMZBW03-S"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             H-KIDOU-ID          OF  H-TKMZBW03-S"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZBW03-S"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZBW03-S"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             H-PTF-CD            OF  H-TKMZBW03-S"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             H-KJN-YMD           OF  H-TKMZBW03-S"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報. "
      D             "基本会計ベースフラグ=["
      D              WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":WK-DATE  OF  SQL-SELECT-1-3=["
      D             WK-DATE             OF  SQL-SELECT-1-3"]"
      D    DISPLAY  CNS-PGM-ID":H-DMKJN-YMD-S1  OF  H-TKMZBW03-S=["
      D             H-DMKJN-YMD-S1      OF  H-TKMZBW03-S"]"
      D    DISPLAY  CNS-PGM-ID":H-DMKJN-YMD-S2  OF  H-TKMZBW03-S=["
      D             H-DMKJN-YMD-S2      OF  H-TKMZBW03-S"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT3                                         @3212SEINO@@
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-3         TO  SQLSTMT3                    @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT3=["SQLSTMT3"]"                  @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW03-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMZBW03-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZBW03-CR-OPEN  NOT = CNS-ON                       @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
               PREPARE  S3  FROM :SQLSTMT3                              @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-057          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-3         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
           EXEC  SQL  DECLARE  TKMZBW03_CURSOR  CURSOR  FOR  S3 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
           CONTINUE.
       TKMZBW03-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKMZBW03-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKMZBW03_CURSOR
                 USING :H-TKMZBW03-S.H-SYORI-YMD,
                       :H-TKMZBW03-S.H-KIDOU-ID,
                       :H-TKMZBW03-S.H-RIYO-CMP-CD,
                       :H-TKMZBW03-S.H-FUND-CD,
                       :H-TKMZBW03-S.H-PTF-CD,
                       :H-TKMZBW03-S.H-KJN-YMD,
                       :H-TKMZBW03-S.H-SYORI-YMD,
                       :H-TKMZBW03-S.H-KIDOU-ID,
                       :H-TKMZBW03-S.H-RIYO-CMP-CD,
                       :H-TKMZBW03-S.H-FUND-CD,
                       :H-TKMZBW03-S.H-PTF-CD,
                       :H-TKMZBW03-S.H-KJN-YMD,
                       :H-TKMZBW03-S.H-RIYO-CMP-CD,
                       :H-TKMZBW03-S.H-FUND-CD,
                       :H-TKMZBW03-S.H-PTF-CD,
                       :H-TKMZBW03-S.H-DMKJN-YMD-S1,
                       :H-TKMZBW03-S.H-DMKJN-YMD-S2
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZBW03-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW03-CR-OPEN=["
      D             FLG-TKMZBW03-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-058          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-3         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW03-OPEN-EXT.
           EXIT.
      ******************************************************************@3212SEINO@
      *    カーソル定義処理                                             @3212SEINO@
      ******************************************************************@3212SEINO@
       TKMZBW03-DEC-1-RTN     SECTION.                                  @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"       @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- 処理実行日                                            @3212SEINO@
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-SYORI-YMD            OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-SYORI-YMD-1S        OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-SYORI-YMD-2S        OF  WK-MSG-1-3                  @3212SEINO@
      *---------- 起動ID                                                @3212SEINO@
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-KIDOU-ID             OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-KIDOU-ID-1S         OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-KIDOU-ID-2S         OF  WK-MSG-1-3                  @3212SEINO@
      *---------- 利用会社コード                                        @3212SEINO@
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-RIYO-CMP-CD-1S      OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-RIYO-CMP-CD-2S      OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-RIYO-CMP-CD-3S      OF  WK-MSG-1-3                  @3212SEINO@
      *---------- ファンドコード                                        @3212SEINO@
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-FUND-CD              OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-FUND-CD-1S          OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-FUND-CD-2S          OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-FUND-CD-3S          OF  WK-MSG-1-3                  @3212SEINO@
      *---------- ポートフォリオコード                                  @3212SEINO@
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-PTF-CD               OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-PTF-CD-1S           OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-PTF-CD-2S           OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-PTF-CD-3S           OF  WK-MSG-1-3                  @3212SEINO@
      *---------- 基準日                                                @3212SEINO@
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-KJN-YMD              OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-KJN-YMD-1S          OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-KJN-YMD-2S          OF  WK-MSG-1-3                  @3212SEINO@
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02                       @3212SEINO@
            =  CNS-KH-KK-BASE-FLG-1                                     @3212SEINO@
           THEN                                                         @3212SEINO@
             MOVE  CNS-YKJ-YMD                                          @3212SEINO@
               TO  WK-DATE              OF  SQL-SELECT-1-3,             @3212SEINO@
                   WK-DATE              OF  WK-MSG-1-3                  @3212SEINO@
           ELSE                                                         @3212SEINO@
             MOVE  CNS-UKE-YMD                                          @3212SEINO@
               TO  WK-DATE              OF  SQL-SELECT-1-3,             @3212SEINO@
                   WK-DATE              OF  WK-MSG-1-3                  @3212SEINO@
           END-IF                                                       @3212SEINO@
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-DMKJN-YMD-S1         OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-DMKJN-YMD-S1        OF  WK-MSG-1-3                  @3212SEINO@
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02                 @3212SEINO@
             TO  H-DMKJN-YMD-S2         OF  H-TKMZBW03-S,               @3212SEINO@
                 WK-DMKJN-YMD-S2        OF  WK-MSG-1-3                  @3212SEINO@
      *---------- テーブルID                                            @3212SEINO@
           MOVE  WK-TBL-TKMZBW03                                        @3212SEINO@
             TO  SQL1-TKMZBW03          OF  SQL-SELECT-1-3,             @3212SEINO@
                 SQL3-TKMZBW03          OF  SQL-SELECT-1-3,             @3212SEINO@
                 WK-TAB1-TKMZBW03       OF  WK-MSG-1-3,                 @3212SEINO@
                 WK-TAB3-TKMZBW03       OF  WK-MSG-1-3                  @3212SEINO@
           MOVE  WK-TBL-TKMXTR00                                        @3212SEINO@
             TO  SQL2-TKMXTR00          OF  SQL-SELECT-1-3,             @3212SEINO@
                 WK-TAB2-TKMXTR00       OF  WK-MSG-1-3                  @3212SEINO@
      *----------------------<DEBUG>------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["                          @3212SEINO@
      D             H-SYORI-YMD         OF  H-TKMZBW03-S"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":起動ID =["                              @3212SEINO@
      D             H-KIDOU-ID          OF  H-TKMZBW03-S"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["                      @3212SEINO@
      D             H-RIYO-CMP-CD       OF  H-TKMZBW03-S"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["                      @3212SEINO@
      D             H-FUND-CD           OF  H-TKMZBW03-S"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["                @3212SEINO@
      D             H-PTF-CD            OF  H-TKMZBW03-S"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":基準日 =["                              @3212SEINO@
      D             H-KJN-YMD           OF  H-TKMZBW03-S"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報. "                 @3212SEINO@
      D             "基本会計ベースフラグ=["                            @3212SEINO@
      D              WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02"]"              @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":WK-DATE  OF  SQL-SELECT-1-3=["          @3212SEINO@
      D             WK-DATE             OF  SQL-SELECT-1-3"]"           @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":H-DMKJN-YMD-S1  OF  H-TKMZBW03-S=["     @3212SEINO@
      D             H-DMKJN-YMD-S1      OF  H-TKMZBW03-S"]"             @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":H-DMKJN-YMD-S2  OF  H-TKMZBW03-S=["     @3212SEINO@
      D             H-DMKJN-YMD-S2      OF  H-TKMZBW03-S"]"             @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           INITIALIZE  SQLSTMT3-1                                       @3212SEINO@
      *---------- ＳＱＬ文                                              @3212SEINO@
           MOVE  SQL-SELECT-1-3         TO  SQLSTMT3-1                  @3212SEINO@
      *----------------------<DEBUG>------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":SQLSTMT3-1=["SQLSTMT3-1"]"              @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW03-CR1-OPEN=["                @3212SEINO@
      D             FLG-TKMZBW03-CR1-OPEN"]"                            @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF  FLG-TKMZBW03-CR1-OPEN  NOT = CNS-ON                      @3212SEINO@
           THEN                                                         @3212SEINO@
           EXEC  SQL                                                    @3212SEINO@
               PREPARE  A3  FROM :SQLSTMT3-1                            @3212SEINO@
           END-EXEC                                                     @3212SEINO@
      *-----------------------DEBUG-------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"            @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF  SQLCODE  =  CNS-SQL-NORMAL                               @3212SEINO@
           THEN                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
           ELSE                                                         @3212SEINO@
      *----------------------<DEBUG>------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"                @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- ワークエラーパッケージを編集                          @3212SEINO@
             INITIALIZE  WK-SYS-ERR-INFO                                @3212SEINO@
             MOVE  CNS-POS-057          TO  WK-ERR-POS                  @3212SEINO@
             STRING  CNS-SQL-MSG-SELECT,                                @3212SEINO@
                     WK-MSG-1-3         DELIMITED  BY  SIZE             @3212SEINO@
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO             @3212SEINO@
             PERFORM  ERR-MSG-2-RTN                                     @3212SEINO@
           END-IF                                                       @3212SEINO@
           EXEC  SQL  DECLARE  TKMZBW03_CURSOR1 CURSOR  FOR  A3 END-EXEC@3212SEINO@
      *-----------------------DEBUG-------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"            @3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"         @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           ELSE                                                         @3212SEINO@
             CONTINUE                                                   @3212SEINO@
           END-IF                                                       @3212SEINO@
      *-----------------------DEBUG-------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"   @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           EXEC  SQL                                                    @3212SEINO@
               OPEN TKMZBW03_CURSOR1                                    @3212SEINO@
                 USING :H-TKMZBW03-S.H-SYORI-YMD,                       @3212SEINO@
                       :H-TKMZBW03-S.H-KIDOU-ID,                        @3212SEINO@
                       :H-TKMZBW03-S.H-RIYO-CMP-CD,                     @3212SEINO@
                       :H-TKMZBW03-S.H-FUND-CD,                         @3212SEINO@
                       :H-TKMZBW03-S.H-PTF-CD,                          @3212SEINO@
                       :H-TKMZBW03-S.H-KJN-YMD,                         @3212SEINO@
                       :H-TKMZBW03-S.H-SYORI-YMD,                       @3212SEINO@
                       :H-TKMZBW03-S.H-KIDOU-ID,                        @3212SEINO@
                       :H-TKMZBW03-S.H-RIYO-CMP-CD,                     @3212SEINO@
                       :H-TKMZBW03-S.H-FUND-CD,                         @3212SEINO@
                       :H-TKMZBW03-S.H-PTF-CD,                          @3212SEINO@
                       :H-TKMZBW03-S.H-KJN-YMD,                         @3212SEINO@
                       :H-TKMZBW03-S.H-RIYO-CMP-CD,                     @3212SEINO@
                       :H-TKMZBW03-S.H-FUND-CD,                         @3212SEINO@
                       :H-TKMZBW03-S.H-PTF-CD,                          @3212SEINO@
                       :H-TKMZBW03-S.H-DMKJN-YMD-S1,                    @3212SEINO@
                       :H-TKMZBW03-S.H-DMKJN-YMD-S2                     @3212SEINO@
           END-EXEC                                                     @3212SEINO@
      *-----------------------DEBUG-------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"               @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           IF  SQLCODE = CNS-SQL-NORMAL                                 @3212SEINO@
           THEN                                                         @3212SEINO@
             MOVE  CNS-ON               TO  FLG-TKMZBW03-CR1-OPEN       @3212SEINO@
      *-----------------------DEBUG-------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW03-CR1-OPEN=["                @3212SEINO@
      D             FLG-TKMZBW03-CR1-OPEN"]"                            @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           ELSE                                                         @3212SEINO@
      *-----------------------DEBUG-------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"                   @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
      *---------- ワークエラーパッケージを編集                          @3212SEINO@
             INITIALIZE  WK-SYS-ERR-INFO                                @3212SEINO@
             MOVE  CNS-POS-058          TO  WK-ERR-POS                  @3212SEINO@
             STRING  CNS-SQL-MSG-SELECT,                                @3212SEINO@
                     WK-MSG-1-3         DELIMITED  BY  SIZE             @3212SEINO@
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO             @3212SEINO@
             PERFORM  ERR-MSG-2-RTN                                     @3212SEINO@
           END-IF                                                       @3212SEINO@
      *-------------------<DEBUG>---------------------------------------@3212SEINO@
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"     @3212SEINO@
      *-----------------------------------------------------------------@3212SEINO@
           CONTINUE.                                                    @3212SEINO@
       TKMZBW03-DEC-1-EXT.                                              @3212SEINO@
           EXIT.                                                        @3212SEINO@
      ******************************************************************
      *    4.2.2.銘柄別断面情報データカーソルフェッチして
      ******************************************************************
       TKMZBW03-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 銘柄別断面情報データカーソル"
      D             "フェッチ処理 START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報. "                 @3212SEINO@@
      D             "基本会計ベースフラグ=["                            @3212SEINO@@
      D              WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02"]"              @3212SEINO@@
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMZBW03-3
           IF  WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02                       @3212SEINO@@
            =  CNS-KH-KK-BASE-FLG-1                                     @3212SEINO@@
           THEN                                                         @3212SEINO@@
             EXEC  SQL
                 FETCH
                      TKMZBW03_CURSOR
                 INTO :H-TKMZBW03-3.H-MEG-CD,
                      :H-TKMZBW03-3.H-SEC-SBT-CD,
                      :H-TKMZBW03-3.H-TATE-FLG,
                      :H-TKMZBW03-3.H-GYOKU-ID,
                      :H-TKMZBW03-3.H-SIJO-TUKA-CD,
                      :H-TKMZBW03-3.H-SABON-UPDATE-FROM,
                      :H-TKMZBW03-3.H-MEG-CD-SHRU,
                      :H-TKMZBW03-3.H-SAI-CALC-KBN,
                      :H-TKMZBW03-3.H-MEG-CD-SHRU2
             END-EXEC
             CONTINUE                                                   @3212SEINO@
           ELSE                                                         @3212SEINO@
             EXEC  SQL                                                  @3212SEINO@
                 FETCH                                                  @3212SEINO@
                      TKMZBW03_CURSOR1                                  @3212SEINO@
                 INTO :H-TKMZBW03-3.H-MEG-CD,                           @3212SEINO@
                      :H-TKMZBW03-3.H-SEC-SBT-CD,                       @3212SEINO@
                      :H-TKMZBW03-3.H-TATE-FLG,                         @3212SEINO@
                      :H-TKMZBW03-3.H-GYOKU-ID,                         @3212SEINO@
                      :H-TKMZBW03-3.H-SIJO-TUKA-CD,                     @3212SEINO@
                      :H-TKMZBW03-3.H-SABON-UPDATE-FROM,                @3212SEINO@
                      :H-TKMZBW03-3.H-MEG-CD-SHRU,                      @3212SEINO@
                      :H-TKMZBW03-3.H-SAI-CALC-KBN,                     @3212SEINO@
                      :H-TKMZBW03-3.H-MEG-CD-SHRU2                      @3212SEINO@
             END-EXEC                                                   @3212SEINO@
             CONTINUE                                                   @3212SEINO@
           END-IF                                                       @3212SEINO@
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
      *---------- 1)ワーク銘柄別断面情報を初期化
               INITIALIZE  WK-TKMZBW03
                           WK-TKMZZR00
                           WK-TKMZSR00
                           WK-TKMZGZ00
                           WK-MEG-ZOK-INFO
                           WK-SPAY-PLUS-TORI-FLG
                           WK-SPAY-PLUS-TRKJ-KJB
                           WK-BC-HS  OF  WK-TUKA-DEF-HASU-SYRI-PARM
                           WK-BC-ST-KETASU OF WK-TUKA-DEF-HASU-SYRI-PARM
                           WK-KEISAN-FLG1
                           WK-KEISAN-FLG2
                           WK-KEISAN-FLG3
                           WK-KJN-YMD-KEKA-RSK-DATA
                           WK-AITAI-TRHK-DATA
                           WK-TRHK-DATA
                           WK-TZ-ZN-IDO
                           WK-ELS0-PTN
                           WK-IDO-CALC-PATTERN-INFO
                           WK-MEG-CD-REF
                           WK-GAIBU-MEG-CD-SSC
                           WK-GAIBU-MEG-CD-STC
                           WK-TORI-UPD-FLG
                           WK-SAIKS-SURYO-TANI
                           WK-ZOUGENJYUN-SOTAIBT-KBN
                           WK-KAISI-ZN-FLG
                           WK-0-CUPON-FLG
                           WK-MSG-FLG-1
                           WK-MSG-FLG-2
                           WK-MSG-FLG-3
                           WK-MSG-FLG-4
                           PARM-SMZJ2211-INOUT
                           PARM-SMZJ2150-INOUT
               MOVE  CNS-X-1            TO  WK-ZN-CALC-FLG
      *---------- ワーク取引存在フラグ
               MOVE  CNS-KJ-DMN-0       TO  WK-TRHK-SONZAI-FLG
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-MEG-ZOK-INFO=["WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":FLG-MEG-ZOK=["FLG-MEG-ZOK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク仮払金増加の取引存在フラグ=["
      D             WK-SPAY-PLUS-TORI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク仮払金増加の取引計上基準日=["
      D             WK-SPAY-PLUS-TRKJ-KJB"]"
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "市場通貨小数点以下桁数=["
      D             WK-BC-ST-KETASU  OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "市場通貨端数処理方法=["
      D             WK-BC-HS        OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引存在フラグ=["
      D                                         WK-TRHK-SONZAI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":未収配当計算コールフラグ =["
      D                                             WK-KEISAN-FLG1"]"
      D    DISPLAY  CNS-PGM-ID":債券過去経過利息計算コールフラグ =["
      D                                             WK-KEISAN-FLG2"]"
      D    DISPLAY  CNS-PGM-ID":その他未収配当計算コールフラグ =["
      D                                             WK-KEISAN-FLG3"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日の経過利息データ =["
      D                                   WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク相対取引データ =["
      D                                         WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引データ =["WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動 =["WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワークその他処理パターン =["
      D                                       WK-ELS0-PTN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク異動計算パターン情報 =["
      D                                   WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス =["
      D                                              WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID
      D                   ":ワーク外部銘柄コード変換用証券種別コード =["
      D                                           WK-GAIBU-MEG-CD-SSC"]"
      D    DISPLAY  CNS-PGM-ID
      D                   ":ワーク外部銘柄コード変換用市場通貨コード =["
      D                                           WK-GAIBU-MEG-CD-STC"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引差分更新フラグ =["
      D                                               WK-TORI-UPD-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク再計算数量単位を初期化する =["
      D                                           WK-SAIKS-SURYO-TANI"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高計算フラグ =["
      D                                                WK-ZN-CALC-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク増減順相対物区分を初期化する =["
      D                                     WK-ZOUGENJYUN-SOTAIBT-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高変換フラグ      =["
      D             WK-KAISI-ZN-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク0クーポン債フラグ  = ["
      D             WK-0-CUPON-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3002コールデータなしフラグ =["
      D                                                  WK-MSG-FLG-1"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コール一部該当データなし"
      D             "フラグ =["                          WK-MSG-FLG-2"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コール利率取得失敗フラグ"
      D             " =["                                WK-MSG-FLG-3"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コールデータなしフラグ =["
      D                                                  WK-MSG-FLG-4"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ2211-INOUT=["
      D             PARM-SMZJ2211-INOUT"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SMZJ2150-INOUT=["
      D             PARM-SMZJ2150-INOUT"]"
      *-----------------------------------------------------------------
      *---------- ワーク開始基準日断面存在フラグ ← '1'(ある)
               MOVE  CNS-KJ-DMN-1       TO  WK-KKY-DMN-SONZAI-FLG
      *---------- ワーク銘柄属性取得フラグ ← '0'
               MOVE  CNS-MEG-ZOK-0      TO  FLG-MEG-ZOK
      *---------- ワーク銘柄属性コールフラグ        ←  0(コールする）
               MOVE  ZERO               TO  FLG-MEG-CALL
               MOVE  ZERO               TO  FLG-TORI-UPD
      *---------- ワーク銘柄属性取得区分
               MOVE  CNS-MEG-ZKSE-SYUTK-0  TO  WK-MEG-ZKSE-SYUTK-KBN
      *---------- ワーク取引件数 ← 0
               MOVE  ZERO               TO  WK-TRHK-KENSU
      *---------- 2) ワーク銘柄別断面情報.処理実行日 ← ワークポートフォリオ情報.処理実行日
               MOVE  WK-SYORI-YMD       OF  WK-PTF-INFO
                 TO  WK-SYORI-YMD       OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.起動ID ← ワークポートフォリオ情報.起動ID
               MOVE  WK-KIDOU-ID        OF  WK-PTF-INFO
                 TO  WK-KIDOU-ID        OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.利用会社コード ←  ワークポートフォリオ情報.利用会社コード
               MOVE  WK-RIYO-CMP-CD     OF  WK-PTF-INFO
                 TO  WK-RIYO-CMP-CD     OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.ファンドコード ←  ワークポートフォリオ情報.ファンドコード
               MOVE  WK-FUND-CD         OF  WK-PTF-INFO
                 TO  WK-FUND-CD         OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.ポートフォリオコード ←  ワークポートフォリオ情報.ポートフォリオコード
               MOVE  WK-PTF-CD          OF  WK-PTF-INFO
                 TO  WK-PTF-CD          OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.開始基準日 ← ワーク基準日断面情報.開始基準日
               MOVE  WK-KAISI-KJN-YMD   OF  WK-TKMZBW02
                 TO  WK-KAISI-KJN-YMD   OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.基準日 ← ワーク基準日断面情報.基準日
               MOVE  WK-KJN-YMD         OF  WK-TKMZBW02
                 TO  WK-KJN-YMD         OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.銘柄コード ←  「別紙1-3 SQL説明」.銘柄コード
               MOVE  H-MEG-CD           OF  H-TKMZBW03-3
                 TO  WK-MEG-CD          OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.証券種別コード ←  「別紙1-3 SQL説明」.証券種別コード
               MOVE  H-SEC-SBT-CD       OF  H-TKMZBW03-3
                 TO  WK-SEC-SBT-CD      OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.資産負債・買建売建フラグ ← 別紙1-3 SQL説明.資産負債・買建売建フラグ
               MOVE  H-TATE-FLG         OF  H-TKMZBW03-3
                 TO  WK-TATE-FLG        OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.玉ID ←  「別紙1-3 SQL説明」.玉ID
               MOVE  H-GYOKU-ID         OF  H-TKMZBW03-3
                 TO  WK-GYOKU-ID        OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.市場通貨コード ← 「別紙1-3 SQL説明」.市場通貨コード
               MOVE  H-SIJO-TUKA-CD     OF  H-TKMZBW03-3
                 TO  WK-SIJO-TUKA-CD    OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.差分更新From日 ←  「別紙1-3 SQL説明」.差分更新From日
               MOVE  H-SABON-UPDATE-FROM
                                        OF  H-TKMZBW03-3
                 TO  WK-SABON-UPDATE-FROM
                                        OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.銘柄種類 ←  「別紙1-3 SQL説明」.銘柄種類
               MOVE  H-MEG-CD-SHRU      OF  H-TKMZBW03-3
                 TO  WK-MEG-CD-SHRU     OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.再計算区分 ←  「別紙1-3 SQL説明」.再計算区分
               MOVE  H-SAI-CALC-KBN     OF  H-TKMZBW03-3
                 TO  WK-SAI-CALC-KBN    OF  WK-TKMZBW03
      *---------- ワーク銘柄別断面情報.銘柄種類２ ← 別紙1-3 SQL説明.銘柄種類２
               MOVE  H-MEG-CD-SHRU2     OF  H-TKMZBW03-3
                 TO  WK-MEG-CD-SHRU2    OF  WK-TKMZBW03
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始基準日断面存在フラグ =["
      D             WK-KKY-DMN-SONZAI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得フラグ =["
      D             FLG-MEG-ZOK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性コールフラグ=["
      D             FLG-MEG-CALL"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得区分=["
      D             WK-MEG-ZKSE-SYUTK-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引件数=["WK-TRHK-KENSU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.処理実行日=["
      D             WK-SYORI-YMD        OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.起動ID=["
      D             WK-KIDOU-ID         OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.利用会社コード=["
      D             WK-RIYO-CMP-CD      OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.ファンドコード=["
      D             WK-FUND-CD          OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.ポートフォリオコー"
      D     "ド=["  WK-PTF-CD           OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.開始基準日=["
      D             WK-KAISI-KJN-YMD    OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.基準日=["
      D             WK-KJN-YMD          OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄コード=["
      D             WK-MEG-CD           OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD       OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.資産負債・買建売建"
      D    "フラグ=["WK-TATE-FLG        OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.玉ID=["
      D             WK-GYOKU-ID         OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.市場通貨コード=["
      D             WK-SIJO-TUKA-CD     OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日=["
      D           WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類=["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN     OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類２=["
      D             WK-MEG-CD-SHRU2     OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
               MOVE  CNS-ON             TO  FLG-FETCH-SYUURYOU2
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU2=["
      D             FLG-FETCH-SYUURYOU2"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-059        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-3       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-2-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別断面情報データカーソル"
      D             "フェッチ処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW03-FET-EXT.
           EXIT.
      ******************************************************************
      *    4.2.4.開始時残高計算処理
      ******************************************************************
       KAISI-ZN-CALC-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 開始時残高計算処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.順番 =["
      D             WK-JUNBAN           OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日 =["
      D             WK-KAISI-KJN-YMD    OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日 =["
      D             WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
      *---------- 開始時残高計算ルーチン
           PERFORM  SMZJ1610-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  開始時残高計算処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       KAISI-ZN-CALC-EXT.
           EXIT.
      ******************************************************************
      *    4.2.4 開始時残高計算ルーチン
      ******************************************************************
       SMZJ1610-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  開始時残高計算ルーチン 処理"
      D             " START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1610-INOUT
                       PARM-RTNPKG
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 銘柄種類
           MOVE  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
             TO  MEG-CD-SHRU            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 再計算区分
           MOVE  WK-SAI-CALC-KBN        OF  WK-TKMZBW03
             TO  SAI-CALC-KBN           OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 銘柄種類２
           MOVE  WK-MEG-CD-SHRU2        OF  WK-TKMZBW03
             TO  MEG-CD-SHRU2           OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ1610-ARG1
      *---------- 約定ベース受渡順フラグ
           MOVE  WK-YKJ-UKE-JUN-FLG
             TO  YKJ-UKE-JUN-FLG        OF  PARM-SMZJ1610-ARG1
      *---------- 異動計算パターン情報.売り続く限り同一コスト
           MOVE  WK-URI-TUDUKU-SAME-COST
                                        OF  WK-IDO-CALC-PATTERN-INFO
             TO  URI-TUDUKU-SAME-COST   OF  PARM-SMZJ1610-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日=["
      D             KAISI-KJN-YMD       OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日    =["
      D             KJN-YMD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             MEG-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID=["
      D             GYOKU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日=["
      D             SABON-UPDATE-FROM   OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類=["
      D             MEG-CD-SHRU         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":再計算区分=["
      D              SAI-CALC-KBN       OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類２=["
      D             MEG-CD-SHRU2        OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ=["
      D             YKJ-UKE-JUN-FLG     OF  PARM-SMZJ1610-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限り同一コスト=["
      D             URI-TUDUKU-SAME-COST
      D                                 OF  PARM-SMZJ1610-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1610"             USING  PARM-SMZJ1610-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1610)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
      *---------- @ワーク初期化
      *---------- ワーク開始時残高履歴情報
      *---------- ワーク開始時資金残履歴情報
      *---------- ワーク開始時元本残高情報
      *---------- ワーク差分更新モード取得ルート区分                    @3212SEINO@@
               INITIALIZE  WK-TKMZZR00
                           WK-TKMZSR00
                           WK-TKMZGZ00
                           WK-SABON-UPDATE-KBN                          @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報  =["
      D             WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時資金残履歴情報=["
      D             WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時元本残高情報  =["
      D             WK-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク差分更新モード取得ルート区分  =[" @3212SEINO@@
      D             WK-SABON-UPDATE-KBN"]"                              @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日 =["
      D             WK-SABON-UPDATE-FROM OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN     OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.コピー元データ区分=["
      D             CPY-MOTO-DATA-KBN   OF  PARM-SMZJ1610-ARG2"]"
      *-----------------------------------------------------------------
           IF  WK-SABON-UPDATE-FROM     OF  WK-TKMZBW03  =  ZERO
           AND ((WK-SAI-CALC-KBN        OF  WK-TKMZBW03  =  CNS-X-2
           AND CPY-MOTO-DATA-KBN        OF  PARM-SMZJ1610-ARG2
                                                     NOT =  CNS-1)
           OR  WK-SAI-CALC-KBN          OF  WK-TKMZBW03  =  CNS-X-1)
           THEN
      *---------- ワーク開始時残高変換フラグ
             MOVE  CNS-0                TO  WK-KAISI-ZN-FLG
           ELSE
             MOVE  CNS-1                TO  WK-KAISI-ZN-FLG
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高変換フラグ    =["
      D             WK-KAISI-ZN-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
               EVALUATE  WK-MEG-CD-SHRU  OF  WK-TKMZBW03
                 WHEN  CNS-MEG-CD-SHRU-1
      *---------- ワーク開始時残高変換フラグ＝0(変換しない)の場合
                   IF  WK-KAISI-ZN-FLG  = ZERO
                   THEN
                     MOVE  TKMZZR00-PARM  OF  PARM-SMZJ1610-ARG2
                       TO  WK-TKMZZR00
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報 =["
      D             WK-TKMZZR00"]"
      *-----------------------------------------------------------------
                   ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報."
      D             "同一コスト継続フラグ =["
      D             SAME-COST-KZK-FLG   OF  WK-TKMZZR00"]"
      *-----------------------------------------------------------------
      *---------- c) 開始基準日の残高履歴項目取得。
                     PERFORM  SELECT-TKMZZR00-RTN
      *---------- d)リターンパッケージ.差分更新モード取得ルート区分＝0の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":差分更新モード取得ルート区分 =["
      D             SABUN-UPD-GET-KBN   OF  PARM-SMZJ1610-ARG2"]"
      *-----------------------------------------------------------------
                     IF  SABUN-UPD-GET-KBN  OF  PARM-SMZJ1610-ARG2
                      =  ZERO
                     THEN
      *---------- (a)「別紙4-1 編集要領」
                       PERFORM  TKMZZR00-EDIT-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":売り続く無効時代用データなし区分 =["
      D             URI-TUDUKU-MKJD-NODATA-KBN
      D                                 OF  PARM-SMZJ1610-ARG2"]"
      *-----------------------------------------------------------------
      *---------- (b)◆リターンパッケージ.売り続く無効時代用データなし区分＝1:なしの場合
                       IF  URI-TUDUKU-MKJD-NODATA-KBN
                                        OF  PARM-SMZJ1610-ARG2 = CNS-1
                       THEN
                         MOVE  WK-SAME-COST-KZK-FLG OF  WK-TKMZZR00-PARM
                           TO  SAME-COST-KZK-FLG    OF  WK-TKMZZR00
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始基準日の残高履歴項目."
      D             "同一コスト継続フラグ=["
      D             WK-SAME-COST-KZK-FLG OF  WK-TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報."
      D             "同一コスト継続フラグ=["
      D             SAME-COST-KZK-FLG   OF  WK-TKMZZR00"]"
      *-----------------------------------------------------------------
                         IF  SAME-COST-KZK-FLG   OF  WK-TKMZZR00
                          =  CNS-SCK-FLG-1
                         THEN
      *----------  市場通貨払出単価
                           MOVE  WK-SJTK-HARAID-TNK OF  WK-TKMZZR00-PARM
                             TO  SJTK-H-TNK      OF  WK-TKMZZR00
      *----------  運用通貨払出単価
                           MOVE  WK-UYTK-HARAID-TNK OF  WK-TKMZZR00-PARM
                             TO  UYTK-H-TNK      OF  WK-TKMZZR00
                         ELSE
                           CONTINUE
                         END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報."
      D             "市場通貨払出単価 =["
      D             SJTK-H-TNK          OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報."
      D             "運用通貨払出単価 =["
      D             UYTK-H-TNK          OF  WK-TKMZZR00"]"
      *-----------------------------------------------------------------
                       ELSE
                         MOVE  IDO-DATA-SAME-COST-KZ-FLG
                                        OF  PARM-SMZJ1610-ARG2
                           TO  SAME-COST-KZK-FLG    OF  WK-TKMZZR00
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報."
      D             "同一コスト継続フラグ=["
      D             SAME-COST-KZK-FLG   OF  WK-TKMZZR00"]"
      *-----------------------------------------------------------------
                       END-IF
                       MOVE  SABUN-UPD-GET-KBN  OF  PARM-SMZJ1610-ARG2  @3212SEINO@@
                         TO  WK-SABON-UPDATE-KBN                        @3212SEINO@@
      *--------------------<DEBUG>--------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":ワーク差分更新モード取得ルート区分 =["  @3212SEINO@@
      D             WK-SABON-UPDATE-KBN   "]"                           @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
                     ELSE
                       MOVE  TKMZZR00-PARM  OF  PARM-SMZJ1610-ARG2
                         TO  WK-TKMZZR00
                       MOVE  SABUN-UPD-GET-KBN  OF  PARM-SMZJ1610-ARG2  @3212SEINO@@
                         TO  WK-SABON-UPDATE-KBN                        @3212SEINO@@
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報 =["
      D             WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク差分更新モード取得ルート区分 =["  @3212SEINO@@
      D             WK-SABON-UPDATE-KBN"]"                              @3212SEINO@@
      *-----------------------------------------------------------------
                     END-IF
                   END-IF
                 WHEN  CNS-MEG-CD-SHRU-2
      *---------- ワーク開始時残高変換フラグ＝0(変換しない)の場合
                   IF  WK-KAISI-ZN-FLG   =  ZERO
                   THEN
                     MOVE  TKMZGZ00-PARM    OF  PARM-SMZJ1610-ARG2
                       TO  WK-TKMZGZ00
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時元本残高情報 =["
      D             WK-TKMZGZ00"]"
      *-----------------------------------------------------------------
                   ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":差分更新モード取得ルート区分 =["
      D             SABUN-UPD-GET-KBN  OF  PARM-SMZJ1610-ARG2"]"
      *-----------------------------------------------------------------
                     IF  SABUN-UPD-GET-KBN  OF  PARM-SMZJ1610-ARG2
                       = ZERO
                     THEN
      *---------- 「別紙4-7 編集要領」
                       PERFORM  TKMZGZ00-EDIT-RTN
                     ELSE
                       MOVE  TKMZGZ00-PARM    OF  PARM-SMZJ1610-ARG2
                         TO  WK-TKMZGZ00
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時元本残高情報 =["
      D             WK-TKMZGZ00"]"
      *-----------------------------------------------------------------
                     END-IF
                   END-IF
                 WHEN  CNS-MEG-CD-SHRU-3
      *---------- ワーク開始時残高変換フラグ＝0(変換しない)の場合
                   IF  WK-KAISI-ZN-FLG   =  ZERO
                   THEN
                     MOVE  TKMZSR00-PARM  OF  PARM-SMZJ1610-ARG2
                       TO  WK-TKMZSR00
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時資金残履歴情報 =["
      D             WK-TKMZSR00"]"
      *-----------------------------------------------------------------
                   ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":差分更新モード取得ルート区分 =["
      D             SABUN-UPD-GET-KBN  OF  PARM-SMZJ1610-ARG2"]"
      *-----------------------------------------------------------------
                     IF  SABUN-UPD-GET-KBN  OF  PARM-SMZJ1610-ARG2
                       = ZERO
                     THEN
      *---------- 「別紙4-2 編集要領」
                       PERFORM  TKMZSR00-EDIT-RTN
      *---------- 開始基準日の資金残履歴項目取得。(「別紙1-19 SQL説明」を参照)
                       PERFORM  TKMZSR00-SELECT-RTN
                     ELSE
                       MOVE  TKMZSR00-PARM  OF  PARM-SMZJ1610-ARG2
                         TO  WK-TKMZSR00
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時資金残履歴情報 =["
      D             WK-TKMZSR00"]"
      *-----------------------------------------------------------------
                     END-IF
                   END-IF
                 WHEN  OTHER
                   CONTINUE
               END-EVALUATE
               IF  WK-JUNBAN             OF  WK-TKMZBW02 = CNS-JUNBAN-1
               AND WK-KAISI-KJN-YMD      OF  WK-TKMZBW02 = ZERO
               AND WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03 = ZERO
               AND CPY-MOTO-DATA-KBN     OF  PARM-SMZJ1610-ARG2
                                                     NOT =  CNS-1
               THEN
      *---------- ワーク開始基準日断面存在フラグ ← '0'(なし)
                 MOVE  CNS-KJ-DMN-0      TO  WK-KKY-DMN-SONZAI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始基準日断面存在フラグ =["
      D             WK-KKY-DMN-SONZAI-FLG"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             WHEN  CNS-RTN-113
      *---------- ワーク開始基準日断面存在フラグ ← '0'(なし)
               MOVE  CNS-KJ-DMN-0       TO  WK-KKY-DMN-SONZAI-FLG
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始基準日断面存在フラグ =["
      D             WK-KKY-DMN-SONZAI-FLG"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-060        TO  WK-ERR-POS
               PERFORM  ERR-MSG-1-RTN
           END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  開始時残高計算ルーチン 処理"
      D             " END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1610-EXT.
           EXIT.
      ******************************************************************
      *    開始基準日の残高履歴項目取得
      ******************************************************************
       SELECT-TKMZZR00-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴を取得(別紙1-13) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高履歴CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT13                                        @3212SEINO@@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZZR00-1-S,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-13
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZZR00-1-S,
                 WK-FUND-CD             OF  WK-MSG-1-13
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZZR00-1-S,
                 WK-PTF-CD              OF  WK-MSG-1-13
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  H-SEC-SBT-CD           OF  H-TKMZZR00-1-S,
                 WK-SEC-SBT-CD          OF  WK-MSG-1-13
      *----------  銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-MEG-CD               OF  H-TKMZZR00-1-S,
                 WK-MEG-CD              OF  WK-MSG-1-13
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  H-TATE-FLG             OF  H-TKMZZR00-1-S,
                 WK-TATE-FLG            OF  WK-MSG-1-13
      *----------  玉ＩＤ
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  H-GYOKU-ID             OF  H-TKMZZR00-1-S
                 WK-GYOKU-ID            OF  WK-MSG-1-13
      *----------  基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMZZR00-1-S,
                 WK-KJN-YMD             OF  WK-MSG-1-13
      *----------  TBL
           MOVE  WK-TBL-TKMZZR00
             TO  SQL-TBL-ID-13          OF  SQL-SELECT-1-13,
                 WK-MSG-TKMZZR00        OF  WK-MSG-1-13
           MOVE  SQL-SELECT-1-13        TO  SQLSTMT13                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD       OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD           OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD            OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード=["
      D             H-SEC-SBT-CD        OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード          =["
      D             H-MEG-CD            OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産負債・買建売建フラグ=["
      D             H-TATE-FLG          OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ＩＤ              =["
      D             H-GYOKU-ID          OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日          =["
      D             H-KJN-YMD           OF  H-TKMZZR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT13=[" SQLSTMT13 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID ":WK-MSG-1-13=[" WK-MSG-1-13 "]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZR00-CR-1-OPEN=["               @3212SEINO@@
      D             FLG-TKMZZR00-CR-1-OPEN"]"                           @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  残高履歴CURSOR PREPARE
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZZR00-CR-1-OPEN  NOT = CNS-ON                     @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
             PREPARE  S13  FROM  :SQLSTMT13                             @3212SEINO@@
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR PREPARE 正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-061          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-13        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
           EXEC  SQL
             DECLARE  TKMZZR00_CUR_1  CURSOR  FOR  S13
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZZR00_CUR_1
               USING :H-TKMZZR00-1-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZZR00-CR-1-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZR00-CR-1-OPEN=["
      D             FLG-TKMZZR00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-062          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-13        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZZR00_CUR_1
             INTO  :H-TKMZZR00-1
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高履歴CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.市場通貨未収収益計上・戻入額=["
      D             H-SJTK-MSSE-KJMIG   OF  H-TKMZZR00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.運用通貨未収収益計上・戻入額=["
      D             H-UYTK-MSSE-KJMIG   OF  H-TKMZZR00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.市場通貨払出単価=["
      D             H-SJTK-HARAID-TNK   OF  H-TKMZZR00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.運用通貨払出単価=["
      D             H-UYTK-HARAID-TNK   OF  H-TKMZZR00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-13.同一コスト継続フラグ=["
      D             H-SAME-COST-KZK-FLG OF  H-TKMZZR00-1"]"
      *-----------------------------------------------------------------
      *----------  市場通貨未収収益計上・戻入額
               MOVE  H-SJTK-MSSE-KJMIG  OF  H-TKMZZR00-1
                 TO  WK-SJTK-MSSE-KJMIG OF  WK-TKMZZR00-PARM
      *----------  運用通貨未収収益計上・戻入額
               MOVE  H-UYTK-MSSE-KJMIG  OF  H-TKMZZR00-1
                 TO  WK-UYTK-MSSE-KJMIG OF  WK-TKMZZR00-PARM
      *----------  市場通貨払出単価
               MOVE  H-SJTK-HARAID-TNK  OF  H-TKMZZR00-1
                 TO  WK-SJTK-HARAID-TNK OF  WK-TKMZZR00-PARM
      *----------  運用通貨払出単価
               MOVE  H-UYTK-HARAID-TNK  OF  H-TKMZZR00-1
                 TO  WK-UYTK-HARAID-TNK OF  WK-TKMZZR00-PARM
      *----------  同一コスト継続フラグ
               MOVE  H-SAME-COST-KZK-FLG
                                        OF  H-TKMZZR00-1
                 TO  WK-SAME-COST-KZK-FLG
                                        OF  WK-TKMZZR00-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨未収収益計上・戻入額=["
      D             WK-SJTK-MSSE-KJMIG  OF  WK-TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨未収収益計上・戻入額=["
      D             WK-UYTK-MSSE-KJMIG  OF  WK-TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨払出単価=["
      D             WK-SJTK-HARAID-TNK  OF  WK-TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨払出単価=["
      D             WK-UYTK-HARAID-TNK  OF  WK-TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク同一コスト継続フラグ=["
      D             WK-SAME-COST-KZK-FLG
      D                                 OF  WK-TKMZZR00-PARM"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *----------  市場通貨未収収益計上・戻入額
               MOVE  ZERO
                 TO  WK-SJTK-MSSE-KJMIG OF  WK-TKMZZR00-PARM
      *----------  運用通貨未収収益計上・戻入額
               MOVE  ZERO
                 TO  WK-UYTK-MSSE-KJMIG OF  WK-TKMZZR00-PARM
      *----------  同一コスト継続フラグ
               MOVE  CNS-SCK-FLG-0
                 TO  WK-SAME-COST-KZK-FLG
                                        OF  WK-TKMZZR00-PARM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨未収収益計上・戻入額=["
      D             WK-SJTK-MSSE-KJMIG  OF  WK-TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨未収収益計上・戻入額=["
      D             WK-UYTK-MSSE-KJMIG  OF  WK-TKMZZR00-PARM"]"
      D    DISPLAY  CNS-PGM-ID":同一コスト継続フラグ=["
      D             WK-SAME-COST-KZK-FLG
      D                                 OF  WK-TKMZZR00-PARM"]"
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-063          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-13        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR FETCH END ***"
      *D    DISPLAY  CNS-PGM-ID":*** 残高履歴CURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZR00-CR-1-OPEN= ["
      *D             FLG-TKMZZR00-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZZR00_CUR_1
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"残高履歴"
      *D             "CUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF               TO  FLG-TKMZZR00-CR-1-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZR00-CR-1-OPEN =["
      *D             FLG-TKMZZR00-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高履歴CURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-064          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-13        DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-7-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***残高履歴CUR CLOSE END ***"
      D    DISPLAY  CNS-PGM-ID":*** 残高履歴を取得(別紙1-13) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SELECT-TKMZZR00-EXT.
           EXIT.
      ******************************************************************
      *    別紙4-1 編集要領
      ******************************************************************
       TKMZZR00-EDIT-RTN      SECTION.
      *-----------------------------------------------------------------
      *    INITIALIZE  WK-TKMZZR00
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  RIYO-CMP-CD            OF  WK-TKMZZR00
      *---------- ファンドコード
           MOVE  FUND-CD                OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  FUND-CD                OF  WK-TKMZZR00
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  PTF-CD                 OF  WK-TKMZZR00
      *---------- 証券種別コード
           MOVE  SEC-SBT-CD             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SEC-SBT-CD             OF  WK-TKMZZR00
      *---------- 銘柄コード
           MOVE  MEG-CD                 OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  MEG-CD                 OF  WK-TKMZZR00
      *---------- 資産負債・買建売建フラグ
           MOVE  TATE-FLG               OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  TATE-FLG               OF  WK-TKMZZR00
      *---------- 玉ＩＤ
           MOVE  GYOKU-ID               OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  GYOKU-ID               OF  WK-TKMZZR00
      *---------- 市場通貨コード
           MOVE  SIJO-TUKA-CD           OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SIJO-TUKA-CD           OF  WK-TKMZZR00
      *---------- 数量残高
           MOVE  IDOG-SRYZN             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SRYZN                  OF  WK-TKMZZR00
      *---------- 市場通貨簿価残高
           MOVE  SJTK-IDOG-BOKAZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-BOKAZN            OF  WK-TKMZZR00
      *---------- 運用通貨簿価残高
           MOVE  UYTK-IDOG-BOKAZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-BOKAZN            OF  WK-TKMZZR00
      *---------- 市場通貨簿価単価
           MOVE  SJTK-BOKA-TNK          OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-BOKA-TNK          OF  WK-TKMZZR00
      *---------- 運用通貨簿価単価
           MOVE  UYTK-BOKA-TNK          OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-BOKA-TNK          OF  WK-TKMZZR00
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  BOKA-KWS               OF  WK-TKMZZR00
      *---------- 市場通貨前払金残高
           MOVE  SJTK-IDOG-PPAYZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-PPAYZN            OF  WK-TKMZZR00
      *---------- 運用通貨前払金残高
           MOVE  UYTK-IDOG-PPAYZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-PPAYZN            OF  WK-TKMZZR00
      *---------- 市場通貨前受金残高
           MOVE  SJTK-IDOG-ARECZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-ARECZN            OF  WK-TKMZZR00
      *---------- 運用通貨前受金残高
           MOVE  UYTK-IDOG-ARECZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-ARECZN            OF  WK-TKMZZR00
      *---------- 市場通貨仮払金残高
           MOVE  SJTK-IDOG-SPAYZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-SPAYZN            OF  WK-TKMZZR00
      *---------- 運用通貨仮払金残高
           MOVE  UYTK-IDOG-SPAYZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-SPAYZN            OF  WK-TKMZZR00
      *---------- 市場通貨払出単価
           MOVE  SJTK-H-TNK             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-H-TNK             OF  WK-TKMZZR00
      *---------- 運用通貨払出単価
           MOVE  UYTK-H-TNK             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-H-TNK             OF  WK-TKMZZR00
      *---------- 市場通貨未収収益計上・戻入額
           MOVE  WK-SJTK-MSSE-KJMIG     OF  WK-TKMZZR00-PARM
             TO  SJTK-MSSE-KJMIG        OF  WK-TKMZZR00
      *---------- 運用通貨未収収益計上・戻入額
           MOVE  WK-UYTK-MSSE-KJMIG     OF  WK-TKMZZR00-PARM
             TO  UYTK-MSSE-KJMIG        OF  WK-TKMZZR00
      *---------- 数量残高（利付）
           MOVE  IDOG-SRYZN-RIT         OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SRYZN-RIT              OF  WK-TKMZZR00
      *---------- 建玉単価
           MOVE  TGYOKU-TNK             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  TGYOKU-TNK             OF  WK-TKMZZR00
      *---------- 建玉為替レート
           MOVE  TGYOKU-KWS-RATE        OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  TGYOKU-KWS-RATE        OF  WK-TKMZZR00
      *---------- 建玉ブローカー
           MOVE  TGYOKU-BRK             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  TGYOKU-BRK             OF  WK-TKMZZR00
      *---------- 建玉約定日
           MOVE  TGYOKU-YKJ-YMD         OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  TGYOKU-YKJ-YMD         OF  WK-TKMZZR00
      *---------- 市場通貨建玉約定金額残
           MOVE  SJTK-IDOG-TG-YJKNZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TG-YJKNZN         OF  WK-TKMZZR00
      *---------- 運用通貨建玉約定金額残
           MOVE  UYTK-IDOG-TG-YJKNZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TG-YJKNZN         OF  WK-TKMZZR00
      *---------- 市場通貨建玉手数料残
           MOVE  SJTK-IDOG-TG-TSRZN     OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TG-TSRZN          OF  WK-TKMZZR00
      *---------- 運用通貨建玉手数料残
           MOVE  UYTK-IDOG-TG-TSRZN     OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TG-TSRZN          OF  WK-TKMZZR00
      *---------- 市場通貨建玉消費税残
           MOVE  SJTK-IDOG-TG-S-TAXZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TG-S-TAXZN        OF  WK-TKMZZR00
      *---------- 運用通貨建玉消費税残
           MOVE  UYTK-IDOG-TG-S-TAXZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TG-S-TAXZN        OF  WK-TKMZZR00
      *---------- 市場通貨建玉その他費用残
           MOVE  SJTK-IDOG-TG-ELS-HZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TG-ELS-HIYOZN     OF  WK-TKMZZR00
      *---------- 運用通貨建玉その他費用残
           MOVE  UYTK-IDOG-TG-ELS-HZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TG-ELS-HIYOZN     OF  WK-TKMZZR00
      *---------- 市場通貨建玉精算金額残
           MOVE  SJTK-IDOG-TG-SSKGZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TG-SSKGZN         OF  WK-TKMZZR00
      *---------- 運用通貨建玉精算金額残
           MOVE  UYTK-IDOG-TG-SSKGZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TG-SSKGZN         OF  WK-TKMZZR00
      *---------- ＯＰ資産負債・買建売建フラグ
           MOVE  OP-TATE-FLG            OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  OP-TATE-FLG            OF  WK-TKMZZR00
      *---------- 市場通貨源泉税還付予定額残高
           MOVE  SJTK-IDOG-GSZKP-YTZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-GSZKP-YTZN        OF  WK-TKMZZR00
      *---------- 運用通貨源泉税還付予定額残高
           MOVE  UYTK-IDOG-GSZKP-YTZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-GSZKP-YTZN        OF  WK-TKMZZR00
      *---------- 決済通貨源泉税還付予定額残高
           MOVE  KSTK-IDOG-GSZKP-YTZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  KSTK-GSZKP-YTZN        OF  WK-TKMZZR00
      *---------- 市場通貨ノンカバー未収金残高
           MOVE  SJTK-IDOG-NOCV-MSKZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-NOCV-MSKZN        OF  WK-TKMZZR00
      *---------- 運用通貨ノンカバー未収金残高
           MOVE  UYTK-IDOG-NOCV-MSKZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-NOCV-MSKZN        OF  WK-TKMZZR00
      *---------- 市場通貨ノンカバー未払金残高
           MOVE  SJTK-IDOG-NOCV-MBKZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-NOCV-MBKZN        OF  WK-TKMZZR00
      *---------- 運用通貨ノンカバー未払金残高
           MOVE  UYTK-IDOG-NOCV-MBKZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-NOCV-MBKZN        OF  WK-TKMZZR00
      *---------- 短期スタート・エンド経過利息
           MOVE  SHORT-STEN-KEKA-RSK    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SHORT-STEN-KEKA-RSK    OF  WK-TKMZZR00
      *---------- 短期スタート日
           MOVE  SHORT-START-YMD        OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SHORT-START-YMD        OF  WK-TKMZZR00
      *---------- 短期エンド日
           MOVE  SHORT-END-YMD          OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SHORT-END-YMD          OF  WK-TKMZZR00
      *---------- 投資対象国コード
           MOVE  TSTSK-CD               OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  TSTSK-CD               OF  WK-TKMZZR00
      *---------- 発行国コード
           MOVE  HAKO-CD                OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  HAKO-CD                OF  WK-TKMZZR00
      *---------- 数量単位
           MOVE  SURYO-TANI             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SURYO-TANI             OF  WK-TKMZZR00
      *---------- 市場通貨未払費用残
           MOVE  SJTK-IDOG-MBHYZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-MBHYZN            OF  WK-TKMZZR00
      *---------- 運用通貨未払費用残
           MOVE  UYTK-IDOG-MBHYZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-MBHYZN            OF  WK-TKMZZR00
      *---------- 市場通貨未払消費税残
           MOVE  SJTK-IDOG-MB-S-TAXZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-MB-S-TAXZN        OF  WK-TKMZZR00
      *---------- 運用通貨未払消費税残
           MOVE  UYTK-IDOG-MB-S-TAXZN   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-MB-S-TAXZN        OF  WK-TKMZZR00
      *---------- 市場通貨移管評価損益残
           MOVE  SJTK-IDOG-IK-HKSEZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-IK-HKSEZN         OF  WK-TKMZZR00
      *---------- 運用通貨移管評価損益残
           MOVE  UYTK-IDOG-IK-HKSEZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-IK-HKSEZN         OF  WK-TKMZZR00
      *---------- 市場通貨移管未収収益
           MOVE  SJTK-IDOG-IK-MSSHEKI   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-IK-MSSHEKI        OF  WK-TKMZZR00
      *---------- 運用通貨移管未収収益
           MOVE  UYTK-IDOG-IK-MSSHEKI   OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-IK-MSSHEKI        OF  WK-TKMZZR00
      *---------- 運用通貨移管前払金評価損益残
           MOVE  UYTK-IDOG-IK-PPHKZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-IK-PPHKZN         OF  WK-TKMZZR00
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード          =["
      D             RIYO-CMP-CD         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード          =["
      D             FUND-CD             OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード    =["
      D             PTF-CD              OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード          =["
      D             SEC-SBT-CD          OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード              =["
      D             MEG-CD              OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ                  =["
      D             GYOKU-ID            OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード     =["
      D             SIJO-TUKA-CD        OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":数量残高           =["
      D             SRYZN               OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価残高   =["
      D             SJTK-BOKAZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価残高   =["
      D             UYTK-BOKAZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価   =["
      D             SJTK-BOKA-TNK       OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価   =["
      D             UYTK-BOKA-TNK       OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート     =["
      D             BOKA-KWS            OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金残高 =["
      D             SJTK-PPAYZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金残高 =["
      D             UYTK-PPAYZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前受金残高 =["
      D             SJTK-ARECZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前受金残高 =["
      D             UYTK-ARECZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨仮払金残高 =["
      D             SJTK-SPAYZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨仮払金残高 =["
      D             UYTK-SPAYZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価   =["
      D             SJTK-H-TNK          OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価   =["
      D             UYTK-H-TNK          OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益計上・戻入額   =["
      D             SJTK-MSSE-KJMIG     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益計上・戻入額   =["
      D             UYTK-MSSE-KJMIG     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":数量残高（利付）   =["
      D             SRYZN-RIT           OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価           =["
      D             TGYOKU-TNK          OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート     =["
      D             TGYOKU-KWS-RATE     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー     =["
      D             TGYOKU-BRK          OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日         =["
      D             TGYOKU-YKJ-YMD      OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉約定金額残   =["
      D             SJTK-TG-YJKNZN      OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉約定金額残   =["
      D             UYTK-TG-YJKNZN      OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料残     =["
      D             SJTK-TG-TSRZN       OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料残     =["
      D             UYTK-TG-TSRZN       OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税残     =["
      D             SJTK-TG-S-TAXZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税残     =["
      D             UYTK-TG-S-TAXZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用残 =["
      D             SJTK-TG-ELS-HIYOZN  OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用残 =["
      D             UYTK-TG-ELS-HIYOZN  OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額残   =["
      D             SJTK-TG-SSKGZN      OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額残   =["
      D             UYTK-TG-SSKGZN      OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ =["
      D             OP-TATE-FLG         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定額残高 =["
      D             SJTK-GSZKP-YTZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定額残高 =["
      D             UYTK-GSZKP-YTZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨源泉税還付予定額残高 =["
      D             KSTK-GSZKP-YTZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨ノンカバー未収金残高 =["
      D             SJTK-NOCV-MSKZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨ノンカバー未収金残高 =["
      D             UYTK-NOCV-MSKZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨ノンカバー未払金残高 =["
      D             SJTK-NOCV-MBKZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨ノンカバー未払金残高 =["
      D             UYTK-NOCV-MBKZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息 =["
      D             SHORT-STEN-KEKA-RSK OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日               =["
      D             SHORT-START-YMD     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日                 =["
      D             SHORT-END-YMD       OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード             =["
      D             TSTSK-CD            OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード                 =["
      D             HAKO-CD             OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":数量単位                     =["
      D             SURYO-TANI          OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未払費用残           =["
      D             SJTK-MBHYZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未払費用残           =["
      D             UYTK-MBHYZN         OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨未払消費税残         =["
      D             SJTK-MB-S-TAXZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未払消費税残         =["
      D             UYTK-MB-S-TAXZN     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨移管評価損益残       =["
      D             SJTK-IK-HKSEZN      OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管評価損益残       =["
      D             UYTK-IK-HKSEZN      OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨移管未収収益         =["
      D             SJTK-IK-MSSHEKI     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管未収収益         =["
      D             UYTK-IK-MSSHEKI     OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨移管前払金評価損益残 =["
      D             UYTK-IK-PPHKZN      OF  WK-TKMZZR00"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZZR00-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    別紙4-2 編集要領
      ******************************************************************
       TKMZSR00-EDIT-RTN      SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  WK-TKMZSR00
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  RIYO-CMP-CD            OF  WK-TKMZSR00
      *---------- ファンドコード
           MOVE  FUND-CD                OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  FUND-CD                OF  WK-TKMZSR00
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  PTF-CD                 OF  WK-TKMZSR00
      *---------- 決済口座番号
           MOVE  KS-KOZA-NO             OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  KS-KOZA-NO             OF  WK-TKMZSR00
      *---------- 証券種別コード
           MOVE  SEC-SBT-CD             OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SEC-SBT-CD             OF  WK-TKMZSR00
      *---------- 決済口座通貨コード
           MOVE  KOZA-TUKA-CD           OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  KOZA-TUKA-CD           OF  WK-TKMZSR00
      *---------- 市場通貨当日ＣＡＳＨ残高
           MOVE  SJTK-IDOG-SK-BOKAZN    OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TJT-CASHZN        OF  WK-TKMZSR00
      *---------- 運用通貨当日ＣＡＳＨ残高
           MOVE  UYTK-IDOG-SK-BOKAZN    OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TJT-CASHZN        OF  WK-TKMZSR00
      *---------- 市場通貨当日未収入金残高（内物）
           MOVE  SJTK-IDOG-MSNKZN-UM    OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TJT-MSNKZN-UM     OF  WK-TKMZSR00
      *---------- 運用通貨当日未収入金残高（内物）
           MOVE  UYTK-IDOG-MSNKZN-UM    OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TJT-MSNKZN-UM     OF  WK-TKMZSR00
      *---------- 市場通貨当日未収入金残高（外物）
           MOVE  SJTK-IDOG-MSNKZN-SM    OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TJT-MSNKZN-SM     OF  WK-TKMZSR00
      *---------- 運用通貨当日未収入金残高（外物）
           MOVE  UYTK-IDOG-MSNKZN-SM    OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TJT-MSNKZN-SM     OF  WK-TKMZSR00
      *---------- 市場通貨当日未払金残高（内物）
           MOVE  SJTK-IDOG-MBKZN-UM     OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TJT-MBKZN-UM      OF  WK-TKMZSR00
      *---------- 運用通貨当日未払金残高（内物）
           MOVE  UYTK-IDOG-MBKZN-UM     OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TJT-MBKZN-UM      OF  WK-TKMZSR00
      *---------- 市場通貨当日未払金残高（外物）
           MOVE  SJTK-IDOG-MBKZN-SM     OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SJTK-TJT-MBKZN-SM      OF  WK-TKMZSR00
      *---------- 運用通貨当日未払金残高（外物）
           MOVE  UYTK-IDOG-MBKZN-SM     OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  UYTK-TJT-MBKZN-SM      OF  WK-TKMZSR00
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  TKMZSI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  BOKA-KWS               OF  WK-TKMZSR00
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード          =["
      D             RIYO-CMP-CD         OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード          =["
      D             FUND-CD             OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード    =["
      D             PTF-CD              OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号            =["
      D             KS-KOZA-NO          OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード          =["
      D             SEC-SBT-CD          OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード=["
      D             KOZA-TUKA-CD        OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日ＣＡＳＨ残高 =["
      D             SJTK-TJT-CASHZN     OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日ＣＡＳＨ残高 =["
      D             UYTK-TJT-CASHZN     OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未収入金残高（内物） =["
      D             SJTK-TJT-MSNKZN-UM  OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未収入金残高（内物） =["
      D             UYTK-TJT-MSNKZN-UM  OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未収入金残高（外物）=["
      D             SJTK-TJT-MSNKZN-SM  OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未収入金残高（外物）=["
      D             UYTK-TJT-MSNKZN-SM  OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未払金残高（内物）=["
      D             SJTK-TJT-MBKZN-UM   OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未払金残高（内物）=["
      D             UYTK-TJT-MBKZN-UM   OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日未払金残高（外物）=["
      D             SJTK-TJT-MBKZN-SM   OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨当日未払金残高（外物）=["
      D             UYTK-TJT-MBKZN-SM   OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート     =["
      D             BOKA-KWS            OF  WK-TKMZSR00"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSR00-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    開始基準日の資金残履歴項目取得。(「別紙1-19 SQL説明」を参照)
      ******************************************************************
       TKMZSR00-SELECT-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴取得(別紙1-19) START ***"
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR PREPARE START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT19                                        @3212SEINO@@
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZSR00-1-S,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-19
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZSR00-1-S,
                 WK-FUND-CD             OF  WK-MSG-1-19
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZSR00-1-S,
                 WK-PTF-CD              OF  WK-MSG-1-19
      *---------- 決済口座番号
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-KS-KOZA-NO           OF  H-TKMZSR00-1-S,
                 WK-KS-KOZA-NO          OF  WK-MSG-1-19
      *---------- 基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMZSR00-1-S,
                 WK-KJN-YMD             OF  WK-MSG-1-19
      *---------- TBL
           MOVE  WK-TBL-TKMZSR00
             TO  SQL-TKMZSR00           OF  SQL-SELECT-1-19,
                 WK-TKMZSR00-S          OF  WK-MSG-1-19
           MOVE  SQL-SELECT-1-19        TO  SQLSTMT19                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZSR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZSR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD            OF  H-TKMZSR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":決済口座番号=["
      D             H-KS-KOZA-NO        OF  H-TKMZSR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":基準日 =["
      D             H-KJN-YMD           OF  H-TKMZSR00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT19=[" SQLSTMT19 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSR00-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMZSR00-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  資金残履歴 CURSOR PREPARE
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZSR00-CR-OPEN  NOT = CNS-ON                       @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
             PREPARE  S19  FROM  :SQLSTMT19                             @3212SEINO@@
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":資金残履歴 CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR PREPARE 正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-065          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-19        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
           EXEC  SQL
             DECLARE  TKMZSR00_CUR_1  CURSOR  FOR  S19
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR DECLARE SQLCODE=["
      D             SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZSR00_CUR_1
               USING :H-TKMZSR00-1-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZSR00-CR-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSR00-CR-OPEN=["
      D             FLG-TKMZSR00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-066          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-19        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-7-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZSR00_CUR_1
             INTO  :H-TKMZSR00-1
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-19.市場通貨未収収益計上・戻入額=["
      D             H-SJTK-MSSE-KJMIG   OF  H-TKMZSR00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-19.運用通貨未収収益計上・戻入額=["
      D             H-UYTK-MSSE-KJMIG   OF  H-TKMZSR00-1"]"
      *-----------------------------------------------------------------
      *----------  ワーク開始時資金残履歴情報.市場通貨未収収益計上・戻入額
               MOVE  H-SJTK-MSSE-KJMIG  OF  H-TKMZSR00-1
                 TO  SJTK-MSSE-KJMIG    OF  WK-TKMZSR00
      *----------  ワーク開始時資金残履歴情報.運用通貨未収収益計上・戻入額
               MOVE  H-UYTK-MSSE-KJMIG  OF  H-TKMZSR00-1
                 TO  UYTK-MSSE-KJMIG    OF  WK-TKMZSR00
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時資金残履歴情報."
      D    "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG     OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時資金残履歴情報."
      D    "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG     OF  WK-TKMZSR00"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *----------  ワーク開始時資金残履歴情報.市場通貨未収収益計上・戻入額
               MOVE  ZERO
                 TO  SJTK-MSSE-KJMIG    OF  WK-TKMZSR00
      *----------  ワーク開始時資金残履歴情報.運用通貨未収収益計上・戻入額
               MOVE  ZERO
                 TO  UYTK-MSSE-KJMIG    OF  WK-TKMZSR00
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時資金残履歴情報."
      D    "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG     OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時資金残履歴情報."
      D    "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG     OF  WK-TKMZSR00"]"
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-067        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-19      DELIMITED  BY  SIZE
               INTO    WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-7-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR FETCH END ***"
      *D    DISPLAY  CNS-PGM-ID":*** 資金残履歴CURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZSR00-CR-OPEN= ["
      *D             FLG-TKMZSR00-CR-OPEN "]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZSR00_CUR_1
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"資金残履歴 CUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF              TO  FLG-TKMZSR00-CR-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZSR00-CR-OPEN =["
      *D             FLG-TKMZSR00-CR-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":資金残履歴CURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-068          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-19        DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-7-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***資金残履歴CUR CLOSE END ***"
      D    DISPLAY  CNS-PGM-ID":*** 資金残履歴取得(別紙1-19) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSR00-SELECT-EXT.
           EXIT.
      ******************************************************************
      *    別紙4-7 編集要領
      ******************************************************************
       TKMZGZ00-EDIT-RTN      SECTION.
      *    INITIALIZE  WK-TKMZGZ00
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  RIYO-CMP-CD            OF  WK-TKMZGZ00
      *---------- ファンドコード
           MOVE  FUND-CD                OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  FUND-CD                OF  WK-TKMZGZ00
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  PTF-CD                 OF  WK-TKMZGZ00
      *---------- 元本数量残高
           MOVE  IDOG-SRYZN             OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  GNP-SRYZN              OF  WK-TKMZGZ00
      *---------- 元本簿価残高
           MOVE  UYTK-IDOG-BOKAZN       OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  GNP-BOKAZN             OF  WK-TKMZGZ00
      *---------- 総投入金額
           MOVE  UYTK-IDOG-TG-SSKGZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SO-TN-KGK              OF  WK-TKMZGZ00
      *---------- 初期設定金額
           MOVE  UYTK-IDOG-TG-YJKNZN    OF  TKMZZI00-PARM
                                        OF  PARM-SMZJ1610-ARG2
             TO  SHOKI-SET-KGK          OF  WK-TKMZGZ00
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード         =["
      D             RIYO-CMP-CD         OF  WK-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード         =["
      D             FUND-CD             OF  WK-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード   =["
      D             PTF-CD              OF  WK-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID":元本数量残高           =["
      D             GNP-SRYZN           OF  WK-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID":元本簿価残高           =["
      D             GNP-BOKAZN          OF  WK-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID":総投入金額             =["
      D             SO-TN-KGK           OF  WK-TKMZGZ00"]"
      D    DISPLAY  CNS-PGM-ID":初期設定金額           =["
      D             SHOKI-SET-KGK       OF  WK-TKMZGZ00"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZGZ00-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    4.2.4.銘柄断面ループ属性データセット
      ******************************************************************
       MEG-DMN-GRP-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄断面ループ属性データセット"
      D            "処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄コード=["
      D             WK-MEG-CD  OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
      *---------- 1)銘柄コード判断処理
           IF WK-MEG-CD  OF  WK-TKMZBW03 NOT = SPACE AND
              WK-MEG-CD  OF  WK-TKMZBW03 NOT = CNS-X-CASH
           THEN
             PERFORM  VARYING  WK-IDX7    FROM CNS-1 BY CNS-1
               UNTIL  WK-IDX7  > CNS-250  OR
                      WK-MEG-CD           OF  WK-TKMZBW03(1:4)  =
                      TRHK-JIYU-CD        OF  WK-TKCMTZ00(WK-IDX7)
             END-PERFORM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-IDX7   = ["WK-IDX7"]"
      *-----------------------------------------------------------------
             IF  WK-IDX7  > CNS-250
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":該当データなしの場合"
      *-----------------------------------------------------------------
      *---------- ワーク銘柄属性コールフラグ        ←  1
               MOVE  CNS-1                TO  FLG-MEG-CALL
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性コールフラグ=["
      D             FLG-MEG-CALL"]"
      *-----------------------------------------------------------------
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":該当データある場合"
      *-----------------------------------------------------------------
               CONTINUE
             END-IF
           ELSE
             CONTINUE
           END-IF
      *---------- 2)銘柄コードリファレンス取得
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性コールフラグ=["
      D                         FLG-MEG-CALL"]"
      *-----------------------------------------------------------------
           IF  FLG-MEG-CALL = CNS-1
           THEN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード=["
      D                         WK-SEC-SBT-CD      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
             IF  WK-SEC-SBT-CD  OF  WK-TKMZBW03 =  CNS-MA99
             THEN
               MOVE  SPACE  TO  WK-GAIBU-MEG-CD-SSC
               MOVE  SPACE  TO  WK-GAIBU-MEG-CD-STC
               MOVE  CNS-1  TO  WK-TORI-UPD-FLG
             ELSE
               MOVE  WK-SEC-SBT-CD      OF  WK-TKMZBW03
                 TO  WK-GAIBU-MEG-CD-SSC
               MOVE  WK-SIJO-TUKA-CD    OF  WK-TKMZBW03
                 TO  WK-GAIBU-MEG-CD-STC
             END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                   ":ワーク外部銘柄コード変換用証券種別コード =["
      D                                           WK-GAIBU-MEG-CD-SSC"]"
      D    DISPLAY  CNS-PGM-ID
      D                   ":ワーク外部銘柄コード変換用市場通貨コード =["
      D                                           WK-GAIBU-MEG-CD-STC"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引差分更新フラグ =["
      D                                               WK-TORI-UPD-FLG"]"
      *-----------------------------------------------------------------
             PERFORM  SCZY3002-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
             IF  FLG-TORI-UPD  =  CNS-1
             THEN
               CONTINUE
             ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引差分更新フラグ =["
      D                                               WK-TORI-UPD-FLG"]"
      *-----------------------------------------------------------------
               IF  WK-TORI-UPD-FLG = CNS-1
               THEN
      *---------- ワーク銘柄別断面情報.証券種別コード   ←  リターンパッケージ.証券種別コード
                 MOVE  SEC-SBT-CD           OF  PARM-SCZY3002-ARG2
                   TO  WK-SEC-SBT-CD        OF  WK-TKMZBW03
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD       OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
                 PERFORM  TKMZBW03-UPDATE-RTN
               ELSE
                 CONTINUE
               END-IF
             END-IF
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報."
      D             "市場通貨コード=["
      D             WK-SIJO-TUKA-CD     OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
           IF  FLG-TORI-UPD = CNS-1
           THEN
             CONTINUE
           ELSE
             MOVE  CNS-OFF                TO  FLG-SEARCH-END
      *---------- 3)市場通貨コードの属性セット
             INITIALIZE  WK-IDX5
             PERFORM  UNTIL
                      WK-IDX5 = CNS-500  OR FLG-SEARCH-END = CNS-ON
               COMPUTE  WK-IDX5 = WK-IDX5 + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク通貨情報.通貨コード("WK-IDX5") =["
      D             WK-TUKA-CD          OF  WK-TUKA-INFO(WK-IDX5)"]"
      *-----------------------------------------------------------------
               IF  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
                =  WK-TUKA-CD             OF  WK-TUKA-INFO(WK-IDX5)
               THEN
      *---------- ワーク通貨デフォールト端数.市場通貨小数点以下桁数 ← ワーク通貨情報.小数点以下桁数
                 MOVE  WK-ST-KETASU       OF  WK-TUKA-INFO(WK-IDX5)
                   TO  WK-BC-ST-KETASU    OF  WK-TUKA-DEF-HASU-SYRI-PARM
      *---------- ワーク通貨デフォールト端数.市場通貨端数処理方法 ← ワーク通貨情報.端数処理
                 MOVE  WK-HASU            OF  WK-TUKA-INFO(WK-IDX5)
                   TO  WK-BC-HS           OF  WK-TUKA-DEF-HASU-SYRI-PARM
                 MOVE  CNS-ON             TO  FLG-SEARCH-END
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "市場通貨小数点以下桁数 =["
      D             WK-BC-ST-KETASU    OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク通貨デフォールト端数."
      D             "市場通貨端数処理方法 =["
      D             WK-BC-HS           OF  WK-TUKA-DEF-HASU-SYRI-PARM"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             END-PERFORM
      *---------- 4)異動計算パターン取得
             PERFORM  SCZY4304-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
             IF  FLG-TORI-UPD = CNS-1
             THEN
               CONTINUE
             ELSE
      *---------- 7)銘柄属性取得区分所得
               PERFORM  SMZJ4014-2-RTN
      *---------- 8)銘柄属性取得
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性コールフラグ=["
      D                         FLG-MEG-CALL"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得区分    =["
      D             WK-MEG-ZKSE-SYUTK-KBN"]"
      *-----------------------------------------------------------------
               IF  FLG-MEG-CALL = CNS-1
               AND WK-MEG-ZKSE-SYUTK-KBN = CNS-MEG-ZKSE-SYUTK-1
               THEN
                 PERFORM  SCZY3031-RTN
               ELSE
                 CONTINUE
               END-IF
      *---------- 4)国内外国区分編集 ＆ ワーク費用計上諸区分の属性セット
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD       OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
      *---------- ワーク銘柄別断面情報.銘柄種類＝'1'(物) OR '2'(元本)の場合
               IF  WK-MEG-CD-SHRU    OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-1
               OR  WK-MEG-CD-SHRU    OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-2
               THEN
                 PERFORM  NAI-GAI-KBN-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク国内外国区分 =["WK-NAI-GAI-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD       OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD証券種別コード=["
      D             WK-OLD-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク国内外国区分 =["WK-NAI-GAI-KBN"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD国内外国区分 =["
      D             WK-OLD-NAI-GAI-KBN"]"
      *-----------------------------------------------------------------
                 IF  WK-SEC-SBT-CD  OF  WK-TKMZBW03
                 NOT= WK-OLD-SEC-SBT-CD
                 OR  WK-NAI-GAI-KBN NOT=  WK-OLD-NAI-GAI-KBN
                 THEN
      *---------- 4)ワーク費用計上諸区分の属性セット
                   PERFORM  SMZJ4011-RTN
      *---------- BワークOLD証券種別コード ← ワーク銘柄別断面情報.証券種別コード
                   MOVE  WK-SEC-SBT-CD  OF  WK-TKMZBW03
                     TO  WK-OLD-SEC-SBT-CD
      *----------   ワークOLD国内外国区分 ← ワーク国内外国区分
                   MOVE  WK-NAI-GAI-KBN TO  WK-OLD-NAI-GAI-KBN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークOLD証券種別コード =["
      D             WK-OLD-SEC-SBT-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワークOLD国内外国区分   =["
      D             WK-OLD-NAI-GAI-KBN"]"
      *-----------------------------------------------------------------
                 ELSE
                   CONTINUE
                 END-IF
               ELSE
                 CONTINUE
               END-IF
      *---------- 9)乗除区分取得処理
               PERFORM  SCZY4502-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
               IF  FLG-TORI-UPD = CNS-1
               THEN
                 CONTINUE
               ELSE
      *---------- ワーク銘柄別断面情報.証券種別コード≠ワークOLD証券種別コード2の場合
                 IF  WK-SEC-SBT-CD            OF  WK-TKMZBW03
                 NOT =  WK-OLD-SEC-SBT-CD-2
                 THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード≠"
      D             "ワークOLD証券種別コード2"
      *-----------------------------------------------------------------
      *---------- 8)管理数量単位の取得処理
                   PERFORM  SURYO-TANI-RTN
                 ELSE
                   CONTINUE
                 END-IF
      *---------- 11)数量単位再取得処理
                 PERFORM  SMZJ4022-RTN
      *---------- 12)銘柄属性取得区分所得
                 PERFORM  SMZJ4014-3-RTN
      *---------- 13)0クーポン債判定処理
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性情報.利付／割引区分  = ["
      D             WK-RITUKI-WARI-KBN   OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性情報.利率／割引率    = ["
      D             WK-RRT-WARI-RT       OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性情報.単位１日あたり利息額"
      D             "=["WK-TANI-1-YMD-RG OF  WK-MEG-ZOK-INFO"]"
      *-----------------------------------------------------------------
                 IF  WK-RITUKI-WARI-KBN OF  WK-MEG-ZOK-INFO = CNS-X-1
                 AND WK-RRT-WARI-RT     OF  WK-MEG-ZOK-INFO = ZERO
                 AND (WK-TANI-1-YMD-RG  OF  WK-MEG-ZOK-INFO = ZERO  OR
                      WK-TANI-1-YMD-RG  OF  WK-MEG-ZOK-INFO = CNS-ALL9)
                 THEN
      *---------- ワーク0クーポン債フラグ
                   MOVE  CNS-1          TO  WK-0-CUPON-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク0クーポン債フラグ = ["
      D             WK-0-CUPON-FLG"]"
      *-----------------------------------------------------------------
                 ELSE
                   CONTINUE
                 END-IF
               END-IF
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 銘柄断面ループ属性データセット"
      D            "処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       MEG-DMN-GRP-EXT.
           EXIT.
      ******************************************************************
      *    銘柄別断面情報TBLの証券種別コードに更新処理
      ******************************************************************
       TKMZBW03-UPDATE-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別断面情報TBLの証券種別コード"
      D             "に更新処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMZBW03-UPDATE
      *---------- ワーク銘柄別断面情報.証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  H-SEC-SBT-CD           OF  H-TKMZBW03-UPDATE,
                 WK-SEC-SBT-CD          OF  WK-MSG-1-15
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  H-SYORI-YMD            OF  H-TKMZBW03-UPDATE,
                 WK-SYORI-YMD-S         OF  WK-MSG-1-15
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  H-KIDOU-ID             OF  H-TKMZBW03-UPDATE,
                 WK-KIDOU-ID-S          OF  WK-MSG-1-15
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW03-UPDATE,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-15
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZBW03-UPDATE,
                 WK-FUND-CD-S           OF  WK-MSG-1-15
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZBW03-UPDATE,
                 WK-PTF-CD-S            OF  WK-MSG-1-15
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMZBW03-UPDATE,
                 WK-KJN-YMD-S           OF  WK-MSG-1-15
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-MEG-CD               OF  H-TKMZBW03-UPDATE,
                 WK-MEG-CD-S            OF  WK-MSG-1-15
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  H-TATE-FLG             OF  H-TKMZBW03-UPDATE,
                 WK-TATE-FLG-S          OF  WK-MSG-1-15
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  H-GYOKU-ID             OF  H-TKMZBW03-UPDATE,
                 WK-GYOKU-ID-S          OF  WK-MSG-1-15
      *---------- 銘柄種類
           MOVE  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
             TO  H-MEG-CD-SHRU          OF  H-TKMZBW03-UPDATE,
                 WK-MEG-CD-SHRU-S       OF  WK-MSG-1-15
      *---------- テーブルID
           MOVE  WK-TBL-TKMZBW03
             TO  SQL-TKMZBW03           OF  SQL-UPDATE-1-15,
                 WK-TKMZBW03-S          OF  WK-MSG-1-15
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             H-SYORI-YMD         OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             H-KIDOU-ID          OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             H-PTF-CD            OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             H-KJN-YMD           OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             H-MEG-CD            OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             H-TATE-FLG          OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":玉ID=["
      D             H-GYOKU-ID          OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類=["
      D             H-MEG-CD-SHRU       OF  H-TKMZBW03-UPDATE"]"
      D    DISPLAY  CNS-PGM-ID":WK-MSG-1-15=["WK-MSG-1-15"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT15                                        @3212SEINO@@
      *----ＳＱＬ文
           MOVE  SQL-UPDATE-1-15         TO  SQLSTMT15                  @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT15=["SQLSTMT15"]"                @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-2=["FLG-OPEN-FLG-2"]"      @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-OPEN-FLG-2  NOT = CNS-ON                             @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC SQL
               PREPARE  S15  FROM :SQLSTMT15                            @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-069          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MSG-1-15         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *-----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D              "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           END-IF
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
           EXEC SQL
               EXECUTE S15
                 USING :H-TKMZBW03-UPDATE
           END-EXEC
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-UPDATE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
            OR SQLCODE  =  CNS-SQL-NOTFOUND
            OR SQLCODE  =  CNS-SQL-UNIQUE
           THEN
             MOVE  CNS-ON               TO  FLG-OPEN-FLG-2              @3212SEINO@@
      *----------------------<DEBUG>------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-2=["FLG-OPEN-FLG-2"]"      @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-070          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-UPDATE,
                     WK-MSG-1-15         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *----------ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D              "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           END-IF
      *-----------------------<DEBUG>-----------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別断面情報TBLの証券種別コード"
      D             "に更新処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW03-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    1)銘柄コードリファレンス取得
      ******************************************************************
       SCZY3002-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄コードリファレンス取得 処理"
      D             "  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY3002-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  PARM-SCZY3002-ARG1
      *---------- 内部銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  NAIBU-MEG-CD           OF  PARM-SCZY3002-ARG1
      *---------- 商品分類コード
           MOVE  SPACE
             TO  SYOHIN-BUNRUI-CD       OF  PARM-SCZY3002-ARG1
      *---------- 証券種別コード
           MOVE  WK-GAIBU-MEG-CD-SSC
             TO  SEC-SBT-CD             OF  PARM-SCZY3002-ARG1
      *---------- 元証券種別コード
           MOVE  SPACE
             TO  MOTO-SEC-SBT-CD        OF  PARM-SCZY3002-ARG1
      *---------- 銘柄通貨コード
           MOVE  WK-GAIBU-MEG-CD-STC
             TO  MEG-TUKA-CD            OF  PARM-SCZY3002-ARG1
      *---------- コードリファレンス系列コード
           MOVE  SPACE
             TO  CD-REF-KRTU-CD         OF  PARM-SCZY3002-ARG1
      *---------- 業務タスクID
           MOVE  SPACE
             TO  GYOMU-TASK-ID          OF  PARM-SCZY3002-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  PARM-SCZY3002-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":内部銘柄コード=["
      D             NAIBU-MEG-CD        OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":商品分類コード=["
      D             SYOHIN-BUNRUI-CD    OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":元証券種別コード=["
      D             MOTO-SEC-SBT-CD     OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄通貨コード=["
      D             MEG-TUKA-CD         OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":コードリファレンス系列コード=["
      D             CD-REF-KRTU-CD      OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY3002-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             KJN-YMD             OF  PARM-SCZY3002-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY3002"             USING  PARM-SCZY3002-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3002)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク銘柄コードリファレンス初期化
             INITIALIZE  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.銘柄通貨コード ← リターンパッケージ.銘柄通貨コード
             MOVE  MEG-TUKA-CD          OF  PARM-SCZY3002-ARG2
               TO  WK-MEG-TUKA-CD       OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.発行体国コード ← リターンパッケージ.発行体国コード
             MOVE  HAKKO-TAI-KUNI-CD    OF  PARM-SCZY3002-ARG2
               TO  WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.投資対象国コード ← リターンパッケージ.投資対象国コード
             MOVE  TOUSI-TARGET-KUNI-CD OF  PARM-SCZY3002-ARG2
               TO  WK-TSTSK-CD          OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.外部銘柄コード ← リターンパッケージ.外部銘柄コード
             MOVE  GAIBU-MEG-CD         OF  PARM-SCZY3002-ARG2
               TO  WK-GAIBU-MEG-CD      OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.株式種別 ← リターンパッケージ.株式種別
             MOVE  KABU-SBT             OF  PARM-SCZY3002-ARG2
               TO  WK-KABU-SBT          OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.回 ← リターンパッケージ.回
             MOVE  KAYI                 OF  PARM-SCZY3002-ARG2
               TO  WK-KAYI              OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.号 ← リターンパッケージ.号
             MOVE  GOU                  OF  PARM-SCZY3002-ARG2
               TO  WK-GOU               OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.限月 ← リターンパッケージ.限月
             MOVE  GENGETSU             OF  PARM-SCZY3002-ARG2
               TO  WK-GENGETSU          OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.ストライクプライス ← リターンパッケージ.ストライクプライス
             MOVE  STRIKEPRICE          OF  PARM-SCZY3002-ARG2
               TO  WK-STRIKEPRICE       OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.満期日 ← リターンパッケージ.満期日
             MOVE  MNK-YMD              OF  PARM-SCZY3002-ARG2
               TO  WK-MNK-YMD           OF  WK-MEG-CD-REF
      *---------- ワーク銘柄コードリファレンス.証券種別コード ←  リターンパッケージ.証券種別コード
             MOVE  SEC-SBT-CD           OF  PARM-SCZY3002-ARG2
               TO  WK-SEC-SBT-CD        OF  WK-MEG-CD-REF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "銘柄通貨コード=["
      D             WK-MEG-TUKA-CD      OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "=["
      D             WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "投資対象国コード=["
      D             WK-TSTSK-CD         OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "外部銘柄コード=["
      D             WK-GAIBU-MEG-CD     OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "株式種別=["
      D             WK-KABU-SBT         OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス.回"
      D             "=["
      D             WK-KAYI             OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "号=["
      D             WK-GOU              OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "限月=["
      D             WK-GENGETSU         OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "ストライクプライス=["
      D             WK-STRIKEPRICE      OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "満期日=["
      D             WK-MNK-YMD          OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "証券種別コード    =["
      D             WK-SEC-SBT-CD       OF  WK-MEG-CD-REF"]"
      *-----------------------------------------------------------------
           ELSE
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-110
             THEN
               MOVE  CNS-1              TO   WK-MSG-FLG-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3002コールデータなしフラグ =["
      D             WK-MSG-FLG-1"]"
      *-----------------------------------------------------------------
               IF  WK-TORI-UPD-FLG = CNS-1
               THEN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
                 IF  WK-MEG-CD-SHRU     OF  WK-TKMZBW03
                   = CNS-MEG-CD-SHRU-3
                 THEN
      *---------- 有効銘柄チェック
                   PERFORM  YUKO-MEG-CHECK-RTN
                 ELSE
                   PERFORM  SCZY3002-MSG-RTN
                 END-IF
                 MOVE  CNS-1  TO  FLG-TORI-UPD
               ELSE
                 MOVE  ZERO   TO  FLG-TORI-UPD
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-071          TO  WK-ERR-POS
               PERFORM  ERR-MSG-1-RTN
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 銘柄コードリファレンス取得  処理"
      D             " END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY3002-EXT.
           EXIT.
      ******************************************************************
      *    有効銘柄チェック
      ******************************************************************
       YUKO-MEG-CHECK-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  有効銘柄チェック処理  START  ***"
      *-----------------------------------------------------------------
            INITIALIZE  FLG-CHECK
      *---------- 直前履歴のチェック処理
            PERFORM  TKMZSR00-CHECK-RTN
      *---------- 資金取引のチェック処理
            IF  FLG-CHECK = CNS-ON
            THEN
              CONTINUE
            ELSE
              PERFORM  TKMXST00-CHECK-RTN
            END-IF
      *---------- 未収補正のチェック処理
            IF  FLG-CHECK = CNS-ON
            THEN
              CONTINUE
            ELSE
              PERFORM  TKMZMS00-CHECK-RTN
            END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 有効銘柄チェック処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       YUKO-MEG-CHECK-EXT.
           EXIT.
      ******************************************************************
      *    直前履歴のチェック処理
      ******************************************************************
       TKMZSR00-CHECK-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  直前履歴のチェック処理(別紙1-23)  START  ***"
      D    DISPLAY  CNS-PGM-ID":*** CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT23
                       SQL-SELECT-1-23
                       H-TKMZSR00-23-S
                       H-TKMZSR00-23-W
                       WK-MSG-1-23
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZSR00-23-W,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-23
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZSR00-23-W,
                 WK-FUND-CD             OF  WK-MSG-1-23
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZSR00-23-W,
                 WK-PTF-CD              OF  WK-MSG-1-23
      *---------- 決済口座番号
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-KS-KOZA-NO           OF  H-TKMZSR00-23-W,
                 WK-KS-KOZA-NO          OF  WK-MSG-1-23
      *---------- 基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMZSR00-23-W,
                 WK-KJN-YMD             OF  WK-MSG-1-23
      *----------  テーブルID
           MOVE  WK-TBL-TKMZSR00
             TO  SQL-TKMZSR00           OF  SQL-SELECT-1-23,
                 WK-MSG-TKMZSR00        OF  WK-MSG-1-23
           MOVE  SQL-SELECT-1-23        TO  SQLSTMT23
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZSR00-23-W"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZSR00-23-W"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZSR00-23-W"]"
      D    DISPLAY  CNS-PGM-ID ":決済口座番号=["
      D             H-KS-KOZA-NO         OF  H-TKMZSR00-23-W"]"
      D    DISPLAY  CNS-PGM-ID ":基準日=["
      D             H-KJN-YMD            OF  H-TKMZSR00-23-W"]"
      D    DISPLAY  CNS-PGM-ID ":WK-MSG-1-23=[" WK-MSG-1-23 "]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT23=[" SQLSTMT23 "]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMZSR00=["FLG-OPEN-TKMZSR00"]"
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START
           IF  FLG-OPEN-TKMZSR00  NOT =  CNS-ON
           THEN
      *----------  CURSOR PREPARE
             EXEC  SQL
               PREPARE  S23  FROM  :SQLSTMT23
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポジション
               MOVE  CNS-POS-170        TO  WK-ERR-POS
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- リターンコード
               MOVE  CNS-RTN-900        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-23
                 DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZSR00_CUR_23  CURSOR  FOR  S23
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZSR00_CUR_23
               USING :H-TKMZSR00-23-W
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-OPEN-TKMZSR00
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMZSR00=["FLG-OPEN-TKMZSR00"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-171          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-23
               DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID":*** CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH  TKMZSR00_CUR_23
               INTO :H-TKMZSR00-23-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ": CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               MOVE  CNS-ON             TO  FLG-CHECK
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-CHECK=["FLG-CHECK"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             H-RIYO-CMP-CD       OF  H-TKMZSR00-23-S"]"
      *-----------------------------------------------------------------
               PERFORM  SCZY3002-MSG-RTN
             WHEN  CNS-SQL-NOTFOUND
               CONTINUE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  NOTFOUND"
      *-----------------------------------------------------------------
             WHEN OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポジション
               MOVE  CNS-POS-172        TO  WK-ERR-POS
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- リターンコード
               MOVE  CNS-RTN-900        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-23
                 DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":***  直前履歴のチェック処理(別紙1-23) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZSR00-CHECK-EXT.
           EXIT.
      ******************************************************************
      *    資金取引のチェック処理
      ******************************************************************
       TKMXST00-CHECK-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  資金取引のチェック処理(別紙1-24)  START  ***"
      D    DISPLAY  CNS-PGM-ID":*** CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT24
                       SQL-SELECT-1-24
                       H-TKMXST00-24-S
                       H-TKMXST00-24-W
                       WK-MSG-1-24
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMXST00-24-W,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-24
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMXST00-24-W,
                 WK-FUND-CD             OF  WK-MSG-1-24
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMXST00-24-W,
                 WK-PTF-CD              OF  WK-MSG-1-24
      *---------- 決済口座番号
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-KS-KOZA-NO           OF  H-TKMXST00-24-W,
                 WK-KS-KOZA-NO          OF  WK-MSG-1-24
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  H-KAISI-KJN-YMD        OF  H-TKMXST00-24-W,
                 WK-KAISI-KJN-YMD       OF  WK-MSG-1-24
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMXST00-24-W,
                 WK-KJN-YMD             OF  WK-MSG-1-24
      *----------  テーブルID
           MOVE  WK-TBL-TKMXST00
             TO  SQL-TKMXST00           OF  SQL-SELECT-1-24,
                 WK-MSG-TKMXST00        OF  WK-MSG-1-24
           MOVE  SQL-SELECT-1-24        TO  SQLSTMT24
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMXST00-24-W"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMXST00-24-W"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMXST00-24-W"]"
      D    DISPLAY  CNS-PGM-ID ":決済口座番号=["
      D             H-KS-KOZA-NO         OF  H-TKMXST00-24-W"]"
      D    DISPLAY  CNS-PGM-ID ":開始基準日=["
      D             H-KAISI-KJN-YMD      OF  H-TKMXST00-24-W"]"
      D    DISPLAY  CNS-PGM-ID ":基準日=["
      D             H-KJN-YMD            OF  H-TKMXST00-24-W"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT24=[" SQLSTMT24 "]"
      D    DISPLAY  CNS-PGM-ID ":WK-MSG-1-24=[" WK-MSG-1-24 "]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMXST00=["FLG-OPEN-TKMXST00"]"
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START
           IF  FLG-OPEN-TKMXST00  NOT =  CNS-ON
           THEN
      *----------  CURSOR PREPARE
             EXEC  SQL
               PREPARE  S24  FROM  :SQLSTMT24
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポジション
               MOVE  CNS-POS-173        TO  WK-ERR-POS
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- リターンコード
               MOVE  CNS-RTN-900        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-24
                 DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMXST00_CUR_24  CURSOR  FOR  S24
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMXST00_CUR_24
               USING :H-TKMXST00-24-W
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-OPEN-TKMXST00
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMXST00=["FLG-OPEN-TKMXST00"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-174          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-24
               DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID":*** CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH  TKMXST00_CUR_24
               INTO :H-TKMXST00-24-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ": CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
               MOVE  CNS-ON             TO  FLG-CHECK
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-CHECK=["FLG-CHECK"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             H-RIYO-CMP-CD       OF  H-TKMXST00-24-S"]"
      *-----------------------------------------------------------------
               PERFORM  SCZY3002-MSG-RTN
             WHEN  CNS-SQL-NOTFOUND
               CONTINUE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  NOTFOUND"
      *-----------------------------------------------------------------
             WHEN OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポジション
               MOVE  CNS-POS-175        TO  WK-ERR-POS
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- リターンコード
               MOVE  CNS-RTN-900        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-24
                 DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":***  資金取引のチェック処理(別紙1-24) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMXST00-CHECK-EXT.
           EXIT.
      ******************************************************************
      *    未収補正のチェック処理
      ******************************************************************
       TKMZMS00-CHECK-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  未収補正のチェック処理(別紙1-25)  START  ***"
      D    DISPLAY  CNS-PGM-ID":*** CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT25
                       SQL-SELECT-1-25
                       H-TKMZMS00-25-S
                       H-TKMZMS00-25-W
                       WK-MSG-1-25
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZMS00-25-W,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-25
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZMS00-25-W,
                 WK-FUND-CD             OF  WK-MSG-1-25
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZMS00-25-W,
                 WK-PTF-CD              OF  WK-MSG-1-25
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-MEG-CD               OF  H-TKMZMS00-25-W,
                 WK-MEG-CD              OF  WK-MSG-1-25
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  H-TATE-FLG             OF  H-TKMZMS00-25-W,
                 WK-TATE-FLG            OF  WK-MSG-1-25
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  H-GYOKU-ID             OF  H-TKMZMS00-25-W,
                 WK-GYOKU-ID            OF  WK-MSG-1-25
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  H-KAISI-KJN-YMD        OF  H-TKMZMS00-25-W,
                 WK-KAISI-KJN-YMD       OF  WK-MSG-1-25
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMZMS00-25-W,
                 WK-KJN-YMD             OF  WK-MSG-1-25
      *----------  テーブルID
           MOVE  WK-TBL-TKMZMS00
             TO  SQL-TKMZMS00           OF  SQL-SELECT-1-25,
                 WK-MSG-TKMZMS00        OF  WK-MSG-1-25
           MOVE  SQL-SELECT-1-25        TO  SQLSTMT25
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード=["
      D             H-MEG-CD             OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":資産負債・買建売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":玉ID=["
      D             H-GYOKU-ID           OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":開始基準日=["
      D             H-KAISI-KJN-YMD      OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":基準日=["
      D             H-KJN-YMD            OF  H-TKMZMS00-25-W"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT25=[" SQLSTMT25 "]"
      D    DISPLAY  CNS-PGM-ID ":WK-MSG-1-25=[" WK-MSG-1-25 "]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMZMS00=["FLG-OPEN-TKMZMS00"]"
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START
           IF  FLG-OPEN-TKMZMS00  NOT =  CNS-ON
           THEN
      *----------  CURSOR PREPARE
             EXEC  SQL
               PREPARE  S25  FROM  :SQLSTMT25
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR PREPARE 正常"
      *-----------------------------------------------------------------
               CONTINUE
             ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポジション
               MOVE  CNS-POS-176        TO  WK-ERR-POS
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- リターンコード
               MOVE  CNS-RTN-900        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-25
                 DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-RTN
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
             EXEC  SQL
               DECLARE  TKMZMS00_CUR_25  CURSOR  FOR  S25
             END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZMS00_CUR_25
               USING :H-TKMZMS00-25-W
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-OPEN-TKMZMS00
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMZMS00=["FLG-OPEN-TKMZMS00"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ポジション
             MOVE  CNS-POS-177          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-25
               DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID":*** CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH  TKMZMS00_CUR_25
               INTO :H-TKMZMS00-25-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ": CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             H-RIYO-CMP-CD       OF  H-TKMZMS00-25-S"]"
      *-----------------------------------------------------------------
               PERFORM  SCZY3002-MSG-RTN
             WHEN  CNS-SQL-NOTFOUND
               CONTINUE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  NOTFOUND"
      *-----------------------------------------------------------------
             WHEN OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
      *---------- ポジション
               MOVE  CNS-POS-178        TO  WK-ERR-POS
      *---------- エラー検知プログラムID
               MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
      *---------- リターンコード
               MOVE  CNS-RTN-900        TO  WK-RTN-CD
      *---------- 詳細リターンコード
               MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
               MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-25
                 DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
               PERFORM  ERR-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** CURSOR FETCH END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":***  未収補正のチェック処理(別紙1-25) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZMS00-CHECK-EXT.
           EXIT.
      ******************************************************************
      *    ワークメッセージへインサート
      ******************************************************************
       SCZY3002-MSG-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  ワークメッセージへインサート START ***"
      *-----------------------------------------------------------------
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M34のメッセージID
           MOVE  CNS-MSG-E000580
             TO  WK-MSG-ID              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '証拠金の銘柄ｺｰﾄﾞﾘﾌｧﾚﾝｽ'
           MOVE  CNS-TK-MOJI-73
             TO  WK-TK-MOJI             OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-MEG-CD         OF  WK-TKMZBW03,
                   CNS-MSG-15,WK-GAIBU-MEG-CD-SSC,
                   CNS-MSG-16,WK-GAIBU-MEG-CD-STC
                   DELIMITED  BY  SIZE
              INTO  WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA＋1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
           MOVE  CNS-RTN-BT4            TO  WK-RETURN-CD
      *---------- ワーク明細単位実行ステータス
           MOVE  CNS-MT-JS-270          TO  WK-MT-JIKKOU-STATUS
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）
           MOVE  CNS-MT-JS-270
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "進捗ステータス（基準日） =["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":***  ワークメッセージへインサート END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY3002-MSG-EXT.
           EXIT.
      ******************************************************************
      *    4)国内外国区分編集
      ******************************************************************
       NAI-GAI-KBN-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  国内外国区分編集 処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード=["
      D             WK-SEC-SBT-CD       OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄コードリファレンス."
      D             "発行体国コード=["
      D             WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.運用通貨コード=["
      D             WK-CAPITAL-TUKA-CD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.市場通貨コード=["
      D             WK-SIJO-TUKA-CD     OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性情報.ユーロ円債区分  =["
      D             WK-EURO-BOND-KBN    OF  WK-MEG-ZOK-INFO"]"
      *-----------------------------------------------------------------
           EVALUATE  WK-SEC-SBT-CD      OF  WK-TKMZBW03
             WHEN  CNS-X-DSMS
             WHEN  CNS-X-DBMS
             WHEN  CNS-X-ETDB
             WHEN  CNS-X-ETDS
             WHEN  CNS-X-ETDC
             WHEN  CNS-X-ITDB
             WHEN  CNS-X-ITDS
             WHEN  CNS-X-ITDC
      *---------- ワーク国内外国区分 ← '0'( 国内)
               MOVE  CNS-NAI-GAI-KBN-0  TO  WK-NAI-GAI-KBN
             WHEN  CNS-X-FSMS
             WHEN  CNS-X-FBMS
             WHEN  CNS-X-ETFS
             WHEN  CNS-X-ETFB
             WHEN  CNS-X-ETF
             WHEN  CNS-X-ITFS
             WHEN  CNS-X-ITFB
             WHEN  CNS-X-ITF
             WHEN  CNS-X-MAFB
             WHEN  CNS-X-MAFS
      *---------- ワーク国内外国区分 ← '1' (海外)
               MOVE  CNS-NAI-GAI-KBN-1  TO  WK-NAI-GAI-KBN
             WHEN  CNS-X-B
             WHEN  CNS-X-CB
             WHEN  CNS-X-WB
             WHEN  CNS-X-CBMS
               IF   WK-CAPITAL-TUKA-CD    OF WK-TKMZBW02 = CNS-JPY
                AND WK-SIJO-TUKA-CD       OF WK-TKMZBW03 = CNS-JPY
                AND ( WK-EURO-BOND-KBN    OF WK-MEG-ZOK-INFO
                  = CNS-EURO-BOND-KBN-0
                 OR  WK-EURO-BOND-KBN     OF WK-MEG-ZOK-INFO
                  = SPACE )
               THEN
      *---------- ワーク国内外国区分 ← '0'( 国内)
                 MOVE  CNS-NAI-GAI-KBN-0  TO WK-NAI-GAI-KBN
               ELSE
      *---------- ワーク国内外国区分 ← '1' (海外)
                 MOVE  CNS-NAI-GAI-KBN-1  TO WK-NAI-GAI-KBN
               END-IF
             WHEN  CNS-X-CASH
             WHEN  CNS-X-MAR
             WHEN  CNS-X-MABF
             WHEN  CNS-X-MABO
             WHEN  CNS-X-MAB
             WHEN  CNS-X-MASF
             WHEN  CNS-X-MASO
             WHEN  CNS-X-MAS
               IF  WK-CAPITAL-TUKA-CD     OF WK-TKMZBW02
                =  WK-SIJO-TUKA-CD        OF WK-TKMZBW03
               THEN
      *---------- ワーク国内外国区分 ← '0'( 国内)
                 MOVE  CNS-NAI-GAI-KBN-0  TO WK-NAI-GAI-KBN
               ELSE
      *---------- ワーク国内外国区分 ← '1' (海外)
                 MOVE  CNS-NAI-GAI-KBN-1  TO WK-NAI-GAI-KBN
               END-IF
             WHEN  OTHER
               IF   WK-CAPITAL-TUKA-CD    OF WK-TKMZBW02 = CNS-JPY
                AND WK-SIJO-TUKA-CD       OF WK-TKMZBW03 = CNS-JPY
                AND ( WK-HAKKO-TAI-KUNI-CD
                                          OF WK-MEG-CD-REF = CNS-JPN
                OR  WK-HAKKO-TAI-KUNI-CD  OF WK-MEG-CD-REF = SPACE )
               THEN
      *---------- ワーク国内外国区分 ← '0'( 国内)
                 MOVE  CNS-NAI-GAI-KBN-0  TO  WK-NAI-GAI-KBN
               ELSE
      *---------- ワーク国内外国区分 ← '1' (海外)
                 MOVE  CNS-NAI-GAI-KBN-1  TO  WK-NAI-GAI-KBN
               END-IF
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク国内外国区分 =["WK-NAI-GAI-KBN"]"
      D    DISPLAY  CNS-PGM-ID":*** 国内外国区分編集 処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       NAI-GAI-KBN-EXT.
           EXIT.
      ******************************************************************
      *    4)ワーク費用計上諸区分の属性セット
      ******************************************************************
       SMZJ4011-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ワーク費用計上諸区分の属性セット"
      D             "処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4011-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SMZJ4011-ARG1
      *---------- 仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD      OF  WK-TKMZBW02
             TO  SWK-KJN-PTN-CD         OF  PARM-SMZJ4011-ARG1
      *---------- 測定基準区分
           MOVE  WK-ST-KJN-KBN          OF  WK-TKMZBW02
             TO  ST-KJN-KBN             OF  PARM-SMZJ4011-ARG1
      *---------- 国内外国区分
           MOVE  WK-NAI-GAI-KBN
             TO  NAI-GAI-KBN            OF  PARM-SMZJ4011-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  PARM-SMZJ4011-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SMZJ4011-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準パターンコード=["
      D             SWK-KJN-PTN-CD      OF  PARM-SMZJ4011-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":測定基準区分=["
      D             ST-KJN-KBN          OF  PARM-SMZJ4011-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":国内外国区分=["
      D             NAI-GAI-KBN         OF  PARM-SMZJ4011-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZJ4011-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4011"             USING  PARM-SMZJ4011-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4011)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *----------  為替差損益計上区分
             MOVE  UKS-KJY-KBN          OF  PARM-SMZJ4011-ARG2
               TO  WK-UKS-KJY-KBN       OF  WK-HIYO-KJY-M-KBN
      *----------  手数料用売買損益に含むフラグ
             MOVE  TESRY-BN-FLG         OF  PARM-SMZJ4011-ARG2
               TO  WK-TESRY-BN-FLG      OF  WK-HIYO-KJY-M-KBN
      *----------  消費税用売買損益に含むフラグ
             MOVE  SHOHI-TAX-BN-FLG     OF  PARM-SMZJ4011-ARG2
               TO  WK-SHOHI-TAX-BN-FLG  OF  WK-HIYO-KJY-M-KBN
      *----------  その他費用用売買損益に含むフラグ
             MOVE  ELS-HIYO-BN-FLG      OF  PARM-SMZJ4011-ARG2
               TO  WK-ELS-HIYO-BN-FLG   OF  WK-HIYO-KJY-M-KBN
      *----------  日歩用売買損益に含むフラグ
             MOVE  HIBU-BBSNEKI-FLG     OF  PARM-SMZJ4011-ARG2
               TO  WK-HIBU-BBSNEKI-FLG  OF  WK-HIYO-KJY-M-KBN
      *----------  逆日歩用売買損益に含むフラグ
             MOVE  GHIBU-BBSNEKI-FLG    OF  PARM-SMZJ4011-ARG2
               TO  WK-GHIBU-BBSNEKI-FLG OF  WK-HIYO-KJY-M-KBN
      *----------  管理費用売買損益に含むフラグ
             MOVE  KRH-BBSNEKI-FLG      OF  PARM-SMZJ4011-ARG2
               TO  WK-KRH-BBSNEKI-FLG   OF  WK-HIYO-KJY-M-KBN
      *----------  管理費消費税用売買損益に含むフラグ
             MOVE  KRH-SHZ-BBSNEKI-FLG  OF  PARM-SMZJ4011-ARG2
               TO  WK-KRH-SHZ-BBSNEKI-FLG
                                        OF  WK-HIYO-KJY-M-KBN
      *----------  手数料を市場取得金額に含めるフラグ
             MOVE  TESRY-SJST-KN-FLG    OF  PARM-SMZJ4011-ARG2
               TO  WK-TESRY-SJST-KN-FLG OF  WK-HIYO-KJY-M-KBN
      *----------  消費税を市場取得金額に含めるフラグ
             MOVE  SHOHI-TAX-SJST-KN-FLG
                                        OF  PARM-SMZJ4011-ARG2
               TO  WK-SHOHI-TAX-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
      *----------  その他費用を市場取得金額に含めるフラグ
             MOVE  ELS-HIYO-SJST-KN-FLG OF  PARM-SMZJ4011-ARG2
               TO  WK-ELS-HIYO-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
      *----------  日歩を市場取得金額に含めるフラグ
             MOVE  KSG-HIBU-SJST-KN-FLG OF  PARM-SMZJ4011-ARG2
               TO  WK-KSG-HIBU-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
      *----------  逆日歩を市場取得金額に含めるフラグ
             MOVE  KSG-GHIBU-SJST-KN-FLG
                                        OF  PARM-SMZJ4011-ARG2
               TO  WK-KSG-GHIBU-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
      *----------  管理費を市場取得金額に含めるフラグ
             MOVE  KSG-SJST-KN-FLG      OF  PARM-SMZJ4011-ARG2
               TO  WK-KSG-SJST-KN-FLG   OF  WK-HIYO-KJY-M-KBN
      *----------  管理費消費税を市場取得金額に含めるフラグ
             MOVE  KSG-KRH-SJST-KN-FLG  OF  PARM-SMZJ4011-ARG2
               TO  WK-KSG-KRH-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-072          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク費用計上諸区分:"
      D    DISPLAY  CNS-PGM-ID":為替差損益計上区分=["
      D             WK-UKS-KJY-KBN      OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ=["
      D             WK-TESRY-BN-FLG     OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ=["
      D             WK-SHOHI-TAX-BN-FLG OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ=["
      D             WK-ELS-HIYO-BN-FLG  OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":日歩用売買損益に含むフラグ=["
      D             WK-HIBU-BBSNEKI-FLG OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩用売買損益に含むフラグ=["
      D             WK-GHIBU-BBSNEKI-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":管理費用売買損益に含むフラグ=["
      D             WK-KRH-BBSNEKI-FLG  OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税用売買損益に含むフラグ=["
      D             WK-KRH-SHZ-BBSNEKI-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含めるフラグ=["
      D             WK-TESRY-SJST-KN-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含めるフラグ=["
      D             WK-SHOHI-TAX-SJST-KN-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含める"
      D    "フラグ=[" WK-ELS-HIYO-SJST-KN-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":日歩を市場取得金額に含めるフラグ=["
      D             WK-KSG-HIBU-SJST-KN-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩を市場取得金額に含めるフラグ=["
      D             WK-KSG-GHIBU-SJST-KN-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":管理費を市場取得金額に含めるフラグ=["
      D             WK-KSG-SJST-KN-FLG  OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税を市場取得金額に含める"
      D    "フラグ=[" WK-KSG-KRH-SJST-KN-FLG
      D                                 OF  WK-HIYO-KJY-M-KBN"]"
      D    DISPLAY  CNS-PGM-ID":*** ワーク費用計上諸区分の属性セット"
      D             "処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4011-EXT.
           EXIT.
      ******************************************************************
      *    4)異動計算パターン取得
      ******************************************************************
       SCZY4304-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動計算パターン取得 処理START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4304-INOUT
                       PARM-RTNPKG
      *---------- 異動計算パターンコード
           MOVE  WK-IDO-CALC-PATTERN-CD OF  WK-TKMZBW02
             TO  IDO-CALC-PATTERN-CD    OF  PARM-SCZY4304-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  SIJO-TUKA-CD           OF  PARM-SCZY4304-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  PARM-SCZY4304-ARG1
      *---------- 保有目的
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03(1:1)
             TO  POSSESSION-OBJECT      OF  PARM-SCZY4304-ARG1
      *---------- 異動計算パターンデータエリア
           MOVE  WK-TBL-TKPFPT01-AREA   TO  PARM-SCZY4304-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":異動計算パターンコード=["
      D             IDO-CALC-PATTERN-CD OF  PARM-SCZY4304-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             SIJO-TUKA-CD        OF  PARM-SCZY4304-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SCZY4304-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":保有目的=["
      D             POSSESSION-OBJECT   OF  PARM-SCZY4304-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":異動計算パターンデータエリア=["
      *                                     PARM-SCZY4304-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4304"             USING  PARM-SCZY4304-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4304)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク異動計算パターン情報 初期化
             INITIALIZE  WK-IDO-CALC-PATTERN-INFO
      *---------- 利用会社コード
             MOVE  RIYO-CMP-CD          OF  PARM-SCZY4304-ARG3
               TO  WK-RIYO-CMP-CD       OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 異動計算パターンコード
             MOVE  IDO-CALC-PATTERN-CD  OF  PARM-SCZY4304-ARG3
               TO  WK-IDO-CALC-PATTERN-CD
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 市場通貨コード
             MOVE  SIJO-TUKA-CD         OF  PARM-SCZY4304-ARG3
               TO  WK-SIJO-TUKA-CD      OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 証券種別コード
             MOVE  SEC-SBT-CD           OF  PARM-SCZY4304-ARG3
               TO  WK-SEC-SBT-CD        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 保有目的
             MOVE  POSSESSION-OBJECT    OF  PARM-SCZY4304-ARG3
               TO  WK-POSSESSION-OBJECT OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 払出簿価計算方法
             MOVE  DEBET-BOKA-CALC-HOU  OF  PARM-SCZY4304-ARG3
               TO  WK-DEBET-BOKA-CALC-HOU
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 払出簿価端数（市場通貨）
             MOVE  DEBET-BOKA-HASU-BC   OF  PARM-SCZY4304-ARG3
               TO  WK-DEBET-BOKA-HASU-BC
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 払出単価桁数（市場通貨）
             MOVE  DEBET-TNK-KETASU-BC  OF  PARM-SCZY4304-ARG3
               TO  WK-DEBET-TNK-KETASU-BC
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 払出単価端数（市場通貨）
             MOVE  DEBET-TNK-HASU-BC    OF  PARM-SCZY4304-ARG3
               TO  WK-DEBET-TNK-HASU-BC OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 払出簿価端数（運用通貨）
             MOVE  DEBET-BOKA-HASU-LC   OF  PARM-SCZY4304-ARG3
               TO  WK-DEBET-BOKA-HASU-LC
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 払出単価桁数（運用通貨）
             MOVE  DEBET-TNK-KETASU-LC  OF  PARM-SCZY4304-ARG3
               TO  WK-DEBET-TNK-KETASU-LC
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 払出単価端数（運用通貨）
             MOVE  DEBET-TNK-HASU-LC    OF  PARM-SCZY4304-ARG3
               TO  WK-DEBET-TNK-HASU-LC OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 売り続く限り同一コスト
             MOVE  URI-TUDUKU-SAME-COST OF  PARM-SCZY4304-ARG3
               TO  WK-URI-TUDUKU-SAME-COST
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 同一日は同一コスト
             MOVE  SAME-YMD-SAME-COST   OF  PARM-SCZY4304-ARG3
               TO  WK-SAME-YMD-SAME-COST
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）１
             MOVE  TEKIYO-SAKI-SYRI1    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI1 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）２
             MOVE  TEKIYO-SAKI-SYRI2    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI2 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）３
             MOVE  TEKIYO-SAKI-SYRI3    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI3 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）４
             MOVE  TEKIYO-SAKI-SYRI4    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI4 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）５
             MOVE  TEKIYO-SAKI-SYRI5    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI5 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）６
             MOVE  TEKIYO-SAKI-SYRI6    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI6 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）７
             MOVE  TEKIYO-SAKI-SYRI7    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI7 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）８
             MOVE  TEKIYO-SAKI-SYRI8    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI8 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（先処理）９
             MOVE  TEKIYO-SAKI-SYRI9    OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-SAKI-SYRI9 OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）１
             MOVE  TEKIYO-ATO-SYRI1     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI1  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）２
             MOVE  TEKIYO-ATO-SYRI2     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI2  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）３
             MOVE  TEKIYO-ATO-SYRI3     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI3  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）４
             MOVE  TEKIYO-ATO-SYRI4     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI4  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）５
             MOVE  TEKIYO-ATO-SYRI5     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI5  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）６
             MOVE  TEKIYO-ATO-SYRI6     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI6  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）７
             MOVE  TEKIYO-ATO-SYRI7     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI7  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）８
             MOVE  TEKIYO-ATO-SYRI8     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI8  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 適用（後処理）９
             MOVE  TEKIYO-ATO-SYRI9     OF  PARM-SCZY4304-ARG3
               TO  WK-TEKIYO-ATO-SYRI9  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 簿価為替レート適用フラグ
             MOVE  BOKA-KWS-TEKIYO-FLG  OF  PARM-SCZY4304-ARG3
               TO  WK-BOKA-KWS-TEKIYO-FLG
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 簿価為替レート端数
             MOVE  BOKA-KWS-HASU        OF  PARM-SCZY4304-ARG3
               TO  WK-BOKA-KWS-HASU     OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 簿価為替レート桁数
             MOVE  BOKA-KWS-KETASU      OF  PARM-SCZY4304-ARG3
               TO  WK-BOKA-KWS-KETASU   OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 新／旧株の区別
             MOVE  NEW-KYU-KABU-KBN     OF  PARM-SCZY4304-ARG3
               TO  WK-NEW-KYU-KABU-KBN  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 新／旧簿価計算方法
             MOVE  NEW-KYU-BOKA-CALC    OF  PARM-SCZY4304-ARG3
               TO  WK-NEW-KYU-BOKA-CALC OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 按分簿価端数
             MOVE  ANB-BOKA-HASU        OF  PARM-SCZY4304-ARG3
               TO  WK-ANB-BOKA-HASU     OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 按分単価端数
             MOVE  ANB-TNK-HASU         OF  PARM-SCZY4304-ARG3
               TO  WK-ANB-TNK-HASU      OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 按分単価桁数
             MOVE  ANB-TNK-KETASU       OF  PARM-SCZY4304-ARG3
               TO  WK-ANB-TNK-KETASU    OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 前払金償却方法
             MOVE  MAEKIN-SHOUKYK-HOU   OF  PARM-SCZY4304-ARG3
               TO  WK-MAEKIN-SHOUKYK-HOU
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 前払金償却分端数
             MOVE  MAEKIN-SHOUKYK-HASU  OF  PARM-SCZY4304-ARG3
               TO  WK-MAEKIN-SHOUKYK-HASU
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 増減取引順
             MOVE  ZOUGEN-TORI-JUN      OF  PARM-SCZY4304-ARG3
               TO  WK-ZOUGEN-TORI-JUN   OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 増加取引処理順序
             MOVE  GKYK-PLUS-SYRI-JUN   OF  PARM-SCZY4304-ARG3
               TO  WK-GKYK-PLUS-SYRI-JUN
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 減少取引処理順序
             MOVE  GKYK-MINUS-SYRI-JUN  OF  PARM-SCZY4304-ARG3
               TO  WK-GKYK-MINUS-SYRI-JUN
                                        OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 処理順序
             MOVE  SYRI-JUN             OF  PARM-SCZY4304-ARG3
               TO  WK-SYRI-JUN          OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 更新日時
             MOVE  UPD-DATE             OF  PARM-SCZY4304-ARG3
               TO  WK-UPD-DATE          OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 更新ログインユーザ会社コード
             MOVE  UPD-LOGIN-CMP-CD     OF  PARM-SCZY4304-ARG3
               TO  WK-UPD-LOGIN-CMP-CD  OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 更新ユーザID
             MOVE  UPD-SID              OF  PARM-SCZY4304-ARG3
               TO  WK-UPD-SID           OF  WK-IDO-CALC-PATTERN-INFO
      *---------- 更新プログラムID
             MOVE  UPD-PGMID            OF  PARM-SCZY4304-ARG3
               TO  WK-UPD-PGMID         OF  WK-IDO-CALC-PATTERN-INFO
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             WK-RIYO-CMP-CD      OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターンコード=["
      D             WK-IDO-CALC-PATTERN-CD
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             WK-SIJO-TUKA-CD     OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             WK-SEC-SBT-CD       OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":保有目的=["
      D             WK-POSSESSION-OBJECT
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価計算方法=["
      D             WK-DEBET-BOKA-CALC-HOU
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（市場通貨）=["
      D             WK-DEBET-BOKA-HASU-BC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（市場通貨）=["
      D             WK-DEBET-TNK-KETASU-BC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（市場通貨）=["
      D             WK-DEBET-TNK-HASU-BC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（運用通貨）=["
      D             WK-DEBET-BOKA-HASU-LC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（運用通貨）=["
      D             WK-DEBET-TNK-KETASU-LC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（運用通貨）=["
      D             WK-DEBET-TNK-HASU-LC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限り同一コスト=["
      D             WK-URI-TUDUKU-SAME-COST
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":同一日は同一コスト=["
      D             WK-SAME-YMD-SAME-COST
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）１=["
      D             WK-TEKIYO-SAKI-SYRI1
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）２=["
      D             WK-TEKIYO-SAKI-SYRI2
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）３=["
      D             WK-TEKIYO-SAKI-SYRI3
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）４=["
      D             WK-TEKIYO-SAKI-SYRI4
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）５=["
      D             WK-TEKIYO-SAKI-SYRI5
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）６=["
      D             WK-TEKIYO-SAKI-SYRI6
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）７=["
      D             WK-TEKIYO-SAKI-SYRI7
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）８=["
      D             WK-TEKIYO-SAKI-SYRI8
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）９=["
      D             WK-TEKIYO-SAKI-SYRI9
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）１=["
      D             WK-TEKIYO-ATO-SYRI1 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）２=["
      D             WK-TEKIYO-ATO-SYRI2 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）３=["
      D             WK-TEKIYO-ATO-SYRI3 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）４=["
      D             WK-TEKIYO-ATO-SYRI4 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）５=["
      D             WK-TEKIYO-ATO-SYRI5 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）６=["
      D             WK-TEKIYO-ATO-SYRI6 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）７=["
      D             WK-TEKIYO-ATO-SYRI7 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）８=["
      D             WK-TEKIYO-ATO-SYRI8 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）９=["
      D             WK-TEKIYO-ATO-SYRI9 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート適用フラグ=["
      D             WK-BOKA-KWS-TEKIYO-FLG
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート端数=["
      D             WK-BOKA-KWS-HASU    OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート桁数=["
      D             WK-BOKA-KWS-KETASU  OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":新／旧株の区別=["
      D             WK-NEW-KYU-KABU-KBN OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":新／旧簿価計算方法=["
      D             WK-NEW-KYU-BOKA-CALC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":按分簿価端数=["
      D             WK-ANB-BOKA-HASU    OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":按分単価端数=["
      D             WK-ANB-TNK-HASU     OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":按分単価桁数=["
      D             WK-ANB-TNK-KETASU   OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":前払金償却方法=["
      D             WK-MAEKIN-SHOUKYK-HOU
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":前払金償却分端数=["
      D             WK-MAEKIN-SHOUKYK-HASU
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":増減取引順=["
      D             WK-ZOUGEN-TORI-JUN  OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":増加取引処理順序=["
      D             WK-GKYK-PLUS-SYRI-JUN
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":減少取引処理順序=["
      D             WK-GKYK-MINUS-SYRI-JUN
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":処理順序=["
      D             WK-SYRI-JUN         OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":更新日時=["
      D             WK-UPD-DATE         OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード=["
      D             WK-UPD-LOGIN-CMP-CD OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザID=["
      D             WK-UPD-SID          OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムID=["
      D             WK-UPD-PGMID        OF  WK-IDO-CALC-PATTERN-INFO"]"
      *-----------------------------------------------------------------
      *---------- C)ワーク基準日断面情報.運用通貨コード ＝ ワーク銘柄別断面情報.市場通貨コードの場合
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.運用通貨コード=["
      D                      WK-CAPITAL-TUKA-CD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.市場通貨コード=["
      D                      WK-SIJO-TUKA-CD     OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
             IF  WK-CAPITAL-TUKA-CD  OF  WK-TKMZBW02
              =  WK-SIJO-TUKA-CD     OF  WK-TKMZBW03
             THEN
               MOVE  WK-DEBET-BOKA-HASU-LC   OF WK-IDO-CALC-PATTERN-INFO
                 TO  WK-DEBET-BOKA-HASU-BC   OF WK-IDO-CALC-PATTERN-INFO
               MOVE  WK-DEBET-TNK-KETASU-LC  OF WK-IDO-CALC-PATTERN-INFO
                 TO  WK-DEBET-TNK-KETASU-BC  OF WK-IDO-CALC-PATTERN-INFO
               MOVE  WK-DEBET-TNK-HASU-LC    OF WK-IDO-CALC-PATTERN-INFO
                 TO  WK-DEBET-TNK-HASU-BC    OF WK-IDO-CALC-PATTERN-INFO
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（運用通貨）=["
      D             WK-DEBET-BOKA-HASU-LC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（運用通貨）=["
      D             WK-DEBET-TNK-KETASU-LC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（運用通貨）=["
      D             WK-DEBET-TNK-HASU-LC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（市場通貨）=["
      D             WK-DEBET-BOKA-HASU-BC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（市場通貨）=["
      D             WK-DEBET-TNK-KETASU-BC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（市場通貨）=["
      D             WK-DEBET-TNK-HASU-BC
      D                                 OF  WK-IDO-CALC-PATTERN-INFO"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-110
             THEN
               PERFORM  M34-FREE-AREA-RTN
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-073          TO  WK-ERR-POS
               PERFORM  ERR-MSG-1-RTN
             END-IF
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD=["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
           IF  FLG-TORI-UPD = CNS-1
           THEN
             CONTINUE
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク異動計算パターン情報.処理順序=["
      D                      WK-SYRI-JUN  OF WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D    "基本会計ベースフラグ=["WK-KH-KK-BASE-FLG  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- ワーク異動計算パターン情報.処理順序＝
      *---------- ('5' or '6' or '7' or '8') 且つ
      *---------- ワーク基準日断面情報.基本会計ベースフラグ＝'1'(約定ベース)
             IF (WK-SYRI-JUN OF WK-IDO-CALC-PATTERN-INFO
              = CNS-SYRI-JUN-5
             OR WK-SYRI-JUN OF WK-IDO-CALC-PATTERN-INFO = CNS-SYRI-JUN-6
             OR WK-SYRI-JUN OF WK-IDO-CALC-PATTERN-INFO = CNS-SYRI-JUN-7
             OR WK-SYRI-JUN OF WK-IDO-CALC-PATTERN-INFO
              = CNS-SYRI-JUN-8)
             AND WK-KH-KK-BASE-FLG OF WK-TKMZBW02 = CNS-KH-KK-BASE-FLG-1
             THEN
      *---------- ワーク約定ベース受渡順フラグ
               MOVE  CNS-YKJ-1            TO  WK-YKJ-UKE-JUN-FLG
             ELSE
      *---------- ワーク約定ベース受渡順フラグ
               MOVE  CNS-YKJ-0            TO  WK-YKJ-UKE-JUN-FLG
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク約定ベース受渡順フラグ=["
      D                                            WK-YKJ-UKE-JUN-FLG"]"
      *-----------------------------------------------------------------
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク約定ベース受渡順フラグ=["
      D                                            WK-YKJ-UKE-JUN-FLG"]"
      D    DISPLAY  CNS-PGM-ID":*** 異動計算パターン取得  処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY4304-EXT.
           EXIT.
      ******************************************************************
      *    8)銘柄属性取得
      ******************************************************************
       SCZY3031-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 銘柄属性取得  処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY3031-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  PARM-SCZY3031-ARG1
      *---------- 内部銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  NAIBU-MEG-CD           OF  PARM-SCZY3031-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SYOUKEN-CD             OF  PARM-SCZY3031-ARG1
      *---------- 銘柄通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  MEIGAR-TUKA-CD         OF  PARM-SCZY3031-ARG1
      *---------- 業務タスクID
           MOVE  SPACE
             TO  GYOUMU-TASKU-CD        OF  PARM-SCZY3031-ARG1
      *---------- 基本属性取得用基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KIHON-KIJYUN-BI        OF  PARM-SCZY3031-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY3031-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":内部銘柄コード=["
      D             NAIBU-MEG-CD        OF  PARM-SCZY3031-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SYOUKEN-CD          OF  PARM-SCZY3031-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄通貨コード=["
      D             MEIGAR-TUKA-CD      OF  PARM-SCZY3031-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOUMU-TASKU-CD     OF  PARM-SCZY3031-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基本属性取得用基準日=["
      D             KIHON-KIJYUN-BI     OF  PARM-SCZY3031-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SCZY3031"             USING  PARM-SCZY3031-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3031)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *    DISPLAY  CNS-PGM-ID":リターンパッケージ.銘柄名称（日本語）=["
      *             MEG-NAME-J          OF  PARM-SCZY3031-ARG2"]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
             WHEN  CNS-RTN-111
      *        IF  MEG-NAME-J           OF  PARM-SCZY3031-ARG2
      *         =  CNS-MEG-NAME-J
      *        THEN
      *---------- ワーク銘柄属性取得フラグ
      *          MOVE  CNS-MEG-ZOK-0      TO  FLG-MEG-ZOK
      *-------------------<DEBUG>---------------------------------------
      *    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得フラグ =["
      *             FLG-MEG-ZOK"]"
      *-----------------------------------------------------------------
      *        ELSE
      *---------- 現地源泉税非課税区分
                 MOVE  LCL-GS-TAX-NOTAX-KBN OF  PARM-SCZY3031-ARG2
                   TO  WK-G-GSZ-NOTAX-KBN   OF  WK-MEG-ZOK-INFO
      *---------- 初期利払起算日
                 MOVE  SHOKI-RIBAR-KS-YMD   OF  PARM-SCZY3031-ARG2
                   TO  WK-SHOKI-RB-KS-YMD   OF  WK-MEG-ZOK-INFO
      *---------- 初期利払日
                 MOVE  SHOKI-RIBAR-YMD      OF  PARM-SCZY3031-ARG2
                   TO  WK-SHOKI-RIBAR-YMD   OF  WK-MEG-ZOK-INFO
      *---------- 最終利払起算日
                 MOVE  LAST-RIBAR-KISAN-YMD OF  PARM-SCZY3031-ARG2
                   TO  WK-LAST-RB-KS-YMD    OF  WK-MEG-ZOK-INFO
      *---------- 終期利払日
                 MOVE  LAST-RIBAR-YMD       OF  PARM-SCZY3031-ARG2
                   TO  WK-SHUKI-RIBAR-YMD   OF  WK-MEG-ZOK-INFO
      *---------- 利払回数
                 MOVE  KESSAN-RIBAR-KAISU   OF  PARM-SCZY3031-ARG2
                   TO  WK-RIBAR-KAISU       OF  WK-MEG-ZOK-INFO
      *---------- 利払日１
                 MOVE  KESSAN-RIBAR-YMD-1   OF  PARM-SCZY3031-ARG2
                   TO  WK-RIBAR-YMD-1       OF  WK-MEG-ZOK-INFO
      *---------- 利払日２
                 MOVE  KESSAN-RIBAR-YMD-2   OF  PARM-SCZY3031-ARG2
                   TO  WK-RIBAR-YMD-2       OF  WK-MEG-ZOK-INFO
      *---------- 利払日３
                 MOVE  KESSAN-RIBAR-YMD-3   OF  PARM-SCZY3031-ARG2
                   TO  WK-RIBAR-YMD-3       OF  WK-MEG-ZOK-INFO
      *---------- 利払日４
                 MOVE  KESSAN-RIBAR-YMD-4   OF  PARM-SCZY3031-ARG2
                   TO  WK-RIBAR-YMD-4       OF  WK-MEG-ZOK-INFO
      *---------- ファクター・連動係数
                 MOVE  RENKSU               OF  PARM-SCZY3031-ARG2
                   TO  WK-FT-RENDOU-KESU    OF  WK-MEG-ZOK-INFO
      *---------- 単位１日あたり利息額
                 MOVE  TANI-1-YMD-RSK-GAKU  OF  PARM-SCZY3031-ARG2
                   TO  WK-TANI-1-YMD-RG     OF  WK-MEG-ZOK-INFO
      *---------- 経過日数計算方法
                 MOVE  KEKA-NISU-CALC-HOU   OF  PARM-SCZY3031-ARG2
                   TO  WK-KN-CALC-HOU       OF  WK-MEG-ZOK-INFO
      *---------- 経過日数計算方法１ヶ月３０日設定区分
                 MOVE  KKNS-KSHH-1M30D-KBN  OF  PARM-SCZY3031-ARG2
                   TO  WK-KKKS-1M30D-KBN    OF  WK-MEG-ZOK-INFO
      *---------- 経過日数計算方法片端／両端区分
                 MOVE  KKNS-KSHH-KTT-RT-KBN OF  PARM-SCZY3031-ARG2
                   TO  WK-KKK-KTT-RT-KBN    OF  WK-MEG-ZOK-INFO
      *---------- 勘定科目出力商品名
                 MOVE  KNJ-KAMK-OUT-SYOHIN  OF  PARM-SCZY3031-ARG2
                   TO  WK-KNJ-KAMK-OUT-SYOHIN
                                          OF  WK-MEG-ZOK-INFO
      *---------- 利付／割引区分
                 MOVE  RITUKI-WARI-KBN      OF  PARM-SCZY3031-ARG2
                   TO  WK-RITUKI-WARI-KBN   OF  WK-MEG-ZOK-INFO
      *---------- 利払日休日処理区分
                 MOVE  K-R-YMD-QJT-SYRI-KBN      OF  PARM-SCZY3031-ARG2
                   TO  WK-RIBAR-YMD-QJT-SR-KBN   OF  WK-MEG-ZOK-INFO
      *---------- 初期利払日休日処理区分
                 MOVE  SHOKI-RB-YMD-QJT-KBN      OF  PARM-SCZY3031-ARG2
                   TO  WK-SHOKI-RB-YMD-QJT-KBN   OF  WK-MEG-ZOK-INFO
      *---------- 終期利払日休日処理区分
                 MOVE  SHUKI-RB-YMD-QJT-KBN      OF  PARM-SCZY3031-ARG2
                   TO  WK-SHUKI-RB-YMD-QJT-KBN   OF  WK-MEG-ZOK-INFO
      *---------- 設定日
                 MOVE  SET-YMD                   OF  PARM-SCZY3031-ARG2
                   TO  WK-SET-YMD                OF  WK-MEG-ZOK-INFO
      *---------- 乗数（分子）
                 MOVE  JYOUSUU-BUNSI             OF  PARM-SCZY3031-ARG2
                   TO  WK-JYOUSUU-BUNSI          OF  WK-MEG-ZOK-INFO
      *---------- 乗数（分母）
                 MOVE  JYOUSUU-BUNBO             OF  PARM-SCZY3031-ARG2
                   TO  WK-JYOUSUU-BUNBO          OF  WK-MEG-ZOK-INFO
      *---------- コールプット区分
                 MOVE  CALL-PUT-KBN              OF  PARM-SCZY3031-ARG2
                   TO  WK-CALL-PUT-KBN           OF  WK-MEG-ZOK-INFO
      *---------- 固定変動区分
                 MOVE  FIX-VRBL-KBN              OF  PARM-SCZY3031-ARG2
                   TO  WK-FIX-VRBL-KBN           OF  WK-MEG-ZOK-INFO
      *---------- 連動係数参照区分
                 MOVE  RENKSU-REF-KBN            OF  PARM-SCZY3031-ARG2
                   TO  WK-RENKSU-REF-KBN         OF  WK-MEG-ZOK-INFO
      *---------- 利率／割引率
                 MOVE  RRT-WARI-RT               OF  PARM-SCZY3031-ARG2
                   TO  WK-RRT-WARI-RT            OF  WK-MEG-ZOK-INFO
      *---------- ユーロ円債区分
                 MOVE  EURO-BOND-KBN             OF  PARM-SCZY3031-ARG2
                   TO  WK-EURO-BOND-KBN          OF  WK-MEG-ZOK-INFO
      *---------- 償還日
                 MOVE  SHOKAN-YMD                OF  PARM-SCZY3031-ARG2
                   TO  WK-SHOKAN-YMD             OF  WK-MEG-ZOK-INFO
      *---------- 償還日休日処理区分
                 MOVE  SHOKAN-QJT-SYRI-KBN       OF  PARM-SCZY3031-ARG2
                   TO  WK-SHOKAN-QJT-SYRI-KBN    OF  WK-MEG-ZOK-INFO
      *---------- ワーク銘柄属性取得フラグ
                 MOVE  CNS-MEG-ZOK-1             TO  FLG-MEG-ZOK
      *---------- 利払日数
                 MOVE  RIBAR-NISU                OF  PARM-SCZY3031-ARG2
                   TO  WK-RIBAR-NISU             OF  WK-MEG-ZOK-INFO
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":現地源泉税非課税区分 =["
      D             WK-G-GSZ-NOTAX-KBN  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":初期利払起算日 =["
      D             WK-SHOKI-RB-KS-YMD  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日 =["
      D             WK-SHOKI-RIBAR-YMD  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":最終利払起算日 =["
      D             WK-LAST-RB-KS-YMD   OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日 =["
      D             WK-SHUKI-RIBAR-YMD  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利払回数 =["
      D             WK-RIBAR-KAISU      OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利払日１ =["
      D             WK-RIBAR-YMD-1      OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利払日２ =["
      D             WK-RIBAR-YMD-2      OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利払日３ =["
      D             WK-RIBAR-YMD-3      OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利払日４ =["
      D             WK-RIBAR-YMD-4      OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ファクター・連動係数 =["
      D             WK-FT-RENDOU-KESU   OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":単位１日あたり利息額 =["
      D             WK-TANI-1-YMD-RG    OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法 =["
      D             WK-KN-CALC-HOU      OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法１ヶ月３０日設定区分 =["
      D             WK-KKKS-1M30D-KBN   OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法片端／両端区分 =["
      D             WK-KKK-KTT-RT-KBN   OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":勘定科目出力商品名 =["
      D             WK-KNJ-KAMK-OUT-SYOHIN
      D                                 OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利付／割引区分 =["
      D             WK-RITUKI-WARI-KBN  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利払日休日処理区分 =["
      D             WK-RIBAR-YMD-QJT-SR-KBN  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日休日処理区分 =["
      D             WK-SHOKI-RB-YMD-QJT-KBN  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日休日処理区分 =["
      D             WK-SHUKI-RB-YMD-QJT-KBN  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":設定日 =["
      D             WK-SET-YMD  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":乗数（分子） =["
      D             WK-JYOUSUU-BUNSI  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":乗数（分母） =["
      D             WK-JYOUSUU-BUNBO  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":コールプット区分 =["
      D             WK-CALL-PUT-KBN   OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":固定変動区分 =["
      D             WK-FIX-VRBL-KBN   OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":連動係数参照区分 =["
      D             WK-RENKSU-REF-KBN OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":利率／割引率     =["
      D             WK-RRT-WARI-RT    OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ユーロ円債区分   =["
      D             WK-EURO-BOND-KBN  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":償還日           =["
      D             WK-SHOKAN-YMD     OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":償還日休日処理区分   =["
      D             WK-SHOKAN-QJT-SYRI-KBN  OF  WK-MEG-ZOK-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得フラグ =["
      D             FLG-MEG-ZOK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク利払日数 =["
      D             WK-RIBAR-NISU"]"
      *-----------------------------------------------------------------
                 IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
                 =  CNS-RTN-111
                 THEN
                   MOVE  CNS-1            TO  WK-MSG-FLG-2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コール一部該当データ"
      D             "なしフラグ =["WK-MSG-FLG-2"]"
      *-----------------------------------------------------------------
                 ELSE
                   CONTINUE
                 END-IF
      *        END-IF
             WHEN  CNS-RTN-110
      *---------- B)データセット
               MOVE  CNS-MEG-ZOK-0      TO  FLG-MEG-ZOK
               MOVE  CNS-1              TO  WK-MSG-FLG-4
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得フラグ =["
      D             FLG-MEG-ZOK"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コールデータなしフラグ"
      D             " =["WK-MSG-FLG-4"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-112
      *---------- A)データセット
               MOVE  CNS-MEG-ZOK-0      TO  FLG-MEG-ZOK
               MOVE  CNS-1              TO  WK-MSG-FLG-3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得フラグ =["
      D             FLG-MEG-ZOK"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コール利率取得失敗フラグ"
      D             " =["WK-MSG-FLG-3"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-074          TO  WK-ERR-POS
               PERFORM  ERR-MSG-1-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 銘柄属性取得  処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY3031-EXT.
           EXIT.
      ******************************************************************
      *    @ ワークメッセージエリアへインサート
      ******************************************************************
       M24-FREE-AREA-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- ワーク銘柄コードリファレンス.外部銘柄コード
           MOVE  WK-GAIBU-MEG-CD        OF  WK-MEG-CD-REF
             TO  WK-TK-MOJI             OF  WK-MSG-AREA(WK-CounterA,1)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA＋1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
           MOVE  CNS-RTN-BT4            TO  WK-RETURN-CD
      *---------- ワーク明細単位実行ステータス
           MOVE  CNS-MT-JS-270          TO  WK-MT-JIKKOU-STATUS
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）
           MOVE  CNS-MT-JS-270
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "進捗ステータス（基準日） =["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           CONTINUE.
       M24-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *    ポートフォリオエラーメッセージへインサート
      ******************************************************************
       M34-FREE-AREA-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M34のメッセージID
           MOVE  CNS-MSG-E000580
             TO  WK-MSG-ID              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '異動計算パターン'
           MOVE  CNS-TK-MOJI-74
             TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03,
                   CNS-MSG-38,WK-GYOKU-ID       OF  WK-TKMZBW03(1:1)
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------<DEBUG>--------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA＋1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
           MOVE  CNS-RTN-BT4            TO  WK-RETURN-CD
      *---------- ワーク明細単位実行ステータス
           MOVE  CNS-MT-JS-270          TO  WK-MT-JIKKOU-STATUS
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）
           MOVE  CNS-MT-JS-270
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
           MOVE  CNS-1  TO  FLG-TORI-UPD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "進捗ステータス（基準日） =["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD =["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
           CONTINUE.
       M34-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *    ポートフォリオエラーメッセージへインサート
      ******************************************************************
       M34-FREE-AREA1-RTN     SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M34のメッセージID
           MOVE  CNS-MSG-E000580
             TO  WK-MSG-ID              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '為替換算情報'
           MOVE  CNS-TK-MOJI-77
             TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03,
                   CNS-MSG-38,WK-GYOKU-ID       OF  WK-TKMZBW03(1:1)
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------<DEBUG>--------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA＋1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
           MOVE  CNS-RTN-BT4            TO  WK-RETURN-CD
      *---------- ワーク明細単位実行ステータス
           MOVE  CNS-MT-JS-270          TO  WK-MT-JIKKOU-STATUS
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）
           MOVE  CNS-MT-JS-270
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
           MOVE  CNS-1  TO  FLG-TORI-UPD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "進捗ステータス（基準日） =["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TORI-UPD =["FLG-TORI-UPD"]"
      *-----------------------------------------------------------------
           CONTINUE.
       M34-FREE-AREA1-EXT.
           EXIT.
      ******************************************************************
      *    ワークメッセージエリアへインサート
      ******************************************************************
       M41-FREE-AREA-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M41のメッセージID
           MOVE  CNS-MSG-W000655
             TO  WK-MSG-ID              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
           MOVE  WK-STRIKEPRICE         OF  WK-MEG-CD-REF
             TO  WK-STRIKEPRICE-M
           MOVE  WK-STRIKEPRICE-M               TO  WK-STRIKEPRICE-X
           STRING  WK-MIDDLE-FREE-MSG(1:WK-MIDDLE-FREE-COUNT),
                   CNS-MSG-14,  WK-GAIBU-MEG-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD
                                                OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   WK-KAYI                      OF  WK-MEG-CD-REF,
                   WK-GOU                       OF  WK-MEG-CD-REF,
                   WK-GENGETSU                  OF  WK-MEG-CD-REF,
                   WK-STRIKEPRICE-X,
                   WK-MNK-YMD                   OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
             INTO  WK-FREE-MSG          OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT2
           THEN
             MOVE  CNS-RTN-BT2          TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
           THEN
             MOVE  CNS-MT-JS-200        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           IF  WK-STK-STS-KJN-YMD       OF  WK-TKMZBW02 < CNS-MT-JS-200
           THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '200'(警告終了)
             MOVE  CNS-MT-JS-200
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           CONTINUE.
       M41-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *    11)数量単位再取得処理
      ******************************************************************
       SMZJ4022-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  数量単位再取得処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4022-INOUT
                       PARM-RTNPKG
      *---------- 銘柄属性取得フラグ
           MOVE  FLG-MEG-ZOK
             TO  MEG-ZOK-FLG             OF  PARM-SMZJ4022-ARG1
      *---------- 管理数量単位
           MOVE  WK-KANRI-SURYO-TANI
             TO  KANRI-SURYO-TANI        OF  PARM-SMZJ4022-ARG1
      *---------- 銘柄取得用データ.利用会社コード
           MOVE  WK-RIYO-CMP-CD          OF  WK-TKMZBW02
             TO  RIYO-CMP-CD             OF  PARM-SMZJ4022-ARG1
      *---------- 銘柄取得用データ.内部銘柄コード
           MOVE  WK-MEG-CD               OF  WK-TKMZBW03
             TO  NAIBU-MEG-CD            OF  PARM-SMZJ4022-ARG1
      *---------- 銘柄取得用データ.証券種別コード
           MOVE  WK-SEC-SBT-CD           OF  WK-TKMZBW03
             TO  SEC-SBT-CD              OF  PARM-SMZJ4022-ARG1
      *---------- 銘柄取得用データ.銘柄通貨コード
           MOVE  WK-SIJO-TUKA-CD         OF  WK-TKMZBW03
             TO  MEG-TUKA-CD             OF  PARM-SMZJ4022-ARG1
      *---------- 銘柄取得用データ.基本属性取得用基準日
           MOVE  WK-KJN-YMD              OF  WK-TKMZBW03
             TO  KIHON-KIJYUN-BI         OF  PARM-SMZJ4022-ARG1
      *---------- 銘柄属性データ.乗数（分子）
           MOVE  WK-JYOUSUU-BUNSI        OF  WK-MEG-ZOK-INFO
             TO  JYOUSUU-BUNSI           OF  PARM-SMZJ4022-ARG1
      *---------- 銘柄属性データ.乗数（分母）
           MOVE  WK-JYOUSUU-BUNBO        OF  WK-MEG-ZOK-INFO
             TO  JYOUSUU-BUNBO           OF  PARM-SMZJ4022-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄属性取得フラグ=["
      D             MEG-ZOK-FLG          OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理数量単位=["
      D             KANRI-SURYO-TANI     OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄取得用データ.利用会社コード=["
      D             RIYO-CMP-CD          OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄取得用データ.内部銘柄コード=["
      D             NAIBU-MEG-CD         OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄取得用データ.証券種別コード=["
      D             SEC-SBT-CD           OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄取得用データ.銘柄通貨コード=["
      D             MEG-TUKA-CD          OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄取得用データ.基本属性取得用基準日=["
      D             KIHON-KIJYUN-BI      OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ.乗数（分子）=["
      D             JYOUSUU-BUNSI        OF  PARM-SMZJ4022-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ.乗数（分母）=["
      D             JYOUSUU-BUNBO        OF  PARM-SMZJ4022-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4022"             USING  PARM-SMZJ4022-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4022)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク再計算数量単位 ← 【SMZJ4022】.ARG2.再計算数量単位
             MOVE  SAIKS-SURYO-TANI         OF  PARM-SMZJ4022-ARG2
               TO  WK-SAIKS-SURYO-TANI
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク再計算数量単位 =["
      D                                           WK-SAIKS-SURYO-TANI"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-075        TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  数量単位再取得処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4022-EXT.
           EXIT.
      ******************************************************************
      *    証券種別判定
      ******************************************************************
       SMZJ4014-3-RTN         SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4014-INOUT
                       PARM-RTNPKG
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  PARM-SMZJ4014-ARG1
      *---------- 判定対象区分
           MOVE  CNS-X-8
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4014-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分  =["
      D             HANTEI-TARGET-KBN   OF  PARM-SMZJ4014-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4014"             USING  PARM-SMZJ4014-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4014)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             MOVE  ZOUGENJYUN-SOTAIBT-KBN   OF  PARM-SMZJ4014-ARG2
               TO  WK-ZOUGENJYUN-SOTAIBT-KBN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク増減順相対物区分=["
      D             WK-MEG-ZKSE-SYUTK-KBN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4014-3-EXT.
           EXIT.
      ******************************************************************
      *    7)乗除区分取得処理
      ******************************************************************
       SCZY4502-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  乗除区分取得処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY4502-INOUT
                       PARM-RTNPKG
      *---------- 為替系列コード
           MOVE  WK-YKJ-RATE-CD         OF  WK-TKMZBW02
             TO  KWS-KRTU-CD            OF  PARM-SCZY4502-ARG1
      *---------- ベース通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  BASE-TUKA-CD           OF  PARM-SCZY4502-ARG1
      *---------- 目的通貨コード
           MOVE  WK-CAPITAL-TUKA-CD     OF  WK-TKMZBW02
             TO  MOKUTEKI-TUKA-CD       OF  PARM-SCZY4502-ARG1
      *---------- 為替換算情報データエリア
           MOVE  WK-TBL-TKJCKK00-AREA   TO  PARM-SCZY4502-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":為替系列コード=["
      D             KWS-KRTU-CD         OF  PARM-SCZY4502-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ベース通貨コード=["
      D             BASE-TUKA-CD        OF  PARM-SCZY4502-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":目的通貨コード=["
      D             MOKUTEKI-TUKA-CD    OF  PARM-SCZY4502-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":為替換算情報データエリア=["
      *                                     PARM-SCZY4502-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY4502"             USING  PARM-SCZY4502-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4502)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワーク乗算/除算区分 ← 【SCZY4502】.ARG3.乗算/除算区分
             MOVE  JZ-JS-KBN            OF  PARM-SCZY4502-ARG3
               TO  WK-JZ-JS-KBN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク乗算/除算区分 =["WK-JZ-JS-KBN"]"
      *-----------------------------------------------------------------
           ELSE
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-110
             THEN
               PERFORM  M34-FREE-AREA1-RTN
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-076        TO  WK-ERR-POS
               PERFORM  ERR-MSG-1-RTN
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  乗除区分取得処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY4502-EXT.
           EXIT.
      ******************************************************************
      *    8)管理数量単位の取得処理
      ******************************************************************
       SURYO-TANI-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***管理数量単位の取得処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード = ["
      D             WK-SEC-SBT-CD      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
           PERFORM  VARYING  WK-IDX6   FROM CNS-1 BY CNS-1
             UNTIL  WK-IDX6  > CNS-200   OR
                    WK-SEC-SBT-CD      OF  WK-TKMZBW03  =
                    SEC-SBT-CD         OF  WK-TKCMSZ00(WK-IDX6)
           END-PERFORM
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-IDX6   = ["WK-IDX6"]"
      *-----------------------------------------------------------------
           IF  WK-IDX6  >  CNS-200
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":該当データなしの場合"
      *-----------------------------------------------------------------
      *---------- エラーパッケージをセットして
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-077          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  ZERO                 TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
             IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
             THEN
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           ELSE
             MOVE  KANRI-SURYO-TANI    OF  WK-TKCMSZ00(WK-IDX6)
               TO  WK-KANRI-SURYO-TANI
           END-IF
      *---------- ワークOLD証券種別コード2 ← ワーク銘柄別断面情報.証券種別コード
           MOVE  WK-SEC-SBT-CD         OF  WK-TKMZBW03
             TO  WK-OLD-SEC-SBT-CD-2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク管理数量単位 = ["
      D             WK-KANRI-SURYO-TANI"]"
      D    DISPLAY  CNS-PGM-ID":*** 管理数量単位の取得処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SURYO-TANI-EXT.
           EXIT.
      ******************************************************************
      *    4.2.5.銘柄別断面情報データチェック処理
      ******************************************************************
       MEG-DMN-CHECK-RTN      SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 銘柄別断面情報データチェック 処理"
      D             "  START ***"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報データ.再計算区分 =["
      D             WK-SAI-CALC-KBN     OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
           IF  WK-SAI-CALC-KBN          OF  WK-TKMZBW03
            =  CNS-SAI-CALC-KBN-1
           THEN
      *---------- 4.2.5.2 対象取引決定と処理順決定
             PERFORM  TG-TRHK-KT-SRJUN-RTN
             IF  FLG-TORI-UPD = CNS-1
             THEN
               CONTINUE
             ELSE
      *---------- 4.2.5.3 対象取引別処理 ループ処理※「4.3処理」
               PERFORM  TARGET-TRHK-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別断面情報データチェック 処理"
      D             " END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       MEG-DMN-CHECK-EXT.
           EXIT.
      ******************************************************************
      *    4.2.5.再計算データ削除処理
      ******************************************************************
       SMZJ1710-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 再計算データ削除 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1710-INOUT
                       PARM-RTNPKG
      *----------  勘定異動／残高作成
           MOVE  I-KJIDO-ZANSK          OF  WK-DENBUN-IN
             TO  KJIDO-ZANSK            OF  PARM-SMZJ1710-ARG1
      *----------  基準日断面情報
           MOVE  WK-TKMZBW02
             TO  KJN-YMD-DAME-JYHO-PARM OF  PARM-SMZJ1710-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":勘定異動／残高作成 =["
      D             KJIDO-ZANSK         OF  PARM-SMZJ1710-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  KJN-YMD-DAME-JYHO-PARM
      D                                 OF  PARM-SMZJ1710-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  KJN-YMD-DAME-JYHO-PARM
      D                                 OF  PARM-SMZJ1710-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  KJN-YMD-DAME-JYHO-PARM
      D                                 OF  PARM-SMZJ1710-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  KJN-YMD-DAME-JYHO-PARM
      D                                 OF  PARM-SMZJ1710-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  KJN-YMD-DAME-JYHO-PARM
      D                                 OF  PARM-SMZJ1710-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  KJN-YMD-DAME-JYHO-PARM
      D                                 OF  PARM-SMZJ1710-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1710"             USING  PARM-SMZJ1710-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1710)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-078          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  再計算データ削除 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1710-EXT.
           EXIT.
      ******************************************************************
      *    4.2.4.約定ベース受渡順特殊差分処理
      ******************************************************************
       SMZJ1712-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 約定ベース受渡順特殊差分処理 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1712-INOUT
                       PARM-RTNPKG
      *----------  銘柄別断面情報
      *----------  処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  PARM-SMZJ1712-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  PARM-SMZJ1712-ARG1
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  PARM-SMZJ1712-ARG1
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  PARM-SMZJ1712-ARG1
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  PARM-SMZJ1712-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  PARM-SMZJ1712-ARG1
      *----------  基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  PARM-SMZJ1712-ARG1
      *----------  銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  PARM-SMZJ1712-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  PARM-SMZJ1712-ARG1
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  PARM-SMZJ1712-ARG1
      *----------  玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  PARM-SMZJ1712-ARG1
      *----------  差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  PARM-SMZJ1712-ARG1
      *---------- 銘柄種類
           MOVE  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
             TO  MEG-CD-SHRU            OF  PARM-SMZJ1712-ARG1
      *---------- 銘柄種類２
           MOVE  WK-MEG-CD-SHRU2        OF  WK-TKMZBW03
             TO  MEG-CD-SHRU2           OF  PARM-SMZJ1712-ARG1
      *----------  勘定異動／残高作成
           MOVE  I-KJIDO-ZANSK          OF  WK-DENBUN-IN
             TO  KJIDO-ZANSK            OF  PARM-SMZJ1712-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日                    =["
      D             SYORI-YMD           OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID                        =["
      D             KIDOU-ID            OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード                =["
      D             RIYO-CMP-CD         OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード                =["
      D             FUND-CD             OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード          =["
      D             PTF-CD              OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日                    =["
      D             KAISI-KJN-YMD       OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日                        =["
      D             KJN-YMD             OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード                    =["
      D             MEG-CD              OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード                =["
      D             SEC-SBT-CD          OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ      =["
      D             TATE-FLG            OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID                          =["
      D             GYOKU-ID            OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日                =["
      D             SABON-UPDATE-FROM   OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類                      =["
      D             MEG-CD-SHRU         OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類２                    =["
      D             MEG-CD-SHRU2        OF  PARM-SMZJ1712-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":勘定異動／残高作成 =["
      D             KJIDO-ZANSK         OF  PARM-SMZJ1712-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1712"             USING  PARM-SMZJ1712-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1712)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日 =["
      D             WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1712リターンした差分更新From日  =["
      D             SABON-UPDATE-FROM     OF  PARM-SMZJ1712-ARG2"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             MOVE  SABON-UPDATE-FROM     OF  PARM-SMZJ1712-ARG2
               TO  WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03
             MOVE  CNS-SAI-CALC-KBN-1
               TO  WK-SAI-CALC-KBN       OF  WK-TKMZBW03
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-166         TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日 =["
      D             WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.再計算区分 =["
      D             WK-SAI-CALC-KBN       OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1712リターンした差分更新From日  =["
      D             SABON-UPDATE-FROM     OF  PARM-SMZJ1712-ARG2"]"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 約定ベース受渡順特殊差分処理 処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1712-EXT.
           EXIT.
      ******************************************************************
      *    4.2.5.2 対象取引決定と処理順決定
      ******************************************************************
       TG-TRHK-KT-SRJUN-RTN   SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象取引決定と処理順決定 処理 "
      D             " START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
      *---------- 4.2.5.2.1ワーク銘柄別断面情報.銘柄種類＝'1'(物) OR '2'(元本)の場合
           IF  WK-MEG-CD-SHRU     OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-1 OR
               WK-MEG-CD-SHRU     OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-2
           THEN
      *---------- 対象取引決定と処理順決定（物）の処理
             PERFORM  SMZJ1810-RTN
      *---------- 4.2.5.2.2ワーク銘柄別断面情報.銘柄種類＝'3'(資金)場合
           ELSE
      *---------- 対象取引決定と処理順決定（資金）の処理
             PERFORM  SMZJ1820-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引決定と処理順決定 処理 "
      D             " END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TG-TRHK-KT-SRJUN-EXT.
           EXIT.
      ******************************************************************
      *    4.2.5.2.1.対象取引決定と処理順決定（物）の処理
      ******************************************************************
       SMZJ1810-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引決定と処理順決定（物）"
      D             "の処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1810-INOUT
                       PARM-RTNPKG
      *---------- 基準日断面情報.処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  TKMZBW02
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 基準日断面情報.起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  TKMZBW02
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  TKMZBW02
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 基準日断面情報.基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG      OF  WK-TKMZBW02
             TO  KH-KAIKEI-BASE-FLG     OF  TKMZBW02
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 銘柄別断面情報:
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 異動計算パターン
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-IDO-CALC-PATTERN-INFO
             TO  RIYO-CMP-CD            OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 異動計算パターンコード
           MOVE  WK-IDO-CALC-PATTERN-CD OF  WK-IDO-CALC-PATTERN-INFO
             TO  IDO-CALC-PATTERN-CD    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-IDO-CALC-PATTERN-INFO
             TO  SIJO-TUKA-CD           OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-IDO-CALC-PATTERN-INFO
             TO  SEC-SBT-CD             OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 保有目的
           MOVE  WK-POSSESSION-OBJECT   OF  WK-IDO-CALC-PATTERN-INFO
             TO  POSSESSION-OBJECT      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 払出簿価計算方法
           MOVE  WK-DEBET-BOKA-CALC-HOU OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-CALC-HOU    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 払出簿価端数（市場通貨）
           MOVE  WK-DEBET-BOKA-HASU-BC  OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-HASU-BC     OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 払出単価桁数（市場通貨）
           MOVE  WK-DEBET-TNK-KETASU-BC OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-KETASU-BC    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 払出単価端数（市場通貨）
           MOVE  WK-DEBET-TNK-HASU-BC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-HASU-BC      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 払出簿価端数（運用通貨）
           MOVE  WK-DEBET-BOKA-HASU-LC  OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-HASU-LC     OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 払出単価桁数（運用通貨）
           MOVE  WK-DEBET-TNK-KETASU-LC OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-KETASU-LC    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 払出単価端数（運用通貨）
           MOVE  WK-DEBET-TNK-HASU-LC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-HASU-LC      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 売り続く限り同一コスト
           MOVE  WK-URI-TUDUKU-SAME-COST
                                        OF  WK-IDO-CALC-PATTERN-INFO
             TO  URI-TUDUKU-SAME-COST   OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 同一日は同一コスト
           MOVE  WK-SAME-YMD-SAME-COST  OF  WK-IDO-CALC-PATTERN-INFO
             TO  SAME-YMD-SAME-COST     OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）１
           MOVE  WK-TEKIYO-SAKI-SYRI1   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI1      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）２
           MOVE  WK-TEKIYO-SAKI-SYRI2   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI2      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）３
           MOVE  WK-TEKIYO-SAKI-SYRI3   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI3      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）４
           MOVE  WK-TEKIYO-SAKI-SYRI4   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI4      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）５
           MOVE  WK-TEKIYO-SAKI-SYRI5   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI5      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）６
           MOVE  WK-TEKIYO-SAKI-SYRI6   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI6      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）７
           MOVE  WK-TEKIYO-SAKI-SYRI7   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI7      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）８
           MOVE  WK-TEKIYO-SAKI-SYRI8   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI8      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（先処理）９
           MOVE  WK-TEKIYO-SAKI-SYRI9   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI9      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）１
           MOVE  WK-TEKIYO-ATO-SYRI1    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI1       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）２
           MOVE  WK-TEKIYO-ATO-SYRI2    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI2       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）３
           MOVE  WK-TEKIYO-ATO-SYRI3    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI3       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）４
           MOVE  WK-TEKIYO-ATO-SYRI4    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI4       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）５
           MOVE  WK-TEKIYO-ATO-SYRI5    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI5       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）６
           MOVE  WK-TEKIYO-ATO-SYRI6    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI6       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）７
           MOVE  WK-TEKIYO-ATO-SYRI7    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI7       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）８
           MOVE  WK-TEKIYO-ATO-SYRI8    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI8       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 適用（後処理）９
           MOVE  WK-TEKIYO-ATO-SYRI9    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI9       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 簿価為替レート適用フラグ
           MOVE  WK-BOKA-KWS-TEKIYO-FLG OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-TEKIYO-FLG    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 簿価為替レート端数
           MOVE  WK-BOKA-KWS-HASU       OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-HASU          OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 簿価為替レート桁数
           MOVE  WK-BOKA-KWS-KETASU     OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-KETASU        OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 新／旧株の区別
           MOVE  WK-NEW-KYU-KABU-KBN    OF  WK-IDO-CALC-PATTERN-INFO
             TO  NEW-KYU-KABU-KBN       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 新／旧簿価計算方法
           MOVE  WK-NEW-KYU-BOKA-CALC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  NEW-KYU-BOKA-CALC      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 按分簿価端数
           MOVE  WK-ANB-BOKA-HASU       OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-BOKA-HASU          OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 按分単価端数
           MOVE  WK-ANB-TNK-HASU        OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-TNK-HASU           OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 按分単価桁数
           MOVE  WK-ANB-TNK-KETASU      OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-TNK-KETASU         OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 前払金償却方法
           MOVE  WK-MAEKIN-SHOUKYK-HOU  OF  WK-IDO-CALC-PATTERN-INFO
             TO  MAEKIN-SHOUKYK-HOU     OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 前払金償却分端数
           MOVE  WK-MAEKIN-SHOUKYK-HASU OF  WK-IDO-CALC-PATTERN-INFO
             TO  MAEKIN-SHOUKYK-HASU    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 増減取引順
           MOVE  WK-ZOUGEN-TORI-JUN     OF  WK-IDO-CALC-PATTERN-INFO
             TO  ZOUGEN-TORI-JUN        OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 増加取引処理順序
           MOVE  WK-GKYK-PLUS-SYRI-JUN  OF  WK-IDO-CALC-PATTERN-INFO
             TO  GKYK-PLUS-SYRI-JUN     OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 減少取引処理順序
           MOVE  WK-GKYK-MINUS-SYRI-JUN OF  WK-IDO-CALC-PATTERN-INFO
             TO  GKYK-MINUS-SYRI-JUN    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 処理順序
           MOVE  WK-SYRI-JUN            OF  WK-IDO-CALC-PATTERN-INFO
             TO  SYRI-JUN               OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 更新日時
           MOVE  WK-UPD-DATE            OF  WK-IDO-CALC-PATTERN-INFO
             TO  UPD-DATE               OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 更新ログインユーザ会社コード
           MOVE  WK-UPD-LOGIN-CMP-CD    OF  WK-IDO-CALC-PATTERN-INFO
             TO  UPD-LOGIN-CMP-CD       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 更新ユーザＩＤ
           MOVE  WK-UPD-SID             OF  WK-IDO-CALC-PATTERN-INFO
             TO  UPD-SID                OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 更新プログラムＩＤ
           MOVE  WK-UPD-PGMID           OF  WK-IDO-CALC-PATTERN-INFO
             TO  UPD-PGMID              OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  SIJO-TUKA-CD           OF  SIJO
                                        OF  PARM-SMZJ1810-ARG1
      *---------- 増減順相対物区分
           MOVE  WK-ZOUGENJYUN-SOTAIBT-KBN
             TO  ZOUGENJYUN-SOTAIBT-KBN OF  PARM-SMZJ1810-ARG1
      *---------- ポートフォリオ属性データエリア
           MOVE  WK-TBL-TKPFZK01-AREA
             TO  TBL-TKPFZK01-1         OF  PARM-SMZJ1810-ARG1
      *---------- 取引属性データエリア
           MOVE  WK-TBL-TKCMTZ00-AREA
             TO  TBL-TKCMTZ00-1         OF  PARM-SMZJ1810-ARG1
      *---------- 異動計算パターンデータエリア
           MOVE  WK-TBL-TKPFPT01-AREA
             TO  TBL-TKPFPT01-1         OF  PARM-SMZJ1810-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW02
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.起動ID=["
      D             KIDOU-ID            OF  TKMZBW02
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  TKMZBW02
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基本会計ベースフラグ=["
      D             KH-KAIKEI-BASE-FLG  OF  TKMZBW02
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日 =["
      D             KAISI-KJN-YMD       OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日 =["
      D             SABON-UPDATE-FROM   OF  TKMZBW03
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン:"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターンコード=["
      D             IDO-CALC-PATTERN-CD OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             SIJO-TUKA-CD        OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":保有目的 =["
      D             POSSESSION-OBJECT   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価計算方法  =["
      D             DEBET-BOKA-CALC-HOU OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（市場通貨） =["
      D             DEBET-BOKA-HASU-BC  OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（市場通貨）=["
      D             DEBET-TNK-KETASU-BC OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（市場通貨）=["
      D             DEBET-TNK-HASU-BC   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（運用通貨）=["
      D             DEBET-BOKA-HASU-LC  OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（運用通貨）=["
      D             DEBET-TNK-KETASU-LC OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（運用通貨）=["
      D             DEBET-TNK-HASU-LC   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限り同一コスト  =["
      D             URI-TUDUKU-SAME-COST OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":同一日は同一コスト =["
      D             SAME-YMD-SAME-COST  OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）１  =["
      D             TEKIYO-SAKI-SYRI1   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）２  =["
      D             TEKIYO-SAKI-SYRI2   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）３  =["
      D             TEKIYO-SAKI-SYRI3   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）４  =["
      D             TEKIYO-SAKI-SYRI4   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）５  =["
      D             TEKIYO-SAKI-SYRI5   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）６  =["
      D             TEKIYO-SAKI-SYRI6   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）７  =["
      D             TEKIYO-SAKI-SYRI7   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）８  =["
      D             TEKIYO-SAKI-SYRI8   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）９  =["
      D             TEKIYO-SAKI-SYRI9   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）９ =["
      D             TEKIYO-ATO-SYRI9    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）８ =["
      D             TEKIYO-ATO-SYRI8    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）７ =["
      D             TEKIYO-ATO-SYRI7    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）６ =["
      D             TEKIYO-ATO-SYRI6    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）５ =["
      D             TEKIYO-ATO-SYRI5    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）４ =["
      D             TEKIYO-ATO-SYRI4    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）３ =["
      D             TEKIYO-ATO-SYRI3    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）２ =["
      D             TEKIYO-ATO-SYRI2    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）１ =["
      D             TEKIYO-ATO-SYRI1    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート適用フラグ =["
      D             BOKA-KWS-TEKIYO-FLG OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート端数 =["
      D             BOKA-KWS-HASU       OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート桁数 =["
      D             BOKA-KWS-KETASU     OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":新／旧株の区別 =["
      D             NEW-KYU-KABU-KBN    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":新／旧簿価計算方法 =["
      D             NEW-KYU-BOKA-CALC   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分簿価端数 =["
      D             ANB-BOKA-HASU       OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分単価端数 =["
      D             ANB-TNK-HASU        OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分単価桁数 =["
      D             ANB-TNK-KETASU      OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前払金償却方法 =["
      D             MAEKIN-SHOUKYK-HOU  OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前払金償却分端数 =["
      D             MAEKIN-SHOUKYK-HASU OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":増減取引順 =["
      D             ZOUGEN-TORI-JUN     OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":増加取引処理順序 =["
      D             GKYK-PLUS-SYRI-JUN  OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":減少取引処理順序 =["
      D             GKYK-MINUS-SYRI-JUN OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理順序 =["
      D             SYRI-JUN            OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":更新日時 =["
      D             UPD-DATE            OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード =["
      D             UPD-LOGIN-CMP-CD    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ =["
      D             UPD-SID             OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ =["
      D             UPD-PGMID           OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             SIJO-TUKA-CD        OF  SIJO
      D                                 OF  PARM-SMZJ1810-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":増減順相対物区分 =["
      D             ZOUGENJYUN-SOTAIBT-KBN  OF  PARM-SMZJ1810-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":ポートフォリオ属性データエリア =["
      *             TBL-TKPFZK01-1      OF  PARM-SMZJ1810-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":取引属性データエリア =["
      *             TBL-TKCMTZ00-1      OF  PARM-SMZJ1810-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":異動計算パターンデータエリア =["
      *             TBL-TKPFPT01-1      OF  PARM-SMZJ1810-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1810"             USING  PARM-SMZJ1810-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1810)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- 識別子
             MOVE  CNS-TKMXTR00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(1)
      *---------- 対象処理
             MOVE  CNS-SELECT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(1)
      *---------- 処理件数
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(1)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(1)
                   +  TRHK-SELECT-KENSU OF  PARM-SMZJ1810-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(1)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(1)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(1)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(1)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(1)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(1)"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1810.ARG2.警告フラグ(1) =["
      D             WARN-FLG-1          OF  PARM-SMZJ1810-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1810.ARG2.警告フラグ(2) =["
      D             WARN-FLG-2          OF  PARM-SMZJ1810-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1810.ARG2.警告フラグ(3) =["
      D             WARN-FLG-3          OF  PARM-SMZJ1810-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1810.ARG2.警告フラグ(4) =["
      D             WARN-FLG-4          OF  PARM-SMZJ1810-ARG2"]"
      *-----------------------------------------------------------------
      *---------- @ SMZJ1810.ARG2.警告フラグ(1)＝0
             IF  WARN-FLG-1             OF  PARM-SMZJ1810-ARG2
              =  CNS-WANR-FLG-0
             THEN
               CONTINUE
             ELSE
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M39のメッセージID
               MOVE  CNS-MSG-E000611
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '約定レートあり決済未入力データ'
               MOVE  CNS-TK-MOJI-9
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M2-FREE-AREA-RTN
             END-IF
      *---------- A SMZJ1810.ARG2.警告フラグ(2)＝0 且つ SMZJ1810.ARG2.警告フラグ(3)＝0
             IF  WARN-FLG-2             OF  PARM-SMZJ1810-ARG2
              =  CNS-WANR-FLG-0
             AND WARN-FLG-3             OF  PARM-SMZJ1810-ARG2
              =  CNS-WANR-FLG-0
             THEN
               CONTINUE
             ELSE
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M13のメッセージID
               MOVE  CNS-MSG-E000612
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '約定レート未入力データ'
               MOVE  CNS-TK-MOJI-10
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M2-FREE-AREA-RTN
             END-IF
      *---------- 【SMZJ1810】.ARG2.警告フラグ(1)≠0 or
      *---------- 【SMZJ1810】.ARG2.警告フラグ(2)≠0 or
      *---------- 【SMZJ1810】.ARG2.警告フラグ(3)≠0の場合
             IF  WARN-FLG-1 OF PARM-SMZJ1810-ARG2  NOT = CNS-WANR-FLG-0
              OR WARN-FLG-2 OF PARM-SMZJ1810-ARG2  NOT = CNS-WANR-FLG-0
              OR WARN-FLG-3 OF PARM-SMZJ1810-ARG2  NOT = CNS-WANR-FLG-0
             THEN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
               IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-270
               THEN
                 MOVE  CNS-MT-JS-270        TO  WK-MT-JIKKOU-STATUS
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT4
               THEN
                 MOVE  CNS-RTN-BT4          TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D    "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '270'(業務エラー(続行可能))
               IF  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02 < CNS-MT-JS-270
               THEN
                 MOVE  CNS-MT-JS-270
                   TO  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D    "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           ELSE
      *---------- ◇リターンコード＝'110'(データなし)の場合
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-110
             THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M08のメッセージID
               MOVE  CNS-MSG-E000429
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← 'ポートフォリオの対象履歴'
               MOVE  CNS-TK-MOJI-71
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  LC-FREE-MSG-2-RTN
               MOVE  CNS-1              TO  FLG-TORI-UPD
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-079          TO  WK-ERR-POS
               PERFORM  ERR-MSG-1-RTN
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引決定と処理順決定（物）"
      D             "の処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1810-EXT.
           EXIT.
      ******************************************************************
      *    4.2.5.2.2.対象取引決定と処理順決定（資金）の処理
      ******************************************************************
       SMZJ1820-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引決定と処理順決定（資金）"
      D             "の処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1820-INOUT
                       PARM-RTNPKG
      *---------- 銘柄別断面情報:
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日断面情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  TKMZBW02
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日断面情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  TKMZBW02
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日断面情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  TKMZBW02
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日断面情報.基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  TKMZBW02
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日断面情報.基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG      OF  WK-TKMZBW02
             TO  KH-KAIKEI-BASE-FLG     OF  TKMZBW02
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  TKMZBW02
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 基準日断面情報.仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD      OF  WK-TKMZBW02
             TO  SWK-KJN-PTN-CD         OF  TKMZBW02
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 異動計算パターン
      *---------- 適用（先処理）１
           MOVE  WK-TEKIYO-SAKI-SYRI1   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI1      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）２
           MOVE  WK-TEKIYO-SAKI-SYRI2   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI2      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）３
           MOVE  WK-TEKIYO-SAKI-SYRI3   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI3      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）４
           MOVE  WK-TEKIYO-SAKI-SYRI4   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI4      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）５
           MOVE  WK-TEKIYO-SAKI-SYRI5   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI5      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）６
           MOVE  WK-TEKIYO-SAKI-SYRI6   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI6      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）７
           MOVE  WK-TEKIYO-SAKI-SYRI7   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI7      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）８
           MOVE  WK-TEKIYO-SAKI-SYRI8   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI8      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（先処理）９
           MOVE  WK-TEKIYO-SAKI-SYRI9   OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-SAKI-SYRI9      OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）９
           MOVE  WK-TEKIYO-ATO-SYRI9    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI9       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）８
           MOVE  WK-TEKIYO-ATO-SYRI8    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI8       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）７
           MOVE  WK-TEKIYO-ATO-SYRI7    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI7       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）６
           MOVE  WK-TEKIYO-ATO-SYRI6    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI6       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）５
           MOVE  WK-TEKIYO-ATO-SYRI5    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI5       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）４
           MOVE  WK-TEKIYO-ATO-SYRI4    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI4       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）３
           MOVE  WK-TEKIYO-ATO-SYRI3    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI3       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）２
           MOVE  WK-TEKIYO-ATO-SYRI2    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI2       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 適用（後処理）１
           MOVE  WK-TEKIYO-ATO-SYRI1    OF  WK-IDO-CALC-PATTERN-INFO
             TO  TEKIYO-ATO-SYRI1       OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 増減取引順
           MOVE  WK-ZOUGEN-TORI-JUN     OF  WK-IDO-CALC-PATTERN-INFO
             TO  ZOUGEN-TORI-JUN        OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 増加取引処理順序
           MOVE  WK-GKYK-PLUS-SYRI-JUN  OF  WK-IDO-CALC-PATTERN-INFO
             TO  GKYK-PLUS-SYRI-JUN     OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 減少取引処理順序
           MOVE  WK-GKYK-MINUS-SYRI-JUN OF  WK-IDO-CALC-PATTERN-INFO
             TO  GKYK-MINUS-SYRI-JUN    OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *---------- 処理順序
           MOVE  WK-SYRI-JUN            OF  WK-IDO-CALC-PATTERN-INFO
             TO  SYRI-JUN               OF  IDO-CALC-PATTERN
                                        OF  PARM-SMZJ1820-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日 =["
      D             KAISI-KJN-YMD       OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日 =["
      D             SABON-UPDATE-FROM   OF  TKMZBW03
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.利用会社コード  = ["
      D             RIYO-CMP-CD         OF  TKMZBW02
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.ファンドコード  = ["
      D             FUND-CD             OF  TKMZBW02
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D                      ":基準日断面情報.ポートフォリオコード  = ["
      D             PTF-CD              OF  TKMZBW02
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基準日  = ["
      D             KJN-YMD             OF  TKMZBW02
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D                      ":基準日断面情報.基本会計ベースフラグ  = ["
      D             KH-KAIKEI-BASE-FLG  OF  TKMZBW02
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日  = ["
      D             KAISI-KJN-YMD-NEXT  OF  TKMZBW02
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID
      D                    ":基準日断面情報.仕訳基準パターンコード  = ["
      D             SWK-KJN-PTN-CD      OF  TKMZBW02
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン:"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）１  =["
      D             TEKIYO-SAKI-SYRI1   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）２  =["
      D             TEKIYO-SAKI-SYRI2   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）３  =["
      D             TEKIYO-SAKI-SYRI3   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）４  =["
      D             TEKIYO-SAKI-SYRI4   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）５  =["
      D             TEKIYO-SAKI-SYRI5   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）６  =["
      D             TEKIYO-SAKI-SYRI6   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）７  =["
      D             TEKIYO-SAKI-SYRI7   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）８  =["
      D             TEKIYO-SAKI-SYRI8   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（先処理）９  =["
      D             TEKIYO-SAKI-SYRI9   OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）９ =["
      D             TEKIYO-ATO-SYRI9    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）８ =["
      D             TEKIYO-ATO-SYRI8    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）７ =["
      D             TEKIYO-ATO-SYRI7    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）６ =["
      D             TEKIYO-ATO-SYRI6    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）５ =["
      D             TEKIYO-ATO-SYRI5    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）４ =["
      D             TEKIYO-ATO-SYRI4    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）３ =["
      D             TEKIYO-ATO-SYRI3    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）２ =["
      D             TEKIYO-ATO-SYRI2    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":適用（後処理）１ =["
      D             TEKIYO-ATO-SYRI1    OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":増減取引順 =["
      D             ZOUGEN-TORI-JUN     OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":増加取引処理順序 =["
      D             GKYK-PLUS-SYRI-JUN  OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":減少取引処理順序 =["
      D             GKYK-MINUS-SYRI-JUN OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理順序 =["
      D             SYRI-JUN            OF  IDO-CALC-PATTERN
      D                                 OF  PARM-SMZJ1820-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1820"             USING  PARM-SMZJ1820-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1820)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- 識別子
             MOVE  CNS-TKMXST00
               TO  WK-IDENT-ID          OF  WK-SCZY7040-ARG2(2)
      *---------- 対象処理
             MOVE  CNS-SELECT
               TO  WK-OBJECT-DISPOSAL   OF  WK-SCZY7040-ARG2(2)
      *---------- 処理件数
             COMPUTE  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(2)
                   =  WK-DISPOSAL-NUM   OF  WK-SCZY7040-ARG2(2)
                   +  SIKIN-TORI-SELECT-KENSU
                                        OF  PARM-SMZJ1820-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(2)."
      D      "識別子=["WK-IDENT-ID      OF  WK-SCZY7040-ARG2(2)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(2)."
      D    "対象処理=["WK-OBJECT-DISPOSAL
      D                                 OF  WK-SCZY7040-ARG2(2)"]"
      D    DISPLAY  CNS-PGM-ID":SCZC7040.ARG2.テーブル.ファイル情報(2)."
      D    "処理件数=["WK-DISPOSAL-NUM  OF  WK-SCZY7040-ARG2(2)"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-080          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引決定と処理順決定（資金）"
      D             "の処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1820-EXT.
           EXIT.
      ******************************************************************
      *    4.2.6.LC未収収益計算処理
      ******************************************************************
       LC-MS-CALC-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** LC未収収益計算処理  START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類２ =["
      D             WK-MEG-CD-SHRU2     OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得フラグ      =["
      D             FLG-MEG-ZOK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性情報.利付／割引区分=["
      D             WK-RITUKI-WARI-KBN OF WK-MEG-ZOK-INFO"]"
      *-----------------------------------------------------------------
      *---------- ワーク銘柄別断面情報.銘柄種類＝'1'(物)
           IF  WK-MEG-CD-SHRU           OF  WK-TKMZBW03
            =  CNS-MEG-CD-SHRU-1
           THEN
      *---------- ワーク銘柄別断面情報.銘柄種類２＝'1'(株)
             EVALUATE  WK-MEG-CD-SHRU2  OF  WK-TKMZBW03
               WHEN  CNS-MEG-CD-SHRU-1
                 IF  FLG-MEG-ZOK  =  CNS-MEG-ZOK-1
                 THEN
      *---------- 1）4.2.6.1.【SMZJ2110】未収配当計算処理処理ルーチン
                   PERFORM  SMZJ2110-RTN
                 ELSE
                   CONTINUE
                 END-IF
      *---------- ワーク銘柄別断面情報.銘柄種類２＝'2'(債券)
               WHEN  CNS-MEG-CD-SHRU-2
                 IF  FLG-MEG-ZOK  =  CNS-MEG-ZOK-1
                 AND WK-RITUKI-WARI-KBN OF WK-MEG-ZOK-INFO NOT = CNS-C2
                 AND WK-0-CUPON-FLG NOT  =  CNS-1
                 THEN
      *---------- 1）4.2.7.2.【SMZJ2211】跨ぎ前払金異動額集計処理
                   PERFORM  SMZJ2211-RTN
      *---------- 2）4.2.7.2.【SMZJ2120】債券過去経過利息計算ルーチン
                   PERFORM  SMZJ2120-RTN
                 ELSE
                   CONTINUE
                 END-IF
      *---------- ワーク銘柄別断面情報.銘柄種類２＝'3'(その他)
               WHEN  OTHER
      *---------- 1)その他処理パターン決定
                 PERFORM  SET-ELSO-PTN-RTN
      *---------- 2)4.2.7.3【SMZJ2130】その他未収収益計算ルーチン
                 IF  (WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-CASH
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MAR
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MABF
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MABO
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MAB
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MAFB
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MASF
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MASO
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MAS
                  AND WK-SEC-SBT-CD  OF  WK-TKMZBW03  NOT=  CNS-X-MAFS)
                 THEN
                   PERFORM  SMZJ2130-RTN
                 ELSE
                   CONTINUE
                 END-IF
             END-EVALUATE
           ELSE
             CONTINUE
           END-IF
      *---------- 4.2.7.4 ワーク銘柄別断面情報.銘柄種類＝'3'(資金)
           IF  WK-MEG-CD-SHRU           OF  WK-TKMZBW03
            =  CNS-MEG-CD-SHRU-3
           THEN
      *---------- 資金の未収収益計算を行う
             PERFORM  SMZJ2140-RTN
           ELSE
             CONTINUE
           END-IF
      *---------- 4.2.7.5 ワーク銘柄別断面情報.銘柄種類＝'1'(物)、'3'(資金)の場合
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
           IF  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
            =  CNS-MEG-CD-SHRU-1  OR
               WK-MEG-CD-SHRU         OF  WK-TKMZBW03
            =  CNS-MEG-CD-SHRU-3
           THEN
      *---------- 4.2.7.5.【SMZJ2150】未収収益計上計算ルーチン
             PERFORM  SMZJ2150-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  LC未収収益計算処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       LC-MS-CALC-EXT.
           EXIT.
      ******************************************************************
      *    1)その他処理パターン決定
      ******************************************************************
       SET-ELSO-PTN-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  その他処理パターン決定  START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.証券種別コード =["
      D                               WK-SEC-SBT-CD  OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
           EVALUATE  WK-SEC-SBT-CD  OF  WK-TKMZBW03
             WHEN  CNS-X-NCD
             WHEN  CNS-X-XMOC
      *      WHEN  CNS-X-FDAL
      *---------- 利払日型
               MOVE  CNS-1              TO  WK-ELS0-PTN
             WHEN  CNS-X-GEN
             WHEN  CNS-X-GNS
      *---------- スタートエンド型(現先)
               MOVE  CNS-2              TO  WK-ELS0-PTN
             WHEN  CNS-X-CALL
             WHEN  CNS-X-DA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引存在フラグ =["
      D                                          WK-TRHK-SONZAI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動.短期スタート日 =["
      D                          SHORT-START-YMD  OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動.短期エンド日 =["
      D                          SHORT-END-YMD    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報."
      D       "短期スタート日 =["SHORT-START-YMD  OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報.短期エンド日=["
      D                          SHORT-END-YMD    OF  WK-TKMZZR00"]"
      *-----------------------------------------------------------------
               IF  (WK-TRHK-SONZAI-FLG  =  CNS-KJ-DMN-1
                 AND  SHORT-START-YMD  OF  WK-TZ-ZN-IDO  NOT  =  ZERO
                 AND  SHORT-END-YMD    OF  WK-TZ-ZN-IDO  NOT  =  ZERO)
                OR (WK-TRHK-SONZAI-FLG  =  CNS-KJ-DMN-0
                 AND  SHORT-START-YMD  OF  WK-TKMZZR00  NOT  =  ZERO
                 AND  SHORT-END-YMD    OF  WK-TKMZZR00  NOT  =  ZERO)
               THEN
                 MOVE  CNS-3            TO  WK-ELS0-PTN
               ELSE
                 MOVE  CNS-1            TO  WK-ELS0-PTN
               END-IF
             WHEN  OTHER
               CONTINUE
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークその他処理パターン =["
      D                                                WK-ELS0-PTN"]"
      D    DISPLAY  CNS-PGM-ID":***  その他処理パターン決定  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SET-ELSO-PTN-EXT.
           EXIT.
      ******************************************************************
      *    4.2.6.1.未収配当計算処理
      ******************************************************************
       SMZJ2110-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  未収配当計算 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2110-INOUT
                       PARM-RTNPKG
      *---------- 銘柄別断面情報:
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  SIJO-TUKA-CD           OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 基準日断面情報.料率パターンコード
           MOVE  WK-COMMISSION-PATTERN  OF  WK-TKMZBW02
             TO  COMMISSION-PATTERN     OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 基準日断面情報.未収配当計上割合
           MOVE  WK-MISYU-HAITOU-WARIAI OF  WK-TKMZBW02
             TO  MISYU-HAITOU-WARIAI    OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 各属性データ.現地源泉税課税区分 ← ワーク銘柄属性情報.現地源泉税非課税区分
           MOVE  WK-G-GSZ-NOTAX-KBN     OF  WK-MEG-ZOK-INFO
             TO  G-GSZ-KAZEI-KBN        OF  ZOK-DATA-PARM
                                        OF  PARM-SMZJ2110-ARG1
      *---------- 投資対象国コード
           MOVE  WK-TSTSK-CD            OF  WK-MEG-CD-REF
             TO  TSTSK-CD               OF  PARM-SMZJ2110-ARG1
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始基準日断面存在フラグ =["
      D             WK-KKY-DMN-SONZAI-FLG"]"
      *-----------------------------------------------------------------
      *---------- 数量単位
           IF  WK-KKY-DMN-SONZAI-FLG  =  CNS-KJ-DMN-1
           THEN
             MOVE  SURYO-TANI           OF  WK-TKMZZR00
               TO  SURYO-TANI           OF  PARM-SMZJ2110-ARG1
           ELSE
             MOVE  SURYO-TANI           OF  WK-TZ-ZN-IDO
               TO  SURYO-TANI           OF  PARM-SMZJ2110-ARG1
           END-IF
      *----------  料率データエリア
           MOVE  WK-TBL-TKCMRY00-AREA
             TO  RYORITU-DATA-AREA      OF  PARM-SMZJ2110-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             SIJO-TUKA-CD        OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.料率パターンコード =["
      D             COMMISSION-PATTERN  OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.未収配当計上割合 =["
      D             MISYU-HAITOU-WARIAI OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理 =["
      D             TUKA-DEF-HASU-SYRI-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":各属性データ.現地源泉税課税区分 =["
      D             G-GSZ-KAZEI-KBN     OF  ZOK-DATA-PARM
      D                                 OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード =["
      D             TSTSK-CD            OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":数量単位 =["
      D             SURYO-TANI          OF  PARM-SMZJ2110-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":料率データエリア =["
      D             RYORITU-DATA-AREA   OF  PARM-SMZJ2110-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2110"             USING  PARM-SMZJ2110-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2110)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               MOVE  CNS-1              TO  WK-KEISAN-FLG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収配当計算コールフラグ =["
      D                                                WK-KEISAN-FLG1"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-110
               MOVE  CNS-1              TO  WK-KEISAN-FLG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":未収配当計算コールフラグ =["
      D                                                WK-KEISAN-FLG1"]"
      D    DISPLAY  CNS-PGM-ID":ARG2.ワークエラー区分    =["
      D             WORK-ERR-KBN        OF  PARM-SMZJ2110-ARG2"]"
      *-----------------------------------------------------------------
               IF  WORK-ERR-KBN  OF  PARM-SMZJ2110-ARG2 = CNS-ERR-KBN-03
               THEN
                 CONTINUE
               ELSE
                 EVALUATE  WORK-ERR-KBN OF  PARM-SMZJ2110-ARG2
                   WHEN  CNS-ERR-KBN-01
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '変更日の対象未収収益'
                     MOVE  CNS-TK-MOJI-49
                       TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,1)
                   WHEN  CNS-ERR-KBN-02
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '対応取引'
                     MOVE  CNS-TK-MOJI-50
                       TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,1)
                   WHEN  CNS-ERR-KBN-04
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '権利落日の対象配当情報'
                     MOVE  CNS-TK-MOJI-52
                       TO  WK-TK-MOJI   OF  WK-MSG-AREA(WK-CounterA,1)
                   WHEN  OTHER
                     CONTINUE
                 END-EVALUATE
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M35のメッセージID
                 MOVE  CNS-MSG-W000510
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
                 PERFORM  LC-FREE-MSG-1-RTN
               END-IF
             WHEN  CNS-RTN-002
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M10のメッセージID
               MOVE  CNS-MSG-E000445
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←'配当情報'
               MOVE  CNS-TK-MOJI-53
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←'500'
               MOVE  CNS-TK-MOJI-54
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,2)
               PERFORM  LC-FR-MSG-1-RTN
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-081        TO  WK-ERR-POS
               PERFORM  ERR-MSG-4-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  未収配当計算処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ2110-EXT.
           EXIT.
      ******************************************************************
      *    4.2.6.2.債券過去経過利息計算
      ******************************************************************
       SMZJ2120-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  債券過去経過利息計算  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2120-INOUT
                       PARM-RTNPKG
      *---------- 銘柄別断面情報:
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 初期利払起算日
           MOVE  WK-SHOKI-RB-KS-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-KS-YMD     OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 初期利払日
           MOVE  WK-SHOKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-YMD        OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 最終利払起算日
           MOVE  WK-LAST-RB-KS-YMD      OF  WK-MEG-ZOK-INFO
             TO  LAST-RIBAR-KISAN-YMD   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 終期利払日
           MOVE  WK-SHUKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RIBAR-YMD        OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 利払回数
           MOVE  WK-RIBAR-KAISU         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-KAISU            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 利払日１
           MOVE  WK-RIBAR-YMD-1         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-1            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 利払日２
           MOVE  WK-RIBAR-YMD-2         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-2            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 利払日３
           MOVE  WK-RIBAR-YMD-3         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-3            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 利払日４
           MOVE  WK-RIBAR-YMD-4         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-4            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- ファクター・連動係数
           MOVE  WK-FT-RENDOU-KESU      OF  WK-MEG-ZOK-INFO
             TO  FACTOR-RENDOU-KESU     OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2120-ARG1
      *---------- 利払日休日処理区分
           MOVE  WK-RIBAR-YMD-QJT-SR-KBN      OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-QJT-SR-KBN         OF  MEG-ZOKUSEI-DATA-PARM
                                              OF  PARM-SMZJ2120-ARG1
      *---------- 初期利払日休日処理区分
           MOVE  WK-SHOKI-RB-YMD-QJT-KBN      OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RB-YMD-QJT-KBN         OF  MEG-ZOKUSEI-DATA-PARM
                                              OF  PARM-SMZJ2120-ARG1
      *---------- 終期利払日休日処理区分
           MOVE  WK-SHUKI-RB-YMD-QJT-KBN      OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RB-YMD-QJT-KBN         OF  MEG-ZOKUSEI-DATA-PARM
                                              OF  PARM-SMZJ2120-ARG1
      *---------- 固定変動区分
           MOVE  WK-FIX-VRBL-KBN              OF  WK-MEG-ZOK-INFO
             TO  FIX-VRBL-KBN                 OF  MEG-ZOKUSEI-DATA-PARM
                                              OF  PARM-SMZJ2120-ARG1
      *---------- 連動係数参照区分
           MOVE  WK-RENKSU-REF-KBN            OF  WK-MEG-ZOK-INFO
             TO  RENKSU-REF-KBN               OF  MEG-ZOKUSEI-DATA-PARM
                                              OF  PARM-SMZJ2120-ARG1
      *---------- 開始時残高数量残高（利付） ← ワーク開始時残高履歴情報.数量残高（利付）
           MOVE  SRYZN-RIT              OF  WK-TKMZZR00
             TO  KAISIZN-SRYZN-RIT      OF  PARM-SMZJ2120-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  SIJO-TUKA-CD           OF  PARM-SMZJ2120-ARG1
      *---------- 管理数量単位
           MOVE  WK-KANRI-SURYO-TANI
             TO  KANRI-SURYO-TANI       OF  PARM-SMZJ2120-ARG1
      *---------- 料率パターンコード
           MOVE  WK-COMMISSION-PATTERN  OF  WK-TKMZBW02
             TO  COMMISSION-PATTERN     OF  PARM-SMZJ2120-ARG1
      *---------- 約定ベース受渡順フラグ
           MOVE  WK-YKJ-UKE-JUN-FLG
             TO  YKJ-UKE-JUN-FLG        OF  PARM-SMZJ2120-ARG1
      *---------- 跨ぎ異動数量（利付）集計
           MOVE  MATAGI-IDO-SURYO-RIT   OF  PARM-SMZJ2211-ARG2
             TO  MTGI-IDO-SURYO-SHUKE   OF  PARM-SMZJ2120-ARG1
      *---------- 利払日数
           MOVE  WK-RIBAR-NISU          OF  WK-MEG-ZOK-INFO
             TO  KEKA-NISU              OF  MEG-SKJO-DATA-3
                                        OF  PARM-SMZJ2120-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日 =["
      D             KAISI-KJN-YMD       OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日=["
      D             SABON-UPDATE-FROM   OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理 =["
      D             TUKA-DEF-HASU-SYRI-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払起算日=["
      D             SHOKI-RIBAR-KS-YMD  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日 =["
      D             SHOKI-RIBAR-YMD     OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":最終利払起算日=["
      D             LAST-RIBAR-KISAN-YMD OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日=["
      D             SHUKI-RIBAR-YMD     OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払回数 =["
      D             RIBAR-KAISU         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日１ =["
      D             RIBAR-YMD-1         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日２=["
      D             RIBAR-YMD-2         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日３ =["
      D             RIBAR-YMD-3         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日４ =["
      D             RIBAR-YMD-4         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファクター・連動係数=["
      D             FACTOR-RENDOU-KESU  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日休日処理区分=["
      D             RIBAR-YMD-QJT-SR-KBN  OF  MEG-ZOKUSEI-DATA-PARM
      D                                   OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日休日処理区分=["
      D             SHOKI-RB-YMD-QJT-KBN  OF  MEG-ZOKUSEI-DATA-PARM
      D                                   OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日休日処理区分=["
      D             SHUKI-RB-YMD-QJT-KBN  OF  MEG-ZOKUSEI-DATA-PARM
      D                                   OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":固定変動区分=["
      D             FIX-VRBL-KBN          OF  MEG-ZOKUSEI-DATA-PARM
      D                                   OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":連動係数参照区分=["
      D             RENKSU-REF-KBN        OF  MEG-ZOKUSEI-DATA-PARM
      D                                   OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高数量残高（利付）=["
      D             KAISIZN-SRYZN-RIT   OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             SIJO-TUKA-CD        OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理数量単位 =["
      D             KANRI-SURYO-TANI    OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":料率パターンコード =["
      D             COMMISSION-PATTERN  OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ =["
      D             YKJ-UKE-JUN-FLG     OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":跨ぎ異動数量（利付）集計 =["
      D             MTGI-IDO-SURYO-SHUKE OF  PARM-SMZJ2120-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日数 =["
      D             KEKA-NISU             OF  MEG-SKJO-DATA-3
      D                                   OF  PARM-SMZJ2120-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2120"             USING  PARM-SMZJ2120-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ユーザ入力データあるフラグ=["
      D             USER-IN-FLG         OF  PARM-SMZJ2120-ARG2"]"
      *-----------------------------------------------------------------
           IF  USER-IN-FLG              OF  PARM-SMZJ2120-ARG2
            =  CNS-USER-IN-FLG
           THEN
      *----------  【SMZJ2211】.ARG2.跨ぎ市場通貨前払金異動額集計 ← 0
             MOVE  ZERO
               TO  MATAGI-SJTK-PPAYIDOG OF  PARM-SMZJ2211-ARG2
      *----------  【SMZJ2211】.ARG2.跨ぎ運用通貨前払金異動額集計 ← 0
             MOVE  ZERO
               TO  MATAGI-UYTK-PPAYIDOG OF  PARM-SMZJ2211-ARG2
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":跨ぎ市場通貨前払金異動額集計=["
      D             MATAGI-SJTK-PPAYIDOG OF  PARM-SMZJ2211-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":跨ぎ運用通貨前払金異動額集計=["
      D             MATAGI-UYTK-PPAYIDOG OF  PARM-SMZJ2211-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2120)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
             WHEN  CNS-RTN-113
      *----------  市場通貨経過利息
               MOVE  SJTK-KEKA-RSK      OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-SJTK-KEKA-RSK   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  運用通貨経過利息
               MOVE  UYTK-KEKA-RSK      OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-UYTK-KEKA-RSK   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  市場通貨源泉税
               MOVE  SJTK-GENSEN-TAX    OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-SJTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  運用通貨源泉税
               MOVE  UYTK-GENSEN-TAX    OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-UYTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  評価為替レート
               MOVE  HYK-KWS            OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-HYK-KWS         OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  源泉税評価為替レート
               MOVE  GENS-TAX-HYK-KWS   OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-GENS-TAX-HYK-KWS  OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  ファクター・連動係数
               MOVE  FACTOR-RENDOU-KESU OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-FT-RENDOU-KESU  OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- 債券過去経過利息計算コールフラグ
               MOVE  CNS-1              TO  WK-KEISAN-FLG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨経過利息 =["
      D             WK-SJTK-KEKA-RSK    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨経過利息 =["
      D             WK-UYTK-KEKA-RSK    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税   =["
      D             WK-SJTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税   =["
      D             WK-UYTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":評価為替レート   =["
      D             WK-HYK-KWS          OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":源泉税評価為替レート =["
      D             WK-GENS-TAX-HYK-KWS OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ファクター・連動係数 =["
      D             WK-FT-RENDOU-KESU   OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":債券過去経過利息計算コールフラグ =["
      D                                                WK-KEISAN-FLG2"]"
      *-----------------------------------------------------------------
             WHEN  CNS-RTN-110
      *----------  市場通貨経過利息
               MOVE  SJTK-KEKA-RSK      OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-SJTK-KEKA-RSK   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  運用通貨経過利息
               MOVE  UYTK-KEKA-RSK      OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-UYTK-KEKA-RSK   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  市場通貨源泉税
               MOVE  SJTK-GENSEN-TAX    OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-SJTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  運用通貨源泉税
               MOVE  UYTK-GENSEN-TAX    OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-UYTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  評価為替レート
               MOVE  HYK-KWS            OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-HYK-KWS         OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  源泉税評価為替レート
               MOVE  GENS-TAX-HYK-KWS   OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-GENS-TAX-HYK-KWS  OF  WK-KJN-YMD-KEKA-RSK-DATA
      *----------  ファクター・連動係数
               MOVE  FACTOR-RENDOU-KESU OF  KJY-KEKA-RSK-PARM
                                        OF  PARM-SMZJ2120-ARG2
                 TO  WK-FT-RENDOU-KESU  OF  WK-KJN-YMD-KEKA-RSK-DATA
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":市場通貨経過利息 =["
      D             WK-SJTK-KEKA-RSK    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨経過利息 =["
      D             WK-UYTK-KEKA-RSK    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税   =["
      D             WK-SJTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税   =["
      D             WK-UYTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":評価為替レート   =["
      D             WK-HYK-KWS          OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":源泉税評価為替レート =["
      D             WK-GENS-TAX-HYK-KWS OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ファクター・連動係数 =["
      D             WK-FT-RENDOU-KESU   OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      *-----------------------------------------------------------------
      *---------- 債券過去経過利息計算コールフラグ
               MOVE  CNS-1              TO  WK-KEISAN-FLG2
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M35のメッセージID
               MOVE  CNS-MSG-W000510
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '対応取引'
               MOVE  CNS-TK-MOJI-50
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  LC-FREE-MSG-1-RTN
             WHEN  CNS-RTN-112
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M24のメッセージID
               MOVE  CNS-MSG-E000526
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
                 STRING   CNS-MSG-13,  WK-KJN-YMD     OF  WK-TKMZBW03,
                          CNS-MSG-1,   WK-SEC-SBT-CD  OF  WK-TKMZBW03,
                          CNS-MSG-2,   WK-MEG-TUKA-CD OF  WK-MEG-CD-REF,
                          CNS-MSG-3,
                                 WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                          CNS-MSG-4,     WK-TSTSK-CD  OF  WK-MEG-CD-REF,
                          CNS-MSG-6,         WK-KAYI  OF  WK-MEG-CD-REF,
                          CNS-MSG-7,         WK-GOU   OF  WK-MEG-CD-REF,
                          CNS-MSG-25,   WK-TATE-FLG   OF  WK-TKMZBW03,
                          CNS-MSG-26,   WK-GYOKU-ID   OF  WK-TKMZBW03,
                          CNS-MSG-37
                                          DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG        OF  WK-MSG-AREA(WK-CounterA)
               PERFORM  M24-FREE-AREA-RTN
             WHEN  CNS-RTN-114
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M25のメッセージID
               MOVE  CNS-MSG-E000525
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ストライクプライス
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
                 STRING  CNS-MSG-13,  WK-KJN-YMD      OF  WK-TKMZBW03,
                         CNS-MSG-1,   WK-SEC-SBT-CD   OF  WK-MEG-CD-REF,
                         CNS-MSG-2,   WK-MEG-TUKA-CD  OF  WK-MEG-CD-REF,
                         CNS-MSG-47,
                               WK-HAKKO-TAI-KUNI-CD   OF  WK-MEG-CD-REF,
                         CNS-MSG-48,  WK-TSTSK-CD     OF  WK-MEG-CD-REF,
                         CNS-MSG-19,  WK-KABU-SBT     OF  WK-MEG-CD-REF,
                         CNS-MSG-50,  WK-KAYI         OF  WK-MEG-CD-REF,
                         CNS-MSG-50,  WK-GOU          OF  WK-MEG-CD-REF,
                         CNS-MSG-50,  WK-GENGETSU     OF  WK-MEG-CD-REF,
                         CNS-MSG-50,  WK-STRIKEPRICE-X,
                         CNS-MSG-50,  WK-MNK-YMD      OF  WK-MEG-CD-REF,
                         CNS-MSG-51,  WK-TATE-FLG     OF  WK-TKMZBW03,
                         CNS-MSG-52,  WK-GYOKU-ID     OF  WK-TKMZBW03,
                         CNS-MSG-56
                 DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-MSG-AREA(WK-CounterA)
               PERFORM  M24-FREE-AREA-RTN
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-082        TO  WK-ERR-POS
               PERFORM  ERR-MSG-4-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  債券過去経過利息計算  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ2120-EXT.
           EXIT.
      ******************************************************************
      *    4.2.6.3.その他未収収益計算
      ******************************************************************
       SMZJ2130-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  その他未収収益計算 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2130-INOUT
                       PARM-RTNPKG
      *---------- 銘柄別断面情報:
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 銘柄種類
           MOVE  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
             TO  MEG-CD-SHRU            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  SJO-TKA-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 銘柄属性データ
      *---------- 初期利払起算日
           MOVE  WK-SET-YMD             OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-KS-YMD     OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 初期利払日
           MOVE  WK-SET-YMD             OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-YMD        OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 最終利払起算日
           MOVE  WK-LAST-RB-KS-YMD      OF  WK-MEG-ZOK-INFO
             TO  LAST-RIBAR-KISAN-YMD   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 終期利払日
           MOVE  WK-SHUKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RIBAR-YMD        OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 利払回数
           MOVE  WK-RIBAR-KAISU         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-KAISU            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 利払日１
           MOVE  WK-RIBAR-YMD-1         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-1            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 利払日２
           MOVE  WK-RIBAR-YMD-2         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-2            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 利払日３
           MOVE  WK-RIBAR-YMD-3         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-3            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 利払日４
           MOVE  WK-RIBAR-YMD-4         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-4            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 利払日休日処理区分
           MOVE  WK-RIBAR-YMD-QJT-SR-KBN OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-QJT-SR-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 初期利払日休日処理区分
           MOVE  WK-SHOKI-RB-YMD-QJT-KBN OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 終期利払日休日処理区分
           MOVE  WK-SHUKI-RB-YMD-QJT-KBN OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 単位１日あたり利息額
           MOVE  WK-TANI-1-YMD-RG       OF  WK-MEG-ZOK-INFO
             TO  TANI-1-YMD-RSK-GAKU    OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 経過日数計算方法
           MOVE  WK-KN-CALC-HOU         OF  WK-MEG-ZOK-INFO
             TO  KEKA-NISU-CALC-HOU     OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 経過日数計算方法１ヶ月３０日設定区分
           MOVE  WK-KKKS-1M30D-KBN      OF  WK-MEG-ZOK-INFO
             TO  KKNS-KSHH-1M30D-KBN    OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 経過日数計算方法片端／両端区分
           MOVE  WK-KKK-KTT-RT-KBN      OF  WK-MEG-ZOK-INFO
             TO  KKNS-KSHH-KTT-RT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 外国現地源泉税非課税区分
           MOVE  WK-G-GSZ-NOTAX-KBN     OF  WK-MEG-ZOK-INFO
             TO  GAI-G-GSZ-NOTAX-KBN    OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 開始時残高履歴情報
      *---------- 市場通貨コード
           MOVE  SIJO-TUKA-CD           OF  WK-TKMZZR00
             TO  SIJO-TUKA-CD           OF  KAISI-ZN-RIRK-INFO
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 短期スタート日
           MOVE  SHORT-START-YMD        OF  WK-TKMZZR00
             TO  SHORT-START-YMD        OF  KAISI-ZN-RIRK-INFO
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 短期エンド日
           MOVE  SHORT-END-YMD          OF  WK-TKMZZR00
             TO  SHORT-END-YMD          OF  KAISI-ZN-RIRK-INFO
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 数量残高
           MOVE  SRYZN                  OF  WK-TKMZZR00
             TO  SRYZN                  OF  KAISI-ZN-RIRK-INFO
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 短期スタート・エンド経過利息
           MOVE  SHORT-STEN-KEKA-RSK    OF  WK-TKMZZR00
             TO  SHORT-STEN-KEKA-RSK    OF  KAISI-ZN-RIRK-INFO
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 投資対象国コード
           MOVE  WK-TSTSK-CD            OF  WK-MEG-CD-REF
             TO  TSTSK-CD               OF  PARM-SMZJ2130-ARG1
      *---------- 管理数量単位
           MOVE  WK-KANRI-SURYO-TANI
             TO  KANRI-SURYO-TANI       OF  PARM-SMZJ2130-ARG1
      *---------- 料率パターンコード
           MOVE  WK-COMMISSION-PATTERN  OF  WK-TKMZBW02
             TO  COMMISSION-PATTERN     OF  PARM-SMZJ2130-ARG1
      *---------- 残高異動データ
      *---------- 短期スタート日
           MOVE  SHORT-START-YMD        OF  WK-TZ-ZN-IDO
             TO  SHORT-ST-YMD           OF  ZN-IDO-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 短期エンド日
           MOVE  SHORT-END-YMD          OF  WK-TZ-ZN-IDO
             TO  SHORT-ED-YMD           OF  ZN-IDO-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 短期スタート・エンド経過利息
           MOVE  SHORT-STEN-KEKA-RSK    OF  WK-TZ-ZN-IDO
             TO  SHORT-STN-KEA-RSK      OF  ZN-IDO-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 異動後数量残高
           MOVE  IDOG-SRYZN             OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN             OF  ZN-IDO-DATA-PARM
                                        OF  PARM-SMZJ2130-ARG1
      *---------- その他処理パターン
           MOVE  WK-ELS0-PTN
             TO  ELSO-PTN               OF  PARM-SMZJ2130-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2130-ARG1
      *---------- 約定ベース受渡順フラグ
           MOVE  WK-YKJ-UKE-JUN-FLG
             TO  YKJ-UKE-JUN-FLG        OF  PARM-SMZJ2130-ARG1
      *---------- 銘柄属性取得フラグ
           MOVE  FLG-MEG-ZOK
             TO  MEG-ZOK-FLG            OF  PARM-SMZJ2130-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日 =["
      D             KAISI-KJN-YMD       OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類 =["
      D             MEG-CD-SHRU         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             SJO-TKA-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日=["
      D             SABON-UPDATE-FROM   OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理 =["
      D             TUKA-DEF-HASU-SYRI-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ:"
      D    DISPLAY  CNS-PGM-ID":初期利払起算日 =["
      D             SHOKI-RIBAR-KS-YMD  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日 =["
      D             SHOKI-RIBAR-YMD     OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":最終利払起算日 =["
      D           LAST-RIBAR-KISAN-YMD  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日 =["
      D             SHUKI-RIBAR-YMD     OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払回数 =["
      D             RIBAR-KAISU         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日１ =["
      D             RIBAR-YMD-1         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日２ =["
      D             RIBAR-YMD-2         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日３ =["
      D             RIBAR-YMD-3         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日４ =["
      D             RIBAR-YMD-4         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日休日処理区分 =["
      D          RIBAR-YMD-QJT-SR-KBN   OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日休日処理区分 =["
      D          SHOKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日休日処理区分 =["
      D          SHUKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":単位１日あたり利息額=["
      D             TANI-1-YMD-RSK-GAKU OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法 =["
      D             KEKA-NISU-CALC-HOU  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法１ヶ月３０日設定区分=["
      D             KKNS-KSHH-1M30D-KBN OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法片端／両端区分=["
      D             KKNS-KSHH-KTT-RT-KBN OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":外国現地源泉税非課税区分 =["
      D             GAI-G-GSZ-NOTAX-KBN OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報:"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             SIJO-TUKA-CD        OF  KAISI-ZN-RIRK-INFO
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日 =["
      D             SHORT-START-YMD     OF  KAISI-ZN-RIRK-INFO
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日=["
      D             SHORT-END-YMD       OF  KAISI-ZN-RIRK-INFO
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":数量残高 =["
      D             SRYZN               OF  KAISI-ZN-RIRK-INFO
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息 =["
      D             SHORT-STEN-KEKA-RSK OF  KAISI-ZN-RIRK-INFO
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード =["
      D             TSTSK-CD            OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理数量単位=["
      D             KANRI-SURYO-TANI    OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":料率パターンコード =["
      D             COMMISSION-PATTERN  OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":残高異動データ:"
      D    DISPLAY  CNS-PGM-ID":短期スタート日 =["
      D             SHORT-ST-YMD        OF  ZN-IDO-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日 =["
      D             SHORT-ED-YMD        OF  ZN-IDO-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息 =["
      D             SHORT-STN-KEA-RSK   OF  ZN-IDO-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高 =["
      D             IDOG-SRYZN          OF  ZN-IDO-DATA-PARM
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他処理パターン =["
      D             ELSO-PTN            OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ =["
      D             YKJ-UKE-JUN-FLG     OF  PARM-SMZJ2130-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性取得フラグ =["
      D             MEG-ZOK-FLG         OF  PARM-SMZJ2130-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2130"             USING  PARM-SMZJ2130-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2130)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
             WHEN  CNS-RTN-110
      *---------- ワーク基準日の経過利息データ.市場通貨未収収益
               MOVE  SJTK-MS-SHEKI      OF  PARM-SMZJ2130-ARG2
                 TO  WK-SJTK-MS-SHEKI   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.運用通貨未収収益
               MOVE  UYTK-MS-SHEKI      OF  PARM-SMZJ2130-ARG2
                 TO  WK-UYTK-MS-SHEKI   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.市場通貨源泉税
               MOVE  SJTK-GENSEN-TAX    OF  PARM-SMZJ2130-ARG2
                 TO  WK-SJTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.運用通貨源泉税
               MOVE  UYTK-GENSEN-TAX    OF  PARM-SMZJ2130-ARG2
                 TO  WK-UYTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.評価為替レート
               MOVE  HYK-KWS            OF  PARM-SMZJ2130-ARG2
                 TO  WK-HYK-KWS         OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.源泉税評価為替レート
               MOVE  GENS-TAX-HYK-KWS   OF  PARM-SMZJ2130-ARG2
                 TO  WK-GENS-TAX-HYK-KWS  OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- その他未収配当計算コールフラグ
               MOVE  CNS-1              TO  WK-KEISAN-FLG3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日の経過利息データ:"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益 =["
      D             WK-SJTK-MS-SHEKI    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益 =["
      D             WK-UYTK-MS-SHEKI    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税 =["
      D             WK-SJTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税 =["
      D             WK-UYTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":評価為替レート =["
      D             WK-HYK-KWS          OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":源泉税評価為替レート =["
      D             WK-GENS-TAX-HYK-KWS OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":その他未収配当計算コールフラグ =["
      D                                               WK-KEISAN-FLG3"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-083          TO  WK-ERR-POS
               PERFORM  ERR-MSG-1-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  その他未収収益計算 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ2130-EXT.
           EXIT.
      ******************************************************************
      *   4.2.6.4.資金の未収収益計算
      ******************************************************************
       SMZJ2140-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金の未収収益計算 処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2140-INOUT
                       PARM-RTNPKG
      *---------- 銘柄別断面情報:
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 銘柄種類
           MOVE  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
             TO  MEG-CD-SHRU            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 銘柄属性データ
      *---------- 初期利払起算日
           MOVE  WK-SET-YMD             OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-KS-YMD     OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 初期利払日
           MOVE  WK-SET-YMD             OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-YMD        OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 最終利払起算日
           MOVE  WK-LAST-RB-KS-YMD      OF  WK-MEG-ZOK-INFO
             TO  LAST-RIBAR-KISAN-YMD   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 終期利払日
           MOVE  WK-SHUKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RIBAR-YMD        OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 利払回数
           MOVE  WK-RIBAR-KAISU         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-KAISU            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 利払日１
           MOVE  WK-RIBAR-YMD-1         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-1            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 利払日２
           MOVE  WK-RIBAR-YMD-2         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-2            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 利払日３
           MOVE  WK-RIBAR-YMD-3         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-3            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 利払日４
           MOVE  WK-RIBAR-YMD-4         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-4            OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 利払日休日処理区分
           MOVE  WK-RIBAR-YMD-QJT-SR-KBN OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-QJT-SR-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 初期利払日休日処理区分
           MOVE  WK-SHOKI-RB-YMD-QJT-KBN OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 終期利払日休日処理区分
           MOVE  WK-SHUKI-RB-YMD-QJT-KBN OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 単位１日あたり利息額
           MOVE  WK-TANI-1-YMD-RG       OF  WK-MEG-ZOK-INFO
             TO  TANI-1-YMD-RSK-GAKU    OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 経過日数計算方法
           MOVE  WK-KN-CALC-HOU         OF  WK-MEG-ZOK-INFO
             TO  KEKA-NISU-CALC-HOU     OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 経過日数計算方法１ヶ月３０日設定区分
           MOVE  WK-KKKS-1M30D-KBN      OF  WK-MEG-ZOK-INFO
             TO  KKNS-KSHH-1M30D-KBN    OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 経過日数計算方法片端／両端区分
           MOVE  WK-KKK-KTT-RT-KBN      OF  WK-MEG-ZOK-INFO
             TO  KKNS-KSHH-KTT-RT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 外国現地源泉税非課税区分
           MOVE  WK-G-GSZ-NOTAX-KBN     OF  WK-MEG-ZOK-INFO
             TO  GAI-G-GSZ-NOTAX-KBN    OF  MEG-ZOKUSEI-DATA-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 開始時資金残履歴情報
      *---------- 決済口座通貨コード
           MOVE  KOZA-TUKA-CD           OF  WK-TKMZSR00
             TO  KOZA-TUKA-CD           OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 市場通貨当日ＣＡＳＨ残高
           MOVE  SJTK-TJT-CASHZN        OF  WK-TKMZSR00
             TO  SJTK-TJT-CASHZN        OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 投資対象国コード
           MOVE  WK-TSTSK-CD            OF  WK-MEG-CD-REF
             TO  TSTSK-CD               OF  PARM-SMZJ2140-ARG1
      *---------- 管理数量単位
           MOVE  WK-KANRI-SURYO-TANI
             TO  KANRI-SURYO-TANI       OF  PARM-SMZJ2140-ARG1
      *---------- 料率パターンコード
           MOVE  WK-COMMISSION-PATTERN  OF  WK-TKMZBW02
             TO  COMMISSION-PATTERN     OF  PARM-SMZJ2140-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2140-ARG1
      *---------- 約定ベース受渡順フラグ
           MOVE  WK-YKJ-UKE-JUN-FLG
             TO  YKJ-UKE-JUN-FLG        OF  PARM-SMZJ2140-ARG1
      *---------- 銘柄属性取得フラグ
           MOVE  FLG-MEG-ZOK
             TO  MEG-ZOK-FLG            OF  PARM-SMZJ2140-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日 =["
      D             KAISI-KJN-YMD       OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類 =["
      D             MEG-CD-SHRU         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日=["
      D             SABON-UPDATE-FROM   OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理 =["
      D             TUKA-DEF-HASU-SYRI-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ:"
      D    DISPLAY  CNS-PGM-ID":初期利払起算日 =["
      D             SHOKI-RIBAR-KS-YMD  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日 =["
      D             SHOKI-RIBAR-YMD     OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":最終利払起算日 =["
      D           LAST-RIBAR-KISAN-YMD  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日 =["
      D             SHUKI-RIBAR-YMD     OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払回数 =["
      D             RIBAR-KAISU         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日１ =["
      D             RIBAR-YMD-1         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日２ =["
      D             RIBAR-YMD-2         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日３ =["
      D             RIBAR-YMD-3         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日４ =["
      D             RIBAR-YMD-4         OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日休日処理区分 =["
      D          RIBAR-YMD-QJT-SR-KBN   OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日休日処理区分 =["
      D          SHOKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日休日処理区分 =["
      D          SHUKI-RB-YMD-QJT-KBN   OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":単位１日あたり利息額=["
      D             TANI-1-YMD-RSK-GAKU OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法 =["
      D             KEKA-NISU-CALC-HOU  OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法１ヶ月３０日設定区分=["
      D             KKNS-KSHH-1M30D-KBN OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過日数計算方法片端／両端区分=["
      D             KKNS-KSHH-KTT-RT-KBN OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":外国現地源泉税非課税区分 =["
      D             GAI-G-GSZ-NOTAX-KBN OF  MEG-ZOKUSEI-DATA-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報:"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード =["
      D             KOZA-TUKA-CD        OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨当日ＣＡＳＨ残高 =["
      D             SJTK-TJT-CASHZN     OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード =["
      D             TSTSK-CD            OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理数量単位 =["
      D             KANRI-SURYO-TANI    OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":料率パターンコード =["
      D             COMMISSION-PATTERN  OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ =["
      D             YKJ-UKE-JUN-FLG     OF  PARM-SMZJ2140-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性取得フラグ =["
      D             MEG-ZOK-FLG         OF  PARM-SMZJ2140-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2140"             USING  PARM-SMZJ2140-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2140)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
             WHEN  CNS-RTN-110
      *---------- ワーク基準日の経過利息データ.市場通貨未収収益
               MOVE  SJTK-MS-SHEKI      OF  KJY-MS-SHEKI-PARM
                                        OF   PARM-SMZJ2140-ARG2
                 TO  WK-SJTK-MS-SHEKI   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.運用通貨未収収益
               MOVE  UYTK-MS-SHEKI      OF  KJY-MS-SHEKI-PARM
                                        OF   PARM-SMZJ2140-ARG2
                 TO  WK-UYTK-MS-SHEKI   OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.市場通貨源泉税
               MOVE  SJTK-GENSEN-TAX    OF  KJY-MS-SHEKI-PARM
                                        OF   PARM-SMZJ2140-ARG2
                 TO  WK-SJTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- ワーク基準日の経過利息データ.運用通貨源泉税
               MOVE  UYTK-GENSEN-TAX    OF  KJY-MS-SHEKI-PARM
                                        OF   PARM-SMZJ2140-ARG2
                 TO  WK-UYTK-GENSEN-TAX OF  WK-KJN-YMD-KEKA-RSK-DATA
      *---------- その他未収配当計算コールフラグ
               MOVE  CNS-1              TO  WK-KEISAN-FLG3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日の経過利息データ:"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益 =["
      D             WK-SJTK-MS-SHEKI    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益 =["
      D             WK-UYTK-MS-SHEKI    OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税 =["
      D             WK-SJTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税 =["
      D             WK-UYTK-GENSEN-TAX  OF  WK-KJN-YMD-KEKA-RSK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":その他未収配当計算コールフラグ =["
      D                                               WK-KEISAN-FLG3"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-084          TO  WK-ERR-POS
               PERFORM  ERR-MSG-4-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 資金の未収収益計算 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ2140-EXT.
           EXIT.
      ******************************************************************
      *   4.2.6.5.未収収益計上計算
      ******************************************************************
       SMZJ2150-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  未収収益計上計算  処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2150-INOUT
                       PARM-RTNPKG
      *---------- 銘柄別断面情報:
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 銘柄種類
           MOVE  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
             TO  MEG-CD-SHRU            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2150-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類=["
      D             MEG-CD-SHRU         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2150-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2150"             USING  PARM-SMZJ2150-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2150)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-085          TO  WK-ERR-POS
             PERFORM  ERR-MSG-4-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 未収収益計上計算  処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ2150-EXT.
           EXIT.
      ******************************************************************
      *    4.2.7.2.1)跨ぎ前払金異動額集計処理
      ******************************************************************
       SMZJ2211-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***跨ぎ前払金異動額集計処理START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2211-INOUT
                       PARM-RTNPKG
      *---------- 基準日断面情報:
      *----------  処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2211-ARG1
      *----------  起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2211-ARG1
      *----------  開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2211-ARG1
      *----------  基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2211-ARG1
      *----------  基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG
                                        OF  WK-TKMZBW02
             TO  KIHON-KAIKEI-BASE-FLG  OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2211-ARG1
      *----------  仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD      OF  WK-TKMZBW02
             TO  SKJN-PTN-CD            OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ2211-ARG1
      *---------- 銘柄別断面情報:
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *----------  銘柄種類２
           MOVE  WK-MEG-CD-SHRU2        OF  WK-TKMZBW03
             TO  MEG-CD-SHRU2           OF  MEG-DNM-JOHO-PARM
                                        OF  PARM-SMZJ2211-ARG1
      *----------  利付／割引区分
           MOVE  WK-RITUKI-WARI-KBN     OF  WK-MEG-ZOK-INFO
             TO  RITUKI-WARI-KBN        OF  PARM-SMZJ2211-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報:"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始基準日の翌日 =["
      D             KAISI-KJN-YMD-NEXT  OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             KJN-YMD             OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基本会計ベースフラグ =["
      D             KIHON-KAIKEI-BASE-FLG OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準パターンコード =["
      D             SKJN-PTN-CD         OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             TATE-FLG            OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             GYOKU-ID            OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄種類２ =["
      D             MEG-CD-SHRU2        OF  MEG-DNM-JOHO-PARM
      D                                 OF  PARM-SMZJ2211-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利付／割引区分 =["
      D             RITUKI-WARI-KBN     OF  PARM-SMZJ2211-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ2211"             USING  PARM-SMZJ2211-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2211)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
               CONTINUE
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-086        TO  WK-ERR-POS
               PERFORM  ERR-MSG-4-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  跨ぎ前払金異動額集計処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ2211-EXT.
           EXIT.
      ******************************************************************
      *   4.2.7.銘柄別残高計算
      ******************************************************************
       MEG-ZN-CALC-RTN        SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別残高計算 処理  START  ***"
      *-----------------------------------------------------------------
      *---------- 1)ワーク残高計算フラグ編集
           PERFORM  ZN-CALC-FLG-EDIT-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高計算フラグ=["WK-ZN-CALC-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始基準日断面存在フラグ =["
      D             WK-KKY-DMN-SONZAI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引存在フラグ =["
      D             WK-TRHK-SONZAI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日 =["
      D             WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03 "]"
      *-----------------------------------------------------------------
      *---------- 2)ワーク残高計算フラグ＝'1'(する)の場合
           IF  WK-ZN-CALC-FLG = CNS-ZN-CALC-FLG-1
           THEN
      *---------- @ワーク開始基準日断面存在フラグ＝'1'(ある) AND ワーク取引存在フラグ＝'0'(なし)
      *---------- AND ワーク銘柄別断面情報.差分更新From日＝0の場合
             IF  WK-KKY-DMN-SONZAI-FLG = CNS-KJ-DMN-1  AND
                 WK-TRHK-SONZAI-FLG    = CNS-KJ-DMN-0  AND
                 WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03  = ZERO
             THEN
               MOVE  CNS-SAI-CALC-KBN-2
                 TO  WK-SAI-CALC-KBN    OF  WK-TKMZBW03
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.再計算区分=["
      D             WK-SAI-CALC-KBN     OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
      *---------- A 銘柄別残高計算ルーチン
             PERFORM  SMZJ2210-RTN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別残高計算 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       MEG-ZN-CALC-EXT.
           EXIT.
      ******************************************************************
      *    1)ワーク残高計算フラグ編集
      ******************************************************************
       ZN-CALC-FLG-EDIT-RTN   SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨異動後仮払金残(前)=["
      D             WK-SJTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨異動後仮払金残(前)=["
      D             WK-UYTK-IDOG-SPAYZN"]"
      *-----------------------------------------------------------------
           MOVE  ZERO  TO  WK-SJTK-IDOG-SPAYZN
           MOVE  ZERO  TO  WK-UYTK-IDOG-SPAYZN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨異動後仮払金残(後)=["
      D             WK-SJTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨異動後仮払金残(後)=["
      D             WK-UYTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始基準日断面存在フラグ =["
      D             WK-KKY-DMN-SONZAI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引存在フラグ =["
      D             WK-TRHK-SONZAI-FLG"]"
      *-----------------------------------------------------------------
           IF  WK-KKY-DMN-SONZAI-FLG = CNS-KJ-DMN-0
           THEN
             IF  WK-TRHK-SONZAI-FLG = CNS-KJ-DMN-1
             THEN
              MOVE  SJTK-IDOG-SPAYZN   OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-SPAYZN
               MOVE  UYTK-IDOG-SPAYZN   OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-SPAYZN
               MOVE  CNS-ZN-CALC-FLG-1  TO  WK-ZN-CALC-FLG
             ELSE
               CONTINUE
             END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨異動後仮払金残=["
      D             WK-SJTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨異動後仮払金残=["
      D             WK-UYTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高計算フラグ=["WK-ZN-CALC-FLG"]"
      *-----------------------------------------------------------------
           ELSE
             IF  WK-TRHK-SONZAI-FLG = CNS-KJ-DMN-0
             THEN
               MOVE  SJTK-SPAYZN        OF  WK-TKMZZR00
                 TO  WK-SJTK-IDOG-SPAYZN
               MOVE  UYTK-SPAYZN        OF  WK-TKMZZR00
                 TO  WK-UYTK-IDOG-SPAYZN
             ELSE
               MOVE  SJTK-IDOG-SPAYZN   OF  WK-TZ-ZN-IDO
                 TO  WK-SJTK-IDOG-SPAYZN
               MOVE  UYTK-IDOG-SPAYZN   OF  WK-TZ-ZN-IDO
                 TO  WK-UYTK-IDOG-SPAYZN
             END-IF
             MOVE  CNS-ZN-CALC-FLG-1  TO  WK-ZN-CALC-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨異動後仮払金残=["
      D             WK-SJTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨異動後仮払金残=["
      D             WK-UYTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク残高計算フラグ=["WK-ZN-CALC-FLG"]"
      *-----------------------------------------------------------------
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高計算フラグ=["WK-ZN-CALC-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
           IF  WK-ZN-CALC-FLG = CNS-ZN-CALC-FLG-1  AND
               WK-MEG-CD-SHRU  OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-1
           THEN
      *---------- 証券種別判定
             PERFORM  SMZJ4014-RTN
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       ZN-CALC-FLG-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    証券種別判定
      ******************************************************************
       SMZJ4014-RTN           SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4014-INOUT
                       PARM-RTNPKG
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  PARM-SMZJ4014-ARG1
      *---------- 判定対象区分
           MOVE  CNS-ZN-RIRK-SK-KBN-1
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4014-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分  =["
      D             HANTEI-TARGET-KBN   OF  PARM-SMZJ4014-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4014"             USING  PARM-SMZJ4014-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4014)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             MOVE  ZN-RIRK-SK-KBN       OF  PARM-SMZJ4014-ARG2
               TO  WK-ZN-CALC-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク残高計算フラグ=["WK-ZN-CALC-FLG"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4014-EXT.
           EXIT.
      ******************************************************************
      *    証券種別判定
      ******************************************************************
       SMZJ4014-2-RTN         SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4014-INOUT
                       PARM-RTNPKG
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  PARM-SMZJ4014-ARG1
      *---------- 判定対象区分
           MOVE  CNS-X-7
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4014-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分  =["
      D             HANTEI-TARGET-KBN   OF  PARM-SMZJ4014-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4014"             USING  PARM-SMZJ4014-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4014)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             MOVE  MEG-ZKSE-SYUTK-KBN   OF  PARM-SMZJ4014-ARG2
               TO  WK-MEG-ZKSE-SYUTK-KBN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得区分=["
      D             WK-MEG-ZKSE-SYUTK-KBN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4014-2-EXT.
           EXIT.
      ******************************************************************
      *    A 銘柄別残高計算ルーチン
      ******************************************************************
       SMZJ2210-RTN           SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ2210-INOUT
                       PARM-RTNPKG
      *---------- 基準日断面情報:
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 基準日種類
           MOVE  WK-KJN-YMD-SHRU        OF  WK-TKMZBW02
             TO  KJN-YMD-SHRU           OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG      OF  WK-TKMZBW02
             TO  KH-KAIKEI-BASE-FLG     OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 基準日断面作成区分
           MOVE  WK-KJN-YMD-DMN-SK-KBN  OF  WK-TKMZBW02
             TO  KJN-YMD-DMN-SK-KBN     OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD      OF  WK-TKMZBW02
             TO  SKJN-PTN-CD            OF  TKMZBW02-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 銘柄別断面情報:
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 銘柄種類
           MOVE  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
             TO  MEG-CD-SHRU            OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 銘柄種類2
           MOVE  WK-MEG-CD-SHRU2        OF  WK-TKMZBW03
             TO  MEG-CD-SHRU2           OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 再計算区分
           MOVE  WK-SAI-CALC-KBN        OF  WK-TKMZBW03
             TO  SAI-CALC-KBN           OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 差分更新FROM日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  SIJO-TUKA-CD           OF  TKMZBW03-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 開始時残高履歴情報:
      *---------- 決算日断面区分
           MOVE  KSN-YMD-DMN-KBN        OF  WK-TKMZZR00
             TO  KSN-YMD-DMN-KBN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨コード
           MOVE  SIJO-TUKA-CD           OF  WK-TKMZZR00
             TO  SIJO-TUKA-CD           OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 数量残高
           MOVE  SRYZN                  OF  WK-TKMZZR00
             TO  SRYZN                  OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  WK-TKMZZR00
             TO  BOKA-KWS               OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨簿価残高
           MOVE  SJTK-BOKAZN            OF  WK-TKMZZR00
             TO  SJTK-BOKAZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨簿価残高
           MOVE  UYTK-BOKAZN            OF  WK-TKMZZR00
             TO  UYTK-BOKAZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨簿価単価
           MOVE  SJTK-BOKA-TNK          OF  WK-TKMZZR00
             TO  SJTK-BOKA-TNK          OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨簿価単価
           MOVE  UYTK-BOKA-TNK          OF  WK-TKMZZR00
             TO  UYTK-BOKA-TNK          OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨前払金残
           MOVE  SJTK-PPAYZN            OF  WK-TKMZZR00
             TO  SJTK-PPAYZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨前払金残
           MOVE  UYTK-PPAYZN            OF  WK-TKMZZR00
             TO  UYTK-PPAYZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨前受金残
           MOVE  SJTK-ARECZN            OF  WK-TKMZZR00
             TO  SJTK-ARECZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨前受金残
           MOVE  UYTK-ARECZN            OF  WK-TKMZZR00
             TO  UYTK-ARECZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨仮払金残
           MOVE  SJTK-SPAYZN            OF  WK-TKMZZR00
             TO  SJTK-SPAYZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨仮払金残
           MOVE  UYTK-SPAYZN            OF  WK-TKMZZR00
             TO  UYTK-SPAYZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨払出単価
           MOVE  SJTK-H-TNK             OF  WK-TKMZZR00
             TO  SJTK-H-TNK             OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨払出単価
           MOVE  UYTK-H-TNK             OF  WK-TKMZZR00
             TO  UYTK-H-TNK             OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  同一コスト継続フラグ
           MOVE  SAME-COST-KZK-FLG      OF  WK-TKMZZR00
             TO  SAME-COST-KZK-FLG      OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  市場通貨未収収益計上・戻入額
           MOVE  SJTK-MSSE-KJMIG        OF  WK-TKMZZR00
             TO  SJTK-MSSE-KJMIG        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  運用通貨未収収益計上・戻入額
           MOVE  UYTK-MSSE-KJMIG        OF  WK-TKMZZR00
             TO  UYTK-MSSE-KJMIG        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 数量残高（利付）
           MOVE  SRYZN-RIT              OF  WK-TKMZZR00
             TO  SRYZN-RIT              OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 建玉単価
           MOVE  TGYOKU-TNK             OF  WK-TKMZZR00
             TO  TGYOKU-TNK             OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 建玉為替レート
           MOVE  TGYOKU-KWS-RATE        OF  WK-TKMZZR00
             TO  TGYOKU-KWS-RATE        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 建玉ブローカー
           MOVE  TGYOKU-BRK             OF  WK-TKMZZR00
             TO  TGYOKU-BRK             OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 建玉約定日
           MOVE  TGYOKU-YKJ-YMD         OF  WK-TKMZZR00
             TO  TGYOKU-YKJ-YMD         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨建玉約定金額残
           MOVE  SJTK-TG-YJKNZN         OF  WK-TKMZZR00
             TO  SJTK-TG-YJKNZN         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨建玉約定金額残
           MOVE  UYTK-TG-YJKNZN         OF  WK-TKMZZR00
             TO  UYTK-TG-YJKNZN         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨建玉手数料残
           MOVE  SJTK-TG-TSRZN          OF  WK-TKMZZR00
             TO  SJTK-TG-TSRZN          OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨建玉手数料残
           MOVE  UYTK-TG-TSRZN          OF  WK-TKMZZR00
             TO  UYTK-TG-TSRZN          OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨建玉消費税残
           MOVE  SJTK-TG-S-TAXZN        OF  WK-TKMZZR00
             TO  SJTK-TG-S-TAXZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨建玉消費税残
           MOVE  UYTK-TG-S-TAXZN        OF  WK-TKMZZR00
             TO  UYTK-TG-S-TAXZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨建玉その他費用残
           MOVE  SJTK-TG-ELS-HIYOZN     OF  WK-TKMZZR00
             TO  SJTK-TG-ELS-HIYOZN     OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨建玉その他費用残
           MOVE  UYTK-TG-ELS-HIYOZN     OF  WK-TKMZZR00
             TO  UYTK-TG-ELS-HIYOZN     OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨建玉精算金額残
           MOVE  SJTK-TG-SSKGZN         OF  WK-TKMZZR00
             TO  SJTK-TG-SSKGZN         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨建玉精算金額残
           MOVE  UYTK-TG-SSKGZN         OF  WK-TKMZZR00
             TO  UYTK-TG-SSKGZN         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  OP資産負債・買建売建フラグ
           MOVE  OP-TATE-FLG            OF  WK-TKMZZR00
             TO  OP-TATE-FLG            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨源泉税還付予定額残高
           MOVE  SJTK-GSZKP-YTZN        OF  WK-TKMZZR00
             TO  SJTK-GSZKP-YTZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨源泉税還付予定額残高
           MOVE  UYTK-GSZKP-YTZN        OF  WK-TKMZZR00
             TO  UYTK-GSZKP-YTZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 決済通貨源泉税還付予定額残高
           MOVE  KSTK-GSZKP-YTZN        OF  WK-TKMZZR00
             TO  KSTK-GSZKP-YTZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨ノンカバー未収金残高
           MOVE  SJTK-NOCV-MSKZN        OF  WK-TKMZZR00
             TO  SJTK-NOCV-MSKZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨ノンカバー未収金残高
           MOVE  UYTK-NOCV-MSKZN        OF  WK-TKMZZR00
             TO  UYTK-NOCV-MSKZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨ノンカバー未払金残高
           MOVE  SJTK-NOCV-MBKZN        OF  WK-TKMZZR00
             TO  SJTK-NOCV-MBKZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨ノンカバー未払金残高
           MOVE  UYTK-NOCV-MBKZN        OF  WK-TKMZZR00
             TO  UYTK-NOCV-MBKZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 短期スタート・エンド経過利息
           MOVE  SHORT-STEN-KEKA-RSK    OF  WK-TKMZZR00
             TO  SHORT-STEN-KEKA-RSK    OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 短期スタート日
           MOVE  SHORT-START-YMD        OF  WK-TKMZZR00
             TO  SHORT-START-YMD        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 短期エンド日
           MOVE  SHORT-END-YMD          OF  WK-TKMZZR00
             TO  SHORT-END-YMD          OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 基本会計ベースフラグ
           MOVE  KH-KAIKEI-BASE-FLG     OF  WK-TKMZZR00
             TO  KH-KAIKEI-BASE-FLG     OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  投資対象国コード
           MOVE  TSTSK-CD               OF  WK-TKMZZR00
             TO  TSTSK-CD               OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  発行国コード
           MOVE  HAKO-CD                OF  WK-TKMZZR00
             TO  HAKO-CD                OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  数量単位
           MOVE  SURYO-TANI             OF  WK-TKMZZR00
             TO  SURYO-TANI             OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  市場通貨未払費用残
           MOVE  SJTK-MBHYZN            OF  WK-TKMZZR00
             TO  SJTK-MBHYZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  運用通貨未払費用残
           MOVE  UYTK-MBHYZN            OF  WK-TKMZZR00
             TO  UYTK-MBHYZN            OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  市場通貨未払消費税残
           MOVE  SJTK-MB-S-TAXZN        OF  WK-TKMZZR00
             TO  SJTK-MB-S-TAXZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  運用通貨未払消費税残
           MOVE  UYTK-MB-S-TAXZN        OF  WK-TKMZZR00
             TO  UYTK-MB-S-TAXZN        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  市場通貨移管評価損益残
           MOVE  SJTK-IK-HKSEZN         OF  WK-TKMZZR00
             TO  SJTK-IK-HKSEZN         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  運用通貨移管評価損益残
           MOVE  UYTK-IK-HKSEZN         OF  WK-TKMZZR00
             TO  UYTK-IK-HKSEZN         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  市場通貨移管未収収益
           MOVE  SJTK-IK-MSSHEKI        OF  WK-TKMZZR00
             TO  SJTK-IK-MSSHEKI        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  運用通貨移管未収収益
           MOVE  UYTK-IK-MSSHEKI        OF  WK-TKMZZR00
             TO  UYTK-IK-MSSHEKI        OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  運用通貨移管前払金評価損益残
           MOVE  UYTK-IK-PPHKZN         OF  WK-TKMZZR00
             TO  UYTK-IK-PPHKZN         OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *----------  削除区分
           MOVE  SAKUJO-KBN             OF  WK-TKMZZR00
             TO  SAKUJO-KBN             OF  TKMZZR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 開始時資金残履歴情報:
      *---------- 決算日断面区分
           MOVE  KSN-YMD-DMN-KBN        OF  WK-TKMZSR00
             TO  KSN-YMD-DMN-KBN        OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 証券種別コード
           MOVE  SEC-SBT-CD             OF  WK-TKMZSR00
             TO  SEC-SBT-CD             OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 決済口座通貨コード
           MOVE  KOZA-TUKA-CD           OF  WK-TKMZSR00
             TO  KOZA-TUKA-CD           OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  WK-TKMZSR00
             TO  BOKA-KWS               OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨当日CASH残高
           MOVE  SJTK-TJT-CASHZN        OF  WK-TKMZSR00
             TO  SJTK-TJT-CASHZN        OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨当日CASH残高
           MOVE  UYTK-TJT-CASHZN        OF  WK-TKMZSR00
             TO  UYTK-TJT-CASHZN        OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨当日未収入金残高（内物）
           MOVE  SJTK-TJT-MSNKZN-UM     OF  WK-TKMZSR00
             TO  SJTK-TJT-MSNKZN-UM     OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨当日未収入金残高（内物）
           MOVE  UYTK-TJT-MSNKZN-UM     OF  WK-TKMZSR00
             TO  UYTK-TJT-MSNKZN-UM     OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨当日未収入金残高（外物）
           MOVE  SJTK-TJT-MSNKZN-SM     OF  WK-TKMZSR00
             TO  SJTK-TJT-MSNKZN-SM     OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨当日未収入金残高（外物）
           MOVE  UYTK-TJT-MSNKZN-SM     OF  WK-TKMZSR00
             TO  UYTK-TJT-MSNKZN-SM     OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨当日未払金残高（内物）
           MOVE  SJTK-TJT-MBKZN-UM      OF  WK-TKMZSR00
             TO  SJTK-TJT-MBKZN-UM      OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨当日未払金残高（内物）
           MOVE  UYTK-TJT-MBKZN-UM      OF  WK-TKMZSR00
             TO  UYTK-TJT-MBKZN-UM      OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨当日未払金残高（外物）
           MOVE  SJTK-TJT-MBKZN-SM      OF  WK-TKMZSR00
             TO  SJTK-TJT-MBKZN-SM      OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨当日未払金残高（外物）
           MOVE  UYTK-TJT-MBKZN-SM      OF  WK-TKMZSR00
             TO  UYTK-TJT-MBKZN-SM      OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨未収収益計上・戻入額
           MOVE  SJTK-MSSE-KJMIG        OF  WK-TKMZSR00
             TO  SJTK-MSSE-KJMIG        OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨未収収益計上・戻入額
           MOVE  UYTK-MSSE-KJMIG        OF  WK-TKMZSR00
             TO  UYTK-MSSE-KJMIG        OF  TKMZSR00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 開始時元本残高情報:
      *---------- 決算日断面区分
           MOVE  KSN-YMD-DMN-KBN        OF  WK-TKMZGZ00
             TO  KSN-YMD-DMN-KBN        OF  TKMZGZ00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 元本数量残高
           MOVE  GNP-SRYZN              OF  WK-TKMZGZ00
             TO  GNP-SRYZN              OF  TKMZGZ00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 元本簿価残高
           MOVE  GNP-BOKAZN             OF  WK-TKMZGZ00
             TO  GNP-BOKAZN             OF  TKMZGZ00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 総投入金額
           MOVE  SO-TN-KGK              OF  WK-TKMZGZ00
             TO  SO-TN-KGK              OF  TKMZGZ00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 初期設定金額
           MOVE  SHOKI-SET-KGK          OF  WK-TKMZGZ00
             TO  SHOKI-SET-KGK          OF  TKMZGZ00-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 異動計算パターン:
      *---------- 売り続く限り同一コスト
           MOVE  WK-URI-TUDUKU-SAME-COST
                                        OF  WK-IDO-CALC-PATTERN-INFO
             TO  URI-TUDUKU-SAME-COST   OF  IDO-CALC-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 処理順序
           MOVE  WK-SYRI-JUN            OF  WK-IDO-CALC-PATTERN-INFO
             TO  SYRI-JUN               OF  IDO-CALC-PARM
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 基準日の経過利息データ:
      *---------- 市場通貨経過利息
           MOVE  WK-SJTK-KEKA-RSK       OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  SJTK-KEKA-RSK          OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨経過利息
           MOVE  WK-UYTK-KEKA-RSK       OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  UYTK-KEKA-RSK          OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨未収収益
           MOVE  WK-SJTK-MS-SHEKI       OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  SJTK-MS-SHEKI          OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨未収収益
           MOVE  WK-UYTK-MS-SHEKI       OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  UYTK-MS-SHEKI          OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 市場通貨源泉税
           MOVE  WK-SJTK-GENSEN-TAX     OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  SJTK-GENSEN-TAX        OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 運用通貨源泉税
           MOVE  WK-UYTK-GENSEN-TAX     OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  UYTK-GENSEN-TAX        OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 評価為替レート
           MOVE  WK-HYK-KWS             OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  HYK-KWS                OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 源泉税評価為替レート
           MOVE  WK-GENS-TAX-HYK-KWS    OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  GENS-TAX-HYK-KWS       OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- ファクター・連動係数
           MOVE  WK-FT-RENDOU-KESU      OF  WK-KJN-YMD-KEKA-RSK-DATA
             TO  FACTOR-RENDOU-KESU     OF  KJN-YMD-KEKA-RSK-DATA
                                        OF  PARM-SMZJ2210-ARG1
      *---------- 決算前の未収収益計上
           MOVE  KESAN-MAE-SHEKI        OF  PARM-SMZJ2150-ARG2
             TO  KESSAN-ZE-M-RSK-KJY    OF  PARM-SMZJ2210-ARG1
      *---------- 決算後の未収収益計上
           MOVE  KESAN-ATO-SHEKI        OF  PARM-SMZJ2150-ARG2
             TO  KESSAN-GO-M-RSK-KJY    OF  PARM-SMZJ2210-ARG1
      *---------- 未収配当計算コールフラグ
           MOVE  WK-KEISAN-FLG1
             TO  KEISAN-FLG1            OF  PARM-SMZJ2210-ARG1
      *---------- 債券過去経過利息計算コールフラグ
           MOVE  WK-KEISAN-FLG2
             TO  KEISAN-FLG2            OF  PARM-SMZJ2210-ARG1
      *---------- その他未収配当計算コールフラグ
           MOVE  WK-KEISAN-FLG3
             TO  KEISAN-FLG3            OF  PARM-SMZJ2210-ARG1
      *---------- 再計算数量単位
           MOVE  WK-SAIKS-SURYO-TANI
             TO  SAIKS-SURYO-TANI       OF  PARM-SMZJ2210-ARG1
      *---------- 跨ぎ市場通貨前払金異動額集計
           MOVE  MATAGI-SJTK-PPAYIDOG   OF  PARM-SMZJ2211-ARG2
             TO  MATAGI-SJTK-PPAYIDOG   OF  PARM-SMZJ2210-ARG1
      *---------- 跨ぎ運用通貨前払金異動額集計
           MOVE  MATAGI-UYTK-PPAYIDOG   OF  PARM-SMZJ2211-ARG2
             TO  MATAGI-UYTK-PPAYIDOG   OF  PARM-SMZJ2210-ARG1
      *---------- 約定ベース受渡順フラグ
           MOVE  WK-YKJ-UKE-JUN-FLG
             TO  YKJ-UKE-JUN-FLG        OF  PARM-SMZJ2210-ARG1
      *---------- 取引属性データエリア
           MOVE  WK-TBL-TKCMTZ00-AREA
             TO  TORI-ZOKUSEI-AREA      OF  PARM-SMZJ2210-ARG1
      *---------- 欠落断面有無フラグ
           MOVE  WK-LACK-DMN-FLG
             TO  LACK-DMN-FLG           OF  PARM-SMZJ2210-ARG1
      *---------- 投資対象国コード
           MOVE  WK-TSTSK-CD            OF  WK-MEG-CD-REF
             TO  TSTSK-CD-IN            OF  PARM-SMZJ2210-ARG1
      *---------- 発行国コード
           MOVE  WK-HAKKO-TAI-KUNI-CD   OF  WK-MEG-CD-REF
             TO  HAKO-CD-IN             OF  PARM-SMZJ2210-ARG1
      *---------- 取引存在フラグ                                        @3212SEINO@@
           MOVE  WK-TRHK-SONZAI-FLG                                     @3212SEINO@@
             TO  TRHK-SONZAI-FLG        OF  PARM-SMZJ2210-ARG1          @3212SEINO@@
      *---------- 差分更新モード取得ルート区分                          @3212SEINO@@
           MOVE  WK-SABON-UPDATE-KBN                                    @3212SEINO@@
             TO  SABON-UPDATE-KBN       OF  PARM-SMZJ2210-ARG1          @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.利用会社コード=["
      D             RIYO-CMP-CD         OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.ファンドコード=["
      D             FUND-CD             OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.ポートフォリオコード=["
      D             PTF-CD              OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基準日=["
      D             KJN-YMD             OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.処理実行日= ["
      D             SYORI-YMD           OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.起動ID= ["
      D             KIDOU-ID            OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基準日種類 = ["
      D             KJN-YMD-SHRU        OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基本会計ベースフラグ = ["
      D             KH-KAIKEI-BASE-FLG  OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基準日断面作成区分=["
      D             KJN-YMD-DMN-SK-KBN  OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報.開始基準日の翌日=["
      D             KAISI-KJN-YMD-NEXT  OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID ": 基準日断面情報."
      D                                       "仕訳基準パターンコード=["
      D             SKJN-PTN-CD         OF  TKMZBW02-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.利用会社コード= ["
      D             RIYO-CMP-CD         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ファンドコード= ["
      D             FUND-CD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ポートフォリオコード=["
      D             PTF-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.処理実行日=["
      D             SYORI-YMD           OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.起動ID=["
      D             KIDOU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.証券種別コード=["
      D             SEC-SBT-CD          OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄コード=["
      D             MEG-CD              OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.資産負債・買建売建フラグ"
      D        "=[" TATE-FLG            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.玉ID=["
      D             GYOKU-ID            OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.開始基準日=["
      D             KAISI-KJN-YMD       OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.基準日=["
      D             KJN-YMD             OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄種類=["
      D             MEG-CD-SHRU         OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄種類2=["
      D             MEG-CD-SHRU2        OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.再計算区分=["
      D             SAI-CALC-KBN        OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.差分更新FROM日=["
      D             SABON-UPDATE-FROM   OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.市場通貨コード=["
      D             SIJO-TUKA-CD        OF  TKMZBW03-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨コード=["
      D             SIJO-TUKA-CD        OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.数量残高=["
      D             SRYZN               OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.簿価為替レート=["
      D             BOKA-KWS            OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨簿価残高=["
      D             SJTK-BOKAZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨簿価残高=["
      D             UYTK-BOKAZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨簿価単価=["
      D             SJTK-BOKA-TNK       OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨簿価単価=["
      D             UYTK-BOKA-TNK       OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨前払金残=["
      D             SJTK-PPAYZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨前払金残=["
      D             UYTK-PPAYZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨前受金残=["
      D             SJTK-ARECZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨前受金残=["
      D             UYTK-ARECZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨仮払金残=["
      D             SJTK-SPAYZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨仮払金残=["
      D             UYTK-SPAYZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨払出単価=["
      D             SJTK-H-TNK          OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨払出単価=["
      D             UYTK-H-TNK          OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報."
      D              "同一コスト継続フラグ=["
      D              SAME-COST-KZK-FLG  OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報."
      D              "市場通貨未収収益計上・戻入額=["
      D              SJTK-MSSE-KJMIG    OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報."
      D              "運用通貨未収収益計上・戻入額=["
      D              UYTK-MSSE-KJMIG    OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.数量残高（利付)=["
      D             SRYZN-RIT           OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.建玉単価=["
      D             TGYOKU-TNK          OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.建玉為替レート=["
      D             TGYOKU-KWS-RATE     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.建玉ブローカー=["
      D             TGYOKU-BRK          OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.建玉約定日=["
      D             TGYOKU-YKJ-YMD      OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨建玉約定"
      D    "金額残=["SJTK-TG-YJKNZN     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨建玉約定"
      D    "金額残=["UYTK-TG-YJKNZN     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨建玉手数"
      D     "料残=["SJTK-TG-TSRZN       OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨建玉手数"
      D     "料残=["UYTK-TG-TSRZN       OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨建玉消費"
      D     "税残=["SJTK-TG-S-TAXZN     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨建玉消費"
      D     "税残=["UYTK-TG-S-TAXZN     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨建玉その他"
      D    "費用残=["SJTK-TG-ELS-HIYOZN OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨建玉その他"
      D    "費用残=["UYTK-TG-ELS-HIYOZN OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨建玉精算金"
      D     "額残=["SJTK-TG-SSKGZN      OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨建玉精算金"
      D     "額残=["UYTK-TG-SSKGZN      OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.OP資産負債・買建売"
      D     "建フラグ=["OP-TATE-FLG     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨源泉税還付"
      D    "予定額残高=["SJTK-GSZKP-YTZN   OF TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨源泉税還付"
      D    "予定額残高=["UYTK-GSZKP-YTZN   OF TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.決済通貨源泉税還付"
      D    "予定額残高=["KSTK-GSZKP-YTZN   OF TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨ノンカバー"
      D    "未収金残高=["SJTK-NOCV-MSKZN   OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨ノンカバー"
      D    "未収金残高=["UYTK-NOCV-MSKZN   OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨ノンカバー"
      D    "未払金残高=["SJTK-NOCV-MBKZN   OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨ノンカバー"
      D    "未払金残高=["UYTK-NOCV-MBKZN   OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.短期スタート・エンド"
      D    "経過利息=["SHORT-STEN-KEKA-RSK OF TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.短期スタート日=["
      D             SHORT-START-YMD     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.短期エンド日=["
      D             SHORT-END-YMD       OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1 "]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.基本会計ベースフラグ"
      D         "=["KH-KAIKEI-BASE-FLG  OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.投資対象国コード"
      D         "=["TSTSK-CD            OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.発行国コード"
      D         "=["HAKO-CD             OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.数量単位"
      D         "=["SURYO-TANI          OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨未払費用残"
      D         "=["SJTK-MBHYZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨未払費用残"
      D         "=["UYTK-MBHYZN         OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨未払消費税残"
      D         "=["SJTK-MB-S-TAXZN     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨未払消費税残"
      D         "=["UYTK-MB-S-TAXZN     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨移管評価損"
      D         "益残=["SJTK-IK-HKSEZN  OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨移管評価損"
      D         "益残=["UYTK-IK-HKSEZN  OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.市場通貨移管未収収益"
      D         "=["SJTK-IK-MSSHEKI     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨移管未収収益"
      D         "=["UYTK-IK-MSSHEKI     OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.運用通貨移管前払金評"
      D         "価損益残=["UYTK-IK-PPHKZN
      D                                 OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時残高履歴情報.削除区分"
      D         "=["SAKUJO-KBN          OF  TKMZZR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.証券種別コード=["
      D             SEC-SBT-CD          OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.決済口座通貨コー"
      D             "ド=["KOZA-TUKA-CD  OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.簿価為替レート"
      D             "=["BOKA-KWS        OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.市場通貨当日CASH"
      D     "残高=["SJTK-TJT-CASHZN     OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.運用通貨当日CASH"
      D     "残高=["UYTK-TJT-CASHZN     OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.市場通貨当日未収"
      D             "入金残高（内物）=["
      D             SJTK-TJT-MSNKZN-UM  OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.運用通貨当日未収"
      D             "入金残高（内物）=["
      D             UYTK-TJT-MSNKZN-UM  OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.市場通貨当日未収"
      D             "入金残高（外物）=["
      D             SJTK-TJT-MSNKZN-SM  OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.運用通貨当日未収"
      D             "入金残高（外物）=["
      D             UYTK-TJT-MSNKZN-SM  OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.市場通貨当日未払"
      D             "金残高（内物）=["
      D             SJTK-TJT-MBKZN-UM   OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.運用通貨当日未払"
      D             "金残高（内物）=["
      D             UYTK-TJT-MBKZN-UM   OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.市場通貨当日未払"
      D             "金残高（外物）=["
      D             SJTK-TJT-MBKZN-SM   OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報.運用通貨当日未払"
      D             "金残高（外物）=["
      D             UYTK-TJT-MBKZN-SM   OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報."
      D             "市場通貨未収収益計上・戻入額=["
      D             SJTK-MSSE-KJMIG     OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時資金残履歴情報."
      D             "運用通貨未収収益計上・戻入額=["
      D             UYTK-MSSE-KJMIG     OF  TKMZSR00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時元本残高情報.決算日断面区分=["
      D             KSN-YMD-DMN-KBN     OF  TKMZGZ00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時元本残高情報.元本数量残高=["
      D             GNP-SRYZN           OF  TKMZGZ00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時元本残高情報.元本簿価残高=["
      D             GNP-BOKAZN          OF  TKMZGZ00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時元本残高情報.総投入金額=["
      D             SO-TN-KGK           OF  TKMZGZ00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":開始時元本残高情報.初期設定金額=["
      D             SHOKI-SET-KGK       OF  TKMZGZ00-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限り同一コスト=["
      D             URI-TUDUKU-SAME-COST OF  IDO-CALC-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理順序=["
      D             SYRI-JUN            OF  IDO-CALC-PARM
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.市場通貨経過"
      D     "利息=["SJTK-KEKA-RSK       OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.運用通貨経過"
      D     "利息=["UYTK-KEKA-RSK       OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.市場通貨未収"
      D        "収益=["SJTK-MS-SHEKI    OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.運用通貨未収"
      D         "収益=["UYTK-MS-SHEKI   OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.市場通貨源泉税=["
      D             SJTK-GENSEN-TAX     OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.運用通貨源泉税=["
      D             UYTK-GENSEN-TAX     OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.評価為替レート=["
      D             HYK-KWS             OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.源泉税評価為替"
      D             "レート=["
      D             GENS-TAX-HYK-KWS    OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日の経過利息データ.ファクター・"
      D             "連動係数=["
      D             FACTOR-RENDOU-KESU  OF  KJN-YMD-KEKA-RSK-DATA
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決算前の未収収益計上"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益 =["
      D             SJTK-MS-SHEKI       OF  KESSAN-ZE-M-RSK-KJY
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益 =["
      D             UYTK-MS-SHEKI       OF  KESSAN-ZE-M-RSK-KJY
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決算後の未収収益計上"
      D    DISPLAY  CNS-PGM-ID":市場通貨未収収益 =["
      D             SJTK-MS-SHEKI       OF  KESSAN-GO-M-RSK-KJY
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨未収収益 =["
      D             UYTK-MS-SHEKI       OF  KESSAN-GO-M-RSK-KJY
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":未収配当計算コールフラグ =["
      D             KEISAN-FLG1         OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":債券過去経過利息計算コールフラグ =["
      D             KEISAN-FLG2         OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他未収配当計算コールフラグ =["
      D             KEISAN-FLG3         OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":再計算数量単位  =["
      D             SAIKS-SURYO-TANI    OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":跨ぎ市場通貨前払金異動額集計=["
      D             MATAGI-SJTK-PPAYIDOG
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":跨ぎ運用通貨前払金異動額集計=["
      D             MATAGI-UYTK-PPAYIDOG
      D                                 OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ=["
      D             YKJ-UKE-JUN-FLG     OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引属性データエリア=["
      D             TORI-ZOKUSEI-AREA   OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":欠落断面有無フラグ=["
      D             LACK-DMN-FLG        OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード=["
      D             TSTSK-CD-IN         OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード=["
      D             HAKO-CD-IN          OF  PARM-SMZJ2210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引存在フラグ=["                       @3212SEINO@@
      D             TRHK-SONZAI-FLG     OF  PARM-SMZJ2210-ARG1"]"       @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":差分更新モード取得ルート区分=["         @3212SEINO@@
      D             SABON-UPDATE-KBN    OF  PARM-SMZJ2210-ARG1"]"       @3212SEINO@@
      *-----------------------------------------------------------------
           CALL  "SMZJ2210"             USING  PARM-SMZJ2210-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ2210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
             WHEN  CNS-RTN-000
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日別更新区分 =["
      D             KJB-KOUSIN-KBN      OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":履歴作成フラグ   =["
      D             RIREKI-SAKUSEI-FLG  OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
      *---------- リターンパッケージ.基準日別更新区分≠'0'(更新しない)の場合
               IF  KJB-KOUSIN-KBN  OF  PARM-SMZJ2210-ARG2  NOT =
                   CNS-KJB-KOUSIN-KBN-0
               THEN
                 MOVE  KJB-KOUSIN-KBN   OF  PARM-SMZJ2210-ARG2
                   TO  WK-KJN-YMD-DMN-SK-KBN
                                        OF  WK-TKMZBW02
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基準日断面作成区分 =["
      D             WK-KJN-YMD-DMN-SK-KBN  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
               IF  RIREKI-SAKUSEI-FLG   OF  PARM-SMZJ2210-ARG2 = CNS-1
               THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.履歴作成フラグ＝1"
      D             "（作成する）の場合"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3002コールデータなしフラグ =["
      D                                                  WK-MSG-FLG-1"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コール一部該当データなし"
      D             "フラグ =["                          WK-MSG-FLG-2"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コール利率取得失敗フラグ"
      D             " =["                                WK-MSG-FLG-3"]"
      D    DISPLAY  CNS-PGM-ID":ワークSCZY3031コールデータなしフラグ =["
      D                                                  WK-MSG-FLG-4"]"
      *-----------------------------------------------------------------
                 IF  WK-MSG-FLG-1       =  CNS-1
                 THEN
      *---------- ワークポートフォリオ情報.ファンドコード
                   MOVE  WK-FUND-CD         OF  WK-PTF-INFO
                     TO  WK-FUND-CD         OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
                   MOVE  WK-PTF-CD          OF  WK-PTF-INFO
                     TO  WK-PTF-CD          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
                   MOVE  WK-MKY-KJN-YMD-FROM
                     TO  WK-KJN-YMD-FROM    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
                   MOVE  WK-SITEI-TO        OF  WK-DENBUN-KAISEKI-INFO
                     TO  WK-KJN-YMD-TO      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M26のメッセージID
                   MOVE  CNS-MSG-E000352
                     TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← ' '
                   MOVE  SPACE
                     TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                   STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                           CNS-MSG-15,WK-GAIBU-MEG-CD-SSC,
                           CNS-MSG-16,WK-GAIBU-MEG-CD-STC
                           DELIMITED  BY  SIZE
                     INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
                   COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA＋1 =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
                   MOVE  CNS-RTN-BT4    TO  WK-RETURN-CD
      *---------- ワーク明細単位実行ステータス
                   MOVE  CNS-MT-JS-270  TO  WK-MT-JIKKOU-STATUS
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）
                   MOVE  CNS-MT-JS-270
                     TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "進捗ステータス（基準日） =["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
                 ELSE
                   CONTINUE
                 END-IF
                 IF  WK-MSG-FLG-2       =  CNS-1
                 THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M24のメッセージID
                   MOVE  CNS-MSG-E000526
                     TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                   MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                     TO  WK-STRIKEPRICE-M
                   MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
                   STRING   CNS-MSG-1, WK-SEC-SBT-CD  OF  WK-TKMZBW03,
                            CNS-MSG-2, WK-MEG-TUKA-CD OF  WK-MEG-CD-REF,
                            CNS-MSG-3,
                                 WK-HAKKO-TAI-KUNI-CD OF WK-MEG-CD-REF,
                            CNS-MSG-4, WK-TSTSK-CD    OF  WK-MEG-CD-REF,
                            CNS-MSG-5, WK-KABU-SBT    OF  WK-MEG-CD-REF,
                            CNS-MSG-6, WK-KAYI        OF  WK-MEG-CD-REF,
                            CNS-MSG-7, WK-GOU         OF  WK-MEG-CD-REF,
                            CNS-MSG-8, WK-GENGETSU    OF  WK-MEG-CD-REF,
                            CNS-MSG-9, WK-STRIKEPRICE-X,
                            CNS-MSG-10,WK-MNK-YMD     OF  WK-MEG-CD-REF,
                            CNS-MSG-11
                            DELIMITED  BY  SIZE
                     INTO   WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
                   PERFORM  M24-FREE-AREA-RTN
                 ELSE
                   CONTINUE
                 END-IF
                 IF  WK-MSG-FLG-3       =  CNS-1
                 THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M24のメッセージID
                   MOVE  CNS-MSG-E000526
                     TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                   MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                     TO  WK-STRIKEPRICE-M
                   MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
                   STRING   CNS-MSG-1, WK-SEC-SBT-CD  OF  WK-TKMZBW03,
                            CNS-MSG-2, WK-MEG-TUKA-CD OF  WK-MEG-CD-REF,
                            CNS-MSG-3,
                                 WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                            CNS-MSG-4, WK-TSTSK-CD    OF  WK-MEG-CD-REF,
                            CNS-MSG-5, WK-KABU-SBT    OF  WK-MEG-CD-REF,
                            CNS-MSG-6, WK-KAYI        OF  WK-MEG-CD-REF,
                            CNS-MSG-7, WK-GOU         OF  WK-MEG-CD-REF,
                            CNS-MSG-8, WK-GENGETSU    OF  WK-MEG-CD-REF,
                            CNS-MSG-9, WK-STRIKEPRICE-X,
                            CNS-MSG-10,WK-MNK-YMD     OF  WK-MEG-CD-REF,
                            CNS-MSG-37
                            DELIMITED  BY  SIZE
                     INTO   WK-FREE-MSG     OF  WK-MSG-AREA(WK-CounterA)
                   PERFORM  M24-FREE-AREA-RTN
                 ELSE
                   CONTINUE
                 END-IF
                 IF  WK-MSG-FLG-4       =  CNS-1
                 THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M25のメッセージID
                   MOVE  CNS-MSG-E000525
                     TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                   MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                     TO  WK-STRIKEPRICE-M
                   MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
                   STRING   CNS-MSG-1, WK-SEC-SBT-CD  OF  WK-TKMZBW03,
                            CNS-MSG-2, WK-MEG-TUKA-CD OF  WK-MEG-CD-REF,
                            CNS-MSG-3,
                                 WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                            CNS-MSG-4, WK-TSTSK-CD    OF  WK-MEG-CD-REF,
                            CNS-MSG-5, WK-KABU-SBT    OF  WK-MEG-CD-REF,
                            CNS-MSG-6, WK-KAYI        OF  WK-MEG-CD-REF,
                            CNS-MSG-7, WK-GOU         OF  WK-MEG-CD-REF,
                            CNS-MSG-8, WK-GENGETSU    OF  WK-MEG-CD-REF,
                            CNS-MSG-9, WK-STRIKEPRICE-X,
                            CNS-MSG-10,WK-MNK-YMD     OF  WK-MEG-CD-REF
                            DELIMITED  BY  SIZE
                     INTO   WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
                   PERFORM  M24-FREE-AREA-RTN
                 ELSE
                   CONTINUE
                 END-IF
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":保有残マイナスフラグ1（市場通貨簿価）=["
      D             MINUS-SJTK-FLG-1    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分1=["
      D             KSN-YMD-DMN-KBN-1   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               INITIALIZE  WK-MIDDLE-FREE-MSG
                           WK-MIDDLE-FREE-COUNT
               IF  MINUS-SJTK-FLG-1     OF  PARM-SMZJ2210-ARG2 = CNS-1
               THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '簿価金額(市場通貨)'
                 MOVE  CNS-TK-MOJI-81
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                 EVALUATE  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
                   WHEN  CNS-KSN-YMD-DMN-KBN-1
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-21
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  CNS-KSN-YMD-DMN-KBN-2
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-22
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  OTHER
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  15           TO  WK-MIDDLE-FREE-COUNT
                 END-EVALUATE
                 PERFORM  M41-FREE-AREA-RTN
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":保有残マイナスフラグ1（運用通貨簿価）=["
      D             MINUS-UYTK-FLG-1    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分1=["
      D             KSN-YMD-DMN-KBN-1   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               INITIALIZE  WK-MIDDLE-FREE-MSG
                           WK-MIDDLE-FREE-COUNT
               IF  MINUS-UYTK-FLG-1     OF  PARM-SMZJ2210-ARG2 = CNS-1
               THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '簿価金額(運用通貨)'
                 MOVE  CNS-TK-MOJI-82
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                 EVALUATE  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
                   WHEN  CNS-KSN-YMD-DMN-KBN-1
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-21
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  CNS-KSN-YMD-DMN-KBN-2
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-22
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  OTHER
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  15           TO  WK-MIDDLE-FREE-COUNT
                 END-EVALUATE
                 PERFORM  M41-FREE-AREA-RTN
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":保有残マイナスフラグ1（数量残高）=["
      D             MINUS-SRYZN-FLG-1   OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分1=["
      D             KSN-YMD-DMN-KBN-1   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               INITIALIZE  WK-MIDDLE-FREE-MSG
                           WK-MIDDLE-FREE-COUNT
               IF  MINUS-SRYZN-FLG-1    OF  PARM-SMZJ2210-ARG2 = CNS-1
               THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '数量残高'
                 MOVE  CNS-TK-MOJI-45
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                 EVALUATE  KSN-YMD-DMN-KBN-1  OF  PARM-SMZJ2210-ARG2
                   WHEN  CNS-KSN-YMD-DMN-KBN-1
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-21
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  CNS-KSN-YMD-DMN-KBN-2
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-22
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  OTHER
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  15           TO  WK-MIDDLE-FREE-COUNT
                 END-EVALUATE
                 PERFORM  M41-FREE-AREA-RTN
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":保有残マイナスフラグ2（市場通貨簿価）=["
      D             MINUS-SJTK-FLG-2    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分2=["
      D             KSN-YMD-DMN-KBN-2   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               INITIALIZE  WK-MIDDLE-FREE-MSG
                           WK-MIDDLE-FREE-COUNT
               IF  MINUS-SJTK-FLG-2     OF  PARM-SMZJ2210-ARG2 = CNS-1
               THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '簿価金額(市場通貨)'
                 MOVE  CNS-TK-MOJI-81
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                 EVALUATE  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
                   WHEN  CNS-KSN-YMD-DMN-KBN-1
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-21
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  CNS-KSN-YMD-DMN-KBN-2
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-22
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  OTHER
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  15             TO  WK-MIDDLE-FREE-COUNT
                 END-EVALUATE
                 PERFORM  M41-FREE-AREA-RTN
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":保有残マイナスフラグ2（運用通貨簿価）=["
      D             MINUS-UYTK-FLG-2    OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分2=["
      D             KSN-YMD-DMN-KBN-2   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               INITIALIZE  WK-MIDDLE-FREE-MSG
                           WK-MIDDLE-FREE-COUNT
               IF  MINUS-UYTK-FLG-2     OF  PARM-SMZJ2210-ARG2 = CNS-1
               THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '簿価金額(運用通貨)'
                 MOVE  CNS-TK-MOJI-82
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                 EVALUATE  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
                   WHEN  CNS-KSN-YMD-DMN-KBN-1
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-21
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  CNS-KSN-YMD-DMN-KBN-2
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-22
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  OTHER
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  15             TO  WK-MIDDLE-FREE-COUNT
                 END-EVALUATE
                 PERFORM  M41-FREE-AREA-RTN
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":保有残マイナスフラグ2（数量残高）=["
      D             MINUS-SRYZN-FLG-2   OF  PARM-SMZJ2210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":決算日断面区分2=["
      D             KSN-YMD-DMN-KBN-2   OF  PARM-SMZJ2210-ARG2"]"
      *-----------------------------------------------------------------
               INITIALIZE  WK-MIDDLE-FREE-MSG
                           WK-MIDDLE-FREE-COUNT
               IF  MINUS-SRYZN-FLG-2    OF  PARM-SMZJ2210-ARG2 = CNS-1
               THEN
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ← '数量残高'
                 MOVE  CNS-TK-MOJI-45
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
                 EVALUATE  KSN-YMD-DMN-KBN-2  OF  PARM-SMZJ2210-ARG2
                   WHEN  CNS-KSN-YMD-DMN-KBN-1
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-21
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  CNS-KSN-YMD-DMN-KBN-2
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03,
                             CNS-MSG-20,  CNS-MSG-22
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  36           TO  WK-MIDDLE-FREE-COUNT
                   WHEN  OTHER
                     STRING  CNS-MSG-13,  WK-KJN-YMD   OF  WK-TKMZBW03
                             DELIMITED  BY  SIZE
                       INTO  WK-MIDDLE-FREE-MSG
                     MOVE  15             TO  WK-MIDDLE-FREE-COUNT
                 END-EVALUATE
                 PERFORM  M41-FREE-AREA-RTN
               ELSE
                 CONTINUE
               END-IF
             WHEN  CNS-RTN-300
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M09のメッセージID
               MOVE  CNS-MSG-E000091
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
               PERFORM  LC-FREE-MSG-RTN
      *---------- 基準日別終了処理へ
               PERFORM  KJN-YMD-END-RTN
             WHEN  OTHER
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
               MOVE  CNS-POS-087        TO  WK-ERR-POS
               PERFORM  ERR-MSG-4-RTN
           END-EVALUATE
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ2210-EXT.
           EXIT.
      ******************************************************************
      *   4.2.8.仮払金未引落チェック
      ******************************************************************
       SPAY-HIKI-CHECK-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類=["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類２ =["
      D             WK-MEG-CD-SHRU2     OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄属性取得フラグ=["
      D             FLG-MEG-ZOK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨異動後仮払金残=["
      D             WK-SJTK-IDOG-SPAYZN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨異動後仮払金残=["
      D             WK-UYTK-IDOG-SPAYZN"]"
      *-----------------------------------------------------------------
      *---------- ワーク銘柄別断面情報.銘柄種類＝'1'
           IF  WK-MEG-CD-SHRU     OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-1
           AND WK-MEG-CD-SHRU2    OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-2
           AND FLG-MEG-ZOK                        = CNS-MEG-ZOK-1
           AND (WK-SJTK-IDOG-SPAYZN NOT = ZERO   OR
                WK-UYTK-IDOG-SPAYZN NOT = ZERO)
           THEN
      *---------- 4.2.8.仮払金未引落チェック
             PERFORM  SMZJ4020-RTN
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       SPAY-HIKI-CHECK-EXT.
           EXIT.
      ******************************************************************
      *    銘柄別メッセージ登録処理
      ******************************************************************
       MEG-LOGIN-RTN          SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別メッセージ登録処理"
      D            "  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7080-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7080-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7080-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7080-ARG1
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY7080-ARG1
      *---------- メッセージエリア ← ワークメッセージエリア
           MOVE  WK-MSG-AREA
             TO  MSG-AREA               OF  PARM-SCZY7080-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY7080-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":メッセージエリア=["
      *             MSG-AREA            OF  PARM-SCZY7080-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7080"             USING  PARM-SCZY7080-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7080)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワークメッセージエリアを初期化する
             INITIALIZE  WK-MSG-AREA
      *---------- ワークCounterA      ←  1
             MOVE  CNS-1                TO  WK-CounterA
      *-------------------<DEBUG>---------------------------------------
      *    DISPLAY  CNS-PGM-ID":ワークメッセージエリア =["WK-MSG-AREA"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             PERFORM  SUB-ERR-MSG-RTN
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-088            TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *---------- ワーク明細単位実行ステータス ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード ← '16'：システムエラー
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D             "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  銘柄別メッセージ登録処理"
      D             "  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       MEG-LOGIN-EXT.
           EXIT.
      ******************************************************************
      *    仮払金未引落チェック処理
      ******************************************************************
       SMZJ4020-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 仮払金未引落チェック処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4020-INOUT
                       PARM-RTNPKG
      *---------- 仮払金増加の取引存在フラグ
           MOVE  WK-SPAY-PLUS-TORI-FLG
             TO  SPAY-PLUS-TORI-FLG     OF  PARM-SMZJ4020-ARG1
      *---------- 仮払金増加の取引計上基準日
           MOVE  WK-SPAY-PLUS-TRKJ-KJB
             TO  SPAY-PLUS-TORI-KEIJOU-KIJUNBI
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 銘柄別断面情報:
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  TKMZBW03
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  TKMZBW02
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 銘柄属性:
      *---------- 初期利払起算日
           MOVE  WK-SHOKI-RB-KS-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-KS-YMD     OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 初期利払日
           MOVE  WK-SHOKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-YMD        OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 最終利払起算日
           MOVE  WK-LAST-RB-KS-YMD      OF  WK-MEG-ZOK-INFO
             TO  LAST-RIBAR-KISAN-YMD   OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 終期利払日
           MOVE  WK-SHUKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RIBAR-YMD        OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 利払回数
           MOVE  WK-RIBAR-KAISU         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-KAISU            OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 利払日１
           MOVE  WK-RIBAR-YMD-1         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-1            OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 利払日２
           MOVE  WK-RIBAR-YMD-2         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-2            OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 利払日３
           MOVE  WK-RIBAR-YMD-3         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-3            OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 利払日４
           MOVE  WK-RIBAR-YMD-4         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-4            OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *---------- 利払日数
           MOVE  WK-RIBAR-NISU          OF  WK-MEG-ZOK-INFO
             TO  KEKA-NISU              OF  MEG-ZOKUSEI-PARM
                                        OF  PARM-SMZJ4020-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":仮払金増加の取引存在フラグ=["
      D             SPAY-PLUS-TORI-FLG  OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仮払金増加の取引計上基準日=["
      D             SPAY-PLUS-TORI-KEIJOU-KIJUNBI
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報:"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード=["
      D             FUND-CD             OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
      D             PTF-CD              OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日=["
      D             KJN-YMD             OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             MEG-CD              OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":玉ID=["
      D             GYOKU-ID            OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":差分更新From日=["
      D             SABON-UPDATE-FROM   OF  TKMZBW03
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日=["
      D             KAISI-KJN-YMD-NEXT  OF  TKMZBW02
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性:"
      D    DISPLAY  CNS-PGM-ID":初期利払起算日=["
      D             SHOKI-RIBAR-KS-YMD  OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日=["
      D             SHOKI-RIBAR-YMD     OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":最終利払起算日=["
      D             LAST-RIBAR-KISAN-YMD OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日=["
      D             SHUKI-RIBAR-YMD     OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払回数=["
      D             RIBAR-KAISU         OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日１=["
      D             RIBAR-YMD-1         OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日２=["
      D             RIBAR-YMD-2         OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日３=["
      D             RIBAR-YMD-3         OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日４=["
      D             RIBAR-YMD-4         OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日数=["
      D             KEKA-NISU           OF  MEG-ZOKUSEI-PARM
      D                                 OF  PARM-SMZJ4020-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4020"             USING  PARM-SMZJ4020-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4020)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":リターンパッケージ.警告フラグ=["
      D             WARN-FLG            OF  PARM-SMZJ4020-ARG2"]"
      *-----------------------------------------------------------------
             IF  WARN-FLG               OF  PARM-SMZJ4020-ARG2
              =  CNS-WARN-FLG-1
             THEN
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M02のメッセージID
               MOVE  CNS-MSG-W000551
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- 'マイナス経過利息の仮払金'
               MOVE  CNS-TK-MOJI-42
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
               PERFORM  M02-FREE-MSG-RTN
             ELSE
               CONTINUE
             END-IF
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-089        TO  WK-ERR-POS
             PERFORM  ERR-MSG-4-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  仮払金未引落チェック処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4020-EXT.
           EXIT.
      ******************************************************************
      *   4.2.9.銘柄別断面情報データカーソルクローズ処理
      ******************************************************************
      * TKMZBW03-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  銘柄別断面情報データカーソル"
      *D             "クローズ 処理  START  ***"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *         CLOSE TKMZBW03_CURSOR
      *     END-EXEC
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *       MOVE  CNS-OFF              TO  FLG-TKMZBW03-CR-OPEN
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW03-CR-OPEN=["
      *D             FLG-TKMZBW03-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     ELSE
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQL処理エラー（CLOSE)"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-090          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-3         DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-2-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  銘柄別断面情報データカーソル"
      *D             "クローズ 処理 END  ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW03-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    ポートフォリオエラーメッセージへインサート
      ******************************************************************
       M2-FREE-AREA-RTN       SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------<DEBUG>--------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *-----------------------------------------------------------------
           CONTINUE.
       M2-FREE-AREA-EXT.
           EXIT.
      ******************************************************************
      *   4.2.6 ポートフォリオエラーメッセージへインサート
      ******************************************************************
       LC-FREE-MSG-RTN        SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
      *← '基準日：'ワーク銘柄別断面情報.基準日＋'銘柄：'ワーク銘柄コードリファレンス.外部銘柄コード
      *＋'証券種別：'ワーク銘柄別断面情報.証券種別＋'銘柄通貨：'ワーク銘柄コードリファレンス.銘柄通貨コード
      *＋'発行体国：'ワーク銘柄コードリファレンス.発行体国コード＋'投資対象国：'ワーク銘柄コードリファレンス.投資対象国コード
      *＋'株式種別：'ワーク銘柄コードリファレンス.株式種別＋'回：'ワーク銘柄コードリファレンス.回
      *＋'号：'ワーク銘柄コードリファレンス.号＋'限月：'ワーク銘柄コードリファレンス.限月
      *＋'ストライクプライス：'ワーク銘柄コードリファレンス.ストライクプライス＋'満期日：'ワーク銘柄コードリファレンス.満期日
      *＋'資産負債・買建売建フラグ：'ワーク銘柄別断面情報.資産負債・買建売建フラグ＋'玉ID：'ワーク銘柄別断面情報.玉ID
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-275
           THEN
             MOVE  CNS-MT-JS-275        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT6
           THEN
             MOVE  CNS-RTN-BT6          TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '275'(業務エラー(明細続行不可))
           MOVE  CNS-MT-JS-275
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           CONTINUE.
       LC-FREE-MSG-EXT.
           EXIT.
      ******************************************************************
      *   4.2.6 ポートフォリオエラーメッセージへインサート
      ******************************************************************
       LC-FR-MSG-1-RTN        SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
           MOVE  CNS-MT-JS-270        TO  WK-MT-JIKKOU-STATUS
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           MOVE  CNS-RTN-BT4          TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '270'(業務エラー（続行可能）)
           MOVE  CNS-MT-JS-270
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           CONTINUE.
       LC-FR-MSG-1-EXT.
           EXIT.
      ******************************************************************
      *   4.2.6 ポートフォリオエラーメッセージへインサート
      ******************************************************************
       LC-FREE-MSG-1-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
           THEN
             MOVE  CNS-MT-JS-200    TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT2
           THEN
             MOVE  CNS-RTN-BT2      TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           IF  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 < CNS-MT-JS-200
           THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '200'(警告終了)
             MOVE  CNS-MT-JS-200
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           CONTINUE.
       LC-FREE-MSG-1-EXT.
           EXIT.
      ******************************************************************
      *   4.2.6.1 ポートフォリオエラーメッセージへインサート
      ******************************************************************
       LC-FREE-MSG-2-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
      *← '基準日：'ワーク銘柄別断面情報.基準日＋'銘柄：'ワーク銘柄コードリファレンス.外部銘柄コード
      *＋'証券種別：'ワーク銘柄別断面情報.証券種別＋'銘柄通貨：'ワーク銘柄コードリファレンス.銘柄通貨コード
      *＋'発行体国：'ワーク銘柄コードリファレンス.発行体国コード＋'投資対象国：'ワーク銘柄コードリファレンス.投資対象国コード
      *＋'株式種別：'ワーク銘柄コードリファレンス.株式種別＋'/'ワーク銘柄コードリファレンス.回
      *＋'/'ワーク銘柄コードリファレンス.号＋'/'ワーク銘柄コードリファレンス.限月
      *＋'/'ワーク銘柄コードリファレンス.ストライクプライス＋'/'ワーク銘柄コードリファレンス.満期日
      *＋'Ｌ／Ｓ:'ワーク銘柄別断面情報.資産負債・買建売建フラグ＋'玉ID：'ワーク銘柄別断面情報.玉ID
           MOVE  WK-STRIKEPRICE         OF  WK-MEG-CD-REF
             TO  WK-STRIKEPRICE-M
           MOVE  WK-STRIKEPRICE-M       TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-270
           THEN
             MOVE  CNS-MT-JS-270        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT4
           THEN
             MOVE  CNS-RTN-BT4          TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           IF  WK-STK-STS-KJN-YMD       OF  WK-TKMZBW02 < CNS-MT-JS-270
           THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← ’270’(業務エラーLv1)
             MOVE  CNS-MT-JS-270
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           CONTINUE.
       LC-FREE-MSG-2-EXT.
           EXIT.
      ******************************************************************
      *   4.2.8 ポートフォリオエラーメッセージへインサート
      ******************************************************************
       M02-FREE-MSG-RTN       SECTION.
      *-----------------------------------------------------------------
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  WK-FUND-CD             OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  WK-PTF-CD              OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  WK-KJN-YMD-FROM        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
           MOVE  WK-SITEI-TO            OF  WK-DENBUN-KAISEKI-INFO
             TO  WK-KJN-YMD-TO          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
      *← '基準日：'ワーク銘柄別断面情報.基準日＋'銘柄：'ワーク銘柄コードリファレンス.外部銘柄コード
      *＋'証券種別：'ワーク銘柄別断面情報.証券種別＋'銘柄通貨：'ワーク銘柄コードリファレンス.銘柄通貨コード
      *＋'発行体国：'ワーク銘柄コードリファレンス.発行体国コード＋'投資対象国：'ワーク銘柄コードリファレンス.投資対象国コード
      *＋'株式種別：'ワーク銘柄コードリファレンス.株式種別＋'回：'ワーク銘柄コードリファレンス.回
      *＋'号：'ワーク銘柄コードリファレンス.号＋'限月：'ワーク銘柄コードリファレンス.限月
      *＋'ストライクプライス：'ワーク銘柄コードリファレンス.ストライクプライス＋'満期日：'ワーク銘柄コードリファレンス.満期日
      *＋'資産負債・買建売建フラグ：'ワーク銘柄別断面情報.資産負債・買建売建フラグ＋'玉ID：'ワーク銘柄別断面情報.玉ID
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
           STRING  CNS-MSG-13,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-14,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-15,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-16,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-17,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-18,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-19,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-26,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
           THEN
             MOVE  CNS-MT-JS-200        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT2
           THEN
             MOVE  CNS-RTN-BT2          TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 < CNS-MT-JS-200
           THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '200'(警告終了)
             MOVE  CNS-MT-JS-200
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           CONTINUE.
       M02-FREE-MSG-EXT.
           EXIT.
      ******************************************************************
      *    4.2.5.3 対象取引別処理 ループ処理
      ******************************************************************
       TARGET-TRHK-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象取引別処理 ループ処理 START ***"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類=["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
      *---------- ワーク銘柄別断面情報.銘柄種類＝'1'(物) OR '2'(元本)
           IF  WK-MEG-CD-SHRU     OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-1 OR
               WK-MEG-CD-SHRU     OF  WK-TKMZBW03 = CNS-MEG-CD-SHRU-2
           THEN
      *---------- 4.3.1 銘柄種類＝'1'(物) OR '2'(元本)の場合の処理
             PERFORM  MEG-CD-SHRU-RTN
      *---------- ワーク銘柄別断面情報.銘柄種類＝'3'(資金)
           ELSE
      *---------- 4.3.2 銘柄種類＝'3'(資金)の場合の処理
             PERFORM  MEG-CD-SHRU-3-RTN
      *---------- 上記以外
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引別処理 ループ処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TARGET-TRHK-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1 銘柄種類＝'1'(物) OR '2'(元本)の場合の処理
      ******************************************************************
       MEG-CD-SHRU-RTN        SECTION.
      *-----------------------------------------------------------------
      *---------- 4.3.1.1 対象取引情報データを取得
           PERFORM  TKMZBW04-GET-RTN
           MOVE  CNS-OFF                TO  FLG-FETCH-SYUURYOU3
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU3=["
      D             FLG-FETCH-SYUURYOU3"]"
      *-----------------------------------------------------------------
           PERFORM  UNTIL  FLG-FETCH-SYUURYOU3 = CNS-ON
                       OR  FLG-PTF = CNS-ON
      *---------- 4.3.1.2 対象取引情報データカーソルフェッチ
             PERFORM  TKMZBW04-FET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU3=["
      D             FLG-FETCH-SYUURYOU3"]"
      *-----------------------------------------------------------------
             IF  FLG-FETCH-SYUURYOU3 = CNS-ON
             THEN
               CONTINUE
             ELSE
      *---------- 4.3.1.3.取引取得
               PERFORM  TRHK-GET-RTN
      *---------- 4.3.1.4.ワーク対象取引情報.処理順＝1の場合、直前異動セット
               PERFORM  TZ-IDO-ASSET-RTN
      *---------- 4.3.1.5.ワーク銘柄別断面情報.銘柄種類＝'1'(物)の場合 売り続く限りフラグ設定処理
               IF  WK-MEG-CD-SHRU  OF  WK-TKMZBW03  =  CNS-MEG-CD-SHRU-1
               THEN
                 PERFORM  UTK-KAGI-SET-RTN
               ELSE
                 CONTINUE
               END-IF
      *---------- 4.3.1.6.異動簿価・損益計算（物）
               PERFORM  SMZJ1910-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-SMZJ1910-160=["FLG-SMZJ1910-160"]"
      *-----------------------------------------------------------------
               IF  FLG-SMZJ1910-160 = CNS-1
               THEN
                 CONTINUE
               ELSE
      *---------- 4.3.1.7.直前異動セット
                 PERFORM  TZ-IDO-CALC-EDIT-RTN
      *---------- 4.3.1.8.ワーク取引件数＝1 且つ
      *ワーク再処理基準日FROM＞ワーク直前残高異動.計上基準日の場合、
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引件数=["WK-TRHK-KENSU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク再処理基準日FROM=["
      D                         WK-REDO-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動.計上基準日=["
      D                         KEIJOU-KIJUNBI OF WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
                 IF  WK-TRHK-KENSU = CNS-1 AND
                   WK-REDO-KJN-YMD-FROM > KEIJOU-KIJUNBI OF WK-TZ-ZN-IDO
                 THEN
                   MOVE  KEIJOU-KIJUNBI OF WK-TZ-ZN-IDO
                     TO  WK-REDO-KJN-YMD-FROM
                 ELSE
                   CONTINUE
                 END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク再処理基準日FROM=["
      D                         WK-REDO-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動.計上基準日=["
      D                         KEIJOU-KIJUNBI OF WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
               END-IF
             END-IF
           END-PERFORM
           IF  FLG-PTF = CNS-ON
           THEN
             CONTINUE
           ELSE
      *---------- 4.3.1.7.対象取引情報データカーソルクローズ処理
      ***    PERFORM  TKMZBW04-CLOSE-RTN                                @SEINO@@
      *---------- 4.3.1.8 ワーク取引存在フラグ編集
             PERFORM  TRHK-SZ-FLG-EDIT-RTN
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       MEG-CD-SHRU-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.1対象取引情報データを取得
      ******************************************************************
       TKMZBW04-GET-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引情報データを取得 処理"
      D            "  START  ***"
      *-----------------------------------------------------------------
      *-----------  カーソル定義処理
           PERFORM  TKMZBW04-DEC-RTN
      *-----------  カーソルオープン処理
           PERFORM  TKMZBW04-OPEN-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象取引情報データを取得 処理"
      D             " END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW04-GET-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKMZBW04-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  H-SYORI-YMD            OF  H-TKMZBW04-S,
                 WK-SYORI-YMD-S         OF  WK-MSG-1-4
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  H-KIDOU-ID             OF  H-TKMZBW04-S,
                 WK-KIDOU-ID-S          OF  WK-MSG-1-4
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW04-S,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-4
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZBW04-S,
                 WK-FUND-CD-S           OF  WK-MSG-1-4
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZBW04-S,
                 WK-PTF-CD-S            OF  WK-MSG-1-4
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMZBW04-S,
                 WK-KJN-YMD-S           OF  WK-MSG-1-4
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-MEG-CD               OF  H-TKMZBW04-S,
                 WK-MEG-CD-S            OF  WK-MSG-1-4
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  H-SEC-SBT-CD           OF  H-TKMZBW04-S,
                 WK-SEC-SBT-CD-S        OF  WK-MSG-1-4
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  H-TATE-FLG             OF  H-TKMZBW04-S,
                 WK-TATE-FLG-S          OF  WK-MSG-1-4
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  H-GYOKU-ID             OF  H-TKMZBW04-S,
                 WK-GYOKU-ID-S          OF  WK-MSG-1-4
      *---------- テーブルID
           MOVE  WK-TBL-TKMZBW04
             TO  SQL-TKMZBW04           OF  SQL-SELECT-1-4,
                 WK-TKMZBW04            OF  WK-MSG-1-4
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             H-SYORI-YMD         OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             H-KIDOU-ID          OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             H-PTF-CD            OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             H-KJN-YMD           OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             H-MEG-CD            OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             H-SEC-SBT-CD        OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             H-TATE-FLG          OF  H-TKMZBW04-S"]"
      D    DISPLAY  CNS-PGM-ID":玉ID=["
      D             H-GYOKU-ID          OF  H-TKMZBW04-S"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT4                                         @3212SEINO@@
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-4         TO  SQLSTMT4
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT4=["SQLSTMT4"]"                  @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW04-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMZBW04-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZBW04-CR-OPEN  NOT = CNS-ON                       @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
               PREPARE  S4  FROM :SQLSTMT4                              @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-091          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-4         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
           EXEC  SQL
               DECLARE  TKMZBW04_CURSOR  CURSOR  FOR  S4
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW04-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKMZBW04-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKMZBW04_CURSOR
                 USING :H-TKMZBW04-S.H-SYORI-YMD,
                       :H-TKMZBW04-S.H-KIDOU-ID,
                       :H-TKMZBW04-S.H-RIYO-CMP-CD,
                       :H-TKMZBW04-S.H-FUND-CD,
                       :H-TKMZBW04-S.H-PTF-CD,
                       :H-TKMZBW04-S.H-KJN-YMD,
                       :H-TKMZBW04-S.H-MEG-CD,
                       :H-TKMZBW04-S.H-SEC-SBT-CD,
                       :H-TKMZBW04-S.H-TATE-FLG,
                       :H-TKMZBW04-S.H-GYOKU-ID
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZBW04-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW04-CR-OPEN=["
      D             FLG-TKMZBW04-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-092          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-4         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW04-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.2 対象取引情報データカーソルフェッチ
      ******************************************************************
       TKMZBW04-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象取引情報データカーソルフェッチ"
      D             "処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMZBW04-4
           EXEC  SQL
               FETCH
                    TKMZBW04_CURSOR
               INTO :H-TKMZBW04-4.H-TORI-ID,
                    :H-TKMZBW04-4.H-UKE-YMD,
                    :H-TKMZBW04-4.H-KEIJOU-KIJUNBI,
                    :H-TKMZBW04-4.H-ZOFKU-AKA-KBN,
                    :H-TKMZBW04-4.H-ZOFKU-KBN,
                    :H-TKMZBW04-4.H-ZOFKUMT-KJ-KIJUNBI,
                    :H-TKMZBW04-4.H-SRJUN
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
      *---------- 1)ワーク対象取引情報を初期化
      *---------- ワーク相対取引データを初期化する。
      *---------- ワーク取引事由を初期化する。
      *---------- ワーク市場通貨払出単価を初期化する。
      *---------- ワーク運用通貨払出単価を初期化する。
               INITIALIZE  WK-TARGET-TORI-INFO
                           WK-AITAI-TRHK-DATA
                           WK-TRI-JIYU-K
                           WK-SJTK-H-TNK
                           WK-UYTK-H-TNK
      *---------- ワークデータなしフラグ
               MOVE  ZERO               TO  WK-DATA-NASI-FLG
      *---------- ワークメッセージ種類
               MOVE  ZERO               TO  WK-MSG-SYO
      *---------- ワーク取引件数 ← ワーク取引件数＋1
               COMPUTE  WK-TRHK-KENSU = WK-TRHK-KENSU + CNS-1
      *---------- ワーク売り続く限りフラグ ←'0'(NO)
               MOVE  CNS-UTK-KAGI-FLG-0 TO  WK-URI-TUDUKU-KAGI-FLG
      *---------- ワーク対象取引情報.原取引ID   ←     「別紙1-4 SQL説明」.原取引ID
               MOVE  H-TORI-ID          OF  H-TKMZBW04-4
                 TO  WK-TORI-ID         OF  WK-TARGET-TORI-INFO
      *---------- ワーク対象取引情報.受渡日     ←  「別紙1-4 SQL説明」.受渡日
               MOVE  H-UKE-YMD          OF  H-TKMZBW04-4
                 TO  WK-UKE-YMD         OF  WK-TARGET-TORI-INFO
      *---------- ワーク対象取引情報.計上基準日 ←     「別紙1-4 SQL説明」.計上基準日
               MOVE  H-KEIJOU-KIJUNBI   OF  H-TKMZBW04-4
                 TO  WK-KEIJOU-KIJUNBI  OF  WK-TARGET-TORI-INFO
      *---------- ワーク対象取引情報.増幅赤黒区分 ←     「別紙1-4 SQL説明」.増幅赤黒区分
               MOVE  H-ZOFKU-AKA-KBN    OF  H-TKMZBW04-4
                 TO  WK-ZOFKU-AKA-KBN   OF  WK-TARGET-TORI-INFO
      *---------- ワーク対象取引情報.増幅区分 ← 「別紙1-4 SQL説明」.増幅区分
               MOVE  H-ZOFKU-KBN        OF  H-TKMZBW04-4
                 TO  WK-ZOFKU-KBN       OF  WK-TARGET-TORI-INFO
      *---------- ワーク対象取引情報.増幅元異動計上基準日 ← 「別紙1-4 SQL説明」.増幅元異動計上基準日
               MOVE  H-ZOFKUMT-KJ-KIJUNBI
                                        OF  H-TKMZBW04-4
                 TO  WK-ZOFKUMT-KJ-KJN  OF  WK-TARGET-TORI-INFO
      *---------- ワーク対象取引情報.処理順 ← 「別紙1-4 SQL説明」.処理順
               MOVE  H-SRJUN            OF  H-TKMZBW04-4
                 TO  WK-SRJUN           OF  WK-TARGET-TORI-INFO
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク相対取引データ =["
      D                                         WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引事由 =["WK-TRI-JIYU-K"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨払出単価 =["
      D             WK-SJTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨払出単価 =["
      D             WK-UYTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ =["
      D             WK-DATA-NASI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワークメッセージ種類 =["WK-MSG-SYO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引件数 =["WK-TRHK-KENSU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く限りフラグ=["
      D             WK-URI-TUDUKU-KAGI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.原取引ID =["
      D             WK-TORI-ID          OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.受渡日   =["
      D             WK-UKE-YMD          OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.計上基準日 =["
      D             WK-KEIJOU-KIJUNBI   OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.増幅赤黒区分 =["
      D             WK-ZOFKU-AKA-KBN    OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.増幅区分 =["
      D             WK-ZOFKU-KBN        OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.増幅元異動計上基準日"
      D         "=["WK-ZOFKUMT-KJ-KJN   OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.処理順 =["
      D             WK-SRJUN            OF  WK-TARGET-TORI-INFO"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
               MOVE  CNS-ON             TO  FLG-FETCH-SYUURYOU3
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU3=["
      D             FLG-FETCH-SYUURYOU3"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-093        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-4       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-2-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象取引情報データカーソルフェッチ"
      D             "処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW04-FET-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.3.取引取得
      ******************************************************************
       TRHK-GET-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引取得 処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 4.3.1.3.1.取引データを取得
           PERFORM  TRHK-DATA-GET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引データ.商品別取引区分 =["
      D             WK-SHB-TORI-KBN     OF  WK-TRHK-DATA"]"
      *-----------------------------------------------------------------
      *---------- 4.3.1.3.3.換算後為替レート(市場／運用)取得処理
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク乗算/除算区分 =["WK-JZ-JS-KBN"]"
      *-----------------------------------------------------------------
           IF  WK-JZ-JS-KBN = CNS-JZ-JS-KBN-1
           THEN
      *---------- ワーク対象取引情報.換算後為替レート(市場／運用) ← ワーク取引データ.為替レート（市場／運用）
             MOVE  WK-S-U-KWS           OF  WK-TRHK-DATA
               TO  WK-K-S-U-KWS         OF  WK-TARGET-TORI-INFO
      *---------- ワーク対象取引情報.換算後経過利息為替レート← ワーク取引データ.経過利息為替レート
             MOVE  WK-KEKA-RSK-KWS      OF  WK-TRHK-DATA
               TO  WK-KKRS-KWS          OF  WK-TARGET-TORI-INFO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.換算後為替レート"
      D             "(市場／運用)=["
      D             WK-K-S-U-KWS        OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報."
      D             "換算後経過利息為替レート=["
      D             WK-KKRS-KWS         OF  WK-TARGET-TORI-INFO"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- 1)ワーク対象取引情報.換算後為替レート(市場／運用) ← 1/ワーク取引データ.為替レート（市場／運用）
             COMPUTE  WK-K-S-U-KWS      OF  WK-TARGET-TORI-INFO
                   =  CNS-1 /
                      WK-S-U-KWS        OF  WK-TRHK-DATA
      *---------- 2)ワーク取引データ.経過利息為替レート≠0の場合
             IF  WK-KEKA-RSK-KWS        OF  WK-TRHK-DATA
             NOT = ZERO
             THEN
      *---------- ワーク対象取引情報.換算後経過利息為替レート ←  1/ワーク取引データ.経過利息為替レート
               COMPUTE  WK-KKRS-KWS     OF  WK-TARGET-TORI-INFO
                   =  CNS-1 /
                      WK-KEKA-RSK-KWS   OF  WK-TRHK-DATA
             ELSE
               CONTINUE
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.換算後為替レート"
      D             "(市場／運用) =["
      D             WK-K-S-U-KWS        OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報."
      D             "換算後経過利息為替レート=["
      D             WK-KKRS-KWS         OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":*** 取引取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       TRHK-GET-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.3.1.取引データを取得
      ******************************************************************
       TRHK-DATA-GET-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引データを取得 処理 START  ***"
      *-----------------------------------------------------------------
      *----------  カーソル定義処理
           PERFORM  TKMXTR00-DEC-RTN
      *----------  カーソルオープン処理
           PERFORM  TKMXTR00-OPEN-RTN
      *----------  取引 FETCH 処理
           PERFORM  TKMXTR00-FET-RTN
      *----------  取引 CURSOR CLOSE 処理
      *    PERFORM  TKMXTR00-CLOSE-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引データを取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       TRHK-DATA-GET-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKMXTR00-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMXTR00-S,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-8
      *---------- 原取引ＩＤ
           MOVE  WK-TORI-ID             OF  WK-TARGET-TORI-INFO
             TO  H-TORI-ID              OF  H-TKMXTR00-S,
                 WK-TORI-ID-S           OF  WK-MSG-1-8
      *---------- テーブルID
           MOVE  WK-TBL-TKMXTR00
             TO  SQL-TKMXTR00           OF  SQL-SELECT-1-8,
                 WK-TKMXTR00            OF  WK-MSG-1-8
           MOVE  WK-TBL-TKMXTR01
             TO  SQL-TKMXTR01           OF  SQL-SELECT-1-8,
                 WK-TKMXTR01            OF  WK-MSG-1-8
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMXTR00-S"]"
      D    DISPLAY  CNS-PGM-ID":原取引ＩＤ =["
      D             H-TORI-ID           OF  H-TKMXTR00-S"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT8                                         @3212SEINO@@
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-8         TO  SQLSTMT8                    @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT8=["SQLSTMT8"]"                  @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMXTR00-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMXTR00-CR-OPEN  NOT =  CNS-ON                      @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
               PREPARE  S8  FROM :SQLSTMT8                              @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-094          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-8         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
           EXEC  SQL  DECLARE  TKMXTR00_CURSOR  CURSOR  FOR  S8 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
           CONTINUE.
       TKMXTR00-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKMXTR00-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKMXTR00_CURSOR
                 USING :H-TKMXTR00-S.H-RIYO-CMP-CD,
                       :H-TKMXTR00-S.H-TORI-ID
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMXTR00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["
      D             FLG-TKMXTR00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-095          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-8         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMXTR00-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    取引 FETCH 処理
      ******************************************************************
       TKMXTR00-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 取引 FETCH 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMXTR00-8
                                        H-TKMXTR01-8
           EXEC  SQL
               FETCH
                    TKMXTR00_CURSOR
               INTO :H-TKMXTR00-8,
                    :H-TKMXTR01-8
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
      *---------- 1)ワーク取引データを初期化
             INITIALIZE  WK-TRHK-DATA
      *---------- 利用会社コード
             MOVE  H-RIYO-CMP-CD        OF  H-TKMXTR00-8
               TO  WK-RIYO-CMP-CD       OF  WK-TRHK-DATA
      *---------- 原取引ID
             MOVE  H-TORI-ID            OF  H-TKMXTR00-8
               TO  WK-TORI-ID           OF  WK-TRHK-DATA
      *---------- ファンドコード
             MOVE  H-FUND-CD            OF  H-TKMXTR00-8
               TO  WK-FUND-CD           OF  WK-TRHK-DATA
      *---------- ポートフォリオコード
             MOVE  H-PTF-CD             OF  H-TKMXTR00-8
               TO  WK-PTF-CD            OF  WK-TRHK-DATA
      *---------- 銘柄コード
             MOVE  H-MEG-CD             OF  H-TKMXTR00-8
               TO  WK-MEG-CD            OF  WK-TRHK-DATA
      *---------- 証券種別コード
             MOVE  H-SEC-SBT-CD         OF  H-TKMXTR00-8
               TO  WK-SEC-SBT-CD        OF  WK-TRHK-DATA
      *---------- 玉ID
             MOVE  H-GYOKU-ID           OF  H-TKMXTR00-8
               TO  WK-GYOKU-ID          OF  WK-TRHK-DATA
      *---------- 保有目的
             MOVE  H-POSSESSION-OBJECT  OF  H-TKMXTR00-8
               TO  WK-POSSESSION-OBJECT OF  WK-TRHK-DATA
      *---------- 取引連関ＩＤ
             MOVE  H-THRK-ID            OF  H-TKMXTR00-8
               TO  WK-THRK-ID           OF  WK-TRHK-DATA
      *---------- ダミー区分
             MOVE  H-DUMMY-KBN          OF  H-TKMXTR00-8
               TO  WK-DUMMY-KBN         OF  WK-TRHK-DATA
      *---------- 約定日
             MOVE  H-YKJ-YMD            OF  H-TKMXTR00-8
               TO  WK-YKJ-YMD           OF  WK-TRHK-DATA
      *---------- 受渡日
             MOVE  H-UKE-YMD            OF  H-TKMXTR00-8
               TO  WK-UKE-YMD           OF  WK-TRHK-DATA
      *---------- 取引内容
             MOVE  H-TORI-NAIY          OF  H-TKMXTR00-8
               TO  WK-TORI-NAIY         OF  WK-TRHK-DATA
      *---------- 取引事由
             MOVE  H-TORI-JIYU          OF  H-TKMXTR00-8
               TO  WK-TORI-JIYU         OF  WK-TRHK-DATA
      *---------- 資金決済方法
             MOVE  H-KESAI-HOHO         OF  H-TKMXTR00-8
               TO  WK-KESAI-HOHO        OF  WK-TRHK-DATA
      *---------- 異動数量
             MOVE  H-IDO-SURYO          OF  H-TKMXTR00-8
               TO  WK-IDO-SURYO         OF  WK-TRHK-DATA
      *---------- 権利数量
             MOVE  H-KENRI-SURYO        OF  H-TKMXTR00-8
               TO  WK-KENRI-SURYO       OF  WK-TRHK-DATA
      *---------- 数量単位
             MOVE  H-SURYO-TANI         OF  H-TKMXTR00-8
               TO  WK-SURYO-TANI        OF  WK-TRHK-DATA
      *---------- 市場通貨コード
             MOVE  H-SIJO-TUKA-CD       OF  H-TKMXTR00-8
               TO  WK-SIJO-TUKA-CD      OF  WK-TRHK-DATA
      *---------- 現地通貨コード
             MOVE  H-G-TUKA-CD          OF  H-TKMXTR00-8
               TO  WK-G-TUKA-CD         OF  WK-TRHK-DATA
      *---------- 為替レート（現地／運用）１
             MOVE  H-G-U-KWS1           OF  H-TKMXTR00-8
               TO  WK-G-U-KWS1          OF  WK-TRHK-DATA
      *---------- 為替レート（現地／運用）２
             MOVE  H-G-U-KWS2           OF  H-TKMXTR00-8
               TO  WK-G-U-KWS2          OF  WK-TRHK-DATA
      *---------- 為替レート（現地／市場）
             MOVE  H-G-S-KWS            OF  H-TKMXTR00-8
               TO  WK-G-S-KWS           OF  WK-TRHK-DATA
      *---------- 為替レート（市場／運用）
             MOVE  H-S-U-KWS            OF  H-TKMXTR00-8
               TO  WK-S-U-KWS           OF  WK-TRHK-DATA
      *---------- 円レート（現地／円）
             MOVE  H-G-YEN-KWS          OF  H-TKMXTR00-8
               TO  WK-G-YEN-KWS         OF  WK-TRHK-DATA
      *---------- 経過利息為替レート
             MOVE  H-KEKA-RSK-KWS       OF  H-TKMXTR00-8
               TO  WK-KEKA-RSK-KWS      OF  WK-TRHK-DATA
      *---------- 約定金額（運用通貨換算額）
             MOVE  H-U-KSG-G-YJKG       OF  H-TKMXTR00-8
               TO  WK-U-KSG-G-YJKG      OF  WK-TRHK-DATA
      *---------- 現地手数料（運用通貨換算額）
             MOVE  H-U-KSG-G-TSR        OF  H-TKMXTR00-8
               TO  WK-U-KSG-G-TSR       OF  WK-TRHK-DATA
      *---------- 現地消費税（運用通貨換算額）
             MOVE  H-U-KSG-G-SHZ        OF  H-TKMXTR00-8
               TO  WK-U-KSG-G-SHZ       OF  WK-TRHK-DATA
      *---------- 現地その他費用（運用通貨換算額）
             MOVE  H-U-KSG-G-THY        OF  H-TKMXTR00-8
               TO  WK-U-KSG-G-THY       OF  WK-TRHK-DATA
      *---------- 現地源泉税（運用通貨換算額）
             MOVE  H-U-KSG-G-GSZ        OF  H-TKMXTR00-8
               TO  WK-U-KSG-G-GSZ       OF  WK-TRHK-DATA
      *---------- 既経過利息（運用通貨換算額）
             MOVE  H-U-KSG-G-KKKRS      OF  H-TKMXTR00-8
               TO  WK-U-KSG-G-KKKRS     OF  WK-TRHK-DATA
      *---------- 日歩（運用通貨換算額）
             MOVE  H-U-KSG-HIBU         OF  H-TKMXTR00-8
               TO  WK-U-KSG-HIBU        OF  WK-TRHK-DATA
      *---------- 逆日歩（運用通貨換算額）
             MOVE  H-U-KSG-GHIBU        OF  H-TKMXTR00-8
               TO  WK-U-KSG-GHIBU       OF  WK-TRHK-DATA
      *---------- 管理費（運用通貨換算額）
             MOVE  H-U-KSG-KRH          OF  H-TKMXTR00-8
               TO  WK-U-KSG-KRH         OF  WK-TRHK-DATA
      *---------- 管理費消費税（運用通貨換算額）
             MOVE  H-U-KSG-KRH-SHZ      OF  H-TKMXTR00-8
               TO  WK-U-KSG-KRH-SHZ     OF  WK-TRHK-DATA
      *---------- 運用国手数料（運用通貨換算額）
             MOVE  H-U-KSG-U-TSR        OF  H-TKMXTR00-8
               TO  WK-U-KSG-U-TSR       OF  WK-TRHK-DATA
      *---------- 運用国消費税（運用通貨換算額）
             MOVE  H-U-KSG-U-SHZ        OF  H-TKMXTR00-8
               TO  WK-U-KSG-U-SHZ       OF  WK-TRHK-DATA
      *---------- 運用国その他費用（運用通貨換算額）
             MOVE  H-U-KSG-U-THY        OF  H-TKMXTR00-8
               TO  WK-U-KSG-U-THY       OF  WK-TRHK-DATA
      *---------- 国内源泉税（運用通貨換算額）
             MOVE  H-NAI-TAX-U-KSG      OF  H-TKMXTR00-8
               TO  WK-NAI-TAX-U-KSG     OF  WK-TRHK-DATA
      *---------- 精算金額（運用通貨換算額）
             MOVE  H-U-KSG-G-SSKG       OF  H-TKMXTR00-8
               TO  WK-U-KSG-G-SSKG      OF  WK-TRHK-DATA
      *---------- 入出金額（約定レート・運用通貨換算額）
             MOVE  H-NSKG-Y-UY          OF  H-TKMXTR00-8
               TO  WK-NSKG-Y-UY         OF  WK-TRHK-DATA
      *---------- 入出金額（決済レート・運用通貨換算額）
             MOVE  H-NSKG-K-UY          OF  H-TKMXTR00-8
               TO  WK-NSKG-K-UY         OF  WK-TRHK-DATA
      *---------- 為替差損益
             MOVE  H-UYTK-KWS-SNEKI     OF  H-TKMXTR00-8
               TO  WK-UYTK-KWS-SNEKI    OF  WK-TRHK-DATA
      *---------- 約定金額（市場通貨換算額）
             MOVE  H-S-KSG-G-YJKG       OF  H-TKMXTR00-8
               TO  WK-S-KSG-G-YJKG      OF  WK-TRHK-DATA
      *---------- 現地手数料（市場通貨換算額）
             MOVE  H-S-KSG-G-TSR        OF  H-TKMXTR00-8
               TO  WK-S-KSG-G-TSR       OF  WK-TRHK-DATA
      *---------- 現地消費税（市場通貨換算額）
             MOVE  H-S-KSG-G-SHZ        OF  H-TKMXTR00-8
               TO  WK-S-KSG-G-SHZ       OF  WK-TRHK-DATA
      *---------- 現地その他費用（市場通貨換算額）
             MOVE  H-S-KSG-G-THY        OF  H-TKMXTR00-8
               TO  WK-S-KSG-G-THY       OF  WK-TRHK-DATA
      *---------- 現地源泉税（市場通貨換算額）
             MOVE  H-S-KSG-G-GSZ        OF  H-TKMXTR00-8
               TO  WK-S-KSG-G-GSZ       OF  WK-TRHK-DATA
      *---------- 既経過利息（市場通貨換算額）
             MOVE  H-S-KSG-G-KKKRS      OF  H-TKMXTR00-8
               TO  WK-S-KSG-G-KKKRS     OF  WK-TRHK-DATA
      *---------- 日歩（市場通貨換算額）
             MOVE  H-S-KSG-HIBU         OF  H-TKMXTR00-8
               TO  WK-S-KSG-HIBU        OF  WK-TRHK-DATA
      *---------- 逆日歩（市場通貨換算額）
             MOVE  H-S-KSG-GHIBU        OF  H-TKMXTR00-8
               TO  WK-S-KSG-GHIBU       OF  WK-TRHK-DATA
      *---------- 管理費（市場通貨換算額）
             MOVE  H-S-KSG-KRH          OF  H-TKMXTR00-8
               TO  WK-S-KSG-KRH         OF  WK-TRHK-DATA
      *---------- 管理費消費税（市場通貨換算額）
             MOVE  H-S-KSG-KRH-SHZ      OF  H-TKMXTR00-8
               TO  WK-S-KSG-KRH-SHZ     OF  WK-TRHK-DATA
      *---------- 運用国手数料（市場通貨換算額）
             MOVE  H-S-KSG-U-TSR        OF  H-TKMXTR00-8
               TO  WK-S-KSG-U-TSR       OF  WK-TRHK-DATA
      *---------- 運用国消費税（市場通貨換算額）
             MOVE  H-S-KSG-U-SHZ        OF  H-TKMXTR00-8
               TO  WK-S-KSG-U-SHZ       OF  WK-TRHK-DATA
      *---------- 運用国その他費用（市場通貨換算額）
             MOVE  H-S-KSG-U-THY        OF  H-TKMXTR00-8
               TO  WK-S-KSG-U-THY       OF  WK-TRHK-DATA
      *---------- 国内源泉税（市場通貨換算額）
             MOVE  H-S-KSG-U-GSZ        OF  H-TKMXTR00-8
               TO  WK-S-KSG-U-GSZ       OF  WK-TRHK-DATA
      *---------- 精算金額（市場通貨換算額）
             MOVE  H-S-KSG-SSKG         OF  H-TKMXTR00-8
               TO  WK-S-KSG-SSKG        OF  WK-TRHK-DATA
      *---------- 決済口座１
             MOVE  H-KOZA1-NO           OF  H-TKMXTR00-8
               TO  WK-KOZA1-NO          OF  WK-TRHK-DATA
      *---------- 決済口座１通貨コード
             MOVE  H-KOZA1-TUKA-CD      OF  H-TKMXTR00-8
               TO  WK-KOZA1-TUKA-CD     OF  WK-TRHK-DATA
      *---------- 決済口座１入出金額
             MOVE  H-KOZA1-NSKG         OF  H-TKMXTR00-8
               TO  WK-KOZA1-NSKG        OF  WK-TRHK-DATA
      *---------- 決済口座１入出金額（運用通貨換算額）
             MOVE  H-KOZA1-U-KSG-NSKG   OF  H-TKMXTR00-8
               TO  WK-KOZA1-U-KSG-NSKG  OF  WK-TRHK-DATA
      *---------- 決済口座２
             MOVE  H-KOZA2-NO           OF  H-TKMXTR00-8
               TO  WK-KOZA2-NO          OF  WK-TRHK-DATA
      *---------- 決済口座２通貨コード
             MOVE  H-KOZA2-TUKA-CD      OF  H-TKMXTR00-8
               TO  WK-KOZA2-TUKA-CD     OF  WK-TRHK-DATA
      *---------- 決済口座２入出金額
             MOVE  H-KOZA2-NSKG         OF  H-TKMXTR00-8
               TO  WK-KOZA2-NSKG        OF  WK-TRHK-DATA
      *---------- 決済口座２入出金額（運用通貨換算額）
             MOVE  H-KOZA2-U-KSG-NSKG   OF  H-TKMXTR00-8
               TO  WK-KOZA2-U-KSG-NSKG  OF  WK-TRHK-DATA
      *---------- 還付予定額
             MOVE  H-KANP-YOTEGK        OF  H-TKMXTR00-8
               TO  WK-KANP-YOTEGK       OF  WK-TRHK-DATA
      *---------- 調整損益
             MOVE  H-CHOSEI-SNEKI       OF  H-TKMXTR00-8
               TO  WK-CHOSEI-SNEKI      OF  WK-TRHK-DATA
      *---------- 経過利息区分
             MOVE  H-KKRS-KBN           OF  H-TKMXTR00-8
               TO  WK-KKRS-KBN          OF  WK-TRHK-DATA
      *---------- 効力発生日
             MOVE  H-KOURYOKU-YMD       OF  H-TKMXTR00-8
               TO  WK-KOURYOKU-YMD      OF  WK-TRHK-DATA
      *---------- スタート日（放出日）
             MOVE  H-ST-YMD             OF  H-TKMXTR00-8
               TO  WK-ST-YMD            OF  WK-TRHK-DATA
      *---------- 約定ベースエンド日
             MOVE  H-YKJ-END-YMD        OF  H-TKMXTR00-8
               TO  WK-YKJ-END-YMD       OF  WK-TRHK-DATA
      *---------- 受渡ベースエンド日
             MOVE  H-UKE-END-YMD        OF  H-TKMXTR00-8
               TO  WK-UKE-END-YMD       OF  WK-TRHK-DATA
      *---------- 運用日数
             MOVE  H-UNYO-NISU          OF  H-TKMXTR00-8
               TO  WK-UNYO-NISU         OF  WK-TRHK-DATA
      *---------- 受取利息金額
             MOVE  H-UKETR-RSK-KG       OF  H-TKMXTR00-8
               TO  WK-UKETR-RSK-KG      OF  WK-TRHK-DATA
      *---------- 商品別取引区分
             MOVE  H-SHB-TORI-KBN       OF  H-TKMXTR00-8
               TO  WK-SHB-TORI-KBN      OF  WK-TRHK-DATA
      *---------- 異動確定区分
             MOVE  H-IDO-KBN            OF  H-TKMXTR00-8
               TO  WK-IDO-KBN           OF  WK-TRHK-DATA
      *---------- １口注文ＩＤ
             MOVE  H-ORDR-1K-ID         OF  H-TKMXTR00-8
               TO  WK-ORDR-1K-ID        OF  WK-TRHK-DATA
      *---------- 対象取引ＩＤ
             MOVE  H-TARGET-TORI-ID     OF  H-TKMXTR00-8
               TO  WK-TARGET-TORI-ID    OF  WK-TRHK-DATA
      *---------- 現地ブローカー
             MOVE  H-G-BRK              OF  H-TKMXTR00-8
               TO  WK-G-BRK             OF  WK-TRHK-DATA
      *---------- 資産負債・買建売建フラグ
             MOVE  H-TATE-FLG           OF  H-TKMXTR00-8
               TO  WK-TATE-FLG          OF  WK-TRHK-DATA
      *---------- 投資対象国コード
             MOVE  H-TSTSK-CD           OF  H-TKMXTR00-8
               TO  WK-TSTSK-CD          OF  WK-TRHK-DATA
      *---------- 発行国コード
             MOVE  H-HAKO-CD            OF  H-TKMXTR00-8
               TO  WK-HAKO-CD           OF  WK-TRHK-DATA
      *---------- 約定金額
             MOVE  H-G-YJKG             OF  H-TKMXTR00-8
               TO  WK-G-YJKG            OF  WK-TRHK-DATA
      *---------- 約定単価
             MOVE  H-YKJ-TANKA          OF  H-TKMXTR00-8
               TO  WK-YKJ-TANKA         OF  WK-TRHK-DATA
      *---------- 現地入出金額
             MOVE  H-G-NSKG             OF  H-TKMXTR00-8
               TO  WK-G-NSKG            OF  WK-TRHK-DATA
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             WK-RIYO-CMP-CD      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID=["
      D             WK-TORI-ID          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             WK-MEG-CD           OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             WK-SEC-SBT-CD       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":玉ID =["
      D             WK-GYOKU-ID         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":保有目的 =["
      D             WK-POSSESSION-OBJECT
      D                                 OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ＩＤ =["
      D             WK-THRK-ID          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":ダミー区分 =["
      D             WK-DUMMY-KBN        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":約定日 =["
      D             WK-YKJ-YMD          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":受渡日 =["
      D             WK-UKE-YMD          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":取引内容 =["
      D             WK-TORI-NAIY        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":取引事由 =["
      D             WK-TORI-JIYU        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":資金決済方法 =["
      D             WK-KESAI-HOHO       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":異動数量 =["
      D             WK-IDO-SURYO        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":権利数量 =["
      D             WK-KENRI-SURYO      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":数量単位 =["
      D             WK-SURYO-TANI       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             WK-SIJO-TUKA-CD     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地通貨コード =["
      D             WK-G-TUKA-CD        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":為替レート（現地／運用）１=["
      D             WK-G-U-KWS1         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":為替レート（現地／運用）２=["
      D             WK-G-U-KWS2         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":為替レート（現地／市場）=["
      D             WK-G-S-KWS          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":為替レート（市場／運用）=["
      D             WK-S-U-KWS          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":円レート（現地／円）=["
      D             WK-G-YEN-KWS        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":経過利息為替レート=["
      D             WK-KEKA-RSK-KWS     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":約定金額（運用通貨換算額）=["
      D             WK-U-KSG-G-YJKG     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地手数料（運用通貨換算額）=["
      D             WK-U-KSG-G-TSR      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地消費税（運用通貨換算額）=["
      D             WK-U-KSG-G-SHZ      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地その他費用（運用通貨換算額）=["
      D             WK-U-KSG-G-THY      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地源泉税（運用通貨換算額）=["
      D             WK-U-KSG-G-GSZ      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":既経過利息（運用通貨換算額）=["
      D             WK-U-KSG-G-KKKRS    OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":日歩（運用通貨換算額）=["
      D             WK-U-KSG-HIBU       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩（運用通貨換算額）=["
      D             WK-U-KSG-GHIBU      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費（運用通貨換算額）=["
      D             WK-U-KSG-KRH        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税（運用通貨換算額）=["
      D             WK-U-KSG-KRH-SHZ    OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用国手数料（運用通貨換算額）=["
      D             WK-U-KSG-U-TSR      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用国消費税（運用通貨換算額）=["
      D             WK-U-KSG-U-SHZ      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用国その他費用（運用通貨換算額）=["
      D             WK-U-KSG-U-THY      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":国内源泉税（運用通貨換算額）=["
      D             WK-NAI-TAX-U-KSG    OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":精算金額（運用通貨換算額）=["
      D             WK-U-KSG-G-SSKG     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":入出金額（約定レート・運用通貨換算額)=["
      D             WK-NSKG-Y-UY        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":入出金額（決済レート・運用通貨換算額)=["
      D             WK-NSKG-K-UY        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益 =["
      D             WK-UYTK-KWS-SNEKI   OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":約定金額（市場通貨換算額）=["
      D             WK-S-KSG-G-YJKG     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地手数料（市場通貨換算額）=["
      D             WK-S-KSG-G-TSR      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地消費税（市場通貨換算額）=["
      D             WK-S-KSG-G-SHZ      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地その他費用（市場通貨換算額）=["
      D             WK-S-KSG-G-THY      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地源泉税（市場通貨換算額）=["
      D             WK-S-KSG-G-GSZ      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":既経過利息（市場通貨換算額）=["
      D             WK-S-KSG-G-KKKRS    OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":日歩（市場通貨換算額）=["
      D             WK-S-KSG-HIBU       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩（市場通貨換算額）=["
      D             WK-S-KSG-GHIBU      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費（市場通貨換算額）=["
      D             WK-S-KSG-KRH        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税（市場通貨換算額）=["
      D             WK-S-KSG-KRH-SHZ    OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用国手数料（市場通貨換算額）=["
      D             WK-S-KSG-U-TSR      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用国消費税（市場通貨換算額）=["
      D             WK-S-KSG-U-SHZ      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用国その他費用（市場通貨換算額）=["
      D             WK-S-KSG-U-THY      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":国内源泉税（市場通貨換算額）=["
      D             WK-S-KSG-U-GSZ      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":精算金額（市場通貨換算額）=["
      D             WK-S-KSG-SSKG       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１=["
      D             WK-KOZA1-NO         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１通貨コード=["
      D             WK-KOZA1-TUKA-CD    OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１入出金額=["
      D             WK-KOZA1-NSKG       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１入出金額（運用通貨換算額）=["
      D             WK-KOZA1-U-KSG-NSKG OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座２=["
      D             WK-KOZA2-NO         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座２通貨コード=["
      D             WK-KOZA2-TUKA-CD    OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座２入出金額=["
      D             WK-KOZA2-NSKG       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済口座２入出金額（運用通貨換算額）=["
      D             WK-KOZA2-U-KSG-NSKG OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":還付予定額=["
      D             WK-KANP-YOTEGK      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":調整損益=["
      D             WK-CHOSEI-SNEKI     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":経過利息区分=["
      D             WK-KKRS-KBN         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":効力発生日=["
      D             WK-KOURYOKU-YMD     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":スタート日（放出日）=["
      D             WK-ST-YMD           OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":約定ベースエンド日=["
      D             WK-YKJ-END-YMD      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":受渡ベースエンド日=["
      D             WK-UKE-END-YMD      OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用日数 =["
      D             WK-UNYO-NISU        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":受取利息金額 =["
      D             WK-UKETR-RSK-KG     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":商品別取引区分 =["
      D             WK-SHB-TORI-KBN     OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":異動確定区分 =["
      D             WK-IDO-KBN          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":１口注文ＩＤ =["
      D             WK-ORDR-1K-ID       OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":対象取引ＩＤ  =["
      D             WK-TARGET-TORI-ID   OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地ブローカー =["
      D             WK-G-BRK            OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ =["
      D             WK-TATE-FLG         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード =["
      D             WK-TSTSK-CD         OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード =["
      D             WK-HAKO-CD          OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":約定金額 =["
      D             WK-G-YJKG           OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":約定単価 =["
      D             WK-YKJ-TANKA        OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":現地入出金額 =["
      D             WK-G-NSKG           OF  WK-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":相対取引データ:"
      *-----------------------------------------------------------------
      *---------- 1)ワーク相対取引データを初期化
             INITIALIZE  WK-AITAI-TRHK-DATA
      *---------- 取引連関ＩＤ
             MOVE  H-THRK-ID            OF  H-TKMXTR01-8
               TO  WK-THRK-ID           OF  WK-AITAI-TRHK-DATA
      *---------- 建時単価
             MOVE  H-TATE-TANKA         OF  H-TKMXTR01-8
               TO  WK-TATE-TANKA        OF  WK-AITAI-TRHK-DATA
      *---------- 決済単価
             MOVE  H-KS-TANKA           OF  H-TKMXTR01-8
               TO  WK-KS-TANKA          OF  WK-AITAI-TRHK-DATA
      *---------- 権利行使価格
             MOVE  H-KRKS-KKK           OF  H-TKMXTR01-8
               TO  WK-KRKS-KKK          OF  WK-AITAI-TRHK-DATA
      *---------- 権利行使金額（運用通貨）
             MOVE  H-U-KSG-KRKS-KG      OF  H-TKMXTR01-8
               TO  WK-U-KSG-KRKS-KG     OF  WK-AITAI-TRHK-DATA
      *---------- 決済約定金額（運用通貨）
             MOVE  H-U-KSG-KS-YJKG      OF  H-TKMXTR01-8
               TO  WK-U-KSG-KS-YJKG     OF  WK-AITAI-TRHK-DATA
      *---------- 決済現地手数料（運用通貨）
             MOVE  H-U-KSG-KS-G-TSR     OF  H-TKMXTR01-8
               TO  WK-U-KSG-KS-G-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 決済現地消費税（運用通貨）
             MOVE  H-U-KSG-KS-G-SHZ     OF  H-TKMXTR01-8
               TO  WK-U-KSG-KS-G-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 決済現地その他費用（運用通貨）
             MOVE  H-U-KSG-KS-G-THY     OF  H-TKMXTR01-8
               TO  WK-U-KSG-KS-G-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 決済運用国手数料（運用通貨）
             MOVE  H-U-KSG-KS-U-TSR     OF  H-TKMXTR01-8
               TO  WK-U-KSG-KS-U-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 決済運用国消費税（運用通貨）
             MOVE  H-U-KSG-KS-U-SHZ     OF  H-TKMXTR01-8
               TO  WK-U-KSG-KS-U-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 決済運用国その他費用（運用通貨）
             MOVE  H-U-KSG-KS-U-THY     OF  H-TKMXTR01-8
               TO  WK-U-KSG-KS-U-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 日歩（運用通貨）
             MOVE  H-U-KSG-HIBU         OF  H-TKMXTR01-8
               TO  WK-U-KSG-HIBU        OF  WK-AITAI-TRHK-DATA
      *---------- 逆日歩（運用通貨）
             MOVE  H-U-KSG-GHIBU        OF  H-TKMXTR01-8
               TO  WK-U-KSG-GHIBU       OF  WK-AITAI-TRHK-DATA
      *---------- 管理費（運用通貨）
             MOVE  H-U-KSG-KRH          OF  H-TKMXTR01-8
               TO  WK-U-KSG-KRH         OF  WK-AITAI-TRHK-DATA
      *---------- 管理費消費税（運用通貨）
             MOVE  H-U-KSG-KRH-SHZ      OF  H-TKMXTR01-8
               TO  WK-U-KSG-KRH-SHZ     OF  WK-AITAI-TRHK-DATA
      *---------- 建時約定金額（運用通貨）
             MOVE  H-U-KSG-TH-YJKG      OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-YJKG     OF  WK-AITAI-TRHK-DATA
      *---------- 建時現地手数料（運用通貨）
             MOVE  H-U-KSG-TH-G-TSR     OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-G-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 建時現地消費税（運用通貨）
             MOVE  H-U-KSG-TH-G-SHZ     OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-G-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 建時現地その他費用（運用通貨）
             MOVE  H-U-KSG-TH-G-THY     OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-G-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 建時運用国手数料（運用通貨）
             MOVE  H-U-KSG-TH-U-TSR     OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-U-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 建時運用国消費税（運用通貨）
             MOVE  H-U-KSG-TH-U-SHZ     OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-U-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 建時運用国その他費用（運用通貨）
             MOVE  H-U-KSG-TH-U-THY     OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-U-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ約定金額（運用通貨）
             MOVE  H-U-KSG-TH-OP-YJKG   OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-OP-YJKG  OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ現地手数料（運用通貨）
             MOVE  H-U-KSG-TH-OP-G-TSR  OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-OP-G-TSR OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ現地消費税（運用通貨）
             MOVE  H-U-KSG-TH-OP-G-SHZ  OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-OP-G-SHZ OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ現地その他費用（運用通貨）
             MOVE  H-U-KSG-TH-OP-G-THY  OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-OP-G-THY OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ運用国手数料（運用通貨）
             MOVE  H-U-KSG-TH-OP-U-TSR  OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-OP-U-TSR OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ運用国消費税（運用通貨）
             MOVE  H-U-KSG-TH-OP-U-SHZ  OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-OP-U-SHZ OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ運用国その他費用（運用通貨）
             MOVE  H-U-KSG-TH-OP-U-THY  OF  H-TKMXTR01-8
               TO  WK-U-KSG-TH-OP-U-THY OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ約定金額（運用通貨）
             MOVE  H-U-KSG-HTOP-YJKG    OF  H-TKMXTR01-8
               TO  WK-U-KSG-HTOP-YJKG   OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ現地手数料（運用通貨）
             MOVE  H-U-KSG-HTOP-G-TSR   OF  H-TKMXTR01-8
               TO  WK-U-KSG-HTOP-G-TSR  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ現地消費税（運用通貨）
             MOVE  H-U-KSG-HTOP-G-SHZ   OF  H-TKMXTR01-8
               TO  WK-U-KSG-HTOP-G-SHZ  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ現地その他費用（運用通貨）
             MOVE  H-U-KSG-HTOP-G-THY   OF  H-TKMXTR01-8
               TO  WK-U-KSG-HTOP-G-THY  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ運用国手数料（運用通貨）
             MOVE  H-U-KSG-HTOP-U-TSR   OF  H-TKMXTR01-8
               TO  WK-U-KSG-HTOP-U-TSR  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ運用国消費税（運用通貨）
             MOVE  H-U-KSG-HTOP-U-SHZ   OF  H-TKMXTR01-8
               TO  WK-U-KSG-HTOP-U-SHZ  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ運用国その他費用（運用通貨）
             MOVE  H-U-KSG-HTOP-U-THY   OF  H-TKMXTR01-8
               TO  WK-U-KSG-HTOP-U-THY  OF  WK-AITAI-TRHK-DATA
      *---------- 権利行使金額（市場通貨）
             MOVE  H-S-KSG-KRKS-KG      OF  H-TKMXTR01-8
               TO  WK-S-KSG-KRKS-KG     OF  WK-AITAI-TRHK-DATA
      *---------- 決済約定金額（市場通貨）
             MOVE  H-S-KSG-KS-YJKG      OF  H-TKMXTR01-8
               TO  WK-S-KSG-KS-YJKG     OF  WK-AITAI-TRHK-DATA
      *---------- 決済現地手数料（市場通貨）
             MOVE  H-S-KSG-KS-G-TSR     OF  H-TKMXTR01-8
               TO  WK-S-KSG-KS-G-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 決済現地消費税（市場通貨）
             MOVE  H-S-KSG-KS-G-SHZ     OF  H-TKMXTR01-8
               TO  WK-S-KSG-KS-G-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 決済現地その他費用（市場通貨）
             MOVE  H-S-KSG-KS-G-THY     OF  H-TKMXTR01-8
               TO  WK-S-KSG-KS-G-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 決済運用国手数料（市場通貨）
             MOVE  H-S-KSG-KS-U-TSR     OF  H-TKMXTR01-8
               TO  WK-S-KSG-KS-U-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 決済運用国消費税（市場通貨）
             MOVE  H-S-KSG-KS-U-SHZ     OF  H-TKMXTR01-8
               TO  WK-S-KSG-KS-U-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 決済運用国その他費用（市場通貨）
             MOVE  H-S-KSG-KS-U-THY     OF  H-TKMXTR01-8
               TO  WK-S-KSG-KS-U-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 日歩（市場通貨）
             MOVE  H-S-KSG-HIBU         OF  H-TKMXTR01-8
               TO  WK-S-KSG-HIBU        OF  WK-AITAI-TRHK-DATA
      *---------- 逆日歩（市場通貨）
             MOVE  H-S-KSG-GHIBU        OF  H-TKMXTR01-8
               TO  WK-S-KSG-GHIBU       OF  WK-AITAI-TRHK-DATA
      *---------- 管理費（市場通貨）
             MOVE  H-S-KSG-KRH          OF  H-TKMXTR01-8
               TO  WK-S-KSG-KRH         OF  WK-AITAI-TRHK-DATA
      *---------- 管理費消費税（市場通貨）
             MOVE  H-S-KSG-KRH-SHZ      OF  H-TKMXTR01-8
               TO  WK-S-KSG-KRH-SHZ     OF  WK-AITAI-TRHK-DATA
      *---------- 建時約定金額（市場通貨）
             MOVE  H-S-KSG-TH-YJKG      OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-YJKG     OF  WK-AITAI-TRHK-DATA
      *---------- 建時現地手数料（市場通貨）
             MOVE  H-S-KSG-TH-G-TSR     OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-G-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 建時現地消費税（市場通貨）
             MOVE  H-S-KSG-TH-G-SHZ     OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-G-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 建時現地その他費用（市場通貨）
             MOVE  H-S-KSG-TH-G-THY     OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-G-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 建時運用国手数料（市場通貨）
             MOVE  H-S-KSG-TH-U-TSR     OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-U-TSR    OF  WK-AITAI-TRHK-DATA
      *---------- 建時運用国消費税（市場通貨）
             MOVE  H-S-KSG-TH-U-SHZ     OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-U-SHZ    OF  WK-AITAI-TRHK-DATA
      *---------- 建時運用国その他費用（市場通貨）
             MOVE  H-S-KSG-TH-U-THY     OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-U-THY    OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ約定金額（市場通貨）
             MOVE  H-S-KSG-TH-OP-YJKG   OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-OP-YJKG  OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ現地手数料（市場通貨）
             MOVE  H-S-KSG-TH-OP-G-TSR  OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-OP-G-TSR OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ現地消費税（市場通貨）
             MOVE  H-S-KSG-TH-OP-G-SHZ  OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-OP-G-SHZ OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ現地その他費用（市場通貨）
             MOVE  H-S-KSG-TH-OP-G-THY  OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-OP-G-THY OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ運用国手数料（市場通貨）
             MOVE  H-S-KSG-TH-OP-U-TSR  OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-OP-U-TSR OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ運用国消費税（市場通貨）
             MOVE  H-S-KSG-TH-OP-U-SHZ  OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-OP-U-SHZ OF  WK-AITAI-TRHK-DATA
      *---------- 建時ＯＰ運用国その他費用（市場通貨）
             MOVE  H-S-KSG-TH-OP-U-THY  OF  H-TKMXTR01-8
               TO  WK-S-KSG-TH-OP-U-THY OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ約定金額（市場通貨）
             MOVE  H-S-KSG-HTOP-YJKG    OF  H-TKMXTR01-8
               TO  WK-S-KSG-HTOP-YJKG   OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ現地手数料（市場通貨）
             MOVE  H-S-KSG-HTOP-G-TSR   OF  H-TKMXTR01-8
               TO  WK-S-KSG-HTOP-G-TSR  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ現地消費税（市場通貨）
             MOVE  H-S-KSG-HTOP-G-SHZ   OF  H-TKMXTR01-8
               TO  WK-S-KSG-HTOP-G-SHZ  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ現地その他費用（市場通貨）
             MOVE  H-S-KSG-HTOP-G-THY   OF  H-TKMXTR01-8
               TO  WK-S-KSG-HTOP-G-THY  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ運用国手数料（市場通貨）
             MOVE  H-S-KSG-HTOP-U-TSR   OF  H-TKMXTR01-8
               TO  WK-S-KSG-HTOP-U-TSR  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ運用国消費税（市場通貨）
             MOVE  H-S-KSG-HTOP-U-SHZ   OF  H-TKMXTR01-8
               TO  WK-S-KSG-HTOP-U-SHZ  OF  WK-AITAI-TRHK-DATA
      *---------- 引継ＯＰ運用国その他費用（市場通貨）
             MOVE  H-S-KSG-HTOP-U-THY   OF  H-TKMXTR01-8
               TO  WK-S-KSG-HTOP-U-THY  OF  WK-AITAI-TRHK-DATA
      *---------- 建時現地約定日
             MOVE  H-TATE-G-YKJ-YMD     OF  H-TKMXTR01-8
               TO  WK-TATE-G-YKJ-YMD    OF  WK-AITAI-TRHK-DATA
      *---------- 資産負債・買建売建フラグ
             MOVE  H-TATE-FLG           OF  H-TKMXTR01-8
               TO  WK-TATE-FLG          OF  WK-AITAI-TRHK-DATA
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引連関ＩＤ =["
      D             WK-THRK-ID          OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時単価 =["
      D             WK-TATE-TANKA       OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済単価 =["
      D             WK-KS-TANKA         OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":権利行使価格 =["
      D             WK-KRKS-KKK         OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":権利行使金額（運用通貨）=["
      D             WK-U-KSG-KRKS-KG    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済約定金額（運用通貨）=["
      D             WK-U-KSG-KS-YJKG    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済現地手数料（運用通貨）=["
      D             WK-U-KSG-KS-G-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済現地消費税（運用通貨）=["
      D             WK-U-KSG-KS-G-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済現地その他費用（運用通貨）=["
      D             WK-U-KSG-KS-G-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済運用国手数料（運用通貨）=["
      D             WK-U-KSG-KS-U-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済運用国消費税（運用通貨）=["
      D             WK-U-KSG-KS-U-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済運用国その他費用（運用通貨）=["
      D             WK-U-KSG-KS-U-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":日歩（運用通貨）=["
      D             WK-U-KSG-HIBU       OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩（運用通貨）=["
      D             WK-U-KSG-GHIBU      OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費（運用通貨）=["
      D             WK-U-KSG-KRH        OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税（運用通貨）=["
      D             WK-U-KSG-KRH-SHZ    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時約定金額（運用通貨）=["
      D             WK-U-KSG-TH-YJKG    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（運用通貨）=["
      D             WK-U-KSG-TH-G-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（運用通貨）=["
      D             WK-U-KSG-TH-G-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（運用通貨）=["
      D             WK-U-KSG-TH-G-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（運用通貨）=["
      D             WK-U-KSG-TH-U-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（運用通貨）=["
      D             WK-U-KSG-TH-U-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（運用通貨）=["
      D             WK-U-KSG-TH-U-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ約定金額（運用通貨）=["
      D             WK-U-KSG-TH-OP-YJKG OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（運用通貨）=["
      D             WK-U-KSG-TH-OP-G-TSR
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（運用通貨）=["
      D             WK-U-KSG-TH-OP-G-SHZ
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（運用通貨）=["
      D             WK-U-KSG-TH-OP-G-THY
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（運用通貨）=["
      D             WK-U-KSG-TH-OP-U-TSR
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（運用通貨）=["
      D             WK-U-KSG-TH-OP-U-SHZ
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（運用通貨）=["
      D             WK-U-KSG-TH-OP-U-THY
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ約定金額（運用通貨）=["
      D             WK-U-KSG-HTOP-YJKG  OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地手数料（運用通貨）=["
      D             WK-U-KSG-HTOP-G-TSR OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地消費税（運用通貨）=["
      D             WK-U-KSG-HTOP-G-SHZ OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地その他費用（運用通貨）=["
      D             WK-U-KSG-HTOP-G-THY OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国手数料（運用通貨）=["
      D             WK-U-KSG-HTOP-U-TSR OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国消費税（運用通貨）=["
      D             WK-U-KSG-HTOP-U-SHZ OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国その他費用（運用通貨）=["
      D             WK-U-KSG-HTOP-U-THY OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":権利行使金額（市場通貨）=["
      D             WK-S-KSG-KRKS-KG    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済約定金額（市場通貨）=["
      D             WK-S-KSG-KS-YJKG    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済現地手数料（市場通貨）=["
      D             WK-S-KSG-KS-G-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済現地消費税（市場通貨）=["
      D             WK-S-KSG-KS-G-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済現地その他費用（市場通貨）=["
      D             WK-S-KSG-KS-G-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済運用国手数料（市場通貨）=["
      D             WK-S-KSG-KS-U-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済運用国消費税（市場通貨）=["
      D             WK-S-KSG-KS-U-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済運用国その他費用（市場通貨）=["
      D             WK-S-KSG-KS-U-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":日歩（市場通貨）=["
      D             WK-S-KSG-HIBU       OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩（市場通貨）=["
      D             WK-S-KSG-GHIBU      OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費（市場通貨）=["
      D             WK-S-KSG-KRH        OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税（市場通貨）=["
      D             WK-S-KSG-KRH-SHZ    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時約定金額（市場通貨）=["
      D             WK-S-KSG-TH-YJKG    OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（市場通貨）=["
      D             WK-S-KSG-TH-G-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（市場通貨）=["
      D             WK-S-KSG-TH-G-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（市場通貨）=["
      D             WK-S-KSG-TH-G-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（市場通貨）=["
      D             WK-S-KSG-TH-U-TSR   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（市場通貨）=["
      D             WK-S-KSG-TH-U-SHZ   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（市場通貨）=["
      D             WK-S-KSG-TH-U-THY   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ約定金額（市場通貨）=["
      D             WK-S-KSG-TH-OP-YJKG OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（市場通貨）=["
      D             WK-S-KSG-TH-OP-G-TSR
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（市場通貨）=["
      D             WK-S-KSG-TH-OP-G-SHZ
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（市場通貨）=["
      D             WK-S-KSG-TH-OP-G-THY
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（市場通貨）=["
      D             WK-S-KSG-TH-OP-U-TSR
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（市場通貨）=["
      D             WK-S-KSG-TH-OP-U-SHZ
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（市場通貨）=["
      D             WK-S-KSG-TH-OP-U-THY
      D                                 OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ約定金額（市場通貨）=["
      D             WK-S-KSG-HTOP-YJKG  OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地手数料（市場通貨）=["
      D             WK-S-KSG-HTOP-G-TSR OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地消費税（市場通貨）=["
      D             WK-S-KSG-HTOP-G-SHZ OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地その他費用（市場通貨）=["
      D             WK-S-KSG-HTOP-G-THY OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国手数料（市場通貨）=["
      D             WK-S-KSG-HTOP-U-TSR OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国消費税（市場通貨）=["
      D             WK-S-KSG-HTOP-U-SHZ OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国その他費用（市場通貨）=["
      D             WK-S-KSG-HTOP-U-THY OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":建時現地約定日=["
      D             WK-TATE-G-YKJ-YMD   OF  WK-AITAI-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             WK-TATE-FLG         OF  WK-AITAI-TRHK-DATA"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-096          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-8         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  取引 FETCH 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMXTR00-FET-EXT.
           EXIT.
      ******************************************************************
      *    取引 CURSOR CLOSE 処理
      ******************************************************************
      * TKMXTR00-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***取引 CURSOR CLOSE 処理 START ***"
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["
      *D             FLG-TKMXTR00-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *         CLOSE TKMXTR00_CURSOR
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQLCODE(CLOSE)   =[" SQLCODE "]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *       MOVE  CNS-OFF              TO  FLG-TKMXTR00-CR-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["
      *D             FLG-TKMXTR00-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     ELSE
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-097          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-8         DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-2-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":*** 取引 CURSOR CLOSE 処理 END  ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMXTR00-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *   4.3.1.4.ワーク対象取引情報.処理順＝1の場合、直前異動セット   *
      ******************************************************************
       TZ-IDO-ASSET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ワーク直前残高異動 編集 処理 "
      D             "START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.処理順 =["
      D             WK-SRJUN            OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類 =["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
      *---------- ワーク対象取引情報.処理順＝1の場合、直前異動セット
           IF  WK-SRJUN                 OF  WK-TARGET-TORI-INFO
            =  CNS-SRJUN-1
           THEN
      *---------- 1)ワーク銘柄別断面情報.銘柄種類＝'1'(物)の場合
             IF  WK-MEG-CD-SHRU         OF  WK-TKMZBW03
              =  CNS-MEG-CD-SHRU-1
             THEN
               PERFORM  TZ-IDO-EDIT1-RTN
             ELSE
      *---------- 2)ワーク銘柄別断面情報.銘柄種類＝'2'(元本)の場合
               IF  WK-MEG-CD-SHRU       OF  WK-TKMZBW03
                =  CNS-MEG-CD-SHRU-2
               THEN
                 PERFORM  TZ-IDO-EDIT2-RTN
               ELSE
                 CONTINUE
               END-IF
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ワーク直前残高異動 編集 処理"
      D             "  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TZ-IDO-ASSET-EXT.
           EXIT.
      ******************************************************************
      *   ワーク売り続く限りフラグセット                               *
      ******************************************************************
       UTK-KAGI-SET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ワーク売り続く限りフラグ セット  "
      D             "START  ***"
      *-----------------------------------------------------------------
      *---------- 4.3.1.5.1.証券種別判定
           PERFORM  SMZJ4014-4-RTN
      *---------- 4.3.1.5.2.取引事由判定
           PERFORM  SMZJ4012-3-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く証券種別区分=["
      D             WK-BUY-SEC-SBT-KBN"]"
      D    DISPLAY  CNS-PGM-ID":売買フラグ =["FLG-URIKAI"]"
      *-----------------------------------------------------------------
      *---------- 4.3.1.5.3.ワーク売り続く証券種別区分＝'1'(有効)且つ売買フラグ＝1:売却の場合
           IF  WK-BUY-SEC-SBT-KBN = CNS-BUY-SEC-SBT-KBN  AND
               FLG-URIKAI = CNS-FLG-URIKAI-1
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.処理順 =["
      D             WK-SRJUN            OF  WK-TARGET-TORI-INFO"]"
      *-----------------------------------------------------------------
             INITIALIZE  WK-URI-TUDUKU-KAGI-FLG
      *---------- ワーク対象取引情報.処理順＝1の場合
             IF  WK-SRJUN               OF  WK-TARGET-TORI-INFO
              =  CNS-SRJUN-1
             THEN
               MOVE  SAME-COST-KZK-FLG  OF  WK-TKMZZR00
                 TO  WK-URI-TUDUKU-KAGI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高履歴情報."
      D             "同一コスト継続フラグ =["
      D             SAME-COST-KZK-FLG   OF  WK-TKMZZR00"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く限りフラグ =["
      D             WK-URI-TUDUKU-KAGI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク異動計算パターン情報."
      D             "売り続く限り同一コスト =["
      D         WK-URI-TUDUKU-SAME-COST OF  WK-IDO-CALC-PATTERN-INFO"]"
      *-----------------------------------------------------------------
               IF  WK-URI-TUDUKU-SAME-COST  OF  WK-IDO-CALC-PATTERN-INFO
               NOT =  CNS-UTK-SAME-COST-1
               THEN
                 MOVE  CNS-UTK-KAGI-FLG-0 TO  WK-URI-TUDUKU-KAGI-FLG
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く限りフラグ =["
      D             WK-URI-TUDUKU-KAGI-FLG"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- 取引事由判定
               PERFORM  SMZJ4012-2-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク異動計算パターン情報."
      D             "売り続く限り同一コスト =["
      D         WK-URI-TUDUKU-SAME-COST OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動.赤黒区分 =["
      D             AKA-KBN             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":売買フラグ =["FLG-URIKAI"]"
      *-----------------------------------------------------------------
      *---------- 1)◆ワーク異動計算パターン情報.売り続く限り同一コスト＝'1':YES
      *---------- 且つ ワーク直前残高異動.赤黒区分＝('1' or '9')の場合
               IF  WK-URI-TUDUKU-SAME-COST  OF  WK-IDO-CALC-PATTERN-INFO
                =  CNS-UTK-SAME-COST-1
                AND ((AKA-KBN  OF  WK-TZ-ZN-IDO  =  CNS-AKA-KBN-1
                  OR  AKA-KBN  OF  WK-TZ-ZN-IDO  =  CNS-AKA-KBN-9)
                  OR  FLG-URIKAI = CNS-FLG-URIKAI-2)
               THEN
      *---------- @残高異動計算データTBLから、データを取得「別紙1-11 SQL説明」を参照)(フェッチ一回のみ)
                 PERFORM  SELECT-TKMZBW06-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ=["
      D             WK-DATA-NASI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク約定ベース受渡順フラグ=["
      D             WK-YKJ-UKE-JUN-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.差分更新From日=["
      D             WK-SABON-UPDATE-FROM  OF  WK-TKMZBW03"]"
      D    DISPLAY  CNS-PGM-ID":ワーク開始時残高変換フラグ      =["
      D             WK-KAISI-ZN-FLG"]"
      *-----------------------------------------------------------------
      *---------- Aワークデータなしフラグ＝1の場合
                 IF  WK-DATA-NASI-FLG  =  CNS-DATA-FLG-1
                 THEN
      *---------- A)ワーク約定ベース受渡順フラグ＝'1'
                   IF  WK-YKJ-UKE-JUN-FLG = CNS-YKJ-1
                   THEN
      *---------- 残高異動データTBLから、データを取得する。(「別紙1-12 SQL説明」を参照)
                     PERFORM  SELECT-TKMZZI00-RTN
      *---------- B)上記以外
                   ELSE
      *---------- ワーク市場通貨払出単価← ワーク開始時残高履歴情報.市場通貨払出単価
                     MOVE  SJTK-H-TNK        OF  WK-TKMZZR00
                       TO  WK-SJTK-H-TNK
      *---------- ワーク運用通貨払出単価← ワーク開始時残高履歴情報.運用通貨払出単価
                     MOVE  UYTK-H-TNK        OF  WK-TKMZZR00
                       TO  WK-UYTK-H-TNK
      *---------- ワーク売り続く限りフラグ ← ワーク開始時残高履歴情報.同一コスト継続フラグ
                     MOVE  SAME-COST-KZK-FLG OF  WK-TKMZZR00
                       TO  WK-URI-TUDUKU-KAGI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨払出単価 =["
      D             WK-SJTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨払出単価 =["
      D             WK-UYTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く限りフラグ =["
      D             WK-URI-TUDUKU-KAGI-FLG"]"
      *-----------------------------------------------------------------
                   END-IF
                 ELSE
                   CONTINUE
                 END-IF
               ELSE
      *---------- ワーク取引事由
                 MOVE  TORI-JIYU        OF  WK-TZ-ZN-IDO
                   TO  WK-TRI-JIYU-K
      *---------- ワーク市場通貨払出単価
                 MOVE  SJTK-H-TNK       OF  WK-TZ-ZN-IDO
                   TO  WK-SJTK-H-TNK
      *---------- ワーク運用通貨払出単価
                 MOVE  UYTK-H-TNK       OF  WK-TZ-ZN-IDO
                   TO  WK-UYTK-H-TNK
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引事由 =["WK-TRI-JIYU-K"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨払出単価 =["
      D             WK-SJTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨払出単価 =["
      D             WK-UYTK-H-TNK"]"
      *-----------------------------------------------------------------
               END-IF
      *---------- 2)ワークデータなしフラグ≠1の場合、売買フラグの決定処理
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ=["
      D             WK-DATA-NASI-FLG"]"
      *-----------------------------------------------------------------
               IF  WK-DATA-NASI-FLG NOT= CNS-DATA-FLG-1
               THEN
                 MOVE  WK-TRI-JIYU-K    TO  WK-TORI-JIYU-BAK
      *----------  売買フラグの決定処理
                 PERFORM  SMZJ4012-RTN
      *---------- 3)ワーク異動計算パターン情報.売り続く限り同一コスト＝'1':YES
      *---------- かつ  売買フラグ＝1:売却の場合
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク異動計算パターン情報."
      D             "売り続く限り同一コスト =["
      D         WK-URI-TUDUKU-SAME-COST  OF  WK-IDO-CALC-PATTERN-INFO"]"
      D    DISPLAY  CNS-PGM-ID":売買フラグ =["FLG-URIKAI"]"
      *-----------------------------------------------------------------
                 IF  WK-URI-TUDUKU-SAME-COST OF WK-IDO-CALC-PATTERN-INFO
                  =  CNS-UTK-SAME-COST-1
                 AND  FLG-URIKAI  =  CNS-FLG-URIKAI-1
                 THEN
                   MOVE  CNS-UTK-KAGI-FLG-1  TO  WK-URI-TUDUKU-KAGI-FLG
                 ELSE
                   MOVE  CNS-UTK-KAGI-FLG-0  TO  WK-URI-TUDUKU-KAGI-FLG
                 END-IF
               ELSE
                 CONTINUE
               END-IF
      *---------- 4)ワーク売り続く限りフラグ＝'1'の場合、
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く限りフラグ =["
      D             WK-URI-TUDUKU-KAGI-FLG"]"
      *-----------------------------------------------------------------
               IF  WK-URI-TUDUKU-KAGI-FLG  =  CNS-UTK-KAGI-FLG-1
               THEN
      *---------- ワーク直前残高異動.市場通貨払出単価
                 MOVE  WK-SJTK-H-TNK
                   TO  SJTK-H-TNK       OF  WK-TZ-ZN-IDO
      *---------- ワーク直前残高異動.運用通貨払出単価
                 MOVE  WK-UYTK-H-TNK
                   TO  UYTK-H-TNK       OF  WK-TZ-ZN-IDO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動.市場通貨払出単価 =["
      D             SJTK-H-TNK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動.運用通貨払出単価 =["
      D             UYTK-H-TNK          OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ワーク売り続く限りフラグ セット  "
      D             "END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       UTK-KAGI-SET-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.5.1.証券種別判定
      ******************************************************************
       SMZJ4014-4-RTN         SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4014-INOUT
                       PARM-RTNPKG
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  PARM-SMZJ4014-ARG1
      *---------- 判定対象区分
           MOVE  CNS-HTEI-TGT-KBN-A
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4014-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             SEC-SBT-CD          OF  PARM-SMZJ4014-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分  =["
      D             HANTEI-TARGET-KBN   OF  PARM-SMZJ4014-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4014"             USING  PARM-SMZJ4014-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4014)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- 売り続く証券種別区分
             MOVE  BUY-SEC-SBT-KBN      OF  PARM-SMZJ4014-ARG2
               TO  WK-BUY-SEC-SBT-KBN
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く証券種別区分=["
      D             WK-BUY-SEC-SBT-KBN"]"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4014-4-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ4012】取引事由判定
      ******************************************************************
       SMZJ4012-2-RTN         SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4012】取引事由判定  START  "
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4011-INOUT
                       PARM-RTNPKG
      *---------- 取引事由
           MOVE  TORI-JIYU              OF  WK-TZ-ZN-IDO
             TO  TORI-JIYU              OF  PARM-SMZJ4012-ARG1
      *---------- 判定対象区分
           MOVE  CNS-HTEI-TGT-KBN-6
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4012-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由 =["
      D             TORI-JIYU           OF  PARM-SMZJ4012-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分 =["
      D             HANTEI-TARGET-KBN   OF  PARM-SMZJ4012-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4012"             USING  PARM-SMZJ4012-INOUT
                                               PARM-RTNPKG
      *---------- 売買フラグ
           MOVE  URIKAI-FLG             OF  PARM-SMZJ4012-ARG2
             TO  FLG-URIKAI
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":売買フラグ =["FLG-URIKAI"]"
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4012】取引事由判定  END  "
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4012-2-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.5.2.取引事由判定
      ******************************************************************
       SMZJ4012-3-RTN         SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4012】取引事由判定  START  "
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4012-INOUT
                       PARM-RTNPKG
      *---------- 取引事由
           MOVE  WK-TORI-JIYU           OF  WK-TRHK-DATA
             TO  TORI-JIYU              OF  PARM-SMZJ4012-ARG1
      *---------- 判定対象区分
           MOVE  CNS-HTEI-TGT-KBN-6
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4012-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由 =["
      D             TORI-JIYU  OF  PARM-SMZJ4012-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分 =["
      D             HANTEI-TARGET-KBN   OF  PARM-SMZJ4012-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4012"             USING  PARM-SMZJ4012-INOUT
                                               PARM-RTNPKG
      *---------- 売買フラグ
           MOVE  URIKAI-FLG             OF  PARM-SMZJ4012-ARG2
             TO  FLG-URIKAI
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":売買フラグ =["FLG-URIKAI"]"
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4012】取引事由判定  END  "
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4012-3-EXT.
           EXIT.
      ******************************************************************
      *    残高異動計算データを取得する(別紙1-11)
      ******************************************************************
       SELECT-TKMZBW06-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データを取得(別紙1-11) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT11                                        @3212SEINO@@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW06-1-S,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-11
      *----------  処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  H-SYORI-YMD            OF  H-TKMZBW06-1-S,
                 WK-SYORI-YMD           OF  WK-MSG-1-11
      *----------  起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  H-KIDOU-ID             OF  H-TKMZBW06-1-S,
                 WK-KIDOU-ID            OF  WK-MSG-1-11
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZBW06-1-S,
                 WK-FUND-CD             OF  WK-MSG-1-11
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZBW06-1-S,
                 WK-PTF-CD              OF  WK-MSG-1-11
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  H-SEC-SBT-CD           OF  H-TKMZBW06-1-S,
                 WK-SEC-SBT-CD          OF  WK-MSG-1-11
      *----------  銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-MEG-CD               OF  H-TKMZBW06-1-S,
                 WK-MEG-CD              OF  WK-MSG-1-11
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  H-TATE-FLG             OF  H-TKMZBW06-1-S,
                 WK-TATE-FLG            OF  WK-MSG-1-11
      *----------  玉ＩＤ
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  H-GYOKU-ID             OF  H-TKMZBW06-1-S
                 WK-GYOKU-ID            OF  WK-MSG-1-11
      *----------  異動計上順序
           MOVE  IDO-KJY-JUN            OF  WK-TZ-ZN-IDO
             TO  H-IDO-KJY-JUN          OF  H-TKMZBW06-1-S,
                 WK-IDO-KJY-JUN         OF  WK-MSG-1-11
      *----------  TBL
           MOVE  WK-TBL-TKMZBW06
             TO  SQL-TBL-ID-11          OF  SQL-SELECT-1-11,
                 WK-MSG-TKMZBW06        OF  WK-MSG-1-11
           MOVE  SQL-SELECT-1-11        TO  SQLSTMT11                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":処理実行日          =["
      D             H-SYORI-YMD          OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":起動ID              =["
      D             H-KIDOU-ID           OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード      =["
      D             H-SEC-SBT-CD         OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード          =["
      D             H-MEG-CD             OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産負債・買建売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ＩＤ              =["
      D             H-GYOKU-ID           OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":異動計上順序        =["
      D             H-IDO-KJY-JUN        OF  H-TKMZBW06-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT11=[" SQLSTMT11 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR-1-OPEN=["               @3212SEINO@@
      D             FLG-TKMZBW06-CR-1-OPEN"]"                           @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  残高異動計算データCURSOR PREPARE
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZBW06-CR-1-OPEN  NOT =  CNS-ON                    @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
             PREPARE  S11  FROM  :SQLSTMT11                             @3212SEINO@@
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D       ":残高異動計算データCURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-098          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-11        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
           EXEC  SQL
             DECLARE  TKMZBW06_CUR_1  CURSOR  FOR  S11
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZBW06_CUR_1
               USING :H-TKMZBW06-1-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON              TO  FLG-TKMZBW06-CR-1-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR-1-OPEN=["
      D             FLG-TKMZBW06-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-099          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-11        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZBW06_CUR_1
             INTO  :H-TKMZBW06-1
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動計算データCUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *----------  ワーク取引事由
               MOVE  H-TORI-JIYU        OF  H-TKMZBW06-1
                 TO  WK-TRI-JIYU-K
      *----------  ワーク市場通貨払出単価
               MOVE  H-SJTK-H-TNK       OF  H-TKMZBW06-1
                 TO  WK-SJTK-H-TNK
      *----------  ワーク運用通貨払出単価
               MOVE  H-UYTK-H-TNK       OF  H-TKMZBW06-1
                 TO  WK-UYTK-H-TNK
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引事由 =["WK-TRI-JIYU-K"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨払出単価 =["
      D                                           WK-SJTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨払出単価 =["
      D                                           WK-UYTK-H-TNK"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *----------  ワークデータなしフラグ ← 1
               MOVE  CNS-DATA-FLG-1      TO  WK-DATA-NASI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ=["
      D             WK-DATA-NASI-FLG"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-100          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-11        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データCURSOR FETCH END ***"
      *D    DISPLAY  CNS-PGM-ID
      *D             ":*** 残高異動計算データCURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR-1-OPEN= ["
      *D             FLG-TKMZBW06-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZBW06_CUR_1
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"残高異動計算データ"
      *D             "CUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動計算データCURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF               TO  FLG-TKMZBW06-CR-1-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZBW06-CR-1-OPEN =["
      *D             FLG-TKMZBW06-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-101          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-11        DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-2-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***残高異動計算データCUR CLOSE END ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動計算データを取得(別紙1-11) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SELECT-TKMZBW06-EXT.
           EXIT.
      ******************************************************************
      *    残高異動を取得する(別紙1-12)
      ******************************************************************
       SELECT-TKMZZI00-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高異動を取得(別紙1-12) START ***"
      D    DISPLAY  CNS-PGM-ID
      D             ":*** 残高異動CURSOR PREPARE  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT12                                        @3212SEINO@@
      *----------  利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZZI00-1-S,
                 WK-RIYO-CMP-CD         OF  WK-MSG-1-12
      *----------  ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZZI00-1-S,
                 WK-FUND-CD             OF  WK-MSG-1-12
      *----------  ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZZI00-1-S,
                 WK-PTF-CD              OF  WK-MSG-1-12
      *----------  証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  H-SEC-SBT-CD           OF  H-TKMZZI00-1-S,
                 WK-SEC-SBT-CD          OF  WK-MSG-1-12
      *----------  銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-MEG-CD               OF  H-TKMZZI00-1-S,
                 WK-MEG-CD              OF  WK-MSG-1-12
      *----------  資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  H-TATE-FLG             OF  H-TKMZZI00-1-S,
                 WK-TATE-FLG            OF  WK-MSG-1-12
      *----------  玉ＩＤ
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  H-GYOKU-ID             OF  H-TKMZZI00-1-S
                 WK-GYOKU-ID            OF  WK-MSG-1-12
      *----------  計上基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  H-KEIJOU-KIJUNBI       OF  H-TKMZZI00-1-S,
                 WK-KEIJOU-KIJUNBI      OF  WK-MSG-1-12
      *----------  TBL
           MOVE  WK-TBL-TKMZZI00
             TO  WK-SQL-TKMZZI00-01     OF  SQL-SELECT-1-12,
                 WK-MSG-TKMZZI00        OF  WK-MSG-1-12
           MOVE  SQL-SELECT-1-12        TO  SQLSTMT12                   @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID ":利用会社コード      =["
      D             H-RIYO-CMP-CD        OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ファンドコード      =["
      D             H-FUND-CD            OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
      D             H-PTF-CD             OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":証券種別コード      =["
      D             H-SEC-SBT-CD         OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":銘柄コード          =["
      D             H-MEG-CD             OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":資産負債・買建売建フラグ=["
      D             H-TATE-FLG           OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":玉ＩＤ              =["
      D             H-GYOKU-ID           OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":計上基準日          =["
      D             H-KEIJOU-KIJUNBI     OF  H-TKMZZI00-1-S"]"
      D    DISPLAY  CNS-PGM-ID ":SQLSTMT12=[" SQLSTMT12 "]"             @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZI00-CR-1-OPEN=["               @3212SEINO@@
      D             FLG-TKMZZI00-CR-1-OPEN"]"                           @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  残高異動CURSOR PREPARE
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZZI00-CR-1-OPEN  NOT =  CNS-ON                    @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
             PREPARE  S12  FROM  :SQLSTMT12                             @3212SEINO@@
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CURSOR PREPARE SQLCODE =[" SQLCODE "]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR PREPARE 正常"
      *-----------------------------------------------------------------
             CONTINUE
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR PREPARE 異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-102          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-12        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高異動CURSOR OPEN START ***"
      *-----------------------------------------------------------------
      *----------  DECLARE CURSOR
           EXEC  SQL
             DECLARE  TKMZZI00_CUR_1  CURSOR  FOR  S12
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR DECLARE SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *----------  OPEN CURSOR
           EXEC  SQL
             OPEN  TKMZZI00_CUR_1
               USING :H-TKMZZI00-1-S
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CUR OPEN SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON              TO  FLG-TKMZZI00-CR-1-OPEN
      *-----------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR OPEN  正常"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZI00-CR-1-OPEN=["
      D             FLG-TKMZZI00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR OPEN  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-103          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-12        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高異動CURSOR OPEN END ***"
      D    DISPLAY  CNS-PGM-ID":*** 残高異動CURSOR FETCH START ***"
      *-----------------------------------------------------------------
      *----------  CURSOR FETCH
           EXEC SQL
             FETCH TKMZZI00_CUR_1
             INTO  :H-TKMZZI00-1
           END-EXEC
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":残高異動CUR FETCH SQLCODE=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
      *----------  正常
             WHEN  CNS-SQL-NORMAL
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR FETCH  正常"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.取引事由        =["
      D             H-TORI-JIYU         OF  H-TKMZZI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.市場通貨払出単価=["
      D             H-SJTK-H-TNK        OF  H-TKMZZI00-1"]"
      D    DISPLAY  CNS-PGM-ID":別紙1-12.運用通貨払出単価=["
      D             H-UYTK-H-TNK        OF  H-TKMZZI00-1"]"
      *-----------------------------------------------------------------
      *----------  ワークデータなしフラグ ← 0
               MOVE  ZERO               TO  WK-DATA-NASI-FLG
      *----------  取引事由
               MOVE  H-TORI-JIYU        OF  H-TKMZZI00-1
                 TO  WK-TRI-JIYU-K
      *----------  市場通貨払出単価
               MOVE  H-SJTK-H-TNK       OF  H-TKMZZI00-1
                 TO  WK-SJTK-H-TNK
      *----------  運用通貨払出単価
               MOVE  H-UYTK-H-TNK       OF  H-TKMZZI00-1
                 TO  WK-UYTK-H-TNK
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークデータなしフラグ =["
      D             WK-DATA-NASI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク取引事由 =["WK-TRI-JIYU-K"]"
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨払出単価=["
      D             WK-SJTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨払出単価=["
      D             WK-UYTK-H-TNK"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR FETCH NOTFOUND"
      *-----------------------------------------------------------------
      *---------- ワーク市場通貨払出単価← ワーク開始時残高履歴情報.市場通貨払出単価
               MOVE  SJTK-H-TNK         OF  WK-TKMZZR00
                 TO  WK-SJTK-H-TNK
      *---------- ワーク運用通貨払出単価← ワーク開始時残高履歴情報.運用通貨払出単価
               MOVE  UYTK-H-TNK         OF  WK-TKMZZR00
                 TO  WK-UYTK-H-TNK
      *---------- ワーク売り続く限りフラグ ← ワーク開始時残高履歴情報.同一コスト継続フラグ
               MOVE  SAME-COST-KZK-FLG  OF  WK-TKMZZR00
                 TO  WK-URI-TUDUKU-KAGI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク市場通貨払出単価 =["
      D             WK-SJTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク運用通貨払出単価 =["
      D             WK-UYTK-H-TNK"]"
      D    DISPLAY  CNS-PGM-ID":ワーク売り続く限りフラグ =["
      D             WK-URI-TUDUKU-KAGI-FLG"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動CURSOR FETCH  異常"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-104          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-12        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 残高異動CURSOR FETCH END ***"
      *D    DISPLAY  CNS-PGM-ID":*** 残高異動CURSOR CLOSE START ***"
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZI00-CR-1-OPEN= ["
      *D             FLG-TKMZZI00-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *       CLOSE TKMZZI00_CUR_1
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID"残高異動"
      *D             "CUR CLOSE SQLCODE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動CURSOR CLOSE  正常"
      **-----------------------------------------------------------------
      *       MOVE  CNS-OFF               TO  FLG-TKMZZI00-CR-1-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":FLG-TKMZZI00-CR-1-OPEN =["
      *D             FLG-TKMZZI00-CR-1-OPEN "]"
      **-----------------------------------------------------------------
      *     ELSE
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":残高異動CURSOR CLOSE  異常"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-105          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-12        DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-2-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID ":***残高異動CUR CLOSE END ***"
      D    DISPLAY  CNS-PGM-ID":*** 残高異動を取得(別紙1-12) END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SELECT-TKMZZI00-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ4012】取引事由判定
      ******************************************************************
       SMZJ4012-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4012】取引事由判定  START  "
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4012-INOUT
                       FLG-URIKAI
                       PARM-RTNPKG
      *---------- 取引事由
           MOVE  WK-TORI-JIYU-BAK
             TO  TORI-JIYU              OF  PARM-SMZJ4012-ARG1
      *---------- 判定対象区分
           MOVE  CNS-HTEI-TGT-KBN-6
             TO  HANTEI-TARGET-KBN      OF  PARM-SMZJ4012-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引事由 =["
      D             TORI-JIYU  OF  PARM-SMZJ4012-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":判定対象区分 =["
      D             HANTEI-TARGET-KBN   OF  PARM-SMZJ4012-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4012"             USING  PARM-SMZJ4012-INOUT
                                               PARM-RTNPKG
      *---------- 売買フラグ
           MOVE  URIKAI-FLG             OF  PARM-SMZJ4012-ARG2
             TO  FLG-URIKAI
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":売買フラグ =["FLG-URIKAI"]"
      D    DISPLAY  CNS-PGM-ID":***  【SMZJ4012】取引事由判定  END  "
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4012-EXT.
           EXIT.
      ******************************************************************
      *    「別紙4-3 編集要領」
      ******************************************************************
       TZ-IDO-EDIT1-RTN       SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  WK-TZ-ZN-IDO
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  WK-TKMZZR00
             TO  RIYO-CMP-CD            OF  WK-TZ-ZN-IDO
      *---------- ファンドコード
           MOVE  FUND-CD                OF  WK-TKMZZR00
             TO  FUND-CD                OF  WK-TZ-ZN-IDO
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  WK-TKMZZR00
             TO  PTF-CD                 OF  WK-TZ-ZN-IDO
      *---------- 証券種別コード
           MOVE  SEC-SBT-CD             OF  WK-TKMZZR00
             TO  SEC-SBT-CD             OF  WK-TZ-ZN-IDO
      *---------- 市場通貨コード
           MOVE  SIJO-TUKA-CD           OF  WK-TKMZZR00
             TO  SIJO-TUKA-CD           OF  WK-TZ-ZN-IDO
      *---------- 銘柄コード
           MOVE  MEG-CD                 OF  WK-TKMZZR00
             TO  MEG-CD                 OF  WK-TZ-ZN-IDO
      *---------- 資産負債・買建売建フラグ
           MOVE  TATE-FLG               OF  WK-TKMZZR00
             TO  TATE-FLG               OF  WK-TZ-ZN-IDO
      *---------- 玉ＩＤ
           MOVE  GYOKU-ID               OF  WK-TKMZZR00
             TO  GYOKU-ID               OF  WK-TZ-ZN-IDO
      *---------- 市場通貨簿価単価
           MOVE  SJTK-BOKA-TNK          OF  WK-TKMZZR00
             TO  SJTK-BOKA-TNK          OF  WK-TZ-ZN-IDO
      *---------- 運用通貨簿価単価
           MOVE  UYTK-BOKA-TNK          OF  WK-TKMZZR00
             TO  UYTK-BOKA-TNK          OF  WK-TZ-ZN-IDO
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  WK-TKMZZR00
             TO  BOKA-KWS               OF  WK-TZ-ZN-IDO
      *---------- 市場通貨払出単価
           MOVE  SJTK-H-TNK             OF  WK-TKMZZR00
             TO  SJTK-H-TNK             OF  WK-TZ-ZN-IDO
      *---------- 運用通貨払出単価
           MOVE  UYTK-H-TNK             OF  WK-TKMZZR00
             TO  UYTK-H-TNK             OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後簿価残高
           MOVE  SJTK-BOKAZN            OF  WK-TKMZZR00
             TO  SJTK-IDOG-BOKAZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後簿価残高
           MOVE  UYTK-BOKAZN            OF  WK-TKMZZR00
             TO  UYTK-IDOG-BOKAZN       OF  WK-TZ-ZN-IDO
      *---------- 異動後数量残高
           MOVE  SRYZN                  OF  WK-TKMZZR00
             TO  IDOG-SRYZN             OF  WK-TZ-ZN-IDO
      *---------- 異動後数量残高（利付）
           MOVE  SRYZN-RIT              OF  WK-TKMZZR00
             TO  IDOG-SRYZN-RIT         OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後前払金残
           MOVE  SJTK-PPAYZN            OF  WK-TKMZZR00
             TO  SJTK-IDOG-PPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後前払金残
           MOVE  UYTK-PPAYZN            OF  WK-TKMZZR00
             TO  UYTK-IDOG-PPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後前受金残
           MOVE  SJTK-ARECZN            OF  WK-TKMZZR00
             TO  SJTK-IDOG-ARECZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後前受金残
           MOVE  UYTK-ARECZN            OF  WK-TKMZZR00
             TO  UYTK-IDOG-ARECZN       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後仮払金残
           MOVE  SJTK-SPAYZN            OF  WK-TKMZZR00
             TO  SJTK-IDOG-SPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後仮払金残
           MOVE  UYTK-SPAYZN            OF  WK-TKMZZR00
             TO  UYTK-IDOG-SPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 建玉単価
           MOVE  TGYOKU-TNK             OF  WK-TKMZZR00
             TO  TGYOKU-TNK             OF  WK-TZ-ZN-IDO
      *---------- 建玉為替レート
           MOVE  TGYOKU-KWS-RATE        OF  WK-TKMZZR00
             TO  TGYOKU-KWS-RATE        OF  WK-TZ-ZN-IDO
      *---------- 建玉ブローカー
           MOVE  TGYOKU-BRK             OF  WK-TKMZZR00
             TO  TGYOKU-BRK             OF  WK-TZ-ZN-IDO
      *---------- 建玉約定日
           MOVE  TGYOKU-YKJ-YMD         OF  WK-TKMZZR00
             TO  TGYOKU-YKJ-YMD         OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉約定金額残
           MOVE  SJTK-TG-YJKNZN         OF  WK-TKMZZR00
             TO  SJTK-IDOG-TG-YJKNZN    OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉約定金額残
           MOVE  UYTK-TG-YJKNZN         OF  WK-TKMZZR00
             TO  UYTK-IDOG-TG-YJKNZN    OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉手数料残
           MOVE  SJTK-TG-TSRZN          OF  WK-TKMZZR00
             TO  SJTK-IDOG-TG-TSRZN     OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉手数料残
           MOVE  UYTK-TG-TSRZN          OF  WK-TKMZZR00
             TO  UYTK-IDOG-TG-TSRZN     OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉消費税残
           MOVE  SJTK-TG-S-TAXZN        OF  WK-TKMZZR00
             TO  SJTK-IDOG-TG-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉消費税残
           MOVE  UYTK-TG-S-TAXZN        OF  WK-TKMZZR00
             TO  UYTK-IDOG-TG-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉その他費用残
           MOVE  SJTK-TG-ELS-HIYOZN     OF  WK-TKMZZR00
             TO  SJTK-IDOG-TG-ELS-HZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉その他費用残
           MOVE  UYTK-TG-ELS-HIYOZN     OF  WK-TKMZZR00
             TO  UYTK-IDOG-TG-ELS-HZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉精算金額残
           MOVE  SJTK-TG-SSKGZN         OF  WK-TKMZZR00
             TO  SJTK-IDOG-TG-SSKGZN    OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉精算金額残
           MOVE  UYTK-TG-SSKGZN         OF  WK-TKMZZR00
             TO  UYTK-IDOG-TG-SSKGZN    OF  WK-TZ-ZN-IDO
      *---------- ＯＰ資産負債・買建売建フラグ
           MOVE  OP-TATE-FLG            OF  WK-TKMZZR00
             TO  OP-TATE-FLG            OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後源泉税還付予定額残高
           MOVE  SJTK-GSZKP-YTZN        OF  WK-TKMZZR00
             TO  SJTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後源泉税還付予定額残高
           MOVE  UYTK-GSZKP-YTZN        OF  WK-TKMZZR00
             TO  UYTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
      *---------- 決済通貨異動後源泉税還付予定額残高
           MOVE  KSTK-GSZKP-YTZN        OF  WK-TKMZZR00
             TO  KSTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後ノンカバー未収金残高
           MOVE  SJTK-NOCV-MSKZN        OF  WK-TKMZZR00
             TO  SJTK-IDOG-NOCV-MSKZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後ノンカバー未収金残高
           MOVE  UYTK-NOCV-MSKZN        OF  WK-TKMZZR00
             TO  UYTK-IDOG-NOCV-MSKZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後ノンカバー未払金残高
           MOVE  SJTK-NOCV-MBKZN        OF  WK-TKMZZR00
             TO  SJTK-IDOG-NOCV-MBKZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後ノンカバー未払金残高
           MOVE  UYTK-NOCV-MBKZN        OF  WK-TKMZZR00
             TO  UYTK-IDOG-NOCV-MBKZN   OF  WK-TZ-ZN-IDO
      *---------- 短期スタート・エンド経過利息
           MOVE  SHORT-STEN-KEKA-RSK    OF  WK-TKMZZR00
             TO  SHORT-STEN-KEKA-RSK    OF  WK-TZ-ZN-IDO
      *---------- 短期スタート日
           MOVE  SHORT-START-YMD        OF  WK-TKMZZR00
             TO  SHORT-START-YMD        OF  WK-TZ-ZN-IDO
      *---------- 短期エンド日
           MOVE  SHORT-END-YMD          OF  WK-TKMZZR00
             TO  SHORT-END-YMD          OF  WK-TZ-ZN-IDO
      *---------- 投資対象国コード
           MOVE  TSTSK-CD               OF  WK-TKMZZR00
             TO  TSTSK-CD               OF  WK-TZ-ZN-IDO
      *---------- 発行国コード
           MOVE  HAKO-CD                OF  WK-TKMZZR00
             TO  HAKO-CD                OF  WK-TZ-ZN-IDO
      *---------- 数量単位
           MOVE  SURYO-TANI             OF  WK-TKMZZR00
             TO  SURYO-TANI             OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後未払費用残
           MOVE  SJTK-MBHYZN            OF  WK-TKMZZR00
             TO  SJTK-IDOG-MBHYZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後未払費用残
           MOVE  UYTK-MBHYZN            OF  WK-TKMZZR00
             TO  UYTK-IDOG-MBHYZN       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後未払消費税残
           MOVE  SJTK-MB-S-TAXZN        OF  WK-TKMZZR00
             TO  SJTK-IDOG-MB-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後未払消費税残
           MOVE  UYTK-MB-S-TAXZN        OF  WK-TKMZZR00
             TO  UYTK-IDOG-MB-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後移管評価損益残
           MOVE  SJTK-IK-HKSEZN         OF  WK-TKMZZR00
             TO  SJTK-IDOG-IK-HKSEZN    OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後移管評価損益残
           MOVE  UYTK-IK-HKSEZN         OF  WK-TKMZZR00
             TO  UYTK-IDOG-IK-HKSEZN    OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後移管未収収益
           MOVE  SJTK-IK-MSSHEKI        OF  WK-TKMZZR00
             TO  SJTK-IDOG-IK-MSSHEKI   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後移管未収収益
           MOVE  UYTK-IK-MSSHEKI        OF  WK-TKMZZR00
             TO  UYTK-IDOG-IK-MSSHEKI   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後移管前払金評価損益残
           MOVE  UYTK-IK-PPHKZN         OF  WK-TKMZZR00
             TO  UYTK-IDOG-IK-PPHKZN    OF  WK-TZ-ZN-IDO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード  =["
      D             PTF-CD              OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             SIJO-TUKA-CD        OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード =["
      D             MEG-CD              OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ =["
      D             GYOKU-ID            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価  =["
      D             SJTK-BOKA-TNK       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価  =["
      D             UYTK-BOKA-TNK       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート =["
      D             BOKA-KWS            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価  =["
      D             SJTK-H-TNK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価  =["
      D             UYTK-H-TNK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高  =["
      D             SJTK-IDOG-BOKAZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高  =["
      D             UYTK-IDOG-BOKAZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高 =["
      D             IDOG-SRYZN          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高（利付）=["
      D             IDOG-SRYZN-RIT      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前払金残 =["
      D             SJTK-IDOG-PPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前払金残 =["
      D             UYTK-IDOG-PPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前受金残 =["
      D             SJTK-IDOG-ARECZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前受金残 =["
      D             UYTK-IDOG-ARECZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後仮払金残 =["
      D             SJTK-IDOG-SPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後仮払金残 =["
      D             UYTK-IDOG-SPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価 =["
      D             TGYOKU-TNK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート =["
      D             TGYOKU-KWS-RATE     OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー =["
      D             TGYOKU-BRK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日 =["
      D             TGYOKU-YKJ-YMD      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉約定金額残 =["
      D             SJTK-IDOG-TG-YJKNZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉約定金額残 =["
      D             UYTK-IDOG-TG-YJKNZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉手数料残 =["
      D             SJTK-IDOG-TG-TSRZN  OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉手数料残 =["
      D             UYTK-IDOG-TG-TSRZN  OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉消費税残 =["
      D             SJTK-IDOG-TG-S-TAXZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉消費税残 =["
      D             UYTK-IDOG-TG-S-TAXZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉その他費用残 =["
      D             SJTK-IDOG-TG-ELS-HZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉その他費用残 =["
      D             UYTK-IDOG-TG-ELS-HZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉精算金額残 =["
      D             SJTK-IDOG-TG-SSKGZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉精算金額残 =["
      D             UYTK-IDOG-TG-SSKGZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ =["
      D             OP-TATE-FLG         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後源泉税還付予定額残高 =["
      D             SJTK-IDOG-GSZKP-YTZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後源泉税還付予定額残高 =["
      D             UYTK-IDOG-GSZKP-YTZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨異動後源泉税還付予定額残高 =["
      D             KSTK-IDOG-GSZKP-YTZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未収金残高 =["
      D             SJTK-IDOG-NOCV-MSKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未収金残高 =["
      D             UYTK-IDOG-NOCV-MSKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未払金残高 =["
      D             SJTK-IDOG-NOCV-MBKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未払金残高 =["
      D             UYTK-IDOG-NOCV-MBKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未払金残高 =["
      D             UYTK-IDOG-NOCV-MBKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息 =["
      D             SHORT-STEN-KEKA-RSK OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日 =["
      D             SHORT-START-YMD     OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日  =["
      D             SHORT-END-YMD       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード =["
      D             TSTSK-CD            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード =["
      D             HAKO-CD             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":数量単位  =["
      D             SURYO-TANI          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払費用残 =["
      D             SJTK-IDOG-MBHYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払費用残 =["
      D             UYTK-IDOG-MBHYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払消費税残 =["
      D             SJTK-IDOG-MB-S-TAXZN
      D                                 OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払消費税残 =["
      D             UYTK-IDOG-MB-S-TAXZN
      D                                 OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管評価損益残 =["
      D             SJTK-IDOG-IK-HKSEZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管評価損益残 =["
      D             UYTK-IDOG-IK-HKSEZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管未収収益 =["
      D             SJTK-IDOG-IK-MSSHEKI OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管未収収益 =["
      D             UYTK-IDOG-IK-MSSHEKI OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管前払金評価損益残 =["
      D             UYTK-IDOG-IK-PPHKZN OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TZ-IDO-EDIT1-EXT.
           EXIT.
      ******************************************************************
      *    「別紙4-4 編集要領」
      ******************************************************************
       TZ-IDO-EDIT2-RTN       SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  WK-TZ-ZN-IDO
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  WK-TKMZGZ00
             TO  RIYO-CMP-CD            OF  WK-TZ-ZN-IDO
      *---------- ファンドコード
           MOVE  FUND-CD                OF  WK-TKMZGZ00
             TO  FUND-CD                OF  WK-TZ-ZN-IDO
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  WK-TKMZGZ00
             TO  PTF-CD                 OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後簿価残高
           MOVE  GNP-BOKAZN             OF  WK-TKMZGZ00
             TO  UYTK-IDOG-BOKAZN       OF  WK-TZ-ZN-IDO
      *---------- 異動後数量残高
           MOVE  GNP-SRYZN              OF  WK-TKMZGZ00
             TO  IDOG-SRYZN             OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉約定金額残
           MOVE  SHOKI-SET-KGK          OF  WK-TKMZGZ00
             TO  UYTK-IDOG-TG-YJKNZN    OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉精算金額残
           MOVE  SO-TN-KGK              OF  WK-TKMZGZ00
             TO  UYTK-IDOG-TG-SSKGZN    OF  WK-TZ-ZN-IDO
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード  =["
      D             PTF-CD              OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高 =["
      D             UYTK-IDOG-BOKAZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高 =["
      D             IDOG-SRYZN          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉約定金額残 =["
      D             UYTK-IDOG-TG-YJKNZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉精算金額残 =["
      D             UYTK-IDOG-TG-SSKGZN OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TZ-IDO-EDIT2-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.6.異動簿価・損益計算（物）
      ******************************************************************
       SMZJ1910-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  異動簿価・損益計算（物）処理 "
      D             " START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1910-INOUT
                       PARM-RTNPKG
                       FLG-SMZJ1910-160
      *---------- 取引データ
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TRHK-DATA
             TO  RIYO-CMP-CD            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TRHK-DATA
             TO  FUND-CD                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TRHK-DATA
             TO  PTF-CD                 OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TRHK-DATA
             TO  MEG-CD                 OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TRHK-DATA
             TO  SEC-SBT-CD             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TRHK-DATA
             TO  TATE-FLG               OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TRHK-DATA
             TO  GYOKU-ID               OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 取引連関ＩＤ
           MOVE  WK-THRK-ID             OF  WK-TRHK-DATA
             TO  THRK-ID                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引ＩＤ
           MOVE  WK-TARGET-TORI-ID      OF  WK-TRHK-DATA
             TO  TARGET-TORI-ID         OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 取引内容
           MOVE  WK-TORI-NAIY           OF  WK-TRHK-DATA
             TO  TORI-NAIY              OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 取引事由
           MOVE  WK-TORI-JIYU           OF  WK-TRHK-DATA
             TO  TORI-JIYU              OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TRHK-DATA
             TO  SJTK-CD                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 投資対象国コード
           MOVE  WK-TSTSK-CD            OF  WK-TRHK-DATA
             TO  TSTSK-CD               OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 発行国コード
           MOVE  WK-HAKO-CD             OF  WK-TRHK-DATA
             TO  HAKO-CD                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- １口注文ＩＤ
           MOVE  WK-ORDR-1K-ID          OF  WK-TRHK-DATA
             TO  ORDR-1K-ID             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 約定日
           MOVE  WK-YKJ-YMD             OF  WK-TRHK-DATA
             TO  YKJ-YMD                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 受渡日
           MOVE  WK-UKE-YMD             OF  WK-TRHK-DATA
             TO  UKE-YMD                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 効力発生日
           MOVE  WK-KOURYOKU-YMD        OF  WK-TRHK-DATA
             TO  KOURYOKU-YMD           OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- スタート日（放出日）
           MOVE  WK-ST-YMD              OF  WK-TRHK-DATA
             TO  ST-YMD                 OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 受渡ベースエンド日
           MOVE  WK-UKE-END-YMD         OF  WK-TRHK-DATA
             TO  UKE-END-YMD            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 保有目的
           MOVE  WK-POSSESSION-OBJECT   OF  WK-TRHK-DATA
             TO  POSSESSION-OBJECT      OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 資金決済方法
           MOVE  WK-KESAI-HOHO          OF  WK-TRHK-DATA
             TO  KESAI-HOHO             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地入出金額
           MOVE  WK-G-NSKG              OF  WK-TRHK-DATA
             TO  G-NSKG                 OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地ブローカー
           MOVE  WK-G-BRK               OF  WK-TRHK-DATA
             TO  G-BRK                  OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 経過利息区分
           MOVE  WK-KKRS-KBN            OF  WK-TRHK-DATA
             TO  KKRS-KBN               OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 数量単位
           MOVE  WK-SURYO-TANI          OF  WK-TRHK-DATA
             TO  SURYO-TANI             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 異動数量
           MOVE  WK-IDO-SURYO           OF  WK-TRHK-DATA
             TO  IDO-SURYO              OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 権利数量
           MOVE  WK-KENRI-SURYO         OF  WK-TRHK-DATA
             TO  KENRI-SURYO            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 約定単価
           MOVE  WK-YKJ-TANKA           OF  WK-TRHK-DATA
             TO  YKJ-TANKA              OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 為替レート（市場／運用）
           MOVE  WK-S-U-KWS             OF  WK-TRHK-DATA
             TO  S-U-KWS                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 為替差損益
           MOVE  WK-UYTK-KWS-SNEKI      OF  WK-TRHK-DATA
             TO  UYTK-KWS-SNEKI         OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 調整損益
           MOVE  WK-CHOSEI-SNEKI        OF  WK-TRHK-DATA
             TO  CHOSEI-SNEKI           OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 約定金額
           MOVE  WK-G-YJKG              OF  WK-TRHK-DATA
             TO  G-YJKG                 OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 受取利息金額
           MOVE  WK-UKETR-RSK-KG        OF  WK-TRHK-DATA
             TO  UKETR-RSK-KG           OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 入出金額（約定レート・運用通貨換算額）
           MOVE  WK-NSKG-Y-UY           OF  WK-TRHK-DATA
             TO  NSKG-Y-UY              OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 既経過利息（市場通貨換算額）
           MOVE  WK-S-KSG-G-KKKRS       OF  WK-TRHK-DATA
             TO  S-KSG-G-KKKRS          OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 既経過利息（運用通貨換算額）
           MOVE  WK-U-KSG-G-KKKRS       OF  WK-TRHK-DATA
             TO  U-KSG-G-KKKRS          OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 精算金額（市場通貨換算額）
           MOVE  WK-S-KSG-SSKG          OF  WK-TRHK-DATA
             TO  S-KSG-SSKG             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 精算金額（運用通貨換算額）
           MOVE  WK-U-KSG-G-SSKG        OF  WK-TRHK-DATA
             TO  U-KSG-SSKG             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 約定金額（市場通貨換算額）
           MOVE  WK-S-KSG-G-YJKG        OF  WK-TRHK-DATA
             TO  S-KSG-G-YJKG           OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 約定金額（運用通貨換算額）
           MOVE  WK-U-KSG-G-YJKG        OF  WK-TRHK-DATA
             TO  U-KSG-G-YJKG           OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 運用国手数料（市場通貨換算額）
           MOVE  WK-S-KSG-U-TSR         OF  WK-TRHK-DATA
             TO  S-KSG-U-TSR            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 運用国消費税（市場通貨換算額）
           MOVE  WK-S-KSG-U-SHZ         OF  WK-TRHK-DATA
             TO  S-KSG-U-SHZ            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 運用国その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-U-THY         OF  WK-TRHK-DATA
             TO  S-KSG-U-THY            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 運用国手数料（運用通貨換算額）
           MOVE  WK-U-KSG-U-TSR         OF  WK-TRHK-DATA
             TO  U-KSG-U-TSR            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 運用国消費税（運用通貨換算額）
           MOVE  WK-U-KSG-U-SHZ         OF  WK-TRHK-DATA
             TO  U-KSG-U-SHZ            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 運用国その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-U-THY         OF  WK-TRHK-DATA
             TO  U-KSG-U-THY            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地手数料（市場通貨換算額）
           MOVE  WK-S-KSG-G-TSR         OF  WK-TRHK-DATA
             TO  S-KSG-G-TSR            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地消費税（市場通貨換算額）
           MOVE  WK-S-KSG-G-SHZ         OF  WK-TRHK-DATA
             TO  S-KSG-G-SHZ            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地その他費用（市場通貨換算額）
           MOVE  WK-S-KSG-G-THY         OF  WK-TRHK-DATA
             TO  S-KSG-G-THY            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地手数料（運用通貨換算額）
           MOVE  WK-U-KSG-G-TSR         OF  WK-TRHK-DATA
             TO  U-KSG-G-TSR            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地消費税（運用通貨換算額）
           MOVE  WK-U-KSG-G-SHZ         OF  WK-TRHK-DATA
             TO  U-KSG-G-SHZ            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地その他費用（運用通貨換算額）
           MOVE  WK-U-KSG-G-THY         OF  WK-TRHK-DATA
             TO  U-KSG-G-THY            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地源泉税（市場通貨換算額）
           MOVE  WK-S-KSG-G-GSZ         OF  WK-TRHK-DATA
             TO  S-KSG-G-GSZ            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 現地源泉税（運用通貨換算額）
           MOVE  WK-U-KSG-G-GSZ         OF  WK-TRHK-DATA
             TO  U-KSG-G-GSZ            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 国内源泉税（運用通貨換算額）
           MOVE  WK-NAI-TAX-U-KSG       OF  WK-TRHK-DATA
             TO  NAI-TAX-U-KSG          OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 国内源泉税（市場通貨換算額）
           MOVE  WK-S-KSG-U-GSZ         OF  WK-TRHK-DATA
             TO  S-KSG-U-GSZ            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 日歩（市場通貨換算額）
           MOVE  WK-S-KSG-HIBU          OF  WK-TRHK-DATA
             TO  S-KSG-HIBU             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 逆日歩（市場通貨換算額）
           MOVE  WK-S-KSG-GHIBU         OF  WK-TRHK-DATA
             TO  S-KSG-GHIBU            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費（市場通貨換算額）
           MOVE  WK-S-KSG-KRH           OF  WK-TRHK-DATA
             TO  S-KSG-KRH              OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費消費税（市場通貨換算額）
           MOVE  WK-S-KSG-KRH-SHZ       OF  WK-TRHK-DATA
             TO  S-KSG-KRH-SHZ          OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 日歩（運用通貨換算額）
           MOVE  WK-U-KSG-HIBU          OF  WK-TRHK-DATA
             TO  U-KSG-HIBU             OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 逆日歩（運用通貨換算額）
           MOVE  WK-U-KSG-GHIBU         OF  WK-TRHK-DATA
             TO  U-KSG-GHIBU            OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費（運用通貨換算額）
           MOVE  WK-U-KSG-KRH           OF  WK-TRHK-DATA
             TO  U-KSG-KRH              OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費消費税（運用通貨換算額）
           MOVE  WK-U-KSG-KRH-SHZ       OF  WK-TRHK-DATA
             TO  U-KSG-KRH-SHZ          OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 異動確定区分
           MOVE  WK-IDO-KBN             OF  WK-TRHK-DATA
             TO  IDO-KBN                OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 商品別取引区分
           MOVE  WK-SHB-TORI-KBN        OF  WK-TRHK-DATA
             TO  SHB-TORI-KBN           OF  TORI-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 相対取引データ
      *----------  決済約定金額
           MOVE  WK-U-KSG-KS-YJKG       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-KS-YJKG          OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *----------  権利行使金額
           MOVE  WK-U-KSG-KRKS-KG       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-KRKS-KG          OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時約定金額（市場通貨）
           MOVE  WK-S-KSG-TH-YJKG       OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-YJKG          OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時約定金額（運用通貨）
           MOVE  WK-U-KSG-TH-YJKG       OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-YJKG          OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時現地手数料（市場通貨）
           MOVE  WK-S-KSG-TH-G-TSR      OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-TSR         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時現地消費税（市場通貨）
           MOVE  WK-S-KSG-TH-G-SHZ      OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-SHZ         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時現地その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-G-THY      OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-G-THY         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時運用国手数料（市場通貨）
           MOVE  WK-S-KSG-TH-U-TSR      OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-TSR         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時運用国消費税（市場通貨）
           MOVE  WK-S-KSG-TH-U-SHZ      OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-SHZ         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-U-THY      OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-U-THY         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時現地手数料（運用通貨）
           MOVE  WK-U-KSG-TH-G-TSR      OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-TSR         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時現地消費税（運用通貨）
           MOVE  WK-U-KSG-TH-G-SHZ      OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-SHZ         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時現地その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-G-THY      OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-G-THY         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時運用国手数料（運用通貨）
           MOVE  WK-U-KSG-TH-U-TSR      OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-TSR         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時運用国消費税（運用通貨）
           MOVE  WK-U-KSG-TH-U-SHZ      OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-SHZ         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-U-THY      OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-U-THY         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ現地手数料（市場通貨）
           MOVE  WK-S-KSG-HTOP-G-TSR    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-G-TSR       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ現地消費税（市場通貨）
           MOVE  WK-S-KSG-HTOP-G-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-G-SHZ       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ現地その他費用（市場通貨）
           MOVE  WK-S-KSG-HTOP-G-THY    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-G-THY       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ現地手数料（運用通貨）
           MOVE  WK-U-KSG-HTOP-G-TSR    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-G-TSR       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ現地消費税（運用通貨）
           MOVE  WK-U-KSG-HTOP-G-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-G-SHZ       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ現地その他費用（運用通貨）
           MOVE  WK-U-KSG-HTOP-G-THY    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-G-THY       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ運用国手数料（市場通貨）
           MOVE  WK-S-KSG-HTOP-U-TSR    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-U-TSR       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ運用国消費税（市場通貨）
           MOVE  WK-S-KSG-HTOP-U-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-U-SHZ       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-HTOP-U-THY    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-U-THY       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ運用国手数料（運用通貨）
           MOVE  WK-U-KSG-HTOP-U-TSR    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-U-TSR       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ運用国消費税（運用通貨）
           MOVE  WK-U-KSG-HTOP-U-SHZ    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-U-SHZ       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-HTOP-U-THY    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-U-THY       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ現地手数料（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-TSR   OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-TSR      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ現地消費税（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-SHZ   OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-SHZ      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ現地その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-OP-G-THY   OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-G-THY      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ現地手数料（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-TSR   OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-TSR      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ現地消費税（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-SHZ   OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-SHZ      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ現地その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-OP-G-THY   OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-G-THY      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ運用国手数料（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-TSR   OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-TSR      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ運用国消費税（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-SHZ   OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-SHZ      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ運用国その他費用（市場通貨）
           MOVE  WK-S-KSG-TH-OP-U-THY   OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-U-THY      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ運用国手数料（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-TSR   OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-TSR      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ運用国消費税（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-SHZ   OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-SHZ      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ運用国その他費用（運用通貨）
           MOVE  WK-U-KSG-TH-OP-U-THY   OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-U-THY      OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 決済単価
           MOVE  WK-KS-TANKA            OF  WK-AITAI-TRHK-DATA
             TO  KS-TANKA               OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時現地約定日
           MOVE  WK-TATE-G-YKJ-YMD      OF  WK-AITAI-TRHK-DATA
             TO  TATE-G-YKJ-YMD         OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 権利行使価格
           MOVE  WK-KRKS-KKK            OF  WK-AITAI-TRHK-DATA
             TO  KRKS-KKK               OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時単価
           MOVE  WK-TATE-TANKA          OF  WK-AITAI-TRHK-DATA
             TO  TATE-TANKA             OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ約定金額（市場通貨）
           MOVE  WK-S-KSG-HTOP-YJKG     OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-HTOP-YJKG        OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 引継ＯＰ約定金額（運用通貨）
           MOVE  WK-U-KSG-HTOP-YJKG     OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-HTOP-YJKG        OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ約定金額（市場通貨）
           MOVE  WK-S-KSG-TH-OP-YJKG    OF  WK-AITAI-TRHK-DATA
             TO  S-KSG-TH-OP-YJKG       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 建時ＯＰ約定金額（運用通貨）
           MOVE  WK-U-KSG-TH-OP-YJKG    OF  WK-AITAI-TRHK-DATA
             TO  U-KSG-TH-OP-YJKG       OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-AITAI-TRHK-DATA
             TO  TATE-FLG               OF  AITAI-TRHK-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 異動計算パターン
      *---------- 払出簿価計算方法
           MOVE  WK-DEBET-BOKA-CALC-HOU OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-CALC-HOU    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 払出簿価端数（市場通貨）
           MOVE  WK-DEBET-BOKA-HASU-BC  OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-HASU-BC     OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 払出単価桁数（市場通貨）
           MOVE  WK-DEBET-TNK-KETASU-BC OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-KETASU-BC    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 払出単価端数（市場通貨）
           MOVE  WK-DEBET-TNK-HASU-BC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-HASU-BC      OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 払出簿価端数（運用通貨）
           MOVE  WK-DEBET-BOKA-HASU-LC  OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-HASU-LC     OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 払出単価桁数（運用通貨）
           MOVE  WK-DEBET-TNK-KETASU-LC OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-KETASU-LC    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 払出単価端数（運用通貨）
           MOVE  WK-DEBET-TNK-HASU-LC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-HASU-LC      OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 簿価為替レート適用フラグ
           MOVE  WK-BOKA-KWS-TEKIYO-FLG OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-TEKIYO-FLG    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 簿価為替レート端数
           MOVE  WK-BOKA-KWS-HASU       OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-HASU          OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 簿価為替レート桁数
           MOVE  WK-BOKA-KWS-KETASU     OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-KETASU        OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 按分簿価端数
           MOVE  WK-ANB-BOKA-HASU       OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-BOKA-HASU          OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 按分単価端数
           MOVE  WK-ANB-TNK-HASU        OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-TNK-HASU           OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 按分単価桁数
           MOVE  WK-ANB-TNK-KETASU      OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-TNK-KETASU         OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 前払金償却分端数
           MOVE  WK-MAEKIN-SHOUKYK-HASU OF  WK-IDO-CALC-PATTERN-INFO
             TO  MAEKIN-SHOUKYK-HASU    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 売り続く限り同一コスト
           MOVE  WK-URI-TUDUKU-SAME-COST
                                        OF  WK-IDO-CALC-PATTERN-INFO
             TO  URI-TUDUKU-SAME-COST   OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 同一日は同一コスト
           MOVE  WK-SAME-YMD-SAME-COST  OF  WK-IDO-CALC-PATTERN-INFO
             TO  SAME-YMD-SAME-COST     OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 処理順序
           MOVE  WK-SYRI-JUN            OF  WK-IDO-CALC-PATTERN-INFO
             TO  SYRI-JUN               OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 前払金償却方法
           MOVE  WK-MAEKIN-SHOUKYK-HOU  OF  WK-IDO-CALC-PATTERN-INFO
             TO  MAEKIN-SHOUKYK-HOU     OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 新／旧簿価計算方法
           MOVE  WK-NEW-KYU-BOKA-CALC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  SIN-KYU-BOKA-CALC      OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.利用会社コード
           MOVE  RIYO-CMP-CD            OF  WK-TZ-ZN-IDO
             TO  RIYO-CMP-CD            OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.原取引ＩＤ
           MOVE  TORI-ID                OF  WK-TZ-ZN-IDO
             TO  TORI-ID                OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.取引事由
           MOVE  TORI-JIYU              OF  WK-TZ-ZN-IDO
             TO  TORI-JIYU              OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.赤黒区分
           MOVE  AKA-KBN                OF  WK-TZ-ZN-IDO
             TO  AKA-KBN                OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.異動後数量残高
           MOVE  IDOG-SRYZN             OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN             OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.異動後数量残高(利付)
           MOVE  IDOG-SRYZN-RIT         OF  WK-TZ-ZN-IDO
             TO  IDOG-SRYZN-RIT         OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後簿価残高
           MOVE  SJTK-IDOG-BOKAZN       OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-BOKAZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後簿価残高
           MOVE  UYTK-IDOG-BOKAZN       OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-BOKAZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨払出単価
           MOVE  SJTK-H-TNK             OF  WK-TZ-ZN-IDO
             TO  SJTK-H-TNK             OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨払出単価
           MOVE  UYTK-H-TNK             OF  WK-TZ-ZN-IDO
             TO  UYTK-H-TNK             OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.計上基準日
           MOVE  KEIJOU-KIJUNBI         OF  WK-TZ-ZN-IDO
             TO  KEIJOU-KIJUNBI         OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.異動計上順序
           MOVE  IDO-KJY-JUN            OF  WK-TZ-ZN-IDO
             TO  IDO-KJY-JUN            OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨簿価単価
           MOVE  SJTK-BOKA-TNK          OF  WK-TZ-ZN-IDO
             TO  SJTK-BOKA-TNK          OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨簿価単価
           MOVE  UYTK-BOKA-TNK          OF  WK-TZ-ZN-IDO
             TO  UYTK-BOKA-TNK          OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後建玉精算金額残
           MOVE  UYTK-IDOG-TG-SSKGZN    OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-SSKGZN    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後建玉約定金額残
           MOVE  SJTK-IDOG-TG-YJKNZN    OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-YJKNZN    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後建玉約定金額残
           MOVE  UYTK-IDOG-TG-YJKNZN    OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-YJKNZN    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後建玉手数料残
           MOVE  SJTK-IDOG-TG-TSRZN     OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-TSRZN     OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後建玉手数料残
           MOVE  UYTK-IDOG-TG-TSRZN     OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-TSRZN     OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後建玉消費税残
           MOVE  SJTK-IDOG-TG-S-TAXZN   OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-S-TAXZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後建玉消費税残
           MOVE  UYTK-IDOG-TG-S-TAXZN   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-S-TAXZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後建玉その他費用残
           MOVE  SJTK-IDOG-TG-ELS-HZN   OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-ELS-HZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後建玉その他費用残
           MOVE  UYTK-IDOG-TG-ELS-HZN   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-TG-ELS-HZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後建玉精算金額残
           MOVE  SJTK-IDOG-TG-SSKGZN    OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-TG-SSKGZN    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.オプションＬ／Ｓフラグ
           MOVE  OP-TATE-FLG            OF  WK-TZ-ZN-IDO
             TO  OP-L-S-FLG             OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後前払金残
           MOVE  UYTK-IDOG-PPAYZN       OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-PPAYZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後前払金残
           MOVE  SJTK-IDOG-PPAYZN       OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-PPAYZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後前受金残
           MOVE  UYTK-IDOG-ARECZN       OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-ARECZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後前受金残
           MOVE  SJTK-IDOG-ARECZN       OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-ARECZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後仮払金残
           MOVE  UYTK-IDOG-SPAYZN       OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-SPAYZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後仮払金残
           MOVE  SJTK-IDOG-SPAYZN       OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-SPAYZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後源泉税還付予定額残高
           MOVE  SJTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-GSZKP-YTZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後源泉税還付予定額残高
           MOVE  UYTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-GSZKP-YTZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後ノンカバー未収金残高
           MOVE  SJTK-IDOG-NOCV-MSKZN   OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-NOCV-MSKZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後ノンカバー未収金残高
           MOVE  UYTK-IDOG-NOCV-MSKZN   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-NOCV-MSKZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後ノンカバー未払金残高
           MOVE  SJTK-IDOG-NOCV-MBKZN   OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-NOCV-MBKZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後ノンカバー未払金残高
           MOVE  UYTK-IDOG-NOCV-MBKZN   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-NOCV-MBKZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.短期スタート・エンド経過利息
           MOVE  SHORT-STEN-KEKA-RSK    OF  WK-TZ-ZN-IDO
             TO  SHORT-STEN-KEKA-RSK    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.短期スタート日
           MOVE  SHORT-START-YMD        OF  WK-TZ-ZN-IDO
             TO  SHORT-START-YMD        OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.短期エンド日
           MOVE  SHORT-END-YMD          OF  WK-TZ-ZN-IDO
             TO  SHORT-END-YMD          OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨引継前受・前払プレミアム
           MOVE  SJTK-HT-PPAR-PMM       OF  WK-TZ-ZN-IDO
             TO  SJTK-HT-PPAR-PMM       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨引継前受・前払プレミアム
           MOVE  UYTK-HT-PPAR-PMM       OF  WK-TZ-ZN-IDO
             TO  UYTK-HT-PPAR-PMM       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後未払費用残
           MOVE  SJTK-IDOG-MBHYZN       OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-MBHYZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後未払費用残
           MOVE  UYTK-IDOG-MBHYZN       OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-MBHYZN       OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後未払消費税残
           MOVE  SJTK-IDOG-MB-S-TAXZN   OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-MB-S-TAXZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後未払消費税残
           MOVE  UYTK-IDOG-MB-S-TAXZN   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-MB-S-TAXZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後移管評価損益残
           MOVE  SJTK-IDOG-IK-HKSEZN    OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-IK-HKSEZN    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後移管評価損益残
           MOVE  UYTK-IDOG-IK-HKSEZN    OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-IK-HKSEZN    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨異動後移管未収収益
           MOVE  SJTK-IDOG-IK-MSSHEKI   OF  WK-TZ-ZN-IDO
             TO  SJTK-IDOG-IK-MSSHEKI   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後移管未収収益
           MOVE  UYTK-IDOG-IK-MSSHEKI   OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-IK-MSSHEKI   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.運用通貨異動後移管前払金評価損益残
           MOVE  UYTK-IDOG-IK-PPHKZN    OF  WK-TZ-ZN-IDO
             TO  UYTK-IDOG-IK-PPHKZN    OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.決済通貨異動後源泉税還付予定額残高
           MOVE  KSTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
             TO  KSTK-IDOG-GSZKP-YTZN   OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.ＯＰ資産負債・買建売建フラグ
           MOVE  OP-TATE-FLG            OF  WK-TZ-ZN-IDO
             TO  OP-TATE-FLG            OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.市場通貨コード
           MOVE  SIJO-TUKA-CD           OF  WK-TZ-ZN-IDO
             TO  SI-TU-CD               OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.数量単位
           MOVE  SURYO-TANI             OF  WK-TZ-ZN-IDO
             TO  SURYO-TANI             OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.建玉単価
           MOVE  TGYOKU-TNK             OF  WK-TZ-ZN-IDO
             TO  TGYOKU-TNK             OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.建玉為替レート
           MOVE  TGYOKU-KWS-RATE        OF  WK-TZ-ZN-IDO
             TO  TGYOKU-KWS-RATE        OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.建玉ブローカー
           MOVE  TGYOKU-BRK             OF  WK-TZ-ZN-IDO
             TO  TGYOKU-BRK             OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 直前残高異動.建玉約定日
           MOVE  TGYOKU-YKJ-YMD         OF  WK-TZ-ZN-IDO
             TO  TGYOKU-YKJ-YMD         OF  TZ-ZN-IDO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW02
             TO  SYORI-YMD              OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW02
             TO  KIDOU-ID               OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW02
             TO  RIYO-CMP-CD            OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.開始基準日の翌日
           MOVE  WK-KAISI-KJN-YMD-NEXT  OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD-NEXT     OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.約定レートコード
           MOVE  WK-YKJ-RATE-CD         OF  WK-TKMZBW02
             TO  YKJ-RATE-CD            OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW02
             TO  FUND-CD                OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW02
             TO  PTF-CD                 OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD      OF  WK-TKMZBW02
             TO  SKJN-PTN-CD            OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG      OF  WK-TKMZBW02
             TO  KH-KAIKEI-BASE-FLG     OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.約定主義会計フラグ
           MOVE  WK-YKJ-SYUGI-KAIKEI    OF  WK-TKMZBW02
             TO  YKJ-SYUGI-KAIKEI       OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.キャッシュフロー２回発生区分
           MOVE  WK-CASH-FLOW-KBN       OF  WK-TKMZBW02
             TO  CASH-FLOW-KBN          OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.保有目的
           MOVE  WK-POSSESSION-OBJ      OF  WK-TKMZBW02
             TO  POSSESSION-OBJECT      OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW02
             TO  SEC-SBT-CD             OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.運用通貨コード
           MOVE  WK-CAPITAL-TUKA-CD     OF  WK-TKMZBW02
             TO  UYTK-CD                OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.測定基準区分
           MOVE  WK-ST-KJN-KBN          OF  WK-TKMZBW02
             TO  ST-KJN-KBN             OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW02
             TO  KAISI-KJN-YMD          OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 基準日断面情報.基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW02
             TO  KJN-YMD                OF  KYJ-YMD-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.開始基準日
           MOVE  WK-KAISI-KJN-YMD       OF  WK-TKMZBW03
             TO  KAISI-KJN-YMD          OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  KJN-YMD                OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  TATE-FLG               OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  GYOKU-ID               OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.差分更新From日
           MOVE  WK-SABON-UPDATE-FROM   OF  WK-TKMZBW03
             TO  SABON-UPDATE-FROM      OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.銘柄種類２
           MOVE  WK-MEG-CD-SHRU2        OF  WK-TKMZBW03
             TO  MEG-CD-SHRU2           OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄別断面情報.再計算区分
           MOVE  WK-SAI-CALC-KBN        OF  WK-TKMZBW03
             TO  SAI-CALC-KBN           OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.処理順
           MOVE  WK-SRJUN               OF  WK-TARGET-TORI-INFO
             TO  SRJUN                  OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.原取引ＩＤ
           MOVE  WK-TORI-ID             OF  WK-TARGET-TORI-INFO
             TO  TORI-ID                OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.計上基準日
           MOVE  WK-KEIJOU-KIJUNBI      OF  WK-TARGET-TORI-INFO
             TO  KEIJOU-KIJUNBI         OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.増幅区分
           MOVE  WK-ZOFKU-KBN           OF  WK-TARGET-TORI-INFO
             TO  ZOFKU-KBN              OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.増幅赤黒区分
           MOVE  WK-ZOFKU-AKA-KBN       OF  WK-TARGET-TORI-INFO
             TO  ZOFKU-AKA-KBN          OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.換算後為替レート(市場／運用)
           MOVE  WK-K-S-U-KWS           OF  WK-TARGET-TORI-INFO
             TO  K-S-U-KWS              OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.換算後経過利息為替レート
           MOVE  WK-KKRS-KWS            OF  WK-TARGET-TORI-INFO
             TO  K-KEKA-RSK-KWS         OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 対象取引情報.受渡日
           MOVE  WK-UKE-YMD             OF  WK-TARGET-TORI-INFO
             TO  UKE-YMD                OF  TARGET-TORI-INFO
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 売り続く限りフラグ
           MOVE  WK-URI-TUDUKU-KAGI-FLG
             TO  URI-TUDUKU-KAGI-FLG    OF  PARM-SMZJ1910-ARG1
      *---------- 市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-TKMZBW03
             TO  SIJO-TUKA-CD           OF  PARM-SMZJ1910-ARG1
      *---------- 勘定科目出力商品名
           MOVE  WK-KNJ-KAMK-OUT-SYOHIN OF  WK-MEG-ZOK-INFO
             TO  KNJ-KAMK-OUT-SYOHIN    OF  PARM-SMZJ1910-ARG1
      *---------- 仕訳基準データ
      *---------- 為替差損益計上区分
           MOVE  WK-UKS-KJY-KBN         OF  WK-HIYO-KJY-M-KBN
             TO  UKS-KJY-KBN            OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 手数料用売買損益に含むフラグ
           MOVE  WK-TESRY-BN-FLG        OF  WK-HIYO-KJY-M-KBN
             TO  TESRY-BBSNEKI-FLG      OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 消費税用売買損益に含むフラグ
           MOVE  WK-SHOHI-TAX-BN-FLG    OF  WK-HIYO-KJY-M-KBN
             TO  SHOHI-TAX-BBSNEKI-FLG  OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- その他費用用売買損益に含むフラグ
           MOVE  WK-ELS-HIYO-BN-FLG     OF  WK-HIYO-KJY-M-KBN
             TO  ELS-HIYO-BBSNEKI-FLG   OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 日歩用売買損益に含むフラグ
           MOVE  WK-HIBU-BBSNEKI-FLG    OF  WK-HIYO-KJY-M-KBN
             TO  HIBU-BBSNEKI-FLG       OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 逆日歩用売買損益に含むフラグ
           MOVE  WK-GHIBU-BBSNEKI-FLG   OF  WK-HIYO-KJY-M-KBN
             TO  GHIBU-BBSNEKI-FLG      OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費用売買損益に含むフラグ
           MOVE  WK-KRH-BBSNEKI-FLG     OF  WK-HIYO-KJY-M-KBN
             TO  KRH-BBSNEKI-FLG        OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費消費税用売買損益に含むフラグ
           MOVE  WK-KRH-SHZ-BBSNEKI-FLG OF  WK-HIYO-KJY-M-KBN
             TO  KRH-SHZ-BBSNEKI-FLG    OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 手数料を市場取得金額に含めるフラグ
           MOVE  WK-TESRY-SJST-KN-FLG   OF  WK-HIYO-KJY-M-KBN
             TO  TESRY-SJST-KN-FLG      OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 消費税を市場取得金額に含めるフラグ
           MOVE  WK-SHOHI-TAX-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
             TO  SHOHI-TAX-SJST-KN-FLG  OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- その他費用を市場取得金額に含めるフラグ
           MOVE  WK-ELS-HIYO-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
             TO  ELS-HIYO-SJST-KN-FLG   OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 日歩を市場取得金額に含めるフラグ
           MOVE  WK-KSG-HIBU-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
             TO  KSG-HIBU-SJST-KN-FLG   OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 逆日歩を市場取得金額に含めるフラグ
           MOVE  WK-KSG-GHIBU-SJST-KN-FLG
                                        OF  WK-HIYO-KJY-M-KBN
             TO  KSG-GHIBU-SJST-KN-FLG  OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費を市場取得金額に含めるフラグ
           MOVE  WK-KSG-SJST-KN-FLG     OF  WK-HIYO-KJY-M-KBN
             TO  KSG-SJST-KN-FLG        OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 管理費消費税を市場取得金額に含めるフラグ
           MOVE  WK-KSG-KRH-SJST-KN-FLG OF  WK-HIYO-KJY-M-KBN
             TO  KSG-KRH-SJST-KN-FLG    OF  SKJN-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- キャッシュフロー2回有効フラグ
           MOVE  WK-CASH-FLOW-2-FLG     OF  WORK-AREA
             TO  CASH-FLOW-2-FLG        OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄属性取得フラグ
           MOVE  FLG-MEG-ZOK
             TO  MEG-ZOK-FLG            OF  PARM-SMZJ1910-ARG1
      *---------- 約定ベース受渡順フラグ
           MOVE  WK-YKJ-UKE-JUN-FLG
             TO  YKJ-UKE-JUN-FLG        OF  PARM-SMZJ1910-ARG1
      *---------- 乗算/除算区分
           MOVE  WK-JZ-JS-KBN
             TO  JZ-JS-KBN              OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄属性コールプット区分
           MOVE  WK-CALL-PUT-KBN
             TO  MEG-CALL-PUT-KBN       OF  PARM-SMZJ1910-ARG1
      *---------- ゼロクーポン債フラグ
           MOVE  WK-0-CUPON-FLG
             TO  ZERO-CUPON-FLG         OF  PARM-SMZJ1910-ARG1
      *---------- 銘柄属性データ
      *---------- 初期利払起算日
           MOVE  WK-SHOKI-RB-KS-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-KS-YMD     OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 初期利払日
           MOVE  WK-SHOKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RIBAR-YMD        OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 最終利払起算日
           MOVE  WK-LAST-RB-KS-YMD      OF  WK-MEG-ZOK-INFO
             TO  LAST-RIBAR-KISAN-YMD   OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 最終利払日
           MOVE  WK-SHUKI-RIBAR-YMD     OF  WK-MEG-ZOK-INFO
             TO  LAST-RIBAR-YMD         OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 利払回数
           MOVE  WK-RIBAR-KAISU         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-KAISU            OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 利払日１
           MOVE  WK-RIBAR-YMD-1         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-1            OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 利払日２
           MOVE  WK-RIBAR-YMD-2         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-2            OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 利払日３
           MOVE  WK-RIBAR-YMD-3         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-3            OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 利払日４
           MOVE  WK-RIBAR-YMD-4         OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-4            OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *----------  利払日休日処理区分
           MOVE  WK-RIBAR-YMD-QJT-SR-KBN
                                        OF  WK-MEG-ZOK-INFO
             TO  RIBAR-YMD-QJT-SR-KBN   OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *----------  初期利払日休日処理区分
           MOVE  WK-SHOKI-RB-YMD-QJT-KBN
                                        OF  WK-MEG-ZOK-INFO
             TO  SHOKI-RB-YMD-QJT-KBN   OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *----------  終期利払日休日処理区分
           MOVE  WK-SHUKI-RB-YMD-QJT-KBN
                                        OF  WK-MEG-ZOK-INFO
             TO  SHUKI-RB-YMD-QJT-KBN   OF  MEG-SKJO-DATA
                                        OF  PARM-SMZJ1910-ARG1
      *---------- 利付／割引区分
           MOVE  WK-RITUKI-WARI-KBN     OF  WK-MEG-ZOK-INFO
             TO  RITUKI-WARI-KBN        OF  PARM-SMZJ1910-ARG1
      *----------  勘定異動／残高作成
           MOVE  I-KJIDO-ZANSK          OF  WK-DENBUN-IN
             TO  KJIDO-ZANSK            OF  PARM-SMZJ1910-ARG1
      *----------  為替換算情報データエリア
           MOVE  WK-TBL-TKJCKK00-AREA
             TO  KWS-GET-AREA           OF  PARM-SMZJ1910-ARG1
      *----------  国内外国区分
           MOVE  WK-NAI-GAI-KBN
             TO  NAI-GAI-KBN            OF  PARM-SMZJ1910-ARG1
      *---------- 決済口座１通貨コード
           MOVE  WK-KOZA1-TUKA-CD       OF  WK-TRHK-DATA
             TO  KOZA1-TUKA-CD          OF  PARM-SMZJ1910-ARG1
      *---------- 決済口座２通貨コード
           MOVE  WK-KOZA2-TUKA-CD       OF  WK-TRHK-DATA
             TO  KOZA2-TUKA-CD          OF  PARM-SMZJ1910-ARG1
      *---------- 入出金額（決済レート・運用通貨換算額）
           MOVE  WK-NSKG-K-UY           OF  WK-TRHK-DATA
             TO  NSKG-K-UY              OF  PARM-SMZJ1910-ARG1
      *---------- 決済口座１入出金額
           MOVE  WK-KOZA1-NSKG          OF  WK-TRHK-DATA
             TO  KOZA1-NSKG             OF  PARM-SMZJ1910-ARG1
      *----------  銘柄属性データ2.償還日
           MOVE  WK-SHOKAN-YMD          OF  WK-MEG-ZOK-INFO
             TO  SHOKAN-YMD
             OF  MEG-SKJO-DATA-2        OF  PARM-SMZJ1910-ARG1
      *----------  銘柄属性データ2.償還日休日処理区分
           MOVE  WK-SHOKAN-QJT-SYRI-KBN OF  WK-MEG-ZOK-INFO
             TO  SHOKAN-QJT-SYRI-KBN
             OF  MEG-SKJO-DATA-2        OF  PARM-SMZJ1910-ARG1
      *----------  銘柄属性データ3.利払日数
           MOVE  WK-RIBAR-NISU          OF  WK-MEG-ZOK-INFO
             TO  KEKA-NISU
             OF  MEG-SKJO-DATA-3        OF  PARM-SMZJ1910-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":取引データ:"
      D    DISPLAY  CNS-PGM-ID":資産負債・利用会社コード=["
      D             RIYO-CMP-CD         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・ファンドコード=["
      D             FUND-CD             OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・ポートフォリオコード=["
      D             PTF-CD              OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・銘柄コード=["
      D             MEG-CD              OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・証券種別コード=["
      D             SEC-SBT-CD          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・玉ID=["
      D             GYOKU-ID            OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ＩＤ=["
      D             THRK-ID             OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引ＩＤ=["
      D             TARGET-TORI-ID      OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引内容=["
      D             TORI-NAIY           OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":取引事由=["
      D             TORI-JIYU           OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             SJTK-CD             OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード=["
      D             TSTSK-CD            OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード=["
      D             HAKO-CD             OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":１口注文ＩＤ=["
      D             ORDR-1K-ID          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定日=["
      D            YKJ-YMD              OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受渡日=["
      D             UKE-YMD             OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":効力発生日=["
      D             KOURYOKU-YMD        OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":スタート日（放出日）=["
      D             ST-YMD              OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受渡ベースエンド日=["
      D             UKE-END-YMD         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":保有目的=["
      D             POSSESSION-OBJECT   OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金決済方法=["
      D             KESAI-HOHO          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地入出金額=["
      D             G-NSKG              OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地ブローカー=["
      D             G-BRK               OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":経過利息区分=["
      D             KKRS-KBN            OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":数量単位=["
      D             SURYO-TANI          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動数量=["
      D             IDO-SURYO           OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":権利数量=["
      D             KENRI-SURYO         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定単価=["
      D             YKJ-TANKA           OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":為替レート（市場／運用）=["
      D             S-U-KWS             OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益=["
      D             UYTK-KWS-SNEKI      OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":調整損益=["
      D             CHOSEI-SNEKI        OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定金額=["
      D             G-YJKG              OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受取利息金額=["
      D             UKETR-RSK-KG        OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":入出金額（約定レート・運用通貨換算額)=["
      D             NSKG-Y-UY           OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":既経過利息（市場通貨換算額）=["
      D             S-KSG-G-KKKRS       OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":既経過利息（運用通貨換算額）=["
      D             U-KSG-G-KKKRS       OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":精算金額（市場通貨換算額）=["
      D             S-KSG-SSKG          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":精算金額（運用通貨換算額）=["
      D             U-KSG-SSKG          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定金額（市場通貨換算額）=["
      D             S-KSG-G-YJKG        OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定金額（運用通貨換算額）=["
      D             U-KSG-G-YJKG        OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用国手数料（市場通貨換算額）=["
      D             S-KSG-U-TSR         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用国消費税（市場通貨換算額）=["
      D             S-KSG-U-SHZ         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用国その他費用（市場通貨換算額）=["
      D             S-KSG-U-THY         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用国手数料（運用通貨換算額）=["
      D             U-KSG-U-TSR         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用国消費税（運用通貨換算額）=["
      D             U-KSG-U-SHZ         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用国その他費用（運用通貨換算額）=["
      D             U-KSG-U-THY         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地手数料（市場通貨換算額）=["
      D             S-KSG-G-TSR         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地消費税（市場通貨換算額）=["
      D             S-KSG-G-SHZ         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地その他費用（市場通貨換算額）=["
      D             S-KSG-G-THY         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地手数料（運用通貨換算額）=["
      D             U-KSG-G-TSR         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地消費税（運用通貨換算額）=["
      D             U-KSG-G-SHZ         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地その他費用（運用通貨換算額）=["
      D             U-KSG-G-THY         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地源泉税（市場通貨換算額）=["
      D             S-KSG-G-GSZ         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":現地源泉税（運用通貨換算額）=["
      D             U-KSG-G-GSZ         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":国内源泉税（運用通貨換算額）=["
      D             NAI-TAX-U-KSG       OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":国内源泉税（市場通貨換算額）=["
      D             S-KSG-U-GSZ         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":日歩（市場通貨換算額）=["
      D             S-KSG-HIBU          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩（市場通貨換算額）=["
      D             S-KSG-GHIBU         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費（市場通貨換算額）=["
      D             S-KSG-KRH           OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税（市場通貨換算額）=["
      D             S-KSG-KRH-SHZ       OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":日歩（運用通貨換算額）=["
      D             U-KSG-HIBU          OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩（運用通貨換算額）=["
      D             U-KSG-GHIBU         OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費（運用通貨換算額）=["
      D             U-KSG-KRH           OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税（運用通貨換算額）=["
      D             U-KSG-KRH-SHZ       OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動確定区分=["
      D             IDO-KBN             OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":商品別取引区分=["
      D             SHB-TORI-KBN        OF  TORI-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":相対取引データ:"
      D    DISPLAY  CNS-PGM-ID":決済約定金額=["
      D             U-KSG-KS-YJKG       OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":権利行使金額=["
      D             U-KSG-KRKS-KG       OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時約定金額（市場通貨）=["
      D             S-KSG-TH-YJKG       OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時約定金額（運用通貨）=["
      D             U-KSG-TH-YJKG       OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（市場通貨）=["
      D             S-KSG-TH-G-TSR      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（市場通貨）=["
      D             S-KSG-TH-G-SHZ      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（市場通貨）=["
      D             S-KSG-TH-G-THY      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（市場通貨）=["
      D             S-KSG-TH-U-TSR      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（市場通貨）=["
      D             S-KSG-TH-U-SHZ      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（市場通貨）=["
      D             S-KSG-TH-U-THY      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地手数料（運用通貨）=["
      D             U-KSG-TH-G-TSR      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地消費税（運用通貨）=["
      D             U-KSG-TH-G-SHZ      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地その他費用（運用通貨）=["
      D             U-KSG-TH-G-THY      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国手数料（運用通貨）=["
      D             U-KSG-TH-U-TSR      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国消費税（運用通貨）=["
      D             U-KSG-TH-U-SHZ      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時運用国その他費用（運用通貨）=["
      D             U-KSG-TH-U-THY      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地手数料（市場通貨）=["
      D             S-KSG-HTOP-G-TSR    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地消費税（市場通貨）=["
      D             S-KSG-HTOP-G-SHZ    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地その他費用（市場通貨）=["
      D             S-KSG-HTOP-G-THY    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地手数料（運用通貨）=["
      D             U-KSG-HTOP-G-TSR    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地消費税（運用通貨）=["
      D             U-KSG-HTOP-G-SHZ    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ現地その他費用（運用通貨）=["
      D             U-KSG-HTOP-G-THY    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国手数料（市場通貨）=["
      D             S-KSG-HTOP-U-TSR    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国消費税（市場通貨）=["
      D             S-KSG-HTOP-U-SHZ    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国その他費用（市場通貨）=["
      D             S-KSG-HTOP-U-THY    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国手数料（運用通貨）=["
      D             U-KSG-HTOP-U-TSR    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国消費税（運用通貨）=["
      D             U-KSG-HTOP-U-SHZ    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ運用国その他費用（運用通貨）=["
      D             U-KSG-HTOP-U-THY    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（市場通貨）=["
      D             S-KSG-TH-OP-G-TSR   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（市場通貨）=["
      D             S-KSG-TH-OP-G-SHZ   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（市場通貨）=["
      D             S-KSG-TH-OP-G-THY   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地手数料（運用通貨）=["
      D             U-KSG-TH-OP-G-TSR   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地消費税（運用通貨）=["
      D             U-KSG-TH-OP-G-SHZ   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ現地その他費用（運用通貨）=["
      D             U-KSG-TH-OP-G-THY   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（市場通貨）=["
      D             S-KSG-TH-OP-U-TSR   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（市場通貨）=["
      D             S-KSG-TH-OP-U-SHZ   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（市場通貨）=["
      D             S-KSG-TH-OP-U-THY   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国手数料（運用通貨）=["
      D             U-KSG-TH-OP-U-TSR   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国消費税（運用通貨）=["
      D             U-KSG-TH-OP-U-SHZ   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ運用国その他費用（運用通貨）=["
      D             U-KSG-TH-OP-U-THY   OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決済単価=["
      D             KS-TANKA            OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時現地約定日=["
      D             TATE-G-YKJ-YMD      OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":権利行使価格=["
      D             KRKS-KKK            OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時単価=["
      D             TATE-TANKA          OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ約定金額（市場通貨）=["
      D             S-KSG-HTOP-YJKG     OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":引継ＯＰ約定金額（運用通貨）=["
      D             U-KSG-HTOP-YJKG     OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ約定金額（市場通貨）=["
      D             S-KSG-TH-OP-YJKG    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":建時ＯＰ約定金額（運用通貨）=["
      D             U-KSG-TH-OP-YJKG    OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             TATE-FLG            OF  AITAI-TRHK-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン:"
      D    DISPLAY  CNS-PGM-ID":払出簿価計算方法=["
      D             DEBET-BOKA-CALC-HOU OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（市場通貨）=["
      D             DEBET-BOKA-HASU-BC  OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（市場通貨）=["
      D             DEBET-TNK-KETASU-BC OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（市場通貨）=["
      D             DEBET-TNK-HASU-BC   OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（運用通貨）=["
      D             DEBET-BOKA-HASU-LC  OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（運用通貨）=["
      D             DEBET-TNK-KETASU-LC OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（運用通貨）=["
      D             DEBET-TNK-HASU-LC   OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート適用フラグ=["
      D             BOKA-KWS-TEKIYO-FLG OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート端数=["
      D             BOKA-KWS-HASU       OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート桁数=["
      D             BOKA-KWS-KETASU     OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分簿価端数=["
      D             ANB-BOKA-HASU       OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分単価端数=["
      D             ANB-TNK-HASU        OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分単価桁数=["
      D             ANB-TNK-KETASU      OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前払金償却分端数=["
      D             MAEKIN-SHOUKYK-HASU OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限り同一コスト=["
      D             URI-TUDUKU-SAME-COST    OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":同一日は同一コスト=["
      D             SAME-YMD-SAME-COST  OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理順序=["
      D             SYRI-JUN            OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前払金償却方法=["
      D             MAEKIN-SHOUKYK-HOU  OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":新／旧簿価計算方法=["
      D             SIN-KYU-BOKA-CALC   OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.利用会社コード=["
      D             RIYO-CMP-CD         OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.原取引ＩＤ=["
      D             TORI-ID             OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.取引事由=["
      D             TORI-JIYU           OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.赤黒区分=["
      D            AKA-KBN              OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.異動後数量残高=["
      D             IDOG-SRYZN          OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.異動後数量残高(利付)=["
      D             IDOG-SRYZN-RIT      OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後簿価残高=["
      D             SJTK-IDOG-BOKAZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後簿価残高=["
      D             UYTK-IDOG-BOKAZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨払出単価=["
      D             SJTK-H-TNK          OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨払出単価=["
      D             UYTK-H-TNK          OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.計上基準日=["
      D             KEIJOU-KIJUNBI      OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.異動計上順序=["
      D             IDO-KJY-JUN         OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨簿価単価=["
      D             SJTK-BOKA-TNK       OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨簿価単価=["
      D             UYTK-BOKA-TNK       OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後建玉精算"
      D    "金額残=["UYTK-IDOG-TG-SSKGZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後建玉約定"
      D    "金額残=["SJTK-IDOG-TG-YJKNZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後建玉約定"
      D    "金額残=["UYTK-IDOG-TG-YJKNZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後建玉手数"
      D    "料残=[" SJTK-IDOG-TG-TSRZN  OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後建玉手数"
      D    "料残=[" UYTK-IDOG-TG-TSRZN  OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後建玉消費"
      D    "税残=["  SJTK-IDOG-TG-S-TAXZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後建玉消費"
      D    "税残=["  UYTK-IDOG-TG-S-TAXZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後建玉その他"
      D    "費用残=[" SJTK-IDOG-TG-ELS-HZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後建玉その他"
      D    "費用残=[" UYTK-IDOG-TG-ELS-HZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後建玉精算金"
      D    "額残=[" SJTK-IDOG-TG-SSKGZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.オプションＬ／Ｓフラグ=["
      D             OP-L-S-FLG          OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後前払金残=["
      D             UYTK-IDOG-PPAYZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後前払金残=["
      D             SJTK-IDOG-PPAYZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後前受金残=["
      D             UYTK-IDOG-ARECZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後前受金残=["
      D             SJTK-IDOG-ARECZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後仮払金残=["
      D             UYTK-IDOG-SPAYZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後仮払金残=["
      D             SJTK-IDOG-SPAYZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後源泉税還付予"
      D    "定額残高=["SJTK-IDOG-GSZKP-YTZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後源泉税還付予"
      D    "定額残高=["UYTK-IDOG-GSZKP-YTZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後ノンカバー未"
      D    "収金残高=["SJTK-IDOG-NOCV-MSKZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後ノンカバー未"
      D    "収金残高=["UYTK-IDOG-NOCV-MSKZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.短期スタート・エンド"
      D    "経過利息=["SHORT-STEN-KEKA-RSK  OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.短期スタート日"
      D    "=["SHORT-START-YMD          OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.短期エンド日"
      D    "=["SHORT-END-YMD            OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後ノンカバー未"
      D    "払金残高=["SJTK-IDOG-NOCV-MBKZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後ノンカバー未"
      D    "払金残高=["UYTK-IDOG-NOCV-MBKZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨引継前受・前払プレ"
      D    "ミアム=["SJTK-HT-PPAR-PMM    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨引継前受・前払プレ"
      D    "ミアム=[" UYTK-HT-PPAR-PMM    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後未払費用残=["
      D             SJTK-IDOG-MBHYZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後未払費用残=["
      D             UYTK-IDOG-MBHYZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後未払消費"
      D    "税残=[" SJTK-IDOG-MB-S-TAXZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後未払消費"
      D    "税残=[" UYTK-IDOG-MB-S-TAXZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後移管評価損"
      D    "益残=[" SJTK-IDOG-IK-HKSEZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後移管評価損"
      D    "益残=[" UYTK-IDOG-IK-HKSEZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨異動後移管未収"
      D    "収益=[" SJTK-IDOG-IK-MSSHEKI    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後移管未収"
      D    "収益=["UYTK-IDOG-IK-MSSHEKI    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.運用通貨異動後移管前払金評"
      D    "価損益残=["UYTK-IDOG-IK-PPHKZN OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.決済通貨異動後源泉税還付予"
      D    "定額残高=["KSTK-IDOG-GSZKP-YTZN    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.ＯＰ資産負債・"
      D    "買建売建フラグ=["OP-TATE-FLG    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.市場通貨コード=["
      D                     SI-TU-CD    OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.建玉単価=["
      D                     TGYOKU-TNK  OF  TZ-ZN-IDO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.建玉為替レート=["
      D                     TGYOKU-KWS-RATE    OF  TZ-ZN-IDO
      D                                        OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.建玉ブローカー=["
      D                     TGYOKU-BRK         OF  TZ-ZN-IDO
      D                                        OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前残高異動.建玉約定日=["
      D                     TGYOKU-YKJ-YMD     OF  TZ-ZN-IDO
      D                                        OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DEF-HASU-SYRI-PARM
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.処理実行日=["
      D             SYORI-YMD           OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.起動ID=["
      D             KIDOU-ID            OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.利用会社コード=["
      D             RIYO-CMP-CD         OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日の翌日=["
      D             KAISI-KJN-YMD-NEXT  OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.約定レートコード=["
      D             YKJ-RATE-CD         OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.ファンドコード=["
      D             FUND-CD             OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.ポートフォリオコード=["
      D             PTF-CD              OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.仕訳基準パターンコード=["
      D             SKJN-PTN-CD         OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基本会計ベースフラグ=["
      D             KH-KAIKEI-BASE-FLG  OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.約定主義会計フラグ=["
      D             YKJ-SYUGI-KAIKEI    OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.キャッシュフロー２回発生"
      D    "区分=[" CASH-FLOW-KBN       OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.保有目的=["
      D             POSSESSION-OBJECT   OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.証券種別コード=["
      D             SEC-SBT-CD          OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.運用通貨コード=["
      D             UYTK-CD             OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.測定基準区分=["
      D             ST-KJN-KBN          OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.開始基準日=["
      D             KAISI-KJN-YMD       OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基準日=["
      D             KJN-YMD             OF  KYJ-YMD-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.処理実行日=["
      D             SYORI-YMD           OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.起動ID=["
      D             KIDOU-ID            OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.利用会社コード=["
      D             RIYO-CMP-CD         OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ファンドコード=["
      D             FUND-CD             OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ポートフォリオコード=["
      D             PTF-CD              OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.開始基準日=["
      D             KAISI-KJN-YMD       OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.基準日=["
      D             KJN-YMD             OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄コード=["
      D             MEG-CD              OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.証券種別コード=["
      D             SEC-SBT-CD          OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.資産負債・買建売建"
      D    "フラグ=["TATE-FLG           OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.玉ID=["
      D             GYOKU-ID            OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.差分更新From日=["
      D             SABON-UPDATE-FROM   OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄種類２=["
      D             MEG-CD-SHRU2        OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.再計算区分=["
      D             SAI-CALC-KBN        OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.処理順=["
      D             SRJUN               OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.原取引ＩＤ=["
      D             TORI-ID             OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.計上基準日=["
      D             KEIJOU-KIJUNBI      OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.増幅区分=["
      D             ZOFKU-KBN           OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.増幅赤黒区分=["
      D             ZOFKU-AKA-KBN       OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.換算後為替レート(市場／"
      D             "運用)=["K-S-U-KWS  OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.換算後経過利息為替レート=["
      D             K-KEKA-RSK-KWS      OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象取引情報.受渡日=["
      D             UKE-YMD             OF  TARGET-TORI-INFO
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":売り続く限りフラグ=["
      D            URI-TUDUKU-KAGI-FLG  OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード=["
      D             SIJO-TUKA-CD        OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":勘定科目出力商品名=["
      D             KNJ-KAMK-OUT-SYOHIN OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":仕訳基準データ:"
      D    DISPLAY  CNS-PGM-ID":為替差損益計上区分=["
      D             UKS-KJY-KBN         OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料用売買損益に含むフラグ=["
      D             TESRY-BBSNEKI-FLG   OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税用売買損益に含むフラグ=["
      D             SHOHI-TAX-BBSNEKI-FLG   OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用用売買損益に含むフラグ=["
      D             ELS-HIYO-BBSNEKI-FLG    OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":日歩用売買損益に含むフラグ=["
      D             HIBU-BBSNEKI-FLG    OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩用売買損益に含むフラグ=["
      D             GHIBU-BBSNEKI-FLG   OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費用売買損益に含むフラグ=["
      D             KRH-BBSNEKI-FLG     OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税用売買損益に含むフラグ=["
      D             KRH-SHZ-BBSNEKI-FLG OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":手数料を市場取得金額に含めるフラグ=["
      D             TESRY-SJST-KN-FLG   OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":消費税を市場取得金額に含めるフラグ=["
      D             SHOHI-TAX-SJST-KN-FLG   OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":その他費用を市場取得金額に含める"
      D    "フラグ=["ELS-HIYO-SJST-KN-FLG    OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":日歩を市場取得金額に含めるフラグ=["
      D             KSG-HIBU-SJST-KN-FLG    OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":逆日歩を市場取得金額に含めるフラグ=["
      D             KSG-GHIBU-SJST-KN-FLG   OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費を市場取得金額に含めるフラグ=["
      D             KSG-SJST-KN-FLG     OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":管理費消費税を市場取得金額に含める"
      D    "フラグ=["KSG-KRH-SJST-KN-FLG OF  SKJN-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー2回有効フラグ=["
      D             CASH-FLOW-2-FLG     OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性取得フラグ=["
      D             MEG-ZOK-FLG         OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":約定ベース受渡順フラグ=["
      D             YKJ-UKE-JUN-FLG     OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":乗算/除算区分=["
      D             JZ-JS-KBN           OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性コールプット区分=["
      D             MEG-CALL-PUT-KBN    OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ゼロクーポン債フラグ=["
      D             ZERO-CUPON-FLG      OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄属性データ:"
      D    DISPLAY  CNS-PGM-ID":初期利払起算日 =["
      D             SHOKI-RIBAR-KS-YMD  OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日 =["
      D             SHOKI-RIBAR-YMD     OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":最終利払起算日 =["
      D           LAST-RIBAR-KISAN-YMD  OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":最終利払日 =["
      D             LAST-RIBAR-YMD      OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払回数 =["
      D             RIBAR-KAISU         OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日１ =["
      D             RIBAR-YMD-1         OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日２ =["
      D             RIBAR-YMD-2         OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日３ =["
      D             RIBAR-YMD-3         OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日４ =["
      D             RIBAR-YMD-4         OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利払日休日処理区分 =["
      D             RIBAR-YMD-QJT-SR-KBN
      D                                 OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":初期利払日休日処理区分 =["
      D             SHOKI-RB-YMD-QJT-KBN
      D                                 OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":終期利払日休日処理区分 =["
      D             SHUKI-RB-YMD-QJT-KBN
      D                                 OF  MEG-SKJO-DATA
      D                                 OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利付／割引区分 =["
      D             RITUKI-WARI-KBN     OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":勘定異動／残高作成 =["
      D             KJIDO-ZANSK         OF  PARM-SMZJ1910-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":為替換算情報データエリア =["
      *             KWS-GET-AREA        OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":国内外国区分 =["
      D             NAI-GAI-KBN         OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１通貨コード=["
      D             KOZA1-TUKA-CD       OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決済口座２通貨コード=["
      D             KOZA2-TUKA-CD       OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":入出金額(決済レート・運用通貨換算額)=["
      D             NSKG-K-UY           OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":決済口座１入出金額=["
      D             KOZA1-NSKG          OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID "銘柄属性データ2.償還日  =["
      D             SHOKAN-YMD          OF
      D             MEG-SKJO-DATA-2     OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID "銘柄属性データ2.償還日休日処理区分  =["
      D             SHOKAN-QJT-SYRI-KBN OF
      D             MEG-SKJO-DATA-2     OF  PARM-SMZJ1910-ARG1"]"
      D    DISPLAY  CNS-PGM-ID "銘柄属性データ3.利払日数 =["
      D             KEKA-NISU OF
      D             MEG-SKJO-DATA-3     OF  PARM-SMZJ1910-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1910"             USING  PARM-SMZJ1910-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1910)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- @ ワーク警告情報数 ←  リターンパッケージ.警告情報数
             MOVE  WARN-INFO-SU         OF  PARM-SMZJ1910-ARG2
               TO  WK-WARN-INFO-KN
      *---------- ワーク警告情報 ← リターンパッケージ.警告情報
             MOVE  WARN-INFO            OF  PARM-SMZJ1910-ARG2
               TO  WK-WARN-INFO
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報数 =["WK-WARN-INFO-KN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報   =["WK-WARN-INFO   "]"
      *-----------------------------------------------------------------
      *---------- A警告メッセージ出力
             PERFORM  WARN-MSG-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報数 =["WK-WARN-INFO-KN"]"
      *-----------------------------------------------------------------
             IF  WK-WARN-INFO-KN = ZERO
             THEN
               CONTINUE
             ELSE
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークメッセージ種類 =["WK-MSG-SYO"]"
      *-----------------------------------------------------------------
               IF  WK-MSG-SYO = ZERO
               THEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
                 IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
                 THEN
                   MOVE  CNS-MT-JS-200    TO  WK-MT-JIKKOU-STATUS
                 ELSE
                   CONTINUE
                 END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
                 IF  WK-RETURN-CD < CNS-RTN-BT2
                 THEN
                   MOVE  CNS-RTN-BT2      TO  WK-RETURN-CD
                 ELSE
                   CONTINUE
                 END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D    "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- C)ワーク基準日断面情報.進捗ステータス（基準日） ← '200'(警告終了)
                 IF  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02 < CNS-MT-JS-200
                 THEN
                   MOVE  CNS-MT-JS-200
                     TO  WK-STK-STS-KJN-YMD OF  WK-TKMZBW02
                 ELSE
                   CONTINUE
                 END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D    "(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
               IF  WK-MSG-SYO = CNS-1
               THEN
                 IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-270
                 THEN
      *---------- ワーク明細単位実行ステータス
                   MOVE  CNS-MT-JS-270          TO  WK-MT-JIKKOU-STATUS
                 ELSE
                   CONTINUE
                 END-IF
                 IF  WK-RETURN-CD < CNS-RTN-BT4
                 THEN
      *---------- ワークリターンコード
                   MOVE  CNS-RTN-BT4          TO  WK-RETURN-CD
                 ELSE
                   CONTINUE
                 END-IF
                 IF  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 < CNS-MT-JS-270
                 THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）
                   MOVE  CNS-MT-JS-270        TO  WK-STK-STS-KJN-YMD
                                              OF  WK-TKMZBW02
                 ELSE
                   CONTINUE
                 END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報."
      D             "進捗ステータス（基準日） =["
      D             WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             END-IF
           ELSE
             IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
              =  CNS-RTN-113
             THEN
      *---------- ワークポートフォリオ情報.ファンドコード
               MOVE  WK-FUND-CD         OF  WK-PTF-INFO
                 TO  WK-FUND-CD         OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
               MOVE  WK-PTF-CD          OF  WK-PTF-INFO
                 TO  WK-PTF-CD          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
               MOVE  WK-MKY-KJN-YMD-FROM
                 TO  WK-KJN-YMD-FROM    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
               MOVE  WK-SITEI-TO        OF  WK-DENBUN-KAISEKI-INFO
                 TO  WK-KJN-YMD-TO      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M08のメッセージID
               MOVE  CNS-MSG-E000429
                 TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '対象前払金'
               MOVE  CNS-TK-MOJI-61
                 TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
      *---------- ←'原取引ID：'対象取引情報.原取引ID
               STRING  CNS-MSG-12,
                       WK-TORI-ID       OF  WK-TARGET-TORI-INFO
                                            DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
               COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワーク明細単位実行ステータス ← '275'(業務エラー(明細続行不可))
               MOVE  CNS-MT-JS-275      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード  ←  '6'(業務エラー（明細続行不可）)
               MOVE  CNS-RTN-BT6        TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）  ←  '275'(業務エラー(明細続行不可))
               MOVE  CNS-MT-JS-275
                 TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
               PERFORM  KJN-YMD-END-RTN
             ELSE
               IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
                =  CNS-RTN-160
               THEN
      *---------- ワークポートフォリオ情報.ファンドコード
                 MOVE  WK-FUND-CD         OF  WK-PTF-INFO
                   TO  WK-FUND-CD         OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
                 MOVE  WK-PTF-CD          OF  WK-PTF-INFO
                   TO  WK-PTF-CD          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
                 MOVE  WK-MKY-KJN-YMD-FROM
                   TO  WK-KJN-YMD-FROM    OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
                 MOVE  WK-SITEI-TO        OF  WK-DENBUN-KAISEKI-INFO
                   TO  WK-KJN-YMD-TO      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M08のメッセージID
                 MOVE  CNS-MSG-E000429
                   TO  WK-MSG-ID          OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- 'CB転換・ワラント行使の関連'
                 MOVE  CNS-TK-MOJI-76
                   TO  WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ ←
      *---------- '原取引ID：'対象取引情報.原取引ID
                 STRING  CNS-MSG-12,
                         WK-TORI-ID       OF  WK-TARGET-TORI-INFO
                                              DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG      OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
                 COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- ワーク明細単位実行ステータス ← '270'(業務エラー（続行可能）)
                 MOVE  CNS-MT-JS-270      TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード  ←  '4'(業務エラー（続行可能）)
                 MOVE  CNS-RTN-BT4        TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日）  ←  '270'(業務エラー（続行可能）)
                 MOVE  CNS-MT-JS-270
                   TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- ・次の対象取引情報データのフェッチ処理へ進む 4.3.1.2
                 MOVE  CNS-1  TO  FLG-SMZJ1910-160
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-SMZJ1910-160 =["
      D             FLG-SMZJ1910-160"]"
      *-----------------------------------------------------------------
               ELSE
      *---------- ワークエラーパッケージを編集
                 INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
                 MOVE  CNS-POS-106        TO  WK-ERR-POS
                 PERFORM  ERR-MSG-1-RTN
               END-IF
             END-IF
           END-IF
      *---------- 3)
           IF  FLG-SMZJ1910-160 = CNS-1
           THEN
             CONTINUE
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SMZJ1910のリターンパッケージ."
      D             "残高異動計算データ.市場通貨異動後仮払金残=["
      D             SJTK-IDOG-SPAYZN    OF  ZN-IDO-CALC-DATE
      D                                 OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動."
      D             "市場通貨異動後仮払金残=["
      D             SJTK-IDOG-SPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":SMZJ1910のリターンパッケージ."
      D             "残高異動計算データ.運用通貨異動後仮払金残=["
      D             UYTK-IDOG-SPAYZN    OF  ZN-IDO-CALC-DATE
      D                                 OF  PARM-SMZJ1910-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前残高異動."
      D             "運用通貨異動後仮払金残=["
      D             UYTK-IDOG-SPAYZN    OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
             IF  (SJTK-IDOG-SPAYZN        OF  ZN-IDO-CALC-DATE
                                          OF  PARM-SMZJ1910-ARG2 >
                 SJTK-IDOG-SPAYZN         OF  WK-TZ-ZN-IDO)
             OR  (UYTK-IDOG-SPAYZN        OF  ZN-IDO-CALC-DATE
                                          OF  PARM-SMZJ1910-ARG2 >
                 UYTK-IDOG-SPAYZN         OF  WK-TZ-ZN-IDO)
             THEN
               MOVE  CNS-SPLU-TORI-FLG    TO  WK-SPAY-PLUS-TORI-FLG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク仮払金増加の取引存在フラグ=["
      D             WK-SPAY-PLUS-TORI-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象取引情報.計上基準日=["
      D             WK-KEIJOU-KIJUNBI   OF  WK-TARGET-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク仮払金増加の取引計上基準日=["
      D             WK-SPAY-PLUS-TRKJ-KJB"]"
      *-----------------------------------------------------------------
               IF  WK-KEIJOU-KIJUNBI      OF  WK-TARGET-TORI-INFO >
                                              WK-SPAY-PLUS-TRKJ-KJB
               THEN
                 MOVE  WK-KEIJOU-KIJUNBI  OF  WK-TARGET-TORI-INFO
                   TO  WK-SPAY-PLUS-TRKJ-KJB
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク仮払金増加の取引計上基準日=["
      D             WK-SPAY-PLUS-TRKJ-KJB"]"
      *-----------------------------------------------------------------
             ELSE
               CONTINUE
             END-IF
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動簿価.損益計算（物）処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1910-EXT.
           EXIT.
      ******************************************************************
      *    4.3.1.7.直前異動セット
      ******************************************************************
       TZ-IDO-CALC-EDIT-RTN   SECTION.
      *-----------------------------------------------------------------
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  PARM-SMZJ1910-ARG2
             TO  RIYO-CMP-CD            OF  WK-TZ-ZN-IDO
      *---------- ファンドコード
           MOVE  FUND-CD                OF  PARM-SMZJ1910-ARG2
             TO  FUND-CD                OF  WK-TZ-ZN-IDO
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  PARM-SMZJ1910-ARG2
             TO  PTF-CD                 OF  WK-TZ-ZN-IDO
      *---------- 原取引ID
           MOVE  TORI-ID                OF  PARM-SMZJ1910-ARG2
             TO  TORI-ID                OF  WK-TZ-ZN-IDO
      *---------- 計上基準日
           MOVE  KEIJOU-KIJUNBI         OF  PARM-SMZJ1910-ARG2
             TO  KEIJOU-KIJUNBI         OF  WK-TZ-ZN-IDO
      *---------- 赤黒区分
           MOVE  AKA-KBN                OF  PARM-SMZJ1910-ARG2
             TO  AKA-KBN                OF  WK-TZ-ZN-IDO
      *---------- 誤計上
           MOVE  ERR-KJY-NO             OF  PARM-SMZJ1910-ARG2
             TO  ERR-KJY-NO             OF  WK-TZ-ZN-IDO
      *---------- 誤計上区分
           MOVE  ERR-KJY-KBN            OF  PARM-SMZJ1910-ARG2
             TO  ERR-KJY-KBN            OF  WK-TZ-ZN-IDO
      *---------- 取引連関ID
           MOVE  THRK-ID                OF  PARM-SMZJ1910-ARG2
             TO  THRK-ID                OF  WK-TZ-ZN-IDO
      *---------- 証券種別コード
           MOVE  SEC-SBT-CD             OF  PARM-SMZJ1910-ARG2
             TO  SEC-SBT-CD             OF  WK-TZ-ZN-IDO
      *---------- 取引内容
           MOVE  TORI-NAIY              OF  PARM-SMZJ1910-ARG2
             TO  TORI-NAIY              OF  WK-TZ-ZN-IDO
      *---------- 取引事由
           MOVE  TORI-JIYU              OF  PARM-SMZJ1910-ARG2
             TO  TORI-JIYU              OF  WK-TZ-ZN-IDO
      *---------- 市場通貨コード
           MOVE  SIJO-TUKA-CD           OF  PARM-SMZJ1910-ARG2
             TO  SIJO-TUKA-CD           OF  WK-TZ-ZN-IDO
      *---------- 銘柄コード
           MOVE  MEG-CD                 OF  PARM-SMZJ1910-ARG2
             TO  MEG-CD                 OF  WK-TZ-ZN-IDO
      *---------- 資産負債・買建売建フラグ
           MOVE  TATE-FLG               OF  PARM-SMZJ1910-ARG2
             TO  TATE-FLG               OF  WK-TZ-ZN-IDO
      *---------- 玉ＩＤ
           MOVE  GYOKU-ID               OF  PARM-SMZJ1910-ARG2
             TO  GYOKU-ID               OF  WK-TZ-ZN-IDO
      *---------- 約定日
           MOVE  YKJ-YMD                OF  PARM-SMZJ1910-ARG2
             TO  YKJ-YMD                OF  WK-TZ-ZN-IDO
      *---------- 受渡日
           MOVE  UKE-YMD                OF  PARM-SMZJ1910-ARG2
             TO  UKE-YMD                OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動簿価
           MOVE  SJTK-IDO-BOKA          OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDO-BOKA          OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動簿価
           MOVE  UYTK-IDO-BOKA          OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDO-BOKA          OF  WK-TZ-ZN-IDO
      *---------- 市場通貨簿価単価
           MOVE  SJTK-BOKA-TNK          OF  PARM-SMZJ1910-ARG2
             TO  SJTK-BOKA-TNK          OF  WK-TZ-ZN-IDO
      *---------- 運用通貨簿価単価
           MOVE  UYTK-BOKA-TNK          OF  PARM-SMZJ1910-ARG2
             TO  UYTK-BOKA-TNK          OF  WK-TZ-ZN-IDO
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  PARM-SMZJ1910-ARG2
             TO  BOKA-KWS               OF  WK-TZ-ZN-IDO
      *---------- 市場通貨払出簿価
           MOVE  SJTK-H-BOKA            OF  PARM-SMZJ1910-ARG2
             TO  SJTK-H-BOKA            OF  WK-TZ-ZN-IDO
      *---------- 運用通貨払出簿価
           MOVE  UYTK-H-BOKA            OF  PARM-SMZJ1910-ARG2
             TO  UYTK-H-BOKA            OF  WK-TZ-ZN-IDO
      *---------- 市場通貨払出単価
           MOVE  SJTK-H-TNK             OF  PARM-SMZJ1910-ARG2
             TO  SJTK-H-TNK             OF  WK-TZ-ZN-IDO
      *---------- 運用通貨払出単価
           MOVE  UYTK-H-TNK             OF  PARM-SMZJ1910-ARG2
             TO  UYTK-H-TNK             OF  WK-TZ-ZN-IDO
      *---------- 異動数量
           MOVE  IDO-SURYO              OF  PARM-SMZJ1910-ARG2
             TO  IDO-SURYO              OF  WK-TZ-ZN-IDO
      *---------- 異動数量（利付）
           MOVE  IDO-SURYO-RIT          OF  PARM-SMZJ1910-ARG2
             TO  IDO-SURYO-RIT          OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後簿価残高
           MOVE  SJTK-IDOG-BOKAZN       OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-BOKAZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後簿価残高
           MOVE  UYTK-IDOG-BOKAZN       OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-BOKAZN       OF  WK-TZ-ZN-IDO
      *---------- 異動後数量残高
           MOVE  IDOG-SRYZN             OF  PARM-SMZJ1910-ARG2
             TO  IDOG-SRYZN             OF  WK-TZ-ZN-IDO
      *---------- 異動後数量残高（利付）
           MOVE  IDOG-SRYZN-RIT         OF  PARM-SMZJ1910-ARG2
             TO  IDOG-SRYZN-RIT         OF  WK-TZ-ZN-IDO
      *---------- 市場通貨前払金異動額
           MOVE  SJTK-PPAYIDOG          OF  PARM-SMZJ1910-ARG2
             TO  SJTK-PPAYIDOG          OF  WK-TZ-ZN-IDO
      *---------- 運用通貨前払金異動額
           MOVE  UYTK-PPAYIDOG          OF  PARM-SMZJ1910-ARG2
             TO  UYTK-PPAYIDOG          OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後前払金残
           MOVE  SJTK-IDOG-PPAYZN       OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-PPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後前払金残
           MOVE  UYTK-IDOG-PPAYZN       OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-PPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後前受金残
           MOVE  SJTK-IDOG-ARECZN       OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-ARECZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後前受金残
           MOVE  UYTK-IDOG-ARECZN       OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-ARECZN       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後仮払金残
           MOVE  SJTK-IDOG-SPAYZN       OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-SPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後仮払金残
           MOVE  UYTK-IDOG-SPAYZN       OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-SPAYZN       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨売買損益
           MOVE  SJTK-BBSNEKI           OF  PARM-SMZJ1910-ARG2
             TO  SJTK-BBSNEKI           OF  WK-TZ-ZN-IDO
      *---------- 運用通貨売買損益
           MOVE  UYTK-BBSNEKI           OF  PARM-SMZJ1910-ARG2
             TO  UYTK-BBSNEKI           OF  WK-TZ-ZN-IDO
      *---------- 為替差損益
           MOVE  UYTK-KWS-SNEKI         OF  PARM-SMZJ1910-ARG2
             TO  UYTK-KWS-SNEKI         OF  WK-TZ-ZN-IDO
      *---------- 為替差損益（利金）
           MOVE  UYTK-KWS-SNEKI-RK      OF  PARM-SMZJ1910-ARG2
             TO  UYTK-KWS-SNEKI-RK      OF  WK-TZ-ZN-IDO
      *---------- 為替差損益（市場）
           MOVE  UYTK-KWS-SNEKI-SJ      OF  PARM-SMZJ1910-ARG2
             TO  UYTK-KWS-SNEKI-SJ      OF  WK-TZ-ZN-IDO
      *---------- 市場通貨手数料
           MOVE  SJTK-TSR               OF  PARM-SMZJ1910-ARG2
             TO  SJTK-TSR               OF  WK-TZ-ZN-IDO
      *---------- 運用通貨手数料
           MOVE  UYTK-TSR               OF  PARM-SMZJ1910-ARG2
             TO  UYTK-TSR               OF  WK-TZ-ZN-IDO
      *---------- 市場通貨消費税
           MOVE  SJTK-S-TAX             OF  PARM-SMZJ1910-ARG2
             TO  SJTK-S-TAX             OF  WK-TZ-ZN-IDO
      *---------- 運用通貨消費税
           MOVE  UYTK-S-TAX             OF  PARM-SMZJ1910-ARG2
             TO  UYTK-S-TAX             OF  WK-TZ-ZN-IDO
      *---------- 市場通貨源泉税
           MOVE  SJTK-GENSEN-TAX        OF  PARM-SMZJ1910-ARG2
             TO  SJTK-GENSEN-TAX        OF  WK-TZ-ZN-IDO
      *---------- 運用通貨源泉税
           MOVE  UYTK-GENSEN-TAX        OF  PARM-SMZJ1910-ARG2
             TO  UYTK-GENSEN-TAX        OF  WK-TZ-ZN-IDO
      *---------- 市場通貨その他損益
           MOVE  SJTK-ELS-SNEKI         OF  PARM-SMZJ1910-ARG2
             TO  SJTK-ELS-SNEKI         OF  WK-TZ-ZN-IDO
      *---------- 運用通貨その他損益
           MOVE  UYTK-ELS-SNEKI         OF  PARM-SMZJ1910-ARG2
             TO  UYTK-ELS-SNEKI         OF  WK-TZ-ZN-IDO
      *---------- 市場通貨利金等損益勘定
           MOVE  SJTK-RKSEKJ            OF  PARM-SMZJ1910-ARG2
             TO  SJTK-RKSEKJ            OF  WK-TZ-ZN-IDO
      *---------- 運用通貨利金等損益勘定
           MOVE  UYTK-RKSEKJ            OF  PARM-SMZJ1910-ARG2
             TO  UYTK-RKSEKJ            OF  WK-TZ-ZN-IDO
      *---------- 異動計上順序
           MOVE  IDO-KJY-JUN            OF  PARM-SMZJ1910-ARG2
             TO  IDO-KJY-JUN            OF  WK-TZ-ZN-IDO
      *---------- 建玉単価
           MOVE  TGYOKU-TNK             OF  PARM-SMZJ1910-ARG2
             TO  TGYOKU-TNK             OF  WK-TZ-ZN-IDO
      *---------- 建玉為替レート
           MOVE  TGYOKU-KWS-RATE        OF  PARM-SMZJ1910-ARG2
             TO  TGYOKU-KWS-RATE        OF  WK-TZ-ZN-IDO
      *---------- 建玉ブローカー
           MOVE  TGYOKU-BRK             OF  PARM-SMZJ1910-ARG2
             TO  TGYOKU-BRK             OF  WK-TZ-ZN-IDO
      *---------- 建玉約定日
           MOVE  TGYOKU-YKJ-YMD         OF  PARM-SMZJ1910-ARG2
             TO  TGYOKU-YKJ-YMD         OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉約定金額残
           MOVE  SJTK-IDOG-TG-YJKNZN    OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-TG-YJKNZN    OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉約定金額残
           MOVE  UYTK-IDOG-TG-YJKNZN    OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-TG-YJKNZN    OF  WK-TZ-ZN-IDO
      *---------- 市場通貨建玉手数料
           MOVE  SJTK-TG-TSR            OF  PARM-SMZJ1910-ARG2
             TO  SJTK-TG-TSR            OF  WK-TZ-ZN-IDO
      *---------- 運用通貨建玉手数料
           MOVE  UYTK-TG-TSR            OF  PARM-SMZJ1910-ARG2
             TO  UYTK-TG-TSR            OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉手数料残
           MOVE  SJTK-IDOG-TG-TSRZN     OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-TG-TSRZN     OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉手数料残
           MOVE  UYTK-IDOG-TG-TSRZN     OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-TG-TSRZN     OF  WK-TZ-ZN-IDO
      *---------- 市場通貨建玉消費税
           MOVE  SJTK-TG-S-TAX          OF  PARM-SMZJ1910-ARG2
             TO  SJTK-TG-S-TAX          OF  WK-TZ-ZN-IDO
      *---------- 運用通貨建玉消費税
           MOVE  UYTK-TG-S-TAX          OF  PARM-SMZJ1910-ARG2
             TO  UYTK-TG-S-TAX          OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉消費税残
           MOVE  SJTK-IDOG-TG-S-TAXZN   OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-TG-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉消費税残
           MOVE  UYTK-IDOG-TG-S-TAXZN   OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-TG-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨建玉その他費用
           MOVE  SJTK-TG-ELS-HIYO       OF  PARM-SMZJ1910-ARG2
             TO  SJTK-TG-ELS-HIYO       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨建玉その他費用
           MOVE  UYTK-TG-ELS-HIYO       OF  PARM-SMZJ1910-ARG2
             TO  UYTK-TG-ELS-HIYO       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉その他費用残
           MOVE  SJTK-IDOG-TG-ELS-HZN   OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-TG-ELS-HZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉その他費用残
           MOVE  UYTK-IDOG-TG-ELS-HZN   OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-TG-ELS-HZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨建玉精算金額
           MOVE  SJTK-TG-SSKG           OF  PARM-SMZJ1910-ARG2
             TO  SJTK-TG-SSKG           OF  WK-TZ-ZN-IDO
      *---------- 運用通貨建玉精算金額
           MOVE  UYTK-TG-SSKG           OF  PARM-SMZJ1910-ARG2
             TO  UYTK-TG-SSKG           OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後建玉精算金額残
           MOVE  SJTK-IDOG-TG-SSKGZN    OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-TG-SSKGZN    OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後建玉精算金額残
           MOVE  UYTK-IDOG-TG-SSKGZN    OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-TG-SSKGZN    OF  WK-TZ-ZN-IDO
      *---------- 市場通貨引継前受・前払プレミアム
           MOVE  SJTK-HT-PPAR-PMM       OF  PARM-SMZJ1910-ARG2
             TO  SJTK-HT-PPAR-PMM       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨引継前受・前払プレミアム
           MOVE  UYTK-HT-PPAR-PMM       OF  PARM-SMZJ1910-ARG2
             TO  UYTK-HT-PPAR-PMM       OF  WK-TZ-ZN-IDO
      *---------- ＯＰ資産負債・買建売建フラグ
           MOVE  OP-TATE-FLG            OF  PARM-SMZJ1910-ARG2
             TO  OP-TATE-FLG            OF  WK-TZ-ZN-IDO
      *---------- 市場通貨源泉税還付予定異動額
           MOVE  SJTK-GSZKP-YTIDOG      OF  PARM-SMZJ1910-ARG2
             TO  SJTK-GSZKP-YTIDOG      OF  WK-TZ-ZN-IDO
      *---------- 運用通貨源泉税還付予定異動額
           MOVE  UYTK-GSZKP-YTIDOG      OF  PARM-SMZJ1910-ARG2
             TO  UYTK-GSZKP-YTIDOG      OF  WK-TZ-ZN-IDO
      *----------  決済通貨源泉税還付予定異動額
           MOVE  KSTK-GSZKP-YTIDOG      OF  PARM-SMZJ1910-ARG2
             TO  KSTK-GSZKP-YTIDOG      OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後源泉税還付予定額残高
           MOVE  SJTK-IDOG-GSZKP-YTZN   OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後源泉税還付予定額残高
           MOVE  UYTK-IDOG-GSZKP-YTZN   OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
      *---------- 決済通貨異動後源泉税還付予定額残高
           MOVE  KSTK-IDOG-GSZKP-YTZN   OF  PARM-SMZJ1910-ARG2
             TO  KSTK-IDOG-GSZKP-YTZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後ノンカバー未収金残高
           MOVE  SJTK-IDOG-NOCV-MSKZN   OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-NOCV-MSKZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後ノンカバー未収金残高
           MOVE  UYTK-IDOG-NOCV-MSKZN   OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-NOCV-MSKZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後ノンカバー未払金残高
           MOVE  SJTK-IDOG-NOCV-MBKZN   OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-NOCV-MBKZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後ノンカバー未払金残高
           MOVE  UYTK-IDOG-NOCV-MBKZN   OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-NOCV-MBKZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後未払費用残
           MOVE  SJTK-IDOG-MBHYZN       OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-MBHYZN       OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後未払費用残
           MOVE  UYTK-IDOG-MBHYZN       OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-MBHYZN       OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後未払消費税残
           MOVE  SJTK-IDOG-MB-S-TAXZN   OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-MB-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後未払消費税残
           MOVE  UYTK-IDOG-MB-S-TAXZN   OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-MB-S-TAXZN   OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後移管評価損益残
           MOVE  SJTK-IDOG-IK-HKSEZN    OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-IK-HKSEZN    OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後移管評価損益残
           MOVE  UYTK-IDOG-IK-HKSEZN    OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-IK-HKSEZN    OF  WK-TZ-ZN-IDO
      *---------- 市場通貨異動後移管未収収益
           MOVE  SJTK-IDOG-IK-MSSHEKI   OF  PARM-SMZJ1910-ARG2
             TO  SJTK-IDOG-IK-MSSHEKI   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後移管未収収益
           MOVE  UYTK-IDOG-IK-MSSHEKI   OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-IK-MSSHEKI   OF  WK-TZ-ZN-IDO
      *---------- 運用通貨異動後移管前払金評価損益残
           MOVE  UYTK-IDOG-IK-PPHKZN    OF  PARM-SMZJ1910-ARG2
             TO  UYTK-IDOG-IK-PPHKZN    OF  WK-TZ-ZN-IDO
      *---------- 削除区分
           MOVE  SAKUJO-KBN             OF  PARM-SMZJ1910-ARG2
             TO  SAKUJO-KBN             OF  WK-TZ-ZN-IDO
      *---------- 短期スタート・エンド経過利息
           MOVE  SHORT-STEN-KEKA-RSK    OF  PARM-SMZJ1910-ARG2
             TO  SHORT-STEN-KEKA-RSK    OF  WK-TZ-ZN-IDO
      *---------- 短期スタート日
           MOVE  SHORT-START-YMD        OF  PARM-SMZJ1910-ARG2
             TO  SHORT-START-YMD        OF  WK-TZ-ZN-IDO
      *---------- 短期エンド日
           MOVE  SHORT-END-YMD          OF  PARM-SMZJ1910-ARG2
             TO  SHORT-END-YMD          OF  WK-TZ-ZN-IDO
      *---------- 投資対象国コード
           MOVE  TSTSK-CD               OF  PARM-SMZJ1910-ARG2
             TO  TSTSK-CD               OF  WK-TZ-ZN-IDO
      *---------- 発行国コード
           MOVE  HAKO-CD                OF  PARM-SMZJ1910-ARG2
             TO  HAKO-CD                OF  WK-TZ-ZN-IDO
      *---------- 数量単位
           MOVE  SURYO-TANI             OF  PARM-SMZJ1910-ARG2
             TO  SURYO-TANI             OF  WK-TZ-ZN-IDO
      *---------- 作成フラグ
           MOVE  SK-FLG                 OF  PARM-SMZJ1910-ARG2
             TO  SK-FLG                 OF  WK-TZ-ZN-IDO
      *---------- 作成日時
           MOVE  SK-DATE                OF  PARM-SMZJ1910-ARG2
             TO  SK-DATE                OF  WK-TZ-ZN-IDO
      *---------- 作成ログインユーザ会社コード
           MOVE  SK-LOGIN-CMP-CD        OF  PARM-SMZJ1910-ARG2
             TO  SK-LOGIN-CMP-CD        OF  WK-TZ-ZN-IDO
      *---------- 作成ユーザＩＤ
           MOVE  SK-SID                 OF  PARM-SMZJ1910-ARG2
             TO  SK-SID                 OF  WK-TZ-ZN-IDO
      *---------- 作成プログラムＩＤ
           MOVE  SK-PGMID               OF  PARM-SMZJ1910-ARG2
             TO  SK-PGMID               OF  WK-TZ-ZN-IDO
      *---------- 更新フラグ
           MOVE  UPD-FLG                OF  PARM-SMZJ1910-ARG2
             TO  UPD-FLG                OF  WK-TZ-ZN-IDO
      *---------- 更新日時
           MOVE  UPD-DATE               OF  PARM-SMZJ1910-ARG2
             TO  UPD-DATE               OF  WK-TZ-ZN-IDO
      *---------- 更新ログインユーザ会社コード
           MOVE  UPD-LOGIN-CMP-CD       OF  PARM-SMZJ1910-ARG2
             TO  UPD-LOGIN-CMP-CD       OF  WK-TZ-ZN-IDO
      *---------- 更新ユーザＩＤ
           MOVE  UPD-SID                OF  PARM-SMZJ1910-ARG2
             TO  UPD-SID                OF  WK-TZ-ZN-IDO
      *---------- 更新プログラムＩＤ
           MOVE  UPD-PGMID              OF  PARM-SMZJ1910-ARG2
             TO  UPD-PGMID              OF  WK-TZ-ZN-IDO
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード             =["
      D             RIYO-CMP-CD         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード             =["
      D             FUND-CD             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード       =["
      D             PTF-CD              OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID                   =["
      D             TORI-ID             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":計上基準日                 =["
      D             KEIJOU-KIJUNBI      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分                   =["
      D             AKA-KBN             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上                   =["
      D             ERR-KJY-NO          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分                 =["
      D             ERR-KJY-KBN         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID                 =["
      D             THRK-ID             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード             =["
      D             SEC-SBT-CD          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":取引内容                   =["
      D             TORI-NAIY           OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":取引事由                   =["
      D             TORI-JIYU           OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード             =["
      D             SIJO-TUKA-CD        OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード                 =["
      D             MEG-CD              OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ   =["
      D             TATE-FLG            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":玉ＩＤ                     =["
      D             GYOKU-ID            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":約定日                     =["
      D             YKJ-YMD             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":受渡日                     =["
      D             UKE-YMD             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動簿価           =["
      D             SJTK-IDO-BOKA       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動簿価           =["
      D             UYTK-IDO-BOKA       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨簿価単価           =["
      D             SJTK-BOKA-TNK       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨簿価単価           =["
      D             UYTK-BOKA-TNK       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート             =["
      D             BOKA-KWS            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価           =["
      D             SJTK-H-BOKA         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価           =["
      D             UYTK-H-BOKA         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価           =["
      D             SJTK-H-TNK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価           =["
      D             UYTK-H-TNK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動数量                   =["
      D             IDO-SURYO           OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動数量（利付）           =["
      D             IDO-SURYO-RIT       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後簿価残高     =["
      D             SJTK-IDOG-BOKAZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後簿価残高     =["
      D             UYTK-IDOG-BOKAZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高             =["
      D             IDOG-SRYZN          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動後数量残高（利付）     =["
      D             IDOG-SRYZN-RIT      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨前払金異動額       =["
      D             SJTK-PPAYIDOG       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨前払金異動額       =["
      D             UYTK-PPAYIDOG       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前払金残     =["
      D             SJTK-IDOG-PPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前払金残     =["
      D             UYTK-IDOG-PPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後前受金残     =["
      D             SJTK-IDOG-ARECZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後前受金残     =["
      D             UYTK-IDOG-ARECZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後仮払金残     =["
      D             SJTK-IDOG-SPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後仮払金残     =["
      D             UYTK-IDOG-SPAYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨売買損益           =["
      D             SJTK-BBSNEKI        OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨売買損益           =["
      D             UYTK-BBSNEKI        OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益                 =["
      D             UYTK-KWS-SNEKI      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（利金）         =["
      D             UYTK-KWS-SNEKI-RK   OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益（市場）         =["
      D             UYTK-KWS-SNEKI-SJ   OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨手数料             =["
      D             SJTK-TSR            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨手数料             =["
      D             UYTK-TSR            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨消費税             =["
      D             SJTK-S-TAX          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨消費税             =["
      D             UYTK-S-TAX          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税             =["
      D             SJTK-GENSEN-TAX     OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税             =["
      D             UYTK-GENSEN-TAX     OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨その他損益         =["
      D             SJTK-ELS-SNEKI      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨その他損益         =["
      D             UYTK-ELS-SNEKI      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定     =["
      D             SJTK-RKSEKJ         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定     =["
      D             UYTK-RKSEKJ         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序               =["
      D             IDO-KJY-JUN         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉単価                   =["
      D             TGYOKU-TNK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉為替レート             =["
      D             TGYOKU-KWS-RATE     OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉ブローカー             =["
      D             TGYOKU-BRK          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":建玉約定日                 =["
      D             TGYOKU-YKJ-YMD      OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉約定金額残=["
      D             SJTK-IDOG-TG-YJKNZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉約定金額残=["
      D             UYTK-IDOG-TG-YJKNZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉手数料         =["
      D             SJTK-TG-TSR         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉手数料         =["
      D             UYTK-TG-TSR         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉手数料残 =["
      D             SJTK-IDOG-TG-TSRZN  OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉手数料残 =["
      D             UYTK-IDOG-TG-TSRZN  OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉消費税         =["
      D             SJTK-TG-S-TAX       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉消費税         =["
      D             UYTK-TG-S-TAX       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉消費税残 =["
      D             SJTK-IDOG-TG-S-TAXZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉消費税残 =["
      D             UYTK-IDOG-TG-S-TAXZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉その他費用     =["
      D             SJTK-TG-ELS-HIYO    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉その他費用     =["
      D             UYTK-TG-ELS-HIYO    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉その他費用残=["
      D             SJTK-IDOG-TG-ELS-HZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉その他費用残=["
      D             UYTK-IDOG-TG-ELS-HZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨建玉精算金額       =["
      D             SJTK-TG-SSKG        OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨建玉精算金額       =["
      D             UYTK-TG-SSKG        OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後建玉精算金額残=["
      D             SJTK-IDOG-TG-SSKGZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後建玉精算金額残=["
      D             UYTK-IDOG-TG-SSKGZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨引継前受・前払プレミアム=["
      D             SJTK-HT-PPAR-PMM    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨引継前受・前払プレミアム=["
      D             UYTK-HT-PPAR-PMM    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":ＯＰ資産負債・買建売建フラグ=["
      D             OP-TATE-FLG         OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨源泉税還付予定異動額=["
      D             SJTK-GSZKP-YTIDOG   OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨源泉税還付予定異動額=["
      D             UYTK-GSZKP-YTIDOG   OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨源泉税還付予定異動額=["
      D             KSTK-GSZKP-YTIDOG   OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後源泉税還付予定額残高=["
      D             SJTK-IDOG-GSZKP-YTZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後源泉税還付予定額残高=["
      D             UYTK-IDOG-GSZKP-YTZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨異動後源泉税還付予定額残高=["
      D             KSTK-IDOG-GSZKP-YTZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未収金残高=["
      D             SJTK-IDOG-NOCV-MSKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未収金残高=["
      D             UYTK-IDOG-NOCV-MSKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ノンカバー未払金残高=["
      D             SJTK-IDOG-NOCV-MBKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ノンカバー未払金残高=["
      D             UYTK-IDOG-NOCV-MBKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払費用残    =["
      D             SJTK-IDOG-MBHYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払費用残    =["
      D             UYTK-IDOG-MBHYZN    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払消費税残    =["
      D             SJTK-IDOG-MB-S-TAXZN  OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払消費税残    =["
      D             UYTK-IDOG-MB-S-TAXZN  OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管評価損益残=["
      D             SJTK-IDOG-IK-HKSEZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管評価損益残=["
      D             UYTK-IDOG-IK-HKSEZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後移管未収収益  =["
      D             SJTK-IDOG-IK-MSSHEKI OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管未収収益  =["
      D             UYTK-IDOG-IK-MSSHEKI OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後移管前払金評価損益残=["
      D             UYTK-IDOG-IK-PPHKZN OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":削除区分                    =["
      D             SAKUJO-KBN          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート・エンド経過利息=["
      D             SHORT-STEN-KEKA-RSK OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":短期スタート日              =["
      D             SHORT-START-YMD     OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":短期エンド日                =["
      D             SHORT-END-YMD       OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":投資対象国コード            =["
      D             TSTSK-CD            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":発行国コード                =["
      D             HAKO-CD             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":数量単位                    =["
      D             SURYO-TANI          OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ                  =["
      D             SK-FLG              OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":作成日時                    =["
      D             SK-DATE             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード=["
      D             SK-LOGIN-CMP-CD     OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ              =["
      D             SK-SID              OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ          =["
      D             SK-PGMID            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ                  =["
      D             UPD-FLG             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":更新日時                    =["
      D             UPD-DATE            OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード=["
      D             UPD-LOGIN-CMP-CD    OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ              =["
      D             UPD-SID             OF  WK-TZ-ZN-IDO"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ          =["
      D             UPD-PGMID           OF  WK-TZ-ZN-IDO"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TZ-IDO-CALC-EDIT-EXT.
           EXIT.
      ******************************************************************
      *   4.3.1.7対象取引情報データカーソルクローズ処理
      ******************************************************************
      * TKMZBW04-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  対象取引情報データカーソルクローズ"
      *D             "処理  START  ***"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *         CLOSE TKMZBW04_CURSOR
      *     END-EXEC
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *       MOVE  CNS-OFF              TO  FLG-TKMZBW04-CR-OPEN
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW04-CR-OPEN=["
      *D             FLG-TKMZBW04-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     ELSE
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQL処理エラー（CLOSE)"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-107          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-4         DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-2-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  対象取引情報データカーソルクローズ"
      *D             "処理 END  ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW04-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    4.3.1.8 ワーク取引存在フラグ編集
      ******************************************************************
       TRHK-SZ-FLG-EDIT-RTN   SECTION.
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引件数 =["WK-TRHK-KENSU"]"
      *-----------------------------------------------------------------
           IF  WK-TRHK-KENSU = ZERO
           THEN
             MOVE  CNS-KJ-DMN-0         TO  WK-TRHK-SONZAI-FLG
           ELSE
             MOVE  CNS-KJ-DMN-1         TO  WK-TRHK-SONZAI-FLG
           END-IF
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引存在フラグ =["
      D             WK-TRHK-SONZAI-FLG"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TRHK-SZ-FLG-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    4.3.2 銘柄種類＝'3'(資金)の場合の処理
      ******************************************************************
       MEG-CD-SHRU-3-RTN      SECTION.
      *-----------------------------------------------------------------
      *---------- 4.3.2.1 対象資金取引情報データを取得
           PERFORM  TKMZBW05-GET-RTN
           MOVE  CNS-OFF                TO  FLG-FETCH-SYUURYOU4
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU4=["
      D             FLG-FETCH-SYUURYOU4"]"
      *-----------------------------------------------------------------
           PERFORM  UNTIL  FLG-FETCH-SYUURYOU4 = CNS-ON
                       OR  FLG-PTF = CNS-ON
      *---------- 4.3.2.2 対象資金取引情報データカーソルフェッチ
             PERFORM  TKMZBW05-FET-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU4=["
      D             FLG-FETCH-SYUURYOU4"]"
      *-----------------------------------------------------------------
             IF  FLG-FETCH-SYUURYOU4 = CNS-ON
             THEN
               CONTINUE
             ELSE
      *---------- 4.3.2.3.処理資金取引取得
               PERFORM  SIKI-TRHK-GET-RTN
      *---------- 4.3.2.4.ワーク対象資金取引情報.処理順＝1の場合、直前異動セット
               PERFORM  ST-TZ-IDO-ASSET-RTN
      *---------- 4.3.2.5.異動簿価・損益計算（物）
      *---------- 2)【SMZJ1920】異動簿価・損益計算(資金)
               PERFORM  SMZJ1920-RTN
      *---------- 4.3.2.6.直前異動セット
               PERFORM  SK-BOKA-IDO-EDIT-RTN
      *---------- 4.3.2.7.ワーク取引件数＝1 且つ
      *        且つ ワーク再処理基準日FROM＞ワーク直前資金簿価異動.異動日の場合、
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引件数=["WK-TRHK-KENSU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク再処理基準日FROM=["
      D                         WK-REDO-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前資金簿価異動.異動日=["
      D                         IDO-YMD OF WK-TYOKUZEN-SK-BOKA-IDOG"]"
      *-----------------------------------------------------------------
               IF  WK-TRHK-KENSU = CNS-1 AND
                   WK-REDO-KJN-YMD-FROM > IDO-YMD
                                          OF WK-TYOKUZEN-SK-BOKA-IDOG
               THEN
                   MOVE  IDO-YMD  OF  WK-TYOKUZEN-SK-BOKA-IDOG
                     TO  WK-REDO-KJN-YMD-FROM
               ELSE
                 CONTINUE
               END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク再処理基準日FROM=["
      D                         WK-REDO-KJN-YMD-FROM"]"
      D    DISPLAY  CNS-PGM-ID":ワーク直前資金簿価異動.異動日=["
      D                         IDO-YMD OF WK-TYOKUZEN-SK-BOKA-IDOG"]"
      *-----------------------------------------------------------------
             END-IF
           END-PERFORM
           IF  FLG-PTF = CNS-ON
           THEN
             CONTINUE
           ELSE
      *---------- 4.3.2.7 対象資金取引情報データカーソルクローズ処理
      *      PERFORM  TKMZBW05-CLOSE-RTN
      *---------- 4.3.1.8 ワーク取引存在フラグ編集
             PERFORM  TRHK-SZ-FLG-EDIT-RTN
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       MEG-CD-SHRU-3-EXT.
           EXIT.
      ******************************************************************
      *    4.3.2.1対象資金取引情報データを取得
      ******************************************************************
       TKMZBW05-GET-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象資金取引情報データを取得 処理"
      D            "  START  ***"
      *-----------------------------------------------------------------
      *-----------  カーソル定義処理
           PERFORM  TKMZBW05-DEC-RTN
      *-----------  カーソルオープン処理
           PERFORM  TKMZBW05-OPEN-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象資金取引情報データを取得 処理"
      D             " END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW05-GET-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKMZBW05-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  H-SYORI-YMD            OF  H-TKMZBW05-S,
                 WK-SYORI-YMD-S         OF  WK-MSG-1-5
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  H-KIDOU-ID             OF  H-TKMZBW05-S,
                 WK-KIDOU-ID-S          OF  WK-MSG-1-5
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW05-S,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-5
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  H-FUND-CD              OF  H-TKMZBW05-S,
                 WK-FUND-CD-S           OF  WK-MSG-1-5
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  H-PTF-CD               OF  H-TKMZBW05-S,
                 WK-PTF-CD-S            OF  WK-MSG-1-5
      *---------- 基準日
           MOVE  WK-KJN-YMD             OF  WK-TKMZBW03
             TO  H-KJN-YMD              OF  H-TKMZBW05-S,
                 WK-KJN-YMD-S           OF  WK-MSG-1-5
      *---------- 銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-MEG-CD               OF  H-TKMZBW05-S,
                 WK-MEG-CD-S            OF  WK-MSG-1-5
      *---------- 証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  H-SEC-SBT-CD           OF  H-TKMZBW05-S,
                 WK-SEC-SBT-CD-S        OF  WK-MSG-1-5
      *---------- 資産負債・買建売建フラグ
           MOVE  WK-TATE-FLG            OF  WK-TKMZBW03
             TO  H-TATE-FLG             OF  H-TKMZBW05-S,
                 WK-TATE-FLG-S          OF  WK-MSG-1-5
      *---------- 玉ID
           MOVE  WK-GYOKU-ID            OF  WK-TKMZBW03
             TO  H-GYOKU-ID             OF  H-TKMZBW05-S,
                 WK-GYOKU-ID-S          OF  WK-MSG-1-5
      *---------- テーブルID
           MOVE  WK-TBL-TKMZBW05
             TO  SQL-TKMZBW05           OF  SQL-SELECT-1-5,
                 WK-TKMZBW05            OF  WK-MSG-1-5
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             H-SYORI-YMD         OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             H-KIDOU-ID          OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             H-FUND-CD           OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             H-PTF-CD            OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":基準日 =["
      D             H-KJN-YMD           OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":銘柄コード=["
      D             H-MEG-CD            OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             H-SEC-SBT-CD        OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":資産負債・買建売建フラグ=["
      D             H-TATE-FLG          OF  H-TKMZBW05-S"]"
      D    DISPLAY  CNS-PGM-ID":玉ID=["
      D             H-GYOKU-ID          OF  H-TKMZBW05-S"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT5                                         @3212SEINO@@
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-5         TO  SQLSTMT5                    @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT5=["SQLSTMT5"]"                  @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW05-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMZBW05-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZBW05-CR-OPEN  NOT = CNS-ON                       @3212SEINO@@
           THEN                                                         @3212SEINO@@
           EXEC  SQL
               PREPARE  S5  FROM :SQLSTMT5                              @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-108          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-5         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
           EXEC  SQL  DECLARE  TKMZBW05_CURSOR  CURSOR  FOR  S5 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
           CONTINUE.
       TKMZBW05-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKMZBW05-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKMZBW05_CURSOR
                 USING :H-TKMZBW05-S.H-SYORI-YMD,
                       :H-TKMZBW05-S.H-KIDOU-ID,
                       :H-TKMZBW05-S.H-RIYO-CMP-CD,
                       :H-TKMZBW05-S.H-FUND-CD,
                       :H-TKMZBW05-S.H-PTF-CD,
                       :H-TKMZBW05-S.H-KJN-YMD,
                       :H-TKMZBW05-S.H-MEG-CD,
                       :H-TKMZBW05-S.H-SEC-SBT-CD,
                       :H-TKMZBW05-S.H-TATE-FLG,
                       :H-TKMZBW05-S.H-GYOKU-ID
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZBW05-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW05-CR-OPEN=["
      D             FLG-TKMZBW05-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-109          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-5         DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW05-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    4.3.2.2 対象資金取引情報データカーソルフェッチ
      ******************************************************************
       TKMZBW05-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 対象資金取引情報データカーソル"
      D             "フェッチ処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMZBW05-5
           EXEC  SQL
               FETCH
                    TKMZBW05_CURSOR
               INTO :H-TKMZBW05-5.H-TORI-ID,
                    :H-TKMZBW05-5.H-SIKIN-SBT,
                    :H-TKMZBW05-5.H-IDO-YMD,
                    :H-TKMZBW05-5.H-ZG-KBN,
                    :H-TKMZBW05-5.H-SRJUN,
                    :H-TKMZBW05-5.H-UKE-KIRIKAE-FLG,
                    :H-TKMZBW05-5.H-KK-SWK-KJN-PTN-CD,
                    :H-TKMZBW05-5.H-KK-CF-NK-YK-FLG,
                    :H-TKMZBW05-5.H-KK-KH-KK-BASE-FLG,
                    :H-TKMZBW05-5.H-UKE-MBMS-ZF-FLG
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           EVALUATE  SQLCODE
             WHEN  CNS-SQL-NORMAL
      *---------- 1)ワーク対象資金取引情報を初期化
               INITIALIZE  WK-TS-TORI-INFO
      *---------- ワーク取引件数 ← ワーク取引件数＋1
               COMPUTE  WK-TRHK-KENSU = WK-TRHK-KENSU + CNS-1
      *---------- ワーク対象資金取引情報.原取引ID   ←     「別紙1-5 SQL説明」.原取引ID
               MOVE  H-TORI-ID          OF  H-TKMZBW05-5
                 TO  WK-TORI-ID         OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.資金種別 ←     「別紙1-5 SQL説明」.資金種別
               MOVE  H-SIKIN-SBT        OF  H-TKMZBW05-5
                 TO  WK-SIKIN-SBT       OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.異動日 ←     「別紙1-5 SQL説明」.異動日
               MOVE  H-IDO-YMD          OF  H-TKMZBW05-5
                 TO  WK-IDO-YMD         OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.増減区分 ← 「別紙1-5 SQL説明」.増減区分
               MOVE  H-ZG-KBN           OF  H-TKMZBW05-5
                 TO  WK-ZG-KBN          OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.処理順 ← 「別紙1-5 SQL説明」.処理順
               MOVE  H-SRJUN            OF  H-TKMZBW05-5
                 TO  WK-SRJUN           OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.受渡計上切替対象フラグ ←  「別紙1-5 SQL説明」.受渡計上切替対象フラグ
               MOVE  H-UKE-KIRIKAE-FLG  OF  H-TKMZBW05-5
                 TO  WK-UKE-KIRIKAE-FLG OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.切替仕訳基準パターンコード← 「別紙1-5 SQL説明」.切替仕訳基準パターンコード
               MOVE  H-KK-SWK-KJN-PTN-CD OF  H-TKMZBW05-5
                 TO  WK-KK-SWK-KJN-PTN-CD  OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.切替キャッシュフロー2回有効フラグ←
      *---------- 「別紙1-5 SQL説明」.切替キャッシュフロー2回有効フラグ
               MOVE  H-KK-CF-NK-YK-FLG   OF  H-TKMZBW05-5
                 TO  WK-KK-CF-NK-YK-FLG  OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.切替基本会計ベースフラグ← 「別紙1-5 SQL説明」.切替基本会計ベースフラグ
               MOVE  H-KK-KH-KK-BASE-FLG OF  H-TKMZBW05-5
                 TO  WK-KK-KH-KK-BASE-FLG  OF  WK-TS-TORI-INFO
      *---------- ワーク対象資金取引情報.受渡未払未収増幅フラグ←   「別紙1-5 SQL説明」.受渡未払未収増幅フラグ
               MOVE  H-UKE-MBMS-ZF-FLG   OF  H-TKMZBW05-5
                 TO  WK-UKE-MBMS-ZF-FLG  OF  WK-TS-TORI-INFO
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク取引件数 =["WK-TRHK-KENSU"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報.原取引ID =["
      D             WK-TORI-ID          OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報.資金種別 =["
      D             WK-SIKIN-SBT        OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報.異動日 =["
      D             WK-IDO-YMD          OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報.増減区分 =["
      D             WK-ZG-KBN           OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報.処理順 =["
      D             WK-SRJUN            OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID
      D              ":ワーク対象資金取引情報.受渡計上切替対象フラグ =["
      D             WK-UKE-KIRIKAE-FLG  OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID
      D          ":ワーク対象資金取引情報.切替仕訳基準パターンコード =["
      D             WK-KK-SWK-KJN-PTN-CD OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報."
      D                           "切替キャッシュフロー2回有効フラグ =["
      D             WK-KK-CF-NK-YK-FLG  OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報."
      D                                    "切替基本会計ベースフラグ =["
      D             WK-KK-KH-KK-BASE-FLG OF  WK-TS-TORI-INFO"]"
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報."
      D                                    "受渡未払未収増幅フラグ=["
      D             WK-UKE-MBMS-ZF-FLG  OF  WK-TS-TORI-INFO"]"
      *-----------------------------------------------------------------
             WHEN  CNS-SQL-NOTFOUND
               MOVE  CNS-ON             TO  FLG-FETCH-SYUURYOU4
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-FETCH-SYUURYOU4=["
      D             FLG-FETCH-SYUURYOU4"]"
      *-----------------------------------------------------------------
             WHEN  OTHER
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-110        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-5       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-EVALUATE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  対象資金取引情報データカーソル"
      D             "フェッチ処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW05-FET-EXT.
           EXIT.
      ******************************************************************
      *    4.3.2.3.処理資金取引取得
      ******************************************************************
       SIKI-TRHK-GET-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 処理資金取引取得 処理 START  ***"
      *-----------------------------------------------------------------
      *----------  カーソル定義処理
           PERFORM  TKMZBW18-DEC-RTN
      *----------  カーソルオープン処理
           PERFORM  TKMZBW18-OPEN-RTN
      *----------  処理資金取引 FETCH 処理
           PERFORM  TKMZBW18-FET-RTN
      *----------  処理資金取引 CURSOR CLOSE 処理
      *    PERFORM  TKMZBW18-CLOSE-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 処理資金取引取得 処理  END *** "
      *-----------------------------------------------------------------
           CONTINUE.
       SIKI-TRHK-GET-EXT.
           EXIT.
      ******************************************************************
      *    カーソル定義処理
      ******************************************************************
       TKMZBW18-DEC-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  H-RIYO-CMP-CD          OF  H-TKMZBW18-S,
                 WK-RIYO-CMP-CD-S       OF  WK-MSG-1-10
      *---------- 原取引ＩＤ
           MOVE  WK-TORI-ID             OF  WK-TS-TORI-INFO
             TO  H-TORI-ID              OF  H-TKMZBW18-S,
                 WK-TORI-ID-S           OF  WK-MSG-1-10
      *---------- 決済口座番号
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  H-KS-KOZA-NO           OF  H-TKMZBW18-S,
                 WK-KS-KOZA-NO-S        OF  WK-MSG-1-10
      *---------- 資金種別
           MOVE  WK-SIKIN-SBT           OF  WK-TS-TORI-INFO
             TO  H-SIKIN-SBT            OF  H-TKMZBW18-S,
                 WK-SIKIN-SBT-S         OF  WK-MSG-1-10
      *---------- 異動日
           MOVE  WK-IDO-YMD             OF  WK-TS-TORI-INFO
             TO  H-IDO-YMD              OF  H-TKMZBW18-S,
                 WK-IDO-YMD-S           OF  WK-MSG-1-10
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D           ":ワーク対象資金取引情報.受渡未払未収増幅フラグ=["
      D             WK-UKE-MBMS-ZF-FLG  OF   WK-TS-TORI-INFO "]"
      *-----------------------------------------------------------------
           IF  WK-UKE-MBMS-ZF-FLG  OF   WK-TS-TORI-INFO
             = CNS-X-1
           THEN
             MOVE  CNS-ZG-KBN-2
               TO  H-ZG-KBN               OF  H-TKMZBW18-S,
                   WK-ZG-KBN-S            OF  WK-MSG-1-10
           ELSE
      *---------- 増減区分
             MOVE  WK-ZG-KBN              OF  WK-TS-TORI-INFO
               TO  H-ZG-KBN               OF  H-TKMZBW18-S,
                   WK-ZG-KBN-S            OF  WK-MSG-1-10
           END-IF
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  H-SYORI-YMD            OF  H-TKMZBW18-S,
                 WK-SYORI-YMD-S         OF  WK-MSG-1-10
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  H-KIDOU-ID             OF  H-TKMZBW18-S,
                 WK-KIDOU-ID-S          OF  WK-MSG-1-10
      *---------- テーブルID
           MOVE  WK-TBL-TKMZBW18
             TO  SQL-TKMZBW18           OF  SQL-SELECT-1-10,
                 WK-TKMZBW18            OF  WK-MSG-1-10
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             H-RIYO-CMP-CD       OF  H-TKMZBW18-S"]"
      D    DISPLAY  CNS-PGM-ID":原取引ＩＤ =["
      D             H-TORI-ID           OF  H-TKMZBW18-S"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号 =["
      D             H-KS-KOZA-NO        OF  H-TKMZBW18-S"]"
      D    DISPLAY  CNS-PGM-ID":資金種別 =["
      D             H-SIKIN-SBT         OF  H-TKMZBW18-S"]"
      D    DISPLAY  CNS-PGM-ID":異動日 =["
      D             H-IDO-YMD           OF  H-TKMZBW18-S"]"
      D    DISPLAY  CNS-PGM-ID":増減区分 =["
      D             H-ZG-KBN            OF  H-TKMZBW18-S"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             H-SYORI-YMD         OF  H-TKMZBW18-S"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             H-KIDOU-ID          OF  H-TKMZBW18-S"]"
      *-----------------------------------------------------------------
           INITIALIZE  SQLSTMT10                                        @3212SEINO@@
      *---------- ＳＱＬ文
           MOVE  SQL-SELECT-1-10         TO  SQLSTMT10                  @3212SEINO@@
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLSTMT10=["SQLSTMT10"]"                @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW18-CR-OPEN=["                 @3212SEINO@@
      D             FLG-TKMZBW18-CR-OPEN"]"                             @3212SEINO@@
      *-----------------------------------------------------------------
      *----------  ２度目以降のカーソルPREPARE,DECLAREスキップ START    @3212SEINO@@
           IF  FLG-TKMZBW18-CR-OPEN  NOT = CNS-ON
           THEN
           EXEC  SQL
               PREPARE  S10  FROM :SQLSTMT10                            @3212SEINO@@
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-PREPARE=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE  =  CNS-SQL-NORMAL
           THEN
             CONTINUE
           ELSE
      *----------------------<DEBUG>------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（PREPARE)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-111          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-10        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
           EXEC  SQL  DECLARE  TKMZBW18_CURSOR  CURSOR  FOR S10 END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-DECLARE=["SQLCODE"]"
      *-----------------------------------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソル定義処理 END  ***"
      *-----------------------------------------------------------------
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
           CONTINUE.
       TKMZBW18-DEC-EXT.
           EXIT.
      ******************************************************************
      *   カーソルオープン処理
      ******************************************************************
       TKMZBW18-OPEN-RTN      SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 START  ***"
      *-----------------------------------------------------------------
           EXEC  SQL
               OPEN TKMZBW18_CURSOR
                 USING :H-TKMZBW18-S.H-RIYO-CMP-CD,
                       :H-TKMZBW18-S.H-TORI-ID,
                       :H-TKMZBW18-S.H-KS-KOZA-NO,
                       :H-TKMZBW18-S.H-SIKIN-SBT,
                       :H-TKMZBW18-S.H-IDO-YMD,
                       :H-TKMZBW18-S.H-ZG-KBN,
                       :H-TKMZBW18-S.H-SYORI-YMD,
                       :H-TKMZBW18-S.H-KIDOU-ID
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-OPEN=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-ON               TO  FLG-TKMZBW18-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW18-CR-OPEN=["
      D             FLG-TKMZBW18-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（OPEN)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-112          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-10        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルオープン処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW18-OPEN-EXT.
           EXIT.
      ******************************************************************
      *    処理資金取引 FETCH 処理
      ******************************************************************
       TKMZBW18-FET-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 処理資金取引 FETCH 処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE                   H-TKMZBW18-10
           EXEC  SQL
               FETCH
                    TKMZBW18_CURSOR
               INTO :H-TKMZBW18-10.H-KOZA-TUKA-CD,
                    :H-TKMZBW18-10.H-THRK-ID,
                    :H-TKMZBW18-10.H-KSTK-IDOG,
                    :H-TKMZBW18-10.H-UYTK-IDOG,
                    :H-TKMZBW18-10.H-IDO-KBN,
                    :H-TKMZBW18-10.H-SIJO-TUKA-CD,
                    :H-TKMZBW18-10.H-TORI-JIYU,
                    :H-TKMZBW18-10.H-SEC-SBT-CD,
                    :H-TKMZBW18-10.H-TORI-NAIY
           END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-FETCH=["SQLCODE"]"
      *-----------------------------------------------------------------
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
      *---------- 1)ワーク処理資金取引データを初期化
             INITIALIZE  WK-SIKIN-TRHK-DATA
      *---------- 決済口座通貨コード
             MOVE  H-KOZA-TUKA-CD       OF  H-TKMZBW18-10
               TO  WK-KOZA-TUKA-CD      OF  WK-SIKIN-TRHK-DATA
      *---------- 市場通貨コード
             MOVE  H-SIJO-TUKA-CD       OF  H-TKMZBW18-10
               TO  WK-SIJO-TUKA-CD      OF  WK-SIKIN-TRHK-DATA
      *---------- 取引連関ＩＤ
             MOVE  H-THRK-ID            OF  H-TKMZBW18-10
               TO  WK-THRK-ID           OF  WK-SIKIN-TRHK-DATA
      *---------- 決済通貨異動額
             MOVE  H-KSTK-IDOG          OF  H-TKMZBW18-10
               TO  WK-KSTK-IDOG         OF  WK-SIKIN-TRHK-DATA
      *---------- 運用通貨異動額
             MOVE  H-UYTK-IDOG          OF  H-TKMZBW18-10
               TO  WK-UYTK-IDOG         OF  WK-SIKIN-TRHK-DATA
      *---------- 異動確定区分
             MOVE  H-IDO-KBN            OF  H-TKMZBW18-10
               TO  WK-IDO-KBN           OF  WK-SIKIN-TRHK-DATA
      *---------- 取引事由
             MOVE  H-TORI-JIYU          OF  H-TKMZBW18-10
               TO  WK-TORI-JIYU         OF  WK-SIKIN-TRHK-DATA
      *---------- 証券種別コード
             MOVE  H-SEC-SBT-CD         OF  H-TKMZBW18-10
               TO  WK-SEC-SBT-CD        OF  WK-SIKIN-TRHK-DATA
      *---------- 取引内容
             MOVE  H-TORI-NAIY          OF  H-TKMZBW18-10
               TO  WK-TORI-NAIY         OF  WK-SIKIN-TRHK-DATA
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード =["
      D             WK-KOZA-TUKA-CD     OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨コード =["
      D             WK-SIJO-TUKA-CD     OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ＩＤ =["
      D             WK-THRK-ID          OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":決済通貨異動額 =["
      D             WK-KSTK-IDOG        OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動額 =["
      D             WK-UYTK-IDOG        OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":異動確定区分 =["
      D             WK-IDO-KBN          OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":取引事由 =["
      D             WK-TORI-JIYU        OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード=["
      D             WK-SEC-SBT-CD       OF  WK-SIKIN-TRHK-DATA"]"
      D    DISPLAY  CNS-PGM-ID":取引内容 =["
      D             WK-TORI-NAIY        OF  WK-SIKIN-TRHK-DATA"]"
      *-----------------------------------------------------------------
           ELSE
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQL処理エラー（FETCH)"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-113          TO  WK-ERR-POS
             STRING  CNS-SQL-MSG-SELECT,
                     WK-MSG-1-10        DELIMITED  BY  SIZE
               INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-2-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  処理資金取引 FETCH 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       TKMZBW18-FET-EXT.
           EXIT.
      ******************************************************************
      *    処理資金取引 CURSOR CLOSE 処理
      ******************************************************************
      * TKMZBW18-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":*** 処理資金取引 CURSOR CLOSE 処理 "
      *D             "START ***"
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW18-CR-OPEN=["
      *D             FLG-TKMZBW18-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *         CLOSE TKMZBW18_CURSOR
      *     END-EXEC
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQLCODE(CLOSE) =[" SQLCODE "]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *       MOVE  CNS-OFF              TO  FLG-TKMZBW18-CR-OPEN
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW18-CR-OPEN=["
      *D             FLG-TKMZBW18-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     ELSE
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-114          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-10        DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-2-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":*** 処理資金取引 CURSOR CLOSE 処理 "
      *D             "END  ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW18-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    4.3.2.4.ワーク対象資金取引情報.処理順＝1の場合、直前異動セット
      ******************************************************************
       ST-TZ-IDO-ASSET-RTN    SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク対象資金取引情報.処理順 =["
      D             WK-SRJUN            OF  WK-TS-TORI-INFO"]"
      *-----------------------------------------------------------------
           IF  WK-SRJUN  OF  WK-TS-TORI-INFO = CNS-SRJUN-1
           THEN
      *---------- ワーク直前資金簿価異動
             PERFORM  TZ-SK-BOKA-IDOG-RTN
           ELSE
             CONTINUE
           END-IF
      *-----------------------------------------------------------------
           CONTINUE.
       ST-TZ-IDO-ASSET-EXT.
           EXIT.
      ******************************************************************
      *    「別紙4-5 編集要領」
      ******************************************************************
       TZ-SK-BOKA-IDOG-RTN    SECTION.
      *-----------------------------------------------------------------
           INITIALIZE  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  WK-TKMZSR00
             TO  RIYO-CMP-CD            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- ファンドコード
           MOVE  FUND-CD                OF  WK-TKMZSR00
             TO  FUND-CD                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  WK-TKMZSR00
             TO  PTF-CD                 OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  WK-TKMZSR00
             TO  BOKA-KWS               OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後ＣＡＳＨ残高
           MOVE  SJTK-TJT-CASHZN        OF  WK-TKMZSR00
             TO  SJTK-IDOG-SK-BOKAZN    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後ＣＡＳＨ残高
           MOVE  UYTK-TJT-CASHZN        OF  WK-TKMZSR00
             TO  UYTK-IDOG-SK-BOKAZN    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未収入金残高（内物）
           MOVE  SJTK-TJT-MSNKZN-UM     OF  WK-TKMZSR00
             TO  SJTK-IDOG-MSNKZN-UM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未収入金残高（内物）
           MOVE  UYTK-TJT-MSNKZN-UM     OF  WK-TKMZSR00
             TO  UYTK-IDOG-MSNKZN-UM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未収入金残高（外物）
           MOVE  SJTK-TJT-MSNKZN-SM     OF  WK-TKMZSR00
             TO  SJTK-IDOG-MSNKZN-SM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未収入金残高（外物）
           MOVE  UYTK-TJT-MSNKZN-SM     OF  WK-TKMZSR00
             TO  UYTK-IDOG-MSNKZN-SM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未払金残高（内物）
           MOVE  SJTK-TJT-MBKZN-UM      OF  WK-TKMZSR00
             TO  SJTK-IDOG-MBKZN-UM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未払金残高（内物）
           MOVE  UYTK-TJT-MBKZN-UM      OF  WK-TKMZSR00
             TO  UYTK-IDOG-MBKZN-UM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未払金残高（外物）
           MOVE  SJTK-TJT-MBKZN-SM      OF  WK-TKMZSR00
             TO  SJTK-IDOG-MBKZN-SM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未払金残高（外物）
           MOVE  UYTK-TJT-MBKZN-SM      OF  WK-TKMZSR00
             TO  UYTK-IDOG-MBKZN-SM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード  =["
      D             PTF-CD              OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート =["
      D             BOKA-KWS            OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ＣＡＳＨ残高 =["
      D             SJTK-IDOG-SK-BOKAZN OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ＣＡＳＨ残高 =["
      D             UYTK-IDOG-SK-BOKAZN OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（内物） =["
      D             SJTK-IDOG-MSNKZN-UM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（内物） =["
      D             UYTK-IDOG-MSNKZN-UM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（外物） =["
      D             SJTK-IDOG-MSNKZN-SM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（外物） =["
      D             UYTK-IDOG-MSNKZN-SM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（内物） =["
      D             SJTK-IDOG-MBKZN-UM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（内物） =["
      D             UYTK-IDOG-MBKZN-UM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（外物） =["
      D             SJTK-IDOG-MBKZN-SM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（外物） =["
      D             UYTK-IDOG-MBKZN-SM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      *-----------------------------------------------------------------
           CONTINUE.
       TZ-SK-BOKA-IDOG-EXT.
           EXIT.
      ******************************************************************
      *    【SMZJ1920】異動簿価・損益計算(資金)
      ******************************************************************
       SMZJ1920-RTN           SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  異動簿価・損益計算（資金）処理 "
      D             " START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ1920-INOUT
                       PARM-RTNPKG
      *---------- 資金取引データ.決済口座通貨コード
           MOVE  WK-KOZA-TUKA-CD        OF  WK-SIKIN-TRHK-DATA
             TO  KOZA-TUKA-CD           OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.市場通貨コード
           MOVE  WK-SIJO-TUKA-CD        OF  WK-SIKIN-TRHK-DATA
             TO  SIJO-TUKA-CD           OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.取引連関ＩＤ
           MOVE  WK-THRK-ID             OF  WK-SIKIN-TRHK-DATA
             TO  THRK-ID                OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.決済通貨異動額
           MOVE  WK-KSTK-IDOG           OF  WK-SIKIN-TRHK-DATA
             TO  KSTK-IDOG              OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.運用通貨異動額
           MOVE  WK-UYTK-IDOG           OF  WK-SIKIN-TRHK-DATA
             TO  UYTK-IDOG              OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.取引事由
           MOVE  WK-TORI-JIYU           OF  WK-SIKIN-TRHK-DATA
             TO  TORI-JIYU              OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.異動確定区分
           MOVE  WK-IDO-KBN             OF  WK-SIKIN-TRHK-DATA
             TO  IDO-KBN                OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-SIKIN-TRHK-DATA
             TO  SEC-SBT-CD             OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 資金取引データ.取引内容
           MOVE  WK-TORI-NAIY           OF  WK-SIKIN-TRHK-DATA
             TO  TORI-NAIY              OF  SIKIN-TORI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 異動計算パターン
      *---------- 払出簿価計算方法
           MOVE  WK-DEBET-BOKA-CALC-HOU OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-CALC-HOU    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 払出簿価端数（市場通貨）
           MOVE  WK-DEBET-BOKA-HASU-BC  OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-HASU-BC     OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 払出単価桁数（市場通貨）
           MOVE  WK-DEBET-TNK-KETASU-BC OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-KETASU-BC    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 払出単価端数（市場通貨）
           MOVE  WK-DEBET-TNK-HASU-BC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-HASU-BC      OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 払出簿価端数（運用通貨）
           MOVE  WK-DEBET-BOKA-HASU-LC  OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-BOKA-HASU-LC     OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 払出単価桁数（運用通貨）
           MOVE  WK-DEBET-TNK-KETASU-LC OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-KETASU-LC    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 払出単価端数（運用通貨）
           MOVE  WK-DEBET-TNK-HASU-LC   OF  WK-IDO-CALC-PATTERN-INFO
             TO  DEBET-TNK-HASU-LC      OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 簿価為替レート適用フラグ
           MOVE  WK-BOKA-KWS-TEKIYO-FLG OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-TEKIYO-FLG    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 簿価為替レート端数
           MOVE  WK-BOKA-KWS-HASU       OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-HASU          OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 簿価為替レート桁数
           MOVE  WK-BOKA-KWS-KETASU     OF  WK-IDO-CALC-PATTERN-INFO
             TO  BOKA-KWS-KETASU        OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 按分簿価端数
           MOVE  WK-ANB-BOKA-HASU       OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-BOKA-HASU          OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 按分単価端数
           MOVE  WK-ANB-TNK-HASU        OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-TNK-HASU           OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 按分単価桁数
           MOVE  WK-ANB-TNK-KETASU      OF  WK-IDO-CALC-PATTERN-INFO
             TO  ANB-TNK-KETASU         OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 前払金償却分端数
           MOVE  WK-MAEKIN-SHOUKYK-HASU OF  WK-IDO-CALC-PATTERN-INFO
             TO  MAEKIN-SHOUKYK-HASU    OF  YIDOU-CALC-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 直前の資金簿価異動:
      *---------- 市場通貨異動後未収入金残高（内物）
           MOVE  SJTK-IDOG-MSNKZN-UM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  SJTK-IDOG-MSNKZN-UM    OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 運用通貨異動後未収入金残高（内物）
           MOVE  UYTK-IDOG-MSNKZN-UM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  UYTK-IDOG-MSNKZN-UM    OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 市場通貨異動後未収入金残高（外物）
           MOVE  SJTK-IDOG-MSNKZN-SM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  SJTK-IDOG-MSNKZN-SM    OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 運用通貨異動後未収入金残高（外物）
           MOVE  UYTK-IDOG-MSNKZN-SM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  UYTK-IDOG-MSNKZN-SM    OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 市場通貨異動後未払金残高（内物）
           MOVE  SJTK-IDOG-MBKZN-UM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  SJTK-IDOG-MBKZN-UM     OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 運用通貨異動後未払金残高（内物）
           MOVE  UYTK-IDOG-MBKZN-UM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  UYTK-IDOG-MBKZN-UM     OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 市場通貨異動後未払金残高（外物）
           MOVE  SJTK-IDOG-MBKZN-SM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  SJTK-IDOG-MBKZN-SM     OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 運用通貨異動後未払金残高（外物）
           MOVE  UYTK-IDOG-MBKZN-SM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  UYTK-IDOG-MBKZN-SM     OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 市場通貨異動後CASH残高
           MOVE  SJTK-IDOG-SK-BOKAZN    OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  SJTK-IDOG-SK-BOKAZN    OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 運用通貨異動後CASH残高
           MOVE  UYTK-IDOG-SK-BOKAZN    OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  UYTK-IDOG-SK-BOKAZN    OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 異動計上順序
           MOVE  IDO-KJY-JUN            OF  WK-TYOKUZEN-SK-BOKA-IDOG
             TO  IDO-KJY-JUN            OF  TZ-SK-BOKA-IDO-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 通貨デフォールト端数処理
           MOVE  WK-TUKA-DEF-HASU-SYRI-PARM
             TO  TUKA-DEF-HASU-SYRI-PARM
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 銘柄別断面情報.処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-TKMZBW03
             TO  SYORI-YMD              OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 銘柄別断面情報.起動ID
           MOVE  WK-KIDOU-ID            OF  WK-TKMZBW03
             TO  KIDOU-ID               OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 銘柄別断面情報.利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-TKMZBW03
             TO  RIYO-CMP-CD            OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 銘柄別断面情報.ファンドコード
           MOVE  WK-FUND-CD             OF  WK-TKMZBW03
             TO  FUND-CD                OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 銘柄別断面情報.ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-TKMZBW03
             TO  PTF-CD                 OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 銘柄別断面情報.銘柄コード
           MOVE  WK-MEG-CD              OF  WK-TKMZBW03
             TO  MEG-CD                 OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 銘柄別断面情報.証券種別コード
           MOVE  WK-SEC-SBT-CD          OF  WK-TKMZBW03
             TO  SEC-SBT-CD             OF  MEG-BETU-DMN-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 対象資金取引情報.原取引ＩＤ
           MOVE  WK-TORI-ID             OF  WK-TS-TORI-INFO
             TO  TORI-ID                OF  TAGET-SIKIN-TORI-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 対象資金取引情報.資金種別
           MOVE  WK-SIKIN-SBT           OF  WK-TS-TORI-INFO
             TO  SIKIN-SBT              OF  TAGET-SIKIN-TORI-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 対象資金取引情報.異動日
           MOVE  WK-IDO-YMD             OF  WK-TS-TORI-INFO
             TO  IDO-YMD                OF  TAGET-SIKIN-TORI-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 対象資金取引情報.増減区分
           MOVE  WK-ZG-KBN              OF  WK-TS-TORI-INFO
             TO  ZG-KBN                 OF  TAGET-SIKIN-TORI-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 対象資金取引情報.処理順
           MOVE  WK-SRJUN               OF  WK-TS-TORI-INFO
             TO  SRJUN                  OF  TAGET-SIKIN-TORI-INFO
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 運用通貨コード
           MOVE  WK-CAPITAL-TUKA-CD     OF  WK-TKMZBW02
             TO  CAPITAL-TUKA-CD        OF  PARM-SMZJ1920-ARG1
      *---------- 基準日断面情報.仕訳基準パターンコード
           MOVE  WK-SWK-KJN-PTN-CD      OF  WK-TKMZBW02
             TO  SWK-KJN-PTN-CD         OF  PARM-SMZJ1920-ARG1
      *---------- 基準日断面情報.基本会計ベースフラグ
           MOVE  WK-KH-KK-BASE-FLG      OF  WK-TKMZBW02
             TO  KH-KAIKEI-BASE-FLG     OF  PARM-SMZJ1920-ARG1
      *---------- キャッシュフロー2回有効フラグ
           MOVE  WK-CASH-FLOW-2-FLG
             TO  CASH-FLOW-2-FLG        OF  PARM-SMZJ1920-ARG1
      *---------- 乗算/除算区分
           MOVE  WK-JZ-JS-KBN
             TO  JZ-JS-KBN              OF  PARM-SMZJ1920-ARG1
      *---------- 受渡計上切替対象フラグ
           MOVE  WK-UKE-KIRIKAE-FLG     OF  WK-TS-TORI-INFO
             TO  UKE-KIRIKAE-FLG        OF  PARM-SMZJ1920-ARG1
      *---------- 受渡計上切替対象情報
      *---------- 仕訳基準パターンコード
           MOVE  WK-KK-SWK-KJN-PTN-CD   OF  WK-TS-TORI-INFO
             TO  SWK-KN-PN-CD           OF  UKE-KIRIKAE-INF
                                        OF  PARM-SMZJ1920-ARG1
      *---------- キャッシュフロー2回有効フラグ
           MOVE  WK-KK-CF-NK-YK-FLG     OF  WK-TS-TORI-INFO
             TO  CASH-FLOW-TWO-FLG      OF  UKE-KIRIKAE-INF
                                        OF  PARM-SMZJ1920-ARG1
      *---------- 基本会計ベースフラグ
           MOVE  WK-KK-KH-KK-BASE-FLG   OF  WK-TS-TORI-INFO
             TO  KH-KAIKEI-BS-FLG       OF  UKE-KIRIKAE-INF
                                        OF  PARM-SMZJ1920-ARG1
      *----------  勘定異動／残高作成
           MOVE  I-KJIDO-ZANSK          OF  WK-DENBUN-IN
             TO  KJIDO-ZANSK            OF  PARM-SMZJ1920-ARG1
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":資金取引データ.決済口座通貨コード=["
      D             KOZA-TUKA-CD        OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.市場通貨コード=["
      D             SIJO-TUKA-CD        OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.取引連関ＩＤ=["
      D             THRK-ID             OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.決済通貨異動額=["
      D             KSTK-IDOG           OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.運用通貨異動額=["
      D             UYTK-IDOG           OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.取引事由 =["
      D             TORI-JIYU           OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.異動確定区分 =["
      D             IDO-KBN             OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.証券種別コード=["
      D             SEC-SBT-CD          OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":資金取引データ.取引内容 =["
      D             TORI-NAIY           OF  SIKIN-TORI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計算パターン:"
      D    DISPLAY  CNS-PGM-ID":払出簿価計算方法  =["
      D             DEBET-BOKA-CALC-HOU OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（市場通貨） =["
      D             DEBET-BOKA-HASU-BC  OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（市場通貨）=["
      D             DEBET-TNK-KETASU-BC OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（市場通貨）=["
      D             DEBET-TNK-HASU-BC   OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出簿価端数（運用通貨）=["
      D             DEBET-BOKA-HASU-LC  OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価桁数（運用通貨）=["
      D             DEBET-TNK-KETASU-LC OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":払出単価端数（運用通貨）=["
      D             DEBET-TNK-HASU-LC   OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート適用フラグ =["
      D             BOKA-KWS-TEKIYO-FLG OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート端数 =["
      D             BOKA-KWS-HASU       OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート桁数 =["
      D             BOKA-KWS-KETASU     OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分簿価端数 =["
      D             ANB-BOKA-HASU       OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分単価端数 =["
      D             ANB-TNK-HASU        OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":按分単価桁数 =["
      D             ANB-TNK-KETASU      OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":前払金償却分端数 =["
      D             MAEKIN-SHOUKYK-HASU OF  YIDOU-CALC-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":直前の資金簿価異動:"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（内物）=["
      D             SJTK-IDOG-MSNKZN-UM OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（内物）=["
      D             UYTK-IDOG-MSNKZN-UM OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（外物）=["
      D             SJTK-IDOG-MSNKZN-SM OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（外物）=["
      D             UYTK-IDOG-MSNKZN-SM OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（内物）=["
      D             SJTK-IDOG-MBKZN-UM  OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（内物）=["
      D             UYTK-IDOG-MBKZN-UM  OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（外物）=["
      D             SJTK-IDOG-MBKZN-SM  OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（外物）=["
      D             UYTK-IDOG-MBKZN-SM  OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後CASH残高=["
      D             SJTK-IDOG-SK-BOKAZN OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後CASH残高=["
      D             UYTK-IDOG-SK-BOKAZN OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序=["
      D             IDO-KJY-JUN         OF  TZ-SK-BOKA-IDO-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":通貨デフォールト端数処理=["
      D             TUKA-DEF-HASU-SYRI-PARM
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.処理実行日=["
      D             SYORI-YMD           OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.起動ID  =["
      D             KIDOU-ID            OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.利用会社コード =["
      D             RIYO-CMP-CD         OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ファンドコード=["
      D             FUND-CD             OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.ポートフォリオコード=["
      D             PTF-CD              OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.銘柄コード =["
      D             MEG-CD              OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報.証券種別コード =["
      D             SEC-SBT-CD          OF  MEG-BETU-DMN-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象資金取引情報.原取引ＩＤ=["
      D             TORI-ID             OF  TAGET-SIKIN-TORI-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象資金取引情報.資金種別  =["
      D             SIKIN-SBT           OF  TAGET-SIKIN-TORI-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象資金取引情報.異動日 =["
      D             IDO-YMD             OF  TAGET-SIKIN-TORI-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象資金取引情報.増減区分=["
      D             ZG-KBN              OF  TAGET-SIKIN-TORI-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":対象資金取引情報.処理順=["
      D             SRJUN               OF  TAGET-SIKIN-TORI-INFO
      D                                 OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨コード=["
      D             CAPITAL-TUKA-CD     OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.仕訳基準パターンコード=["
      D              SWK-KJN-PTN-CD     OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":基準日断面情報.基本会計ベースフラグ=["
      D             KH-KAIKEI-BASE-FLG  OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":キャッシュフロー2回有効フラグ=["
      D             CASH-FLOW-2-FLG     OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":乗算/除算区分=["
      D             JZ-JS-KBN           OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受渡計上切替対象フラグ=["
      D             UKE-KIRIKAE-FLG     OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受渡計上切替対象情報."
      D             "仕訳基準パターンコード=["SWK-KN-PN-CD
      D             OF  UKE-KIRIKAE-INF OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受渡計上切替対象情報."
      D             "キャッシュフロー2回有効フラグ=["CASH-FLOW-TWO-FLG
      D             OF  UKE-KIRIKAE-INF OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":受渡計上切替対象情報."
      D             "基本会計ベースフラグ=["KH-KAIKEI-BS-FLG
      D             OF  UKE-KIRIKAE-INF OF  PARM-SMZJ1920-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":勘定異動／残高作成 =["
      D             KJIDO-ZANSK         OF  PARM-SMZJ1920-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ1920"             USING  PARM-SMZJ1920-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ1920)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- @ ワーク警告情報数 ←  リターンパッケージ.警告情報数
             MOVE  WARN-INFO-SU         OF  PARM-SMZJ1920-ARG2
               TO  WK-WARN-INFO-KN
      *---------- ワーク警告情報 ← リターンパッケージ.警告情報
             MOVE  WARN-INFO            OF  PARM-SMZJ1920-ARG2
               TO  WK-WARN-INFO
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報数 =["WK-WARN-INFO-KN"]"
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報   =["WK-WARN-INFO   "]"
      *-----------------------------------------------------------------
      *---------- A 警告メッセージ出力
             PERFORM  WARN-MSG-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報数 =["WK-WARN-INFO-KN"]"
      *-----------------------------------------------------------------
             IF  WK-WARN-INFO-KN = ZERO
             THEN
               CONTINUE
             ELSE
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
               IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-200
               THEN
                 MOVE  CNS-MT-JS-200    TO  WK-MT-JIKKOU-STATUS
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-RETURN-CD < CNS-RTN-BT2
               THEN
                 MOVE  CNS-RTN-BT2      TO  WK-RETURN-CD
               ELSE
                 CONTINUE
               END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
               IF  WK-STK-STS-KJN-YMD  OF  WK-TKMZBW02 < CNS-MT-JS-200
               THEN
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '200'(警告終了)
                 MOVE  CNS-MT-JS-200
                 TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
               ELSE
                 CONTINUE
               END-IF
             END-IF
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-115          TO  WK-ERR-POS
             PERFORM  ERR-MSG-1-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 異動簿価.損益計算(資金)処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ1920-EXT.
           EXIT.
      ******************************************************************
      *    4.3.2.6.直前異動セット
      ******************************************************************
       SK-BOKA-IDO-EDIT-RTN   SECTION.
      *-----------------------------------------------------------------
      *---------- 利用会社コード
           MOVE  RIYO-CMP-CD            OF  PARM-SMZJ1920-ARG2
             TO  RIYO-CMP-CD            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- ファンドコード
           MOVE  FUND-CD                OF  PARM-SMZJ1920-ARG2
             TO  FUND-CD                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- ポートフォリオコード
           MOVE  PTF-CD                 OF  PARM-SMZJ1920-ARG2
             TO  PTF-CD                 OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 原取引ID
           MOVE  TORI-ID                OF  PARM-SMZJ1920-ARG2
             TO  TORI-ID                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 決済口座番号
           MOVE  KS-KOZA-NO             OF  PARM-SMZJ1920-ARG2
             TO  KS-KOZA-NO             OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 資金種別
           MOVE  SIKIN-SBT              OF  PARM-SMZJ1920-ARG2
             TO  SIKIN-SBT              OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 異動日
           MOVE  IDO-YMD                OF  PARM-SMZJ1920-ARG2
             TO  IDO-YMD                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 増減区分
           MOVE  ZG-KBN                 OF  PARM-SMZJ1920-ARG2
             TO  ZG-KBN                 OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 赤黒区分
           MOVE  AKA-KBN                OF  PARM-SMZJ1920-ARG2
             TO  AKA-KBN                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 誤計上
           MOVE  ERR-KJY-NO             OF  PARM-SMZJ1920-ARG2
             TO  ERR-KJY-NO             OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 誤計上区分
           MOVE  ERR-KJY-KBN            OF  PARM-SMZJ1920-ARG2
             TO  ERR-KJY-KBN            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 取引事由
           MOVE  TORI-JIYU              OF  PARM-SMZJ1920-ARG2
             TO  TORI-JIYU              OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 取引連関ID
           MOVE  THRK-ID                OF  PARM-SMZJ1920-ARG2
             TO  THRK-ID                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 決済口座通貨コード
           MOVE  KOZA-TUKA-CD           OF  PARM-SMZJ1920-ARG2
             TO  KOZA-TUKA-CD           OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 証券種別コード
           MOVE  SEC-SBT-CD             OF  PARM-SMZJ1920-ARG2
             TO  SEC-SBT-CD             OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨資金簿価異動額
           MOVE  SJTK-SK-BOKA-IDOGK     OF  PARM-SMZJ1920-ARG2
             TO  SJTK-SK-BOKA-IDOGK     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨資金簿価異動額
           MOVE  UYTK-SK-BOKA-IDOGK     OF  PARM-SMZJ1920-ARG2
             TO  UYTK-SK-BOKA-IDOGK     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨払出簿価
           MOVE  SJTK-H-BOKA            OF  PARM-SMZJ1920-ARG2
             TO  SJTK-H-BOKA            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨払出簿価
           MOVE  UYTK-H-BOKA            OF  PARM-SMZJ1920-ARG2
             TO  UYTK-H-BOKA            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨払出単価
           MOVE  SJTK-H-TNK             OF  PARM-SMZJ1920-ARG2
             TO  SJTK-H-TNK             OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨払出単価
           MOVE  UYTK-H-TNK             OF  PARM-SMZJ1920-ARG2
             TO  UYTK-H-TNK             OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 簿価為替レート
           MOVE  BOKA-KWS               OF  PARM-SMZJ1920-ARG2
             TO  BOKA-KWS               OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後ＣＡＳＨ残高
           MOVE  SJTK-IDOG-SK-BOKAZN    OF  PARM-SMZJ1920-ARG2
             TO  SJTK-IDOG-SK-BOKAZN    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後ＣＡＳＨ残高
           MOVE  UYTK-IDOG-SK-BOKAZN    OF  PARM-SMZJ1920-ARG2
             TO  UYTK-IDOG-SK-BOKAZN    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未収入金残高（内物）
           MOVE  SJTK-IDOG-MSNKZN-UM    OF  PARM-SMZJ1920-ARG2
             TO  SJTK-IDOG-MSNKZN-UM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未収入金残高（内物）
           MOVE  UYTK-IDOG-MSNKZN-UM    OF  PARM-SMZJ1920-ARG2
             TO  UYTK-IDOG-MSNKZN-UM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未収入金残高（外物）
           MOVE  SJTK-IDOG-MSNKZN-SM    OF  PARM-SMZJ1920-ARG2
             TO  SJTK-IDOG-MSNKZN-SM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未収入金残高（外物）
           MOVE  UYTK-IDOG-MSNKZN-SM    OF  PARM-SMZJ1920-ARG2
             TO  UYTK-IDOG-MSNKZN-SM    OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未払金残高（内物）
           MOVE  SJTK-IDOG-MBKZN-UM     OF  PARM-SMZJ1920-ARG2
             TO  SJTK-IDOG-MBKZN-UM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未払金残高（内物）
           MOVE  UYTK-IDOG-MBKZN-UM     OF  PARM-SMZJ1920-ARG2
             TO  UYTK-IDOG-MBKZN-UM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨異動後未払金残高（外物）
           MOVE  SJTK-IDOG-MBKZN-SM     OF  PARM-SMZJ1920-ARG2
             TO  SJTK-IDOG-MBKZN-SM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨異動後未払金残高（外物）
           MOVE  UYTK-IDOG-MBKZN-SM     OF  PARM-SMZJ1920-ARG2
             TO  UYTK-IDOG-MBKZN-SM     OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 為替差損益
           MOVE  UYTK-KWS-SNEKI         OF  PARM-SMZJ1920-ARG2
             TO  UYTK-KWS-SNEKI         OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 市場通貨利金等損益勘定
           MOVE  SJTK-RKSEKJ            OF  PARM-SMZJ1920-ARG2
             TO  SJTK-RKSEKJ            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 運用通貨利金等損益勘定
           MOVE  UYTK-RKSEKJ            OF  PARM-SMZJ1920-ARG2
             TO  UYTK-RKSEKJ            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 異動計上順序
           MOVE  IDO-KJY-JUN            OF  PARM-SMZJ1920-ARG2
             TO  IDO-KJY-JUN            OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 削除区分
           MOVE  SAKUJO-KBN             OF  PARM-SMZJ1920-ARG2
             TO  SAKUJO-KBN             OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 作成フラグ
           MOVE  SK-FLG                 OF  PARM-SMZJ1920-ARG2
             TO  SK-FLG                 OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 作成日時
           MOVE  SK-DATE                OF  PARM-SMZJ1920-ARG2
             TO  SK-DATE                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 作成ログインユーザ会社コード
           MOVE  SK-LOGIN-CMP-CD        OF  PARM-SMZJ1920-ARG2
             TO  SK-LOGIN-CMP-CD        OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 作成ユーザＩＤ
           MOVE  SK-SID                 OF  PARM-SMZJ1920-ARG2
             TO  SK-SID                 OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 作成プログラムＩＤ
           MOVE  SK-PGMID               OF  PARM-SMZJ1920-ARG2
             TO  SK-PGMID               OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 更新フラグ
           MOVE  UPD-FLG                OF  PARM-SMZJ1920-ARG2
             TO  UPD-FLG                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 更新日時
           MOVE  UPD-DATE               OF  PARM-SMZJ1920-ARG2
             TO  UPD-DATE               OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 更新ログインユーザ会社コード
           MOVE  UPD-LOGIN-CMP-CD       OF  PARM-SMZJ1920-ARG2
             TO  UPD-LOGIN-CMP-CD       OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 更新ユーザＩＤ
           MOVE  UPD-SID                OF  PARM-SMZJ1920-ARG2
             TO  UPD-SID                OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *---------- 更新プログラムＩＤ
           MOVE  UPD-PGMID              OF  PARM-SMZJ1920-ARG2
             TO  UPD-PGMID              OF  WK-TYOKUZEN-SK-BOKA-IDOG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード  =["
      D             FUND-CD             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":原取引ID  =["
      D             TORI-ID             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":決済口座番号 =["
      D             KS-KOZA-NO          OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":資金種別  =["
      D             SIKIN-SBT           OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":異動日   =["
      D             IDO-YMD             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":増減区分 =["
      D             ZG-KBN              OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":赤黒区分   =["
      D             AKA-KBN             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":誤計上  =["
      D             ERR-KJY-NO          OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":誤計上区分=["
      D             ERR-KJY-KBN         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":取引事由=["
      D             TORI-JIYU           OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":取引連関ID =["
      D             THRK-ID             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":決済口座通貨コード =["
      D             KOZA-TUKA-CD        OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":証券種別コード =["
      D             SEC-SBT-CD          OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨資金簿価異動額 =["
      D             SJTK-SK-BOKA-IDOGK  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨資金簿価異動額=["
      D             UYTK-SK-BOKA-IDOGK  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出簿価 =["
      D             SJTK-H-BOKA         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出簿価 =["
      D             UYTK-H-BOKA         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨払出単価  =["
      D             SJTK-H-TNK          OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨払出単価  =["
      D             UYTK-H-TNK          OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":簿価為替レート =["
      D             BOKA-KWS            OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後ＣＡＳＨ残高  =["
      D             SJTK-IDOG-SK-BOKAZN OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後ＣＡＳＨ残高  =["
      D             UYTK-IDOG-SK-BOKAZN OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（内物）=["
      D             SJTK-IDOG-MSNKZN-UM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（内物）=["
      D             UYTK-IDOG-MSNKZN-UM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未収入金残高（外物）=["
      D             SJTK-IDOG-MSNKZN-SM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未収入金残高（外物）=["
      D             UYTK-IDOG-MSNKZN-SM OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（内物） =["
      D             SJTK-IDOG-MBKZN-UM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（内物）=["
      D             UYTK-IDOG-MBKZN-UM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨異動後未払金残高（外物）=["
      D             SJTK-IDOG-MBKZN-SM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨異動後未払金残高（外物）=["
      D             UYTK-IDOG-MBKZN-SM  OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":為替差損益    =["
      D             UYTK-KWS-SNEKI      OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":市場通貨利金等損益勘定  =["
      D             SJTK-RKSEKJ         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":運用通貨利金等損益勘定 =["
      D             UYTK-RKSEKJ         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":異動計上順序  =["
      D             IDO-KJY-JUN         OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":削除区分   =["
      D             SAKUJO-KBN          OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":作成フラグ   =["
      D             SK-FLG              OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":作成日時    =["
      D             SK-DATE             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":作成ログインユーザ会社コード  =["
      D             SK-LOGIN-CMP-CD     OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":作成ユーザＩＤ   =["
      D             SK-SID              OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":作成プログラムＩＤ  =["
      D             SK-PGMID            OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":更新フラグ  =["
      D             UPD-FLG             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":更新日時  =["
      D             UPD-DATE            OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":更新ログインユーザ会社コード =["
      D             UPD-LOGIN-CMP-CD    OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":更新ユーザＩＤ =["
      D             UPD-SID             OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      D    DISPLAY  CNS-PGM-ID":更新プログラムＩＤ =["
      D             UPD-PGMID           OF  WK-TYOKUZEN-SK-BOKA-IDOG"]"
      *-----------------------------------------------------------------
           CONTINUE.
       SK-BOKA-IDO-EDIT-EXT.
           EXIT.
      ******************************************************************
      *   4.3.2.7 対象資金取引情報データカーソルクローズ処理
      ******************************************************************
      * TKMZBW05-CLOSE-RTN     SECTION.
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  対象資金取引情報データカーソル"
      *D             "クローズ 処理  START  ***"
      **-----------------------------------------------------------------
      *     EXEC  SQL
      *         CLOSE TKMZBW05_CURSOR
      *     END-EXEC
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      **-----------------------------------------------------------------
      *     IF  SQLCODE = CNS-SQL-NORMAL
      *     THEN
      *       MOVE  CNS-OFF              TO  FLG-TKMZBW05-CR-OPEN
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW05-CR-OPEN=["
      *D             FLG-TKMZBW05-CR-OPEN"]"
      **-----------------------------------------------------------------
      *     ELSE
      **-----------------------DEBUG-------------------------------------
      *D    DISPLAY  CNS-PGM-ID":SQL処理エラー（CLOSE)"
      **-----------------------------------------------------------------
      **---------- ワークエラーパッケージを編集
      *       INITIALIZE  WK-SYS-ERR-INFO
      *       MOVE  CNS-POS-116          TO  WK-ERR-POS
      *       STRING  CNS-SQL-MSG-SELECT,
      *               WK-MSG-1-5         DELIMITED  BY  SIZE
      *         INTO  WK-FREE-MSG        OF  WK-SYS-ERR-INFO
      *       PERFORM  ERR-MSG-2-RTN
      *     END-IF
      **-------------------<DEBUG>---------------------------------------
      *D    DISPLAY  CNS-PGM-ID":***  対象資金取引情報データカーソル"
      *D             "クローズ 処理 END  ***"
      **-----------------------------------------------------------------
      *     CONTINUE.
      * TKMZBW05-CLOSE-EXT.
      *     EXIT.
      ******************************************************************
      *    4.4 警告メッセージ出力処理
      ******************************************************************
       WARN-MSG-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  警告メッセージ出力処理  START  ***"
      *-----------------------------------------------------------------
      *---------- 4.4.1.警告メッセージ編集
           PERFORM  WARN-MSG-EDIT-RTN
      *---------- 4.4.2.警告メッセージ出力
           PERFORM  WARN-MSG-OUT-RTN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  警告メッセージ出力処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       WARN-MSG-EXT.
           EXIT.
      ******************************************************************
      *    4.4.1.警告メッセージ編集
      ******************************************************************
       WARN-MSG-EDIT-RTN      SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  警告メッセージ編集処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報数 =["WK-WARN-INFO-KN"]"
      *-----------------------------------------------------------------
           PERFORM                  VARYING  WK-IDX3
             FROM  CNS-1 BY  CNS-1  UNTIL  WK-IDX3 > WK-WARN-INFO-KN
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-IDX3=["WK-IDX3"]"
      D    DISPLAY  CNS-PGM-ID":WK-CounterA=["WK-CounterA"]"
      *-----------------------------------------------------------------
      *---------- 1)ポートフォリオエラーメッセージへインサート
      *---------- ワークメッセージエリア(ワークCounterA).ファンドコード ←
      *---------- ワークポートフォリオ情報.ファンドコード
             MOVE  WK-FUND-CD           OF  WK-PTF-INFO
               TO  WK-FUND-CD           OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).ポートフォリオコード ←
      *---------- ワークポートフォリオ情報.ポートフォリオコード
             MOVE  WK-PTF-CD            OF  WK-PTF-INFO
               TO  WK-PTF-CD            OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日From ← ワーク明細管理用基準日FROM
             MOVE  WK-MKY-KJN-YMD-FROM
               TO  WK-KJN-YMD-FROM      OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).基準日To ← ワーク電文解析情報.指定To日
             MOVE  WK-SITEI-TO          OF  WK-DENBUN-KAISEKI-INFO
               TO  WK-KJN-YMD-TO        OF  WK-MSG-AREA(WK-CounterA)
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク銘柄別断面情報.銘柄種類=["
      D             WK-MEG-CD-SHRU      OF  WK-TKMZBW03"]"
      *-----------------------------------------------------------------
             EVALUATE  WK-MEG-CD-SHRU   OF  WK-TKMZBW03
               WHEN  CNS-MEG-CD-SHRU-1
               WHEN  CNS-MEG-CD-SHRU-2
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
                STRING
                   CNS-MSG-40,TORI-ID           OF  PARM-SMZJ1910-ARG2,
                   CNS-MSG-41,KEIJOU-KIJUNBI    OF  PARM-SMZJ1910-ARG2,
                   CNS-MSG-42,AKA-KBN           OF  PARM-SMZJ1910-ARG2,
                   CNS-MSG-43,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-44,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-45,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-46,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-47,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-48,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-49,WK-KABU-SBT       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-KAYI           OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GOU            OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-GENGETSU       OF  WK-MEG-CD-REF,
                   CNS-MSG-50,WK-STRIKEPRICE-X,
                   CNS-MSG-50,WK-MNK-YMD        OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-52,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
               WHEN  CNS-MEG-CD-SHRU-3
      *---------- ワークメッセージエリア(ワークCounterA).フリーメッセージ
                 MOVE  WK-STRIKEPRICE   OF  WK-MEG-CD-REF
                   TO  WK-STRIKEPRICE-M
                 MOVE  WK-STRIKEPRICE-M TO  WK-STRIKEPRICE-X
                STRING
                   CNS-MSG-40,TORI-ID           OF  PARM-SMZJ1920-ARG2,
                   CNS-MSG-53,SIKIN-SBT         OF  PARM-SMZJ1920-ARG2,
                   CNS-MSG-54,IDO-YMD           OF  PARM-SMZJ1920-ARG2,
                   CNS-MSG-55,ZG-KBN            OF  PARM-SMZJ1920-ARG2,
                   CNS-MSG-42,AKA-KBN           OF  PARM-SMZJ1920-ARG2,
                   CNS-MSG-43,WK-KJN-YMD        OF  WK-TKMZBW03,
                   CNS-MSG-44,WK-SEC-SBT-CD     OF  WK-TKMZBW03,
                   CNS-MSG-45,WK-GAIBU-MEG-CD   OF  WK-MEG-CD-REF,
                   CNS-MSG-46,WK-MEG-TUKA-CD    OF  WK-MEG-CD-REF,
                   CNS-MSG-47,WK-HAKKO-TAI-KUNI-CD OF  WK-MEG-CD-REF,
                   CNS-MSG-48,WK-TSTSK-CD       OF  WK-MEG-CD-REF,
                   CNS-MSG-51,WK-TATE-FLG       OF  WK-TKMZBW03,
                   CNS-MSG-52,WK-GYOKU-ID       OF  WK-TKMZBW03
                   DELIMITED  BY  SIZE
                   INTO  WK-FREE-MSG    OF  WK-MSG-AREA(WK-CounterA)
               WHEN  OTHER
                 CONTINUE
             END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             WK-FUND-CD          OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             WK-PTF-CD           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日From =["
      D             WK-KJN-YMD-FROM     OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":基準日To =["
      D             WK-KJN-YMD-TO       OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ =["
      D             WK-FREE-MSG         OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク警告情報("WK-IDX3").警告フラグ=["
      D             WARN-FLG            OF  WK-WARN-INFO(WK-IDX3)"]"
      *-----------------------------------------------------------------
             EVALUATE  WARN-FLG         OF  WK-WARN-INFO(WK-IDX3)
      *---------- @ワーク警告情報(IDX1).警告フラグ＝'G1'の場合
               WHEN  CNS-G1
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M05のメッセージID
                 MOVE  CNS-MSG-W000454
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '源泉税還付金入金額'
                 MOVE  CNS-TK-MOJI-43
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←'予定額'
                 MOVE  CNS-TK-MOJI-44
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Aワーク警告情報(IDX1).警告フラグ＝'F1'の場合
               WHEN  CNS-F1
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M06のメッセージID
                 MOVE  CNS-MSG-W000455
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '数量残高'
                 MOVE  CNS-TK-MOJI-45
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←
      *---------- '簿価残高'
                 MOVE  CNS-TK-MOJI-46
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Bワーク警告情報(IDX1).警告フラグ＝'F2'の場合
               WHEN  CNS-F2
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M06のメッセージID
                 MOVE  CNS-MSG-W000455
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '市場通貨異動後CASH残高'
                 MOVE  CNS-TK-MOJI-47
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←
      *---------- '運用通貨異動後CASH残高'
                 MOVE  CNS-TK-MOJI-48
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Bワーク警告情報(IDX1).警告フラグ＝'F3'の場合
               WHEN  CNS-F3
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M06のメッセージID
                 MOVE  CNS-MSG-W000455
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '数量残高'
                 MOVE  CNS-TK-MOJI-45
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←
      *---------- '前払金残高'
                 MOVE  CNS-TK-MOJI-75
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Cワーク警告情報(IDX1).警告フラグ＝'G2'の場合
               WHEN  CNS-G2
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M06のメッセージID
                 MOVE  CNS-MSG-W000455
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←
      *---------- '取引集約の異動数量'
                 MOVE  CNS-TK-MOJI-1
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←
      *---------- '異動後数量残高'
                 MOVE  CNS-TK-MOJI-2
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Dワーク警告情報(IDX1).警告フラグ＝'L1'の場合
               WHEN  CNS-L1
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M33のメッセージID
                 MOVE  CNS-MSG-E000582
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←''
                 MOVE  WK-TORI-ID       OF  WK-TRHK-DATA
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Eワーク警告情報(IDX1).警告フラグ＝'M1'の場合
               WHEN  CNS-M1
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M16のメッセージID
                 MOVE  CNS-MSG-W000486
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Fワーク警告情報(IDX1).警告フラグ＝'M2'の場合
               WHEN  CNS-M2
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M17のメッセージID
                 MOVE  CNS-MSG-W000487
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Gワーク警告情報(IDX1).警告フラグ＝'N1'の場合
               WHEN  CNS-N1
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M12のメッセージID
                 MOVE  CNS-MSG-W000563
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Hワーク警告情報(IDX1).警告フラグ＝'M3'の場合
               WHEN  CNS-M3
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M08のメッセージID
                 MOVE  CNS-MSG-E000429
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '処理対象前払金'
                 MOVE  CNS-TK-MOJI-65
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Iワーク警告情報(IDX1).警告フラグ＝'M4'の場合
               WHEN  CNS-M4
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M29のメッセージID
                 MOVE  CNS-MSG-E000593
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '市場通貨前払金'
                 MOVE  CNS-TK-MOJI-69
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Jワーク警告情報(IDX1).警告フラグ＝'M5'の場合
               WHEN  CNS-M5
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M29のメッセージID
                 MOVE  CNS-MSG-E000593
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '運用通貨前払金'
                 MOVE  CNS-TK-MOJI-70
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Kワーク警告情報(IDX1).警告フラグ＝'M6'の場合
               WHEN  CNS-M6
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M30のメッセージID
                 MOVE  CNS-MSG-E000574
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '市場通貨前払金'
                 MOVE  CNS-TK-MOJI-69
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Lワーク警告情報(IDX1).警告フラグ＝'M7'の場合
               WHEN  CNS-M7
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M30のメッセージID
                 MOVE  CNS-MSG-E000574
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '運用通貨前払金'
                 MOVE  CNS-TK-MOJI-70
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Mワーク警告情報(IDX1).警告フラグ＝'M8'の場合
               WHEN  CNS-M8
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M31のメッセージID
                 MOVE  CNS-MSG-E000575
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '市場通貨前払金'
                 MOVE  CNS-TK-MOJI-69
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Nワーク警告情報(IDX1).警告フラグ＝'M9'の場合
               WHEN  CNS-M9
      *---------- ワークメッセージエリア(ワークCounterA).メッセー           ←  M31のメッセージID
                 MOVE  CNS-MSG-E000575
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '運用通貨前払金'
                 MOVE  CNS-TK-MOJI-70
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Oワーク警告情報(IDX1).警告フラグ＝'MA'の場合
               WHEN  CNS-MA
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M31のメッセージID
                 MOVE  CNS-MSG-E000575
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '前払金数量'
                 MOVE  CNS-TK-MOJI-72
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Pワーク警告情報(IDX1).警告フラグ＝'MB'の場合
               WHEN  CNS-MB
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M32のメッセージID
                 MOVE  CNS-MSG-E000576
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
      *---------- Pワーク警告情報(IDX1).警告フラグ＝'MC'の場合
               WHEN  CNS-MC
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID ← M37のメッセージID
                 MOVE  CNS-MSG-W900142
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字 ←''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- Qワーク警告情報(IDX1).警告フラグ＝'MD'の場合
               WHEN  CNS-MD
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M38のメッセージID
                 MOVE  CNS-MSG-E900143
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← ''
                 MOVE  SPACE
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
      *---------- ワークメッセージ種類              ←  1
                 MOVE  CNS-1            TO  WK-MSG-SYO
               WHEN  CNS-N2
      *---------- ワークメッセージエリア(ワークCounterA).メッセージID← M06のメッセージID
                 MOVE  CNS-MSG-W000455
                   TO  WK-MSG-ID        OF  WK-MSG-AREA(WK-CounterA)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(1).置換文字← '取引の経過利息区分'
                 MOVE  CNS-TK-MOJI-78
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,1)
      *---------- ワークメッセージエリア(ワークCounterA).置換文字詳細(2).置換文字← '銘柄属性'
                 MOVE  CNS-TK-MOJI-79
                   TO  WK-TK-MOJI       OF  WK-MSG-AREA(WK-CounterA,2)
               WHEN  OTHER
                 CONTINUE
             END-EVALUATE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":メッセージID =["
      D             WK-MSG-ID           OF  WK-MSG-AREA(WK-CounterA)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(1).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,1)"]"
      D    DISPLAY  CNS-PGM-ID":置換文字詳細(2).置換文字 =["
      D             WK-TK-MOJI         OF  WK-MSG-AREA(WK-CounterA,2)"]"
      D    DISPLAY  CNS-PGM-ID":ワークメッセージ種類 =["WK-MSG-SYO"]"
      *-----------------------------------------------------------------
      *---------- ワークCounterA ← ワークCounterA＋1
           COMPUTE  WK-CounterA  =  WK-CounterA + CNS-1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
           END-PERFORM
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 警告メッセージ編集処理 END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       WARN-MSG-EDIT-EXT.
           EXIT.
      ******************************************************************
      *    4.4.2.警告メッセージ出力
      ******************************************************************
       WARN-MSG-OUT-RTN       SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  警告メッセージ出力  START  ***"
      *-----------------------------------------------------------------
      *---------- 1)【SCZY7080】バッチメッセージＩＮＳルーチン
           PERFORM  PTF-LOGIN-RTN
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *---------- 基準日別終了処理へ
             PERFORM  KJN-YMD-END-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  警告メッセージ出力  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       WARN-MSG-OUT-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ(1)
      ******************************************************************
       ERR-MSG-1-RTN          SECTION.
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
           MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
             TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
           PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
           THEN
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT16
           THEN
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
           MOVE  CNS-MT-JS-400
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
           PERFORM  KJN-YMD-END-RTN
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-1-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ(2)
      ******************************************************************
       ERR-MSG-2-RTN          SECTION.
      *-----------------------------------------------------------------
      *---------- エラー検知プログラムID
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-900            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  SQLCODE                TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-1           TO  WK-DETAIL-RTN-CD-FLG
      *---------- エラー情報追加処理
           PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
           THEN
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT16
           THEN
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
           MOVE  CNS-MT-JS-400
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
           PERFORM  KJN-YMD-END-RTN
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-2-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ(3)
      ******************************************************************
       ERR-MSG-3-RTN          SECTION.
      *-----------------------------------------------------------------
      *---------- エラー検知プログラムID
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-900            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  SQLCODE                TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-1           TO  WK-DETAIL-RTN-CD-FLG
      *---------- エラー情報追加処理
           PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
           THEN
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT16
           THEN
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-3-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ(4)
      ******************************************************************
       ERR-MSG-4-RTN          SECTION.
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
           MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
             TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
           PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
           THEN
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
           MOVE  CNS-RTN-BT16           TO  WK-RETURN-CD
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
           MOVE  CNS-MT-JS-400
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
           PERFORM  KJN-YMD-END-RTN
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-4-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ(5)
      ******************************************************************
       ERR-MSG-5-RTN          SECTION.
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
           MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
             TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
           MOVE  SPACE
             TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
           PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
           THEN
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT16
           THEN
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-5-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ(6)
      ******************************************************************
       ERR-MSG-6-RTN          SECTION.
      *-----------------------------------------------------------------
      *---------- エラー検知プログラムID
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-900            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  SQLCODE                TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-1           TO  WK-DETAIL-RTN-CD-FLG
      *---------- エラー情報追加処理
           PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
           THEN
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           IF  WK-RETURN-CD < CNS-RTN-BT16
           THEN
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
           ELSE
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-6-EXT.
           EXIT.
      ******************************************************************
      *    エラーメッセージ(7)
      ******************************************************************
       ERR-MSG-7-RTN          SECTION.
      *-----------------------------------------------------------------
      *---------- エラー検知プログラムID
           MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
           MOVE  CNS-RTN-900            TO  WK-RTN-CD
      *---------- 詳細リターンコード
           MOVE  SQLCODE                TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
           MOVE  CNS-DETAIL-1           TO  WK-DETAIL-RTN-CD-FLG
      *---------- エラー情報追加処理
           PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
           MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
           MOVE  CNS-MT-JS-400
             TO  WK-STK-STS-KJN-YMD     OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
      *---------- 基準日別終了処理へ
           PERFORM  KJN-YMD-END-RTN
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-7-EXT.
           EXIT.
      ******************************************************************
      *   3.2.2.7.ポートフォリオ終了処理
      ******************************************************************
       PTF-END-RTN            SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ終了処理 START  ***"
      *-----------------------------------------------------------------
      *---------- 1)カーソルクローズ処理
      *    PERFORM  CURSOR-CLOSE-RTN
      *---------- 2)ポートフォリオ別メッセージ登録処理
           PERFORM  PTF-LOGIN-1-RTN
      *---------- Bコミットする
           PERFORM  DB-COMMIT2-RTN
      *---------- 3)中間DBデータ削除
           PERFORM  DB-DELETE-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":進捗管理なし断面の削除実行フラグ =["
      D             WK-SMZJ4019-FLG"]"
      *-----------------------------------------------------------------
           IF  WK-SMZJ4019-FLG  =  CNS-ON
           THEN
      *---------- 4)進捗管理なし断面の削除
             PERFORM  SMZJ4019-RTN
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":4)進捗管理なし断面の削除SKIP"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク更新区分=["WK-UPDATE-KBN"]"
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行一時停止区分=["
      D             WK-PTF-STOP-FLG"]"
      D    DISPLAY  CNS-PGM-ID":ワークポートフォリオ実行スキップフラグ"
      D             "=["WK-PTF-SKIP-FLG"]"
      *-----------------------------------------------------------------
           IF  WK-UPDATE-KBN =  CNS-UPDATE-KBN-0
           THEN
             CONTINUE
           ELSE
             IF  WK-PTF-STOP-FLG = CNS-0
             AND WK-PTF-SKIP-FLG = CNS-0
             THEN
      *---------- 4)実行状況管理明細更新処理（最終セッション）
               PERFORM  SCZY7210-UPDATE-RTN
             ELSE
               CONTINUE
             END-IF
           END-IF
      *---------- 5)次の行方
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                      ":ワークポートフォリオ実行一時停止区分=["
      D             WK-PTF-STOP-FLG"]"
      *-----------------------------------------------------------------
           IF  WK-PTF-STOP-FLG  =  CNS-0
           THEN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             EVALUATE  WK-MT-JIKKOU-STATUS
               WHEN  CNS-MT-JS-400
      *---------- 3.4 エラー処理へ
                 PERFORM  ERR-RTN
               WHEN  CNS-MT-JS-100
               WHEN  CNS-MT-JS-150
               WHEN  CNS-MT-JS-200
               WHEN  CNS-MT-JS-270
               WHEN  CNS-MT-JS-275
                 MOVE  CNS-ON             TO  FLG-PTF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-PTF=["FLG-PTF"]"
      *-----------------------------------------------------------------
               WHEN OTHER
                 CONTINUE
             END-EVALUATE
           ELSE
             PERFORM  END-RTN
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ終了処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-END-EXT.
           EXIT.
      ******************************************************************
      *   1)カーソルクローズ処理
      ******************************************************************
       CURSOR-CLOSE-RTN       SECTION.
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルクローズ処理 START  ***"
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-OPEN=["
      D             FLG-TKMZSK00-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZSK00-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZSK00_CURSOR
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZSK00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-OPEN=["
      D             FLG-TKMZSK00-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-117        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-1       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["
      D             FLG-TKMXTR00-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMXTR00-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMXTR00_CURSOR
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMXTR00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMXTR00-CR-OPEN=["
      D             FLG-TKMXTR00-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-118        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-8       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動計算データカーソルオープン"
      D             "フラグ=["FLG-TKMZBW06-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZBW06-CR-1-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZBW06_CUR_1
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZBW06-CR-1-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW06-CR-1-OPEN=["
      D             FLG-TKMZBW06-CR-1-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-119        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-11       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":残高異動カーソルオープンフラグ"
      D             "=["FLG-TKMZZI00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZZI00-CR-1-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZZI00_CUR_1
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZZI00-CR-1-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZI00-CR-1-OPEN=["
      D             FLG-TKMZZI00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-120        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-12       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":処理資金取引カーソルオープンフラグ"
      D             "=["FLG-TKMZBW18-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZBW18-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZBW18_CURSOR
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZBW18-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW18-CR-OPEN=["
      D             FLG-TKMZBW18-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-121        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-10       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象資金取引情報カーソルオープンフラグ"
      D             "=["FLG-TKMZBW05-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZBW05-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZBW05_CURSOR
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZBW05-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW05-CR-OPEN=["
      D             FLG-TKMZBW05-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-122        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-5       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":対象取引情報カーソルオープンフラグ=["
      D             FLG-TKMZBW04-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZBW04-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZBW04_CURSOR
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZBW04-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW04-CR-OPEN=["
      D             FLG-TKMZBW04-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-123        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-4       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZR00-CR-1-OPEN=["
      D             FLG-TKMZZR00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZZR00-CR-1-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZZR00_CUR_1
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZZR00-CR-1-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZZR00-CR-1-OPEN=["
      D             FLG-TKMZZR00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-124        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-13      DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSR00-CR-OPEN=["
      D             FLG-TKMZSR00-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZSR00-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZSR00_CUR_1
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZSR00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSR00-CR-OPEN=["
      D             FLG-TKMZSR00-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-125        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-19      DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報カーソルオープンフラグ=["
      D             FLG-TKMZBW03-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZBW03-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZBW03_CURSOR
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZBW03-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW03-CR-OPEN=["
      D             FLG-TKMZBW03-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-126        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-3       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":銘柄別断面情報カーソルオープンフラグ1=["@3212SEINO@@
      D             FLG-TKMZBW03-CR1-OPEN"]"                            @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
           IF  FLG-TKMZBW03-CR1-OPEN = CNS-ON                           @3212SEINO@@
           THEN                                                         @3212SEINO@@
             EXEC  SQL                                                  @3212SEINO@@
                 CLOSE TKMZBW03_CURSOR1                                 @3212SEINO@@
             END-EXEC                                                   @3212SEINO@@
      *-----------------------DEBUG-------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"              @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
             IF  SQLCODE = CNS-SQL-NORMAL                               @3212SEINO@@
             THEN                                                       @3212SEINO@@
               MOVE  CNS-OFF            TO  FLG-TKMZBW03-CR1-OPEN       @3212SEINO@@
      *-----------------------DEBUG-------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW03-CR1-OPEN=["                @3212SEINO@@
      D             FLG-TKMZBW03-CR1-OPEN"]"                            @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
             ELSE                                                       @3212SEINO@@
      *---------- ワークエラーパッケージを編集                          @3212SEINO@@
               INITIALIZE  WK-SYS-ERR-INFO                              @3212SEINO@@
               MOVE  CNS-POS-126        TO  WK-ERR-POS                  @3212SEINO@@
               STRING  CNS-SQL-MSG-SELECT,                              @3212SEINO@@
                       WK-MSG-1-3       DELIMITED  BY  SIZE             @3212SEINO@@
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO             @3212SEINO@@
               PERFORM  ERR-MSG-3-RTN                                   @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D                      ":取引差分更新管理カーソルオープンフラグ=["
      D             FLG-TKMZSK00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZSK00-CR-1-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZSK00_CUR_1
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZSK00-CR-1-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-1-OPEN=["
      D             FLG-TKMZSK00-CR-1-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-127        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-6       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID                                          @3212SEINO@@
      D                     ":取引差分更新管理カーソルオープンフラグ1=["@3212SEINO@@
      D             FLG-TKMZSK00-CR-1-OPEN-1"]"                         @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
           IF  FLG-TKMZSK00-CR-1-OPEN-1 = CNS-ON                        @3212SEINO@@
           THEN                                                         @3212SEINO@@
             EXEC  SQL                                                  @3212SEINO@@
                 CLOSE TKMZSK00_CUR_2                                   @3212SEINO@@
             END-EXEC                                                   @3212SEINO@@
      *-----------------------DEBUG-------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"              @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
             IF  SQLCODE = CNS-SQL-NORMAL                               @3212SEINO@@
             THEN                                                       @3212SEINO@@
               MOVE  CNS-OFF            TO  FLG-TKMZSK00-CR-1-OPEN-1    @3212SEINO@@
      *-----------------------DEBUG-------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZSK00-CR-1-OPEN-1=["             @3212SEINO@@
      D             FLG-TKMZSK00-CR-1-OPEN-1"]"                         @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
             ELSE                                                       @3212SEINO@@
      *---------- ワークエラーパッケージを編集                          @3212SEINO@@
               INITIALIZE  WK-SYS-ERR-INFO                              @3212SEINO@@
               MOVE  CNS-POS-127        TO  WK-ERR-POS                  @3212SEINO@@
               STRING  CNS-SQL-MSG-SELECT,                              @3212SEINO@@
                       WK-MSG-1-6       DELIMITED  BY  SIZE             @3212SEINO@@
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO             @3212SEINO@@
               PERFORM  ERR-MSG-3-RTN                                   @3212SEINO@@
             END-IF                                                     @3212SEINO@@
           ELSE                                                         @3212SEINO@@
             CONTINUE                                                   @3212SEINO@@
           END-IF                                                       @3212SEINO@@
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":基準日断面情報カーソルオープンフラグ=["
      D             FLG-TKMZBW02-CR-OPEN"]"
      *-----------------------------------------------------------------
           IF  FLG-TKMZBW02-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZBW02_CURSOR
             END-EXEC
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      *-----------------------------------------------------------------
             IF  SQLCODE = CNS-SQL-NORMAL
             THEN
               MOVE  CNS-OFF            TO  FLG-TKMZBW02-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-TKMZBW02-CR-OPEN=["
      D             FLG-TKMZBW02-CR-OPEN"]"
      *-----------------------------------------------------------------
             ELSE
      *---------- ワークエラーパッケージを編集
               INITIALIZE  WK-SYS-ERR-INFO
               MOVE  CNS-POS-128        TO  WK-ERR-POS
               STRING  CNS-SQL-MSG-SELECT,
                       WK-MSG-1-2       DELIMITED  BY  SIZE
                 INTO  WK-FREE-MSG      OF  WK-SYS-ERR-INFO
               PERFORM  ERR-MSG-3-RTN
             END-IF
           ELSE
             CONTINUE
           END-IF
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  カーソルクローズ処理 END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       CURSOR-CLOSE-EXT.
           EXIT.
      ******************************************************************
      *    2)ポートフォリオ別メッセージ登録処理
      ******************************************************************
       PTF-LOGIN-RTN          SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ別メッセージ登録処理"
      D            "  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7080-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7080-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7080-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7080-ARG1
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY7080-ARG1
      *---------- メッセージエリア ← ワークメッセージエリア
           MOVE  WK-MSG-AREA
             TO  MSG-AREA               OF  PARM-SCZY7080-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY7080-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":メッセージエリア=["
      *             MSG-AREA            OF  PARM-SCZY7080-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7080"             USING  PARM-SCZY7080-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7080)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワークメッセージエリアを初期化する
             INITIALIZE  WK-MSG-AREA
      *---------- ワークCounterA      ←  1
             MOVE  CNS-1                TO  WK-CounterA
      *-------------------<DEBUG>---------------------------------------
      *    DISPLAY  CNS-PGM-ID":ワークメッセージエリア =["WK-MSG-AREA"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             PERFORM  SUB-ERR-MSG-RTN
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-129            TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
             THEN
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- ワーク基準日断面情報.進捗ステータス（基準日） ← '400'(システムエラー)
             MOVE  CNS-MT-JS-400
               TO  WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク基準日断面情報.進捗ステータス"
      D"(基準日)=["WK-STK-STS-KJN-YMD   OF  WK-TKMZBW02"]"
      *-----------------------------------------------------------------
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ別メッセージ登録処理"
      D             "  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-LOGIN-EXT.
           EXIT.
      ******************************************************************
      *    ポートフォリオ別メッセージ登録処理
      ******************************************************************
       PTF-LOGIN-1-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ別メッセージ登録処理"
      D            "  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7080-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7080-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7080-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7080-ARG1
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY7080-ARG1
      *---------- メッセージエリア ← ワークメッセージエリア
           MOVE  WK-MSG-AREA
             TO  MSG-AREA               OF  PARM-SCZY7080-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY7080-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":メッセージエリア=["
      *             MSG-AREA            OF  PARM-SCZY7080-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7080"             USING  PARM-SCZY7080-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7080)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- ワークメッセージエリアを初期化する
             INITIALIZE  WK-MSG-AREA
      *---------- ワークCounterA      ←  1
             MOVE  CNS-1                TO  WK-CounterA
      *-------------------<DEBUG>---------------------------------------
      *    DISPLAY  CNS-PGM-ID":ワークメッセージエリア =["WK-MSG-AREA"]"
      D    DISPLAY  CNS-PGM-ID":ワークCounterA =["WK-CounterA"]"
      *-----------------------------------------------------------------
           ELSE
      *---------- ワークエラーパッケージを編集
             PERFORM  SUB-ERR-MSG-RTN
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-130            TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
             THEN
               MOVE  CNS-MT-JS-400      TO  WK-MT-JIKKOU-STATUS
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ポートフォリオ別メッセージ登録処理"
      D             "  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       PTF-LOGIN-1-EXT.
           EXIT.
      ******************************************************************
      *    Bコミット処理
      ******************************************************************
       DB-COMMIT2-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ＤＢコミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
             MOVE  CNS-POS-131          TO  WK-ERR-POS
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
             PERFORM  ERR-MSG-3-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ＤＢコミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-COMMIT2-EXT.
           EXIT.
      ******************************************************************
      *    3)中間DBデータ削除
      ******************************************************************
       DB-DELETE-RTN          SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 中間DBデータ削除 処理  START ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4016-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SMZJ4016-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  SYORI-YMD              OF  PARM-SMZJ4016-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SMZJ4016-ARG1
      *---------- 処理区分
           MOVE  CNS-KJN-DMN-2
             TO  SYORI-KBN              OF  PARM-SMZJ4016-ARG1
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  PARM-SMZJ4016-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日 =["
      D             SYORI-YMD           OF  PARM-SMZJ4016-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID =["
      D             KIDOU-ID            OF  PARM-SMZJ4016-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理区分 =["
      D             SYORI-KBN           OF  PARM-SMZJ4016-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4016"             USING  PARM-SMZJ4016-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4016)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
             PERFORM  SUB-ERR-MSG-RTN
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-132          TO  WK-ERR-POS
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD                 OF  PARM-RTNPKG
                                              (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      *-----------------------------------------------------------------
             IF  WK-MT-JIKKOU-STATUS < CNS-MT-JS-400
             THEN
               MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 中間DBデータ削除 処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-DELETE-EXT.
           EXIT.
      ******************************************************************
      *    4)進捗管理なし断面の削除
      ******************************************************************
       SMZJ4019-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  進捗管理なし断面の削除  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SMZJ4019-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  RIYO-CMP-CD            OF  PARM-SMZJ4019-ARG1
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  FUND-CD                OF  PARM-SMZJ4019-ARG1
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  PTF-CD                 OF  PARM-SMZJ4019-ARG1
      *---------- 計算FROM日
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  CALC-FROM              OF  PARM-SMZJ4019-ARG1
      *---------- 締め日
           MOVE  WK-SHIME-YMD           OF  WK-PTF-INFO
             TO  SHIME-YMD              OF  PARM-SMZJ4019-ARG1
      *-------------------------DEBUG-----------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード =["
      D             RIYO-CMP-CD         OF  PARM-SMZJ4019-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード =["
      D             FUND-CD             OF  PARM-SMZJ4019-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  PARM-SMZJ4019-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":計算FROM日 =["
      D             CALC-FROM           OF  PARM-SMZJ4019-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":締め日 =["
      D             SHIME-YMD           OF  PARM-SMZJ4019-ARG1"]"
      *-----------------------------------------------------------------
           CALL  "SMZJ4019"             USING  PARM-SMZJ4019-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SMZJ4019)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
             PERFORM  SUB-ERR-MSG-RTN
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901          TO  WK-RTN-CD
      *---------- ポジション
             MOVE  CNS-POS-133          TO  WK-ERR-POS
      *---------- 詳細リターンコード
             MOVE  RTN-CD               OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- ワーク明細単位実行ステータス
             MOVE  CNS-MT-JS-400        TO  WK-MT-JIKKOU-STATUS
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワーク明細単位実行ステータス =["
      D             WK-MT-JIKKOU-STATUS"]"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  進捗管理なし断面の削除  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SMZJ4019-EXT.
           EXIT.
      ******************************************************************
      *    4)実行状況管理明細更新処理（最終セッション）
      ******************************************************************
       SCZY7210-UPDATE-RTN    SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新処理"
      D             "（最終セッション）処理 START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7210-INOUT
                       PARM-RTNPKG
      *---------- セッション区分
           MOVE  CNS-SESSION-KBN-1
             TO  SESSION-KBN            OF  PARM-SCZY7210-ARG1
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-PTF-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7210-ARG2
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-PTF-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7210-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-PTF-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7210-ARG2
      *---------- ファンドコード
           MOVE  WK-FUND-CD             OF  WK-PTF-INFO
             TO  FUND-CD                OF  PARM-SCZY7210-ARG2
      *---------- ポートフォリオコード
           MOVE  WK-PTF-CD              OF  WK-PTF-INFO
             TO  PTF-CD                 OF  PARM-SCZY7210-ARG2
      *---------- 評価系列コード
           MOVE  SPACE
             TO  HYK-KRTU-CD            OF  PARM-SCZY7210-ARG2
      *---------- 帳票ID
           MOVE  SPACE
             TO  REP-ID                 OF  PARM-SCZY7210-ARG2
      *---------- 帳票任意コード
           MOVE  SPACE
             TO  REP-ANY-CD             OF  PARM-SCZY7210-ARG2
      *---------- 基準日FROM
           MOVE  WK-MKY-KJN-YMD-FROM
             TO  KJN-YMD-FROM           OF  PARM-SCZY7210-ARG2
      *---------- 実行ステータス
           MOVE  WK-MT-JIKKOU-STATUS
             TO  JIKOU-STS              OF  PARM-SCZY7210-ARG2
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":セッション区分  =["
      D             SESSION-KBN         OF  PARM-SCZY7210-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
      D             RIYO-CMP-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日   =["
      D             SYORI-YMD           OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID   =["
      D             KIDOU-ID            OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ファンドコード   =["
      D             FUND-CD             OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":ポートフォリオコード =["
      D             PTF-CD              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":評価系列コード  =["
      D             HYK-KRTU-CD         OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票ID  =["
      D             REP-ID              OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":帳票任意コード =["
      D             REP-ANY-CD          OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日FROM =["
      D             KJN-YMD-FROM        OF  PARM-SCZY7210-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":実行ステータス =["
      D             JIKOU-STS           OF  PARM-SCZY7210-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7210"             USING  PARM-SCZY7210-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7210)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
      *---------- Bコミットする
             PERFORM  DB-COMMIT3-RTN
           ELSE
             PERFORM  SUB-ERR-MSG-RTN
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-134          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-901          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD               OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  実行状況管理明細更新処理"
      D             "（最終セッション）処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7210-UPDATE-EXT.
           EXIT.
      ******************************************************************
      *    Bコミットする
      ******************************************************************
       DB-COMMIT3-RTN         SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  START  ***"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             CONTINUE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 正常"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":コミット処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-159          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  CNS-COMMIT-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
             IF  WK-RETURN-CD < CNS-RTN-BT16
             THEN
               MOVE  CNS-RTN-BT16       TO  WK-RETURN-CD
             ELSE
               CONTINUE
             END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.4 エラー処理へ
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>-------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  コミット処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       DB-COMMIT3-EXT.
           EXIT.
      ******************************************************************
      *    3.3.後処理
      ******************************************************************
       END-RTN                SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  後処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.3.1.メッセージ登録処理
           PERFORM  SCZY7080-RTN
      *---------- 3.3.2.ＤＢコミットリリース処理
           PERFORM  COMMIT-ORA-REL-RTN
      *---------- 3.3.3.処理件数メッセージ出力処理
           PERFORM  SYORI-CNT-MSG-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
      *---------- 3.3.4.終了メッセージ出力処理
           IF  WK-RETURN-CD = CNS-RTN-BT0
           THEN
             MOVE  CNS-N                TO  WK-ERR-SYUBETU
           ELSE
             MOVE  CNS-U                TO  WK-ERR-SYUBETU
           END-IF
      *---------- 3.3.4.バッチ終了メッセージ出力
           PERFORM  END-MSG-OUT-RTN
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  後処理  END  ***"
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      *-----------------------------------------------------------------
           CONTINUE.
       END-EXT.
           STOP RUN  WK-RETURN-CD.
      ******************************************************************
      *    3.4.エラー処理
      ******************************************************************
       ERR-RTN                SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  エラー処理  START  ***"
      D    DISPLAY  CNS-PGM-ID":FLG-TKCMSZ00-CR-OPEN=["
      D             FLG-TKCMSZ00-CR-OPEN"]"
      *-----------------------------------------------------------------
           INITIALIZE  FLG-OPEN-FLG-1                                   @3212SEINO@@
                       FLG-OPEN-FLG-2                                   @3212SEINO@@
                       FLG-OPEN-FLG-3                                   @3212SEINO@@
      *--------------------<DEBUG>--------------------------------------@3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-1=["FLG-OPEN-FLG-1"]"      @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-2=["FLG-OPEN-FLG-2"]"      @3212SEINO@@
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-FLG-3=["FLG-OPEN-FLG-3"]"      @3212SEINO@@
      *-----------------------------------------------------------------@3212SEINO@@
      *---------- 1)カーソルクローズ処理                                @3212SEINO@@
           PERFORM  CURSOR-CLOSE-RTN                                    @3212SEINO@@
           IF  FLG-TKCMSZ00-CR-OPEN = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKCMSZ00_CURSOR
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-TKCMSZ00-CR-OPEN
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      D    DISPLAY  CNS-PGM-ID":FLG-TKCMSZ00-CR-OPEN=["
      D             FLG-TKCMSZ00-CR-OPEN"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           IF  FLG-OPEN-TKMZSR00 = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZSR00_CUR_23
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-OPEN-TKMZSR00
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMZSR00=["
      D             FLG-OPEN-TKMZSR00"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           IF  FLG-OPEN-TKMXST00 = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMXST00_CUR_24
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-OPEN-TKMXST00
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMXST00=["
      D             FLG-OPEN-TKMXST00"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
           IF  FLG-OPEN-TKMZMS00 = CNS-ON
           THEN
             EXEC  SQL
                 CLOSE TKMZMS00_CUR_25
             END-EXEC
             MOVE  CNS-OFF              TO  FLG-OPEN-TKMZMS00
      *-----------------------DEBUG-------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE-CLOSE=["SQLCODE"]"
      D    DISPLAY  CNS-PGM-ID":FLG-OPEN-TKMZMS00=["
      D             FLG-OPEN-TKMZMS00"]"
      *-----------------------------------------------------------------
           ELSE
             CONTINUE
           END-IF
      *---------- 3.4.1.ＤＢロールバックリリース処理
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークDB接続情報.DB接続フラグ =["
      D             WK-DB-SETUZOKU-FLG  OF  WK-DB-SETUZOKU-JYOUHOU"]"
      *-----------------------------------------------------------------
           IF  WK-DB-SETUZOKU-FLG       OF  WK-DB-SETUZOKU-JYOUHOU
            =  CNS-DB-CONNECT-FLG-1
           THEN
             PERFORM  ROLLBACK-ORA-REL-RTN
           ELSE
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":**** ＤＢロールバックリリース処理"
      D            "しない****"
      *-----------------------------------------------------------------
             CONTINUE
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-SYSTEM-ERR=["FLG-SYSTEM-ERR"]"
      *-----------------------------------------------------------------
      *---------- 3.4.2.エラー情報追加処理
           IF  FLG-SYSTEM-ERR = CNS-OFF
           THEN
             PERFORM  ERR-MSG-OUT-RTN
           ELSE
             MOVE  CNS-OFF              TO  FLG-SYSTEM-ERR
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":**** エラー情報追加処理しない ****"
      *-----------------------------------------------------------------
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":FLG-SYSTEM-ERR=["FLG-SYSTEM-ERR"]"
      *-----------------------------------------------------------------
      *---------- 3.4.3.処理件数メッセージ出力処理
           PERFORM  SYORI-CNT-MSG-RTN
      *---------- 3.4.4.終了メッセージ出力処理
           MOVE  CNS-S                  TO  WK-ERR-SYUBETU
           PERFORM  END-MSG-OUT-RTN
      *---------- 3.4.5.プログラム終了（リターンコード＝16（システムエラー)）
           MOVE  CNS-RTN-BT16           TO  WK-RETURN-CD
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ワークリターンコード =["WK-RETURN-CD"]"
      D    DISPLAY  CNS-PGM-ID":***  エラー処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-EXT.
           STOP RUN  WK-RETURN-CD.
      ******************************************************************
      *    3.3.1.メッセージ登録処理
      ******************************************************************
       SCZY7080-RTN           SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  メッセージ登録処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7080-INOUT
                       PARM-RTNPKG
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7080-ARG1
      *---------- 処理実行日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  SYORI-YMD              OF  PARM-SCZY7080-ARG1
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7080-ARG1
      *---------- 業務タスクID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  GYOMU-TASK-ID          OF  PARM-SCZY7080-ARG1
      *---------- メッセージエリア ← ワークメッセージエリア
           MOVE  WK-MSG-AREA
             TO  MSG-AREA               OF  PARM-SCZY7080-ARG2
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":処理実行日=["
      D             SYORI-YMD           OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":起動ID=["
      D             KIDOU-ID            OF  PARM-SCZY7080-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":業務タスクID=["
      D             GYOMU-TASK-ID       OF  PARM-SCZY7080-ARG1"]"
      *    DISPLAY  CNS-PGM-ID":メッセージエリア=["
      *             MSG-AREA            OF  PARM-SCZY7080-ARG2"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7080"             USING  PARM-SCZY7080-INOUT
                                               PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG =["PARM-RTNPKG"]"
      D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7080)       =["
      D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)"]"
      *-----------------------------------------------------------------
           IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
            =  CNS-RTN-000
           THEN
             CONTINUE
           ELSE
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- ポジション
             MOVE  CNS-POS-160          TO  WK-ERR-POS
      *---------- ワークエラーパッケージを編集
             MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
      *---------- リターンコード
             MOVE  CNS-RTN-901            TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  RTN-CD                 OF  PARM-RTNPKG
                                            (COUNTER OF PARM-RTNPKG)
               TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  SPACE
               TO  WK-FREE-MSG            OF  WK-SYS-ERR-INFO
      *---------- エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
      *---------- エラー処理
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  メッセージ登録処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SCZY7080-EXT.
           EXIT.
      ******************************************************************
      *    3.3.2.ＤＢコミットリリース処理
      ******************************************************************
       COMMIT-ORA-REL-RTN     SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** ＤＢコミットリリース処理  START ***"
      D    DISPLAY  CNS-PGM-ID":ワークDB接続情報.DB接続フラグ =["
      D             WK-DB-SETUZOKU-FLG  OF  WK-DB-SETUZOKU-JYOUHOU"]"
      *-----------------------------------------------------------------
      *---------- COMMIT
           EXEC SQL
               COMMIT RELEASE
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT RELEASE)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-DB-CONNECT-FLG-0
               TO  WK-DB-SETUZOKU-FLG   OF  WK-DB-SETUZOKU-JYOUHOU
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢコミットリリース処理 正常"
      D    DISPLAY  CNS-PGM-ID":ワークDB接続情報.DB接続フラグ =["
      D             WK-DB-SETUZOKU-FLG  OF  WK-DB-SETUZOKU-JYOUHOU"]"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢコミットリリース処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-161          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  CNS-COM-RELEASE-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー処理
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  ＤＢコミットリリース処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       COMMIT-ORA-REL-EXT.
           EXIT.
      ******************************************************************
      *    ＤＢロールバックリリース処理
      ******************************************************************
       ROLLBACK-ORA-REL-RTN   SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  ＤＢロールバックリリース処理  START  ***"
      *-----------------------------------------------------------------
      *---------- ROLLBACK
           EXEC SQL
               ROLLBACK RELEASE
           END-EXEC
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":SQLCODE(ROLLBACK RELEASE)=["SQLCODE"]"
      *-----------------------------------------------------------------
      *---------- SQLCODEのチェック
           IF  SQLCODE = CNS-SQL-NORMAL
           THEN
             MOVE  CNS-DB-CONNECT-FLG-0
               TO  WK-DB-SETUZOKU-FLG   OF  WK-DB-SETUZOKU-JYOUHOU
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢロールバックリリース処理 正常"
      D    DISPLAY  CNS-PGM-ID":ワークDB接続情報.DB接続フラグ =["
      D             WK-DB-SETUZOKU-FLG  OF  WK-DB-SETUZOKU-JYOUHOU"]"
      *-----------------------------------------------------------------
           ELSE
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":ＤＢロールバックリリース処理 エラー"
      *-----------------------------------------------------------------
      *---------- ワークリターンコード
             MOVE  CNS-RTN-BT16         TO  WK-RETURN-CD
      *---------- ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *---------- エラー検知プログラムID
             MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
      *---------- ポジション
             MOVE  CNS-POS-162          TO  WK-ERR-POS
      *---------- リターンコード
             MOVE  CNS-RTN-900          TO  WK-RTN-CD
      *---------- 詳細リターンコード
             MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
      *---------- 詳細リターンコードデコードフラグ
             MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  CNS-ROLLBACK-ERR
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *---------- エラー処理
             PERFORM  ERR-RTN
           END-IF
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  ＤＢロールバックリリース処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ROLLBACK-ORA-REL-EXT.
           EXIT.
      ******************************************************************
      *    処理件数メッセージ出力処理
      ******************************************************************
       SYORI-CNT-MSG-RTN      SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID
      D             ":***  処理件数メッセージ出力処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7040-INOUT
      *---------- テーブル・ファイル数
           MOVE  CNS-16
             TO  TABLE-FILE-NUM         OF  PARM-SCZY7040-INOUT
      *---------- 識別子(1)
           MOVE  WK-SCZY7040-ARG2
             TO  ARG2                   OF  PARM-SCZY7040-INOUT
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":テーブル・ファイル数=["
      D             TABLE-FILE-NUM      OF  PARM-SCZY7040-INOUT   "]"
      D    DISPLAY  CNS-PGM-ID":識別子(1)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(1)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(1)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(1)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(1)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(1)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(2)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(2)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(2)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(2)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(2)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(2)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(3)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(3)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(3)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(3)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(3)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(3)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(4)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(4)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(4)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(4)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(4)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(4)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(5)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(5)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(5)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(5)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(5)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(5)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(6)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(6)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(6)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(6)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(6)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(6)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(7)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(7)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(7)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(7)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(7)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(7)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(8)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(8)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(8)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(8)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(8)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(8)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(9)           =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(9)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(9)         =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(9)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(9)         =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(9)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(10)          =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(10)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(10)        =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(10)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(10)        =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(10)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(11)          =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(11)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(11)        =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(11)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(11)        =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(11)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(12)          =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(12)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(12)        =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(12)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(12)        =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(12)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(13)          =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(13)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(13)        =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(13)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(13)        =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(13)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(14)          =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(14)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(14)        =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(14)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(14)        =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(14)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(15)          =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(15)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(15)        =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(15)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(15)        =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(15)"]"
      D    DISPLAY  CNS-PGM-ID":識別子(16)          =["
      D             IDENT-ID            OF  PARM-SCZY7040-INOUT(16)"]"
      D    DISPLAY  CNS-PGM-ID":対象処理(16)        =["
      D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-INOUT(16)"]"
      D    DISPLAY  CNS-PGM-ID":処理件数(16)        =["
      D             DISPOSAL-NUM        OF  PARM-SCZY7040-INOUT(16)"]"
      *-----------------------------------------------------------------
           CALL  "SCZY7040"             USING  PARM-SCZY7040-INOUT
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":*** 処理件数メッセージ出力処理  END ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SYORI-CNT-MSG-EXT.
           EXIT.
      ******************************************************************
      *    エラー2情報追加処理
      ******************************************************************
       ERR-MSG-OUT-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  エラー2情報追加処理  START  ***"
      *-----------------------------------------------------------------
      *---------- エラーリターンパッケージ
           INITIALIZE  PARM-SCZY1170-IN
           MOVE  WK-SYS-ERR-INFO        TO  PARM-SCZY1170-ARG1
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名          =["
      D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":ポジション                      =["
      D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":リターンコード                  =["
      D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコード              =["
      D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
      D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":フリーメッセージ                =["
      D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":PARM-SCZY1170-RTNPKG            =["
      D             PARM-SCZY1170-RTNPKG                      "]"
      *-----------------------------------------------------------------
      *---------- リターンパッケージセットルーチンをコールする
           CALL  "SCZY1170"             USING  PARM-SCZY1170-IN
                                               PARM-SCZY1170-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  エラー2情報追加処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       ERR-MSG-OUT-EXT.
           EXIT.
      ******************************************************************
      *    終了メッセージ出力処理
      ******************************************************************
       END-MSG-OUT-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  終了メッセージ出力処理  START  ***"
      *-----------------------------------------------------------------
           INITIALIZE  PARM-SCZY7020-INOUT
                       PARM-RTNPKG
      *---------- エラー種別
           MOVE  WK-ERR-SYUBETU
             TO  ERR-SYUBETU            OF  PARM-SCZY7020-ARG1
      *---------- プログラムID
           MOVE  CNS-PGM-ID
             TO  PGM-ID                 OF  PARM-SCZY7020-ARG2
      *---------- 利用会社コード
           MOVE  WK-RIYO-CMP-CD         OF  WK-ARG-INFO
             TO  RIYO-CMP-CD            OF  PARM-SCZY7020-ARG2
      *---------- 基準日
           MOVE  WK-SYORI-YMD           OF  WK-ARG-INFO
             TO  KJN-YMD                OF  PARM-SCZY7020-ARG2
      *---------- 実行処理ID
           MOVE  WK-GYOMU-TASK-ID       OF  WK-ARG-INFO
             TO  JIKOU-SYORI-ID         OF  PARM-SCZY7020-ARG2
      *---------- 起動ID
           MOVE  WK-KIDOU-ID            OF  WK-ARG-INFO
             TO  KIDOU-ID               OF  PARM-SCZY7020-ARG2
      *---------- リターンパッケージをセットする
           MOVE  PARM-SCZY1170-RTNPKG   TO  PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":エラー種別    =["
      D             ERR-SYUBETU         OF  PARM-SCZY7020-ARG1"]"
      D    DISPLAY  CNS-PGM-ID":プログラムID  =["
      D             PGM-ID              OF  PARM-SCZY7020-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":利用会社コード=["
      D             RIYO-CMP-CD         OF  PARM-SCZY7020-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":実行処理ID    =["
      D             JIKOU-SYORI-ID      OF  PARM-SCZY7020-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":基準日        =["
      D             KJN-YMD             OF  PARM-SCZY7020-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":起動ID        =["
      D             KIDOU-ID            OF  PARM-SCZY7020-ARG2"]"
      D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG   =["PARM-RTNPKG  "]"
      *-----------------------------------------------------------------
           CALL  "SCZY7020"             USING  PARM-SCZY7020-INOUT
                                               PARM-RTNPKG
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  終了メッセージ出力処理  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       END-MSG-OUT-EXT.
           EXIT.
      ******************************************************************
      *    サブエラーメッセージ出力処理
      ******************************************************************
       SUB-ERR-MSG-RTN        SECTION.
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  サブエラーメッセージ出力処理"
      D             "  START  ***"
      D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
      D             COUNTER OF PARM-RTNPKG"]"
      *-----------------------------------------------------------------
           INITIALIZE  WK-ERR-CNT
           PERFORM                  VARYING  WK-ERR-CNT
             FROM  CNS-1 BY CNS-1
             UNTIL WK-ERR-CNT > COUNTER OF PARM-RTNPKG
      *-------------------<DEBUG>---------------------------------------
      D    DISPLAY  CNS-PGM-ID":WK-ERR-CNT=["WK-ERR-CNT"]"
      *-----------------------------------------------------------------
      *----------  ワークエラーパッケージを編集
             INITIALIZE  WK-SYS-ERR-INFO
      *----------  エラー検知プログラムID
             MOVE  ERR-PGM-ID           OF  PARM-RTNPKG(WK-ERR-CNT)
               TO  WK-ERR-PGM-ID
      *----------  ポジション
             MOVE  ERR-POS              OF  PARM-RTNPKG(WK-ERR-CNT)
               TO  WK-ERR-POS
      *----------  リターンコード
             MOVE  RTN-CD               OF  PARM-RTNPKG(WK-ERR-CNT)
               TO  WK-RTN-CD
      *----------  詳細リターンコード
             MOVE  DETAIL-RTN-CD        OF  PARM-RTNPKG(WK-ERR-CNT)
               TO  WK-DETAIL-RTN-CD
      *----------  詳細リターンコードデコードフラグ
             MOVE  DETAIL-RTN-CD-FLG    OF  PARM-RTNPKG(WK-ERR-CNT)
               TO  WK-DETAIL-RTN-CD-FLG
      *---------- フリーメッセージ
             MOVE  FREE-MSG             OF  PARM-RTNPKG(WK-ERR-CNT)
               TO  WK-FREE-MSG          OF  WK-SYS-ERR-INFO
      *----------  エラー情報追加処理
             PERFORM  ERR-INFO-ADD-RTN
           END-PERFORM
      *--------------------<DEBUG>--------------------------------------
      D    DISPLAY  CNS-PGM-ID":***  サブエラーメッセージ出力処理"
      D             "  END  ***"
      *-----------------------------------------------------------------
           CONTINUE.
       SUB-ERR-MSG-EXT.
           EXIT.
